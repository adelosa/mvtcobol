*$MODULE       PHASE4                                                   00006021
IKF40A CSECT                                                            00012021
PH4BEG EQU   *                                                          00018021
       ENTRY PH4                                                        00024021
       ENTRY CBLIKF40                                                   00030021
         ENTRY  PHINIT                                                  00036021
       DC    C'IKFCBL40'           PHASE NAME                           00042021
       DC    C'B'                  BUILD                                00048021
       DC    X'1E'                 BUILD NUMBER                         00054021
*                                                                       00060021
*                                                                       00066021
*                                                                       00072021
*                                                                       00078021
*                                                                       00084021
*                                                                       00090021
*                                                                       00096021
*                                                                       00102021
*                                                                       00108021
*=3                                                                     00114021
*                                                                       00120021
*TITLE:                                                                 00126021
*                                                                       00132021
*   'IKFCBL40'                                                          00138021
*                                                                       00144021
*STATUS:                                                                00150021
*                                                                       00156021
*   CHANGE LEVEL 000                                                    00162021
*                                                                       00168021
*FUNCTION/OPERATION:                                                    00174021
*                                                                       00180021
*   CHECKS SYNTAX OF PROCEDURE DIVISION. SUPPRESSES INCORRECT OUTPU     00186021
*   REDUCES P1 TO P2 TEXT BY ELIMINATING NON-ESSENTIAL WORDS AND        00192021
*   ATOMIZING EACH STATEMENT INTO A SERIES OF VERB STRINGS, I.E.,       00198021
*   VERB FOLLOWED BY ITS OPERANDS.                                      00204021
*                                                                       00210021
*ENTRY POINTS:                                                          00216021
*                                                                       00222021
*        PH4                                                            00228021
*                                                                       00234021
*INPUT:                                                                 00240021
*                                                                       00246021
*   FILE-3, I-C (P1) TEXT REDUCTION OF PROCEDURE DIVISION.              00252021
*                                                                       00258021
*OUTPUT:                                                                00264021
*                                                                       00270021
*  FILE-2, I-C ( P2 ) TEXT TRANSFORMATION OF PROCEDURE DIVISION         00276021
*                                                                       00282021
*EXTERNAL ROUTINES:                                                     00288021
*                                                                       00294021
*        COS       LINK TO I-O AND INTERPHASE COMMON REGION             00300021
*  (COS IS ALTERNATE NAME FOR PHASE 00 )                                00306021
*        PRIME     *              *     PREPARE TABLE                   00312021
*        INSERT    *TABLE-HANDLING*     PROVIDE ROOM                    00318021
*        TABREL    *              *     RELEASE TABLE                   00324021
*                                                                       00330021
*EXITS-NORMAL:     VIA COS TO PHASE 5        L      1,=A(COS)           00336021
*                                            BALR   0,1                 00342021
*                                            DC     X'0A'               00348021
*EXIT-ERROR-       COMPILER ERROR MSG WHEN IC-TEXT COUNT FIELD = 0,     00354021
*                   THEN SKIP TO PHASE 5                                00360021
*                                                                       00366021
*TABLES/WORK AREAS:                                                     00372021
*                                                                       00378021
*   ALL EXTENSIVE WORK-AREAS ARE TAMER TABLES, DESCRIBED IN DETAIL      00384021
*   AT LOC TAMDEF. SMALL WORK-AREAS START AT LOC DATA.                  00390021
*                                                                       00396021
*ATTRIBUTES:                                                            00402021
*                                                                       00408021
*   NOT REUSABLE                                                        00414021
*                                                                       00420021
*NOTES:                                                                 00426021
*                                                                       00432021
*   GENERAL ORGANIZATION: 1. VERB ANALYZERS                             00438021
*                           A. DATA-MANIPULATION VERBS                  00444021
*                           B. PROCEDURE-NAME-HANDLING VERBS            00450021
*                           C. ARITHMETIC VERBS, IF, AND ELSE           00456021
*                           D. DEBUGGING VERBS                          00462021
*                           E. SORT VERBS                               00468021
*                           F. COMPILER-DIRECTING VERBS                 00474021
*                           G. I-O VERBS                                00480021
*                         2. PHASE CONTROLLER                           00486021
*                         3. SUBROUTINES                                00492021
*                         4. CONSTANTS                                  00498021
*                         5. DATA                                       00504021
*                         6. INITIALIZATION (OVERLAYS DATA)             00510021
*                                                                       00516021
*   BASE-REGISTERS FOR 2-6 ARE LOADED DURING INITIALIZATION AND NEV     00522021
*      CHANGED.                                                         00528021
*   BASE-REGISTER FOR VERB-ANALYZER (RVRB) IS LOADED BY PHASE-CONTR     00534021
*      LER EACH TIME A VERB IS FOUND.                                   00540021
*   REGISTER 13 IS NOT USED.                                            00546021
*   VERB ANALYZERS DO NOT STORE-RESTORE REGISTERS.                      00552021
*   ALL PHASE 4 INTERNAL SUBROUTINES SAVE AND RESTORE ALL REGISTERS     00558021
*      (EXCEPT FOR THOSE WHICH ADVANCE THE INPUT POINTER RIN).          00564021
*      BUT EXTERNAL SUBROUTINE COS CLOBBERS REGISTERS 0 AND 1           00570021
*      AND TAMER INSERT ROUTINE MODIFIES REGISTERS 0,2, AND 3.          00576021
*      PHASE 4 SUBROUTINES,HOWEVER, WHICH CALL COS AND TAMER DO         00582021
*      SAVE  REGISTERS 0 - 3.                                           00588021
*                                                                       00594021
PH40   TITLE 'IKFCBL40'                                                 00600021
*                         5. PHASE INITIALIZATION                       00606021
*                         6. DATA                                       00612021
*                                                                       00618021
*   VERB ANALYZERS ARE GROUPED INTO SEVERAL CSECTS WHICH MAY BE REO     00624021
*      GANIZED AT WILL,SINCE EACH VERB HAS ITS OWN BASE. SUBROUTINE     00630021
*      CONSTANTS,AND DATA ARE SIMILARLY GROUPED INTO CSECT1 - CSECT     00636021
*      WHOSE FIRST LABEL IS, RESPECTIVELY,COMON1 - COMON5. IF REOR-     00642021
*      GANIZATION IS NECESSARY, CARE MUST BE TAKEN WITH THESE 5 LAB     00648021
*      SINCE IT IS THEIR ADDRESSES THAT GO INTO THE 5 PERMANENT BAS     00654021
*      REGISTERS. ALSO, ALL ADCONS SHOULD BE KEPT TOGETHER IN CSECT     00660021
*      AND ALL VARIABLE DATA IN CSECT5.                                 00666021
*                                                                       00672021
*                                                                       00678021
*                                                                       00684021
*   GENERAL CONSIDERATIONS IN ERROR PROCESSING                          00690021
*                                                                       00696021
*      ALMOST NO ASSUMPTIONS - 'ERROR RECOVERIES' FOR THE SOURCE PR     00702021
*   GRAM - ARE MADE.  OUR HOPE IS TO CHECK AS MUCH AS CAN REASONABL     00708021
*   BE CHECKED SO AS TO SAVE REPEATED RECOMPILATIONS. IT IS  N O T      00714021
*   TO GUESS WHAT THE PROGRAMMER MAY HAVE INTENDED AND CORRECT HIS      00720021
*   MISTAKES.                                                           00726021
*      WE PROCESS IN SEQUENCE FORWARD, ALWAYS ASKING 'GIVEN WHAT WE     00732021
*   HAVE SO FAR, WHAT IS THE NEXT ELEMENT WE CAN EXPECT?'  WHEN WE      00738021
*   FAIL TO FIND IT WE DO NOT GO BACK AND READJUST OUR EXPECTATION.     00744021
*   (LIMITED CORE PREVENTS THIS SOPHISTICATION.) WE DELETE.             00750021
*      WE ATTEMPT TO CORRECT ONLY IN THE SIMPLEST CASES -- E.G.,        00756021
*   UNPAIRED PARENTHESES,MISSING REQUIRED COBOL WORDS WHEN THERE IS     00762021
*   NO CHOICE OF OPTIONS.                                               00768021
*        IN THE MOST GENERAL TERMS: A WRONG OPERAND WHICH IS ONE OF     00774021
*   SERIES (ADD X Y Z TO A) IS DISCARDED. A WRONG OPERAND WHICH IS      00780021
*   SINGLE CAUSES THE ENTIRE VERB STATEMENT TO BE DELETED. A WRONG      00786021
*   MISSING REQUIRED COBOL WORD IS ASSUMED.AN OPTIONAL CLAUSE CONTA     00792021
*   ING WRONG OPERANDS IS DISCARDED.                                    00798021
*      WE SEND TO PHASE 5 ONLY CORRECT OUTPUT AS FAR AS WE KNOW. IT     00804021
*   CAN BE STUPID BUT SHOULD BE ACCEPTABLE TO THEIR ANALYZERS.          00810021
*      WE WRITE NO MESSAGE  IF THE UNWELCOME-UNEXPECTED ELEMENT IS      00816021
*   'ERROR-SYMBOL', ASSUMING A PREVIOUS PHASE HAS COMMENTED IT.         00822021
*   WE SIMPLY APPEND TO THE OTHER PHASES'S MESSAGE THE ACTION WE AR     00828021
*   TAKING, E.G., DELETING STATEMENT,DISCARDING OPTION,ETC.             00834021
*      IN A FEW CASES -- NOTABLY THE COMPLEX, POSSIBLY LENGTHY, VER     00840021
*   IF AND PERFORM AND THE ARITHMETIC VERBS -- WE SUBSTITUTE ARBITR     00846021
*   FOR ILLEGAL OPERANDS. THIS IS MERELY TO FACILITATE OUR CONTINUE     00852021
*   PROCESSING AND DOES NOT REPRESENT  AN ATTEMPTED 'CORRECTION'.       00858021
*      WE DISCARD MEANINGLESS OPTIONAL WORDS WITHOUT REGARD TO THE      00864021
*   INAPPROPRIATENESS OF THEIR USE (E.G., 'IS','ARE','THEN').           00870021
*                                                                       00876021
*                                                                       00882021
       EJECT                                                            00888021
*=2                                                                     00894021
*                 ABSOLUTE EQUATED VALUES                               00900021
*                                                                       00906021
       SPACE   5                                                        00912021
*                                                                       00918021
*              STANDARD EQUATES FOR BC INSTRUCTIONS                     00924021
*                                                                       00930021
UNCOND EQU   15                                                         00936021
HI     EQU   2                                                          00942021
LO     EQU   4                                                          00948021
EQ     EQU   8                                                          00954021
NOTHI  EQU   13                                                         00960021
NOTLO  EQU   11                                                         00966021
NOTEQ  EQU   7                                                          00972021
OV     EQU   1                                                          00978021
POS    EQU   2                                                          00984021
NEG    EQU   4                                                          00990021
ZERO   EQU   8                                                          00996021
NOTOV  EQU   14                                                         01002021
NOTPOS EQU   13                                                         01008021
NOTNEG EQU   11                                                         01014021
NOTZER EQU   7                                                          01020021
ONES   EQU   1                                                          01026021
MIXED  EQU   4                                                          01032021
NOTONE EQU   14                                                         01038021
NOTMXD EQU   11                                                         01044021
NOP    EQU   0                                                          01050021
       EJECT                                                            01056021
*                                                                       01062021
*                 REGISTER NAMES                                        01068021
*                                                                       01074021
RA0    EQU   0                'ACCUMULATOR'                             01080021
RW1    EQU   1                INDEX AND WORK REGISTERS                  01086021
RW2    EQU   2                                                          01092021
RW3    EQU   3                                                          01098021
RW4    EQU   4                                                          01104021
RW5    EQU   5                                                          01110021
RW6    EQU     6                                                        01116021
RB1    EQU   7           BASE REGISTERS                                 01122021
RB2    EQU   8                                                          01128021
RB3    EQU   9                                                          01134021
RB4    EQU     10                                                       01140021
RB5    EQU     11                                                       01146021
RIN    EQU     12            CURRENT-INPUT POINTER                      01152021
R13    EQU   13                                                         01158021
RCS    EQU   14          CALL REGISTER FOR SUBROUTINES                  01164021
RAS    EQU     15            BASE FOR INTERPHASE AND INFREQUENT         01170021
RVRB   EQU     15                  BASE FOR VERB ANALYZERS              01176021
       IHBCOB                                                           01182021
       EJECT                                                            01188021
*                 PHASE-4 EQU'S FOR TIBS                                01194021
*                                                                       01200021
STRING EQU   TIB9-COS                                                   01206021
VARYTB EQU   TIB10-COS                                                  01212021
VNTBL  EQU   TIB11-COS                                                  01218021
PFMTBL EQU   TIB12-COS                                                  01224021
DBGTBL EQU   TIB13-COS                                                  01230021
PNOUNT EQU   TIB14-COS                                                  01236021
PSIGNT EQU   TIB15-COS                                                  01242021
PTRFLS EQU   TIB16-COS                                                  01248021
PSHTBL EQU   TIB17-COS                                                  01254021
DEFSBS EQU   TIB18-COS                                                  01260021
KEYTBL EQU   TIB20-COS                                                  01266021
SETTBL EQU   TIB21-COS                                                  01272021
*                                                                       01278021
*              OTHER EQU'S USED AS IMMEDIATE VALUES IN INSTRUCTIONS     01284021
*                                                                       01290021
MSWON  EQU     1                                                        01296021
MSWOFF EQU     254                                                      01302021
MASTER EQU     X'10'              USED TO TEST PSHTBL AND PTRFLS        01308021
MPND   EQU     X'6'                                                     01314021
MPNU   EQU     X'20'                                                    01320021
MLGN   EQU     X'88'              GNDEF                                 01326021
MVERB    EQU   68                                                       01332021
MVBOUT EQU     X'84'                                                    01338021
MREL   EQU     X'50'              ORDINARY RELATIONAL                   01344021
MCNDRL   EQU   X'51'          RELATION FROM CONDITION-NAME              01350021
MNEGRL EQU     X'01'               NOT-BIT FOR IF RELATIONAL            01356021
MF0    EQU   X'F0'                                                      01362021
MFF      EQU   255                                                      01368021
MBREAK EQU   X'42'                                                      01374021
MCARD  EQU   X'81'                                                      01380021
MOP    EQU     X'20'                                                    01386021
MDN      EQU   X'30'                                                    01392021
MFILE  EQU     X'21'                                                    01398021
MSFN   EQU     X'21'                                                    01404021
MGDN     EQU   X'F8'                                                    01410021
MIR    EQU     X'BA'                                                    01416021
MSS      EQU   X'31'                                                    01422021
MNLIT    EQU   X'32'                                                    01428021
MFLIT    EQU   X'33'                                                    01434021
MALIT    EQU   X'34'                                                    01440021
MATEXT   EQU   X'37'               LISTING A-TEXT                       01446021
MOWNLT EQU     X'3F'                                                    01452021
MFGCON   EQU   X'75'                                                    01458021
MSIGN    EQU   X'53'                                                    01464021
MGLTBC EQU     X'FA'              GLOBAL-TABLE CELL                     01470021
MINCOD EQU     1                                                        01476021
MDVCOD EQU     3                                                        01482021
MINMSK EQU     X'1'               USED TO CHANGE SIGN OF LITERAL        01488021
MLITBT EQU     1                                                        01494021
UNSIGN EQU   X'0F'                                                      01500021
MDNUM  EQU     128                MODE-BYTE FOR NUMERIC DATA-NAME       01506021
MDREP  EQU     32                               REPORT   .              01512021
MNUMVB EQU     X'0E'              CODE FOR RELAT. VERB 'NUMERIC'        01518021
MALFVB EQU     X'0C'              CODE FOR RELAT. VERB 'ALPHABETIC'     01524021
MANMOD EQU     3                MODE+1 FOR ALPHANUMERIC                 01530021
MALMOD EQU     2                           ALPHABETIC                   01536021
MIDMOD EQU     12                          INT. DECIMAL                 01542021
MEDMOD EQU     8                           EXT. DECIMAL                 01548021
MEFMOD EQU     9                            EXT. FLOATING               01554021
MSNMOD EQU     X'D'                          STERLING NON-REPORT        01560021
MNUMBT EQU     128              BIT IN MODE FOR NUMERIC                 01566021
MGRPBT EQU 112                                                          01572021
MNONBT EQU     32               BIT IN MODE FOR NON-NUMERIC             01578021
MRPAL  EQU     64            MODE BIT COMMON TO AN,AL, GRP              01584021
MFGMOD EQU     3               BITS IN MODE FOR FIGCON                  01590021
MGRPV    EQU   4                  MODE FOR GROUP-VARIABLE DN            01596021
MFPRBT EQU     X'1'        FLOATING-POINT PRECISION                     01602021
MFGZRO EQU     128                 BIT IN MODE OFR FIGCON ZERO          01608021
MFGALP EQU     64                  BIT IN MODE FOR FIGCON AL AND SP     01614021
MSKALF EQU     X'10'           BIT IN RELAT.VERB FOR NON-NUMERIC        01620021
MNOALF EQU     X'EF'              TURNS OFF MSKALF                      01626021
MIFMOD EQU     X'0A'            VALUE OF MODE FOR INT. FLOATING         01632021
MNUMRL EQU     X'0B'            HIGHEST CODE FOR NUMERIC RELATIONAL     01638021
MOPLNG EQU     126          LENGTH OF LONGEST IF OPERAND + 4 FOR IT     01644021
MDUGPK EQU     X'09'               DEBUG PACKET CODE                    01650021
MERDCL EQU     X'08'         ERROR-DECL BIT IN FILE ATTRIBUTES          01656021
MASYNC EQU     2                  MAJOR-CODE BIT FOR ASYNCH. FILE       01662021
MENDCL EQU     X'08'               END DECLARATIVES CODE                01668021
MDECL  EQU     X'07'               DECLARATIVE CODE                     01674021
MPRDIV EQU     X'06'              START OF SOURCE PROCEDURE DIVISIO     01680021
MQRT   EQU     X'0A'              START OF Q- ROUTINES, END OF SOUR     01686021
MSNBIT EQU     X'40'              SECTION-NAME BIT IN LHN,RHN           01692021
MDBGBT EQU     X'80'         DEBUG BIT FOR LHN,RHN REFERENCED IN DE     01698021
MDBUGU EQU     X'40'         DEBUG BIT FOR LHN,RHN DEFINED IN DEBUG     01704021
MALTBT EQU     X'10'              ALTER BIT FOR LHN,RHN                 01710021
MPFMBT EQU     X'20'            PERFORM BIT FOR LHN,RHN                 01716021
MDUMBT EQU     X'20'              DUMMY-NAME BIT FOR LHN                01722021
MRPTBT EQU     X'01'              REPORT DECLARATIVE BIT FOR RHN        01728021
MLABIT EQU     X'04'              PN BIT,DEFINED IN ERROR DECLARATI     01734021
MDCLPN EQU     X'10'              PN BIT, DEFINED IN ANY DECLARATIV     01740021
MLABRP EQU     X'05'          COMBINATION OF PN LABEL AND REPORT BI     01746021
MELDB  EQU     X'4C'       COMBINES ERR, LAB,DEBUG PN BITS              01752021
MGOBIT EQU     8                                                        01758021
MEXTBT EQU     4                  EXIT BIT FOR LHN                      01764021
MNDPFM EQU     X'04'               USED BY IDLHN TO MARK END-PERFOR     01770021
USINDX EQU    X'70'                USAGE IS INDEX                       01776021
*                                                                       01782021
MNOIND EQU   X'9F'                                                      01788021
MB20   EQU     20                                                       01794021
MB24   EQU     24                  BINARY 00011000                      01800021
MB128  EQU     128                 BINARY 10000000                      01806021
MSKIND EQU   X'60'      THIS PLUS REL. CODE GIVES INDEX RELCODE         01812021
MINDNM EQU   X'36'                 FIRST BYTE OF INDEXNAME              01818021
INDMD1 EQU   X'08'                FIRST BYTE MODE FOR INDEXNAME         01824021
INDNMD1 EQU   X'10'          FIRST BYTE MODE INDEX DATA ITEM            01830021
M7F    EQU     X'7F'                                                    01836021
GODL   EQU     X'14'                                                    01842021
MVLC EQU       X'F7'                                                    01848021
MZERO  EQU     X'00'                                                    01854021
MB1    EQU     1                                                        01860021
MB2    EQU     2                                                        01866021
MB3    EQU     3                                                        01872021
MB4    EQU     4                                                        01878021
MB5    EQU     5                                                        01884021
MB6    EQU     6                                                        01890021
MB7    EQU     7                                                        01896021
MB8    EQU     8                   BINARY 00001000                      01902021
MB9    EQU     9                                                        01908021
MB10    EQU    10                                                       01914021
MB11   EQU     11                                                       01920021
MB12   EQU     12                                                       01926021
MB13   EQU     13                                                       01932021
MB14   EQU 14                                                           01938021
MB35   EQU   35                                                         01944021
MB16   EQU     16                   BINARY 00010000                     01950021
MB32   EQU     32                   BINARY 00100000                     01956021
MB64   EQU     64                   BINARY 01000000                     01962021
INDEP   EQU  50          INDICATES MINIMUM PTY VALUE FOR INDEP SEGT     01968021
SEGBK  EQU   X'0D'           SEGMENTATION CONTROL BREAK                 01974021
NONSEG EQU X'FF'         VALUE IN SEGLMT FOR NON-SEGT PGM               01980021
MC1    EQU     X'C1'                C1=A                                01986021
ME9    EQU     X'E9'                E9=Z                                01992021
MF9    EQU     X'F9'                F9=9                                01998021
MREEL  EQU     X'80'            *  OPTION CODE FOR CLOSE                02004021
MCLNOR EQU     X'30'            *                                       02010021
MRWND   EQU    X'40'              CLOSE REWIND                          02016021
MVREC  EQU     X'60'        MODE-V BIT IN FN ATTRIBUTES                 02022021
MQSAM  EQU     X'F0'         * FILE TYPE IN FN ATTRIBUTES               02028021
MBSAM  EQU     X'40'        *                                           02034021
MBISAM EQU     X'20'         *                                          02040021
MQISAM EQU     X'10'         *                                          02046021
MBDAM  EQU     X'80'        *                                           02052021
MBIBD    EQU   X'A0'               BITS BISAM AND BDAM                  02058021
MQSBS    EQU   X'B0'               BITS NOT QSAM OR BSAM                02064021
MBDREL EQU     X'04'               BDAM RELATIVE TRACK BITS             02070021
DBDMW  EQU    X'8C'        DIRECT BDAM W ACCESS METHOD                  02076021
BDMDIR EQU    X'84'               DIRECT BDAM ACCESS METHOD             02082021
MSPDN  EQU     X'79'               SPECIAL DN'S= TALLY ETC.             02088021
MOUOPT EQU   X'0F'       *    OPTION CODES OFR OPEN                     02094021
MINOPT EQU    X'00'      *                                              02100021
MIOOPT EQU    X'04'     **                                              02106021
MRVOPT EQU    X'01'     **                                              02112021
MLEAVE EQU    X'30'     *    ADDNL OPEN OPTIONS                         02118021
MRERD  EQU    X'10'    *                                                02124021
MDISP  EQU    X'00'   *                                                 02130021
ADVNCNG EQU  X'09'       TESTS IF ADV OPT EVER USED IN WRITE            02136021
AFTADV  EQU  X'01'       TESTS IF AFTER ADV EVER USED                   02142021
CARGCN  EQU  X'55'       MNEMONIC NAME  ADV OPTION                      02148021
BEFBIT EQU X'80'                                                        02154021
MAPP5  EQU     X'02'         ON QSAM,QISAM,BISAM, WRITE-ONLY BIT        02160021
MWONLY EQU     X'07'              MAJOR CODE FOR DN OF WRITE-ONLY F     02166021
MLEV1  EQU   X'08'       LEVEL 01                                       02172021
MLV177 EQU  X'0C'    LEVEL 01 OR 77                                     02178021
MBLI   EQU   X'F0'                 IS BASE LOCATOR A BLI                02184021
WRTOLV EQU   X'FB'  USED TO 'AND' LEV 77 BIT OFF WRITEONLY              02190021
MSDMAJ EQU     9                  MAJOR CODE FOR SORT FILE              02196021
USOPT  EQU   X'01'           USING FOUND IN SORT STATEMENT              02202021
GVOPT  EQU   X'10'      GIVING IN SORT STATEMENT                        02208021
TAMNUM  EQU  12        NO. TABLES ALWAYS PRIMED/RELEASED                02214021
NEXSN  EQU   8                                                          02220021
PRIOTY EQU   1                                                          02226021
PROCNM EQU   2                                                          02232021
PNIDEN EQU   4                                                          02238021
PTYPN  EQU   7                                                          02244021
PROCED EQU   0                                                          02250021
R0       EQU   0                                                        02256021
DX0      EQU   0                                                        02262021
LX0      EQU   0                                                        02268021
DX1      EQU   1                                                        02274021
NX1      EQU   1                                                        02280021
LX1      EQU   1                                                        02286021
DX2      EQU   2                                                        02292021
NX2      EQU   2                                                        02298021
LX2      EQU   2                                                        02304021
DX3      EQU   3                                                        02310021
NX3      EQU   3                                                        02316021
LX3      EQU   3                                                        02322021
DX4      EQU   4                                                        02328021
NX4      EQU   4                                                        02334021
LX4      EQU   4                                                        02340021
DX5      EQU   5                                                        02346021
NX5      EQU   5                                                        02352021
LX5      EQU   5                                                        02358021
DX6      EQU   6                                                        02364021
NX6      EQU   6                                                        02370021
LX6      EQU   6                                                        02376021
DX7      EQU   7                                                        02382021
NX7      EQU   7                                                        02388021
DX8      EQU   8                                                        02394021
NX8      EQU   8                                                        02400021
LX8      EQU   8                                                        02406021
DX9      EQU   9                                                        02412021
DX10     EQU   10                                                       02418021
NX10     EQU   10                                                       02424021
LX10     EQU   10                                                       02430021
DX11     EQU   11                                                       02436021
DX12     EQU   12                                                       02442021
NX12     EQU   12                                                       02448021
DX13     EQU   13                                                       02454021
NX13     EQU   13                                                       02460021
DX14     EQU   14                                                       02466021
NX14     EQU   14                                                       02472021
NX16     EQU   16                                                       02478021
LX16     EQU   16                                                       02484021
LX122    EQU   122                                                      02490021
LX124    EQU   124                                                      02496021
LX256    EQU   256                                                      02502021
DX256    EQU   256                                                      02508021
XX0      EQU   X'00'                                                    02514021
XXF0     EQU   X'F0'                                                    02520021
XX0C     EQU   X'0C'                                                    02526021
XX0E   EQU     X'0E'                                                    02532021
XX00     EQU   X'00'                                                    02538021
XX02     EQU   X'02'                                                    02544021
XX03     EQU   X'03'                                                    02550021
XX06     EQU   X'06'                                                    02556021
XX08     EQU   X'08'                                                    02562021
XX04     EQU   X'04'                                                    02568021
XX39     EQU   X'39'                                                    02574021
XX09     EQU   X'09'                                                    02580021
XX35     EQU   X'35'                                                    02586021
XX40     EQU   X'40'                                                    02592021
XX0F     EQU   X'0F'                                                    02598021
XX01     EQU   X'01'                                                    02604021
XX07     EQU   X'07'                                                    02610021
XX84     EQU   X'84'                                                    02616021
XX11     EQU   X'11'                                                    02622021
XX10     EQU   X'10'                                                    02628021
XX1F     EQU   X'1F'                                                    02634021
XX30     EQU   X'30'                                                    02640021
XX36     EQU   X'36'                                                    02646021
XX05     EQU   X'05'                                                    02652021
XXBB     EQU   X'BB'                                                    02658021
XX60     EQU   X'60'                                                    02664021
XXA0     EQU   X'A0'                                                    02670021
XXB0     EQU   X'B0'                                                    02676021
XX90     EQU   X'90'                                                    02682021
XX20     EQU   X'20'                                                    02688021
XX80     EQU   X'80'                                                    02694021
XX46     EQU   X'46'                                                    02700021
XX18     EQU   X'18'                                                    02706021
XXFE     EQU   X'FE'                                                    02712021
XX89     EQU   X'89'                                                    02718021
XXEF     EQU   X'EF'                                                    02724021
XXFD     EQU   X'FD'                                                    02730021
XXDF     EQU   X'DF'                                                    02736021
XX7F     EQU   X'7F'                                                    02742021
XX0A     EQU   X'0A'                                                    02748021
XX4D     EQU   X'4D'                                                    02754021
XX5D     EQU   X'5D'                                                    02760021
XX79     EQU   X'79'                                                    02766021
XXFF     EQU   X'FF'                                                    02772021
XX72     EQU   X'72'                                                    02778021
XX81     EQU   X'81'                                                    02784021
XX61     EQU   X'61'                                                    02790021
XXA3     EQU   X'A3'                                                    02796021
XX63     EQU   X'63'                                                    02802021
XX70     EQU   X'70'                                                    02808021
XX0D     EQU   X'0D'                                                    02814021
XX23     EQU   X'23'                                                    02820021
XX1D     EQU   X'1D'                                                    02826021
XX1E     EQU   X'1E'                                                    02832021
XX2A     EQU   X'2A'                                                    02838021
XX32     EQU   X'32'                                                    02844021
XC0      EQU   C'0'                                                     02850021
       EJECT                                                            02856021
IKF40A CSECT                                                            02862021
       USING   COMON1,RB1                                               02868021
       USING   COMON2,RB2                                               02874021
       USING   COMON3,RB3                                               02880021
       USING   COMON4,RB4                                               02886021
       USING   COMON5,RB5                                               02892021
*                                                                       02898021
       USING   GOTTEN,RIN                                               02904021
       USING    COS,RW1                                                 02910021
       SPACE   12                                                       02916021
*******************************************************************     02922021
*                                                                       02928021
*                                                                       02934021
*                   V E R B  A N A L Y Z E R S                          02940021
*                                                                       02946021
*      ALL VERB ANALYZERS START ' USING  *,RVRB '.                      02952021
*      THEIR ADDRESSES ARE IN A LIST, ORDERED BY CODE, AT AVRB.         02958021
*      IDENT LOADS RVRB FROM THE APPROPRIATE CELL OF THIS LIST, AND     02964021
*        TURNS CONTROL OVER TO THE ANALYZER BY A  BCR  UNCOND,RVRB      02970021
*                                                                       02976021
*      EXIT FROM EACH ANALYZER IS TO IDENT.                             02982021
*         BC   UNCOND,IDENT       NORMAL CASE                           02988021
*         BC   UNCOND,IDERR       AFTER MSG HAS BEEN WRITTEN            02994021
*                                                                       03000021
*      VERB ANALYZERS DO NOT SAVE AND RESTORE REGISTERS EXCEPT FOR      03006021
*        THEIR OWN CONVENIENCE.                                         03012021
*                                                                       03018021
*                                                                       03024021
*******************************************************************     03030021
         EJECT                                                          03036021
*=1    MOVE    VERB                                                     03042021
*******************************************************************     03048021
*                                                                       03054021
*                                                                       03060021
*                                                                       03066021
*                                  M O V E                              03072021
*                                                                       03078021
*                                                                       03084021
*                                                                       03090021
*** STRINGS PRODUCED                                                    03096021
*      SOURCE - MOVE A TO B,C,D.                                        03102021
*      OUTPUT - MOVE A B                                                03108021
*               MOVE A C                                                03114021
*               MOVE A D                                                03120021
*                                                                       03126021
*      SOURCE - MOVE CORRESPONDING A TO B,C.                            03132021
*      OUTPUT - MOVE A1 B1    ('CORRESPONDING' OPERANDS GIVEN BY PH     03138021
*               MOVE A2 B2                                              03144021
*               .    .  .                                               03150021
*               MOVE AN BN                                              03156021
*               MOVE A1 C1                                              03162021
*               MOVE A2 C2                                              03168021
*               .    .  .                                               03174021
*               MOVE AN CN                                              03180021
*                                                                       03186021
*                                                                       03192021
*** SUBROUTINES CALLED                                                  03198021
*      GETNXT,GETALL,RDUCOP,STOVRB,STOINP,GENSTR,ISOKMV,ERROR,OPERR     03204021
*                                                                       03210021
*                                                                       03216021
*** ERROR PROCESSING                                                    03222021
*      ASSUME 'TO' IF MISSING                                           03228021
*      ACCEPT SUPERFLUOUS 'TO' BETWEEN MULTIPLE TARGETS                 03234021
*      IF SOURCE-FIELD ILLEGAL, SKIP TILL NEXT STATEMENT                03240021
*      IF TARGET-FIELD ILLEGAL, SKIP, SEEK LEGAL TARGET-FIELD           03246021
*      IF SOURCE AND TARGET INCOMPATIBLE,SKIP,SEEK NEXT TARGET          03252021
*                                                                       03258021
*                                                                       03264021
*                                                                       03270021
*                                                                       03276021
*                                                                       03282021
*** NOTES                                                               03288021
*    MOVSW1      IF ON, SECOND OPERAND WAS FOUND                        03294021
*      DRYRUN  IF ON MEANS SOURCE FORM OF CORRESPONDING. CHECK SYNT     03300021
*               BUT PRODUCE NO OUTPUT. TURNED OFF BY MOVE OR OPERR.     03306021
*      CORRSW  IF ON MEANS PROCESSING PH3 EXPANSIONS. DO OUTPUT. TU     03312021
*               OFF BY MOVE OR OPERR WHEN NEXT WORD 'CORRESPONDING'     03318021
*               IS FOUND (PH3 INSERTS THIS AT END OF EACH EXPANSION     03324021
*              SERIES).                                                 03330021
*      OP1SS AND OP2SS ARE INITIALIZED OFF. TURNED ON IF SOURCE FOR     03336021
*               OF CORRESPONDING HAS SUBSCRIPTED OP1 OR OP2,RESPECT     03342021
*               LY. IF EITHER IS ON, OPSSSW IS TURNED ON BEFORE A       03348021
*               CALL TO RDUCOP,TO TELL THE SUBSCRIPT ROUTINE TO FIN     03354021
*               SUBSCRIPTS FOR EXPANSION OPERANDS NOT IN THE INPUT      03360021
*               STREAM AS NORMALLY BUT AT LOC OPRND1 OR OPRND2 RES-     03366021
*               PECTIVELY. SUBSCR TURNS OFF OPSSSW.                     03372021
*      THISOP CONTAINS ADDR OF  OPRND1 OR OPRND2, RESPECTIVELY. TEL     03378021
*               RDUCOP WHICH OPERAND IS BEING STORED (DRYRUN) OR        03384021
*               PROCESSED (EXPANSIONS). TELLS OPERR WHETHER TO GIVE     03390021
*               UP (OPRND1) OR SKIP TO NEXT OPERAND (OPRND2).           03396021
*                                                                       03402021
*                                                                       03408021
*                                                                       03414021
*******************************************************************     03420021
       SPACE   5                                                        03426021
       USING   *,RVRB                                                   03432021
MOVE   EQU     *                                                        03438021
*                                                                       03444021
       NI      SKIPSW,MSWOFF                                            03450021
         XC    LEFTSS(LX2),LEFTSS   INIT TAMM-DISPL) SAVE AREAS         03456021
         XC    LEFTDP(LX2),LEFTDP                                       03462021
       LA      RCS,OPRND1         TELL SUBSCR AND OPERR IT IS OP-1      03468021
       ST      RCS,THISOP                                               03474021
       NI    MOVSW1,MSWOFF         INITIALIZE SWITCH TO ZERO            03480021
         CLC   GOTTEN(LX2),CBSAME   IS IT COBOL WORD 'SAME'             03486021
       BC    EQ,MOVE48             YES - IT IS 'SAME'                   03492021
         CLC   GOTTEN(LX2),CBCORR   IS IT COBOL WORD 'CORRESPONDING'    03498021
       BC    NOTEQ,MOVE51          NO - CHECK IF CORR SWITCH ON         03504021
       BAL   RCS,GETNXT            IS IT 'CORRESPONDING'                03510021
       BAL     RCS,ISDTOP         IS IT A DATA OPERAND AT ALL           03516021
       BC      UNCOND,OPERR        NO - GIVE UP                         03522021
       OI    DRYRUN,MSWON          SET ON, SOURCE-FORM OF CORRESPON     03528021
MOVE04 NI    OP1SS,MSWOFF          INITIALIZE OP1SS SW                  03534021
MOVE07 EQU     *                                                        03540021
       BAL   RCS,RDUCOP            IS IT A VALID DATA OPERAND AT AL     03546021
       BAL   RCS,OPERR             NO, GO TO OPERR SUBROUTINE           03552021
       BAL     RCS,GETALL          YES, MOVE OPERAND TO SAVE AREA       03558021
       LA      RW2,PLEFT          SAVE OP1 FOR MSG                      03564021
         MVC   MODEL(LX2),MODE      SAVE MODE OF OP1 FOR ISOKMV ROUT    03570021
         MVC   DMAXL(LX1),DCURR                                         03576021
       TM    DRYRUN,MSWON                                               03582021
       BC    ZERO,MOVE54           ORDINARY 'MOVE'                      03588021
       CLI   GOTTEN,MSS            IS IT A SUSCRIPTED DN                03594021
       BC    NOTEQ,MOVE10          NO, GET ANOTHER ENTITY               03600021
       OI    OP1SS,MSWON           GOT 1ST SS DN, TURN OP1SS SW ON      03606021
MOVE10 BAL   RCS,GETNXT            GO TO GETNXT ROUTINE                 03612021
       LA      RCS,OPRND2         PROVIDE OPRND2 ADDR. TO SUBSCR        03618021
       ST      RCS,THISOP                                               03624021
       TM    CORRSW,MSWON                                               03630021
       BC    ONES,MOVE29           NOT A CORRESPONDING MOVE             03636021
       NI    OP2SS,MSWOFF                                               03642021
MOVE13   CLC   GOTTEN(LX2),CBTO     IS IT COBOL WORD 'TO'               03648021
       BC    EQ,MOVE16             YES, CHECK IF FIRST 'TO'             03654021
       TM    MOVSW1,MSWON          NOT 'TO'                             03660021
       BC    ONES,MOVE20           FOR DN-3,DN-4----ETC.                03666021
       LA      RA0,CBTO           'TO' MISSING                          03672021
       BAL     RCS,ERROR           NOT 'TO' OR 2ND OPERAND- ERROR       03678021
       LA      RW1,ELST07                                               03684021
       BC    UNCOND,MOVE20         CHECK IF 2ND OPERAND IS VALID        03690021
MOVE16 TM    MOVSW1,MSWON                                               03696021
       BC    ZERO,MOVE18           THE FIRST 'TO'                       03702021
       LA      RA0,CBTO                                                 03708021
       BAL     RCS,ERROR          SUPERFLUOUS 'TO'                      03714021
       LA      RW1,ELST08                                               03720021
MOVE18 BAL   RCS,GETNXT            GET NEXT INPUT                       03726021
MOVE20 BAL   RCS,RDUCOP            IS IT A VALID DATA OPERAND           03732021
       OI      SKIPSW,MSWON         NO                                  03738021
       BAL     RCS,GETALL          YES, MOVE OPERAND TO SAVE AREA       03744021
       LA      RW2,PRIGHT         SAVE OP2 FOR MSG                      03750021
         MVC   MODER(LX2),MODE      SAVE MODE OF OP2 FOR ISOKMV ROUT    03756021
         MVC   DMAXR(LX1),DCURR                                         03762021
       TM      SKIPSW,MSWON        WAS IT GOOD OPERAND                  03768021
       BC      ONES,MOVE32          NO                                  03774021
       TM      MODE,MLITBT          IS IT DN                            03780021
       BC      ONES,MOVE35          NO - LITERAL - ERROR                03786021
       TM    DRYRUN,MSWON                                               03792021
       BC    ZERO,MOVE58           ORDINARY 'MOVE' DRYRUN OFF           03798021
       CLI   GOTTEN,MSS            IS IT A SS DN                        03804021
       BC    NOTEQ,MOVE23          NO, NOT SUBSCRIPTED                  03810021
       OI    OP2SS,MSWON           GOT 2ND SS DN, TURN OP2SS SW ON      03816021
MOVE23 BAL   RCS,GETNXT            GET NEXT INPUT                       03822021
       NI    DRYRUN,MSWOFF         AFTER GOT 2 SS DN TURN DRYRUN SW     03828021
       OI    CORRSW,MSWON           AND TURN CORRSW SW ON               03834021
       OI    GENRED,MSWON          DRYRUN ON, BUT NOT GENERATE YET,     03840021
*                                  TURN GENRED ON TO TELL IDENT - -     03846021
*                                  MESSAGE.                             03852021
       BC    UNCOND,IDENT          EXIT                                 03858021
MOVE29 TM    OP2SS,MSWON           IS 2ND SS DN PROCESSED               03864021
       BC    ZERO,MOVE13           NO                                   03870021
       OI    OPSSSW,MSWON          IT IS A SUBSCROPTED DN 'MOVE'        03876021
       BC    UNCOND,MOVE13         CHECK VALIDITY OF DN                 03882021
MOVE32 NI      SKIPSW,MSWOFF                                            03888021
       BAL     RCS,OPERR           YES                                  03894021
MOVE35 BAL     RCS,ERROR           OP-2 CANT BE RECEIVING FIELD         03900021
       LA      RW1,ELST34                                               03906021
MOVE38 OI    GENRED,MSWON          TURN ON FOR IDENT                    03912021
       BC    UNCOND,MOVE62         GET NEXT ENTITY                      03918021
MOVE45   CLC   GOTTEN(LX2),CBCORR   IS IT COBOL WORD 'CORRESPONDING'    03924021
       BC    NOTEQ,IDENT           NO, GO BACK TO IDENT                 03930021
       BAL   RCS,GETNXT            YES, DISCARD 'CORRESPONDING'         03936021
       NI    CORRSW,MSWOFF         IT IS CORRESPONDING 'MOVE'           03942021
       BC    UNCOND,IDENT          EXIT                                 03948021
MOVE48 OI    DRYRUN,MSWON          GOT COBOL WORD 'SAME' AFTER 'MOV     03954021
       BC    UNCOND,MOVE10         PROCESS NEXT OPERAND                 03960021
MOVE51 TM    CORRSW,MSWON                                               03966021
       BC    ZERO,MOVE04           NOT A SOURCE OF CORRESPONDING        03972021
       TM    OP1SS,MSWON                                                03978021
       BC    ZERO,MOVE07           NOT SS DN OF CORRESPONDING           03984021
       OI    OPSSSW,MSWON          1ST SS OPRND WAS FOUND               03990021
       BC    UNCOND,MOVE07         CHECK IF SS OPERAND VALID            03996021
MOVE54 BAL   RCS,STOVRB            STORE VERB 'MOVE' ON STRING          04002021
       BAL   RCS,STOINP            STORE OPERAND-1 ON STRING            04008021
         MVC   LEFTDP(LX2),DSPSTR  SAVE DISPL. OF VERB + OPERAND1 FO    04014021
*                                  REUSE IF SEVERAL TARGET FIELDS       04020021
         MVC   LEFTSS(LX2),DSPSBS  SAVE OPERAND-1'S SBS DISPLACEMENT    04026021
       BC    UNCOND,MOVE10         GET 2ND OPERAND                      04032021
MOVE58 BAL     RCS,ISOKMV         ARE SOURCE AND TARGET COMPATIBLE      04038021
       BC      UNCOND,MOVE38       NO                                   04044021
       BAL     RCS,STOINP           YES - STORE OP2                     04050021
       BAL   RCS,GENSTR            GENERATE STRING TO OUTPUT            04056021
       NI    CLEVMSG,MSWOFF                                             04062021
MOVE62 BAL   RCS,GETNXT            GET THE NEXT ENTITY                  04068021
       TM    CORRSW,MSWON                                               04074021
       BC    ONES,MOVE45           CHECK IF 'CORRESPONDING'             04080021
       L     RW2,ASTRNG            OFF, STORE LEFTDP (SIZE OF MOVE      04086021
         L     RW2,DX0(RW2)         OPERAND-1) INTO TAMER DISPLACEME    04092021
         MVC   DX4(LX2,RW2),LEFTDP                                      04098021
         MVC   DSPSTR(LX2),LEFTDP                                       04104021
       L     RW2,ADFSBS            STORE LEFTSS (SAVED DISPSS FOR       04110021
         L     RW2,DX0(RW2)         OPERAND-1) INTO DEFSBS DISPLACEM    04116021
         MVC   DX4(LX2,RW2),LEFTSS                                      04122021
         MVC   DSPSBS(LX2),LEFTSS                                       04128021
       OI    MOVSW1,MSWON          2ND OPERAND WAS FOUND                04134021
       BC    UNCOND,MOVE13         IS THE OPERAND VALID                 04140021
         EJECT                                                          04146021
*=1    MOVRPT  VERB                                                     04152021
*******************************************************************     04158021
*                                                                       04164021
*                      M O V R P T                                      04170021
*                                                                       04176021
*                                                                       04182021
*      ANALYZER FOR SPECIAL INTERNAL VERBS FROM REPORT-WRITER AND       04188021
*       Q-ROUTINES. CONSISTS SOLELY OF CHANGING VERB AND PN'S TO        04194021
*       P-2 TEXT FORM AND MAKING SURE NO OPERANDS ARE UNDEFINED.        04200021
*                                                                       04206021
*                                                                       04212021
*** SUBROUTINES CALLED                                                  04218021
*      STOVRB,STPNIN,GETNXT,GENSTR                                      04224021
*      ISINTG,ERROR,RDUCOP                                              04230021
*                                                                       04236021
*                                                                       04242021
*******************************************************************     04248021
       SPACE   5                                                        04254021
       USING   *,RVRB                                                   04260021
UPDATE EQU     *             THE ONLY INTERNAL VERB THAT MAY HAVE       04266021
*                             ERRORS                                    04272021
       OI      TEMPSW,MSWON                                             04278021
       LA      RVRB,MOVRPT-UPDATE(RVRB)                                 04284021
       USING   *,RVRB                                                   04290021
MOVRPT EQU     *                                                        04296021
       BAL     RCS,STOVRB          STORE VERB IN STRING                 04302021
       SR      RW5,RW5                                                  04308021
         IC    RW5,VERB+NX2        RW5 CONTROLS LOOP                    04314021
       LTR     RW5,RW5                                                  04320021
       BC      ZERO,MOVRP4          EXIT IF NO OPERANDS                 04326021
MOVRP2   CLC   GOTTEN(LX1),ERSYMB                                       04332021
       BC      EQ,IDERR             DONT GENR IF ANY IS UNDEFINED       04338021
       CLI     GOTTEN,MDN         IS IT DN FROM WRITE-ONLY RECORD       04344021
       BC      NOTEQ,MOVR2X         NO- OK                              04350021
         TM    DX2(RIN),MWONLY                                          04356021
       BC      NOTONE,MOVR2X        NO- OK                              04362021
       BAL     RCS,ERROR           YES - WARNING, MAY BE ILLEGAL        04368021
       LA      RW1,ELST5E                                               04374021
         NI    DX2(RIN),XXF0       TURN OFF APPLY WRITEONLY BITS        04380021
MOVR2X EQU     *                                                        04386021
       BAL     RCS,STPNIN         STORE                                 04392021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  04398021
       TM      TEMPSW,MSWON       DID WE JUST GET 2ND OP FOR UPDATE     04404021
       BC      ZERO,MOVRP3          NO - CONTINUE                       04410021
       NI      TEMPSW,MSWOFF        YES - TEST IT FOR ERRORS            04416021
       CLI     GOTTEN,MDN                                               04422021
       BC      NOTEQ,UPDAT1        NOT A DN                             04428021
         TM    DX3(RIN),XX0C       IS IT SUBSCRIPTED                    04434021
       BC      NOTZER,UPDAT2       YES - ERROR                          04440021
UPDAT1 EQU     *                                                        04446021
       CLI     GOTTEN,MGLTBC      IS IT VLC                             04452021
       BC      EQ,MOVRP3            YES - OK                            04458021
       BAL     RCS,RDUCOP         DATA OPERAND                          04464021
       BC      UNCOND,UPDAT2        NO - ERROR                          04470021
       BAL     RCS,ISINT2         INTEGER                               04476021
       BC      UNCOND,UPDAT2       NO - ERROR                           04482021
       CLI     GOTTEN,MSS         SUBSCRIPTED                           04488021
       BC      EQ,UPDAT2           YES - ERROR                          04494021
       TM      MODE,MLITBT        DATA-NAME                             04500021
       BC      NOTZER,UPDAT2       NO - ERROR                           04506021
       BCT     RW5,MOVR2X          YES                                  04512021
UPDAT2 BAL     RCS,ERROR          NO GOOD - SUBSTITUTR TALLY            04518021
       LA      RW1,ELST53                                               04524021
       LA      RIN,CBTALY                                               04530021
MOVRP3 EQU     *                                                        04536021
       BCT     RW5,MOVRP2         RETURN FOR NEXT                       04542021
MOVRP4 BAL     RCS,GENSTR         GENR WHOLE STRING                     04548021
       BC      UNCOND,IDENT        RETURN TO IDENT                      04554021
       EJECT                                                            04560021
*=1    TRFORM  VERB                                                     04566021
*******************************************************************     04572021
*                                                                       04578021
*                                                                       04584021
*                                                                       04590021
*                        T R A N S F O R M                              04596021
*                                                                       04602021
*                                                                       04608021
*** STRINGS PRODUCED                                                    04614021
*      SOURCE - TRANSFORM DN3 (CHARACTERS) FROM OP1 TO OP2.             04620021
*      OUTPUT - TRANSFORM INFO-NN DN3 OP1 OP2.                          04626021
*                                                                       04632021
*                                                                       04638021
*                                                                       04644021
*   NN =       IF 'FROM' OPERAND IS    AND    'TO' OPERAND IS           04650021
*                                                                       04656021
*    0         FIGCON                          FIGCON                   04662021
*              NNL1=1                          NNL2=1                   04668021
*                                                                       04674021
*    4         FIGCON                          DN2=1                    04680021
*              NNL1=1                                                   04686021
*                                                                       04692021
*    8         NNL1 GREATER THAN 1             NNL2 GREATER THAN 1      04698021
*              DN1 GREATER THAN 1             DN2 GREATER THAN 1        04704021
*                                                                       04710021
*   12         NNL1 GREATER THAN 1            DN2 = 1                   04716021
*                                                                       04722021
*   16         NNL1 GREATER THAN 1            FIGCON                    04728021
*              DN1  GREATER THAN 1            NNL2 = 1                  04734021
*                                                                       04740021
*   20         DN1 = 1                        FIGCON                    04746021
*                                             NNL2 = 1                  04752021
*                                                                       04758021
*   24         DN1 = 1                        DN2 = 1                   04764021
*                                                                       04770021
*                                                                       04776021
*                                                                       04782021
*      ('1' ABOVE REFERS TO LENGTH OF THE ENTITY)                       04788021
*                                                                       04794021
*                                                                       04800021
*** SUBROUTINES CALLED                                                  04806021
*      GETNXT,RDUCOP,STOVRB,STOINP,STOR45,GENSTR,ERROR                  04812021
*                                                                       04818021
*                                                                       04824021
*** ERROR PROCESSING                                                    04830021
*      ASSUME 'TO' AND/OR 'FROM' IF MISSING                             04836021
*      IF DN3 NOT NON-NUMERIC DATA-NAME, OR                             04842021
*      IF OP1 NOT NON-NUMERIC OPERAND OF LEGAL LENGTH, OR               04848021
*      IF OP2  .   .    .       .     .  .     .     , OR               04854021
*      IF OP1 AND OP2 ARE INCOMPATIBLE IN LENGTH, SKIP TO NEXT STAT     04860021
*        MENT                                                           04866021
*      TRANSFORM EXT-DECIMAL-NAME FROM SPACES TO --, IS ACCEPTED WI     04872021
*       WARNING                                                         04878021
*                                                                       04884021
*                                                                       04890021
*** NOTES                                                               04896021
*      TFMSW1 IS ON TO TRIGGER MSG IF 'TO' OR 'FROM' MISSING            04902021
*      RW1 IS USED AS SWITCH,INDICATING OP1 IF 0, OP2 IF 2              04908021
*      RW2 IS A SUMMARY OF THE TYPES OF OPERANDS FOUND. AT THE END      04914021
*        THE STATEMENT IT = 0 IF NEITHER OP1 NOR OP2 IS DATA-NAME       04920021
*                           1 IF ONLY OP1 IS DATA-NAME                  04926021
*                           3 IF ONLY OP2 IS DATA-NAME                  04932021
*                           5 IF BOTH OP1 AND OP2 ARE DATANAMES         04938021
*                                                                       04944021
*                                                                       04950021
*                                                                       04956021
*******************************************************************     04962021
       SPACE   6                                                        04968021
       USING   *,RVRB                                                   04974021
TRFORM EQU     *                                                        04980021
       NI      TFMSW1,MSWOFF       INITIALIZE TFMSW1 OFF                04986021
         NI    ETOPTS+NX2,MZERO     ZERO LAST BYTE OF ETOPTS            04992021
         NI    TREDSW,MSWOFF      SWITCH FOR ED NAME                    04998021
       SR      RW1,RW1             RW1 USED AS INDEX TO INDICATE        05004021
*                                  WHETHER OPERAND 2 OR 3 IS BEING      05010021
*                                  PROCESSED                            05016021
       SR      RW2,RW2             FINAL VALUE INDICATES WHETHER        05022021
*                                  OPERAND 2 OR/AND 3 ARE DATA NAME     05028021
       LA      RA0,BCDDN          PARAM FOR POSSIBLE MSG 32             05034021
       BAL     RCS,RDUCOP         IS IT A VALID DATA-OPERAND AT ALL     05040021
       BC      UNCOND,IDGVUP       NOT DATA OPERAND                     05046021
       TM      MODE,MLITBT        IS IT A DN                            05052021
       BC      ONES,IDGVUP          NO - GIVE UP                        05058021
         CLI   MODE+NX1,MB7                                             05064021
         BC    LO,TRFM02          AN,AL,OR GROUP OK                     05070021
         CLI   MODE+NX1,MEDMOD                                          05076021
         BC    NOTEQ,TRFM05       ILLEGAL MODE                          05082021
         OI    TREDSW,MSWON       ED, SPECIAL CASE                      05088021
TRFM02 BAL     RCS,STOVRB          STORE 'TRANSFORM' VERB ON STRING     05094021
       LA      RW4,ETOPTS                                               05100021
       BAL     RCS,STOR45         STORE ETOPTS IN STRING                05106021
       BAL     RCS,STOINP            STORE DATA NAME ON STRING          05112021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      05118021
         CLC   GOTTEN(LX2),CBCHAR     IS IT CHARACTERS                  05124021
       BC      NOTEQ,TRFM03        NO                                   05130021
       BAL     RCS,GETNXT          YES, GET NEXT ENTITY                 05136021
TRFM03   CLC   GOTTEN(LX2),CBFROM     IS COBOL WORD 'FROM'              05142021
       BC      NOTEQ,TRFM06        NO, ISSUE A WARNING MESSAGE          05148021
       BAL     RCS,GETNXT            'FROM' IS FOUND, GET NEXT DATA     05154021
TRFM04 BAL     RCS,RDUCOP          IS IT A VALID DATA OPERAND           05160021
       BC      UNCOND,TRFM05       NON-OPERAND                          05166021
       LTR     RW1,RW1                                                  05172021
       BC      NOTZER,TRFM4X       IT IS OP2                            05178021
       BAL     RCS,GETALL         SAVE FROM-OPERAND FOR ERR. MSG        05184021
       LA      RW2,PLEFT                                                05190021
         TM    TREDSW,MSWON       WAS OPERAND 1 ED                      05196021
         BC    ZERO,TRFM4X          NO                                  05202021
         CLC   GOTTEN(LX2),CBSPCE   YES - IS THIS 'SPACE'               05208021
         BC    NOTEQ,TRFM05          NO - DISCARD                       05214021
TRFM4X EQU     *                                                        05220021
       TM      MODE,MB32           IS DN NUMERIC                        05226021
       BC      ZERO,TRFM05         IT IS NUMERIC                        05232021
       TM      MODE,MB1                                                 05238021
       BC      ZERO,TRFM12        IT IS A DN                            05244021
       TM      MODE,MB2                                                 05250021
       BC      ONES,TRFM07         FIG-CON                              05256021
       BC      ZERO,TRFM11         NON NUMERIC LITERAL                  05262021
TRFM05 BAL     RCS,ERROR           ILLEGAL DATA OPERAND                 05268021
       LA      RW1,ELST04                                               05274021
       BC      UNCOND,IDERR        SKIP THE STATEMENT                   05280021
TRFM06 OI      TFMSW1,MSWON          TURN ON IF 'FROM' MISSING          05286021
       LA      RA0,CBFROM          FOR ERROR MESSAGE                    05292021
       BC      UNCOND,TRFM04       CHECK THE OPERAND                    05298021
TRFM07   LH    RW3,N1              PUT 1 INTO FIGCON LENGTH             05304021
         STH   RW3,SVTFLN(RW1)                                          05310021
TRFM08 BAL     RCS,STOINP          STORE CURRENT INPUT ON STRING        05316021
       C       RW1,N0                TEST INDEX IF NOT 0 INDICATE       05322021
*                                    WHOLE STAEMENT IS BEING CHECKE     05328021
       BC      NOTEQ,TRFM16        CHECK THE WHOLE STATEMENT            05334021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  05340021
         CLC   GOTTEN(LX2),CBTO       IS IT COBOL WORD 'TO'             05346021
       BC      NOTEQ,TRFM10        NO, TURN THE SWITCH ON               05352021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  05358021
TRFM09   LA    RW1,DX2(RW1)           INDEX INCREMENTED BY 2            05364021
       BC      UNCOND,TRFM04       IS THE 2ND OPERAND VALID             05370021
TRFM10 OI      TFMSW1,MSWON          TURN ON INDICATE 'TO ' MISSING     05376021
       LA      RA0,CBTO            FOR ERROR MESSAGE                    05382021
       BC      UNCOND,TRFM09       IT IS SECOND OPERAND                 05388021
TRFM11   SR    RW3,RW3                                                  05394021
         IC    RW3,GOTTEN+NX1       SAVE NON-NUM-LIT. LENGTH            05400021
         STH   RW3,SVTFLN(RW1)                                          05406021
       BC      UNCOND,TRFM08       STORE NON-NUM-LIT. ON STRING         05412021
TRFM12   LA    RW2,DX1(RW2)           GET CURRENT DATA NAME             05418021
       AR      RW2,RW1               INDICATOR VALUE                    05424021
         CLI   MODE+NX1,MB1         IS IT DN GROUP FIXED                05430021
       BC      EQ,TRFM15           YES                                  05436021
         CLI   MODE+NX1,MB3         IS IT DN ALPHABETIC OR ALPHANUME    05442021
       BC      NOTHI,TRFM14        YES                                  05448021
       BC      UNCOND,TRFM05       ILLEGAL OPERAND                      05454021
TRFM15   TM    DX7(RIN),MSWON      DOES BIT 47 HAVE 1                   05460021
       BC      ONES,TRF19X        ERROR                                 05466021
TRFM14   CLC   DX8(LX2,RIN),N256    IS LENGTH OVER 256                  05472021
       BC      HI,TRF19X           YES - ERROR                          05478021
       LA      RW4,SVTFLN(RW1)                                          05484021
         MVC   DX0(LX2,RW4),DX8(RIN) SAVE THE VALID LENGTH              05490021
       BC      UNCOND,TRFM08       STORE OPERAND IN STRING              05496021
TRFM16   CLC   SVTFLN(LX2),SVTFLN+NX2  COMPARE 2 OPERANDS' LENGTHS      05502021
       BC      EQ,TRFM21           EQUAL-LENGTH OPERANDS                05508021
       CH      RW2,N4                                                   05514021
       BC      EQ,TRFM19             BOTH OPERANDS ARE DN  ERROR        05520021
         CLC   SVTFLN+NX2(LX2),N1      IS 2ND OPERAND LENGTH IS 1       05526021
       BC      NOTEQ,TRFM19          ERROR                              05532021
       CH      RW2,N3                                                   05538021
       BC      EQ,TRFM20           2ND OPERAND IS DN                    05544021
         OI    ETOPTS+NX2,MB16        1ST OPER. EITHER DN1 OR NNL1      05550021
*                                    2ND OPER. EITHER FIGCON OR NNL     05556021
TRFM17 L       RW4,ASTRNG                                               05562021
         L     RW4,DX0(RW4)                                             05568021
         L     RW4,DX0(RW4)                                             05574021
         MVC   DX6(LX1,RW4),ETOPTS+NX2 MOVE CURRENT ETOPTS+2 TO STRIN   05580021
       TM      TFMSW1,MSWON                                             05586021
       BC      ZERO,TRFM18         OFF. GENERATE STRING TO OUTPUT       05592021
       BAL     RCS,ERROR           'TO' AND/OR 'FROM' MISSING           05598021
       LA      RW1,ELST07                                               05604021
TRFM18 BAL     RCS,GENSTR            GENERATE STRING TO OUTPUT          05610021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      05616021
       TM      TREDSW,MSWON       WAS OPERAND 1 ED                      05622021
       BC      ZERO,IDENT          NO - EXIT                            05628021
         BAL   RCS,ERROR            YES - WARNING                       05634021
         LA    RW1,ELST5C                                               05640021
       BC      UNCOND,IDENT        EXIT                                 05646021
TRFM19 BAL     RCS,ERROR           DN LENGTH IS GREATER THAN 256 OR     05652021
       LA      RW1,ELST05           WRONG LENGTH                        05658021
       BC      UNCOND,IDERR        ERROR EXIT                           05664021
TRF19X BAL     RCS,ERROR           LENGTH GREATER THAN 256              05670021
       LA      RW1,ELST47        OPERAND TOO LONG                       05676021
       BC      UNCOND,IDERR        ERROR EXIT                           05682021
TRFM20   OI    ETOPTS+NX2,MB12        2ND OPERAND IS DN2                05688021
       BC      UNCOND,TRFM17       GENERATE THE STRING                  05694021
TRFM21   CLC   SVTFLN(LX2),N1         IS 1ST OPERAND IS 1               05700021
       BC      EQ,TRFM22           YES                                  05706021
         OI    ETOPTS+NX2,MB8         1ST OPER. EITHER DN1 OR NNL1      05712021
       BC      UNCOND,TRFM17         2ND OPER. EITHER NNL2 OR DN2       05718021
TRFM22 C       RW2,N0                IS RW2 ZERO                        05724021
       BC      EQ,TRFM25           YES, OP1 NOR OP2 ARE DN              05730021
       CH      RW2,N3                IS RW2 = 3                         05736021
       BC      HI,TRFM23           OP1 AND OP2 ARE DATA-NAMES           05742021
       BC      EQ,TRFM24           OP2 IS A DN                          05748021
         OI    ETOPTS+NX2,MB20        1ST OPERAND IS DN1                05754021
       BC      UNCOND,TRFM17         2ND OPER. IS EITHER FIGCON OR      05760021
TRFM23   OI    ETOPTS+NX2,MB24        BOTH OPERANDS ARE DN              05766021
       BC      UNCOND,TRFM17       GENERATE THE STRING                  05772021
TRFM24   OI    ETOPTS+NX2,MB4         2ND OPERAND IS DN                 05778021
       BC      UNCOND,TRFM17       GENERATE THE STRING                  05784021
TRFM25   OI    ETOPTS+NX2,MZERO       1ST OPER. EITHER FIGCON OR NNL    05790021
       BC      UNCOND,TRFM17       GENERATE THE STRING                  05796021
               EJECT                                                    05802021
*=1    EXAMIN  VERB                                                     05808021
*******************************************************************     05814021
*                                                                       05820021
*                                                                       05826021
*                                                                       05832021
*                          E X A M I N E                                05838021
*                                                                       05844021
*                                                                       05850021
*** STRINGS PRODUCED                                                    05856021
*      SOURCE - EXAMINE DN ... OPTIONS...CHAR1...OPTIONS ... CHAR2      05862021
*      OUTPUT -                                                         05868021
*        (WITH REPLACING)               (WITHOUT REPLACING)             05874021
*      EXAMINE                           EXAMINE                        05880021
*      INFO-XX                           INFO-XX                        05886021
*      CHAR-1                             CHAR-1                        05892021
*      CHAR-2                             CHAR-1                        05898021
*      DN                                 DN                            05904021
*                                                                       05910021
*                                                                       05916021
*                                                                       05922021
*         XX = BYTE    WHOSE MAKE UP IS                                 05928021
*                                                                       05934021
*         BIT 0 = 1     IF 'TALLYING'                                   05940021
*             1 = 1     IF 'REPLACING'                                  05946021
*             2 = 1     IF 'ALL'                                        05952021
*             3 = 1     IF 'LEADING'                                    05958021
*             4 = 1     IF 'UNTIL FIRST'                                05964021
*             5 = 1     IF 'FIRST'                                      05970021
*             6 = 0     ALWAYS                                          05976021
*             7 = 0     ALWAYS                                          05982021
*                                                                       05988021
*                                                                       05994021
*** SUBROUTINES CALLED                                                  06000021
*      GETNXT,RDUCOP,STOVRB,STOINP,STOR45,GETALL,SAVNXT,GENSTR,ERRO     06006021
*                                                                       06012021
*                                                                       06018021
*** ERROR PROCESSING                                                    06024021
*      IF 1ST OPERAND NOT DATA-NAME OR NOT USAGE DISPLAY, OR            06030021
*      CHARS 1 AND 2 NOT SINGLE-BYTE NON-NUMERIC LITERAL OR FIGCON,     06036021
*      CHAR1 OR CHAR2 INCOMPATIBLE IN MODE WITH DN, SKIP STATEMENT      06042021
*      IF NEITHER 'TALLYING' NOR 'REPLACING' FOUND, OR                  06048021
*      OPTION MISSING FOLLOWING THESE, SKIP STATEMENT                   06054021
*      IF 'BY' MISSING AFTER 'REPLACING' OR 'FIRST'AFTER 'UNTIL'        06060021
*      ASSUME IT                                                        06066021
*                                                                       06072021
*                                                                       06078021
*** NOTES                                                               06084021
*    EXMSW1 IS TURNED ON, TELLING CHAR-2 IS PROCESSED                   06090021
*    EXMSW2 IS TURNED ON, TELLING DN IS NUMERIC DISPLAY                 06096021
*    EXMSW3 IS TURNED ON, TELLING DN IS OTHER DISPLAY                   06102021
*                                                                       06108021
*                                                                       06114021
*                                                                       06120021
*******************************************************************     06126021
       SPACE   6                                                        06132021
       USING   *,RVRB                                                   06138021
EXAMIN EQU     *                                                        06144021
       LA      RA0,BCDDN          PARAM FOR POSSIBLE MSG 32             06150021
       BAL     RCS,RDUCOP         IS IT A VALID DATA-OPERAND AT ALL     06156021
       BC      UNCOND,IDGVUP      NO                                    06162021
       TM      MODE,MB1            IS IT A DATA NAME                    06168021
       BC      ONES,IDGVUP         NO                                   06174021
       NI      EXMSW1,MSWOFF                                            06180021
       NI      EXMSW2,MSWOFF                                            06186021
       NI      EXMSW3,MSWOFF       INITIALIZE ALL SWITHCHES             06192021
         NI    ETOPTS+NX2,MZERO     ZERO ETOPTS LAST BYTE               06198021
       BAL     RCS,STOVRB          STORE VERB IN STRING                 06204021
       LA      RW4,ETOPTS         STORE ETOPTS IN STRING                06210021
       BAL     RCS,STOR45          STORE ENTITY                         06216021
       CLI     MODE,MB128            IS DN NUMERIC                      06222021
       BC      EQ,EXAM24           YES                                  06228021
         CLI   MODE+NX1,MB2                                             06234021
       BC      EQ,EXAM02           ALPHABETIC   USAGE DISPLAY           06240021
       BC      UNCOND,EXAM06       ALPHANUMERIC , GROUP OR REPORT       06246021
*                                  OTHER DISPLAY                        06252021
EXAM02 BAL     RCS,GETALL          MOVE ENTITY TO SAVE AREA             06258021
       LA      RW2,PLEFT          SAVE THE DATA-NAME                    06264021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      06270021
         CLC   GOTTEN(LX2),CBTLYG   IS IT COBOL WORD 'TALLYING'         06276021
       BC      EQ,EXAM08           YES                                  06282021
         CLC   GOTTEN(LX2),CBRPLC   IS IT COBOL WORD 'REPLACING'        06288021
       BC      NOTEQ,EXAM04        ERROR, OPTION MISSING                06294021
         OI    ETOPTS+NX2,MB64      'REPLACING' PUT 1 TO BIT 1 OF ET    06300021
EXAM03 BAL     RCS,GETNXT          GET NEXT ENTITY                      06306021
         CLC   GOTTEN(LX2),CBALL    IS COBOL WORD 'ALL'                 06312021
       BC      EQ,EXAM09           'ALL' IS FOUND                       06318021
         CLC   GOTTEN(LX2),CBLEAD                                       06324021
       BC      EQ,EXAM10           'LEADING' IS FOUND                   06330021
         CLC   GOTTEN(LX2),CBUNTL                                       06336021
       BC      EQ,EXAM11           'UNTIL' IS FOUND                     06342021
         TM    ETOPTS+NX2,MB64      IF BIT 1 IS ON, IT IS OPTION 2 W    06348021
       BC      ONES,EXAM13         'REPLACING'                          06354021
EXAM04 LA      RA0,KEYWRD          OPTION KEYWORD MISSING               06360021
       BAL     RCS,ERROR           ERROR                                06366021
       BC      UNCOND,IDGVUP       GIVE UP                              06372021
EXAM05 OI      EXMSW2,MSWON        NUMERIC DISPLAY                      06378021
       BC      UNCOND,EXAM02       SAVE THE ENTIRE ENTITY               06384021
EXAM06 OI      EXMSW3,MSWON        OTHER DISPLAY                        06390021
       BC      UNCOND,EXAM02       SAVE THE ENTIRE ENTITY               06396021
EXAM08   OI    ETOPTS+NX2,MB128     'TALLYING' IS FOUND, PUT 1 TO BI    06402021
*                                  0 OF ETOPTS                          06408021
       BC      UNCOND,EXAM03       GET THE KEYWORD                      06414021
EXAM09   OI    ETOPTS+NX2,MB32      'ALL' PUT 1 TO BIT 2 OF ETOPTS      06420021
       BC      UNCOND,EXAM14       GET NEXT ENTITY                      06426021
EXAM10   OI    ETOPTS+NX2,MB16      'LEADING' 1 TO BIT 3 OF ETOPTS      06432021
       BC      UNCOND,EXAM14       GET THE NEXT ENTITY                  06438021
EXAM11 BAL     RCS,GETNXT          GET THE NEXT ENTITY                  06444021
         CLC   GOTTEN(LX2),CBFRST                                       06450021
       BC      EQ,EXAM12           'FIRST' FOUND AFTER 'UNTIL'          06456021
       LA      RA0,CBFRST         'FIRST' MISSING AFTER 'UNTIL'         06462021
       BAL     RCS,ERROR           ERROR                                06468021
       LA      RW1,ELST07                                               06474021
       OI      NEXTIN,MSWON                                             06480021
EXAM12   OI    ETOPTS+NX2,MB8       'UNTIL FIRST' 1 TO BIT 4 OF ETOP    06486021
       BC      UNCOND,EXAM14       GET THE NEXT ENTITY                  06492021
EXAM13   CLC   GOTTEN(LX2),CBFRST                                       06498021
       BC      NOTEQ,EXAM04        'FIRST' OF OPTION 2 MISSING          06504021
         OI    ETOPTS+NX2,MB4       'FIRST' 1 TO BIT 5 OF ETOPTS        06510021
EXAM14 BAL     RCS,GETNXT          GET THE NEXT ENTITY                  06516021
         CLC   GOTTEN(LX2),CBALL IS IT ALL 'CHAR'                       06522021
       BNE   EXAM14Y   NO- OK                                           06528021
       BAL   RCS,ERROR   ISSUE WARNING BUT CONTINUE PROCESSING          06534021
       LA    RW1,ELST43     GIVE WARNING-BUT PROCESS NORMALLY           06540021
EXAM14Y BAL  RCS,RDUCOP   SEE IF VALID DATA OPERAND                     06546021
       BC      UNCOND,EXM14X       NO,GIVE UP                           06552021
         CLC   GOTTEN(LX2),ALPNUM   TEST CHAR1 AND CHAR2 IF IT 1 BYT    06558021
       BC      EQ,EXAM15           ALPHANUMERIC LITERAL OR              06564021
         MVC   TEMP(LX1),GOTTEN+NX1   MOVE FIGCON CHARACTER TO TEMP     06570021
       CLI     GOTTEN,MFGCON       FIGURATIVE CONSTANT                  06576021
       BC      EQ,EXAM16           YES, CHECK MODE OF DN                06582021
         CLC   GOTTEN(LX4),NUMLT1 IS IT INTEGRAL NUM LIT                06588021
       BNE   EXM14X       NO- ERROR                                     06594021
         TM    GOTTEN+NX4,UNSIGN                                        06600021
       BO    EXM14Z                DN IS NOT SIGNED                     06606021
       BAL   RCS,ERROR             INVALID LITERAL                      06612021
       LA    RW1,ELST41                                                 06618021
         OI    GOTTEN+NX4,UNSIGN  MAKE IT UNSIGNED                      06624021
EXM14Z   UNPK  FIGALL+NX1(LX1),GOTTEN+NX4(LX1)                          06630021
       LA    RIN,FIGALL                                                 06636021
       TM    EXMSW2,MSWON  DNM NUMERIC OR ALNUM                         06642021
       BO    EXAM20                NUMERIC                              06648021
       TM    EXMSW3,MSWON                                               06654021
       BO    EXAM20                OTHER                                06660021
       B     EXAM17  NO-ERROR                                           06666021
EXM14X EQU     *                                                        06672021
       BAL     RCS,ERROR           INVALID OPERAND                      06678021
       LA      RW1,ELST09                                               06684021
       BC      UNCOND,IDERR        ERROR EXIT                           06690021
EXAM15   MVC   TEMP(LX1),GOTTEN+NX2 MOVE LITERAL CHARACTER TO TEMP      06696021
EXAM16 TM      EXMSW3,MSWON                                             06702021
       BC      ONES,EXAM20         DN IS ALPHANUMERIC                   06708021
       TM      EXMSW2,MSWON                                             06714021
       BC      ONES,EXAM19         DN IS NUMERIC                        06720021
       CLI     TEMP,MC1                                                 06726021
       BC      NOTLO,EXAM18        TEST IS IT ALPHABETIC                06732021
       CLI     TEMP,MB64          IS IT BLANK                           06738021
       BC      EQ,EXAM20           LITERAL IS BLANK                     06744021
EXAM17 BAL     RCS,ERROR           CHAR IS LIT. OR FIGCON BUT           06750021
       LA      RW1,ELST0B           DIFFERENT MODE FOR DN               06756021
       BC      UNCOND,IDERR        ERROR EXIT                           06762021
EXAM18 CLI     TEMP,ME9                                                 06768021
       BC      NOTHI,EXAM20        DN IS ALPHABETIC                     06774021
       BC      HI,EXAM17           NO, ERROR                            06780021
EXAM19 CLI     TEMP,MF0                                                 06786021
       BC      LO,EXAM17           DN NOT NUMERIC - ERROR               06792021
       CLI     TEMP,MF9                                                 06798021
       BC      HI,EXAM17           DN NOT NUMERIC - ERROR               06804021
EXAM20 BAL     RCS,STOINP          STORE CHAR-1                         06810021
       TM      EXMSW1,MSWON        IS THE 2ND TEST FOR CHARACTERS       06816021
         BC    ONES,*+NX8           YES, SKIP TO STORE CHAR AGAIN       06822021
       BAL     RCS,STOINP          STORE CHARACTER-1 AGAIN              06828021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      06834021
       TM      EXMSW1,MSWON                                             06840021
       BC      ONES,EXAM23         CHAR-2 IS PROCESSED                  06846021
         TM    ETOPTS+NX2,MB64      TEST ETOPTS BIT 1 FOR 'REPLACING    06852021
       BC      ONES,EXAM21         ON                                   06858021
         CLC   GOTTEN(LX2),CBRPLC   OFF                                 06864021
       BC      NOTEQ,EXAM23        'REPLACING' IS MISSING               06870021
         OI    ETOPTS+NX2,MB64      'REPLACING' 1 TO BIT 1 OF ETOPTS    06876021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  06882021
*                                                                       06888021
EXAM21   CLC   GOTTEN(LX2),CBBY     IS IT COBOL WORD 'BY'               06894021
       BC    EQ,EXAM22             YES-BRANCH                           06900021
       LA      RA0,CBBY                                                 06906021
       BAL     RCS,ERROR           'BY' MISSING - ISSUE WARNING         06912021
       LA      RW1,ELST07                                               06918021
       OI      NEXTIN,MSWON                                             06924021
EXAM22 L       RW1,ASTRNG          GIVE ADDRESS TO PREMVV               06930021
       BAL     RCS,PREMVV          REMOVE VARIABLE LENGTH               06936021
         LA    RW4,DX0               (DUMMY FOR CHARACTER-1)            06942021
       OI      EXMSW1,MSWON        SET EXMSW1 SWITCH ON FOR NEXT CH     06948021
       BC      UNCOND,EXAM14       GET CHAR-2                           06954021
EXAM23 L       RW3,ASTRNG          NEW ETOPTS+2 TO STRING-ETOPTS+2      06960021
         L     RW3,DX0(RW3)                                             06966021
         L     RW2,DX0(RW3)                                             06972021
         MVC   DX6(LX1,RW2),ETOPTS+NX2                                  06978021
       LA      RW4,PLEFT          STORE DN FROM SAVE AREA TO STRING     06984021
       BAL     RCS,STOR45          STORE DN                             06990021
       BAL     RCS,GENSTR          GENERATE STRING                      06996021
       BC      UNCOND,IDENT        EXIT                                 07002021
EXAM24   CLI   MODE+NX1,MB9                                             07008021
       BC      NOTHI,EXAM05        NUMERIC DISPLAY                      07014021
         CLI   MODE+NX1,MB13                                            07020021
       BC      EQ,EXAM05           STERLING NON-REPORT NUMERIC DISP     07026021
         CLI   DX4(RIN),MFF        IS IT A SPECIAL REGISTER             07032021
         BNE   EXAM25              NO                                   07038021
         BAL   RCS,ERROR           YES                                  07044021
         LA    RW1,ELST73          WRITE ERROR MESSAGE                  07050021
       BC      UNCOND,IDERR        ERROR EXIT                           07056021
EXAM25 EQU     *                                                        07062021
       BAL     RCS,ERROR          USEAGE NOT DISPLAY                    07068021
       LA      RW1,ELST0E                                               07074021
       BC      UNCOND,IDERR        ERROR - DO NOT GENERATE              07080021
               EJECT                                                    07086021
*=2    EOS     PERIOD HANDLING                                          07092021
*******************************************************************     07098021
*                                                                       07104021
*                                                                       07110021
*                                 E O S                                 07116021
*                                                                       07122021
*                                                                       07128021
*      GENERATES LABEL FOR NEXT-SENTENCE (NXTSNT),IF IT HAS BEEN        07134021
*       REFERENCED, AND ALL REMAINING LABELS IN PSHTBL STORED BY        07140021
*       IF AND RELATED ANALYZERS                                        07146021
*                                                                       07152021
*** SUBROUTINES CALLED                                                  07158021
*      GNXTST,SRCHTB,ERROR                                              07164021
*                                                                       07170021
*** ERROR PROCESSING                                                    07176021
*      IF LABELS ARE IN PSHTBL, OR IF NXTSNT IS NOT 0 -- THEN           07182021
*        IF PROGRAM-BREAK OTHER THAN END-DECLARATIVES FOLLOWS, WRIT     07188021
*          MSG AND PROVIDES 'STOP RUN'.                                 07194021
*        IF END-DECLARATIVES, OR SECTION-NAME WITHIN DECLARATIVES,      07200021
*          END-OF-RANGE OF PERFORM FOLLOWS, WRITES MSG THAT 'EXIT'      07206021
*          NEEDED AND PROVIDED.                                         07212021
*     IF PROGRAM BREAK IS SEGMENTATION, THIS IS VALID                   07218021
*                                                                       07224021
*******************************************************************     07230021
       SPACE   3                                                        07236021
       USING   *,RVRB                                                   07242021
EOS    EQU     *                                                        07248021
       BAL   RCS,IFSRCH       BRANCH TO IF...SEARCH               5961  07254021
         NI    IFSW1,MSWOFF        RESET IFSW1                    99997 07260021
         CLC   NXTSNT(LX2),N0      HAS NEXT SENTENCE BEEN CALLED        07266021
       BC      NOTEQ,EOS2           YES                                 07272021
         CLC   DSPUSH(LX2),N0      ARE THERE LABELS IN PSHTBL           07278021
       BC      EQ,EOS12             NO - NO ERRORS                      07284021
EOS2   CLI     GOTTEN,MPND        IS NEXT A PN                          07290021
       BC      EQ,EOS4              YES                                 07296021
         CLC   GOTTEN(LX2),CBDBUG     IS IT DEBUG VERB                  07302021
       BC      EQ,EOS3X            YES                                  07308021
       CLI     GOTTEN,MBREAK      IS IT A PROGRAM-BREAK                 07314021
       BC      NOTEQ,EOS10          NO - NO ERRORS                      07320021
         CLI   GOTTEN+NX1,MENDCL    IS IT END-DECLARATIVES              07326021
       BC    EQ,EOS8A              YES                                  07332021
         CLI   GOTTEN+NX1,SEGBK IS IT SEGMENTATION CONTROL BREAK        07338021
       BC    EQ,EOS10          YES- OK                                  07344021
EOS3   EQU     *                                                        07350021
         CLI   PGMBRK,MDUGPK   ARE WE PROCESSING *DEBUG PACKET          07356021
         BC    EQ,EOS10     YES                                         07362021
       BAL     RCS,ERROR           NO - ERROR                           07368021
       LA      RW1,ELST01           MSG -- ASSUME STOP RUN              07374021
       BC      UNCOND,EOS10        GO TO GENERATE LABELS                07380021
EOS3X    LH    RW1,SAVLHN+NX4      GET ID OF NEXT PN FOR *DEBUG         07386021
         LA    RW1,DX1(RW1)                                             07392021
       STH     RW1,SRCHNM                                               07398021
       OI      SWDBUG,MSWON        TURN DEBUG SWITCH                    07404021
         BC    UNCOND,*+NX10        GO TO SEARCH TABLE                  07410021
EOS4     MVC   SRCHNM(LX2),DX4(RIN) IS IT END OF PERFORM                07416021
       L       RW1,APFMTB                                               07422021
       BAL     RCS,SRCHTB          SEARCH TABLE                         07428021
       BC      UNCOND,EOS6         IS IT 'DEBUG'                        07434021
       LA      RA0,BCDPFD            YES - ERROR, NEED EXIT             07440021
       BC      UNCOND,EOS9         ERROR FOUND                          07446021
EOS6   TM      SWDBUG,MSWON                                             07452021
       BC      ONES,EOS10         (FOR DEBUG WE DONT HAVE PN IN INP     07458021
         TM    DX2(RIN),MSNBIT     IS IT SECTION NAME                   07464021
       BC      ZERO,EOS10           NO - ALL OK                         07470021
       CLI     PGMBRK,MDECL       IS IT USE SECTION                     07476021
        BC    EQ,EOS8A             YES-ERROR - NEED EXIT                07482021
         CLC   NEXSN(LX2,RIN),N0    IS IT LAST OF PROGRAM               07488021
       BC      EQ,EOS3               YES - NEED STOP RUN                07494021
       BC      UNCOND,EOS10           NO - ALL OK                       07500021
EOS8A  LA    RA0,BCDECL                                                 07506021
EOS9   BAL     RCS,ERROR           PROCESS ERROR                        07512021
       LA      RW1,ELST48         MSG -- EXIT NEEDED                    07518021
EOS10  BAL     RCS,GNXTST         GENR ALL PENDING LABELS               07524021
         MVI   SWDBUG,XX00                                              07530021
EOS12    NI    SAVLHN,XX00         ZERO ATTRIBUTES OF LAST LHN          07536021
       NI      PSKPGO,MSWOFF      REINIT SW FOR ELSE                    07542021
       OI      GENRED,MSWON                                             07548021
       BC      UNCOND,IDENT        EXIT                                 07554021
         EJECT                                                          07560021
*=1    GO      VERB                                                     07566021
*******************************************************************     07572021
*                                                                       07578021
*                                   G O                                 07584021
*                                                                       07590021
*** STRINGS PRODUCED                                                    07596021
*                                                                       07602021
*        1. FOR ORDINARY 'GO'                                           07608021
*      GO,1                                                             07614021
*      RHN                                                              07620021
*                                                                       07626021
*        2. FOR ALTERED 'GO'                                            07632021
*      LHN                                                              07638021
*      GO,1                                                             07644021
*      VN          (VN IS FOUND IN VNTBL FOR ID OF LHN)                 07650021
*      EQU,2                                                            07656021
*      VN                                                               07662021
*      RHN                                                              07668021
*                                                                       07674021
*        3. FOR GO-DEPENDING-ON                                         07680021
*      GO-DEP-FIRST,2                                                   07686021
*      N       (RHN COUNT)                                              07692021
*      DATA-NAME                                                        07698021
*      GO-DEP-MIDDLE,1                                                  07704021
*      RHN1                                                             07710021
*      GO-DEP-MIDDLE,1                                                  07716021
*      RHN2                                                             07722021
*      .                                                                07728021
*      .                                                                07734021
*      GO-DEP-LAST,1                                                    07740021
*      RHNN                                                             07746021
*                                                                       07752021
*                                                                       07758021
*** SUBROUTINES CALLED                                                  07764021
*      GETNXT,STOVRB,STOR45,STPNIN,COPYIN,GENDAT,GENSTR,RDUCOP,ISIN     07770021
*      ISOKSC,GOBACK,ERROR                                              07776021
*                                                                       07782021
*                                                                       07788021
*** ERROR PROCESSING                                                    07794021
*      UNALTERED 'GO TO .',STATEMENT SKIPPED                            07800021
*      PROCEDURE-NAME DOES NOT FOLLOW GO(TO),STATEMENT SKIPPED          07806021
*      MISSING 'TO' ASSUMED                                             07812021
*      MISSING 'DEPENDING ON' ASSUMED IF MORE THAN ONE PN FOUND (AN     07818021
*        NON-PN COMPLETES THE SERIES)                                   07824021
*      ILLEGAL DATA-NAME REPLACED BY 'TALLY'                            07830021
*      BRANCH  TO ILLEGAL SECTION, STATEMENT GENERATED AFTER MSG        07836021
*      ALTERED GO-DEPENDING, NO MSG (ALTER WILL WRITE), GENERATE        07842021
*        ORDINARY NON-ALTERED GO STRING                                 07848021
*      ALTERED GO WHICH IS ALSO END-OF-RANGE OF PERFORM, TREAT AS       07854021
*        UNALTERED. LET ALTER ANALYZER WRITE MSG                        07860021
*                                                                       07866021
*                                                                       07872021
*** NOTES                                                               07878021
*      PSKPGO SWITCH IS TURNED ON IN CASES 1 AND 2, TELLING 'ELSE'      07884021
*        NOT TO GENERATE 'GO-TO-NEXT-SENTENCE'                          07890021
*      GOSW1   TURNED ON WHEN 2ND PN IS FOUND,INDICATES 'DEPENDING'     07896021
*              IS REQUIRED                                              07902021
*                                                                       07908021
*      PHASE 1 TURNS ON BIT 0 OF ATTRIBUTES FOR A PN WHICH HEADS A      07914021
*       SINGLE GO (AND THUS CAN BE ALTERED), AND BIT 7 FOR A PN         07920021
*       REFERENCED BY AN ALTER. IDENT SAVES EVERY NEW PNDEF AT SAVL     07926021
*       IF IT IS FOLLOWED BY ANY VERB BUT GO OR EXIT ITS ATTRIBUTES     07932021
*       ZEROED OUT. (GO ITSELF ZEROES THEM ON EXITING.) THUS IT IS      07938021
*       KNOWN THAT ANY GO- OR ALTER-BITS FOUND ARE FOR THE PARAGRAP     07944021
*       OF WHICH THE GO BEING PROCESSED IS THE FIRST VERB               07950021
*                                                                       07956021
*                                                                       07962021
*******************************************************************     07968021
       SPACE   6                                                        07974021
         USING *,RVRB                                                   07980021
GO       EQU   *                                                        07986021
       OI      PSKPGO,MSWON       TELL 'ELSE' NOT TO GENR.'GO-TO-NE     07992021
       BAL     RCS,STOVRB          STORE VERB ROUTINE                   07998021
         MVC   GOCTR(LX2),N1       RESET COUNTER TO 1                   08004021
         CLC   GOTTEN(LX2),CBTO     IS IT COBOL WORD'TO'                08010021
       BC      EQ,GO01             YES                                  08016021
       LA      RA0,CBTO                                                 08022021
       BAL     RCS,ERROR          'TO' MISSING                          08028021
       LA      RW1,ELST07                                               08034021
       BC      UNCOND,GO05         IS IT PERIOD                         08040021
GO01   BAL     RCS,GETNXT          GET THE NEXT ENTITY                  08046021
GO05     CLC   GOTTEN(LX2),CBEOS    IS IT PERIOD                        08052021
       BC      NOTEQ,GO25          NOT PERIOD                           08058021
         TM    LHN+NX2,MALTBT       IS STATEMENT ALTERED                08064021
       BC      ZERO,GO20           NO, ERROR                            08070021
GO10   EQU     *                                                        08076021
         TM    LHN+NX2,MPFMBT       IS ALTERED GO ALSO END-OF-PERFOR    08082021
       BC      ZERO,GO12             NO - OK                            08088021
         CLC   GOTTEN(LX2),CBEOS      YES - SKIP ALTER CODING           08094021
       BC      EQ,IDENT                    EXIT FOR EOS                 08100021
       BC      UNCOND,GO35                 TREAT PN AS UNALTERED        08106021
GO12   LA      RW4,VNREF           STORE VN IN STRING (IDLHN SET IT     08112021
       BAL     RCS,STOR45          STORE IN STRING                      08118021
       LA      RW4,EQUVRB                                               08124021
       BAL     RCS,STOR45          STORE VN IN STRING                   08130021
       LA      RW4,VNREF          STORE - VN(REF) EQU PN(REF)           08136021
       BAL     RCS,STOR45          STORE IN STRING                      08142021
         CLC   GOTTEN(LX2),CBEOS    IS THIS END OF SENTENCE             08148021
       BE    GO21                  YES,GENERATE DUMMY PN REF            08154021
         MVC   TNUMER(LX2),PNIDEN(RIN)   SAVE PN NUM               2962 08160021
         MVC   TPRIOR(LX1),PTYPN(RIN)   SAVE PRIORITY              2962 08166021
       BAL     RCS,STPNIN          STORE P2-TEXT EQUIV. OF ENTITY       08172021
         LA    RW4,TRUREF        GENERATE DUMMY PNREF              2962 08178021
         BAL    RCS,STOR45      FOR ALTERED GO                     2962 08184021
       BAL     RCS,GETNXT         DOES PERIOD FOLLOW THIS GO            08190021
GO15   BAL     RCS,GENSTR          GENERATE STRING                      08196021
       BC      UNCOND,IDENT        EXIT                                 08202021
GO20   BAL     RCS,ERROR           LHN A OR/AND G OFF ILLEGAL STATE     08208021
       LA      RW1,ELST0F                                               08214021
       BC      UNCOND,IDERR        ERROR EXIT                           08220021
GO21   LA    RW4,PNREF1            GET ADDR OF DUMMY PN REF             08226021
       BAL   RCS,STOR45            STORE IN EQU STRING                  08232021
       B     GO15                  GO TO MAIN LINE                      08238021
GO25   CLI     GOTTEN,MPNU         IS IT A PN                           08244021
       BC      EQ,GO30             FIND THE PROCEDURE NAME              08250021
         CLC   GOTTEN(LX1),GNREF    IS IT GN FROM INTERNAL VERBS        08256021
       BC      EQ,GO25X            YES - OK                             08262021
         TM    SAVLHN+NX3,MLABIT                                        08268021
       BC      ZERO,GO26           ERROR                                08274021
         CLC   GOTTEN(LX2),CBMORL  WITHIN LABEL-DECL., MORE-LABELS L    08280021
       BC      NOTEQ,GO26          NO                                   08286021
GO25X  EQU     *                                                        08292021
       BAL     RCS,STOINP          STORE INPUT IN STRING                08298021
       BAL     RCS,GETNXT          GET INPUT                            08304021
       BC      UNCOND,GO82        OK - WIND UP                          08310021
GO26   EQU     *                                                        08316021
       LA      RA0,BCDPN                                                08322021
       BC      UNCOND,IDGVUP       GIVE UP                              08328021
GO30   BAL     RCS,ISOKSC          IS PN IN ALLOWABLE SECTION           08334021
         TM    LHN+NX2,MALTBT       IS STATEMENT AN ALTERED GO          08340021
       BC      ZERO,GO35           NO                                   08346021
         TM    LHN+NX2,MGOBIT       YES,  IS IT A SINGLE GO PARAGRAP    08352021
       BC      ONES,GO10           YES,OK (IF NO,ALTER WILL WRITE M     08358021
GO35   NI      GOSW1,MSWOFF        SET SW OFF                           08364021
         CLC   PTYPN(LX1,RIN),PTYCEL ARE WE GOING TO PN SAME PTY        08370021
       BE    GO38      YES-NORMAL PROCESSING                            08376021
       BAL   RCS,GETALL       SAVE THIS PN AND SEE IF NORMAL GO TO      08382021
       LA    RW2,CURENT      OR GO-DEP-ON                               08388021
       BAL   RCS,GETNXT            GET THE NEXT ENTITY                  08394021
       BAL   RCS,ISEND             IS THIS NORMAL GO                    08400021
        B      GO37           NOT END - SEEK IF DEP.               0009 08406021
*****                                                             47933 08412021
*  GENERATES SEGMENT GO TO                                        47933 08418021
*****                                                             47933 08424021
GO35A    DS    0H                                                 47933 08430021
       L     RIN,ACURNT     NORMAL GO                                   08436021
GO36   BAL    RCS,GENDAT   GENERATE SEGT GO VERB                        08442021
       LA    RW2,GOSEGT                                                 08448021
         MVC   RPRIOR(LX1),PTYPN(RIN)  SET UP PN REF                    08454021
         MVC   RNUMER(LX2),PNIDEN(RIN)                                  08460021
       BAL    RCS,GENDAT           GENERATE PN REFERANCE                08466021
       LA    RW2,PNREF     GENERATE THE RHN                             08472021
       L     RIN,TRUPNT    POINT RIN TO ENDWORD                         08478021
    OI    GENRED,MSWON                                                  08484021
         TM    SEARCHSW,MSWON      IS THIS FROM SEARCH RTN        47933 08490021
         BZ    IDENT               NO,  RETURN TO IDENT RTN       47933 08496021
         OI    GOSW,MSWON          YES, TRUN ON GOSW AND RETURN   47933 08502021
       BC    UNCOND,IDENT          EXIT                                 08508021
GO37    EQU    *                                                   0009 08514021
         TM    SEARCHSW,MSWON      IS THIS FROM SEARCH RTN        47933 08520021
         BO    GO35A               YES,  GO TO GENERATE SEG. GO TO47933 08526021
        L      RIN,ACURNT     ADDR OF SAVED PN                     0009 08532021
        BAL    RCS,STPNIN     STORE SAVED PN IN STRING             0009 08538021
        L      RIN,TRUPNT     POINT RIN BACK TO CURRENT INPUT      0009 08544021
        B      GO40                SEEK IF 'DEPENDING'             0009 08550021
GO38   BAL    RCS,STPNIN           STORE P2 TEXT EQUIV. OF ENTITY       08556021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      08562021
GO40     CLC   GOTTEN(LX2),CBDEPN   IS COBOL WORD 'DEPENDING'           08568021
       BC      EQ,GO86             YES, FOUND 'DEPENDING'               08574021
       CLI     GOTTEN,MPNU         NO -IS IT A PN                       08580021
       BC      EQ,GO90             IT IS A 'PN'                         08586021
       TM      GOTTEN,MOP         IS IT PERHAPS DN,NUMLIT,ETC.          08592021
       BC      ZERO,GO42            NO                                  08598021
       LA      RA0,BCDPN            YES -DISCARD                        08604021
       BAL     RCS,ERROR           ERROR                                08610021
       LA      RW1,ELST38                                               08616021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  08622021
       BC      UNCOND,GO40  SEEK A BETTER ONE                           08628021
GO42   EQU     *                                                        08634021
       TM      GOSW1,MSWON         NOT A PN EITHER                      08640021
       BC    ZERO,GO96             NOT 'DEPENDING'                      08646021
       LA      RA0,CBDEPN                                               08652021
       BAL     RCS,ERROR           'DEPENDING' MISSING OR ILLEGAL       08658021
       LA      RW1,ELST07                                               08664021
GO45     CLC   GOTTEN(LX2),CBON     IS COBOL WORD 'ON'                  08670021
       BC      NOTEQ,GO50          NOT COBOL WORD 'ON'                  08676021
       BAL     RCS,GETNXT          YES IT IS 'ON'  GET NEXT I/P         08682021
GO50   BAL     RCS,RDUCOP         IS IT VALID DATA OPERAND              08688021
       BC      UNCOND,GO70          NO                                  08694021
       L       RW1,ASTRNG           YES - CHANGE LAST VERB TO GODL      08700021
       BAL     RCS,GOBACK          STORE ADDR OF 2ND ENTRY              08706021
       DC      XL2'2'              ADDR OF 2ND ENTRY FROM END           08712021
       L     RW2,ADNTRY                                                 08718021
         MVI   DX1(RW2),GODL                                            08724021
       LR      RW1,RIN                                                  08730021
       CLI     MODE,MB128         IS IT NUMERIC DN                      08736021
       BC      NOTEQ,GO70          NO - ERROR                           08742021
       BAL     RCS,ISINT2         IS IT INTEGER                         08748021
       BC      UNCOND,GO70         NO, DN IS NOT AN INTEGER             08754021
         CLI   DX0(RW1),MSPDN      IS IT SPECIAL NAME LIKE 'TALLY'      08760021
       BC      EQ,GO76             YES, OK                              08766021
         CLI   DX9(RW1),MB4         TEST DECIMAL DIGIT LENGTH OF ITE    08772021
       BC      HI,GO70             IS IT LESS THAN OR EQUAL TO 4        08778021
         TM    DX8(RW1),MB128       TEST BIT 64 IS 1                    08784021
       BC      ZERO,GO76           SCALE IS ZERO, OK                    08790021
       SR      RW2,RW2                                                  08796021
         MVC   SCLVLU+NX1(LX1),DX8(RW1) MOVE SCALE TO HW BOUNDARY       08802021
         NI    SCLVLU+NX1,M7F                                           08808021
         IC    RW2,DX9(RW1)                                             08814021
       AH      RW2,SCLVLU          BIT 64-71 ABS. VALUE + BITS 72-7     08820021
       CH      RW2,N4                                                   08826021
       BC      NOTHI,GO76          IT IS VALID                          08832021
GO70   BAL     RCS,ERROR           GO DEPENDING ON MUST BE FOLLOWED     08838021
       LA      RW1,ELST22          NUMERIC INTEGER DN LESS THAN OR      08844021
       BC      UNCOND,IDERR        ERROR EXIT                           08850021
GO76   EQU     *                  DN IS OK                              08856021
         MVC   ATIB(LX4),ADFSBS    GENR SUBSCRIPTS IF ANY               08862021
       OI      NOTRAL,MSWON       TELL GENALL NO TRAILING BYTE-COUN     08868021
       BAL     RCS,GENALL          WRITE TABLE TO OUTPUT                08874021
       NI      NOTRAL,MSWOFF                                            08880021
         XC    DSPSBS(LX2),DSPSBS                                       08886021
       BAL     RCS,GENDAT         GENR GO-DEPENDING-1ST                 08892021
       LA      RW2,GOD1                                                 08898021
       BAL     RCS,GENDAT          GENR GO-DEPENDING-MIDDLE             08904021
         LA    RW2,GOD1+NX3                                             08910021
       BAL     RCS,COPYIN         COPY INPUT (OBJECT OF 'DEPENDING      08916021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  08922021
       NI      PSKPGO,MSWOFF      ELSE MUST GIVE FALL-THRU BRANCH       08928021
*                                    FOR GO-DEPENDING-ON                08934021
GO82   BAL     RCS,GENSTR          GENERATE STRING AND EXIT             08940021
       BC      UNCOND,IDENT        EXIT FOR EOS                         08946021
GO86   BAL     RCS,GETNXT          FIND COBOL WORD 'DEPENDING'          08952021
       BC      UNCOND,GO45         TEST NEXT GOTTEN IS IT COBOL WOR     08958021
GO90   TM      GOSW1,MSWON                                              08964021
       BC      ONES,GO95           ON, OPTION 2 'GO' STATEMENT          08970021
       OI      GOSW1,MSWON         OFF, TURN IT ON                      08976021
       L       RW1,ASTRNG                                               08982021
         L     RW1,DX0(RW1)         CHANGE 1ST VERB CODE GOD1 TO GOD    08988021
         L     RW1,DX0(RW1)                                             08994021
         MVC   DX0(LX3,RW1),GODM                                        09000021
GO95   LA      RW4,GODM                                                 09006021
       BAL     RCS,STOR45          STORE GODM IN STRING                 09012021
       BAL     RCS,ISOKSC          IS PN IN ALLOWABLE SECTION           09018021
       BAL     RCS,STPNIN         STORE PN IN STRING                    09024021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  09030021
       LH      RW1,GOCTR          UPDATE COUNTER                        09036021
       AH      RW1,N1                                                   09042021
       STH     RW1,GOCTR                                                09048021
       BC      UNCOND,GO40         TEST NEXT DATA FOR 'PN' OR 'DEPN     09054021
GO96   TM    SEARCHSW,MSWON                                             09060021
       BZ    GO82                  OFF. GENERATE STRING AND EXIT        09066021
       OI    GOSW,MSWON            LAST WAS GO                          09072021
       B     GO82                  GENERATE STRING AND EXIT             09078021
               EJECT                                                    09084021
*=1    ALTER   VERB                                                     09090021
*******************************************************************     09096021
*                                                                       09102021
*                                                                       09108021
*                              A L T E R                                09114021
*                                                                       09120021
*                                                                       09126021
*** STRINGS PRODUCED                                                    09132021
*      SOURCE - ALTER PN1 TO PROCEED TO PN2, PN3 TO PROCEED TO PN4,     09138021
*               ... PNM TO PROCEED TO PNN.                              09144021
*      OUTPUT - MOVE-4 PN2 VN1                                          09150021
*               MOVE-4 PN4 VN3                                          09156021
*               .      .   .                                            09162021
*               MOVE-4 PNN VNM                                          09168021
*                                                                       09174021
*                                                                       09180021
*          MOVE-4 IS A  SPECIAL INTERNAL MOVE VERB                      09186021
*          VN1,VN3,VNM ARE VN'S ASSOCIATED IN THE VNTBL WITH PN1,PN     09192021
*           PNN,RESPECTIVELY. THEY ARE ENTERED IN THE TABLE EITHER      09198021
*           DURING ALTER PROCESSING OR WHEN THEY TURN UP AT POINT O     09204021
*           DEFINITION,WHICHEVER OCCURS FIRST.                          09210021
*          WHEN ONE OF THESE THEN TURNS UP PRECEDING A GO (SEE GO       09216021
*           ANALYZER), GO VN RATHER THAN GO PN IS GENERATED.            09222021
*                                                                       09228021
*                                                                       09234021
*** SUBROUTINES CALLED                                                  09240021
*      GETNXT,STOVRB,STOR45,STPNIN,ISOKSC,SRCHTB,PNSRTF,PUPVNC,ERRO     09246021
*                                                                       09252021
*                                                                       09258021
*** ERROR PROCESSING                                                    09264021
*      ASSUME MISSING PARTS OR WHOLE OF 'TO PROCEED TO'                 09270021
*      GIVE UP (LET IDENT WRITE MSG) WHEN ANY OPERAND NOT PN            09276021
*      WRITE MSG BUT GENERATE STRING WHEN PN IS IN ILLEGAL SECTION      09282021
*      SKIP PAIR OF WHICH 1ST PN DOES NOT REFERENCE A SIMPLE 'GO' (     09288021
*                TURNED ON BY PHASE 1)                                  09294021
*      SKIP PAIR OF WHICH 1ST PN  IS END-OF-RANGE OF A PERFORM (BIT     09300021
*        TURNED ON BY PHASE 1)                                          09306021
*                                                                       09312021
*                                                                       09318021
*** NOTES                                                               09324021
*      ALTSW1 PREVENTS GENERATION IF 1ST PN OF PAIR IS NOT A 'GO'       09330021
*      ALTSW2 PRVENTS PROLIFERATION OF MESSAGES ABOUT 'TO-PROCEED-T     09336021
*                                                                       09342021
*                                                                       09348021
*******************************************************************     09354021
       SPACE   6                                                        09360021
         USING *,RVRB                                                   09366021
ALTER    EQU   *                                                        09372021
       BAL     RCS,STOVRB          STORE VERB ROUTINE                   09378021
       NI      ALTSW1,MSWOFF       TURN SWITCHES OFF                    09384021
       NI      ALTSW2,MSWOFF                                            09390021
*                                                                       09396021
*      IS ENTITY 1ST PN OF PAIR                                         09402021
*                                                                       09408021
ALT    CLI     GOTTEN,MPNU              IS IT PN 1,3,5,ETC.             09414021
       BC      EQ,ALT2             YES                                  09420021
*                                                                       09426021
*          PN NOT FOUND - END OF ALTER STATEMENT                        09432021
*                                                                       09438021
       BAL     RCS,ISEND          IS IT END                             09444021
         BC    UNCOND,*+NX8         NO, GIVE UP                         09450021
       BC      UNCOND,IDENT         YES - OK                            09456021
       LA      RA0,BCDPN            NO - MSG AND GIVE UP                09462021
       BC      UNCOND,IDGVUP       DISCARD TILL ENDWORD                 09468021
*                                                                       09474021
*              1ST PN OF PAIR FOUND                                     09480021
*                                                                       09486021
*                                                                       09492021
ALT2     TM    DX2(RIN),MGOBIT     IS ALTERED PN THAT OF A GO PARAGR    09498021
       BC      ZERO,ALT60           NO- ERROR                           09504021
         TM    DX2(RIN),MPFMBT     YES, BUT IS IT END OF PERFORM        09510021
       BC      ONES,ALT65             YES- ERROR,SKIP                   09516021
       BAL     RCS,GETALL         SAVE FOR COMPARISON WITH PN2          09522021
       LA      RW2,CURENT                                               09528021
         MVC   SRCHNM(LX2),DX4(RIN)                                     09534021
       L       RW1,AVNTBL                                               09540021
       BAL     RCS,SRCHTB         IS IT IN VNTBL                        09546021
         BC    UNCOND,*+NX8         NO                                  09552021
       BC      UNCOND,ALT5         YES                                  09558021
       BAL     RCS,PNSRTF          NO - PUT IT IN                       09564021
         LA    RW4,DX4(RIN)                                             09570021
       BAL     RCS,PUPVNC         UPDATE VN COUNTER                     09576021
       BAL     RCS,PNSRTF          UPDATE ADDR OF TABLE                 09582021
       LA      RW4,VNNUM                                                09588021
ALT5     MVC   VNID(LX2),VNNUM MOVE IT TO ITS HEADER                    09594021
         MVC   VNPTY(LX1),PTYPN(RIN) MOVE IN THE PRIORITY NUM OF PN1    09600021
       TM    SEGLM,NONSEG    IS PROGRAM SEGMENTED                       09606021
       BO    ALT10         NO-EXIT                                      09612021
       CLI   VNPTY,INDEP      IS ALTERED PN IN INDEP SEGT               09618021
       BL    ALT10            NO-OK                                     09624021
         CLC   VNPTY(LX1),PTYCEL                                        09630021
       BE    ALT10                 PRIORITY EQUAL                       09636021
       B     ALT71            UNEQUAL INDEP PRIORITIES-ERROR            09642021
ALT10  NI    GENRED,MSWOFF                                              09648021
         MVC   TNUMER(LX2),PNIDEN(RIN)                             2962 09654021
         MVC   TPRIOR(LX1),PTYPN(RIN)                              2962 09660021
       BAL   RCS,GETNXT            GET NEXT INPUT DATA                  09666021
*                                                                       09672021
*                 SEEK 'TO-PROCEED-TO'                                  09678021
*                                                                       09684021
         CLC   GOTTEN(LX2),CBTO     IS COBOL WORD 'TO'                  09690021
       BC      EQ,ALT15            YES                                  09696021
       OI      ALTSW2,MSWON        SET SW 2 ON FOR ERROR MESSAGE        09702021
         CLC   GOTTEN(LX2),ERSYMB   IS IT ERROR                         09708021
         BC    EQ,ALT15            YES-DISCARD                          09714021
       BC      UNCOND,ALT20        NO - NOT ERROR                       09720021
ALT15  BAL     RCS,GETNXT          GET THE NEXT ENTITY                  09726021
ALT20    CLC   GOTTEN(LX2),CBPRCD   IS COBOL WORD PROCEED               09732021
       BC      EQ,ALT25            YES                                  09738021
         CLC   GOTTEN(LX2),ERSYMB   IS IT ERROR                         09744021
         BC    EQ,ALT25            YES-DISCARD                          09750021
       BC    UNCOND,ALT40           PROCESS PN S                        09756021
ALT25  BAL     RCS,GETNXT          GET THE NEXT ENTITY                  09762021
ALT30    CLC   GOTTEN(LX2),CBTO     IS COBOL WORD 'TO'                  09768021
       BC      EQ,ALT35            YES                                  09774021
       OI      ALTSW2,MSWON                                             09780021
         CLC   GOTTEN(LX2),ERSYMB   IS IT ERROR                         09786021
         BC    EQ,ALT35            YES-DISCARD                          09792021
       BC      UNCOND,ALT40        NO                                   09798021
ALT35  BAL     RCS,GETNXT          GET NEXT ENTITY                      09804021
*                                                                       09810021
*              SHOULD MSG BE WRITTEN ABOUT MISSING COBOL WORDS          09816021
*                                                                       09822021
ALT40  TM      ALTSW1,MSWON                                             09828021
       BC      ONES,ALT45          ALTSW1 ON, MSG SAID 'SKIPPING'       09834021
       TM      ALTSW2,MSWON        OFF    REF. 'GO'                     09840021
       BC      ZERO,ALT45          OFF, COBOL WORD ARE OK               09846021
       LA      RA0,BCDTPR                                               09852021
       BAL     RCS,ERROR           TO OR/AND PROCCED MISSING            09858021
       LA      RW1,ELST07                                               09864021
       NI      ALTSW2,MSWOFF       TURN OFF SWITCH 2                    09870021
*                                                                       09876021
*                IS NEXT ENTITY 2ND PN OF PAIR                          09882021
*                                                                       09888021
ALT45  CLI     GOTTEN,MPNU         IS IT PN 4,6,8 ETC.                  09894021
       BC      NOTEQ,ALT62         NOT SECOND PN                        09900021
       TM      ALTSW1,MSWON                                             09906021
       BC      ZERO,ALT50            OFF, GOOD PNS.                     09912021
       NI      ALTSW1,MSWOFF       C BIT 4 IS ZERO, PN IS NOT STORE     09918021
       OI      GENRED,MSWON                                             09924021
       BC      UNCOND,ALT55        GO DISCARD                           09930021
ALT50    XC    CURENT+NX3(LX4),DX3(RIN) (3 RIN HAS DECL BITS, 6 RIN HAS 09936021
         TM    CURENT+NX3,MLABRP      WAS ONE LABEL OR RPT DECL,OTHE    09942021
       BC      ZERO,ALT54          NO                                   09948021
ALT52  BAL     RCS,ERROR          WARNING MESSAGE                       09954021
       LA      RW1,ELST10                                               09960021
ALT54  BAL     RCS,STPNIN         STORE PN2 IN STRING                   09966021
       LA      RW4,VNREF          STORE ITS VN FROM TABLE               09972021
       BAL     RCS,STOR45          STORE VN IN STRING                   09978021
         LA    RW4,TRUREF        GENER DUMMY PNREF                 2962 09984021
         BAL   RCS,STOR45        FOR P1 FOR XREF                   2962 09990021
       BAL   RCS,GENSTR            GENERATE VERB-STRING TABLE           09996021
       BAL     RCS,STOVRB          PUT VERB BACK IN STRING              10002021
ALT55  BAL     RCS,GETNXT          SEEK NEXT PAIR OF PN,S.              10008021
       BC      UNCOND,ALT          PROCESS NEXT PAIR OF PNS             10014021
*                                                                       10020021
*      ERROR - 1ST PN OF PAIR IS NOT THAT OF A 'GO' STATEMENT           10026021
*                                                                       10032021
ALT60  BAL     RCS,ERROR           ALTERED PN NOT OF GO PARAGRAPH       10038021
       LA      RW1,ELST1F                                               10044021
       BC      UNCOND,ALT70       DISCARD REST OF THIS PAIR             10050021
*                                                                       10056021
*      ERROR - 2ND OPERAND OF PAIR IS NOT A PN                          10062021
*                                                                       10068021
ALT62  LA      RA0,BCDPN                                                10074021
       BAL     RCS,ERROR           NOT A PN                             10080021
       LA      RW1,ELST32                                               10086021
       NI      ALTSW1,MSWOFF                                            10092021
       BAL     RCS,ISEND           IS THIS AN END OF 1 PAIR             10098021
       BC      UNCOND,ALT55        YES                                  10104021
       BC      UNCOND,IDERR        NO - ERROR                           10110021
*                                                                       10116021
*              ERROR - ALTERED PN IS END OF PERFORM ALSO                10122021
*                                                                       10128021
ALT65  BAL     RCS,ERROR           WRITE ERROR MESSAGE                  10134021
       LA      RW1,ELST21                                               10140021
ALT70  OI      ALTSW1,MSWON       SWITCH SAYS DISCARD REST OF THIS      10146021
       BC      UNCOND,ALT10        SKIP PAIR - GET NEXT ENTITY          10152021
ALT71  BAL   RCS,ERROR             PRIORITIES NOT EQUAL - ERROR         10158021
       LA    RW1,ELST62                                                 10164021
       B     ALT70                 DISCARD REST OF PAIR                 10170021
       EJECT                                                            10176021
IKF40B CSECT                                                            10182021
*=1    PRFORM  VERB                                                     10188021
*******************************************************************     10194021
*                                                                       10200021
*                                                                       10206021
*                            P R F O R M                                10212021
*                                                                       10218021
*                                                                       10224021
*      THE PN USED AS END-OF-RANGE (THE ONE AFTER 'THRU',OR THE ONL     10230021
*       ONE IF THERE IS NO 'THRU')  WAS   GIVEN A PERFORM-BIT IN IT     10236021
*       ATTRIBUTES BY PHASE 1. WHEN PHASE 4 FIRST COMES UPON IT,        10242021
*       WHETHER AS A LHN OR HERE IN THE PERFORM, IT PUTS THIS PN-ID     10248021
*       AND A NEW VN-NUMBER IN THE VNTBL. THIS VN-NUMBER IS THE ONE     10254021
*       REFERRED TO BELOW AS 'RETURN-VN'. IT IS THE SAME ONE ENTERE     10260021
*       IN THE PFMTBL ALONG WITH THE PN-ID OF THE 1ST PN AFTER THE      10266021
*       END-OF-RANGE OF THE PERFORM (THIS PROCESSING IS DONE BY IDE     10272021
*       WHICH PRODUCES THE CODING TO COME BACK AFTER A PERFORM, NAM     10278021
*       'GO VN').                                                       10284021
*                                                                       10290021
*                                                                       10296021
*** STRINGS PRODUCED (OPTIONS 1-3)                                      10302021
*                                                                       10308021
*      OPTION 1. PERFORM PN1 (THRU PN4).                                10314021
*                           MOVE RETURN-VN PFMSAV-N                     10320021
*                           MOVE GN-N RETURN-VN                         10326021
*                           GO PN1                                      10332021
*                      GN-N MOVE PFMSAV-N RETURN-VN                     10338021
*                                                                       10344021
*      OPTION 2. PERFORM PN1 (THRU PN4) X TIMES.                        10350021
*                           MOVE RETURN-VN PFMSAV-N                     10356021
*                           MOVE GN-N RETURN-VN                         10362021
*                           GO-TIMES PN1 X   (SPECIAL GO-VERB)          10368021
*                      GN-N MOVE PFMSAV-N RETURN-VN                     10374021
*                                                                       10380021
*      OPTION 3. PERFORM PN1 (THRU PN4) UNTIL A = B .                   10386021
*                           MOVE RETURN-VN PFMSAV-N                     10392021
*                           MOVE GN-N RETURN-VN                         10398021
*                      GN-N = A B GN-TRUE                               10404021
*                           GO PN1                                      10410021
*                   GN-TRUE MOVE PFMSAV-N RETURN-VN                     10416021
*                                                                       10422021
*                                                                       10428021
*      STRINGS FOR OPTION 4 WITH'VARYING' ARE DETAILED ABOVE THE CO     10434021
*        AT LOC VARY.                                                   10440021
*                                                                       10446021
*                                                                       10452021
*** SUBROUTINES CALLED                                                  10458021
*      GETNXT,GETALL,SAVNXT,STOR45,STLOOP,GENSTR,GENLAB,GENLST,GENG     10464021
*      GENMOV,GNARTH,PUPIR,PUPVNC,PUPLGN,INSERT,PNSRTF,PZSTRT,SRCHT     10470021
*      ISOKSC,ISEND,RDUCOP,OKPFOP,PMKTAL,DECMAX,GETPVN,ERROR            10476021
*                                                                       10482021
*                                                                       10488021
*** ERROR PROCESSING                                                    10494021
*      IF PN DOESNT FOLLOW VERB SKIP WHOLE STATEMENT                    10500021
*      IF PN DOESNT FOLLOW 'THRU' IGNORE 'THRU', CONSIDER STATEMENT     10506021
*       ENDED                                                           10512021
*      IF PN AFTER 'THRU' IS DEFINED AS PRECEDING PN BEFORE 'THRU',     10518021
*       GIVE WARNING BUT PROCESS NORMALLY                               10524021
*      IF THE 'THRU' PN (OR SINGLE PN) IS ALSO ALTERED PROCESS NORM     10530021
*       WITHOUT MSG. ALTER ANALYZER WILL ISSUE IT AND DELETE THE AL     10536021
*      IF EITHER PN IS IN ILLEGAL SECTION GIVE MSG BUT PROCESS NORM     10542021
*      ASSUME OPTION 1 IF 'VARYING', 'UNTIL', OR OPERAND DOES NOT       10548021
*       FOLLOW LAST PN (LET IDENT WRITE MSG IF IT IS GARBAGE)           10554021
*      ASSUME OPTION 2 IF OPERAND FOLLOWS. IF OPERAND ILLEGAL, SUBS     10560021
*       TUTE 'TALLY'                                                    10566021
*      ASSUME 'TIMES' IF MISSING IN OPTION 2                            10572021
*      ERRORS BETWEEN'UNTIL' AND END-OF-STATEMENT OR 'AFTER' ARE        10578021
*       HANDLED BY THE IF ANALYZER                                      10584021
*      WITHIN OPTION 4, ASSUME 'FROM', 'BY', 'UNTIL' IF MISSING WHE     10590021
*                        EXPECTED                                       10596021
*                       SUBSTITUTE 'TALLY' FOR ILLEGAL OPERANDS         10602021
*                       WARN BUT PROCESS VARIATIONS AFTER 3RD           10608021
*                                                                       10614021
*                                                                       10620021
*** NOTES                                                               10626021
*      PFMSAV-N IS A UNIQUE SAVE-AREA RESERVED BY UPPING THE PSVCTR     10632021
*        COMMON. GN'S ARE  PRODUCED AS NEEDED BY UPPING THE GNCTR.      10638021
*                                                                       10644021
*      FOR ALL OPTIONS, IDENT WILL PRODUCE JUST BEFORE PN2 (OR BEFO     10650021
*        PN5 IF THERE WAS 'THRU PN4')                                   10656021
*                                                                       10662021
*                           GO RETURN-VN                                10668021
*                           EQU RETURN-VN PN2 (OR PN5)                  10674021
*                                                                       10680021
*                                                                       10686021
*                                                                       10692021
*      CONDITIONS FOLLOWING 'UNTIL' ARE EVALUATED BY IF. BEFORE CAL     10698021
*        IF, PRFORM EFFECTIVELY NEGATES THE ENTIRE CONDITION, BECAU     10704021
*        HERE ONE FALLS THRU WHEN THE CONDITION FAILS, WHEREAS IN A     10710021
*        ORDINARY IF-STATEMENT ONE FALLS THRU IF THE CONDITION SUCC     10716021
*                                                                       10722021
*      PERFSW ON DIRECTS IF TO RETURN TO PRFORM RATHER THAN IDENT A     10728021
*        TO ACCEPT 'AFTER' AS A TERMINATOR.                             10734021
*                                                                       10740021
*      VARYSW FOR OPTIONS 1-3 IS USED TO SIGNIFY WHICH OPTION WAS       10746021
*        FOUND IN ORDER TO GENERATE WHATEVER IS SPECIAL TO ANY OPTI     10752021
*        (E.G., THE GO-TIMES VERB, OR THE RETURN-GN PRECEDING A         10758021
*        CONDITION.)                                                    10764021
*                                                                       10770021
*      SORTSW  ON SAYS CALL WAS FROM SORT. NOTHING IS GENERATED AND     10776021
*        RETURN IS TO SORT ANALYZER                                     10782021
*                                                                       10788021
*                                                                       10794021
*******************************************************************     10800021
       SPACE   5                                                        10806021
       SPACE   5                                                        10812021
*                                                                       10818021
*                                 PROCESS PN1 AND PN2                   10824021
*                                                                       10830021
       DS      0H                                                       10836021
       USING   *,RVRB                                                   10842021
       USING   CONDGN,RW2                                               10848021
PRFORM EQU     *                                                        10854021
       NI    SPSEGT,MSWOFF                                              10860021
         XC    VARYSW(LX2),VARYSW    INITIALIZE OPTION SWITCH           10866021
       LA      RA0,BCDPN          PARAM FOR POSSIBLE MSG 32             10872021
       CLI     GOTTEN,MPNU        IS INPUT A PN                         10878021
       BC      EQ,PERF2            YES                                  10884021
         XC    SORTSW(LX1),SORTSW NO - GIVE UP                          10890021
       BC      UNCOND,IDGVUP       GIVE UP PROCESSING                   10896021
PERF2  EQU     *                                                        10902021
         TM    SORTSW,MSWON        IS FROM SORT                   50782 10908021
         BZ    PERF4               NO                             50782 10914021
         TM    DX2(RIN),MSNBIT     SECTION NAME                   50782 10920021
         BO    PERF4               YES OK                         50782 10926021
         LA    RA0,BCDSEC          MSG PARM                       50782 10932021
         BAL   RCS,ERROR           WRITE E MSG                    50782 10938021
         LA    RW1,ELST83                                         50782 10944021
PERF4    DS    0H                                                 50782 10950021
         MVC   SNUMER(LX2),PNIDEN(RIN) MOVE PN NUM INTO SAVEPN          10956021
         MVC   SPRIOR(LX1),PTYPN(RIN) MOVE PRIORITY NUM INTO SAVEPN     10962021
         MVC   THRUPN(LX10),PROCED(RIN) SAVE PN TO SEARCH TABLES        10968021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      10974021
         CLC   GOTTEN(LX2),CBTHRU    DOES 'THRU' FOLLOW                 10980021
       BC    NOTEQ,PERF12          NO                                   10986021
         OI    THRUSW,MSWON     INDICATE THAT THRU FOLLOWS         2962 10992021
       BAL     RCS,GETNXT           YES - DOES ANOTHER PN               10998021
       CLI     GOTTEN,MPNU                                              11004021
       BC      NOTEQ,PERF8          NO- ERROR,DISCARD THRU              11010021
          MVC   TNUMER(LX2),PNIDEN(RIN)                            2962 11016021
         MVC   TPRIOR(LX1),PTYPN(RIN)    SAVE PRIORITY OF PN2      2962 11022021
         CLC   PNIDEN(LX2,RIN),SNUMER IS PN AFTER 'THRU' GT PN1         11028021
       BC    NOTLO,PERF6            NO - OK                             11034021
       BAL   RCS,ERROR              YES - WARNING                       11040021
       LA      RW1,ELST24                                               11046021
PERF6    MVC   THRUPN(LX10),PROCED(RIN) USE 2ND PN TO SEARCH TABLES     11052021
       BAL     RCS,GETNXT         DISCARD PN2                           11058021
       BC    UNCOND,PERF12         PROCESS VN                           11064021
PERF8  LA      RA0,CBTHRU                                               11070021
       BAL     RCS,ERROR          MSG. NO PN AFTER 'THRU'               11076021
       LA      RW1,ELST25                                               11082021
         NI    THRUSW,MSWON        RESET THRU SW                  12345 11088021
         LA    RA0,BCDPN           PARAM FOR MSG 50               12345 11094021
         B     IDGVUP              DISCARD STATEMENT              12345 11100021
*                                                                       11106021
*                                 PN'S PROCESSED.  PUT OUT              11112021
*              MOVE VN PFMSAV                                           11118021
*                                                                       11124021
PERF12 EQU     *                                                        11130021
       BAL     RCS,GETPVN          GET VN                               11136021
         MVC   SVNID(LX2),VNNUM SAVE VNNUM                              11142021
         MVC   SVNPTY(LX1),THRPTY AND PTY OF THRUPN                     11148021
       L       RW1,COSADR         GET A NEW PFMSAV NUMBER               11154021
       LH    RW2,PSVCTR                                                 11160021
         LA    RW2,DX1(RW2)                                             11166021
       STH   RW2,PSVCTR                                                 11172021
         STH   RW2,PFMSAV+NX2                                           11178021
       BAL     RCS,STLOOP         STORE MOVE-VN-PFMSAV                  11184021
       DC    XL2'3'                STORE  3 ELEMENTS                    11190021
       LA      RW4,MOVEVN                                               11196021
       LA      RW4,SAVEVN                                               11202021
       LA      RW4,PFMSAV                                               11208021
*                     DETERMINE WHICH OPTION                            11214021
*                                                                       11220021
PERFLR BAL   RCS,ISEND     IS THIS END OF PERFORM (OPT 1)               11226021
         BC    UNCOND,*+NX8         NO                                  11232021
       BC      UNCOND,PERF24        YES                                 11238021
         CLC   GOTTEN(LX2),CBUNTL  IS IT UNTIL (OPTION 3)               11244021
       BC      EQ,PERF22            YES                                 11250021
         CLC   GOTTEN(LX2),CBVARY  IS IT VARYING (OPTION 4)             11256021
       BC      EQ,VARY              YES                                 11262021
       BAL     RCS,RDUCOP         IS IT OPERAND                         11268021
       BC      UNCOND,PERF24         NO-ASSUME OPTION 1                 11274021
       OI      INTGSW,MSWON       TELL OKPFOP MUST FIND INTEGER         11280021
       BAL     RCS,OKPFOP           YES - OPTION 2. SEE THAT N IS O     11286021
*                                                                       11292021
*                                 PROCESS OPTIONS 1 - 3                 11298021
*                                                                       11304021
         MVI   VARYSW,XX02         SET SW = 2 FOR OPTION 2              11310021
       BC      UNCOND,PERF24       GET NEW GN FOR OPTION 2              11316021
PERF22   MVI   VARYSW,XX03         SET SW = 3 FOR OPTION 3              11322021
PERF24 BAL     RCS,PUPLGN         GET A NEW GN NUMBER                   11328021
         MVC   GNREF+NX1(LX2),NXTLGN                                    11334021
         MVC   TEMP(LX4),SAVEVN     VN NOW GIVEN PTY OF PTYCEL          11340021
         MVC   TEMP+NX1(LX1),PTYCEL                                     11346021
       BAL     RCS,STLOOP        STORE MOVE-GN-VN (RETURN FROM PERF     11352021
       DC    XL2'3'                STORE  3 ELEMENTS                    11358021
       LA      RW4,MOVEVN                                               11364021
       LA      RW4,GNREF                                                11370021
       LA    RW4,TEMP                                                   11376021
         CLI   VARYSW,XX02         WHICH OPTION                         11382021
       BC      LO,PERF30            OPTION 1                            11388021
       BC      EQ,PERF35            OPTION 2                            11394021
         MVC   GNDEF+NX1(LX2),NXTLGN  OPTION 3                          11400021
       BAL     RCS,GENSTR         CLEAR STRING (SORT NEVER USES)        11406021
       BAL     RCS,GENLAB       GENR RETURN-VN BEFORE CONDITION         11412021
       BAL     RCS,UNTIL               GO GENR STRINGS FOR CONDITIO     11418021
*BEFORE ISSUEING A GO PN1 WE MUST CHECK PTY OF PN1                      11424021
*COMPARING IT TO CURRENT PTY TO DETERMINE CORECT GO VERB                11430021
*AND TO PUT OUT INITIALIZATION VERB WHEN NECESSARY                      11436021
PERF30 BAL RCS,PFMGOPN1            CHECK PRIORITY OF PN1                11442021
       BC      UNCOND,PERF40       CHECK SWITCH OPTION                  11448021
PERF35 BAL     RCS,STLOOP         GENR  GOTIMES-N-PN1 FOR OPTION 2      11454021
       DC    XL2'3'                STORE  3 ELEMENTS                    11460021
       LA      RW4,GOTIME                                               11466021
       LA      RW4,SAVEPN                                               11472021
         LA    RW4,DX0(RIN)                                             11478021
PERF40   CLI   VARYSW,XX02         WHICH OPTION                         11484021
       BC      HI,PERF45            3                                   11490021
       BC      LO,PERF43            1                                   11496021
       BAL     RCS,GETNXT           2 -- DOES 'TIMES' FOLLOW            11502021
         CLC   GOTTEN(LX2),CBTIME                                       11508021
       BC      EQ,PERF42           TIMES - DISCARD                      11514021
       LA      RA0,CBTIME         NO - ERROR, ASSUME IT                 11520021
       BAL     RCS,ERROR           WARNING MESSAGE                      11526021
       LA      RW1,ELST07                                               11532021
       BC      UNCOND,PERF43       OPTION 1 OR 2                        11538021
PERF42 BAL     RCS,GETNXT         DISCARD 'TIMES                        11544021
PERF43   MVC   GNDEF+NX1(LX2),GNREF+NX1 FOR OPTIONS 1 AND 2             11550021
       LA      RW4,GNDEF          STORE RETURN-GN AS LGN                11556021
       BAL     RCS,STOR45          STORE ENTITY IN STRING               11562021
       BC      UNCOND,ENDPFM       END OF PERFORM, PUT OUT              11568021
PERF45 BAL     RCS,GENSTR           3- GENR STRINGS                     11574021
       BAL     RCS,GENLST            GENR PSHTBL LABELS FROM IF         11580021
       BC      UNCOND,ENDPFM       END OF PERFORM, PUT OUT              11586021
*                                                                       11592021
*                                                                       11598021
*                          'UNTIL' FOUND                                11604021
*                                                                       11610021
*                   GO TO IF TO EVALUATE CONDITION                      11616021
*                                                                       11622021
*                                                                       11628021
UNTIL  EQU     *                                                        11634021
       STM     RCS,RW6,SVUNTL     SAVE REGISTERS (IF USES THEM)         11640021
       OI      PERFSW,MSWON       TELL 'IF' TO ACCEPT 'AFTER' AND       11646021
*                                   RETURN TO UNTIL2                    11652021
       BAL     RCS,GETNXT         DISCARD 'UNTIL'                       11658021
       L       RVRB,AIF           GO TO IF TO PRODUCE STRINGS FOR       11664021
       BCR     UNCOND,RVRB          CONDITION                           11670021
UNTIL2 NI      PERFSW,MSWOFF                                            11676021
       LM      RCS,RW6,SVUNTL                                           11682021
       BCR     UNCOND,RCS          RETURN                               11688021
*                                                                       11694021
*                                                                       11700021
*              END OF ALL PERFORMS. PUT OUT                             11706021
*                                                                       11712021
*              MOVE-PFMSAV-VN  (FROM VNTBL)                             11718021
*                                                                       11724021
*                                                                       11730021
*      NOTE THAT FOR OPTIONS 3 AND 4, WHICH CALL IF, STRINGS HAVE B     11736021
*       GENERATED. FOR OPTIONS 1 AND 2 THEY ARE MERELY STORED. WHEN     11742021
*       CALL TO PERFORM IS FROM SORT, THEY ARE LEFT IN STRING TABLE     11748021
*       SORT ANALYZER TO HANDLE.                                        11754021
ENDPFM EQU     *                                                        11760021
       BAL     RCS,STLOOP         STORE MOVE-PFMSAV-VN                  11766021
       DC    XL2'3'                STORE  3 ELEMENTS                    11772021
       LA      RW4,MOVEVN                                               11778021
       LA      RW4,PFMSAV                                               11784021
       LA      RW4,SAVEVN                                               11790021
         TM    THRUSW,MSWON      IS IT OPTION 'THRU'               2962 11796021
         BC    ZERO,ENDPFR       NO - GET OUT                      2962 11802021
         LA    RW4,TRUREF        YES-GENERATE DUMMY PNREF          2962 11808021
          BAL   RCS,STOR45       FOR THRU FOR XREF                 2962 11814021
         NI    THRUSW,MSWOFF                                       2962 11820021
ENDPFR   NI    PERFSW,MSWOFF     OFF PERFSW TESTED IN IF           2962 11826021
       NI    INTGSW,MSWOFF                                              11832021
       TM      SORTSW,MSWON      WAS PERFORM CALLED BY SORT             11838021
       BC      ONES,ENDPFS         YES                                  11844021
       BAL     RCS,GENSTR         NO - GENR STRINGS AND EXIT            11850021
       BC      UNCOND,IDENT        EXIT                                 11856021
       USING   SORT,RVRB                                                11862021
ENDPFS EQU     *                                                        11868021
       L       RVRB,ASORT           YES - RETURN TO SORT ANALYZER       11874021
         BC    UNCOND,SORBAK       RETURN TO SORT                       11880021
       USING   PRFORM,RVRB                                              11886021
*                                                                       11892021
*                                                                       11898021
*      PFMGOPN1                                                         11904021
*    CHECKS PRIORITY OF SAVEPN  (PN1)                                   11910021
*    ISSUES GO TO PN1  ACCORDING TO ITS                                 11916021
*   PRIORITY                                                            11922021
*   BAL   RCS,PFMGOPN1                                                  11928021
*   (RETURN)                                                            11934021
*                                                                       11940021
*                                                                       11946021
PFMGOPN1 EQU *                                                          11952021
       ST    RCS,PFMGOSV                                                11958021
         CLC   SPRIOR(LX1),PTYCEL COMPARE PRIORITIES                    11964021
       BE    PFMGO4    NORMAL GO VERB                                   11970021
PFMGO2 BAL   RCS,STLOOP            STORE THE 2 ENTITIES                 11976021
       DC    XL2'2'                STORE  2 ELEMENTS                    11982021
       LA    RW4,GOSEGT    INIT NOT NEEDED SEGT GO                      11988021
       LA    RW4,SAVEPN    STORE THE PN                                 11994021
       B     PFMGO3                PN TO STORE                          12000021
PFMGO4 BAL   RCS,STLOOP            STORE THE 2 ENTITIES                 12006021
       DC    XL2'2'                STORE  2 ELEMENTS                    12012021
       LA    RW4,CBGO                                                   12018021
       LA    RW4,SAVEPN                                                 12024021
PFMGO3 L     RCS,PFMGOSV                                                12030021
       BR    RCS                   RETURN                               12036021
       SPACE   5                                                        12042021
         EJECT                                                          12048021
*                                                                       12054021
*                                 OPTION 4 -- VARYING                   12060021
*                                                                       12066021
       SPACE   3                                                        12072021
*                                                                       12078021
*                                                                       12084021
*      THE STRINGS PRODUCED FOR OPTION 4 ARE, FOR EXAMPLE -             12090021
*                                                                       12096021
* PERFORM PN1 (THRU PN4) VARYING                                        12102021
*  X FROM N1 BY N2          X FROM N1 BY N2          X FROM N1 BY N     12108021
*    UNTIL A=B.               UNTIL A=B AFTER          UNTIL A=B AF     12114021
*                           Y FROM N3 BY N4          Y FROM N3 BY N     12120021
*                             UNTIL C=D.               UNTIL C=D AF     12126021
*                                                    Z FROM N5 BY N     12132021
*                                                      UNTIL E=F.       12138021
*                                                                       12144021
*                                                                       12150021
*        MOVE VN1 PFMSAV        MOVE VN1 PFMSAV       MOVE VN1 PFMS     12156021
*        MOVE N1 X              MOVE N1 X             MOVE N1 X         12162021
*        GO INIT1               GO INIT1              GO INIT1          12168021
*                                                                       12174021
* PLUS1. ADD N2 X         PLUS1.ADD N2 X        PLUS1.ADD N2 X          12180021
* COND1.= A B  TRUE1      COND1.= A B TRUE1     COND1.= A B TRUE1       12186021
*                               GO COND2              GO COND 2         12192021
*                                                                       12198021
*                         MOVE2.MOVE N3 Y       MOVE2.MOVE N3 Y         12204021
*                               GO VN2                GO VN2            12210021
*                         PLUS2.ADD N4 Y        PLUS2.ADD N4 Y          12216021
*                         COND2.= C D TRUE2     COND2.= C D TRUE2       12222021
*                                                     GO COND3          12228021
*                                                                       12234021
*                                               MOVE3.MOVE N5 Z         12240021
*                                                     GO VN3            12246021
*                                               PLUS3.ADD N6 Z          12252021
*                                               COND3.= E F TRUE3       12258021
*                                                                       12264021
*                                                                       12270021
*        GO PN1                 GO PN1                GO PN1            12276021
*                                                                       12282021
*                                                                       12288021
*                         INIT1.MOVE INIT2 VN2  INIT1.MOVE INIT2 VN     12294021
*                               GO MOVE2              MOVE MOVE3 VN     12300021
*                                                     GO MOVE2          12306021
*                                                                       12312021
* INIT1. MOVE PLUS1 VN1   INIT2.MOVE PLUS1 VN2  INIT2.MOVE PLUS1 VN     12318021
*        GO COND1               MOVE PLUS2 VN1        MOVE PLUS2 VN     12324021
*                               GO COND1              MOVE PLUS3 VN     12330021
*                                                     GO COND1          12336021
*                                                                       12342021
*                                               TRUE3.GO MOVE3          12348021
*                         TRUE2.GO MOVE2        TRUE2.GO MOVE2          12354021
*                                                                       12360021
* TRUE1. MOVE PFMSAV      TRUE1.MOVE PFMSAV     TRUE1.MOVE PFMSAV       12366021
*         VN1                    VN1                   VN1              12372021
*                                                                       12378021
*******************************************************************     12384021
*      (ALL LABELS IN THE EXAMPLES ABOVE ARE GN'S. VN1 IS THE RETUR     12390021
*        VN.)                                                           12396021
*                                                                       12402021
*      IF MORE THAN 3 DATA-NAMES ARE VARIED,A WARNING IS ISSUED BUT     12408021
*        CORRECT GENERATION (ON THE SAME PATTERN) CONTINUES.            12414021
*                                                                       12420021
*      THE VN COUNTER IS INCREMENTED ONCE FOR EACH LEVEL AFTER 1.       12426021
*      THE GN COUNTER IS INCREMENTED 3 TIMES FOR EACH LEVEL OF VARI     12432021
*       TION, AND ONCE MORE IF INIT2 IS NEEDED. LABELS ARE SAVED IN     12438021
*       TAMER-TABLE VARYTB IN THE FOLLOWING ORDER                       12444021
*                                                                       12450021
*                COND1      *                                           12456021
*                INIT1      * LEVEL 1 (INIT1 HAS POSITION OF UNUSED     12462021
*                PLUS1      *                                           12468021
*                                                                       12474021
*                MOVE2       *                                          12480021
*                COND2       * LEVEL 2                                  12486021
*                VN2         *                                          12492021
*                PLUS2       *                                          12498021
*                                                                       12504021
*                MOVE3        *                                         12510021
*                COND3        * LEVEL 3                                 12516021
*                VN3          *                                         12522021
*                PLUS3        *                                         12528021
*                                                                       12534021
*                .                                                      12540021
*                .                                                      12546021
*                .                                                      12552021
*                .                                                      12558021
*                MOVEN            *                                     12564021
*                CONDN            *  LEVEL N                            12570021
*                VN-N             *                                     12576021
*                PLUSN            *                                     12582021
*                                                                       12588021
*                INIT2                ( HAS POSITION OF MOVE FOR N+     12594021
*                      (UNUSED)                                         12600021
*                VN1        (RETURN-VN)                                 12606021
*                                                                       12612021
*                                                                       12618021
*        RW6  KEEPS TRACK OF THE NUMBER OF DN'S VARIED.                 12624021
*        WHENEVER RW6 GOES UP,RW2 (THE POINTER TO VARYTB)IS INCREME     12630021
*        BY 12. RW2 IS KEPT POINTING TO THE COND-LABEL OF THE CURRE     12636021
*        LEVEL.                                                         12642021
*                                                                       12648021
*      THE 4 LABELS ARE DEFINED WITH SYMBOLIC NAMES UNDER A 'USING      12654021
*        REFERENCE TO THEIR SYMBOLIC NAMES CAUSES THEM TO BE ADDRES     12660021
*        AT THE CURRENT LEVEL IN VARYTB.                                12666021
*                                                                       12672021
*        TRUE1,TRUE2,ETC., STAND FOR THE LABEL(S) PRODUCED BY IF AN     12678021
*          PLACED IN PSHTBL AS BYPASS BRANCHES FOR THE GIVEN CONDIT     12684021
*                                                                       12690021
*                                                                       12696021
       SPACE   3                                                        12702021
VARY   EQU     *                                                        12708021
       BAL     RCS,GENSTR         CLEAR OUT STRING (SORT NEVER USES     12714021
         LA    RW6,DX1             RW6 IS VARYING COUNTER. INIT AT 1    12720021
       NI      ERVASW,MSWOFF      OFF ERROR SWITCH FOR TOO MANY VAR     12726021
*VARYVN IS GN 1ST TIME- VN OTHER TIMES- DIFFERENT                       12732021
*LENGTH AND PRIORITY NUMBER IN VN NECESSITATE CHECK FOR 1ST TIME        12738021
       OI    VRY1ST,MSWON     TURN ON SWITCH FOR 1ST VARYING            12744021
         MVI   VARYSW+NX1,XX0C     SET VARYSW TO COLLECT DATA-NAME      12750021
         XC    DRSULT+NX1(LX1),DRSULT TURN OFF ROUND OPTION FOR ADD     12756021
         MVI   EVAL+NX2,XX02         AND SIZE-ERROR OPTION              12762021
       BAL     RCS,PZSTRT          REINITIALIZE TAMER TABLES            12768021
       LA    RW1,AVARYT                                                 12774021
*                                                                       12780021
*              INITIALIZE BRANCH-TABLE FOR FIRST VARYING                12786021
*                                                                       12792021
       L       RW1,AVARYT                                               12798021
         MVI   DX0(RW1),XX06   TEMPORARILY GIVE TIB COUNT FOR 2 ENTR    12804021
       ST      RVRB,VRBASE                                              12810021
       L       RAS,ANSERT     MAKE ROOM FOR 1ST COND. AND INIT. BRA     12816021
       BALR    RCS,RAS             INITIALIZE TABLE                     12822021
       L     RVRB,VRBASE          RESTORE BASE                          12828021
         LA    RW3,DX6(RW3)                                             12834021
       STH     RW3,DSPVAR         SAVE DISPL.                           12840021
         MVI   DX0(RW1),XX0C   RESTORE TO TIB NORMAL COUNT FOR 4 ENT    12846021
       BAL     RCS,PUPLGN        MOVE 2 NEW GN-NUMBERS TO TABLE         12852021
         MVC   DX1(LX2,RW2),NXTLGN                                      12858021
       BAL     RCS,PUPLGN          UPDATE GN NUMBER                     12864021
         MVC   DX4(LX2,RW2),NXTLGN                                      12870021
         MVC   DX0(LX1,RW2),GNREF  MOVE IN THEIR HEADERS                12876021
         MVC   DX3(LX1,RW2),GNREF                                       12882021
*                                                                       12888021
*      FOR EACH VARYING SET UP BRANCHES AND PUT OUT --                  12894021
*                                                                       12900021
*              MOVE NI DN                                               12906021
*              GO VN                                                    12912021
*      PLUSGN  ADD N2 DN                                                12918021
*      CONDGN                                                           12924021
*                                                                       12930021
VARY10 L       RW1,AVARYT         MAKE ROOM FOR NEXT 4 BRANCHES IN      12936021
       ST      RVRB,VRBASE                                              12942021
       L       RAS,ANSERT           TABLE                               12948021
       BALR    RCS,RAS             INITIALIZE TABLE                     12954021
       L     RVRB,VRBASE                                                12960021
         LA    RW3,DX12(RW3)                                            12966021
       STH     RW3,DSPVAR         SAVE DISPL.                           12972021
*                                                                       12978021
         MVC   DX0(LX1,RW2),GNREF   PUT 3 GN HEADERS IN TABLE           12984021
         MVC   DX3(LX1,RW2),GNREF                                       12990021
         MVC   DX6(LX1,RW2),GNREF                                       12996021
         MVC   DX9(LX1,RW2),VNREF    PUT VN HEADER IN 4TH SLOT          13002021
       SH      RW2,N6            POINT RW2 TO COND BRANCH FOR THIS      13008021
       BAL     RCS,PUPLGN         CREATE GN FOR PLUS GN                 13014021
         MVC   PLUSGN+NX1(LX2),NXTLGN                                   13020021
*                                                                       13026021
       BAL     RCS,VAROPS         GERR MOVE-N1-DN                       13032021
       TM    VRY1ST,MSWON    IS FIRST VARYING                           13038021
       BC    ONES,INITVY    YES                                         13044021
         MVC   VNID(LX2),VARYVN+NX1 NO- MOVE VN NUMBER INTO VNREF       13050021
         MVC   VNPTY(LX1),PTYCEL PRIORITY OF SECTION PERFORM IS  IN     13056021
       BAL   RCS,GENGO   GENR GO-VN                                     13062021
       LA    RW1,VNREF                                                  13068021
       BC    UNCOND,GNPLUS         GENR PLUSGN AS GN                    13074021
INITVY   MVC   GNSAV(LX3),PLUSGN          1ST PLUSGN                    13080021
         BAL   RCS,GENGO      GENREATE GO GN                            13086021
       LA      RW1,VARYVN                                               13092021
GNPLUS   MVC   GNDEF+NX1(LX2),PLUSGN+NX1 GENR PLUSGN AS LGN             13098021
       BAL     RCS,GENLAB          GENERATE LABEL                       13104021
         CH    RW6,N3                                                   13110021
         BE   VARY56          EQUAL                                     13116021
         MVC   GNSAV+3(LX3),PLUSGN                                      13122021
         MVC   VNSAV+2(LX2),VARYVN+1                                    13128021
         MVC   VNSAV+1(LX1),PTYCEL                                      13134021
VARY14   BAL   RCS,VAROPS                                               13140021
         MVC   GNDEF+NX1(LX2),CONDGN+NX1 GENR CONDGN AS LGN             13146021
       BAL     RCS,GENLAB          GENERATE LABEL                       13152021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  13158021
         CLC   GOTTEN(LX2),CBUNTL IS NEXT 'UNTIL'                       13164021
       BC      EQ,VARY15           YES                                  13170021
       LA      RA0,CBUNTL           NO - ERROR. ASSUME IT               13176021
       BAL     RCS,ERROR           WARNING MESSAGE                      13182021
       LA      RW1,ELST07                                               13188021
       OI      NEXTIN,MSWON      ('UNTIL' WILL GET NEXT)                13194021
VARY15 BAL     RCS,UNTIL             GO TO IF TO EXPAND AND GENR CO     13200021
         CLC   GOTTEN(LX2),CBAFTR  DOES'AFTER' FOLLOW CONDITION         13206021
       BC      NOTEQ,VARY30          NO - VARYINGS ARE FINISHED         13212021
*                                                                       13218021
*                                 'AFTER' FOUND                         13224021
*                                                                       13230021
*              FOR EACH 'AFTER' SET UP NEW VN AND GENR --               13236021
*                                                                       13242021
*              GO CONDGN (OF NEXT VARYING)                              13248021
*      MOVEGN                     NOTE. 1ST VARY HAS NO LGN ON MOVE     13254021
*                                                                       13260021
       CH      RW6,N3             HAVE THERE BEEN 3 VARYINGS            13266021
       BC      LO,VARY25            NO-OK                               13272021
       TM      ERVASW,MSWON         YES-ERROR                           13278021
       BC      ONES,VARY25            DONT WRITE MSG MORE THAN ONCE     13284021
       OI      ERVASW,MSWON                                             13290021
       BAL     RCS,ERROR           ERROR                                13296021
       LA      RW1,ELST23           WARNING                             13302021
VARY25 BAL     RCS,PUPLGN         CREATE GN FOR MOVE OF THIS            13308021
         MVC   MOVEGN+NX1(LX2),NXTLGN  LEVEL AND CONDITION OF NEXT      13314021
       BAL     RCS,PUPLGN          CREATE GN                            13320021
         MVC   CONDGN+NX13(LX2),NXTLGN                                  13326021
       BAL     RCS,GENGO          GENR GO-CONDGN                        13332021
         LA    RW1,CONDGN+NX12                                          13338021
         MVC   GNDEF+NX1(LX2),MOVEGN+NX1 GENR MOVEGN AS LGN             13344021
       BAL     RCS,GENLAB          GENERATE LABEL                       13350021
         LA    RW6,DX1(RW6)        INCREMENT VARYING COUNTER            13356021
       BAL     RCS,PUPVNC         GET NEW VN NUMBER,PUT IN TABLE        13362021
         MVC   VARYVN+NX13(LX2),VNNUM                                   13368021
       NI    VRY1ST,MSWOFF    TURN OFF SWITCH 1ST VARY                  13374021
       BC      UNCOND,VARY10      LOOP BACK                             13380021
*                                                                       13386021
*                                                                       13392021
*                                 END OF VARYINGS.  GENR --             13398021
*                                                                       13404021
*              GO PN1                                                   13410021
*                                                                       13416021
*                                                                       13422021
*BEFORE ISSUEING A GO PN1 WE MUST CHECK PTY OF PN1                      13428021
*COMPARING IT TO CURRENT PTY TO DETERMINE CORECT GO VERB                13434021
*AND TO PUT OUT INITIALIZATION VERB WHEN NECESSARY                      13440021
VARY30 BAL RCS,PFMGOPN1            CHECK PRIORITY OF PN1                13446021
       BAL   RCS,GENSTR            GENERATE STRING                      13452021
         MVC   VARYVN+NX13(LX2),SVNID MOVE VN FROM VNTBL TO VARYTB      13458021
*                                                                       13464021
*                                                                       13470021
*      GENR INITIALIZATIONS FOR VN'S                                    13476021
*                                                                       13482021
*                                                                       13488021
       L       RW5,AVARYT         SET RW5 TO START ADDR. OF BRANCH      13494021
         L     RW5,DX0(RW5)          TABLE FOR USE IN BXH               13500021
         L     RW5,DX0(RW5)                                             13506021
         LA    RW2,DX0(RW2)        ZERO 1ST BYTE -- SAFETY FOR BXH      13512021
         LA    RW5,DX0(RW5)                                             13518021
       LH      RW4,NDEC12         SET RW4 = -12 (1 BRANCH GROUP)FOR     13524021
       LNR     RW4,RW4                                                  13530021
         MVC   GNDEF+NX1,DX4(RW5)  GENR INITV1                          13536021
       BAL     RCS,GENLAB          GENERATE LABEL                       13542021
       LR      RW3,RW2            SAVE RW2 TO RESTORE AFTER LOOPS       13548021
       CH      RW6,N1             HOW MANY VARYINGS                     13554021
       BC      EQ,VARY50          ONLY 1 - GO INIT. THE ONLY VN         13560021
*                                                                       13566021
       BAL     RCS,PUPLGN         CREATE BRANCH FOR INIT2               13572021
         MVC   MOVEGN+NX1(LX2),NXTLGN                                   13578021
VARY45   MVC   VNID(LX2),VARYVN+NX1 SET UP VN FOR OUTPUT                13584021
         MVC   VNPTY(LX1),PTYCEL                                        13590021
       BAL   RCS,GENMOV   GENR MOVE MOVE-GN- VN FOR EACH VARYING        13596021
       LA      RW1,MOVEGN            EXCEPT 1ST                         13602021
       LA    RW1,VNREF                                                  13608021
         ST    RW2,RW2SAV                                               13614021
         BAL   RCS,GENDAT     WRITE TO FILE                             13620021
         LA    RW2,EQUVRB     SOURCE ADDR                               13626021
         BAL   RCS,GENDAT     WRITE TO FILE                             13632021
         LA    RW2,VNREF      VN REF                                    13638021
         BAL   RCS,GENDAT     WRITE TO FILE                             13644021
         LA    RW2,MOVEGN                                               13650021
         L     RW2,RW2SAV                                               13656021
       BXH     RW2,RW4,VARY45      SET UP VN                            13662021
       LR      RW2,RW3            RESTORE RW2 TO LAST GROUP             13668021
       BAL     RCS,GENGO          GENR GO-MOVEGN (OF 2ND VARY)          13674021
         LA    RW1,DX9(RW5)                                             13680021
         MVC   GNDEF+NX1(LX2),MOVEGN+NX1 GENR INITV2 AS LGN             13686021
       BAL     RCS,GENLAB          GENERATE LABEL                       13692021
*                                                                       13698021
VARY50 EQU     *                                                        13704021
       SH      RW5,NDEC12        (SET RW5 TO GO THRU LOOP ONCE MORE     13710021
VARY55 EQU     *                                                        13716021
         MVC   VNID(LX2),VARYVN+NX13 SET UP VN REF                      13722021
         MVC   VNPTY(LX1),PTYCEL                                        13728021
       BAL     RCS,GENMOV         GENR MOVE-PLUSGN-VN FOR EACH VARY     13734021
       LA      RW1,PLUSGN                                               13740021
       LA    RW1,VNREF                                                  13746021
       BXH   RW2,RW4,VARY55        SET UP VN                            13752021
       LR    RW2,RW3               RESTORE RW2 TO LAST GROUP            13758021
       BAL     RCS,GENGO          GENR GO-CONDGN (OF 1ST VARY)          13764021
         LA    RW1,DX12(RW5)                                            13770021
       BC      UNCOND,VARY65       GENERATE BRANCHES                    13776021
VARY56   MVC   VNSAV+6(LX2),VARYVN+1                                    13782021
         MVC   VNSAV+5(LX1),PTYCEL                                      13788021
         BAL   RCS,GENMOV     GENERATE ALTER GN TO VN                   13794021
         LA    RW1,GNSAV+3                                              13800021
         LA    RW1,VNSAV+4                                              13806021
         BAL   RCS,GENMOV     GENERATE ALTER GN TO VN                   13812021
         LA    RW1,GNSAV                                                13818021
         LA   RW1,VNSAV                                                 13824021
         B     VARY14         GO TO PROCESS VARYING                     13830021
*                                                                       13836021
*      PUT OUT BRANCHES IN PSHTBL PRODUCED BY UNTIL -                   13842021
*                                                                       13848021
VARY60 BAL     RCS,GENGO          GENR GO-MOVEGN OF CORRESPONDING V     13854021
       LA      RW1,MOVEGN                                               13860021
VARY65 BAL     RCS,GENLST         GENR BRANCHES                         13866021
       BXH     RW2,RW4,VARY60     PUT OUT A GO FOR EACH VARY EXCEPT     13872021
       BC      UNCOND,ENDPFM       GENR OUTPUT-END OF PERFORM           13878021
*                                                                       13884021
       DROP    RW2                                                      13890021
*      (SO THAT REFERENCES WITHIN VAROPS ARE ALL TO BASE REGISTER R     13896021
       SPACE   5                                                        13902021
*                                                                       13908021
*      SUBROUTINE TO PROCESS THE 3 OPERANDS OF 'VARYING'                13914021
*                                                                       13920021
*      BAL     RCS,VAROPS                                               13926021
*      (RETURN)                                                         13932021
*                                                                       13938021
*      VARYSW KNOWS WHICH OPERAND IS TO BE PROCESSED                    13944021
*       IF IT = 12   IT IS THE VARIED DATA-NAME                         13950021
*               4              FROM-VALUE                               13956021
*               8              BY-VALUE                                 13962021
*                                                                       13968021
*      VARYSW IS INITIALIZED AT 12 WHEN 'VARYING IS FOUND. FROM THE     13974021
*        ON, VAROPS ITSELF SETS IT BEFORE EXIT.                         13980021
*                                                                       13986021
VAROPS EQU     *                                                        13992021
       STM     RCS,RW1,SVVROP                                           13998021
       LH    RW1,VARYSW           SW FOR TRANSFER VECTOR                14004021
*                                                                       14010021
*                                 INITIAL STEPS                         14016021
*                                                                       14022021
VROP12 BAL     RCS,GETNXT         GET OPERAND                           14028021
VROP15 BAL     RCS,OKPFOP         MAKE SURE OK (USE TALLY IF NOT)       14034021
       BC    UNCOND,*(RW1)        BRANCH ACCORDING TO FUNCTION          14040021
       BC      UNCOND,VROP25          (PRODUCE MOVE STRING)             14046021
       BC      UNCOND,VROP30          (PRODUCE ADD STRING)              14052021
*                                                                       14058021
*      FIRST USE OF VAROPS, PROCESS VARIED DATA-NAME                    14064021
*                                                                       14070021
         XC    LEFTSS(LX2),LEFTSS  INIT GNARTH VALUES POSSIBLY CLOBB    14076021
         XC    LEFTDP(LX2),LEFTDP     BY IF                             14082021
       TM      MODE,MLITBT        IS IT DATA-NAME                       14088021
       BC      ZERO,VROP20          YES - OK                            14094021
       BAL     RCS,ERROR            NO, LITERAL                         14100021
       LA      RW1,ELST26                                               14106021
       BAL     RCS,PMKTA2           SUBSTITUTE TALLY                    14112021
VROP20   MVC   LEFTSS(LX2),DSPSBS  SAVE SS DISPL. FOR ADD-STRING LAT    14118021
         MVC   DRSULT(LX1),DCURR    .      DRSULT  .   .    .           14124021
         MVC   DMAX(LX1),DCURR     INIT  DMAX      .   .    .           14130021
       BAL     RCS,GETALL          MOVE ENTITY TO SAVE AREA             14136021
       LA      RW2,PSTFLD         MOVE TO PSTFLD                        14142021
       BAL     RCS,GETALL          SAVE THE ENTITY                      14148021
       LA      RW2,PRSULT         MOVE TO PRSULT TO SAVE FOR MOVE S     14154021
         LA    RW1,DX4             SET SW TO PRODUCE MOVE STRING NEX    14160021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      14166021
         CLC   GOTTEN(LX2),CBFROM  DOES 'FROM' FOLLOW                   14172021
       BC      EQ,VROP12           YES, GO PROCESS N1                   14178021
       LA      RA0,CBFROM          NO - ERROR, ASSUME IT                14184021
       BAL     RCS,ERROR           WRITE MESSAGE - WARNING              14190021
       LA      RW1,ELST07                                               14196021
       BC      UNCOND,VROP15       IS OPERAND OK                        14202021
*                                                                       14208021
*      2ND OPERAND  FOUND. PRODUCE MOVE STRING                          14214021
*                                                                       14220021
VROP25   TM    INDSW1,MSWON        INDEX NAME ?                         14226021
       BZ    VROP26         PRODUCE MOVE STRING                         14232021
         NI    INDSW1,MSWOFF       INDEX NAME ILLEGAL FOR OP3           14238021
       BAL   RCS,STLOOP             SET OP1 TO OP2                      14244021
       DC    XL2'3'                3 ENTITIES TO BE STORED              14250021
       LA    RW4,SETP2                                                  14256021
       LA    RW4,PRSULT                                                 14262021
         LA    RW4,DX0(RIN)                                             14268021
       B     VROP27                PRODUCE STRING                       14274021
VROP26 BAL   RCS,STLOOP            STORE 3 ELEMENTS IN STRING           14280021
       DC    XL2'3'                STORE  3 ELEMENTS                    14286021
       LA      RW4,MOVEVB      MOVE                                     14292021
         LA    RW4,DX0(RIN)         N1                                  14298021
       LA      RW4,PRSULT       DN                                      14304021
VROP27 BAL   RCS,GENSTR            GENERATE STRING                      14310021
         MVI   VARYSW+NX1,XX08     SET SW TO PRODUCE ADD STRING NEXT    14316021
       L     RW1,ADFSBS           SET DISPL OF DEFSBS TABLE TO INCL     14322021
         L     RW1,DX0(RW1)         SUBSCRIPTED DN IN THE ADD STRING    14328021
         MVC   DX4(LX2,RW1),LEFTSS                                      14334021
         MVC   DSPSBS(LX2),LEFTSS                                       14340021
         XC    STRCNT(LX2),STRCNT  SAVE STARTING DEFSBS DISPL           14346021
       BAL     RCS,DUPSS          DUPLICATE SS FOR STORE-TERM OF AD     14352021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      14358021
         CLC   GOTTEN(LX2),CBBY    DOES 'BY' FOLLOW                     14364021
       BC      EQ,VROP50            YES-RETURN TO MAIN BODY TO GENR     14370021
       LA      RA0,CBBY                BRANCH AND LGN FOR ADD           14376021
       BAL     RCS,ERROR            NO - ERROR,ASSUME IT                14382021
       LA      RW1,ELST07                                               14388021
       OI      NEXTIN,MSWON        SAVE THIS -- MAY BE N2               14394021
       BC      UNCOND,VROP50          EXIT TO MAIN ROUTINE              14400021
*                                                                       14406021
*      3RD OPERAND FOUND. PRODUCE ADD STRING                            14412021
*                                                                       14418021
VROP30 BAL     RCS,DECMAX         UPDATE DMAX                           14424021
       CLI   PRSULT,MINDNM         IS INDEX NAME BEING VARIED           14430021
       BE    VROP31                YES                                  14436021
       BAL     RCS,PUPIR          GET NEW IR                            14442021
       BAL     RCS,STLOOP   STORE IN STRING                             14448021
       DC    XL2'7'                STORE  7 ELEMENTS                    14454021
       LA      RW4,ADDVRB          ADD                                  14460021
         LA    RW4,DX0(RIN)         N2                                  14466021
       LA      RW4,PRSULT         DN                                    14472021
       LA      RW4,IR              IR                                   14478021
       LA      RW4,PSTVRB         STORE                                 14484021
       LA      RW4,IR              IR                                   14490021
       LA      RW4,PSTFLD          DN                                   14496021
       BAL     RCS,GNARTH         GENERATE WITH EVAL AND IR INFO        14502021
VROP32 BAL   RCS,PZSTRT            CLEAR TABLES                         14508021
       LA    RW2,ASTRNG                                                 14514021
       LA    RW1,ADFSBS                                                 14520021
         MVI   VARYSW+NX1,XX0C    SET SW FOR 1ST OPERAND OF NEXT VAR    14526021
*                                                                       14532021
*                           EXIT TO MAIN ROUTINE                        14538021
*                                                                       14544021
VROP50 LM      RCS,RW1,SVVROP                                           14550021
       BCR     UNCOND,RCS          EXIT TO MAIN RTN                     14556021
VROP31 BAL   RCS,STLOOP            STORE IN STRING                      14562021
       DC    XL2'3'                3 ENTITIES TO BE STORED              14568021
       LA    RW4,SETUP                                                  14574021
       LA    RW4,PRSULT      SET OP1 UP BY OP2                          14580021
         LA    RW4,DX0(RIN)                                             14586021
       BAL   RCS,GENSTR            GENERATE STRING                      14592021
       B     VROP32                CLEAR TABLES BEFORE EXIT             14598021
*                                                                       14604021
*              LABEL DEFINITIONS FOR VARYTB ENTRIES                     14610021
*                 D U M M Y - DONT USE OUTSIDE OF THIS ROUTINE          14616021
*                                                                       14622021
       ORG     *-12                ORIGIN FOR VARYTB                    14628021
CONDGN DS    3C                    DUMMY FOR CONDITIONAL  GN            14634021
VARYVN DS    3C                    DUMMY FOR VARYVN                     14640021
PLUSGN DS    3C                    DUMMY FOR INCR GN                    14646021
MOVEGN DS    3C                    DUMMY MOVEGN                         14652021
       EJECT                                                            14658021
*=1    STOP    VERB                                                     14664021
*******************************************************************     14670021
*                                                                       14676021
*                                                                       14682021
*                                 STOP                                  14688021
*                                                                       14694021
*                                                                       14700021
*** STRING PRODUCED                                                     14706021
*      SOURCE - STOP OP                                                 14712021
*      OUTPUT - STOP OP                                                 14718021
*                                                                       14724021
*                                                                       14730021
*** SUBROUTINES CALLED                                                  14736021
*      GETNXT,RDUCOP,STOVRB,STOINP,GENSTR,ERROR                         14742021
*                                                                       14748021
*                                                                       14754021
*** ERROR PROCESSING                                                    14760021
*      IF NEITHER 'RUN' NOR LITERAL NOR FIGCON FOLLOWS,SKIP STATEME     14766021
*      IF 'RUN' IS FOUND IN DECLARATIVE SECTION OTHER THAN ERROR-       14772021
*       PROCESSING,GENERATE ANYHOW                                      14778021
*                                                                       14784021
*                                                                       14790021
*** NOTES                                                               14796021
*                                                                       14802021
*                                                                       14808021
*      IF 'STOP RUN' IS FOUND,PSKPGO SWITCH IS TURNED ON, TELLING       14814021
*             'ELSE' NOT TO GENERATE 'GO-TO-NEXT-SENTENCE'              14820021
*                                                                       14826021
*                                                                       14832021
*******************************************************************     14838021
       SPACE   6                                                        14844021
         USING *,RVRB                                                   14850021
STOP   EQU   *                                                          14856021
       BAL     RCS,STOVRB          STORE VERB                           14862021
       BAL     RCS,RDUCOP         IS IT A VALID DATA-OPERAND AT ALL     14868021
       BC      UNCOND,STOP1         NO                                  14874021
       TM      MODE,MLITBT                                              14880021
       BC      ONES,STOP2           YES                                 14886021
       BC      UNCOND,STOP4       ILLEGAL OPERAND                       14892021
STOP1    CLC   GOTTEN(LX2),CBRUN   IS IT 'RUN'                          14898021
       BC      NOTEQ,STOP4        NEITHER 'RUN' NOR LIT - ERROR         14904021
       OI      PSKPGO,MSWON       AVOID 'GO NEXT' IN ELSE               14910021
*                                                                       14916021
*              OPERAND FOUND                                            14922021
*                                                                       14928021
STOP2  BAL     RCS,STOINP    GENER STRING AND EXIT                      14934021
       BAL     RCS,GENSTR          GENERATE STRING                      14940021
       BAL     RCS,GETNXT          GET THE NEXT ENTITY                  14946021
       BC      UNCOND,IDENT       GETNXT. EXIT                          14952021
*                                                                       14958021
*                                 ERRONEOUS OPERAND                     14964021
*                                                                       14970021
STOP4  BAL     RCS,ERROR           SKIP THE STMNT & WRITE MSG           14976021
       LA      RW1,ELST04                                               14982021
       BC      UNCOND,IDERR        ERROR EXIT                           14988021
*                                                                       14994021
         EJECT                                                          15000021
*=1    ARITH   VERBS ADD,SUBTRACT,MULTIPLY,DIVIDE                       15006021
*                                                                       15012021
*                                                                       15018021
*******************************************************************     15024021
*                                                                       15030021
*                                                                       15036021
*                           ADD, SUBTR,MULT,DIV                         15042021
*                                                                       15048021
*      RW6 IS LOADED WITH 0 FOR ADD, 2 FOR SUBTR, 4 FOR MULT,6 FOR      15054021
*                                                                       15060021
*        AND ALL ARE PROCESSED BY SAME ANALYZER. AT END OF STMNT ST     15066021
*        CALLED TO PROCESS STORE AND SIZE-ERROR AND TO GENR STRINGS     15072021
*                                                                       15078021
*      ARITH JUDGES BY THE VALUE OF RW6 WHICH COBOL WORDS TO LOOK F     15084021
*        WHETHER MULTIPLE OPERANDS ARE LEGAL, WHEN 'GIVING' CAN BE      15090021
*        EXPECTED, ETC.                                                 15096021
*                                                                       15102021
*                                                                       15108021
*      N O T E .  PHASE 3 COPIES THE SOURCE FORM OF AN ADD- OR          15114021
*       SUBTRACT-CORRESPONDING STATEMENT BEFORE THE EXPANSIONS. THE     15120021
*       END OF A SERIES OF EXPANSIONS IS MARKED BY THE COBOL WORD       15126021
*       'CORRESPONDING', ADDED BY PHASE 3.                              15132021
*                                                                       15138021
*                                                                       15144021
*** STRINGS PRODUCED   (BY STORAN)                                      15150021
*                                                                       15156021
*  EVAL               EVAL          EVAL            EVAL                15162021
*  OPN                OPN           OP3(OR OP2)     OP3(OR OP2)         15168021
*  ADD,5              ADD,5         MULT,5          DIV,5               15174021
*  OP1                OP1           OP1             OP1                 15180021
*  OP2                OP2           OP2             OP2                 15186021
*  IR1                IR1           IR1             IR1                 15192021
*  +                  +             ST              ST                  15198021
*  OP3                OP3           OP3(OR OP2)     OP3(OR OP2)         15204021
*  ADD,5              ADD,5         STORE,2         STORE,2             15210021
*  IR1                IR1           IR1             IR1                 15216021
*  OP3                OP3           OP3(OR OP2)     OP3(OR OP2)         15222021
*  IR2                IR2                                               15228021
*  +                  +(OR - IF NEXT VERB IS SUBTR)                     15234021
*  OP4                OP4                                               15240021
*  .                  .                                                 15246021
*  .                  .                                                 15252021
*  ADD,5            SUBTR,5                                             15258021
*  IRK              IRK                                                 15264021
*  OPM              OPM                                                 15270021
*  IRL              IRL                                                 15276021
*  ST               ST                                                  15282021
*  OPN              OPN                                                 15288021
*  STORE,2          STORE,2                                             15294021
*  IRL              IRL                                                 15300021
*  OPN              OPN                                                 15306021
*                                                                       15312021
*                                                                       15318021
*** SUBROUTINES CALLED                                                  15324021
*      GETNXT,GETALL,STOVRB,STOINP,STOR45,RDUCOP,ISOPAR,ISOPST,PMKT     15330021
*      DECMAX,PUPIR,PREMVV,PNSRTF,GOBACK,OPERR,ERROR                    15336021
*                                                                       15342021
*                                                                       15348021
*** ERROR PROCESSING                                                    15354021
*      ASSUME MISSING 'BY','INTO'. ASSUME MISSING 'TO' OR 'FROM' ON     15360021
*       WITHIN ADD OR SUBTR CORRESPONDING.                              15366021
*      SUBSTITUTE 'TALLY' FOR ILLEGAL OPERANDS                          15372021
*      SKIP STATEMENT IF OPERAND MISSING OR IF 'FROM' OR 'TO (GIVIN     15378021
*       MISSING IN ORDINARY SUBTR OR ADD                                15384021
*      GIVE WARNING BUT ACCEPT 'ADD ... TO ... GIVING...'               15390021
*                                                                       15396021
*                                                                       15402021
*** NOTES                                                               15408021
*      SEE COMMENTS ON MOVE ANALYZER FOR USE OF DRYRUN,CORRSW,OP1(2     15414021
*       IN PROCESSING CORRESPONDING OPTION                              15420021
*      WHEN 'ROUNDED' IS FOUND BIT IS SET IN EVAL STRING                15426021
*      EXIT IS TO STORAN TO FORM EVAL STRING AND PROCESS SIZE ERROR     15432021
*      SUBTRACT WITH MULTIPLE OPERANDS PRODUCES A SERIES OF ADD STR     15438021
*       ONLY THE LAST USES THE SUBTRACT VERB                            15444021
*      DMAX IS COMPUTED FOR ALL OPERANDS INCLUDING STORE-FIELD,         15450021
*       E X C E P T  DENOMINATOR OF DIVIDE AND SOURCE FORM OF COR-      15456021
*       RESPONDING. DECIMAL PLACES OF STORE-FIELD GOES TO DRSULT.       15462021
*      FINAL RESULT (LAST IR) IS MOVED TO PRSULT, STORE-FIELD TO PS     15468021
*      WHEN STORE-FIELD IS IDENTICAL TO LAST ADDEND (SUBTRAHEND,ETC     15474021
*       I.E., WHEN 'GIVING' IS NOT PRESENT -- AND IS SUBSCRIPTED, T     15480021
*       SS DEFINING STRINGS WITH DISTINCT ID'S ARE PRODUCED. THE FI     15486021
*       GOES WITH THE LAST ARITHMETIC STRING, THE SECOND WITH THE S     15492021
*       STRING.                                                         15498021
*      WHEN MULTIPLE STOREFIELDS ARE PRESENT IN ADD AND                 15504021
*      SUBTRACT STATEMENTS AND THERE ARE 2 OR MORE OPERANDS             15510021
*      BEFORE THE 'TO', A TR IS MOVED INTO PSTFLD THE FIRST             15516021
*      TIME THUS STORING THE LAST IR BEFORE THE TO IN TR. CONTROL       15522021
*      IS RETURNED TO THIS ROUTINE FROM STORAN IF RECSW                 15528021
*      IS ON, INDICATING MORE THAN ONE STOREFIELD.  IN THE              15534021
*      CASE WHERE TR IS USED, TR IS ADDED TO EACH STOREFIELD            15540021
*      SPECIFIED IN SOURCE.  IF 1 OP PRECEDES 'TO', VERB AND OP1        15546021
*      DISPLACEMENT IN STRING AND DSP IN DEFSBS FOR OP1 ARE             15552021
*      SAVED IN LEFTDP AND LEFTSS AND ADDED TO EACH STOREFIELD.         15558021
*******************************************************************     15564021
       SPACE   6                                                        15570021
       USING   *,RVRB                                                   15576021
ADD    EQU     *                                                        15582021
SUBTR  EQU     *                                                        15588021
MULT   EQU     *                                                        15594021
DIV    EQU     *                                                        15600021
       SR      RW6,RW6        RW6 USED AS INDEX, SET TO 2 * VERBCOD     15606021
         IC    RW6,VERB+NX1                                             15612021
         SLA   RW6,DX1                                                  15618021
         XC    DMAX(LX2),DMAX      ZERO DMAX AND DRSULT                 15624021
         XC    DCURR(LX1),DCURR    ZERO DCURR                           15630021
       NI      ADDSW,MSWOFF       ERROR SWITCH FOR 'TO' AND 'GIVING     15636021
       NI    REMSW,MSWOFF                                               15642021
       NI      PFNDOP,MSWOFF                                            15648021
       NI   RECSW,MSWOFF  SWITCH FOR MULT REC FIELDS                    15654021
       NI  STFLD1,MSWOFF  SWITCH INDICATES WHETHER FIRST OF MULT        15660021
*                         REC FIELDS WAS PROCESSED                      15666021
       NI    RNDSW,MSWOFF                                               15672021
       NI    GIVESW,MSWOFF                                              15678021
       NI    LITSW,MSWOFF    SET ON IF OP1 LITERAL                      15684021
         XC    SETSVD(LX2),SETSVD   INITIALIZE SAVED DISP IN SETTBL     15690021
         XC    LEFTDP(LX2),LEFTDP  INITIALIZE SAVED DISP LEFT           15696021
         XC    LEFTSS(LX2),LEFTSS FOR MULT REC FIELDS WITH 1 OP         15702021
*                           BEFORE THE 'TO'                             15708021
         XC    SDMAX(LX1),SDMAX                                         15714021
         XC    FLPTSW(LX1),FLPTSW   ZERO OUT FLOATING POINT SW          15720021
        NI     DIVSW,MSWOFF                                             15726021
        NI     ONSIZER,MSWOFF                                           15732021
       LA      RCS,OPRND1         INIT. FOR SUBSCR- CORRESPONDING       15738021
       ST      RCS,THISOP                                               15744021
       TM      CORRSW,MSWON       ARE WE WITHIN CORRESPONDING-SERIE     15750021
       BC      ONES,ARTH06         YES-OPTIONS ALREADY INITIALIZED      15756021
         XC    DRSULT+NX1(LX3),DRSULT+NX1                               15762021
       NI      OP1SS,MSWOFF       TURN OFF SS SWITCH FOR OP1 IN COR     15768021
       CH      RW6,N2             IS VERB + OR -                        15774021
       BC      HI,ARTH09            * OR /. INITIALIZATION COMPLETE     15780021
*                                                                       15786021
*                           VERB IS ADD OR SUBTRACT                     15792021
*                                                                       15798021
         CLC   GOTTEN(LX2),CBCORR  IS A CORRESPONDING-SERIES STARTIN    15804021
       BC      EQ,ARTH03           YES                                  15810021
       LA      RW4,ADDVRB         NO-STORE VERB (SUBTR USES + TILL      15816021
       BAL     RCS,STOR45                         LAST OPERAND)         15822021
       BC      UNCOND,ARTH12       OP1 FOUND                            15828021
*                                                                       15834021
*              'CORRESPONDING' FOUND                                    15840021
*                                                                       15846021
ARTH03 BAL     RCS,GETNXT           DISCARD 'CORRESPONDING'             15852021
       LA      RA0,BCDDN          PARAM FOR POSSIBLE MSG 32             15858021
       BAL     RCS,ISDTOP         IS IT A DATA OPERAND AT ALL           15864021
       BC      UNCOND,IDGVUP       NO - GIVE UP                         15870021
       OI      DRYRUN,MSWON        SWITCH SAYS DONT STORE OR GENR       15876021
       BAL     RCS,RDUCOP          REDUCE SUBSCRIPT,IF ANY              15882021
       BC      UNCOND,OPERR          SUBSCRIPTING ERROR,GIVE UP SER     15888021
       CLI     GOTTEN,MSS          WAS IT SUBSCRIPTED                   15894021
       BC      NOTEQ,ARTH15         NO                                  15900021
       OI      OP1SS,MSWON           SW SAYS EACH OP1 IN SERIES MUS     15906021
       BC      UNCOND,ARTH15        MADE SSID. SEEK COBOL WORD          15912021
*                                                                       15918021
*                           INITIALIZATIONS COMPLETED                   15924021
*                                                                       15930021
ARTH06 TM      OP1SS,MSWON        IN CORRESPONDING-SERIES TURN ON       15936021
       BC      ZERO,ARTH09         SWITCH FOR SUBSCR IF DRY-RUN         15942021
       OI      OPSSSW,MSWON        FOUND OP-1 TO BE SUBSCRIPTED         15948021
ARTH09 BAL     RCS,STOVRB     STORE *,/,+(CORR),-(CORR) IN STRING       15954021
ARTH12 EQU     *                                                        15960021
       BAL     RCS,ISOPAR         IS 1ST OPERAND LEGAL FOR ARITHMET     15966021
       BAL     RCS,ARTH90          NO- SEE IF RECOVERABLE ERROR         15972021
*                                                                       15978021
*                           LEGAL 1ST OPERAND FOUND                     15984021
*                                                                       15990021
       CH      RW6,N6             IS VERB DIVIDE                        15996021
       BC    EQ,ARDIVIDE           YES                                  16002021
       BAL     RCS,DECMAX            NO - UPDATE DMAX OF STATEMENT      16008021
       BAL     RCS,STOINP         STORE OPRND IN STRING                 16014021
         MVC   LEFTDP(LX2),DSPSTR SAVE DISP OF VERB AND OP1             16020021
         MVC   LEFTSS(LX2),DSPSBS SAVE DISP FROM DEFSBS                 16026021
       TM    MODE,MLITBT   IS OP1 A LITERAL                             16032021
       BZ    *+12    NO                                                 16038021
       OI    LITSW,MSWON                                                16044021
       B     ARTH15                OP1 IS A LITERAL                     16050021
       BAL   RCS,GETALL            MOVE OP1 TO SAVE AREA                16056021
       LA    RW2,SAVE1OP    SAVE OP1 TO POSSIBLY STORE IN TR            16062021
ARTH15 LA      RCS,OPRND2         INIT. FOR SUBSCR-CORRESPONDING        16068021
       ST      RCS,THISOP                                               16074021
       TM      CORRSW,MSWON       WITHIN CORRESPONDING SERIES TURN      16080021
       BC      ZERO,ARTH18          SWITCH FOR SUBSCR IF DRY-RUN        16086021
       TM      OP2SS,MSWON          FOUND OP-2 TO BE SUBSCRIPTED        16092021
       BC      ZERO,ARTH21         NOT SUBSCRIPTED                      16098021
       OI      OPSSSW,MSWON                                             16104021
       BC      UNCOND,ARTH21       SW ON FOR SUBSCR RTN & GETNXT        16110021
ARTH18 NI      OP2SS,MSWOFF       TURN OFF SS SWITCH WHEN NOT IN CO     16116021
ARTH21 BAL     RCS,GETNXT          GET THE NEXT ENTITY                  16122021
*                                                                       16128021
*                           COBOL WORD EXPECTED                         16134021
*                                                                       16140021
ARTH24 LA      RW5,CBTO(RW6)                                            16146021
         CLC   GOTTEN(LX2),DX0(RW5) IS IT APPROPRIATE COBOL WORD        16152021
       BC      EQ,ARTH39           YES                                  16158021
       TM      DRYRUN,MSWON     NO - ARE WE IN SOURCE FORM OF 'CORR     16164021
       BC      ONES,ARTH36           IF SO-ERROR                        16170021
       CH      RW6,N2               NO - IS VERB * OR /                 16176021
       BC      HI,ARTH36            YES-ERROR                           16182021
       BC      EQ,ARTH33           VERB IS -                            16188021
         CLC   GOTTEN(LX2),CBGIVE  VERB IS +,'GIVING' POSSIBLE          16194021
       BC      NOTEQ,ARTH33        NO                                   16200021
       TM      PFNDOP,MSWON       YES, 'GIVING' - HAVE WE HAD 2 OPS     16206021
       BC      ZERO,ARTH30          NO                                  16212021
ARTH26   LA    RW4,DX2              YES-REMOVE LAST 2 ENTRIES FROM      16218021
ARTH27 L       RW1,ASTRNG           STRING (ENTERED BY ARTHIR)          16224021
       BAL     RCS,PREMVV          REMOVE VARIBLE-LENGTH                16230021
         LA    RW4,DX0               (DUMMY)                            16236021
       BCT     RW4,ARTH27          NO LOOP                              16242021
       BC      UNCOND,ARTH57      GO STORE RESULT-FIELD IR              16248021
ARTH30 BAL     RCS,ERROR           WRITE ERROR MESSAGE                  16254021
       LA      RW1,ELST18                                               16260021
       BC      UNCOND,IDERR        ERROR EXIT                           16266021
*                                                                       16272021
*      OPERAND OF ADD- OR SUBTRACT-SERIES FOUND (I.E.,NO CB WORD YE     16278021
*                                                                       16284021
ARTH33 NI    LITSW,MSWOFF   NOT SINGLE LITERAL BEFORE TO                16290021
       BAL   RCS,ISOPAR            IS IT LEGAL OPERAND                  16296021
         BAL   RCS,ARTH80          NO-SEE IF RECOVERABLE ERROR          16302021
       BAL     RCS,ARTHIR         YES- STORE IT AND NEW IR IN STRIN     16308021
       LA      RW4,ADDVRB         REPEAT ADD VERB IN STRING             16314021
       BAL     RCS,STOR45          STORE VERB IN STRING                 16320021
       LA      RW4,IR             STORE IR AS 1ST OPRND OF NEW GROU     16326021
       BAL     RCS,STOR45          STORE IR IN STRING                   16332021
       OI      PFNDOP,MSWON       SW TESTED AT ARITH4 TO INSURE         16338021
*                                    2 OPERANDS FOR 'ADD...GIVING'      16344021
       BC      UNCOND,ARTH24       RETURN TO SEEK COBOL WORD            16350021
*                                                                       16356021
*              COBOL WORD MISSING FOR * OR /                            16362021
*                                                                       16368021
ARTH36 LA      RA0,CBTO(RW6)                                            16374021
       BAL     RCS,ERROR           WRITE MESSAGE                        16380021
       LA      RW1,ELST07                                               16386021
       BC      UNCOND,ARTH42       ASSUME IT AND SEEK STORE-FIELD       16392021
*                                                                       16398021
*                           APPROPRIATE COBOL WORD FOUND                16404021
*                                                                       16410021
ARTH39 BAL     RCS,GETNXT          DISCARD IT                           16416021
ARTH42 TM      DRYRUN,MSWON       ARE WE IN SOURCE-FORM OF CORR.        16422021
       BC      ZERO,ARTH45         NO - GO PROCESS STORE-FIELD          16428021
       BAL     RCS,RDUCOP           YES- IS THIS LEGAL DATA-NAME        16434021
       BC      UNCOND,OPERR           NO-DELETE WHOLE SERIES            16440021
       TM      MODE,MLITBT                                              16446021
       BC      NOTZER,OPERR           NO                                16452021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      16458021
       CLI     CURENT,MSS         WAS OPERAND SUBSCRIPTED               16464021
       BC      NOTEQ,ARTH66        NO - GO SEEK 'ROUNDED'               16470021
       OI      OP2SS,MSWON           YES-SW SAYS EACH OP2 IN SERIES     16476021
       BC      UNCOND,ARTH66       MUST BE MADE SSID. SEEK 'ROUNDED     16482021
ARTH45 CH      RW6,N2              WHICH VERB                           16488021
       BC      LO,ARTH48             +                                  16494021
       BC      HI,ARTH54             * OR /                             16500021
*                                                                       16506021
*                           'FROM' FOUND FOR SUBTRACT                   16512021
*                                                                       16518021
       L       RW1,ASTRNG         CHANGE LAST VERB IN STRING AREA T     16524021
       BAL     RCS,GOBACK         POINT RW1 TO LAST VERB                16530021
       DC    XL2'2'                GOBACK NEXT TO LAST                  16536021
       L     RW2,ADNTRY                                                 16542021
         MVI   DX1(RW2),MINCOD     MAKE VERB MINUS                      16548021
       BC      UNCOND,ARTH54       PROCESS THE NEXT OPERAND             16554021
*                                                                       16560021
*                           SEEK STORE-FIELD                            16566021
*                                                                       16572021
ARTH48 OI      ADDSW,MSWON       SWITCH INHIBITS 'GIVING' FOR ADD       16578021
ARTH54   MVC   STRCNT(LX2),DSPSBS  SAVE DEFSBS DISPL. FOR ARTH 69       16584021
         CLC   GOTTEN(LX2),CBTO    IS THIS COBOL TO OF ADD        53115 16590021
         BNE   ARTH48A             IT IS ERROR-SECOND TO OF ADD   53115 16596021
         LR    RA0,RIN             THIS IS SECOND TO FOR ADD      53115 16602021
         BAL   RCS,ERROR           GENERATE E MSG FOR EXTRA TO    53115 16608021
         LA    RW1,ELST07                                         53115 16614021
         BAL   RCS,GETNXT          GET NEXT  INPUT TEXT           53115 16620021
         B     AFTSTR              GO TO END OF STORE RTN         53115 16626021
ARTH48A  DS    0H                                                 53115 16632021
       BAL     RCS,ISOPAR         IS NEXT A LEGAL ARITHMETIC OPERAN     16638021
       BAL     RCS,ARTH90         NO - SEE IF RECOVERABLE ERROR         16644021
       BAL   RCS,GETALL     YES-SAVE TEMPORARILY SINCE                  16650021
        LA  RW2,SAVESTOR      TR MIGHT BE NEEDED                        16656021
         MVC   SDMAX(LX1),DMAX SAVE DMAX FOR OPS BEFORE TO              16662021
        TM     DIVSW,MSWON         WAS IT DIVIDE                        16668021
        BZ     ARTH55              NO                                   16674021
        MVI    MASK,MB2            SET UP MASK                          16680021
        ST     RW2,RW2SAVE         SAVE RW2                             16686021
        LA     RW2,SAVESTOR        GET ADDR OF THE OPERAND              16692021
        BAL    RCS,CHKFLPT         CHECK IF OPERAND IS FL PT            16698021
ARTH55  BAL    RCS,ARTHIR          UPDATE DECMAX,ADD IR TO STRING       16704021
ARTH57   MVC   PRSULT(LX3),IR      MOVE IR TO RESULT FIELD              16710021
*                                                                       16716021
*      WAS LAST THE REAL STORE-FIELD, OR IS THERE 'GIVING'              16722021
*                                                                       16728021
         CLC   GOTTEN(LX2),CBGIVE  IS IT 'GIVING'                       16734021
       BC      NOTEQ,ARTH69       NO-MAKE SURE STORE-FIELD IS NOT A     16740021
       TM      ADDSW,MSWON        YES - WAS THERE 'ADD TO ...'GIVIN     16746021
       BC      ZERO,ARTH60           NO - OK                            16752021
       LA      RA0,CBTO                                                 16758021
       BAL     RCS,ERROR           WRITE MESSAGE                        16764021
       LA      RW1,ELST08                                               16770021
ARTH60 BAL     RCS,GETNXT          GET NEXT ENTITY                      16776021
       BAL     RCS,ISOPST         IS NEXT LEGAL STORE OPERAND           16782021
       BC    UNCOND,ARTH61            CHECK IF IN SETTBL                16788021
       OI    GIVESW,MSWON                                               16794021
ARTH625 EQU    *                                                        16800021
        TM     DIVSW,MSWON         WAS IT DIVIDE                        16806021
        BZ     ARTH63              NO                                   16812021
ARTH635 EQU    *                                                        16818021
        MVI    MASK,MB4            SET UP MASK                          16824021
        ST     RW2,RW2SAVE         SAVE RW2                             16830021
        LA     RW2,PSTFLD          GET ADDRESS OF SAVED OPERAND         16836021
        BAL    RCS,CHKFLPT         CHECK IF OPERAND IS FL PT            16842021
*                  EXIT  -  STORE-OPERAND ESTABLISHED                   16848021
*                                                                       16854021
ARTH63   MVC   DRSULT(LX1),DCURR   MOVE ITS DEC. LENGTH TO EVAL STRI    16860021
ARTH66 NI    RECSW,MSWOFF                                               16866021
       TM    CORRSW,MSWON        IS IT CORRESPONDING                    16872021
       BO    ARITHMET            YES-LEAVE ROUNDED AS ORIG SET          16878021
         XC    DRSULT+NX1(LX1),DRSULT+NX1 NO- REINIT TO NOROUND         16884021
       TM    SETRIN,MFF            ARE WE AT END OF SETTBL              16890021
       BO    AREX0                 END OF SETTBMOVE STFLD AND EXIT      16896021
         CLC   GOTTEN(LX2),CBROUN IS IT ROUNDED                         16902021
       BNE  ARITHMET   NO-SEEK IF END                                   16908021
       BAL  RCS,GETNXT    YES                                           16914021
RNDOP    OI    DRSULT+NX1,MSWON     TURN ON ROUNDED SW                  16920021
ARITHMET TM  DRYRUN,MSWON  SOURCE FORM CORR                             16926021
       BO AREX   YES- EXIT                                              16932021
       TM    GIVESW,MSWON    WAS THERE A GIVING                         16938021
       BO    AREX1                 SEE IF DIVIDE                        16944021
         TM    SETRIN,MFF          IS THIS LAST                   55163 16950021
         BO    AREX0               YES BRANCH                     55163 16956021
CHKDN   DS   0H                                                   40183 16962021
       TM  GOTTEN,MDN   IS NEXT A POSSIBE STORE FIELD                   16968021
         BNO   AREX0               NOT DN                         53115 16974021
        CH     RW6,N4              YES, WHICH VERB                      16980021
        BC     LO,ARTH68           + OR -                               16986021
        LA     RA0,CBGIVE                                               16992021
        BAL    RCS,ERROR           ASSUME GIVING                        16998021
        LA     RW1,ELST07          ISSUE ERROR MESSAGE                  17004021
        BAL    RCS,ISOPST          IS IT LEGAL STORE FIELD              17010021
        BC     UNCOND,IDERR        NO, ERROR EXIT                       17016021
        OI     GIVESW,MSWON        YES, SET GIVESW ON                   17022021
        BC     UNCOND,ARTH625      PROCESS STORE FIELD                  17028021
*DEL                                                                    17034021
*DEL                                                                    17040021
*DEL                                                                    17046021
*DEL                                                                    17052021
*DEL                                                                    17058021
*DEL                                                                    17064021
*DEL                                                                    17070021
*DEL                                                                    17076021
*DEL                                                                    17082021
*DEL                                                                    17088021
*DEL                                                                    17094021
*DEL                                                                    17100021
*DEL                                                                    17106021
*DEL                                                                    17112021
*DEL                                                                    17118021
*DEL                                                                    17124021
*DEL                                                                    17130021
*DEL                                                                    17136021
*DEL                                                                    17142021
*DEL                                                                    17148021
*DEL                                                                    17154021
*DEL                                                                    17160021
AREX0  BAL   RCS,ARTH665           NO                                   17166021
       BAL   RCS,DUPSS       SUPPLY SS DUP FOR STFLD IF NEC             17172021
AREX   L RVRB,ASTOR  EXIT TO STORAN                                     17178021
         BR    RVRB                STORE ANALYZER                       17184021
AREX1  CH    RW6,N6                IS IT DIVIDE                         17190021
       BNE   AREX    NO- EXIT- STFLD ALREADY PROCESSED                  17196021
         CLC   GOTTEN(LX2),CBREM    IS IT REMAINDER OPTION              17202021
       BNE   AREX                 NO                                    17208021
*  DIVIDE REMAINDER FOUND                                               17214021
       BAL   RCS,GETNXT            SAVE REMAINDER STOREFIELD            17220021
       BAL   RCS,GETALL            MOVE REMAINDER TO SAVE AREA          17226021
       LA    RW2,SAVESTOR                                               17232021
        MVI    MASK,MB8            SET UP MASK                          17238021
        ST     RW2,RW2SAVE         SAVE RW2                             17244021
        LA     RW2,SAVESTOR        GET ADDR OF THE OPERAND              17250021
        BAL    RCS,CHKFLPT         CHECK IF OPERAND IS FL PT            17256021
         MVC   LEFTSS(LX2),DSPSBS   SAVE SS DISP                        17262021
         MVC   LEFTDP(LX2),DSPSTR   AND DISP IN STRING                  17268021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      17274021
       OI    REMSW,MSWON           SIGNAL DIVIDE REM FOUNDP             17280021
        CLI    FLPTSW,MZERO        WAS THERE ANY FL PT DATA ITEM        17286021
        BNE    AREX                YES - EXIT TO STORAN                 17292021
        BAL    RCS,PUPTR           GET UPDATED TR                       17298021
         MVC   DRSULT+NX2(LX2),TR+NX1 SIGNAL TR IS USED IN REM CAL      17304021
       BC    UNCOND,AREX           EXIT                                 17310021
ARTH61 TM    SETRIN,MSWON         RIN IN SETTBL OR INPUT BUFFER         17316021
       BZ    IDERR            INPUT BUFFER- EXIT                        17322021
       LR    RIN,RW5                                                    17328021
       ST    RIN,TRUPNT          RESTORE RIN AND TRUPNT                 17334021
         XC    SETRIN(LX1),SETRIN                                       17340021
       B    IDERR           ERROR %EXIT                                 17346021
*                                                                       17352021
*                                                                       17358021
*ASSUME MORE THAN ONE STORE FIELD                                       17364021
*                                                                       17370021
*                                                                       17376021
ARTH68 OI  RECSW,MSWON  SIGNAL TO STORAN TO RETURN TO THIS ROUTINE      17382021
       TM   STFLD1,MSWON   WAS 1ST ALREADY PROCESSED                    17388021
      BO  ADDREC   YES                                                  17394021
       TM    LITSW,MSWON  OP1 LITERAL                                   17400021
       BZ    AR000  NO- REMOVE LAST 4 ENTRIES- TR NEEDED                17406021
ADDREC    BAL  RCS,ARTH665   NO- TR NOT NEEDED                          17412021
       BAL   RCS,DUPSS       SUPPLY SS DUP FOR STFLD IF NEC             17418021
       L  RVRB,ASTOR                                                    17424021
     BR RVRB                       STORE ANALYZER                       17430021
AR000  BAL  RCS,PUPTR  YES- GET UPDATED TR                              17436021
         MVC   PSTFLD(LX3),TR MOVE TR TO STOREFIELD FIRST               17442021
         XC    DMAX(LX1),SDMAX                                          17448021
         XC    SDMAX(LX1),DMAX                                          17454021
         XC    DMAX(LX1),SDMAX                                          17460021
*  DMAX NOW CONTAINS MAX DEC FOR OPS BEFORE TO                          17466021
*  SDMAX HAS MAX DEC PLACES INCLUDING STFLD                             17472021
         MVC   DRSULT(LX1),DMAX                                         17478021
         LA    RW4,DX4       REMOVE LAST FOUR ENTRIES FROM STRING       17484021
AROUND L   RW1,ASTRNG                                                   17490021
       BAL   RCS,PREMVV            REMOVE VARIABLE-LENGTH               17496021
         LA    RW4,DX0                                                  17502021
       BCT   RW4,AROUND            LOOP BACK UNTIL DONE                 17508021
         LH    RW1,IR+NX1                                               17514021
       BCTR  RW1,RA0               STORE IR'S                           17520021
         STH   RW1,IR+NX1                                               17526021
       TM    PFNDOP,MSWON   MORE THAN 1 OP BEFORE TO                    17532021
       BO    *+8                   YES                                  17538021
       BAL    RCS,SVRES   1 OP BEFORE TO- MOVE OP1 TO PRSULT            17544021
         MVC   PRSULT(LX3),IR                                           17550021
         XC    TRSS(LX2),TRSS                                           17556021
       CLI   SAVESTOR,MSS    IS STOREFIELD SUBSCRIPTED                  17562021
       BNE   CKRND    NO SEE IF ROUNDED                                 17568021
         MVC   TRSS(LX2),DSPSBS   SAVE CURRENT DISPLACEMENT DEFSBS      17574021
         MVC   DSPSBS(LX2),STRCNT PUT PREVIOUS DISPLACEMENT IN DSPSB    17580021
*                          SO THAT GNARTH WILL NOT GENERATE LAST        17586021
       L     RW1,ADFSBS     GET TIB ADDRESS OF SS TAB                   17592021
         L     RW2,DX0(RW1) ADDRESS OF TAMM                             17598021
         MVC   DX4(LX2,RW2),STRCNT DECREMENT DISPLACEMENT IN TAMM       17604021
CKRND    TM    DRSULT+NX1,MSWON WAS 'ROUNDED' FOUND                     17610021
       BZ    AR001                 NO                                   17616021
       OI    RNDSW,MSWON      SET ROUND SWITCH ON  FOR NEXT EVAL        17622021
         XC    DRSULT+NX1(LX1),DRSULT+NX1                               17628021
AR001  L   RVRB,ASTOR                                                   17634021
       BR  RVRB  EXIT TO STORAN                                         17640021
*                                                                       17646021
*                                                                       17652021
*STORAN RETURNS HERE WHEN STFLD1 IS OFF- FIRST STORE FIELD              17658021
*HAS NOT YET BEEN ADDED TO STRING BUT HAS BEEN FOUND VALID              17664021
*                                                                       17670021
AFTR   CLI   SAVESTOR,MSS   IS STOREFIELD SUBSCRIPTED                   17676021
       BNE   DEFNIT    NO                                               17682021
         MVC   DSPSBS(LX2),TRSS RESOREORIGINAL TAMM DISP FOR PACKTB     17688021
       L     RW1,ADFSBS                                                 17694021
         L     RW2,DX0(RW1)  TAMM                                       17700021
         MVC   DX4(LX2,RW2),TRSS                                        17706021
       BAL   RCS,PACKTB      MAKE FIRST SS STRING FOR STFLD             17712021
*                          FIRST ENTRY IN DEFSBS TABLE                  17718021
         LA    RW3,DX0                                                  17724021
       LH    RW2,STRCNT                                                 17730021
DEFNIT   XC    STRCNT(LX2),STRCNT                                       17736021
       BAL   RCS,ARTH665    MOVE STOREFIELD TO PSTFLD                   17742021
       BAL   RCS,DUPSS       SUPPLY SS DUP FOR STFLD IF NEC             17748021
       LA  RW4,ADDVRB                                                   17754021
       CH     RW6,N2                                                    17760021
       BNE  AFTR1                  NOT A SUBTRACT VERB                  17766021
       LA    RW4,SUBTRVB     MAKE VERB SUBTRACT                         17772021
AFTR1  BAL  RCS,STOR45  STORE VERB IN STRING                            17778021
       LA    RW4,TR                                                     17784021
       BAL   RCS,STOR45            STORE IN STRING                      17790021
         MVC   LEFTDP(LX2),DSPSTR SAVE VERB AND TR IN LEFTDP            17796021
       LA    RW4,SAVESTOR   IF SSID, SAVESTOR HAS ONE WE WANT           17802021
       BAL   RCS,STOR45            STORE IN STRING                      17808021
         XC    DMAX(LX1),SDMAX                                          17814021
         XC    SDMAX(LX1),DMAX                                          17820021
         XC    DMAX(LX1),SDMAX                                          17826021
         MVC   DRSULT(LX1),DCURR                                        17832021
       BAL  RCS,PUPIR   UPDATE IR FOR RESULT                            17838021
       LA  RW4,IR                                                       17844021
       BAL  RCS,STOR45             STORE IN STRING                      17850021
         MVC   PRSULT(LX3),IR                                           17856021
       TM    RNDSW,MSWON     WAS ROUNDED FOUND                          17862021
       BZ    AFTR2    NO                                                17868021
         OI    DRSULT+NX1,MSWON SET ON OPTION IN EVAL STRING            17874021
       NI    RNDSW,MSWOFF                                               17880021
AFTR2  L   RVRB,ASTOR                                                   17886021
       BR  RVRB                    STORE ANALYZER                       17892021
*                                                                       17898021
*                                                                       17904021
*RETURN WHEN AT LEAST ONE STOREFIELD                                    17910021
*HAS BEEN ADDED TO STRING                                               17916021
*                                                                       17922021
AFTSTR   MVC   DMAX(LX1),SDMAX                                          17928021
       CH    RW6,N2  WHICH VERB                                         17934021
       BNE  ARTH48                 NOT SUBTRACT                         17940021
       B ARTH54                    YES - SUBTRACT VERB                  17946021
*                                                                       17952021
*                                                                       17958021
*              'GIVING' NOT FOUND.  CHECK STORE-FIELD FOR LITERAL       17964021
*               AND SUPPLY DISTINCT SSID FOR SUBSCRIPTED STORE-FIEL     17970021
*                                                                       17976021
ARTH69 TM      MODE,MLITBT                                              17982021
       BC      NOTZER,ARTH75        LITERAL - ERROR                     17988021
       BC      UNCOND,ARTH63       STORE OPERAND ESTABLISHED            17994021
ARTH75 EQU     *                                                        18000021
       LA    RA0,SAVESTOR                                               18006021
       BAL     RCS,ERROR          STORE-FIELD IS LIT OR 'ZERO'          18012021
       LA      RW1,ELST17                                               18018021
       TM    SETRIN,MSWON         RIN POINTING IN SETTBL                18024021
       BZ    IDERR                NO-ERROR EXIT NOW                     18030021
       LR    RIN,RW5           RESTORE RIN TO REAL BEFORE EXITING       18036021
       ST    RIN,TRUPNT                                                 18042021
         XC    SETRIN(LX1),SETRIN                                       18048021
       NI    SIZERROR,MSWOFF                                            18054021
       BC    UNCOND,IDERR          ERROR EXIT                           18060021
*                                                                       18066021
*                   LEGAL ARITHMETIC OPERAND NOT FOUND                  18072021
*                                                                       18078021
ARTH80   EQU   *                                                        18084021
         TM    GOTTEN,MDN          IS IT DATA OPERAND                   18090021
         BC    ONES,ARTH93         YES                                  18096021
         LA    RA0,CBTO(RW6)       'TO(FROM)' MISSING FOR ADD(SUBTR     18102021
         BAL   RCS,ERROR           WARNING MESSAGE                      18108021
         LA    RW1,ELST07                                               18114021
       TM    PFNDOP,MSWON    AT LEAST 2 OPS                             18120021
*  OTHERWISE WE CANNOT SAVE IT                                          18126021
       BZ    ARTH91        NO- GIVE UP                                  18132021
*                                                                       18138021
*        REINITIALIZE FOR RECOVERY FROM NO 'TO' FOR ADD                 18144021
*           OR NO 'FROM' FOR SUBTRACT FOUND                             18150021
*                                                                       18156021
         OI    NEXTIN,MSWON        SW INHIBITS 'GETNXT' AS HAVE NEX     18162021
         CH    RW6,N2              IS IT +                              18168021
         BC    LO,ARTH84           YES                                  18174021
         L     RW1,ASTRNG          CHANGE LAST VERB IN STRING TO -      18180021
         BAL   RCS,GOBACK          POINT TO LAST VERB                   18186021
         DC    XL2'6'              6TH ENTITY FROM END                  18192021
         L     RW2,ADNTRY                                               18198021
         MVI   DX1(RW2),MINCOD      MAKE VERB MINUS                     18204021
ARTH84   EQU   *                                                        18210021
         MVC   SAVESTOR(LX124),CURENT     PUT LAST OP IN SAVESTOR       18216021
         MVC   MODE(LX3),CURMOD        AND ITS MODE IN MODE             18222021
         LA    RIN,CURENT          MAKE RIN POINT TO LAST OPERAND       18228021
         BAL   RCS,GETNXT          GET NEXT ENTITY                      18234021
         BC    UNCOND,ARTH26       REMOVE ENTRIES FROM STRING           18240021
ARTH90 TM      GOTTEN,MDN         IS IT DATA OPERAND                    18246021
       BC      ONES,ARTH93         YES                                  18252021
ARTH91 LA    RA0,BCDNOP           NO- GIVE UP                           18258021
       BC      UNCOND,IDGVUP       GIVE-UP ROUTINE                      18264021
ARTH93 ST      RCS,SVISOP                                               18270021
       BAL     RCS,PMKTAL           YES - SUBSTITUTE 'TALLY'            18276021
       L       RCS,SVISOP                                               18282021
       BCR     UNCOND,RCS          STORE TEMPORARILY                    18288021
DIVREM   MVC   PLEFT(LX124),PSTFLD  SAVE LAST STOREFIELD                18294021
        CLI   FLPTSW,MZERO    WAS THERE ANY FLOATING PT OPERAND         18300021
        BNE    REMERR              YES, ERROR EXIT                      18306021
       OI    NEXTIN,MSWON                                               18312021
       NI    REMSW,MSWOFF                                               18318021
         XC    DRSULT+NX1(LX3),DRSULT+NX1                               18324021
       LA    RIN,SAVESTOR          SEE IF OP AFTER REMAINDER            18330021
       BAL   RCS,ISOPST            IS A VALID STOREFIELD                18336021
       B    IDERR                  NO- ERROR EXIT                       18342021
       L    RW1,ASTRNG             YES- PROCESS                         18348021
       BAL   RCS,PREMVV            REMOVE VARIABLE LENGTHS              18354021
         LA    RW4,DX0              REMOVE LAST IR FROM STRING          18360021
       BAL   RCS,PREMVV            REMOVE VARIABLE LENGTHS              18366021
       LA    RW4,SAVE1OP           SAVE DIVIDEND OF LAST DIVIDE         18372021
       BAL   RCS,GOBACK            POINT TO LAST VERB                   18378021
       DC    XL2'2'                GO BACK 2                            18384021
       L    RW2,ADNTRY             CHANGE VERB IN STRING TO MULTIPL     18390021
         MVI   DX1(RW2),XX02                                            18396021
*   EFFECTIVELY CREATE 'MULTIPLY DIVISOR BY QUOTIENT'                   18402021
        LA     RW4,TR              YES, GET ADDR OF TR                  18408021
        B      ARTH100             STORE TR IN STRING                   18414021
ARTH100 BAL    RCS,STOR45          STORE OPERAND IN STRING              18420021
       BAL   RCS,PUPIR            GET IR FOR STRING                     18426021
       LA    RW4,IR                                                     18432021
       BAL   RCS,STOR45            STORE IT IN STRING                   18438021
*   EFFECTIVELY CREATE 'SUBTRACT MULTIPLICATION RESULT FROM DIVIDEN     18444021
       BAL   RCS,STLOOP            STORE IN STRING                      18450021
       DC    XL2'3'                STORE  3 ELEMENTS                    18456021
       LA    RW4,SUBTRVB          SUBTRACT                              18462021
       LA    RW4,IR                LAST IR                              18468021
       LA    RW4,SAVE1OP               FROM DIVIDEND                    18474021
       BAL   RCS,PUPIR             GET NEW IR FOR THIS RESULT           18480021
       LA    RW4,IR                                                     18486021
       BAL   RCS,STOR45            STORE IT IN STRING                   18492021
         MVC   PRSULT(LX3),IR       MOVE THIS IR TO PRSULT              18498021
       B     AREX                  EXIT                                 18504021
*                                                                       18510021
*                                                                       18516021
*      UPDATES DMAX,STORES OPERAND IN STRING,STORES UPDATED IR IN       18522021
*        STRING, GETS NEXT, AND EXITS                                   18528021
*                                                                       18534021
*                                                                       18540021
ARTHIR EQU     *                                                        18546021
       ST      RCS,SVISOP                                               18552021
       BAL     RCS,DECMAX         UPDATE DECMAX                         18558021
       BAL     RCS,STOINP         STORE NEW OPERAND                     18564021
       BAL     RCS,PUPIR          GET NEW IR                            18570021
       LA      RW4,IR             STORE IR                              18576021
       BAL     RCS,STOR45          STORE IT IN STRING                   18582021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      18588021
       L       RCS,SVISOP                                               18594021
       BCR     UNCOND,RCS          EXIT                                 18600021
*                                                                       18606021
*                                                                       18612021
*    MOVES VALID STORE OPERAND FROM SAVED AREA TO PSTFLD                18618021
*                                                                       18624021
*                                                                       18630021
ARTH665 ST RCS,SVSTFD                                                   18636021
       LA  RW2,SAVESTOR                                                 18642021
       BAL  RCS,COUNT   GET BYTE COUNT                                  18648021
       SR  RW3,RW3   CLEAR RW3                                          18654021
       AH  RW3,BYTES                                                    18660021
       EX RW3,MVSTORE                                                   18666021
       OI  STFLD1,MSWON                                                 18672021
       L  RCS,SVSTFD                                                    18678021
      BR  RCS                      EXIT                                 18684021
MVSTORE  MVC   PSTFLD(LX1),SAVESTOR                                     18690021
SVRES  ST    RCS,SVRSFD                                                 18696021
       LA    RW2,SAVE1OP                                                18702021
       BAL   RCS,COUNT             GET BYTE COUNT                       18708021
       SR    RW3,RW3                                                    18714021
       AH    RW3,BYTES                                                  18720021
       EX    RW3,MVRES                                                  18726021
       L    RCS,SVRSFD                                                  18732021
       B     6(RCS)                EXIT                                 18738021
MVRES    MVC   PRSULT(LX1),SAVE1OP                                      18744021
ARDIVIDE  BAL  RCS,GETALL          MOVE ENTITY TO SAVE AREA             18750021
       LA    RW2,SAVE1OP    SAVE 1ST OP MAY BECOME SECOND OP            18756021
        OI     DIVSW,MSWON         SIGNAL DIVIDE FOUND                  18762021
        MVI    MASK,MB1            SET UP MASK                          18768021
        ST     RW2,RW2SAVE         SAVE RW2                             18774021
        LA     RW2,SAVE1OP         GET ADDR OF THE OPERAND              18780021
        BAL    RCS,CHKFLPT         CHECK IF OPERAND IS FL PT            18786021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      18792021
       LA    RW5,CBTO(RW6)   WHICH DIVIDE OPTION                        18798021
         CLC   GOTTEN(LX2),DX0(RW5) IS IT  INTO                         18804021
       BNE    ARTHDIV1   NOT INTO   SEE IF BY                           18810021
       LA    RW4,SAVE1OP   INTO                                         18816021
       BAL   RCS,STOR45   STORE FIRST OP IN STRING                      18822021
       B     ARTH39       CONTINUE NORMAL PROCESSING                    18828021
ARTHDIV1 CLC   GOTTEN(LX2),CBBY IS IT CB WD BY                          18834021
       BNE   ARTHERDV      NO-ERROR                                     18840021
       BAL   RCS,DECMAX   BY FOUND REVERSE ORDER OF OPS IN STRING       18846021
       BAL   RCS,GETNXT    GET NEXT ELEMENT                             18852021
        BAL    RCS,GETALL     SAVE OPERAND                              18858021
        LA     RW2,SAVEOP     ADDRESS OF SAVE AREA                      18864021
        MVI    MASK,MB2       SET UP MASK                               18870021
        ST     RW2,RW2SAVE         SAVE RW2                             18876021
        LA     RW2,SAVEOP          GET ADDR OF THE OPERAND              18882021
        BAL    RCS,CHKFLPT    LINK TO CHECK FLOATING POINT              18888021
         MVC   STRCNT(LX2),DSPSBS                                       18894021
       BAL   RCS,ISOPAR   IS IT LEGAL OP                                18900021
       BAL   RCS,ARTH90   NO                                            18906021
       BAL   RCS,STOINP   SORE OP2 AS 1ST OP                            18912021
       LA    RW4,SAVE1OP   OP 1 BECOMES SECOND OP                       18918021
       BAL   RCS,STOR45            STORE 2ND OPERAND IN STRING          18924021
       BAL   RCS,PUPIR             INCREAMENT IR BY 1                   18930021
       LA    RW4,IR                                                     18936021
       BAL   RCS,STOR45   STORE IT IN STRING (IR)                       18942021
         MVC   PRSULT(LX3),IR                                           18948021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      18954021
         CLC   GOTTEN(LX2),CBGIVE DOES GIVING FOLLOW                    18960021
       BE    ARTH60   YES OK                                            18966021
       LA    RA0,CBGIVE                                                 18972021
       BAL    RCS,ERROR      ASSUME GIVING                              18978021
       LA    RW1,ELST07                                                 18984021
       BAL   RCS,ISOPST   IS THIS A VALID STORE FIELD                   18990021
       BC    UNCOND,IDERR    NO-  ERROR EXIT                            18996021
       OI    GIVESW,MSWON   YES  SET GIVESW ON                          19002021
         BC    UNCOND,ARTH635      PROCESS STORE OPERAND                19008021
SAVEOP  DS     CL124                                                    19014021
ARTHERDV  LA   RW4,SAVE1OP                                              19020021
       BAL   RCS,STOR45            STORE SAVED OP IN STRING             19026021
         B     ARTH36              PROCESS ERROR                        19032021
REMERR  EQU    *                                                        19038021
         XC    FLPTSW(LX1),FLPTSW   ZERO OUT FLOATING POINT SW          19044021
        BAL    RCS,ERROR      ISSUE ERROR MESSAGE                       19050021
        LA     RW1,ELST4A                                               19056021
        USING  STORAN,RVRB                                              19062021
        L      RVRB,ASTOR     ADDR OF STORAN                            19068021
        BC     UNCOND,STOR108 CONTINUE PROCESS                          19074021
        USING  ADD,RVRB                                                 19080021
CHKFLPT EQU    *                                                        19086021
        ST     RW1,RW1SAVE         SAVE RW1                             19092021
         CLI   DX0(RW2),MDN         IS IT DATA NAME                     19098021
        BE   CHKMODE          YES - CHECK ITS MODE                      19104021
         CLI   DX0(RW2),MFLIT  IS IT FLOATING LITERAL                   19110021
        BE   FLPTFND          YES                                       19116021
        BR  RCS                    GO BACK TO MAIN LINE                 19122021
CHKMODE EQU    *                                                        19128021
        SR   RW1,RW1          CLEAR RW1                                 19134021
         IC    RW1,DX3(RW2)    LOAD DATA NAME'S MODE IN RW1             19140021
         SRL   RW1,DX4         RIGHT JUSTIFIED 4 DIGIT                  19146021
        STC   RW1,DNMODE      STORE MODE INTO DNMODE                    19152021
        CLI   DNMODE,MB9      DATA NAME IS FLOATING POINT               19158021
        BL     NOTFLPT             IF MODE EQUALS 9 OR 10               19164021
        CLI   DNMODE,MB10                                               19170021
        BH   NOTFLPT               NOT FLOATING POINT DATA ITEM         19176021
FLPTFND EQU    *                                                        19182021
         OC    FLPTSW(LX1),MASK     SET UP PROPER SWITCH                19188021
NOTFLPT EQU    *                                                        19194021
        LM     RW1,RW2,RW1SAVE     RESTORE REGISTERS                    19200021
        BCR    UNCOND,RCS          RETURN                               19206021
       EJECT                                                            19212021
*=1    COMPUT  VERB                                                     19218021
*******************************************************************     19224021
*                                                                       19230021
*                                                                       19236021
*                             C O M P U T                               19242021
*                                                                       19248021
*        SIMPLY CHECKS SYNTAX OF STATEMENT                              19254021
*      CALLS ON FORMLA TO ANALYZE ARITHMETIC,BUILD STRINGS, AND         19260021
*        STORE REDUCED OPERAND AT PRSULT                                19266021
*        CALLS ON STORAN TO ANALYZE STORE-FIELD AND OPTIONS             19272021
*                                                                       19278021
*                                                                       19284021
*** STRINGS PRODUCED                                                    19290021
*      EVAL DATA-NAME                                                   19296021
*      ARITH-VERB1,5                                                    19302021
*      OP2,OP1,IR1,IR1-VERB,IR1-OTHER OPERAND                           19308021
*      ARITH-VERB2,5                                                    19314021
*      OP4,OP3,IR2,IR2-VERB,IR2-OTHER OPERAND                           19320021
*      .                                                                19326021
*      .                                                                19332021
*      ARITH-VERBN,5                                                    19338021
*      OPN,OPM,IRL,IRL-VERB,IRL-OTHER OPERAND                           19344021
*      STORE,2                                                          19350021
*      IRL,DATA-NAME                                                    19356021
*                                                                       19362021
*                                                                       19368021
*** SUBROUTINES CALLED                                                  19374021
*      GETNXT,FORMLA,ISOPST,QTBHAS,PZSTRT,ERROR                         19380021
*                                                                       19386021
*                                                                       19392021
*** ERROR PROCESSING                                                    19398021
*      ASSUME MISSING '='                                               19404021
*      SUBSTITUTE TALLY FOR ILLEGAL OPERANDS                            19410021
*      SKIP STATEMENT IF OPERAND MISSING BEFORE OR AFTER '='            19416021
*                                                                       19422021
*                                                                       19428021
*** NOTES                                                               19434021
*      MOVES FINAL RESULT (LAST IR, OR SINGLE TERM) TO PRSULT, STOR     19440021
*        FIELD TO PSTFLD.                                               19446021
*      CALCULATES DMAX FOR ALL OPERANDS EXCEPT  EXPONENTS AND DIVIS     19452021
*                                                                       19458021
*                                                                       19464021
*******************************************************************     19470021
       SPACE   6                                                        19476021
       USING   *,RVRB                                                   19482021
COMPUT   EQU   *                                                        19488021
         XC    DMAX(LX3),DMAX      INIT. EVAL STRING                    19494021
         NI    REMSW,MSWOFF        REST SWITTCH                   46493 19500021
       BAL     RCS,PZSTRT          INITIALIZE TABLES                    19506021
       LA    RW2,APNOUN                                                 19512021
       LA    RW1,APSGNT                                                 19518021
         XC    PRNLEV(LX2),PRNLEV                                       19524021
         XC    PNOUCT(LX2),PNOUCT                                       19530021
         XC    DMAXSW(LX2),DMAXSW                                       19536021
       BAL     RCS,ISOPST         IS IT LEGAL STORE-FIELD               19542021
       BC      UNCOND,IDERR       NO - GIVE UP                          19548021
         MVC   DRSULT(LX1),DCURR     YES                                19554021
         CLC   GOTTEN(LX2),CBROUN  IS IT 'ROUNDED'                      19560021
       BC      NOTEQ,CMPT4        NO                                    19566021
         OI    DRSULT+NX1,MSWON    YES - SET BIT IN EVAL STRING         19572021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      19578021
CMPT4    CLC   GOTTEN(LX2),CBEQSN  IS NEXT '='                          19584021
         BC    NOTEQ,CMPT10             NO - ERROR                      19590021
         BAL   RCS,GETNXT          GET NEXT ENTITY                      19596021
CMPT6  BAL     RCS,FORMLA         IS NEXT A FORMULA 'MAKE STRINGS)      19602021
       BC      UNCOND,CMPT12      NO - ERROR                            19608021
       BC      UNCOND,CMPT12      NO - ERROR                            19614021
         CLC   DSPSGN(LX2),N0      IS SIGN TABLE EMPTY                  19620021
       BC      EQ,CMPT8              YES - OK                           19626021
       BAL     RCS,ERROR          EXTRA (S                              19632021
       LA      RW1,ELST06                                               19638021
CMPT8  L       RVRB,ASTOR         REDUCED OPERAND IS NOW AT PRSULT      19644021
         BCR   UNCOND,RVRB         GO SEEK SIZE-ERROR,AND MAKE STOR     19650021
*                                   STRING                              19656021
*                                                                       19662021
*                      ' = '  MISSING                                   19668021
*                                                                       19674021
CMPT10 LA      RA0,CBEQSN                                               19680021
       BAL     RCS,ERROR           WARNING MSG - '=' MISSING            19686021
       LA      RW1,ELST07                                               19692021
       BC      UNCOND,CMPT6       ASSUME = AND CONTINUE                 19698021
*                                                                       19704021
*                                 ILLEGAL OPERAND                       19710021
*                                                                       19716021
CMPT12 BAL     RCS,ERROR           SUBSTITUTE TALLY FOR OPERAND         19722021
       LA      RW1,ELST04                                               19728021
       BC      UNCOND,IDERR        ERROR EXIT                           19734021
         EJECT                                                          19740021
*=1    STORAN  END OF ARITH AND COMPUT                                  19746021
*******************************************************************     19752021
*                                                                       19758021
*                                                                       19764021
*                             S T O R A N                               19770021
*                                                                       19776021
*                           (STORE ANALYZER)                            19782021
*                                                                       19788021
*                                                                       19794021
*        ALL ARITHMETIC VERBS COME TO STORAN WHEN THEY FINISH           19800021
*                                                                       19806021
*        STORAN FINDS TARGET FIELD AT PSTFLD                            19812021
*                     RESULT FIELD AT PRSULT                            19818021
*                                                                       19824021
*        ANALYZES ON-SIZE-ERROR                                         19830021
*        CREATES STORE VERB-STRING, WITH NOT-SIZE-ERROR BRANCH IF       19836021
*          APPLICABLE                                                   19842021
*        CALLS GNARTH TO GENERATE ENTIRE SERIES OF VERB STRINGS         19848021
*                                                                       19854021
*                                                                       19860021
*** SUBROUTINES CALLED                                                  19866021
*      GETNXT,NEWNXT,STOR45,GNARTH                                      19872021
*                                                                       19878021
*                                                                       19884021
*** ERROR PROCESSING                                                    19890021
*      NONE - ARITH AND COMPUT PROVIDE CORRECT DATA                     19896021
*             ISIZER FINDS MISSING COBOL WORDS                          19902021
*             IDENT FINDS TRAILING GARBAGE                              19908021
*                                                                       19914021
*                                                                       19920021
*** NOTES                                                               19926021
*      (IF DRYRUN SWITCH ON - INDICATING SIMPLY SYNTAX ANALYSIS OF      19932021
*      OR SUBTRACT-CORRESPONDING STATEMENT,PROCESSES ON-SIZE-ERROR,     19938021
*      DOES NO GENERATING.)                                             19944021
*      IF DRYRUN IS ON TURNS IT OFF AND TURNS ON CORRSW                 19950021
*      DISCARDS THE 'CORRESPONDING' THAT ENDS CORRESPONDING EXPANSI     19956021
*        AND TURNS OFF CORRSW                                           19962021
*      NOT-SIZE-ERROR BRANCH IN ORDINARY CASES IS GN ATTACHED TO        19968021
*        NEXT SENTENCE. FOR CORRESPONDING SERIES IT IS SPECIAL GN       19974021
*        WITH ID OF FFFF FOR EACH EXPANSION EXCEPT THE LAST. FOR        19980021
*        THE LAST IT IS NORMAL NEXT-SENTENCE GN                         19986021
*                                                                       19992021
*                                                                       19998021
*******************************************************************     20004021
       SPACE   6                                                        20010021
         USING *,RVRB                                                   20016021
STORAN   EQU   *                                                        20022021
*                                                                       20028021
*                     PROVIDE SIZE-ERROR BRANCH IF NEEDED               20034021
*                                                                       20040021
       TM   RECSW,MSWON  DOES STFLD FOLLOW THIS STFLD                   20046021
       BC    ONES,SIZERCK          YES, CHECK SIZE ERROR                20052021
       TM      CORRSW,MSWON       FOR ADD,SUBTR. CORRESPONDING, 'ON     20058021
       BC      ONES,STOR6      SIZE-ERROR' ANALYZED ALREADY             20064021
       TM    SIZERROR,MSWON    WAS LAST ADD SERIES                      20070021
       BC    ONES,STOR7     YES                                         20076021
       BAL     RCS,ISIZER         IS IT SIZE-ERROR                      20082021
       BC      UNCOND,STOR9         NO                                  20088021
       BAL     RCS,NEWNXT          YES - GIVE RGN OF NEXT SENTENCE      20094021
STOR5    MVC   RGN+NX1(LX2),NXTSNT                                      20100021
       BC      UNCOND,STOR9        GENR ARTH STRING                     20106021
STOR6    CLC   GOTTEN(LX2),CBCORR  IS THIS END OF CORRESPONDING-SERI    20112021
       BC      NOTEQ,STOR8          NO-SEE IF SIZE-ERROR-               20118021
       BAL     RCS,GETNXT           YES-DISCARD 'CORRESPONDING'         20124021
       NI      CORRSW,MSWOFF        OFF SW USED BY ARITH                20130021
       NI      OP1SS,MSWOFF                                             20136021
       NI      OP2SS,MSWOFF                                             20142021
         CLI   EVAL+NX2,XX02       WAS SIZE-ERROR FOUND                 20148021
       BC      EQ,STOR10           NO (COUNT=2)                         20154021
       OI      CONDSW,MSWON        YES,SW FOR INDENT,AND GIVE RGN O     20160021
       BC      UNCOND,STOR5        NEXT SENTENCE FOR LAST IN SERIES     20166021
STOR14 EQU *                                                            20172021
       USING ADD,RVRB                                                   20178021
       L     RVRB,AVRB                                                  20184021
       BC    UNCOND,DIVREM         RETURN TO PROCESS DIVIDE REMAIND     20190021
       USING  STORAN,RVRB                                               20196021
STOR7  NI    SIZERROR,MSWOFF                                            20202021
       LR    RIN,RW5               RESTORE RIN TO TRUE VALUE            20208021
         XC    SETRIN(LX1),SETRIN   TURN OFF SETRIN                     20214021
       ST    RIN,TRUPNT                                                 20220021
         CLI   EVAL+NX2,XX02 WAS SIZE ERROR FOUND                       20226021
       BE    STOR10     NOT FOUND                                       20232021
       BAL   RCS,THROWE   UPDATE RIN TO POINT TO NEXT VERB              20238021
       BAL   RCS,NEWNXT            GIVE RGN OF NEXT SENTENCE            20244021
       BC    UNCOND,STOR5          NXTSNT FOR LAST IN SERIES            20250021
STOR8    CLI   EVAL+NX2,XX02       WAS SIZE-ERROR FOUND                 20256021
       BC      EQ,STOR10            NO                                  20262021
STOR85   MVC   RGN+NX1(LX2),NFFFF STANDARD RGN FOR SERIES (INCL. CORR)  20268021
       BC      UNCOND,STOR10       SIZE ERROR FOUND                     20274021
*                                                                       20280021
*                                 GENERATE ARITHMETIC STRINGS           20286021
*                                                                       20292021
STOR9  TM      DRYRUN,MSWON        -OR IS IT DRYRUN OF 'CORRESPONDI     20298021
       BC      ZERO,STOR10         NO                                   20304021
       NI      DRYRUN,MSWOFF        YES-DONT GENR.                      20310021
       OI      CORRSW,MSWON         TURN ON CORRSW FOR NEXT STATEME     20316021
       OI      GENRED,MSWON        AVOID IDENT MESSAGE                  20322021
       BC      UNCOND,IDENT        EXIT                                 20328021
STOR10 LA      RW4,PSTVRB         PUT INTO STRING AREA                  20334021
       BAL     RCS,STOR45          STORE STORE-VERB IN STRING           20340021
       LA      RW4,PRSULT         RESULT-FIELD                          20346021
       BAL     RCS,STOR45          STORE RESULT FIELD IN STRING         20352021
       LA      RW4,PSTFLD                                               20358021
       BAL     RCS,STOR45          STORE STORE-FIELD IN STRING          20364021
         BAL   RCS,GNARTH          GENER. ENTIRE VERB STRING            20370021
        TM   ONSIZER,MSWON         WAS THERE ON SIZE ERROR IN DIV       20376021
        BZ   STOR105               NO                                   20382021
        BAL    RCS,GENDAT     WRITE TO FILE TWO                         20388021
        LA     RW2,CBGO            ADDR OF VERB GO                      20394021
         MVC   GNSAVE(LX2),NXTSNT   SAVE GNDEF                          20400021
        OI   GNDEFSW,MSWON         TURN ON GN DEF SWITCH                20406021
        BAL   RCS,PUPLGN           BUMP GN                              20412021
         MVC   RGN+NX1(LX2),NXTLGN  MOVE GN'S TO THEIR SLOTS            20418021
         MVC   LGN+NX1(LX2),GNSAVE                                      20424021
        BAL    RCS,GENDAT     WRITE TO FILE TWO                         20430021
        LA     RW2,RGN        WRITE OUT GNREF                           20436021
        BAL    RCS,GENDAT     WRITE TO FILE TWO                         20442021
        LA     RW2,LGN        WRITE OUT GNDEF                           20448021
         MVC   GNSAVE(LX2),NXTLGN   SAVE GNDEF                          20454021
STOR105 TM     REMSW,MSWON    DIVIDE REMAINDER                          20460021
       BO    STOR14                YES- GO TO BRANCH BACK               20466021
        TM   GNDEFSW,MSWON         MORE THAN ONE GN NEEDED              20472021
        BZ   STOR108               NO                                   20478021
        NI   GNDEFSW,MSWOFF        YES, TURN OFF SW                     20484021
         MVC   LGN+NX1(LX2),GNSAVE  GET GN NUMBER                       20490021
        BAL   RCS,GENDAT           WRITE TO FILE TWO                    20496021
        LA   RW2,LGN                                                    20502021
STOR108 TM   RECSW,MSWON                                                20508021
       BZ  STOR12  NO-RETURH TO IDENT                                   20514021
       BAL   RCS,UPDTSET            RESTORE RIN TO PT TO BEG SETTBL     20520021
       BAL   RCS,PZSTRT      REINITIALIZE TABLES FOR NEXT STRING        20526021
       LA    RW1,ADFSBS                                                 20532021
       TM  STFLD1,MSWON                                                 20538021
       BO  STOR11    YES                                                20544021
       BAL   RCS,PZSTRT    REINITIALIZE STRING TO WIPE OUT OP(S) 1      20550021
       LA    RW1,ASTRNG                                                 20556021
       USING ADD,RVRB                                                   20562021
       L  RVRB,AVRB                                                     20568021
       B AFTR                      1ST STORE-FIELD NOT IN STRING        20574021
STOR11 EQU *                                                            20580021
       USING  ADD,RVRB                                                  20586021
       L RVRB,AVRB                                                      20592021
       B AFTSTR                    AT LEAST 1 STRFLD ADDED              20598021
       USING STORAN,RVRB                                                20604021
STOR12 EQU *                                                            20610021
       B IDENT                     EXIT                                 20616021
SIZERCK TM   SIZERROR,MSWON       E- WAS SIZERROR CHECKED FOR           20622021
       BZ    SIZECHK               NO                                   20628021
       B     STOR8  YES  CHECK IF SIZE ERROR FOUND                      20634021
SIZECHK BAL   RCS,PZSTRT             INITIALIZE SETTBL                  20640021
       LA    RW1,ASETBL            TO HOLD STRFLDS                      20646021
       L     RW1,ASETBL                                                 20652021
SIZE1    LA    RW2,DX0(RIN)                                             20658021
       BAL   RCS,COUNT             COMPUTE TOTAL NO. OF BYTES           20664021
         MVC   DX0(LX1,RW1),BYTES+NX1 GET BYTE COUNT FOR INSERT         20670021
       BAL   RCS,PNSRTF            INSERT ELEMENT IN SETTBL             20676021
         LA    RW4,DX0(RIN)                                             20682021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     20688021
       BAL   RCS,ISIZER            SEE IF SIZE ERROR                    20694021
       B     SIZE2                 NO-  SEE IF END                      20700021
SIZE3  L     RW5,TRUPNT            SAVE TRUPNT                          20706021
         L     RW1,DX0(RW1)         POINT RW1 TO TAMM                   20712021
         L     RIN,DX0(RW1)         POINT RIN TO BEGIN TABLE            20718021
       ST    RIN,TRUPNT                                                 20724021
       OI    SETRIN,MSWON          SIGNAL TO GETNXT AND ADD             20730021
         CLI   EVAL+NX2,XX02       WAS SIZERROR FOUND                   20736021
       BNE   STOR85           YES- GN FOR SIZERROR ID OF FFFF           20742021
       B     STOR10            SIZERR NOT FOUND -ISSUE STOREVB          20748021
SIZE2  BAL   RCS,ISEND            NOT SIZERROR- BUT IS ENDOWRD          20754021
       B     SIZE1               NO- SAVE THIS ELEMENT IN SETTBL        20760021
*             AND THEN CHECK NEXT FOR SIZERROR                          20766021
       B     SIZE3                 NO SIZERROR                          20772021
         EJECT                                                          20778021
IKF40C CSECT                                                            20784021
*=1    IF      VERB                                                     20790021
*******************************************************************     20796021
*                                                                       20802021
*                                                                       20808021
*                                  I F                                  20814021
*                                                                       20820021
*        CHECKS SYNTAX OF IF STATEMENT,CALLING ON FORMLA TO ANALYZE     20826021
*              EXPRESSIONS                                              20832021
*        CALLS ON PUTSGN AND PUTNIN TO ENTER SIGNS AND OPERANDS IN      20838021
*              THE TABLES AND TO CREATE ARITHMETIC VERB STRINGS         20844021
*        WHEN PARENTHESES ARE FOUND, PUTSGN ADJUSTS THE PTRFLS LABE     20850021
*              TABLE TO REFLECT THE INFLUENCE OF 'NOT' AT THE NEW L     20856021
*        WHEN END,'AND',OR 'OR' IS FOUND,CALLS ON PFINDL TO ENTER T     20862021
*              APPROPRIATE BY-PASS LABELS IN THE PSHTBL PUSH-DOWN T     20868021
*              AND TO GENERATE THE APPROPRIATE FALL-THRU LABELS         20874021
*                                                                       20880021
*        IN GENERAL, 'BYPASS LABEL' IS THE BRANCH TAKEN WHEN A GIVE     20886021
*              CONDITION FAILS, 'FALL-THRU LABEL' WHEN IT IS SUCCES     20892021
*              FUL                                                      20898021
*                                                                       20904021
*                                                                       20910021
*        SYNTAX IS CHECKED BY THE FOLLOWING ALGORITHM                   20916021
*                                                                       20922021
*  IS IT                YES                             NO              20928021
*                                                                       20934021
*  1. 'NOT'    PROCESS,GETNXT,GO TO 2        GO TO 2                    20940021
*  2. (        PROCESS,GETNXT,GO TO 1        GO TO 3                    20946021
*  3. ALPHALIT PROCESS,GETNXT GO TO R1       GO TO 4                    20952021
*  4. FORMULA  GO TO 5                       E R R O R - - - - - -      20958021
*  5. ONLY DN  GO TO R2 (CLASS TEST)         GO TO 6                    20964021
*  6. ONLY NUM GO TO R5 (RELATION TEST)      GO TO R3 (SIGN TEST)       20970021
*                                                                       20976021
*****                       RELATIONALS                           *     20982021
*                                                                       20988021
* R1. LEV. 88  PROCESS ALL,GETNXT,GO TO R4   GO TO R5                   20994021
* R2. CLASS    PROCESS ALL,GETNXT,GO TO R4   GO TO R3                   21000021
* R3. SIGN     PROCESS ALL,GETNXT,GO TO R4   GO TO R5                   21006021
* R4. )        PROCESS,GETNXT,GO TO R4       TURN ON PNDREL, GO TO      21012021
* R5. RELAT.   TURN OFF PNDREL,PROCESS,      GO TO R7                   21018021
*              GETNXT,GO TO R6                                          21024021
* R6. PRTURN   ON - GO TO 7                  OFF - PROCESS LEFT,GO      21030021
* R7. PRTURN   ON - TURN OFF PRTURN,GO TO 1  OFF - GO TO R8             21036021
* R8. PNDREL   ON - E R R O R - - - - - - -  OFF - PROC. RIGHT,GO T     21042021
*                                                                       21048021
*****                                                             *     21054021
*                                                                       21060021
*  7. ALPHALIT PROCESS RIGHT,GETNXT,GO TO 9  GO TO 8                    21066021
*  8. FORMULA  PROCESS RIGHT,GETNXT,GO TO 9  E R R O R - - - - - -      21072021
*  9. END      PROCESS,GETNXT,EXIT           GO TO 10                   21078021
* 10. AND      PROCESS,GETNXT,GO TO 12       GO TO 11                   21084021
* 11. OR       PROCESS,GETNXT,GO TO 12       E R R O R - - - - - -      21090021
* 12. PNDREL   ON - PRTURN OFF,GO TO 1       OFF - PRTURN ON, GO TO     21096021
*                                                                       21102021
*                                                                       21108021
*** STRINGS PRODUCED                                                    21114021
*     (ARITHMETIC EXPRESSIONS ARE REDUCED BY FORMLA AND THE STRINGS     21120021
*        STORED)                                                        21126021
*      IF ITSELF PRODUCES ONLY A SIMPLE STRING. GNARTH GENRS THE        21132021
*       STRINGS (IF ANY) PRODUCED BY FORMLA FOLLOWED BY THE IF STRI     21138021
*      1. CONDITION TEST                                                21144021
*              RELATION-VERB  LITERAL  DATA-NAME  RGN-BYPASS            21150021
*      2. SIGN TEST                                                     21156021
*              RELATION-VERB   DATA-NAME ZERO     RGN-BYPASS            21162021
*      3. RELATION TEST                                                 21168021
*              RELATION-VERB   OPERAND OPERAND     RGN-BYPASS           21174021
*      4. CLASS TEST                                                    21180021
*              CLASS-VERB     DATA-NAME           RGN-BYPASS            21186021
*                                                                       21192021
*                                                                       21198021
*** SUBROUTINES CALLED                                                  21204021
*      GETNXT,SAVNXT,STOR45,PGONXT,FORMLA,PUTSGN,PUTNIN,PEMPTY,PFIN     21210021
*      COUNT,PCHCNT,PZSTRT,GETMOD,ISEND,ISNXTS,GENSTR,GNARTH,ERROR      21216021
*      PACKTB                                                           21222021
*                                                                       21228021
*                                                                       21234021
*** ERROR PROCESSING                                                    21240021
*      CERTAIN ERROR CONDITIONS ARE DIAGNOSED BY FORMLA AND PUTSGN,     21246021
*        Q.V.                                                           21252021
*      WHEN A NON-OPERAND IS FOUND WHERE AN OPERAND IS EXPECTED,SKI     21258021
*        TILL AND/OR/END                                                21264021
*      WHEN AND/OR/END NOT FOUND WHERE EXPECTED,SKIP TILL ONE IS FO     21270021
*      WHEN NO RELATIONAL IS FOUND WHERE EXPECTED ASSUME '='            21276021
*      WHEN 'NOT' PRECEDES RIGHT TERM, WARN, BUT TREAT AS THOUGH IT     21282021
*        NEGATED THE RELATIONAL                                         21288021
*      WHEN SEVERAL NOT'S FOLLOW EACH OTHER WITHOUT INTERVENING ('S     21294021
*        WARN BUT PROCESS NORMALLY                                      21300021
*      WHEN EXTRA 'IF' OR 'UNTIL' FOLLOWS AND/OR WARN,DISCARD,AND       21306021
*        CONTINUE NORMALLY                                              21312021
*      WHEN MODE OF LEFT AND RIGHT TERM ARE INCOMPATIBLE (ACCORDING     21318021
*        SRL MATRIX) SUBSTITUTE                                         21324021
*          'TALLY = ZERO'  IN CLASS OR SIGN TEST                        21330021
*          'SPACE' FOR RIGHT TERM IF LEFT IS ALPHABETIC IN REL. TES     21336021
*          'ZERO'  .   .     .    .  .    .  OTHER      .  .    .       21342021
*                                                                       21348021
*                                                                       21354021
*** NOTES                                                               21360021
*                                                                       21366021
*        THE SWITCHES PNDREL AND PRTURN ARE USED FOR HANDLING IMPLI     21372021
*          SUBJECTS AND RELATIONALS.                                    21378021
*              PNDREL IS TURNED ON WHENEVER AN IMPLIED SUBJECT WOUL     21384021
*                ILLEGAL, THAT IS, AT THE BEGINNING OF THE STATEMEN     21390021
*                AND AFTER A CONDITIONAL VARIABLE,SIGN TEST,OR CLAS     21396021
*                TEST IS FOUND. IT IS TURNED OFF WHEN A RELATIONAL      21402021
*                IS FOUND. IF PNDREL IS ON AND NO RELATIONAL IS FOU     21408021
*                IT IS AN ERROR.                                        21414021
*              PRTURN IS TURNED ON AFTER 'AND' OR 'OR' IF PNDREL IS     21420021
*                OFF. THEN THE PROGRAM BRANCHES DIRECTLY TO SEEK A      21426021
*                RELATIONAL. IF A RELATIONAL IS FOUND WHEN PRTURN I     21432021
*                ON,PROCESSING OF THE LEFT-HAND TERM IS INHIBITED.      21438021
*                PRTURN IS TURNED OFF (1) WHEN PNDREL IS TURNED ON,     21444021
*                (2) WHEN PNDREL IS OFF AND A RELATIONAL IS NOT FOU     21450021
*                NOW, THE NEXT TIME A RELATIONAL IS NOT FOUND AND       21456021
*                PNDREL IS OFF, THE PROGRAM BRANCHES TO HANDLE THE      21462021
*                OPERAND AS A RIGHT TERM                                21468021
*                                                                       21474021
*                                                                       21480021
*                                                                       21486021
*                                                                       21492021
*        HANDLING OF 'NOT' INVOLVES TWO SWITCHES, PNOTSW AND PNEGSW     21498021
*              PNOTSW IS TURNED ON WHEN 'NOT' IS FOUND,AND TURNED O     21504021
*               BY WHATEVER ROUTINE QUESTIONS IT. IF PUTSGN FINDS I     21510021
*               ON WHEN IT GETS A (, IT INVERTS THE POS-NEG BIT OF      21516021
*               PRECEDING LEVEL TO PRODUCE THE POS-NEG BIT OF THE N     21522021
*               LEVEL IN THE LABEL TABLE PTRFLS.                        21528021
*               IF PUTNIN FINDS IT ON IN PROCESSING AN OPERAND IT       21534021
*               INVERTS PNEGSW. WHEN IF FINDS IT ON IN PROCESSING       21540021
*               A RELATIONAL IT INVERTS THE RELATIONAL.                 21546021
*              PNEGSW IS INITIALIZED OFF, THEN INVERTED (ON-OFF-ON-     21552021
*               ETC.) AS NOTED ABOVE. IT IS ALSO INVERTED WHEN PUTS     21558021
*               FINDS A ) AND NOTES THAT THE POS-NEG BIT OF THIS LE     21564021
*               ON PTRFLS IS OPPOSITE TO THE POS-NEG BIT OF THE PRE     21570021
*               ING LEVEL.                                              21576021
*        AT THE END OF PROCESSING A SIMPLE CONDITION, IF PNEGSW IS      21582021
*          THE RELATIONAL IS REVERSED. PNEGSW HAS A PURELY LOCAL EF     21588021
*          AND DOES NOT CARRY TO THE IMPLIED RELATIONAL. THE PRESEN     21594021
*          OF THE NEG BIT ON THE CURRENT LEVEL OF PTRFLS HOWEVER CA     21600021
*          BOTH THE RELATIONAL TO BE REVERSED AND THE 'AND'S TO BEC     21606021
*          EFFECTIVELY 'OR'S AND VICE VERSA.                            21612021
*                                                                       21618021
*                                                                       21624021
*                                                                       21630021
*******************************************************************     21636021
       SPACE   6                                                        21642021
         USING *,RVRB                                                   21648021
IF       EQU   *                                                        21654021
       OI      PLOGIC,MSWON     SW TELLS SUBROUTINES WE ARE IN IF       21660021
       TM    SEARCHSW,MSWON   CALLED BY SEARCH                    5961  21666021
       BO    IF0              YES                                 5961  21672021
       TM    SRCHALSW,MSWON   CALLED BY SEARCH ALL                5961  21678021
       BO    IF0              YES                                 5961  21684021
       OI    IFSW1,MSWON      TURN ON IF SWITCH                   5961  21690021
IF0    DS    0H                                                   5961  21696021
       TM      PERFSW,MSWON      IS CALL FROM PERFORM                   21702021
         BC    ONES,*+NX12          YES                                 21708021
       LA      RA0,VERB44        PARAM FOR MSG 56                       21714021
       BAL     RCS,ISTRUV          NO - CHECK IF CONDITION ALLOWED      21720021
       L       RW2,APTFLS         STORE ZEROES IN PTRFLS TABLE          21726021
         L     RW2,DX0(RW2)                                             21732021
         LH    RW3,DX4(RW2)        RW3 GETS BYTES USED                  21738021
         MVC   DX4(LX2,RW2),N10     REDUCE COUNT-FIELD TO 2 ENTRIES     21744021
*                            THAT IS, 0 LEVEL AND POSSIBLE HIGHER H     21750021
*              (EXTRA ONE NEEDED WHEN AND,NOT AND, OR NOT OR FOUND)     21756021
         MVC   DSPTRF(LX2),N10     INIT SAVED DISPLACEMENT              21762021
         L     RW2,DX0(RW2)        RW2 GETS ADDR. OF TABLE              21768021
       LR      RW4,RW2            SAVE START OF PTRFLS IN RW4           21774021
       BCTR  RW3,RA0               DECREAMENT COUNT BY 1                21780021
IF1    CH      RW3,N256           ZERO ALL ENTRIES USED                 21786021
       BC      LO,IF2              LESS THAN 256 BYTES LEFT             21792021
         XC    DX0(LX256,RW2),DX0(RW2)                                  21798021
       AH      RW2,N256                                                 21804021
       SH      RW3,N256                                                 21810021
       BC      UNCOND,IF1          LOOP BACK                            21816021
IF2    LTR     RW3,RW3             ARE ALL ENTRIES USED                 21822021
         BC    ZERO,*+NX8          ALL ENTRIES USED                     21828021
       EX      RW3,CLEAN                                                21834021
       TM      PERFSW,MSWON       FOR 'UNTIL' IN PERFORM NEGATE THE     21840021
         BC    ZERO,*+NX8           ENTIRE CONDITION BY PUTTING NEG     21846021
         OI    DX0(RW4),MSWON       BIT AT LEVEL 0                      21852021
       BAL     RCS,PZSTRT         INIT. OTHER TABLES                    21858021
       LA    RW2,APNOUN                                                 21864021
       LA    RW1,APSGNT                                                 21870021
         NI    PNOTSW,MSWOFF       INITIALIZE SWITCHES                  21876021
       NI      IFERSW,MSWOFF                                            21882021
       NI      NOTRSW,MSWOFF                                            21888021
         XC    DMAXSW(LX2),DMAXSW                                       21894021
       NI      PRERSW,MSWOFF                                            21900021
         NI    PNEGSW,MSWOFF                                            21906021
         OI    PNDREL,MSWON                                             21912021
         XC    PRNLEV(LX2),PRNLEV    INITIALIZE LEVELS                  21918021
         XC    OPLEV(LX8),OPLEV    ERROR-CHECK LEVELS                   21924021
         MVC   HILEV(LX2),N5                                            21930021
         XC    DMAX(LX3),DMAX      INIT. EVAL STRING                    21936021
         MVI   EVAL+NX2,XX02                                            21942021
         XC    LEFTDP(LX2),LEFTDP  INIT. LEFT-TERM STRING POINTER       21948021
         XC    LEFTSS(LX2),LEFTSS    AND LEFT SUBSCRIPT POINTER         21954021
         XC    PRVSCT(LX2),PRVSCT                                       21960021
         XC    PNOUCT(LX2),PNOUCT                                       21966021
*                                                                       21972021
*              SEEK NOT ( NOT ( NOT )))                                 21978021
*                                                                       21984021
IF10   EQU     *                                                        21990021
         NI    PRTURN,MSWOFF       REINITIALIZE FOR COMPOUND CONDS.     21996021
*                                                                       22002021
       BAL     RCS,ISPRNO         PROCESS 'NOT'S AND LEADING '('S       22008021
*                                                                       22014021
*        SEEK OPERAND (LEFT TERM IF PNDREL ON, OTHERWISE EITHER TER     22020021
*                                                                       22026021
       BAL     RCS,FORMLA         IS IT FORMULA                         22032021
       BC      UNCOND,IFERR        NO - ERROR                           22038021
       BC      UNCOND,IF17         NO - NON-NUMERIC DATA OPERAND        22044021
IF16     MVC   OPLEV(LX2),PRNLEV     YES - SAVE LEVEL                   22050021
       CLI     PRSULT,MDN         IS IT SINGLE DATA-NAME                22056021
       BC      EQ,RELCLS          YES - SEEK CLASS,SIGN,OR RELATION     22062021
       CLI     PRSULT,MSS                                               22068021
       BC      EQ,RELCLS           SEEK CLASS,SIGN OR RELATION          22074021
       CLI     PRSULT,MIR         IS IT MULTI-OPERAND FORMULA           22080021
       BC      EQ,RELSGN          YES - SEEK SIGN OR RELATION           22086021
         CLC   PRSULT(LX2),CBTALY    SAME FOR 'TALLY'                   22092021
       BC      EQ,RELSGN           SEEK SIGN OR RELATION                22098021
       BC      UNCOND,RELTST       NO - LIT, SEEK RELATION TEST         22104021
IF17   BAL     RCS,PUTNIN          ENTER OPERAND IN PNOUNT              22110021
       BAL     RCS,PEMPTY          EMPTY OUT PSIGNS TABLE               22116021
       BC      UNCOND,IF16         SAVE LEVEL OF DN                     22122021
*                                                                       22128021
*                                                                       22134021
*              PROCESS RELATIONALS                                      22140021
*                                                                       22146021
*                                                                       22152021
*        A SINGLE DATA-NAME MAY BE LEFT TERM OF CLASS,SIGN,OR RELAT     22158021
*        A SINGLE LITERAL                   CONDITION,SIGN,OR RELAT     22164021
*        A MULTI-OPERAND FORMULA                SIGN,OR RELATION        22170021
*                                                                       22176021
*        PRELAT IS A ONE-BYTE FIELD IN WHICH THE RELATIONAL-CODE IS     22182021
*          STORED. AT THE END OF EACH SIMPLE TEST PRELAT IS MOVED T     22188021
*          PRLVRB - THAT IS, THE VERB FOR THE CURRENT TEST, AND         22194021
*          THERE REVERSED IF PNEGSW IS ON. PRELAT ITSELF REMAINS IN     22200021
*          ITS ORIGINAL STATE FOR POSSIBLE USE AS AN IMPLIED RELATI     22206021
*                                                                       22212021
*        PLEFT HOLDS THE LEFT TERM AND PRIGHT THE RIGHT TERM WHEN T     22218021
*          HAVE BEEN DETERMINED. PLEFT IS NOT CHANGED UNLESS TWO        22224021
*          OPERANDS SEPARATED BY A RELATIONAL ARE FOUND. THUS IT        22230021
*          REMAINS INTACT AS AN IMPLIED SUBJECT IF NEEDED.              22236021
*                                                                       22242021
*                                                                       22248021
*                                                                       22254021
*****                                                             *     22260021
*                                                                       22266021
*                        IS IT CLASS TEST                               22272021
*                                                                       22278021
RELCLS   BAL   RCS,ISISNO          (GET RID OF 'IS' AND 'NOT')          22284021
         CLC   GOTTEN(LX2),CBALF    IS IT 'ALPHABETIC'                  22290021
       BC      EQ,RELCL2          YES                                   22296021
         CLC   GOTTEN(LX2),CBNUM    IS IT 'NUMERIC'                     22302021
       BC      NOTEQ,RELSG1       NO - SEEK SIGN TEST                   22308021
       MVI     PRELAT,MNUMVB        RELAT. VERB FOR NUMERIC             22314021
       BC      UNCOND,RELCL4       NUMERIC VERB FOUND                   22320021
RELCL2 MVI     PRELAT,MALFVB        RELAT.VERB FOR ALPHABETIC           22326021
RELCL4 OI      CLASSW,MSWON                                             22332021
       BC      UNCOND,RELS12        GO PROCESS LEFT TERM                22338021
*                                                                       22344021
*                        IS IT SIGN TEST                                22350021
*                                                                       22356021
RELSGN   BAL   RCS,ISISNO          (GET RID OF 'IS' AND 'NOT')          22362021
RELSG1   CLC   GOTTEN(LX2),CBPOS    IS IT 'POSITIVE'                    22368021
         BC    EQ,RELS4             YES                                 22374021
         CLC   GOTTEN(LX2),CBNEG    IS IT 'NEGATIVE'                    22380021
         BC    EQ,RELS6             YES                                 22386021
         CLC   GOTTEN(LX2),CBZERO   IS IT 'ZERO'                        22392021
         BC    NOTEQ,RELT1          NO - SEEK RELATION TEST             22398021
*                                                                       22404021
*              SUPPLY RELATIONAL AND RIGHT TERM 'ZERO' FOR SIGN TES     22410021
*                                                                       22416021
         MVC   PRELAT(LX1),CBEQSN+NX1                                   22422021
       BC      UNCOND,RELS10      FOR ZERO WRITE = 0                    22428021
RELS4    MVC   PRELAT(LX1),CBMORE+NX1     'POSITIVE'    GREATER ZERO    22434021
         BC    UNCOND,RELS8        SUPPLY 'ZERO'                        22440021
RELS6    MVC   PRELAT(LX1),CBLESS+NX1     'NEGATIVE'    LESS    ZERO    22446021
RELS8    MVC   DX0(LX2,RIN),CBZERO  SUPPLY 'ZERO'                       22452021
RELS10 OI      SIGNSW,MSWON       SWITCH TESTED BY OKCOMP               22458021
*                                                                       22464021
*        PROCESS OPERANDS OF CONDITION,CLASS,OR SIGN TEST               22470021
*                                                                       22476021
RELS12   TM    PNOTSW,MSWON                                             22482021
         BC    ZERO,RELS14         'NOT' NOT FOUND                      22488021
         NI    PNOTSW,MSWOFF                                            22494021
       XI      PRELAT,MNEGRL       REVERSE RELATIONAL IF 'NOT' PREC     22500021
RELS14 OI      PNDREL,MSWON    TURN ON PNDREL,ILLEGALIZING IMPLIED      22506021
       NI      NOTRSW,MSWOFF      ANY 'NOT' FOUND WAS OK                22512021
       NI      PFNDIS,MSWOFF       'IS' WAS OK                          22518021
         MVC   RELLEV(LX2),PRNLEV  SAVE LEVEL FOR ERROR CHECK           22524021
       BAL     RCS,IFLEFT         GET LEFT TERM INTO PLEFT              22530021
       TM      CLASSW,MSWON       WAS IT CLASS TEST                     22536021
       BC      ZERO,IF22           NO - GO PUT RIGHT TERM IN PRIGHT     22542021
       BAL     RCS,GETNXT          YES - NO RIGHT TERM BUT PROCESS      22548021
         CLC   GOTTEN(LX2),CBRPRN    TRAILING )'S                       22554021
       BC      NOTEQ,OKCOMP        NO                                   22560021
       BAL     RCS,PUTSGN          YES, ENTER OPERATOR IN PSIGNT        22566021
       BC      UNCOND,OKCOMP       IS IT LEGAL COMBINATION              22572021
*                                                                       22578021
*                        IS IT RELATION TEST                            22584021
*                                                                       22590021
RELTST   BAL   RCS,ISISNO          (GET RID OF 'IS' AND 'NOT')          22596021
RELT1  CLI     GOTTEN,MREL        IS IT A RELATIONAL                    22602021
       BC      NOTEQ,RELT10         NO                                  22608021
         MVC   PRELAT(LX1),GOTTEN+NX1 YES - PUT ITS CODE IN PRELAT      22614021
       BAL     RCS,GETNXT          GET NEXT INPUT                       22620021
         CLC   PRELAT(LX1),CBEQSN+NX1 IS IT 'EQUAL TO'                  22626021
       BC      EQ,RELT2            YES                                  22632021
         CLC   GOTTEN(LX2),CBTHAN    OR 'MORE (LESS) THAN'              22638021
       BC      UNCOND,RELT4        TAKE PROPER BRANCH                   22644021
RELT2    CLC   GOTTEN(LX2),CBTO                                         22650021
RELT4  BC      NOTEQ,RELT6          NO                                  22656021
       BAL     RCS,GETNXT           YES                                 22662021
*                                                                       22668021
*              RELATION-TEST FOUND                                      22674021
*                                                                       22680021
RELT6  BAL     RCS,OKPREN          ARE PARENTHESIS OK                   22686021
       DC    XL1'2'              CHECK END VS LAST REL LEVEL            22692021
       DC      AL1(NOTHI)         OK IF END = OR LOW                    22698021
         MVC   RELLEV(LX2),PRNLEV SAVE NEW REL LEVEL                    22704021
RELT8    NI    PFNDIS,MSWOFF       TURN OFF ERROR SWITCH                22710021
         NI    PNDREL,MSWOFF       TURN OFF PNDREL,LEGALIZING IMPLI     22716021
       NI      NOTRSW,MSWOFF      ANY 'NOT' FOUND WAS OK                22722021
         TM    PRTURN,MSWON                                             22728021
       BC    ZERO,RELT9            NOT 'AND' OR 'OR'                    22734021
       BAL     RCS,OKPREN          ARE PAREN OK                         22740021
       DC      XL1'0'            CHECK END VS LAST LEFT LEVEL           22746021
       DC    AL1(NOTLO)           OK IF END = OR HIGH                   22752021
       TM    PNOTSW,MSWON      WAS NOT FOUND                            22758021
       BC    ZERO,IF20         NO                                       22764021
       NI    PNOTSW,MSWOFF                                              22770021
       XI    PNEGSW,MSWON          NEGATES JUST THIS RELATIONAL         22776021
       B     IF20                  SEEK RIGHT-TERM                      22782021
RELT9  TM    PNOTSW,MSWON          WAS 'NOT' FOUND                      22788021
       BC    ZERO,IF18             NO                                   22794021
       NI    PNOTSW,MSWOFF                                              22800021
       XI    PRELAT,MNEGRL       REL FOLLOWED BY SUBJ-                  22806021
*                                  NEGATES THE RELATIONAL               22812021
       B     IF18                  'NOT' FOUND                          22818021
*                                   NEW RIGHT-TERM                      22824021
*                                                                       22830021
*              NO RELATIONAL OF ANY KIND FOUND                          22836021
*                                                                       22842021
*                                                                       22848021
RELT10   TM    PFNDIS,MSWON        WAS 'IS' FOUND                       22854021
         BC    ZERO,RELT12         NO                                   22860021
RELT11 BAL     RCS,ERRIF           YES - ERROR                          22866021
       LA      RW1,ELST0D                                               22872021
         MVC   PRELAT(LX1),CBEQSN+NX1                                   22878021
         BC    UNCOND,RELT6        RELATION OPERATOR FOUND              22884021
RELT12   TM    PNOTSW,MSWON        WAS 'NOT' FOUND                      22890021
         BC    ZERO,RELT14         NO                                   22896021
       XI    PNEGSW,MSWON                                               22902021
       NI    NOTRSW,MSWOFF      ALLOW NOT BEFORE OBJECT                 22908021
         NI    PNOTSW,MSWOFF                                            22914021
RELT14   TM    PNDREL,MSWON        WAS RELATIONAL REQUIRED              22920021
       BC      ONES,RELT11        YES - ERROR, ASSUME '='               22926021
         TM    PRTURN,MSWON        NO- IF PRTURN IS OFF GO PROCESS      22932021
       BC      NOTZER,IF10         DO NOT PROCESS                       22938021
       BAL     RCS,OKPREN         CHECK END VS LAST LEFT AND REL LE     22944021
       DC      XL1'4'              VS LAST LEFT AND REL LEVEL           22950021
       DC      AL1(NOTLO)         OK IF END = OR HIGH                   22956021
       BC      UNCOND,IF26         GO TO PROCESS RIGHT TERM             22962021
       BC      UNCOND,IF10        IF IT IS ON, GO SEEK AN OPERAND       22968021
*                                                                       22974021
*                                                                       22980021
******                                                          ***     22986021
*                    RELATIONAL HAS NOW BEEN PROCESSED                  22992021
*      GET OPERANDS , GET BRANCH-IDENTIFIERS AND CREATE STRINGS         22998021
*                                                                       23004021
*****                                                            **     23010021
*                                                                       23016021
*              OPERAND IN NOUNS TABLE IS LEFT TERM                      23022021
*                                                                       23028021
IF18   BAL     RCS,IFLEFT         GET LEFT TERM IN PLEFT                23034021
*                                                                       23040021
*                        SEEK RIGHT-TERM                                23046021
*                                                                       23052021
IF20   BAL     RCS,ISPRNO         PROCESS LEADING 'NOT'S AND '('S       23058021
       BAL     RCS,FORMLA         IS OPERAND A FORMULA                  23064021
       BC      UNCOND,IFERR        NO - ERROR                           23070021
       BC      UNCOND,IF22         NO - NON-NUMERIC DATA OPERAND        23076021
       BC      UNCOND,IF26         YES                                  23082021
IF22   BAL     RCS,PUTNIN         YES - PUT IN NOUNS TABLE              23088021
         BAL   RCS,PEMPTY          EMPTY OUT PSIGNS TABLE               23094021
*                                                                       23100021
*                        PROCESS RIGHT TERM                             23106021
*                                                                       23112021
IF26   NI      IFERSW,MSWOFF      IF WE GOT HERE WE'VE RECOVERED FR     23118021
*                                  ASSUMPTIONS MADE AT IFERR, IF AN     23124021
       TM      NOTRSW,MSWON        DID 'NOT' PRECEDE LAST OPERAND       23130021
       BC      ZERO,IF27           NO -OK                               23136021
       NI      NOTRSW,MSWOFF       YES -ERROR                           23142021
       BAL     RCS,ERROR           ERROR                                23148021
       LA      RW1,ELST1B                                               23154021
IF27   BAL     RCS,IFRIT           MOVE RESULT TO PRIGHT                23160021
       BC      UNCOND,OKCOMP      SEE IF LEFT AND RIGHT ARE COMPATI     23166021
*******************************************************************     23172021
*                                                                       23178021
*                                                                       23184021
*              END OF TEST-PORTION OF IF STATEMENT                      23190021
*                                                                       23196021
*              'OR','AND',OR AN ENDWORD SHOULD FOLLOW                   23202021
*                                                                       23208021
*        BYPASS-BRANCHES WILL GO INTO PSHTBL, FALL-THRU BRANCHES        23214021
*         WILL BE GENERATED AS ATTACHED TO NEXT STATEMENT               23220021
*                                                                       23226021
*                                                                       23232021
*                                                                       23238021
IF28   TM    SRCHALSW,MSWON                                             23244021
       BZ    IF281                 NO                                   23250021
       L     RVRB,ASRCHAL                                               23256021
       USING SRCHAL,RVRB                                                23262021
       B     AFTCM1                STORE IN STRING                      23268021
       USING IF,RVRB                                                    23274021
IF281  EQU   *                                                          23280021
         MVC   PRLVRB+NX1(LX1),PRELAT ATTACH RELATIONAL CODE TO VERB H  23286021
         TM    PNEGSW,MSWON                                             23292021
       BC      ZERO,IF29           SWITCH IS OFF                        23298021
         NI    PNEGSW,MSWOFF       PNEGSW ON,REVERSE VERB               23304021
         XI    PRLVRB+NX1,MNEGRL                                        23310021
IF29     BAL   RW6,IF30            LOAD RW6 WITH ADDR. OF PTRFLS GU     23316021
*                                                                       23322021
*                                                                       23328021
*  PTRFLS GUIDE                                                         23334021
*        START SEARCHING PTRFLS TABLE AT START+PRNLEV+BYTE1 FOR BYP     23340021
*                                        START+PRNLEV+BYTE2 FALL-TH     23346021
*        IF TERMINATOR IS                                               23352021
*                                                                       23358021
       DC      XL2'0301'       END                                      23364021
       DC      XL2'0306'       AND                                      23370021
       DC      XL2'0103'       OR                                       23376021
       DC      XL2'0608'       NOT AND                                  23382021
       DC      XL2'0306'       NOT OR                                   23388021
*                                                                       23394021
IF30   BAL     RCS,ISEND     IS IT ENDWORD                              23400021
         BC    UNCOND,*+NX8        NO                                   23406021
         BC    UNCOND,IF34         YES                                  23412021
         CLC   GOTTEN(LX2),CBNEXT   IS IT 'NEXT'                        23418021
         BC    EQ,IF34             YES - TREAT AS END                   23424021
         OI    PRTURN,MSWON                                             23430021
         CLC   GOTTEN(LX2),CBAND    IS IT 'AND'                         23436021
         BC    EQ,IF36             YES                                  23442021
         CLC   GOTTEN(LX2),CBOR     IS IT 'OR'                          23448021
         BC    EQ,IF40             YES                                  23454021
       TM      PERFSW,MSWON                                             23460021
       BC      ZERO,IF31           GET NEXT ENTITY                      23466021
         CLC   GOTTEN(LX2),CBAFTR  IS IT 'AFTER' IN PERFORM             23472021
       BC      EQ,IF34            YES - TREAT AS END                    23478021
IF31   BAL     RCS,ERONCE         NO - WRITE MSG ONLY ONCE              23484021
       LA      RW1,ELST1E                                               23490021
       TM    SEARCHSW,MSWON                                             23496021
       BZ   IF32                   NOT ON                               23502021
         CLC   GOTTEN(LX2),CBWHEN                                       23508021
       BNE   IF32                  NOT 'WHEN'                           23514021
       B     IF34                  YES                                  23520021
IF32   BAL   RCS,GETNXT            GET NEXT INPUT                       23526021
         BC    UNCOND,IF30         CHECK IF ENEWORD                     23532021
*                                                                       23538021
*                     IF-TERMINATOR FOUND                               23544021
*                                                                       23550021
IF34     NI    PRTURN,MSWOFF       TURN OFF PRTURN. THIS IS END         23556021
         XC    LEFTDP(LX2),LEFTDP  NOTE-SINCE GNARTH AT END RESTORES    23562021
         XC    LEFTSS(LX2),LEFTSS   THE TAMM DISPL. TO THEIR LEFT       23568021
*                                  VALUES, THIS CAUSES TABLES TO EM     23574021
         CLC   PRNLEV(LX2),N0       IS PRN LEVEL 0                      23580021
       BC      EQ,IF37              YES / OK                            23586021
       BAL     RCS,ERROR           PRN LEVEL NOT 0                      23592021
       LA      RW1,ELST06                                               23598021
         XC    PRNLEV(LX2),PRNLEV                                       23604021
IF37   TM      PERFSW,MSWON                                             23610021
       BC      ONES,IF44          FOR UNTIL D O N ' T                   23616021
         XI    PRLVRB+NX1,MNEGRL     FOR IF  D O                        23622021
       BC      UNCOND,IF44              REVERSE RELATIONAL              23628021
IF36     LA    RW6,DX2(RW6)         RW6=2 FOR AND                       23634021
         XI    PRLVRB+NX1,MNEGRL   REVERSE RELATIONAL FOR 'AND'         23640021
         BC    UNCOND,IF42         CREATE STRINGS                       23646021
IF40     LA    RW6,DX4(RW6)         RW6=4 FOR OR                        23652021
*                                                                       23658021
*                                                                       23664021
*                   CREATE STRINGS                                      23670021
*                                                                       23676021
*                                                                       23682021
IF42     LH    RW2,PRNLEV          RW2 HOLDS PAREN LEVEL (KEPT IN       23688021
       L       RW1,APTFLS            MULTIPLES OF 5)                    23694021
         L     RW1,DX0(RW1)                                             23700021
         L     RW1,DX0(RW1)         RW1  ADDR. OF START OF TABLE        23706021
         AR    RW1,RW2               +PAREN LEVEL                       23712021
         TM    DX0(RW1),MSWON       IS 'NOT' ACTIVE AT THIS LEVEL       23718021
         BC    ZERO,IF44           NO                                   23724021
         LA    RW6,DX4(RW6)         RW6=RW6+4 (I.E.,6'AND',8 'OR')      23730021
IF44     MVC   PLOW+NX1(LX1),DX0(RW6) PLOW GETS 1ST BYTE OF PTRFLS GUID 23736021
         OI    IFBYPS,MSWON        INDICATE BYPASS PROCESSING   ( P     23742021
       BAL     RCS,PFINDL          GO PUT LABELS OF HIGHER LEVELS I     23748021
       LA      RW4,PRLVRB         STORE RELATIONAL VERB IN STRING       23754021
       BAL     RCS,STOR45          STORE IN STRING                      23760021
       LA      RW4,PLEFT                                                23766021
         BAL   RCS,STOR45          PUT LEFT TERM IN STRING              23772021
       TM      CLASSW,MSWON       IS IT CLASS TEST                      23778021
       BC      ZERO,IF45            NO                                  23784021
       NI      CLASSW,MSWOFF                                            23790021
       BAL     RCS,PCHCNT          YES - ELEMENT COUNT = 2              23796021
       DC      XL2'2'             ... NO RIGHT TERM                     23802021
       BC      UNCOND,IF46         STORE RIGHT TERM                     23808021
IF45   LA      RW4,PRIGHT                                               23814021
         BAL   RCS,STOR45         PUT RIGHT TERM IN STRING              23820021
IF46   LA      RW4,RGN            PUT MASTER BYPASS-LABEL IN STRING     23826021
       BAL     RCS,STOR45          STORE GN IN STRING                   23832021
       BAL     RCS,GNARTH          GENERATE STRINGS                     23838021
*                                                                       23844021
*                        FINAL HOUSEKEEPING                             23850021
*                                                                       23856021
         MVC   PLOW+NX1(LX1),DX1(RW6) MOVE BYTE2 OF PTRFLS GUIDE TO  P  23862021
IF50     MVC   WHENGN+NX1(LX2),RGN+NX1                                  23868021
       BAL   RCS,PFINDL            GENR FALL-THRU LABELS IF ANY         23874021
       TM      PRTURN,MSWON       WAS IT END OF STATEMENT               23880021
         BC    ONES,IF52           NO                                   23886021
       NI      PLOGIC,MSWOFF                                            23892021
       NI      IFERSW,MSWOFF                                            23898021
       TM      PERFSW,MSWON       WAS CALL FROM PERFORM                 23904021
       BC      ONES,IF51             YES                                23910021
         BAL   RCS,ISNXTS          YES- IS IT 'NEXT SENTENCE'           23916021
       BC    UNCOND,IF50A          NOT 'NEXT'                           23922021
         BAL   RCS,PGONXT          PROCESS NEXT SENTENCE                23928021
         BAL   RCS,GENSTR          GENR  GO TO NEXT SENTENCE            23934021
       OI    GOSW,MSWON            LET SEARCH KNOW NEXT SENT GENR       23940021
         OI    PSKPGO,MSWON          AVOID REDUNDANT GO AT 'ELSE'       23946021
IF50A  TM    SEARCHSW,MSWON                                             23952021
       BZ    IDENT                 EXIT                                 23958021
       L     RVRB,ASRCH                                                 23964021
       USING SEARCH,RVRB                                                23970021
       B     SRCH10                GIVE CONTROL TO IMPER. STMT          23976021
       USING IF,RVRB                                                    23982021
IF51   L       RVRB,APRFRM                                              23988021
       USING   PRFORM,RVRB                                              23994021
       BC      UNCOND,UNTIL2       EVALUATE CONDITION                   24000021
       USING   IF,RVRB                                                  24006021
*                                                                       24012021
IF52   EQU     *                                                        24018021
       L       RW1,APTFLS         SHRINK BACK DISPL. FIELD OF PTRFL     24024021
         L     RW1,DX0(RW1)          TAMM                               24030021
       LH      RW2,PRNLEV                                               24036021
         LA    RW2,DX5(RW2)        KEEP HILEV ALWAYS AT PRNLEV+5        24042021
       STH     RW2,HILEV                                                24048021
         LA    RW2,DX5(RW2)        DISPL. OF TAMM IS HILEV+5            24054021
         STH   RW2,DX4(RW1)                                             24060021
       STH     RW2,DSPTRF                                               24066021
         MVC   PRVLEV(LX2),PRNLEV   SAVE PAREN LEVEL IN CASE OF ERRO    24072021
       L       RW1,APSGNT                                               24078021
         L     RW1,DX0(RW1)                                             24084021
         MVC   PRVSCT(LX2),DX4(RW1)   SAVE SIGN-TABLE DISPL.            24090021
         XC    DMAXSW(LX2),DMAXSW  INIT. SW. FOR DIVISORS AND EXPONE    24096021
         XC    DMAX(LX2),DMAX      REINIT. EVAL VERB                    24102021
       NI    PRELAT,MNOIND                                              24108021
       NI      PRELAT,MNOALF      TURN OFF ALF BIT INCASE IMPLIED       24114021
         BAL   RCS,GETNXT               DISCARD TERMINATOR              24120021
       TM      PERFSW,MSWON        IS IT CALL FROM PERFORM              24126021
       BC      ZERO,IF54           NO                                   24132021
         CLC   GOTTEN(LX2),CBUNTL  DOES EXTRA 'UNTIL' FOLLOW IN PERF    24138021
       BC      NOTEQ,IF58           NO OK                               24144021
       LA      RA0,CBUNTL           YES - TRIVIAL ERROR                 24150021
       BC      UNCOND,IF56         WRITE MESSAGE                        24156021
IF54     CLC   GOTTEN(LX2),CBIF    DOES EXTRA 'IF' FOLLOW               24162021
       BC      NOTEQ,IF58           NO - OK                             24168021
       LA      RA0,CBIF                                                 24174021
IF56   BAL     RCS,ERROR             YES-TRIVIAL ERROR                  24180021
       LA      RW1,ELST08                                               24186021
       BAL     RCS,GETNXT            DISCARD IT                         24192021
IF58   TM      PNDREL,MSWON                                             24198021
       BC      ONES,IF10          PNDREL ON - RETURN TO START           24204021
       BC      UNCOND,RELTST        OFF - SEEK RELATIONAL               24210021
*                                                                       24216021
*        SYNTAX ERROR IN IF                                             24222021
*        UNACCEPTABLE RIGHT- OR LEFT-TERM, OR MISSING RELATIONAL        24228021
*                                                                       24234021
IFERR  BAL     RCS,ERRIF           ERROR IN IF                          24240021
       LA      RW1,ELST5B                                               24246021
IFERR2 TM    SRCHALSW,MSWON                                             24252021
       BZ    IFER2                 THIS IS AN END                       24258021
       L     RVRB,ASRCHAL                                               24264021
       USING SRCHAL,RVRB                                                24270021
       B     AFTCOM                INVALID COMPARISON                   24276021
       USING IF,RVRB                                                    24282021
IFER2  OI    GENRED,MSWON                                               24288021
       BAL     RCS,ISEND               IS IT END                        24294021
         BC    UNCOND,IFERR3       NO                                   24300021
         BC    UNCOND,IFERR5            YES                             24306021
IFERR3   CLC   GOTTEN(LX2),CBNEXT  TREAT 'NEXT' AS END                  24312021
       BC      EQ,IFERR5           IT IS NEXT                           24318021
       OI      PRTURN,MSWON                                             24324021
         CLC   GOTTEN(LX2),CBAND    IS IT 'AND                          24330021
         BC    EQ,IFERR6                YES                             24336021
         CLC   GOTTEN(LX2),CBOR     IS IT 'OR'                          24342021
       BC      EQ,IFERR6               YES                              24348021
       TM    SEARCHSW,MSWON                                             24354021
       BZ    *+18                  IS IT SEARCH                         24360021
         CLC   GOTTEN(LX2),CBWHEN                                       24366021
       BNE   IFERR4                NOT 'WHEN'                           24372021
       B     IFERR5                YES 'WHEN'                           24378021
       TM      PERFSW,MSWON                                             24384021
       BC    ZERO,IFERR4           NOT PERFORM                          24390021
         CLC   GOTTEN(LX2),CBAFTR  IS IT 'AFTER' IN PERFORM             24396021
       BC      EQ,IFERR5           YES - TREAT AS END                   24402021
IFERR4 BAL   RCS,GETNXT            GET NEXT INPUT                       24408021
         BC    UNCOND,IFERR2       CHECK FOR SEARCH ALL                 24414021
IFERR5   XC    PRNLEV(LX2),PRNLEV   ZERO PAREN LEVEL FOR END            24420021
         NI    PRTURN,MSWOFF                                            24426021
         XC    LEFTDP(LX2),LEFTDP                                       24432021
         XC    LEFTSS(LX2),LEFTSS                                       24438021
       BC      UNCOND,IFER20       FOUND TERMINATOR                     24444021
*                                                                       24450021
*                        TERMINATOR FOUND, CONTINUE NORMALLY            24456021
*                                                                       24462021
IFERR6   MVC   PRNLEV(LX2),PRVLEV   RESTORE FORMER LEVEL FOR AND,OR     24468021
         MVC   RELLEV(LX2),PRNLEV  HOPE AVOID MORE MSG BY MAKING REL    24474021
         MVC   LFTLEV(LX2),PRNLEV   LFT LEV =                           24480021
       NI      NOTRSW,MSWOFF      TURN OFF ALL NEGATION SWITCHES        24486021
       NI      PNEGSW,MSWOFF                                            24492021
       NI      PNOTSW,MSWOFF                                            24498021
       BAL     RCS,PZSTRT          REINIT. TAMER TABLES                 24504021
       LA    RW1,APNOUN                                                 24510021
         XC    PNOUCT(LX2),PNOUCT                                       24516021
         L     RW1,APSGNT          RESTORE SIGNS TO PREVIOUS COUNT      24522021
         L     RW1,DX0(RW1)                                             24528021
         MVC   DX4(LX2,RW1),PRVSCT                                      24534021
         MVC   DSPSGN(LX2),PRVSCT                                       24540021
IFER20 L       RW1,ASTRNG         RESTORE TAMM AND SAVED DISPL. TO      24546021
         L     RW1,DX0(RW1)         THAT OF LAST LEFT TERM              24552021
         MVC   DX4(LX2,RW1),LEFTDP                                      24558021
         MVC   DSPSTR(LX2),LEFTDP                                       24564021
       L       RW1,ADFSBS                                               24570021
         L     RW1,DX0(RW1)                                             24576021
         MVC   DX4(LX2,RW1),LEFTSS                                      24582021
         MVC   DSPSBS(LX2),LEFTSS                                       24588021
         MVC   PLOW(LX2),N3        ASSUME LEVEL 0 AND END FOR LABELS    24594021
         OI    IFBYPS,MSWON        STORE BY-PASS LABELS                 24600021
         BAL   RCS,PFINDL           (NEVER MIND NOT,ETC. THIS IS JU     24606021
         MVC   PLOW(LX2),N1           TO AVOID UNDEFINED LABELS         24612021
       NI      MSGSW,MSWOFF                                             24618021
       OI      IFERSW,MSWON          AVOID CASCADING MESSAGES           24624021
         BC    UNCOND,IF50         DO FINAL HOUSEKEEPING                24630021
*                                                                       24636021
*      SUB-SUB-ROUTINE TO PROCESS NOT ( NOT ( NOT ...                   24642021
*                                                                       24648021
ISPRNO EQU     *                                                        24654021
       ST      RCS,SVISPR                                               24660021
ISPR2    CLC   GOTTEN(LX2),CBNOT     IS IT 'NOT'                        24666021
       BC      NOTEQ,ISPR6         NO                                   24672021
       OI      NOTRSW,MSWON       YES - ERRSW IN CASE IT PRECEDES R     24678021
       TM      PNOTSW,MSWON       WAS PREVIOUS ALSO 'NOT'               24684021
       BC      ZERO,ISPR4         NO                                    24690021
       BAL     RCS,ERROR           YES - ERROR                          24696021
       LA      RW1,ELST1C                                               24702021
ISPR4  XI      PNOTSW,MSWON       REVERSE NOTSW                         24708021
       BAL     RCS,GETNXT          GET NEXT INPUT                       24714021
       BC      UNCOND,ISPR2       SEEK ANOTHER 'NOT'                    24720021
ISPR6    CLC   GOTTEN(LX2),CBLPRN  IS IT (                              24726021
       BC      NOTEQ,ISPR8          NO - EXIT                           24732021
       BAL     RCS,PUTSGN           YES - PROCESS IT AND ALL FOLLOW     24738021
       BC      UNCOND,ISPR2       SEE IF 'NOT' FOLLOWS                  24744021
ISPR8  L       RCS,SVISPR                                               24750021
       BCR     UNCOND,RCS          EXIT                                 24756021
*                                                                       24762021
*    SUB-SUBROUTINE USED BY RELCLS,RELSGN,RELTST TO DISCARD 'IS','N     24768021
*                                                                       24774021
ISISNO   EQU   *                                                        24780021
       ST      RCS,SVISNO                                               24786021
ISISN1 BAL     RCS,ISPRNO         PROCESS 'NOT'S AND '('S               24792021
         CLC   GOTTEN(LX2),CBIS    IS INPUT 'IS'                        24798021
       BC      NOTEQ,ISISN4       NO - EXIT                             24804021
       TM      PFNDIS,MSWON        IS IT A REPEATED 'IS'                24810021
       BC      ZERO,ISISN2          NO                                  24816021
       LA      RA0,CBIS                                                 24822021
       BAL     RCS,ERROR           YES - ERROR                          24828021
       LA      RW1,ELST08                                               24834021
ISISN2 OI      PFNDIS,MSWON       ERRSW IN CASE NO RELATIONAL FOUND     24840021
       BAL     RCS,GETNXT         DISCARD 'IS'                          24846021
       BC      UNCOND,ISISN1      SEEK FURTHER 'NOT'S AND '('S          24852021
ISISN4 L       RCS,SVISNO                                               24858021
         BCR   UNCOND,RCS          EXIT                                 24864021
*                                                                       24870021
*                                                                       24876021
*                             O K P R E N                               24882021
*                                                                       24888021
*    SUB-SUBROUTINE TO CHECK LOGIC OF PARENTHESIS CHANGES FOR IMPLI     24894021
*       LEFT TERMS AND RELATIONALS                                      24900021
*                                                                       24906021
*      BAL     RCS,OKPREN                                               24912021
*      DC      XL1'N'                                                   24918021
*      DC      AL1(COND)                                                24924021
*      (RETURN)                                                         24930021
*                                                                       24936021
*              N=0 IF LFTLEV TO BE CHECKED                              24942021
*                2    RELLEV                                            24948021
*                4    BOTH                                              24954021
*                                                                       24960021
*              COND IS NOTLO OR NOTHI,WHICHEVER GIVES CORRECT BRANC     24966021
*              FROM    CLC   ENDLEV(2),LEV-IN-QUESTION                  24972021
*                                                                       24978021
*      IN PROCESSING IF, WHEN AND/OR IS FOUND PRNLEV GOES INTO ENDL     24984021
*                             RELATIONAL  .     .     .    .   RELL     24990021
*                             OPERAND     .     .     .    .   OPLE     24996021
*                             LEFT TERM   .   OPLEV   .    .   LFTL     25002021
*                                                                       25008021
*      SOMETHING IS ASSUMED TO BE ILLOGICAL ABOUT PARENTHETIZATION      25014021
*       WHEN                                                            25020021
*              A LEFT TERM IS FOUND AND LFTLEV (LEVEL OF LAST-FOUND     25026021
*                LEFT)IS LESS THAN ENDLEV (LEVEL OF LAST AND/OR)        25032021
*              A RELATIONAL IS FOUND AND RELLEV (LEVEL OF LAST RELA     25038021
*                TIONAL) IS LESS THAN ENDLEV                            25044021
*              A LEFT TERM IS IMPLIED AND LFTLEV IS GREATER THAN        25050021
*                ENDLEV                                                 25056021
*              A RELATIONAL IS IMPLIED AND RELLEV IS GREATER THAN       25062021
*                ENDLEV                                                 25068021
*                                                                       25074021
*                                                                       25080021
OKPREN EQU     *                                                        25086021
*                                                                       25092021
       TM      PRERSW,MSWON       HAS A MSG ALREADY BEEN ISSUED         25098021
         BC    ONES,DX2(RCS)        YES - EXIT                          25104021
       STM     RCS,RW2,SVOKPR                                           25110021
         LA    RA0,DX1             RA0 CONTROLS LOOP                    25116021
         LH    RW2,DX0(RCS)        RW2 HOLDS CONDITION FOR BRANCH       25122021
         SLA   RW2,DX4                                                  25128021
       SR      RW1,RW1                                                  25134021
         IC    RW1,DX0(RCS)        RW1 INDICATES WHETHER RELLEV OR L    25140021
       LA      RW1,LFTLEV(RW1)                                          25146021
         TM    DX0(RCS),XX04       ARE 2 CHECKS NEEDED                  25152021
       BC      ZERO,OKPR4           NO                                  25158021
         LA    RA0,DX2               YES - SET RA0                      25164021
OKPR2  SH      RW1,N2               FOR DOUBLE-CHECK,POINT BACK HW      25170021
OKPR4    CLC   ENDLEV(LX2),DX0(RW1) COMPARE LEVELS                      25176021
       EX      RW2,OKPR10           BRANCH ON CONDITION IN RW2          25182021
       BAL     RCS,ERRIF               NOT OK                           25188021
       LA      RW1,ELST54                                               25194021
       OI      PRERSW,MSWON       AVOID FURTHER MSGS                    25200021
       BC      UNCOND,OKPR8       DONT CHECK BOTH,1 MSG ENOUGH          25206021
OKPR6  BCT     RA0,OKPR2          GO BACK FOR 2ND COMPARISON            25212021
OKPR8  LM      RCS,RW2,SVOKPR                                           25218021
         BC    UNCOND,DX2(RCS)     EXIT                                 25224021
*                                                                       25230021
OKPR10 BC      NOP,OKPR6          OK                                    25236021
*                                                                       25242021
*      SUB-SUBROUTINES OF IF TO MOVE RESULT (IN PRSULT) TO              25248021
*        PLEFT OR PRIGHT, ACCORDING AS IF HAS DETERMINED IT TO BE       25254021
*        LEFT OR RIGHT TERM                                             25260021
*                                                                       25266021
*      BAL     RCS,IFLEFT         BAL      RCS,IFRIT                    25272021
*      (RETURN)                   (RETURN)                              25278021
*                                                                       25284021
*                                                                       25290021
*      IN ADDITION IF LEFT -- WHICH ASSURES THAT A NEW LEFT TERM HA     25296021
*        BEEN FOUND -- DELETES ANY STRINGS THAT MAY HAVE BEEN PRESE     25302021
*        IN CASE THE PRECEDING LEFT TERM WAS AN IR THAT MIGHT HAVE      25308021
*        USED AS AN IMPLIED SUBJECT                                     25314021
*                                                                       25320021
*                                                                       25326021
IFLEFT EQU     *                                                        25332021
       ST      RCS,SVISPR                                               25338021
       BAL     RCS,OKPREN          IS PAREN OK                          25344021
       DC      XL1'0'            CHECK END VS LAST LEFT LEVEL           25350021
       DC      AL1(NOTHI)         OK IF END = OR LOW                    25356021
         MVC   LFTLEV(LX2),OPLEV  SAVE NEW LEFT LEVEL                   25362021
       L       RW1,ASTRNG         MOVE STRING BACK FROM OLD LEFT DI     25368021
       BAL     RCS,PACKTB           TO DISPL. 0, DELETING OLD LEFT      25374021
       LH      RW2,LEFTDP                                               25380021
         LA    RW3,DX0                                                  25386021
         MVC   LEFTDP(LX2),DSPSTR  SET LEFTDP TO NEW DISPL.             25392021
       L       RW1,ADFSBS                                               25398021
       BAL     RCS,PACKTB         DO SAME WITH DEFSBS TABLE             25404021
       LH      RW2,LEFTSS                                               25410021
         LA    RW3,DX0                                                  25416021
         MVC   LEFTSS(LX2),DSPSBS                                       25422021
       L       RCS,SVISPR                                               25428021
       SR      RW1,RW1                                                  25434021
         BC    UNCOND,*+NX8        SAVE RETURN POINTER                  25440021
IFRIT  LA      RW1,MOPLNG         POINT RW1 TO RIGHT                    25446021
       ST      RCS,SVIFRT                                               25452021
       LA      RW1,PLEFT(RW1)                                           25458021
       LA      RW2,PRSULT                                               25464021
       BAL     RCS,COUNT           GET TOTAL OF BYTES                   25470021
       LH      RW2,BYTES                                                25476021
       EX      RW2,IFMVC          MOVE PRSULT TO RESPECTIVE FIELD       25482021
         MVC   MOPLNG-NX3(LX1,RW1),DMAX STORE RESPECTIVE DMAX           25488021
         XC    DMAX(LX1),DMAX                                           25494021
         CLI   DX0(RW1),XX39     IS IT SPEC ALL GT 1 CHAR               25500021
       BNE     *+NX14              NO - OK TO GETMOD                    25506021
         MVC   MOPLNG-NX2(LX2,RW1),ALLGTMD     GET MODE CANT HANDLE IT  25512021
       B     IFLR            EXIT                                       25518021
       BAL     RCS,GETMOD          GET MODE                             25524021
         MVC   MOPLNG-NX2(LX2,RW1),MODE STORE RESPECTIVE MODE           25530021
IFLR   L    RCS,SVIFRT        XIT                                       25536021
       BCR     UNCOND,RCS         RETURN                                25542021
*                                                                       25548021
IFMVC    MVC   DX0(LX1,RW1),PRSULT                                      25554021
*                                                                       25560021
*                                                                       25566021
*     SUBROUTINES TO COMPARE ATTRIBUTES OF LEFT AND RIGHT TERMS TO      25572021
*        INSURE LEGAL COMBINATION,AND TO CHANGE VERB FOR NON-NUMERI     25578021
*        COMPARISONS                                                    25584021
*      IF ILLEGAL COMBINATION IS FOUND, TALLY = ZERO  IS SUBSTITUTE     25590021
*        FOR THE TOTAL STRING                                           25596021
*      MODEL AND MODER CONTAIN ROUGH CLASSIFICATION (SEE GETMOD)        25602021
*      MODEL+1 AND MODER+1 CONTAIN ACTUAL MODE                          25608021
*                                                                       25614021
*                                                                       25620021
*                                                                       25626021
OKCOMP TM    CLASSW,MSWON          IS IT CLASS TEST                     25632021
       BC      ONES,OKCLAS          YES                                 25638021
       TM      SIGNSW,MSWON       IS IT SIGN                            25644021
       BC      ZERO,OKRELT          NO - MUST BE RELATION TEST          25650021
       NI      SIGNSW,MSWOFF        YES                                 25656021
       BC      UNCOND,OKSIGN       IS SIGN OK                           25662021
       SPACE   3                                                        25668021
*                                                                       25674021
*      FOR CLASS TEST. NOTE WE ALREADY KNOW LEFT IS DN, OR IT NEVER     25680021
*        WOULD HAVE FOUND CLASS TEST.                                   25686021
*                                                                       25692021
OKCLAS TM    MODEL,MGRPBT          IS DNM A GROUP ITEM                  25698021
       BC    ONES,IF28          YES- OK                                 25704021
         CLI   MODEL+NX1,MANMOD                                         25710021
       BC      EQ,IF28            AN OK FOR BOTH                        25716021
       CLI     PRELAT,MNUMVB      IS IT 'NUMERIC'                       25722021
       BC      LO,OKCLS2           NO - ALPHABETIC                      25728021
         CLI   MODEL+NX1,MIDMOD    'NUMERIC' NEEDS AN,ID,OR ED          25734021
       BC      EQ,IF28            OK                                    25740021
         CLI   MODEL+NX1,MEDMOD                                         25746021
       BC      EQ,IF28            OK                                    25752021
       BC      UNCOND,OKCLS3       NO - ERROR                           25758021
OKCLS2   CLI   MODEL+NX1,MALMOD    'ALPHABETIC' NEEDS AN OR AL          25764021
       BC      EQ,IF28            OK                                    25770021
OKCLS3 NI      CLASSW,MSWOFF      (AVOID SKIPPING RIGHT AT IF44)        25776021
       LA      RA0,BCDCLS                                               25782021
       BC      UNCOND,LFTERR      ERROR                                 25788021
       SPACE   3                                                        25794021
*                                                                       25800021
*      FOR SIGN TEST. WE ALREADY KNOW LEFT IS DN OR IR,RIGHT 'ZERO'     25806021
*                                                                       25812021
OKSIGN TM      MODEL,MNUMBT       IS LEFT NUMERIC                       25818021
       BC      ONES,IF28          OK                                    25824021
       LA      RA0,BCDSGN                                               25830021
       BC      UNCOND,LFTERR      ERROR                                 25836021
*                                                                       25842021
*      FOR RELATION TEST WE KNOW AT THIS POINT ONLY THAT LEFT AND R     25848021
*        INDIVIDUALLY ARE LEGAL OPERANDS                                25854021
*                                                                       25860021
OKRELT EQU     *                                                        25866021
       TM      MODEL,MLITBT       BOTH CANNOT BE LITS (INCL. FIGCON     25872021
       BC      ZERO,OKREL2         OK                                   25878021
       TM      MODER,MLITBT                                             25884021
       BC      ZERO,OKREL2        NOT BOTH ANYHOW SO OK                 25890021
       BAL     RCS,ERRIF               2 LITERALS BEING COMPARED        25896021
       LA      RW1,ELST0C                                               25902021
       BC      UNCOND,IFERR2       SYNTAX ERROR IN IF                   25908021
*                                                                       25914021
*      IF EITHER IS GROUP, ALL COMPARISONS OK                           25920021
*          EXCEPT IF ONE IS INTERMEDIATE RESULT                         25926021
*                                                                       25932021
OKREL2 TM      MODEL,MGRPBT                                             25938021
         BC    ONES,OKRL2A         LEFT GROUP,ALPHANUMERIC COMPARIS     25944021
       TM      MODER,MGRPBT                                             25950021
         BC    NOTONE,OKREL3       RIGHT GROUP,ALPHANUMERIC COMPARI     25956021
         CLI   PLEFT,MIR           IS LEFT AN INTERMEDIATE RESULT       25962021
         BC    EQ,RITERR           YES,ERROR                            25968021
       CLI   PLEFT,MINDNM          IS IT INDEXNAME                      25974021
       BE    RITERR                YES, ILLEGAL COMBINATION             25980021
         CLC   MODEL(LX2),INDNMD    USAGE INDEX                         25986021
       BE    RITERR                YES, ERROR                           25992021
         BC    UNCOND,CMPALF       NO,GOOD COMPARE                      25998021
OKRL2A   CLI   PRIGHT,MIR          IS RIGHT INTERMEDIATE RESULT         26004021
         BC    EQ,RITERR           YES,ERROR                            26010021
       CLI   PRIGHT,MINDNM                                              26016021
       BE    RITERR                INDEX NAME - ERROR                   26022021
         CLC   MODER(LX2),INDNMD                                        26028021
       BE    RITERR                ERROR - USAGE INDEX                  26034021
         BC    UNCOND,CMPALF       NO,GOOD COMPARE                      26040021
*                                                                       26046021
*   OK IF BOTH ARE SAME CATEGORY (BOTH DN OR REAL LIT,BOTH NUMERIC      26052021
*                                  BOTH NON-NUMERIC)                    26058021
OKREL3   EQU   *                                                        26064021
         MVC   PTEMP(LX1),MODEL                                         26070021
         XC    PTEMP(LX1),MODER                                         26076021
       BC      NOTZER,OKREL4      NOT SAME                              26082021
       TM      MODEL,MNUMBT       ARE THEY NUMERIC                      26088021
       BC      ONES,IF28          YES                                   26094021
       CLI   PLEFT,MINDNM          BOTH INDEX-NAMES                     26100021
       BC    EQ,CMPIND             YES- INDEX COMPARE                   26106021
       TM    MODEL,INDNMD1         ARE THEY INDEX DATA ITEMS            26112021
       BO    CMPIND                YES, INDEX COMPARE                   26118021
       B     CMPALF                NO, ALPHANUMERIC COMPARISON          26124021
       BC      UNCOND,CMPALF        NO,ALPHANUMIC COMPARISON            26130021
*                                                                       26136021
*      THEY DIFFER IN MODE                                              26142021
*                                                                       26148021
OKREL4 EQU     *                                                        26154021
       TM    PTEMP,INDMD1          IS ONE AN INDEX NAME                 26160021
       BC    NOTONE,OKREL6         NO                                   26166021
       TM    PTEMP,INDNMD1         ONE IDEXNM- IS OTHER INDEX DNM       26172021
       BO    CMPIND                YES- INDEX COMPARE                   26178021
       CLI   PLEFT,MINDNM          IS PLEFT THE INDEXNAME               26184021
       BNE   *+12                  NO                                   26190021
       LA    RW1,PRIGHT                                                 26196021
       B     *+8                   PRIGHT IS INDEX-NAME                 26202021
       LA    RW1,PLEFT             POINT RW1 TO OTHER OP                26208021
         CLC   DX0(LX2,RW1),CBZERO   IS OTHER OP FIGCN ZERO             26214021
       BE    CMPIND       THIS IS ALLOWABLE- INDEX COMPARE              26220021
         MVC   DCURR(LX1),MOPLNG-NX3(RW1) SEE IF OTHER OP INTEGER       26226021
         MVC   MODE(LX2),MOPLNG-NX2(RW1)                                26232021
       BAL   RCS,ISINT2            IS OTHER OP INTEGER                  26238021
       B     RITERR                NOT INTEGER- ERROR                   26244021
       B     CMPIND               INTEGER- INEXNAME OK INDEX COMP       26250021
OKREL6 TM    PTEMP,INDNMD1         INDEX-NAME NOT FOUND                 26256021
*                                  IS ONE INDEX DATA ITEM               26262021
       BO    RITERR                YES- ILLEGAL                         26268021
       TM    PTEMP,MNUMBT          IS ONE NUMERIC  (INCLUDES SNR)       26274021
       BC    ONES,OKREL8           NUM VS NON NUM                       26280021
       TM    MODEL,MNUMBT          PERHAPS NUM DNM VS NUM LIT/ZERO      26286021
       BO    IF28                 NUMERIC COMPARE                       26292021
       BC    UNCOND,CMPALF         NEITHER NUMERIC - NN COMPARE         26298021
*  ONE IS NUMERIC   ONE IS NOT                                          26304021
OKREL8 TM    MODEL,MNUMBT          IS LEFT NUMERIC                      26310021
       BC    NOTONE,OKREL7         NO                                   26316021
       LA    RW1,PLEFT                                                  26322021
       B     *+8                   YES, SEE IF RIGHT CLASS              26328021
OKREL7 LA    RW1,PRIGHT                                                 26334021
         CLI   MOPLNG-NX1(RW1),MEDMOD    IS IT ED                       26340021
       BE    CMPALF          OK   NN COMPARE                            26346021
         CLI   MOPLNG-NX1(RW1),MSNMOD STERLING NON-REPORT               26352021
       BE    CMPALF                OK NN                                26358021
         TM    MOPLNG-NX2(RW1),MLITBT NUM LIT OR FIGCON ZERO            26364021
       BO    CMPALF          OK                                         26370021
         CLI   MOPLNG-NX1(RW1),XX09   EXTERNAL FLOAT                    26376021
       BE    CMPALF             OK                                      26382021
       B     RITERR          ERROR                                      26388021
*                                                                       26394021
*                                                                       26400021
*                 CHANGE VERB-CODE FOR NON-NUMERIC COMPARISONS          26406021
*                                                                       26412021
CMPALF OI      PRELAT,MSKALF                                            26418021
       BC      UNCOND,IF28         END-PORTION OF IF                    26424021
CMPIND OI    PRELAT,MSKIND                                              26430021
       BC    UNCOND,IF28           END-PORTION OF IF                    26436021
*                                                                       26442021
*                        ILLEGAL COMBINATION FOUND                      26448021
*                                                                       26454021
LFTERR EQU     *                                                        26460021
       BAL     RCS,ERRIF           ERROR                                26466021
       LA      RW1,ELST1A                                               26472021
       BC      UNCOND,IFERR2       ERROR                                26478021
*                                                                       26484021
RITERR EQU     *                                                        26490021
       BAL     RCS,ERRIF           ERROR                                26496021
       LA      RW1,ELST1D                                               26502021
       BC      UNCOND,IFERR2       ERROR                                26508021
         EJECT                                                          26514021
*=1    ELSE    VERB                                                     26520021
*******************************************************************     26526021
*                                                                       26532021
*                                  E L S E                              26538021
*                                                                       26544021
*** OUTPUT PRODUCED                                                     26550021
*        GENERATES 'GO TO NEXT SENTENCE' FOLLOWED BY LAST LABEL IN      26556021
*          PSHTBL AND ITS EQUS, IF 'ELSE'IS FOLLOWED BY VERB            26562021
*                                                                       26568021
*       (GENERATES ONLY THE LABELS IF LAST VERB WAS 'GO' OR 'STOP-R     26574021
*                                                                       26580021
*        GENERATES LABELS FOLLOWED BY 'GO TO NEXT SENTENCE' IF 'ELS     26586021
*          IS FOLLOWED BY 'NEXT SENTENCE'                               26592021
*                                                                       26598021
*                                                                       26604021
*** SUBROUTINES CALLED                                                  26610021
*      GENLST,PGONXT,GENSTR,ISNXTS,QTBHAS,ERROR                         26616021
*                                                                       26622021
*                                                                       26628021
*** ERROR PROCESSING                                                    26634021
*      GIVES MSG IF NO LABELS IN PSHTBL                                 26640021
*      GIVES WARNING IF VERB FOLLOWS 'NEXT SENTENCE'                    26646021
*      LEAVES FOR IDENT TO NOTICE IF SOMETHING OTHER THAN VERB  OR      26652021
*       'NEXT SENTENCE' FOLLOWS 'ELSE'                                  26658021
*                                                                       26664021
*                                                                       26670021
*** NOTES                                                               26676021
*      PSKPGO TURNED ON BY VERB WHEN GO OR STOP-RUN IS FOUND, ALSO      26682021
*       AND IN IF WHEN GO-NXT-SNT IS GENERATED. TURNED OFF BY IDENT     26688021
*       UPON FINDING ANY VERB BUT 'ELSE'.                               26694021
*                                                                       26700021
*                                                                       26706021
*                                                                       26712021
*                                                                       26718021
*                                                                       26724021
*******************************************************************     26730021
       SPACE   6                                                        26736021
         USING *,RVRB                                                   26742021
ELSE     EQU   *                                                        26748021
       BAL   RCS,IFSRCH       BRANCH TO IF...SEARCH               5961  26754021
         CLC   DSPUSH(LX2),N0      ARE THERE ANY LABELS IN TABLE        26760021
       BC      EQ,ELSE12             NO - ERROR                         26766021
*                                                                       26772021
*                       'ELSE' IS LEGAL                                 26778021
*                                                                       26784021
ELSE1  CLI     GOTTEN,MVERB       DOES VERB FOLLOW                      26790021
         BC    EQ,ELSE4            YES                                  26796021
         BAL   RCS,ISNXTS          NO- DOES 'NEXT SENTENCE'             26802021
       BC      UNCOND,ELSE6       NO (IDENT WILL FIND ERROR)            26808021
*                                                                       26814021
*                       'NEXT SENTENCE' FOLLOWS 'ELSE'                  26820021
*                                                                       26826021
         CLC   GOTTEN(LX2),CBEOS    DOES . FOLLOW 'NEXT SENTENCE'       26832021
       BC      EQ,ELSE7             YES - NO PROCESSING NEEDED          26838021
       BAL     RCS,GENLST         GENR LAST SET OF BYPASS LABELS        26844021
         BAL   RCS,PGONXT          STORE 'GO NEXT SENTENCE'             26850021
         BAL   RCS,GENSTR          GENR. 'GO TO NEXT SENTENCE'          26856021
       OI      PSKPGO,MSWON       INHIBIT 'GO TO NEXT SENTENCE' ON      26862021
       BC      UNCOND,IDENT          NEXT ELSE.  EXIT                   26868021
*                                                                       26874021
*                        VERB FOLLOWS 'ELSE'                            26880021
*                                                                       26886021
ELSE4    CLC   GOTTEN(LX2),CBEOS    IS IT .                             26892021
       BC      EQ,IDENT           YES - ERROR (IDENT WILL FIND IT       26898021
         CLC   GOTTEN(LX2),CBELSE   IS IT ANOTHER 'ELSE'                26904021
       BC      EQ,ELSE10          YES - ERROR (IDENT WILL FIND IT       26910021
ELSE6    TM    PSKPGO,MSWON        OK VERB. WAS LAST VERB GO OR STO     26916021
       BC      ZERO,ELSE8         YES - OMIT 'GO TO NEXT...'            26922021
ELSE7  OI      GENRED,MSWON       (AVOID 'INCOMPLETE' MSG FROM IDEN     26928021
       BC      UNCOND,ELSE10       GENERATE BYPASS LABELS               26934021
ELSE8  BAL     RCS,PGONXT         NO - GENR 'GO TO NEXT...'             26940021
         BAL   RCS,GENSTR          GENERATE STRING                      26946021
ELSE10 BAL     RCS,GENLST         GENR. 1 SET OF BYPASS LABELS          26952021
       BC      UNCOND,IDENT       EXIT                                  26958021
*                                                                       26964021
*      ERROR - EXTRA ELSE FOUND , I.E., NO LABELS IN PSHTBL             26970021
*                                                                       26976021
ELSE12 BAL     RCS,ERROR           PROCESS ERROR                        26982021
       LA      RW1,ELST11                                               26988021
       OI      GENRED,MSWON        AVOID IDENT MSG                      26994021
       BC      UNCOND,ELSE1        'ELSE' IS LEGAL                      27000021
         EJECT                                                          27006021
*=1    DEBUG   VERB                                                     27012021
*******************************************************************     27018021
*                                                                       27024021
*                           D E B U G G                                 27030021
*                                                                       27036021
*                                                                       27042021
*** STRINGS PRODUCED                                                    27048021
*      SOURCE - *DEBUG PN1                                              27054021
*      OUTPUT - DEBUG RPD-NUM GNDEF                                     27060021
*              (AT PN1 A CALL TO THIS GNREF WAS PRODUCED)               27066021
*                                                                       27072021
*                                                                       27078021
*** SUBROUTINES CALLED                                                  27084021
*      GETNXT,STOVRB,STOR45,GENSTR,SRCHTB,ERROR                         27090021
*                                                                       27096021
*                                                                       27102021
*** ERROR PROCESSING                                                    27108021
*      SKIP STATEMENT IF PN MISSING                                     27114021
*                        PN IS REFERENCED BY ANOTHER DEBUG PACKET       27120021
*                        PN IS ITSELF DEFINED IN A DEBUG PACKET         27126021
*                                                                       27132021
*                                                                       27138021
*** NOTES                                                               27144021
*      TRY CAUSES TRYSW TO BE SET ON AND ERROR MESSAGE SEVERITIES       27150021
*        TO BE CHANGED TO 0.                                            27156021
*      THE GN AND RPD NUMBER USED ARE THOSE STORED IN DBGTBL AT THE     27162021
*        TIME IDENT FOUND THE PN AT POINT OF DEFINITION                 27168021
*                                                                       27174021
*                                                                       27180021
*******************************************************************     27186021
       SPACE   3                                                        27192021
       USING *,RVRB                                                     27198021
DEBUGG EQU     *                  START NEW PACKET                      27204021
         LH    RW1,SAVLHN+NX4   GET ID OF SN THAT WILL FOLLOW           27210021
         LA    RW1,DX1(RW1)      ( 1 GREATER THAN LAST LHN FOUND)       27216021
         STH   RW1,SAVLHN+NX4                                           27222021
       BAL     RCS,IDLH01  SEE IF END-OF-PERFORM CODING MUST PRECED     27228021
*                                   DEBUG CODING                        27234021
       LA      RA0,BCDPNU           PARAM FOR IDGVUP                    27240021
       CLI     GOTTEN,MPNU        IS INPUT A PN                         27246021
       BC      NOTEQ,IDGVUP         NO - GIVE UP                        27252021
         TM    DX3(RIN),MDBUGU                                          27258021
       BC      ONES,DEBGE3         DONT ALLOW TO DEBUG A DEBUG PACK     27264021
         MVC   SRCHNM(LX2),DX4(RIN) YES- FIND IN DBGTBL                 27270021
       L       RW1,ADBGTB                                               27276021
       BAL     RCS,SRCHTB          SEARCH TABLE FOR DEBUG - RPD         27282021
       BC      UNCOND,DEBGE2      IF NOT IN MEANS USED BEFORE           27288021
         XC    RPDREF+NX2(LX1),RPDREF+NX2                               27294021
DEBG02 EQU     *                  THEN                                  27300021
       BAL     RCS,STOVRB                STORE 'DEBUG RPD'              27306021
       LA      RW4,RPDREF                                               27312021
       BAL     RCS,STOR45          STORE IN STRING                      27318021
       BAL     RCS,GENSTR                GENR STRING                    27324021
         MVC   GNDEF+NX1(LX2),VNNUM                                     27330021
       BAL     RCS,GENLAB                GENR GN(DEF) FROM TABLE        27336021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      27342021
       BC      UNCOND,IDENT        EXIT                                 27348021
DEBGE2 EQU     *                                                        27354021
       BAL     RCS,ERROR           PN USED IN ANOTHER DBG PACKET        27360021
       LA      RW1,ELST3F          SAME PN USED IN 2 PACKETS            27366021
       BC      UNCOND,IDERR        ERROR EXIT                           27372021
DEBGE3 BAL     RCS,ERROR           PN IS DEFINED IN DEBUG PACKET        27378021
       LA      RW1,ELST50                                               27384021
       BC      UNCOND,IDERR        ERROR EXIT                           27390021
       EJECT                                                            27396021
*=1    EXHIBT  VERB                                                     27402021
*                                                                       27408021
*                                                                       27414021
*******************************************************************     27420021
*                           E X H I B T                                 27426021
*                                                                       27432021
*                                                                       27438021
*** STRINGS PRODUCED                                                    27444021
*      SOURCE - EXHIBIT CHANGED DN1 DN2 'A' DN3 'B'                     27450021
*      OUTPUT - EXHIBIT 'FIRST' CHANGED DN1 DN2 'A'                     27456021
*               EXHIBIT DN3 'B' 'END'                                   27462021
*               EXHIBIT 'FIRST' CHANGED DN1 DN2 'A'                     27468021
*               EXHIBIT DN3 'B' 'END'                                   27474021
*                                                                       27480021
*      SOURCE - EXHIBIT NAMED DN1 DN2 'A' DN3                           27486021
*      OUTPUT - EXHIBIT 'FIRST' NAMED ''DN1'' DN1 ''DN2''               27492021
*               EXHIBIT DN2 'A' ''DN3'' DN3 'END'                       27498021
*               EXHIBIT 'FIRST' NAMED ''DN1'' DN1 ''DN2''               27504021
*               EXHIBIT DN2 'A' ''DN3'' DN3 'END'                       27510021
*                                                                       27516021
*      SOURCE - EXHIBIT CHANGED NAMED DN1                               27522021
*      OUTPUT - EXHIBIT 'FIRST' CHANGED NAMED ''DN1'' DN1               27528021
*               EXHIBIT 'END'                                           27534021
*               EXHIBIT 'FIRST' CHANGED NAMED ''DN1'' DN1               27540021
*               EXHIBIT 'END'                                           27546021
*                                                                       27552021
*      SOURCE - EXHIBIT DN1                                             27558021
*      OUTPUT - EXHIBIT 'FIRST' DN1 'END'                               27564021
*               EXHIBIT 'FIRST' DN1 'END'                               27570021
*                                                                       27576021
*** SUBROUTINES CALLED                                                  27582021
*      GETNXT,SAVCUR,STOVRB,STO5IN,STO545,RDUCOP,GNTWIC,ERROR           27588021
*       ISFLPT                                                          27594021
*                                                                       27600021
*                                                                       27606021
*** ERROR PROCESSING                                                    27612021
*      ACCEPT WITHOUT 'NAMED' OR 'CHANGED'                              27618021
*      ACCEPT WITH 'NAMED CHANGED' REVERSED                             27624021
*      STOP PROCESSING WHEN NON-OPERAND FOUND                           27630021
*                                                                       27636021
*                                                                       27642021
*** NOTES                                                               27648021
*     EXHIBIT... NOTE THAT THIS SCAN USES THE STRING SEGMENTATION       27654021
*      ROUTINES STO5IN, STOK45, AND STO5KN                              27660021
*      THE ENTIRE SERIES OF SUBSTRINGS IS STORED TILL END OF STATE-     27666021
*        MENT AND GENERATED TWICE.                                      27672021
*      PHASE 1 ATTACHES THE BCD FORM OF EACH DATA NAME FOLLOWING TH     27678021
*        IC-TEXT FORM OF THE DN IN THE NAMED OPTION.                    27684021
*      IF ANY DN IS INT. FLOATING POINT,EXHIBIT STRINGS ARE PRECEDE     27690021
*               MOVE DN PARAM                                           27696021
*      GNOUSW TELLS GENSTR TO GENERATE WHAT IT FINDS IN PNOUNT --,      27702021
*       THE MOVE STRINGS                                                27708021
*                                                                       27714021
*******************************************************************     27720021
       SPACE   3                                                        27726021
*                                                                       27732021
       USING *,RVRB                                                     27738021
EXHIBT EQU   *                                                          27744021
       OI    STO5CT,MSWON                                               27750021
       OI      GNOUSW,MSWON       TELL GENSTR TO LOOK IN PNOUNS FOR     27756021
       BAL     RCS,PZSTRT              SOME OUTPUT                      27762021
       L     RW1,APNOUN                                                 27768021
         XC    PARSIZ(LX2),PARSIZ   RESTART PARAM DISPL. COUNT AT 0     27774021
       BAL     RCS,STO5BG         STORE VERB AND 'FIRST'                27780021
         CLC   GOTTEN(LX2),CBCHGD   ='CHANGED'...                       27786021
       BC    NOTEQ,EXHB01           NO                                  27792021
       OI    EXHBCS,MSWON                                               27798021
       BAL   RCS,STO5IN            STORE 'CHANGED'                      27804021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      27810021
EXHB01   CLC   GOTTEN(LX2),CBNAMD   = 'NAMED' ...                       27816021
       BC      NOTEQ,EXHB05         NO                                  27822021
       OI      EXHBNS,MSWON        SET NAMED SW                         27828021
       BAL   RCS,STO5IN            STORE 'NAMED'                        27834021
       BAL   RCS,GETNXT            GET NEXT INPUT                       27840021
         CLC   GOTTEN(LX2),CBCHGD   AGAIN, = 'CHANGED' ...              27846021
       BC    EQ,EXHBE2             YES, OUT OF ORDER, BUT ACCEPT        27852021
EXHB05 TM      EXHBCS,MSWON        WAS EITHER CHGD OR NMD GIVEN...      27858021
       BC      ONES,EXHB07         YES                                  27864021
       TM      EXHBNS,MSWON                                             27870021
       BC      ZERO,EXHBE1          NO, REQUIRED                        27876021
EXHB07 BAL     RCS,RDUCOP          IS DATA NAME VALID                   27882021
       BC      UNCOND,EXHB06       NO                                   27888021
       BAL     RCS,ISFLPT         PROCESS FLOATING-POINT ITEMS          27894021
       OI      EXHBS1,MSWON       SW SAYS LEGAL OPERAND FOUND           27900021
       TM      EXHBCS,MSWON                                             27906021
       BC      ZERO,EXHB7X             EXHIBIT NAMED MAYBE              27912021
         CLI   MODE+NX1,MGRPV      NO - CHANGED. IS THIS VAR. LNG. G    27918021
       BC      EQ,EXHBE3           YES - ERROR                          27924021
EXHB7X EQU     *                                                        27930021
       TM      EXHBNS,MSWON            IS IT NAMED                      27936021
       BC      ZERO,EXHB09               NO                             27942021
       TM      MODE,MLITBT          YES IS CURRENT INPUT DN             27948021
       BC      ONES,EXHB09           NO                                 27954021
       LA      RW4,PLEFT             YES, STORE ITS 35-EQUIVALENT F     27960021
       LH      RW3,CNT35S            (SUBSCR PUT IT AT PLEFT)           27966021
EXHB08 BAL     RCS,STO545          STORE 35-EQUIVAL.                    27972021
       AH      RW4,BYTES                                                27978021
       BCT     RW3,EXHB08          RETURN TO STORE MORE                 27984021
EXHB09 BAL   RCS,STO5IN            NOT SPECIAL CASE                     27990021
       BAL     RCS,GETNXT          GET NEXT INPUT                       27996021
       BC    UNCOND,EXHB07         CHECK IF VALID OPERAND               28002021
EXHB06 BAL     RCS,ISEND          NON-OPERAND - IS IT END               28008021
       BC      UNCOND,EXHBE3      NO - GO DISCARD                       28014021
       TM    EXHBS1,MSWON               IS SW SET...                    28020021
       BC      ZERO,EXHB11        NO - LET IDENT FIND ERROR             28026021
       BAL     RCS,GNTWIC         GENER WHOLE STRING OUTPUT TWICE       28032021
EXHB11 NI      GNOUSW,MSWOFF                                            28038021
       NI      EXHBNS,MSWOFF      RESET ALL SWITCHES                    28044021
       NI      EXHBCS,MSWOFF                                            28050021
       NI      EXHBS1,MSWOFF                                            28056021
       BC      UNCOND,IDENT        *** EXIT FROM EXHIBIT VERB ***       28062021
EXHBE1 EQU   *                     8C                                   28068021
       BAL   RCS,ERROR             CHANGED OR NAMED MISSING             28074021
       LA      RW1,ELST3D                                               28080021
       BC    UNCOND,EXHB07         CHECK IF VALID OP                    28086021
EXHBE2 EQU   *                     8D                                   28092021
       BAL   RCS,ERROR             'CHANGED' OUT OF ORDER, ACCEPT       28098021
       LA      RW1,ELST3E                                               28104021
       BAL   RCS,STO5IN            EXHBE2                               28110021
       BAL   RCS,GETNXT            GET NEXT INPUT                       28116021
       BC    UNCOND,EXHB07         CHECK IF VALID DATA-NAME             28122021
EXHBE3 BAL     RCS,ERROR           NON-OPERAND FOUND                    28128021
       LA      RW1,ELST04                                               28134021
EXHBE4 EQU     *                                                        28140021
       BAL     RCS,GETNXT          DISCARD                              28146021
         CLI   GOTTEN,XX35                                              28152021
       BC      EQ,EXHBE4          DON'T GO BACK WITH 35-EQUIVALENTS     28158021
       BC      UNCOND,EXHB07       CHECK IF VALID DATA-NAME             28164021
       EJECT                                                            28170021
*=1    RESET   VERB                                                     28176021
*=1    READY   VERB                                                     28182021
*                                                                       28188021
*                                                                       28194021
*******************************************************************     28200021
*                           R E A D Y                                   28206021
*                           R E S E T                                   28212021
*                                                                       28218021
*                                                                       28224021
*** STRINGS PRODUCED                                                    28230021
*      VERB ALONE CONSTITUTES STRING                                    28236021
*                                                                       28242021
*** SUBROUTINES CALLED                                                  28248021
*      GETNXT,STOVRB,GENSTR,ERROR                                       28254021
*                                                                       28260021
*                                                                       28266021
*** ERROR PROCESSING                                                    28272021
*      'TRACE' ASSUMED IF MISSING                                       28278021
*                                                                       28284021
*                                                                       28290021
*** NOTES                                                               28296021
*      PHASE 1 TURNS ON A SWITCH IN COMMON IF 'READY TRACE' OCCURS      28302021
*        WHERE IN THE PROCEDURE DIVISION.  IDENT TESTS THIS SWITCH      28308021
*        AND IF IT IS ON GENERATES A TRACE VERB FOR EVERY LHN.          28314021
*                                                                       28320021
*******************************************************************     28326021
*                                                                       28332021
       USING *,RVRB                                                     28338021
READY  EQU   *                                                          28344021
       USING *,RVRB                                                     28350021
RESET  EQU   *                                                          28356021
       BAL   RCS,STOVRB            PUT VERB BACK ON STRING              28362021
         CLC   GOTTEN(LX2),CBTRAC   IS IT TRACE...                      28368021
       BC    NOTEQ,RESTE2           NO, TO ERR2                         28374021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      28380021
       BAL     RCS,GENSTR          GENERATE STRING                      28386021
       BC    UNCOND,IDENT           EXIT                                28392021
RESTE2 EQU   *                     8F                                   28398021
       LA      RA0,CBTRAC                                               28404021
       BAL   RCS,ERROR             WARNING MESSAGE                      28410021
       LA      RW1,ELST07                                               28416021
       BAL   RCS,GENSTR            RESTE2                               28422021
       BC    UNCOND,IDENT          EXIT                                 28428021
       EJECT                                                            28434021
*=1    ON      VERB                                                     28440021
*                                                                       28446021
*                                                                       28452021
*******************************************************************     28458021
*                           O N   (VERB)                                28464021
*                                                                       28470021
*                                                                       28476021
*** STRINGS PRODUCED                                                    28482021
*      (DUMMY OPERAND 'ZERO' IS USED FOR ALL ABSENT INTEGERS)           28488021
*      SOURCE - ON 2                                                    28494021
*      OUTPUT - ONVRB 2 ZERO ZERO GN                                    28500021
*      SOURCE - ON 2 UNTIL 5                                            28506021
*      OUTPUT - ONVRB 2 ZERO 5 GN                                       28512021
*      SOURCE - ON 2 AND EVERY 1 UNTIL 5                                28518021
*      OUTPUT - ONVRB 2  1  5  GN                                       28524021
*                                                                       28530021
*                                                                       28536021
*** SUBROUTINES CALLED                                                  28542021
*      GETNXT, STOVRB,STODUM, STOINP, STOR45, INSERT, PUPLGN, ISNIL     28548021
*      GENSTR,ERROR                                                     28554021
*                                                                       28560021
*                                                                       28566021
*** ERROR PROCESSING                                                    28572021
*      IF OPERANDS 1 AND/OR 2 ARE NOT INTEGERS, 1 IS SUPPLIED           28578021
*      IF OPERAND 3 IS NOT AN INTEGER, THE UNTIL CLAUSE IS SKIPPED      28584021
*      MISSING 'AND' BEFORE 'EVERY' OR 'EVERY' AFTER 'AND' ASSUMED      28590021
*                                                                       28596021
*                                                                       28602021
*** NOTES                                                               28608021
*      THE GN USED IN THE STRING IS PLACED IN PSHTBL WITH A MASTER      28614021
*        AND IS GENERATED AS A LABEL WHEN 'ELSE' OR EOS IS FOUND        28620021
*                                                                       28626021
*                                                                       28632021
*******************************************************************     28638021
       SPACE   3                                                        28644021
*                                                                       28650021
       USING *,RVRB                                                     28656021
ONVRB  EQU   *                                                          28662021
       LA      RA0,CBON         PARAM FOR MSG 56                        28668021
       BAL     RCS,ISTRUV       CHECK IF CONDITION ALLOWED              28674021
       BAL   RCS,STOVRB            ENSTRING ON VERB                     28680021
       OI      PLOGIC,MSWON       TELL GETNXT TO SEND BACK 'AND'        28686021
       LR      RA0,RIN            SET RA0 FOR MSG                       28692021
       BAL     RCS,ISNIL           IS IT A POS NUM INT LIT ...          28698021
       BC    UNCOND,ONERR1          NO, REQUIRED                        28704021
       BAL   RCS,STOINP             YES                                 28710021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      28716021
ONX1   EQU   *                                                          28722021
         CLC   GOTTEN(LX2),CBAND    ='AND'...                           28728021
       BC    NOTEQ,ON1              NO                                  28734021
       BAL   RCS,GETNXT             YES,DISCARD                         28740021
         CLC   GOTTEN(LX2),CBEVER   ='EVERY'...                         28746021
         BC    EQ,ON2              'ON' FOLLOWED BY 'EVERY'             28752021
         LA    RA0,CBEVER          NO, WORD 'EVERY' MISSING             28758021
         BAL   RCS,ERROR           WARNING MESSAGE                      28764021
         LA    RW1,ELST07                                               28770021
         BC    UNCOND,*+NX8        IS IT AN INTEGER                     28776021
ON2    BAL   RCS,GETNXT             YES, DISCARD                        28782021
       LR      RA0,RIN            SET RA0 FOR MSG                       28788021
       BAL     RCS,ISNIL           IS IT A POS NUM INT LIT ...          28794021
       BC    UNCOND,ONERR4          NO, IGNORE CLAUSE                   28800021
       BAL   RCS,STOINP             YES, ENSTRING                       28806021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      28812021
ON3      CLC   GOTTEN(LX2),CBUNTL   ='UNTIL'...                         28818021
       BC    NOTEQ,ON4              NO                                  28824021
       BAL   RCS,GETNXT             YES, DISCARD                        28830021
       LR      RA0,RIN            SET RA0 FOR MSG                       28836021
       BAL     RCS,ISNIL           IS IT A POS NUM INT LIT ...          28842021
       BC    UNCOND,ONERR5          NO, IGNORE CLAUSE                   28848021
       BAL   RCS,STOINP            STORE NIL                            28854021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      28860021
* AT THIS POINT,   TRUE BRANCH IS REACHED. TREAT LIKE IF.               28866021
ON8    BAL   RCS,PUPLGN            GET LGN NUMBER                       28872021
       L     RW1,APUSH             GN TO FALSE BRANCH                   28878021
       ST      RVRB,VRBASE                                              28884021
       L       RAS,ANSERT                                               28890021
       BALR  RCS,RAS               BRANCH TO TARGET ADDRESS             28896021
       L     RVRB,VRBASE                                                28902021
         LA    RW3,DX3(RW3)                                             28908021
       STH     RW3,DSPUSH         UPDATE SAVED DISPL.                   28914021
         MVC   DX0(LX4,RW2),NXTLGN-NX1                                  28920021
         OI    DX0(RW2),MASTER                                          28926021
         MVC   RGN+NX1(LX2),NXTLGN    SET UP RGN SKELETON               28932021
       LA      RW4,RGN              ADDR OF RGN                         28938021
       BAL   RCS,STOR45            ALSO ADD RGN TO STRING               28944021
       BAL     RCS,GENSTR          GENERATE STRING                      28950021
       NI      PLOGIC,MSWOFF      TELL GETNXT TO IGNORE 'AND' AGAIN     28956021
       BAL     RCS,ISNXTS         DOES 'NEXT SENTENCE' FOLLOW           28962021
       BC      UNCOND,IDENT        NO - EXIT                            28968021
       BAL     RCS,PGONXT           YES - PRODUCE GO-STRING             28974021
       BAL     RCS,GENSTR          GENERATE STRING                      28980021
       OI      PSKPGO,MSWON                                             28986021
       BC      UNCOND,IDENT        EXIT                                 28992021
ON1      CLC   GOTTEN(LX2),CBEVER   ='EVERY'...                         28998021
       BC    NOTEQ,ON5              NO, ZEROES TO STRING                29004021
       BC    UNCOND,ONERR2          YES WORD'AND'MISSING                29010021
ON4    BAL     RCS,STODUM          STORE DUMMY ELEMENT (FIGCON ZERO     29016021
       BC    UNCOND,ON8            GET LGN                              29022021
ON5    BAL     RCS,STODUM          STORE DUMMY ELEMENT (FIGCON ZERO     29028021
       BC    UNCOND,ON3            CHECK IF 'UNTIL' FOLLOWS             29034021
*  ERROR ROUTINES NEED MESSAGE GENERATION                               29040021
ONERR1 EQU   *                     90                                   29046021
       BAL   RCS,ERROR             MESSAGE                              29052021
       LA      RW1,ELST40                                               29058021
       LA    RW4,NUMLT1            ONERR1                               29064021
       BAL   RCS,STOR45            STORE ENTITY                         29070021
       BC    UNCOND,ONX1           IS IT 'AND'                          29076021
ONERR2 EQU   *                     94                                   29082021
       LA      RA0,CBAND                                                29088021
       BAL   RCS,ERROR             ERROR                                29094021
       LA      RW1,ELST07                                               29100021
       BC    UNCOND,ON2            ONERR2                               29106021
ONERR4 EQU   *                     91                                   29112021
       BAL   RCS,ERROR             ERROR                                29118021
       LA      RW1,ELST40                                               29124021
       LA    RW4,NUMLT1            ONERR4                               29130021
       BAL   RCS,STOR45            STORE ENTITY                         29136021
       BC    UNCOND,ON3            IS IT 'UNTIL'                        29142021
ONERR5 EQU   *                     92                                   29148021
       BAL   RCS,ERROR             ERROR                                29154021
       LA      RW1,ELST3C                                               29160021
       BC      UNCOND,ON4          STORE ZERO                           29166021
       EJECT                                                            29172021
IKF40D CSECT                                                            29178021
*=1    SORT    VERB                                                     29184021
*                                                                       29190021
*******************************************************************     29196021
*                                                                       29202021
*                                                                       29208021
*                                                                       29214021
*                                                                       29220021
*                           S O R T                                     29226021
*                                                                       29232021
*                                                                       29238021
*** STRINGS PRODUCED                                                    29244021
*      A SEGMENTED CONTINUOUS STRING IS PRODUCED FOR THE SORT-FILE,     29250021
*       SORT KEYS, AND 'USING' AND/OR 'GIVING' (EITHER OR BOTH OF       29256021
*       THESE IS REPLACED BY SPACE-HOLDER 'ZERO' IF ABSENT). AFTER      29262021
*       STRING, WHOSE LAST ELEMENT IS 'END', COMES -- IF THERE IS I     29268021
*       PROCEDURE -- A PERFORM STRING FOR THE SECTION NAME. THEN A      29274021
*       1-ELEMENT STRING 'SORT 'END''.  THEN IF THERE IS OUTPUT PRO     29280021
*       CEDURE ANOTHER PERFORM STRING AND ANOTHER 1-ELEMENT 'SORT       29286021
*       'END''                                                          29292021
*                                                                       29298021
*  ALWAYS PRESENT - SORT 'FIRST' SFN ASC DN DN...ASC DN DN... ZERO      29304021
*                                    DESC        DESC         USING     29310021
*                                                                       29316021
*                   ZERO   'END                                         29322021
*                   GIVING                                              29328021
*      (WITH SORT VERB REPEATED AFTER EVERY 4 ELEMENTS)                 29334021
*                                                                       29340021
*  THEN IF INPUT PROCEDURE                                              29346021
*                   MOVE-4 VN1 PFMSAV1                                  29352021
*                   MOVE-4 GN1 VN1                                      29358021
*                   GO  SN1                                             29364021
*               GN1 MOVE-4 PFMSAV1 VN1                                  29370021
*                   SORT 'END'                                          29376021
*                                                                       29382021
*  THEN IF OUTPUT PROCEDURE                                             29388021
*                   MOVE-4 VN2 PFMSAV2                                  29394021
*                   MOVE-4 GN2 VN2                                      29400021
*                   GO  SN2                                             29406021
*               GN2 MOVE-4 PFMSAV2 VN2                                  29412021
*                   SORT 'END                                           29418021
*                                                                       29424021
*      FOR EXAMPLE                                                      29430021
*      SOURCE - SORT SFIL ASCENDING A B DESCENDING C D INPUT            29436021
*                 PROCEDURE SN1 GIVING OUTFIL                           29442021
*      OUTPUT - SORT 'FIRST' SFIL ASCENDING A                           29448021
*               SORT B DESCENDING C D                                   29454021
*               SORT ZERO GIVING 'END'                                  29460021
*               MOVE-4 VN1 PFMSAV                                       29466021
*               MOVE-4 GN1 VN1                                          29472021
*           GN1 MOVE-4 PFMSAV VN1                                       29478021
*               SORT 'END'                                              29484021
*                                                                       29490021
*                                                                       29496021
*** SUBROUTINES CALLED                                                  29502021
*      GETNXT,STOVRB,STO5IN,STO545,STODUM,ISSORK,CALCLG,GENSTR,ERRO     29508021
*                                                                       29514021
*                                                                       29520021
*** ERROR PROCESSING                                                    29526021
*      IF FIRST OPERAND NOT SORT-FILE NAME SKIP STATEMENT               29532021
*      IF FIRST OPERAND AFTER 'ASCENDING' OR 'DESCENDING' (OR AFTER     29538021
*       SORT-FILE NAME IF THESE ARE MISSING) IS NOT A DATA-NAME, SK     29544021
*       STATEMENT                                                       29550021
*      IF ANY DATA-NAME IS NOT A SORT KEY SKIP STATEMENT                29556021
*      SKIP ALL SORT KEYS AFTER TOTAL BYTE-COUNT EXCEEDS 255            29562021
*      SKIP ALL SORT KEYS AFTER 12TH                                    29568021
*      ASSUME 'ASCENDING' IF NEITHER 'ASCENDING' NOR 'DESCENDING' G     29574021
*      ASSUME 'PROCEDURE' IF MISSING AFTER 'INPUT' OR 'OUTPUT'          29580021
*      ASSUME 'USING' IF 1ST CLAUSE MISSING                             29586021
*      ASSUME 'GIVING' IF 2ND CLAUSE MISSING                            29592021
*      PROCESS NORMALLY IF LEGAL FILE-NAME DOES NOT FOLLOW 'USING'/     29598021
*       'GIVING'                                                        29604021
*                                                                       29610021
*                                                                       29616021
*** NOTES                                                               29622021
*      PERFORM ANALYZER IS CALLED TO CREATE STRINGS FOR INPUT- AND      29628021
*       OUTPUT-PROCEDURE. SORTSW TELLS PERFORM TO RETURN HERE AND       29634021
*       TO STORE EVERYTHING WITHOUT GENERATING. PHASE 1 TREATS THE      29640021
*       SECTION-NAMES IN THE SORT STATEMENT AS IT DOES THE PN'S IN      29646021
*       PERFORM STATEMENTS, I.E., TURNS ON THE PERFORM BIT IN THEIR     29652021
*       ATTRIBUTES                                                      29658021
*      SO12SW IN SORT ANALYZER HAS 2 FUNCTIONS. INITIALIZED OFF, IT     29664021
*       IS TURNED ON WHEN THE NUMBER OF SORT KEYS EXCEEDS 12 OR THE     29670021
*       TOTAL-BYTE COUNT EXCEEDS 255 TO INHIBIT STORING FURTHER SOR     29676021
*       KEYS. SET OFF AFTER ALL SORT KEYS ARE PROCESSED, IT IS AGAI     29682021
*       TURNED ON WHEN THE OUTPUT/GIVING CLAUSE IS FOUND OR ASSUMED     29688021
*       AND TELLS THE ANALYZER WHICH OF THE DUMMY 'ZEROES' TO OVERL     29694021
*       AND WHEN THE STATEMENT IS COMPLETED.                            29700021
*      RW1 IS USED TO KEEP COUNT OF THE SORT KEYS.                      29706021
*     NOTE... THIS SCAN MAKES USE OF THE STRING SEGMENTATION            29712021
*          ROUTINES STO5XY, WHERE XY = IN, 45, OR NK.                   29718021
*                                                                       29724021
*******************************************************************     29730021
       SPACE   3                                                        29736021
       USING *,RVRB                                                     29742021
SORT   EQU   *                                                          29748021
       NI    UGSW,MSWOFF       INITIALIZE                               29754021
       NI    SKIPSW,MSWOFF         INITIALIZE SKIPSW OFF                29760021
         XC    SOROPT(LX1),SOROPT                                       29766021
      NI    OSW,MSWOFF                                                  29772021
       CLI     PGMBRK,MDECL       ARE WE IN DECLARATIVES                29778021
       BC      NOTEQ,SOR0           NO - OK                             29784021
       BAL     RCS,ERROR            YES - WARN                          29790021
       LA      RW1,ELST49                                               29796021
SOR0   EQU     *                                                        29802021
       OI    STO5CT,MSWON          CONTIN-SEGMENTED STRING SW           29808021
       BAL     RCS,STO5BG         STORE VERB AND 'FIRST'                29814021
           BAL   RCS,STO5IN        STORE BCD NAME                       29820021
       BAL   RCS,GETNXT            POINT RIN TO SORTFILE                29826021
       NI    SO12SW,MSWOFF         RESET 12 SW                          29832021
       NI      PFNDOP,MSWOFF                                            29838021
       CLI   GOTTEN,MSFN           SORT FN...                           29844021
       BC    NOTEQ,SOER01          NO, SFN REQUIRED, GET OUT            29850021
         XI    BLNUM,XX00                                               29856021
         MVN   BLNUM(LX1),DX2(RIN)                                      29862021
       CLI     BLNUM,MSDMAJ       IS MAJOR CODE SD                      29868021
       BC      NOTEQ,SOER01         NO - ORDINARY FILE                  29874021
       SR    RW1,RW1               N=0 IN RW1                           29880021
       ST      RW1,SO256           INITIALIZE 256 BYTE TEST             29886021
       BAL   RCS,STO5IN            SFN TO STRING                        29892021
       BAL   RCS,GETALL            SAVE INPUT                           29898021
       LA    RW2,PLEFT                                                  29904021
         MVC   BLNUM+NX2(LX1),DX4(RIN) SAVE BASE LOCATOR FOR CHECKING K 29910021
       BAL   RCS,GETNXT            SFREC                                29916021
       BAL   RCS,RDUCOP            SEE IF VALID SORT-REC FOLLOWS        29922021
       OI    SKIPSW,MSWON          INVALID- SIGNAL FOR USE/GIVE         29928021
       BAL   RCS,GETALL            SAVE                                 29934021
       LA    RW2,PRIGHT                                                 29940021
       BAL   RCS,GETNXT            GET ASCENDING,DECENDING OR DN        29946021
       BAL     RCS,RDUCOP         IS IT DN                              29952021
         BC    UNCOND,*+NX8        NO                                   29958021
       BC      UNCOND,SOER02        YES - ASSUME 'ASCENDING'            29964021
         CLC   GOTTEN(LX2),ERSYMB    NO                                 29970021
       BC      NOTEQ,SOR1          NOT ERROR                            29976021
       BAL     RCS,GETNXT          GET NEXT INPUT                       29982021
       BC      UNCOND,SOER02      ASSUME ERSYMB IS 'ASCENDING'          29988021
SOR1     CLC   GOTTEN(LX2),CBON                                         29994021
         BC    NOTEQ,*+NX8         NOT 'ON'                             30000021
       BAL     RCS,GETNXT         DISCARD 'ON'                          30006021
       LA      RW4,CBASCD         DONT STORE SEQ TILL KEY FOUND         30012021
         CLC   GOTTEN(LX2),CBASCD  IS IT ASCENDING                      30018021
       BC    EQ,SOR2                YES                                 30024021
       LA      RW4,CBDSCD                                               30030021
         CLC   GOTTEN(LX2),CBDSCD   IS IT 'DESCENDING'...               30036021
       BC    EQ,SOR2                YES                                 30042021
       LTR     RW1,RW1            WAS ANY KEY STORED                    30048021
       BC    NOTZER,SOR3           MAYBE END OF KEYS                    30054021
         CLC   GOTTEN(LX2),CBKEY    1ST KEY-MAYBE ASC/DESC OMITTED      30060021
       BNE    SOR1A                NOT 'KEY'- SEE IF DATANAME           30066021
       BAL   RCS,GETNXT          DISCARD OPTIONAL WORD                  30072021
SOR1A  CLI   GOTTEN,MDN          IS IT PERHAPS 1ST KEY                  30078021
       BE    SOER02         YES-PERHAPS                                 30084021
       B     SOER03               NO- GIVE UP                           30090021
       BC    UNCOND,SOR3                             SEEK USE/I/P       30096021
SOR2   EQU     *                                                        30102021
       BAL   RCS,GETNXT            GET NEXT INPUT                       30108021
SOR4X    CLC   GOTTEN(LX2),CBKEY                                        30114021
         BC    NOTEQ,*+NX8         NOT 'KEY'                            30120021
       BAL     RCS,GETNXT         DISCARD 'KEY'                         30126021
         LR    RA0,RW4                                                  30132021
       NI      PFNDOP,MSWOFF      SW SAYS MUST NOW FIND KEY             30138021
SOR4   EQU     *                                                        30144021
       BAL     RCS,ISSORK          DETERMINE IF DN IS AN OPERAND        30150021
*                             DEFINED UNDER SD ENTRY FOR SFN FOUND      30156021
*                             AFTER VERB SORT.                          30162021
       BC      UNCOND,SOR5          NO - PERHAPS END OF KEYS            30168021
         CLI   MODE+NX1,MGRPV      IS IT VARIABLE LENGTH                30174021
       BC      EQ,SOER10             YES - ERROR                        30180021
       BAL     RCS,CALCLG          FIND LENGTH OF THIS DN               30186021
       BC      UNCOND,SOER10       ILLEGAL MINOR                        30192021
SOR4W  L       RW2,SO256                                                30198021
       A       RW2,LENGTH                                               30204021
       CH      RW2,N256           WILL THIS KEY MAKE MORE THAN 256      30210021
        BC     HI,SOER08           YES, DON'T USE                       30216021
       CH      RW1,NDEC12         ARE THERE ALREADY 12                  30222021
       BC      EQ,SOER08            YES - DONT USE                      30228021
         MVC   BLNUM(LX1),BLNUM+NX2                                     30234021
         XC    BLNUM(LX1),DX6(RIN)                                      30240021
       BC      NOTZER,SOER12        NO - ERROR                          30246021
         TM    DX4(RIN),XX40       IS IT SBL                            30252021
       BC      ONES,SOER12          YES - ERROR                         30258021
         MVC   BLNUM(LX2),DX4(RIN)                                      30264021
         NI    BLNUM,XX0F                                               30270021
         CLC   BLNUM(LX2),N4092    IS DISPL. FROM 01 OVER 4092          30276021
       BC      HI,SOER12            YES - ERROR                         30282021
         LA    RW1,DX1(RW1)        UPDATE KEY COUNT                     30288021
       ST      RW2,SO256               AND LENGTH COUNT                 30294021
       TM      PFNDOP,MSWON       IS THIS 1ST KEY AFTER ASC/DESC        30300021
       BC      ONES,SOR4Y           NO                                  30306021
       OI      PFNDOP,MSWON         YES                                 30312021
       BAL     RCS,STO545         STORE ASC/DESC                        30318021
SOR4Y  BAL     RCS,STO5IN         STORE KEY                             30324021
       BAL     RCS,GETNXT          GET NEXT INPUT                       30330021
       BC      UNCOND,SOR4        RETURN FOR ANOTHER                    30336021
SOR5   TM      GOTTEN,MOP         IS THIS OPERAND (INCL. ERROR SYMB     30342021
       BC      ZERO,SOR1           NO - SEEK ASC/DESC AGAIN             30348021
       BC      UNCOND,SOER10       YES - DISCARD                        30354021
SOR3   NI    SO12SW,MSWOFF          REUSE SO12SW                        30360021
         MVC   SORPX1(LX2),DSPSTR  SAVE ITS DISPL.                      30366021
       BAL   RCS,STODUM            I/P DUMMY                            30372021
         MVC   SORPX2(LX2),DSPSTR  SAVE ITS DISPL.                      30378021
       BAL   RCS,STODUM            O/P DUMMY                            30384021
       LA    RW4,CBEND             SIMULATE STRING END                  30390021
       BAL   RCS,STO545            SET J INTO STRING                    30396021
       L     RW1,ASTRNG                                                 30402021
         L     RW1,DX0(RW1)                                             30408021
         L     RW1,DX0(RW1)                                             30414021
       AH    RW1,STO5VE                                                 30420021
         MVC   DX2(LX1,RW1),STO5J+NX1                                   30426021
       SR    RCS,RCS                                                    30432021
       STH   RCS,STO5J             ZERO OUT J                           30438021
         CLC   GOTTEN(LX2),CBUSIN    IS IT USING...                     30444021
       BC    EQ,SOR6A               YES                                 30450021
         CLC   GOTTEN(LX2),CBINPT    IS IT INPUT...                     30456021
       BC    NOTEQ,SOER04            NO, STRUCT ERR, GET OUT            30462021
       BC    UNCOND,SOR7A          1ST TIME THRU                        30468021
SOR7   OI    SO12SW,MSWON          FLAG 2ND TIME THRU                   30474021
       OI    OSW,MSWON               OUTPUT PROC                        30480021
SOR7A  EQU   *                                                          30486021
       BAL   RCS,GETNXT            GET NEXT INPUT                       30492021
         CLC   GOTTEN(LX2),CBPROC   IS IT PROCEDURE...                  30498021
       BC      NOTEQ,SOER06         NO, WARN AND ASSUME PROCEDURE       30504021
       BAL     RCS,GETNXT          DISCARD 'PROCEDURE'                  30510021
SOR8   OI    SORTSW,MSWON                                               30516021
       NI    STO5SW,MSWOFF                                              30522021
       L     RVRB,APRFRM                                                30528021
       BCR   UNCOND,RVRB       *** GO TO PERFORM ANALYZER ***           30534021
SORBAK NI    SORTSW,MSWOFF     *** RETURN FROM PERFORM    ***           30540021
         MVI   VERB+NX2,XX01                                            30546021
       BAL   RCS,STOVRB            STORE PERFORM VERB IN STRING         30552021
       SR    RCS,RCS                                                    30558021
       STH   RCS,STO5J                                                  30564021
       LA    RW4,CBEND                                                  30570021
       BAL   RCS,STO545            STORE PN                             30576021
       BC    UNCOND,SOR10          IS THIS END                          30582021
SOR6   OI    SO12SW,MSWON                                               30588021
SOR6A  BAL   RCS,GETNXT            GET NEXT INPUT                       30594021
       LH      RCS,SORPX1         PNTR TO DUMMY 1                       30600021
       LA    RW4,CBUSIN                                                 30606021
       TM    SO12SW,MSWON                                               30612021
       BC    ONES,SORT6            SORT 12-COUNT SWITCH ON              30618021
       OI    SOROPT,USOPT                                               30624021
*                                                                       30630021
       B     SOR6B                 DISPL OF TEXT WORD                   30636021
SORT6  LH    RCS,SORPX2           DISPL OF DUMMY-2                      30642021
       LA    RW4,CBGIVE                                                 30648021
       OI    SOROPT,GVOPT                                               30654021
SOR6B  EQU     *                  DISP OF TEXT WORD                     30660021
       CLI     GOTTEN,MFILE       FN...                                 30666021
       BC    NOTEQ,SOER09          NO                                   30672021
         TM    DX2(RIN),XX07       IS IT FD                             30678021
       BC    NOTZER,SOER09          NOT FD FN, DISCARD                  30684021
         TM    DX6(RIN),MQSAM       IS IT A QSAM FILE                   30690021
       BC    NOTZER,SOER09         NO- STOP PROCESSING                  30696021
       L       RW2,ASTRNG         CHANGE DISPL IN RCS TO PNTR           30702021
         L     RW2,DX0(RW2)                                             30708021
         L     RW2,DX0(RW2)                                             30714021
       AR    RCS,RW2                                                    30720021
         CLI   DX0(RCS),XX84       DID VERB PRECEDE DUMMY               30726021
         BC    NOTEQ,*+NX8         NO - OK                              30732021
         LA    RCS,DX4(RCS)        YES - POINT TO NEXT ELEMENT (DUMM    30738021
         MVC   DX0(LX2,RCS),DX0(RW4) OVERWRITE ANLIT WITH USING, GIVI   30744021
       TM    SO12SW,MSWON    GIVING                                     30750021
       BC    ONES,SOR10          AVOID OVERLAYING USE DATA              30756021
       BAL   RCS,GETALL            SAVE IT                              30762021
       LA    RW2,SAVESTOR                                               30768021
       BAL   RCS,GETALL         SAVE IT AGAIN                           30774021
       LA    RW2,SVF1           TO USE AS IT IS                         30780021
       BAL   RCS,GETNXT            FN1REC                               30786021
       BAL   RCS,RDUCOP          SEE IF VALID D REC FOUND               30792021
       B     SOER15                 NO- GIVE UP                         30798021
       BAL   RCS,GETALL            SAVE                                 30804021
       LA    RW2,SAVE1OP                                                30810021
       BAL   RCS,GETNXT            GNS                                  30816021
         MVC   SVGNS(LX10),DX2(RIN)                                     30822021
       BAL   RCS,GETNXT         PT TO GIVE/OUTPUT                       30828021
SOR10  EQU   *                                                          30834021
         TM    SO12SW,MSWON    ALL  FINISHED                            30840021
         BC    ONES,SOR13      YES                                      30846021
         CLC   GOTTEN(LX2),CBGIVE   IS IT GIVING...                     30852021
       BC    EQ,SOR6                YES, LOOP BACK TO CHECK FN          30858021
         CLC   GOTTEN(LX2),CBOUTP   IS IT OUTPUT...                     30864021
       BC    NOTEQ,SOR12           NO, CHECK IF END                     30870021
       B     SOR13          CLEAR OUT SORT STRING                       30876021
SOR12  BAL   RCS,ISEND             IS IT END                            30882021
       BC      UNCOND,SOER05        NO                                  30888021
       BC      UNCOND,SOR15X        YES - GIVE UP                       30894021
SOR13  TM    SKIPSW,MSWON          SHOULD STRING BE GENERATED           30900021
       BZ    SOT14                 NO REASON NOT TO                     30906021
         TM    SOROPT,XX11          IS THERE A USING OR GIVING          30912021
       BC    NOTZER,SOER16         YES- CANNOT PROCESS WITHOUT          30918021
*                                  B  VALID SORT-FILE-RECORD.ERROR      30924021
SOT14  DS    0H                   GENERATE SORT STRING                  30930021
       BAL   RCS,GENSTR            GENERATE STRING                      30936021
       TM    OSW,MSWON           HAS O/P BEEN GENERATED                 30942021
       BO    IDENT               OK- FINISHED                           30948021
*   O/P HAS NOT BEEN GENERATED                                          30954021
         TM    SOROPT,XX11        USE AND GIVE OPTIONS                  30960021
       BC    ZERO,SOR7       NEITHER- GENR O/P                          30966021
       MVI   STO5SW,MZERO          KEEP STO5SW OFF FOR DUMPROC          30972021
       BC    ONES,SOT16            BOTH                                 30978021
         TM    SOROPT,XX10         IS IT GIVING                         30984021
       BO    SOT17                 SKIP USE CODE                        30990021
SOT16  EQU   *                                                          30996021
       BAL   RCS,DMPROC1       BRANCH TO USE/CODE                       31002021
         TM    SOROPT,XX10       IS THERE A GIVING                      31008021
       BC    NOTONE,SOR7       GENR O/P                                 31014021
       NI    STO5SW,MSWOFF         STO5SW MUST BE OFF FOR THIS          31020021
SOT17  BAL   RCS,GETALL            SAVE IT                              31026021
       LA    RW2,SAVESTOR                                               31032021
       BAL   RCS,GETALL        SAVE IT AGAIN TO USE DIFFERNETLY         31038021
       LA    RW2,SVF1                                                   31044021
       BAL   RCS,GETNXT            FN2REC                               31050021
       BAL   RCS,RDUCOP          SEE IF VALID D REC FOUND               31056021
       B     SOER15                 NO- GIVE UP                         31062021
       BAL   RCS,GETALL            SAVE                                 31068021
       LA    RW2,SAVE1OP                                                31074021
       BAL   RCS,GETNXT            GNS                                  31080021
         MVC   SVGNS(LX10),DX2(RIN)                                     31086021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      31092021
       BAL   RCS,DMPROC2           OUTPUT PROC-DUMMY                    31098021
       B     IDENT                 EXIT                                 31104021
DMPROC1 ST    RCS,DMSRSV                                                31110021
         NI    SAVESTOR+NX2,XX00    ZERO OUT  3RD  BYTE                 31116021
         OI    SAVESTOR+NX2,MRERD   INPUT-REREAD OPTION                 31122021
OPOP     MVC   DUMVB+NX1(LX2),OPEVB  MOVE  OPEN  VERB TO DUMVB          31128021
       LA    RW2,SAVESTOR                                               31134021
       SR    RW1,RW1               CLEAR RW1 FOR IC                     31140021
         IC    RW1,SAVESTOR+NX1         GET CT  BYTES FOLLOWING         31146021
       AR    RW2,RW1         RW2 HAS ADDRESS OF DICT PTR                31152021
       BCTR    RW2,RA0             SUBTRACT ONE FROM RW2                31158021
         MVC   DX10(LX3,RW2),DX0(RW2) MOVE  DICT  PTR DOWN 10 BYTES     31164021
         MVC   DX0(LX10,RW2),SVGNS   TO ATTACH GNS                      31170021
         IC    RW2,SAVESTOR+NX1     INCREMENT  CT FIELD                 31176021
         LA    RW2,DX10(RW2)        TO REFLECT  GNS                     31182021
         STC   RW2,SAVESTOR+NX1                                         31188021
*                                                                       31194021
* GNS  ATTACHED- CREATE  OPEN STRING                                    31200021
*                                                                       31206021
         LA    RW2,DX2                                                  31212021
STOPEN BAL   RCS,STLOOP            STORE 4 ELEMENTS                     31218021
       DC    XL2'4'                STORE 4                              31224021
       LA    RW4,DUMVB             OPEN                                 31230021
       LA    RW4,CBFRST            FIRST                                31236021
       LA    RW4,SAVESTOR          FN WITH GNS                          31242021
       LA    RW4,CBEND             END                                  31248021
       BCT   RW2,STOPEN            MUST  BE  GENERATED  TWICE           31254021
       BAL   RCS,GENSTR            GENERATE STRING                      31260021
       BAL   RCS,PUPLGN            GET NEW GN NUMBER                    31266021
         MVC   GNSV1+NX1(LX2),NXTLGN SAVE  TO ISSUE LATER AS RGN        31272021
         MVC   LGN+NX1(LX2),NXTLGN                                      31278021
       BAL   RCS,GENDAT            GENERATE LGN                         31284021
       LA    RW2,LGN               GENERATE  LGN1                       31290021
       BAL   RCS,PZSTRT            REINIT. TABLES                       31296021
       LA    RW1,ASTRNG                                                 31302021
*                                                                       31308021
* SEE IF USING OR GIVING CALLED  OPEN                                   31314021
*                                                                       31320021
         TM    UGSW,XX01                                                31326021
       BO    DMRTN                 USING/GIVING CALLED OPEN             31332021
*  PROCESS DUMMY READ                                                   31338021
         MVC   DUMVB+NX1(LX2),DUMRD  PUT READ VERB                      31344021
       LA    RW4,DUMVB             IN  STRING                           31350021
       BAL   RCS,STOR45            STORE READ VERB IN STRING            31356021
       LA    RW4,SVF1             STORE FN WITHOUT GNS ATTACHED         31362021
       BAL   RCS,STOR45            STORE FN                             31368021
       BAL   RCS,PUPLGN            GET NEW GN NUMBER                    31374021
         MVC   RGN+NX1(LX2),NXTLGN                                      31380021
         MVC   GNSV2+NX1(LX2),NXTLGN                                    31386021
       LA    RW4,RGN               AT  END  GN                          31392021
       BAL   RCS,STOR45            STORE GN                             31398021
       BAL   RCS,PUPLGN            GET NEW GN NO.                       31404021
         MVC   RGN+NX1(LX2),NXTLGN                                      31410021
         MVC   GNSV3+NX1(LX2),NXTLGN NEXT  SENT  GN                     31416021
       LA    RW4,RGN               (POINTS  TO 'RELEASE'                31422021
       BAL   RCS,STOR45            STORE RGN                            31428021
       LA    RW4,SAVE1OP           STORE FN-1-REC                       31434021
       BAL   RCS,STOR45            STORE FN-1 REC                       31440021
       LA    RW4,PRIGHT                                                 31446021
       BAL   RCS,STOR45            STORE   SORT-REC                     31452021
*  MOVE  FN-1-REC  TO  SORT-REC                                         31458021
       BAL   RCS,STLOOP            STORE 3 ELEMENTS                     31464021
       DC    XL2'3'                STORE  3 ELEMENTS                    31470021
       LA    RW4,MOVEVB                                                 31476021
       LA    RW4,SAVE1OP                                                31482021
       LA    RW4,PRIGHT                                                 31488021
       BAL   RCS,GENSTR            GENERATES   READ AND MOVE            31494021
* READ MUST  BE GENERATED  AGAIN                                        31500021
       L     RW1,ASTRNG                                                 31506021
         L     RW1,DX0(RW1)         TAMM                                31512021
         L     RW2,DX0(RW1)         TABLE                               31518021
GENTW    CLC   DX0(LX2,RW2),MOVEVB   IS IT MOVE                         31524021
       BE    ENDRD                 YES-EXIT                             31530021
       BAL   RCS,GENDAT            NO-GENERATE                          31536021
         LA    RW2,DX0(RW2)                                             31542021
       AH    RW2,BYTES                                                  31548021
         LA    RW2,DX1(RW2)         INCREMENT  TO SKIP  TRAILING        31554021
       B     GENTW                 BYTE  CT- PT  TO NEXT ELEMENT        31560021
ENDRD  BAL   RCS,GENDAT            LGN  FOR  AT END                     31566021
       LA    RW2,GNSV2                                                  31572021
       BAL   RCS,PUPLGN            GENERATE  GO TO GN  WHERE GN         31578021
         MVC   GNSV2+NX1(LX2),NXTLGN POINTS  TO 'CLOSE'                 31584021
         MVC   RGN+NX1(LX2),NXTLGN                                      31590021
       BAL   RCS,GENGO             GENR. 'GO TO GN'                     31596021
       LA    RW1,RGN                                                    31602021
* ISSUE GN  FROM  GNSV3  AS NXTSNT LGN                                  31608021
       BAL   RCS,GENDAT            WRITE OUT NXTSNT GN                  31614021
       LA    RW2,GNSV3                                                  31620021
* RELEASE                                                               31626021
         MVC   DUMVB+NX1(LX2),RELDM  MOVE IN  RELEASE CODE              31632021
       BAL   RCS,GENDAT            WRITE DUMMY VERB                     31638021
       LA    RW2,DUMVB                                                  31644021
       BAL   RCS,GENDAT            WRITE SORT REC                       31650021
       LA    RW2,PRIGHT            SORT-REC                             31656021
* GENERATE A 'GO TO GN1' POINTING  TO  READ                             31662021
       BAL   RCS,GENGO             GENR. 'GO TO GN'                     31668021
       LA    RW1,GNSV1                                                  31674021
* CLOSE                                                                 31680021
CLSST    NI    SVF1+NX2,XX00                                            31686021
       BAL   RCS,GENDAT            POINTS TO  CLOSE-GONE TO             31692021
       LA    RW2,GNSV2             AT  END                              31698021
CLSET    OI    SVF1+NX2,MRERD       DEFAULT OPTION                      31704021
         MVC   DUMVB+NX1(LX2),CLSDM  CLOSE  CODE  TO DUMMY              31710021
         LA    RW2,DX2                                                  31716021
STCLOS BAL   RCS,STLOOP            STORE 4 ELEMENTS                     31722021
       DC    XL2'4'                STORE 4                              31728021
       LA    RW4,DUMVB             CLOSE                                31734021
       LA    RW4,CBFRST            FIRST                                31740021
       LA    RW4,SVF1              FD                                   31746021
       LA    RW4,CBEND             END                                  31752021
       BCT   RW2,STCLOS            STORE TWICE                          31758021
       BAL   RCS,GENSTR            CLOSE  CODING EFFECTIVELY            31764021
*                                  GENERATED  TWICE                     31770021
       L     RIN,TRUPNT                                                 31776021
       BAL   RCS,PZSTRT            REINIT. STRING                       31782021
       LA    RW1,ASTRNG                                                 31788021
         MVI   VERB+NX2,XX01                                            31794021
       BAL   RCS,GENDAT      GENR SORT 'E                               31800021
       LA    RW2,VERB                                                   31806021
        BAL   RCS,GENDAT           GENR. END                            31812021
       LA    RW2,CBEND                                                  31818021
       L    RCS,DMSRSV                                                  31824021
       NI    UGSW,MSWOFF                                                31830021
        BR     RCS                 EXIT TO IDENT                        31836021
DMPROC2 ST    RCS,DMSRSV                                                31842021
* OUTPUT  PROC-DUMMY                                                    31848021
         NI    SAVESTOR+NX2,XX00                                        31854021
         OI    SAVESTOR+NX2,XX1F    OUTPUT REREAD                       31860021
       OI    UGSW,MSWON                                                 31866021
       B     OPOP                  COMMON OPEN CODE                     31872021
DMRTN  EQU   *                     RETURN FROM OPEN-PROCESS             31878021
*                                  RETURN VERB                          31884021
         MVC   DUMVB+NX1(LX2),DMRET                                     31890021
       BAL   RCS,PUPLGN            GN FOR NXTSNT                        31896021
         MVC   RGN+NX1(LX2),NXTLGN                                      31902021
       BAL   RCS,STLOOP            STORE 7 ELEMENTS                     31908021
       DC    XL2'7'                STORE  7 ELEMENTS                    31914021
       LA    RW4,DUMVB             RETURN                               31920021
       LA    RW4,PLEFT             SFN                                  31926021
       LA    RW4,MOVEVB              MOVE                               31932021
       LA    RW4,PRIGHT                                                 31938021
       LA    RW4,SAVE1OP                                                31944021
       LA    RW4,DUMVB            RETURN                                31950021
       LA    RW4,RGN              GN NXTSNT                             31956021
       BAL   RCS,GENSTR            GENERATE STRING                      31962021
         MVC   GNSV2+NX1(LX2),NXTLGN SAVE NXTSNT GN TO ISSUE AS LGN     31968021
* GO TO  GN POINTING  TO  CLOSE                                         31974021
       BAL   RCS,PUPLGN            GET NEW GN NO.                       31980021
         MVC   RGN+NX1(LX2),NXTLGN                                      31986021
       BAL   RCS,GENGO             GENR. 'GO TO GN'                     31992021
       LA    RW1,RGN                                                    31998021
       BAL   RCS,GENDAT            WRITE LGN                            32004021
       LA    RW2,GNSV2             LGN FOR WRITE                        32010021
         MVC   GNSV2+NX1(LX2),NXTLGN SAVE RGN FOR CLOSE                 32016021
       BAL   RCS,PZSTRT            REINIT. STRING                       32022021
       LA    RW1,ASTRNG                                                 32028021
* WRITE                                                                 32034021
         MVC   DUMVB+NX1(LX2),DMWR                                      32040021
       BAL   RCS,PUPLGN            GET NEW GN NUMBER                    32046021
         MVC   RGN+NX1(LX2),NXTLGN                                      32052021
STWRIT BAL   RCS,STLOOP            STORE 6 ELEMENTS                     32058021
       DC    XL2'6'                STORE 6                              32064021
       LA    RW4,DUMVB                                                  32070021
       LA    RW4,SVF1            FN2                                    32076021
       LA    RW4,RGN                                                    32082021
       LA    RW4,RGN                                                    32088021
       LA    RW4,CBZERO                                                 32094021
       LA    RW4,SAVE1OP           FN-2-REC                             32100021
       BAL   RCS,GENSTR            GENR. STRING                         32106021
         MVC   LGN+NX1(LX2),NXTLGN                                      32112021
       BAL   RCS,GENDAT            NXTSNT GN(GO TO)                     32118021
       LA    RW2,LGN                                                    32124021
* GO  GN                                                                32130021
       BAL   RCS,GENGO             GO  TO  GN POINTING TO RETURN        32136021
       LA    RW1,GNSV1                                                  32142021
       BC    UNCOND,CLSST          CLOSE  COMMON CODE-GNDEF             32148021
SOR15X EQU     *                                                        32154021
       BC    UNCOND,IDENT    ******** LEAVE SORT SCAN ********          32160021
SOER01 EQU   *                     80                                   32166021
       BAL   RCS,ERROR             ISSUE ERROR MESSAGE                  32172021
       LA      RW1,ELST36                                               32178021
       BC    UNCOND,IDERR          SOER01                               32184021
SOER02 EQU   *                     81                                   32190021
       BAL   RCS,ERROR             ISSUE ERROR MESSAGE                  32196021
       LA      RW1,ELST37                                               32202021
       LA    RW4,CBASCD            SOER02                               32208021
       BC      UNCOND,SOR4X        CHECK IF KEY FOLLOWS                 32214021
SOER03 EQU   *                     82                                   32220021
       LA      RA0,BCDSRK                                               32226021
       BC      UNCOND,IDGVUP       NOT KEY - GIVE UP                    32232021
SOER04 EQU   *                     83                                   32238021
       LA      RA0,BCDUSE                                               32244021
       BC      UNCOND,IDGVUP       GIVE UP                              32250021
SOER05 EQU   *                     84                                   32256021
       LA      RA0,BCDGIV                                               32262021
       BC      UNCOND,IDGVUP       GIVE UP                              32268021
SOER06 EQU   *                     85                                   32274021
       LA      RA0,CBPROC                                               32280021
       BAL   RCS,ERROR             ERROR - ASSUME IT                    32286021
       LA      RW1,ELST07                                               32292021
       BC    UNCOND,SOR8           SOER06                               32298021
SOER08 EQU   *                     87                                   32304021
       BAL   RCS,ERROR             SKIP SORT KEY-GT 256 C/12 KEYS       32310021
       LA      RW1,ELST39                                               32316021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      32322021
       BC    UNCOND,SOR4           SOER08                               32328021
SOER09 EQU   *                     88                                   32334021
       BAL   RCS,ERROR             USING/GIVING MISSING                 32340021
       LA      RW1,ELST3A                                               32346021
       BC      UNCOND,IDERR        ERROR EXIT                           32352021
SOER10 EQU   *                     89                                   32358021
       BAL   RCS,ERROR             ILLEGAL OPERAND                      32364021
       LA      RW1,ELST3B                                               32370021
       BAL     RCS,ISEND           CHK IF VERB,LHN, OR BREAK            32376021
         BC    UNCOND,*+NX8        NO                                   32382021
       BC      UNCOND,IDENT        YES, EXIT                            32388021
       BAL     RCS,GETNXT         SEEK A BETTER KEY                     32394021
       BC      UNCOND,SOR4         CHECK IF GOOD KEY                    32400021
SOER12 BAL     RCS,ERROR           KEY IN WRONG POSITION                32406021
       LA      RW1,ELST5A                                               32412021
       BAL     RCS,GETNXT          GET NEXT INPUT                       32418021
       BC      UNCOND,SOR4         CHECK IF GOOD KEY                    32424021
SOER15   MVC   PSTFLD(LX124),SAVESTOR MOVE SAVED FILE TO PSTFLD         32430021
SOER17 BAL   RCS,ERROR             RD MISSING OR ILLEGAL                32436021
       LA    RW1,ELST55                                                 32442021
       BC    UNCOND,IDERR          ERROR EXIT                           32448021
SOER16   MVC   PSTFLD(LX124),PLEFT        MOVE SD TO PSTFLD             32454021
       BC    UNCOND,SOER17         RD MISSING OR ILLEGAL                32460021
         EJECT                                                          32466021
*=1    RETURN VERB                                                      32472021
*                                                                       32478021
*******************************************************************     32484021
*                                                                       32490021
*                                                                       32496021
*                                                                       32502021
*                           R E T U R N                                 32508021
*                                                                       32514021
*              RETURN VERB...  THIS VERB HAS TWO USES                   32520021
*                  SORT OUTPUT PROCEDURES, TO OBTAIN A SORTED RECOR     32526021
*      AND         LINKAGE, TO RETURN FROM A SUBPROGRAM.                32532021
*                                                                       32538021
*         NOTE... THIS ROUTINE USES THE SEGMENTED STRING                32544021
*           ROUTINES STO5XY WHERE XY = IN, 45, KN.                      32550021
*                                                                       32556021
*** STRINGS PRODUCED                                                    32562021
*      SOURCE - RETURN                                                  32568021
*      OUTPUT - RETURN 'END'                                            32574021
*      SOURCE - RETURN SORT-FILE AT END ...                             32580021
*      OUTPUT - RETURN SORT-FILE RGN 'END'                              32586021
*                                                                       32592021
*                                                                       32598021
*** SUBROUTINES CALLED                                                  32604021
*      GETNXT,STOVRB,STO5IN,STO5CU,ISATND,ERROR                         32610021
*                                                                       32616021
*                                                                       32622021
*** ERROR PROCESSING                                                    32628021
*      ASSUME LINKAGE MODE IF 'ENTER LINKAGE' NOT PREVIOUSLY FOUND      32634021
*       EVEN IF RETURN VERB IS FOLLOWED BY A GARBACEOUS OPERAND         32640021
*      MSG BUT NO SPECIAL EXPEDIENT WHEN 'AT END' IS MISSING            32646021
*                                                                       32652021
*                                                                       32658021
*** NOTES                                                               32664021
*      SPECIAL CASE OF 'AT END NEXY SENTENCE' PRODUCES                  32670021
*          RETURN SORT-FILE 'END'                                       32676021
*                                                                       32682021
*                                                                       32688021
*******************************************************************     32694021
       SPACE   3                                                        32700021
       USING   *,RVRB                                                   32706021
RETURN EQU     *                                                        32712021
         MVI   VERB+NX2,XX01       SET ELEMENT COUNT TO 1         52761 32718021
       CLI     GOTTEN,MSFN         IS SORT-F-N NEXT...                  32724021
       BC    NOTEQ,RETUE6          NO - ERROR                           32730021
         TM    GOTTEN+NX2,XX09   TEST FOR SD NAME                       32736021
         BC    NOTONE,RETUE6  BRANCH IF NOT SD NAME                     32742021
       BAL   RCS,GETALL                SAVE SD IN CASE BAD RECORD       32748021
       LA    RW2,PSTFLD                                                 32754021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      32760021
       BAL   RCS,RDUCOP            GET ATTRIBUTES OF SFREC              32766021
       OI    SKIPSW,MSWON          INVALID REC-SET SW TO SKIP           32772021
         MVC   MODEL(LX2),MODE      SAVE RECORDNAME                     32778021
         MVC   PLEFT(LX124),CURENT     IN PLEFT AND ITS MODE -MODEL     32784021
*DEL                                                                    32790021
*DEL                                                                    32796021
       BAL    RCS,GETNXT           GET NEXT ENTITY                      32802021
         CLC   GOTTEN(LX2),CBRCRD   IS IT OPTIONAL CBWD RECORD          32808021
         BNE   RETNIA        NO-SEE IF INTO                       43983 32814021
       BAL    RCS,GETNXT          DISCARD OPTIONAL WORD                 32820021
RETNIA   DS    0H                                                 43983 32826021
         CLC   GOTTEN(LX2),CBINTO   DOES INTO FOLLOW                    32832021
       BNE   RETU01                NO- GO PROCESS AT END                32838021
       TM    SKIPSW,MSWON          YES-BUT WAS SFREC BAD                32844021
       BZ    RETN1                 NO- PROCESS RETURN INTO              32850021
       NI    SKIPSW,MSWOFF         YES- IGNORE OPTION                   32856021
       B    RETUE4                 BAD RECORD NAME                      32862021
RETN1   BAL   RCS,GETNXT           DATA NAME SHOULD FOLLOW              32868021
       BAL   RCS,RDUCOP            SEE IF OK DATA OP                    32874021
       B    RETUE5                ERROR                                 32880021
         MVC   PRIGHT(LX124),CURENT  OK-SAVE DATANAME IN PRIGHT         32886021
         MVC   MODER(LX2),MODE     AND ITS MODE                         32892021
         BAL   RCS,GETNXT           GET NEXT ELEMENT              43983 32898021
       BAL   RCS,ISOKMV             SEE IF ALLOWABLE MOVE               32904021
       B    RETN2                  MSG ALREADY WRITTEN- EXIT            32910021
       BAL   RCS,STLOOP            STORE MOVE STRING                    32916021
       DC    XL2'3'                                                     32922021
      LA    RW4,MOVEVB                                                  32928021
       LA RW4,PLEFT                SF REC  TO                           32934021
       LA    RW4,PRIGHT            DATA NAM%E                           32940021
RETN2    DS    0H                                                 43983 32946021
RETU01   DS    0H                                                 52761 32952021
         BAL   RCS,STOVRB                 STORE RETURN VERB             32958021
       LA    RA0,CBEND             SET RA0 FOR POSSIBLE MESSAGE         32964021
       BAL   RCS,ISATND            IS IT 'AT END'                       32970021
       B     RETN5            AT END NOT FOUND OR NXT SENT FOLLOWS      32976021
RETN4    DS    0H                                                 52761 32982021
         MVI   VERB+NX2,XX02       SET ELEMENT COUNT 2            52761 32988021
         BAL   RCS,GENDAT          PUT OUT  RETURN VERB           52761 32994021
         LA    RW2,VERB            ADDR OF VERB                   43983 33000021
         BAL   RCS,GENDAT             PUTOUT SFNM                 43983 33006021
         LA    RW2,PSTFLD                                         43983 33012021
         BAL   RCS,GENDAT          GEN SF DATA ITEM               52761 33018021
         LA    RW2,PLEFT           SF DATA ITEM                   52761 33024021
         BAL   RCS,GENSTR           GENERAT RETURN STRING         43983 33030021
       BC    UNCOND,IDENT         RETURN TO IDENT                       33036021
RETN5  LA    RW4,CBEND           STORE 'END' INPLACE OF GN AT END       33042021
       BAL    RCS,STOR45           IN STRING                            33048021
       BC    UNCOND,RETN4         GO TO GENERATE STRING                 33054021
RETUE4 DS    0H                                                         33060021
       BAL   RCS,ERROR             ERROR - MSG 85                       33066021
       LA    RW1,ELST55            ERROR EXIT                           33072021
         BC    UNCOND,IDERR        DISCARD TILL ENDWORD                 33078021
RETUE5      LA    RA0,BCDDN                                             33084021
       BC    UNCOND,IDGVUP         GIVE UP                              33090021
RETUE6 BAL   RCS,ERROR             ERROR - MSG 54                       33096021
         LA    RW1,ELST36                                               33102021
         BC    UNCOND,IDERR        ERROR EXIT                           33108021
       EJECT                                                            33114021
*=1    RLEASE  VERB                                                     33120021
*******************************************************************     33126021
*                                                                       33132021
*                                                                       33138021
*                           R L E A S E                                 33144021
*                                                                       33150021
*                                                                       33156021
*** STRINGS PRODUCED                                                    33162021
*      SOURCE - RELEASE DN                                              33168021
*      OUTPUT - RELEASE DN                                              33174021
*                                                                       33180021
*                                                                       33186021
*** SUBROUTINES CALLED                                                  33192021
*      GETNXT,STOVRB,STOINP,ISSORK,GENSTR,ERROR                         33198021
*                                                                       33204021
*                                                                       33210021
*** ERROR PROCESSING                                                    33216021
*      SKIP STATEMENT IF DN IS NOT A LEGAL SORT KEY AT THE 01 LEVEL     33222021
*                                                                       33228021
*                                                                       33234021
*                                                                       33240021
*******************************************************************     33246021
       SPACE   3                                                        33252021
       USING   *,RVRB                                                   33258021
RLEASE EQU     *                                                        33264021
       BAL     RCS,ISSORK          IS DN A SORT KEY...                  33270021
       BC      UNCOND,RELEE1       NO                                   33276021
         TM    DX7(RIN),MLEV1 IS DN 01 LEVEL                            33282021
       BC    ZERO,RELEE1    NO                                          33288021
       BAL   RCS,GETALL       SAVE DN                                   33294021
       LA    RW2,SAVE1OP                                                33300021
       BAL     RCS,GETNXT          GET NEXT ENTITY                      33306021
         CLC   GOTTEN(LX2),CBFROM                                       33312021
       BNE   RLSEXT                NO FROM- GENR STRING AND EXIT        33318021
         MVC   PRIGHT(LX124),CURENT       SAVE SD REC                   33324021
         MVC   MODER(LX2),MODE           AND ITS MODE IN PRIGHT         33330021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      33336021
       BAL    RCS,RDUCOP         SEE IF VALID DATANAME FOLLOWS          33342021
       B    RELEE2                ERROR                                 33348021
         MVC   PLEFT(LX124),CURENT        SAVE IT IN PLEFT              33354021
         MVC   MODEL(LX2),MODE                                          33360021
       BAL   RCS,ISOKMV        ARE THEY COMPATIBLE FOR MOVE             33366021
       B     RLSE1                 NO                                   33372021
       BAL     RCS,STLOOP     STORE 3 ELEMENTS IN STRING                33378021
       DC    XL2'3'                                                     33384021
       LA    RW4,MOVEVB       MOVE VERB                                 33390021
       LA      RW4,PLEFT      DATA NAME                                 33396021
       LA    RW4,PRIGHT       SD REC                                    33402021
RLSEXT DS    0H                                                         33408021
       BAL   RCS,STOVRB       STORE RELEASE VERB                        33414021
       LA    RW4,SAVE1OP                                                33420021
       BAL   RCS,STOR45       STORE DN                                  33426021
RLSE1  DS    0H                                                         33432021
       CLI   GOTTEN,MVERB     IS IT A VERB                              33438021
       BE    RLSE2            YES, DON'T GET NEXT ELEMENT               33444021
       BAL   RCS,GETNXT       GET NEXT ELEMENT                          33450021
RLSE2  DS    0H                                                         33456021
       BAL   RCS,GENSTR       GENR RELEASE STRING                       33462021
       BC    UNCOND,IDENT                    EXIT                       33468021
RELEE2 LA    RA0,BCDDN                                                  33474021
       B    IDGVUP          ERROR EXIT                                  33480021
RELEE1 EQU   *                     97                                   33486021
       BAL   RCS,ERROR             ERROR - MSG 66                       33492021
       LA      RW1,ELST42                                               33498021
       BC    UNCOND,IDERR          RELEE1                               33504021
       EJECT                                                            33510021
       EJECT                                                            33516021
       EJECT                                                            33522021
*=1    CALL    VERB                                                     33528021
*=1    LINK    VERB                                                     33534021
*=1    ENTRY   VERB                                                     33540021
*******************************************************************     33546021
*                                                                       33552021
*                                                                       33558021
*                           C A L L                                     33564021
*                           L I N K                                     33570021
*                           E N T R Y                                   33576021
*                                                                       33582021
*                                                                       33588021
*** STRINGS PRODUCED                                                    33594021
*      SOURCE - LINK 'EXT'                                              33600021
*      OUTPUT - LINK 'FIRST' 'EXT' 'END'                                33606021
*      SOURCE - CALL 'EXT' USING DN FN PN1 PN2 PN3                      33612021
*      OUTPUT - CALL 'FIRST' 'EXT' DN FN PN1                            33618021
*               CALL  PN2 PN3 'END'                                     33624021
*                                                                       33630021
*                                                                       33636021
*** SUBROUTINES CALLED                                                  33642021
*      GETNXT,STOVRB,STO5IN,ST5PNI,STO5CU,RDUCOP,ERROR                  33648021
*                                                                       33654021
*                                                                       33660021
*** ERROR PROCESSING                                                    33666021
*      SKIP STATEMENT IF FIRST OPERAND NOT AN EXTERNAL NAME             33672021
*      SKIP USING CLAUSE IF 1ST SUCCEEDING OPERAND IS NOT A LEGAL O     33678021
*      END USING CLAUSE AT FIRST ILLEGAL OPERAND - IDENT FINDS ERRO     33684021
*                                                                       33690021
*                                                                       33696021
*        THESE SHARE A COMMON SCAN AND USE THE STO5XY ROUTINES          33702021
*             FOR STRING SEGMENTATION.                                  33708021
*                                                                       33714021
*******************************************************************     33720021
       SPACE   3                                                        33726021
       USING   *,RVRB                                                   33732021
CALL   EQU     *                                                        33738021
LINKVB EQU   *                                                          33744021
       NI      ENTRSW,MSWOFF       SWITCH OFF FOR CALL                  33750021
       LA    RVRB,ENTRY-CALL(RVRB)         BRANCH TO ENTRY CODE         33756021
       USING ENTRY,RVRB                                                 33762021
       BC    UNCOND,ENTR01         ENTRY CODE                           33768021
       USING   *,RVRB                                                   33774021
ENTRY  EQU     *                                                        33780021
       TM    SEGLM,NONSEG          IS PROGRAM SEGMENTED                 33786021
       BC    NOTONE,ENTR2A     SEGMENTED                                33792021
ENTR1A DS    0H                                                         33798021
       OI      ENTRSW,MSWON        SWITCH ON FOR ENTRY                  33804021
ENTR01 BAL     RCS,STO5BG         STORE VERB AND 'FIRST'(KEEP INSTR     33810021
*                                    ENTRY+4)                           33816021
       BAL     RCS,ISITXN          IS IT XN...                          33822021
       BC    UNCOND,LKMDE4          NO                                  33828021
       BAL     RCS,STO5IN           YES,SAVE                            33834021
       BAL     RCS,GETNXT          GET NEXT INPUT                       33840021
         CLC   GOTTEN(LX2),CBUSIN   ='USING'...                         33846021
       BC      NOTEQ,ENTR02         NO,FINISHED                         33852021
       NI      PFNDOP,MSWOFF                                            33858021
ENTR03 EQU     *                                                        33864021
       BAL     RCS,GETNXT          GET NEXT INPUT                       33870021
       BAL     RCS,ENTR04          IS IT LEGAL OPERAND...               33876021
       BAL     RCS,ST5PNI            YES                                33882021
       BC      UNCOND,ENTR03        YES, LOOP THRU AGAIN                33888021
ENTR02 BAL     RCS,STO5CU          GEN STRING                           33894021
       BC      UNCOND,IDENT        EXIT FROM CALL AND ENTRY VERBS..     33900021
LKMDE4 EQU   *                     9A                                   33906021
       LA      RA0,BCDXTN                                               33912021
       BAL   RCS,ERROR             NOT EXTERNAL NAME, SKIP STMNT        33918021
       LA      RW1,ELST32                                               33924021
       BC    UNCOND,IDERR          LKMDE4                               33930021
ENTRER BAL   RCS,ERROR             CALL SEGMENTED, ERROR                33936021
       LA    RW1,ELST6C                                                 33942021
       B     IDERR       ERROR EXIT                                     33948021
ENTR2A DS    0H                                                         33954021
       CLC   PTYCEL(LX1),SEGLM     SEGMENT INDEP                        33960021
       BL    ENTR1A           YES - OK                                  33966021
       B     ENTRER           NO - ERROR                                33972021
*                                                                       33978021
* ISIT TYPE ROUTINE FOR CHECKING CALL,ENTRY OPERANDS                    33984021
*                                                                       33990021
ENTR04 STM     RCS,RW2,SVSO14                                           33996021
       BAL     RCS,RDUCOP          IS IT A DN...                        34002021
       BC      UNCOND,ENTR4A       NO,PERHAPS APN,FN,ETC.               34008021
         TM    MODE,MLITBT                                              34014021
         BC    ONES,ENTR06         LITERAL -ERROR                       34020021
       TM      ENTRSW,MSWON        YES, CALL OR ENTRY                   34026021
       BC      ZERO,ENTR4Y         CALL,ANY DN O.K.                     34032021
       SR      RW2,RW2             ENTRY,ONLY LINKAGE O.K.              34038021
         IC    RW2,DX2(RIN)                                             34044021
         LA    RCS,DX7              MASK OUT MAJOR IN RW2               34050021
       NR    RW2,RCS                                                    34056021
       CH      RW2,N5              MUST BE LINKAGE                      34062021
       BC      NOTEQ,ENTR4N        NOT LEGAL                            34068021
         TM    DX7(RIN),MLV177 IS DN AT 01 OR 77 LEVEL                  34074021
       BC    ZERO,ENTR4N    NO-ERROR                                    34080021
       BC    UNCOND,ENTR4Y         YES                                  34086021
ENTR4A TM      ENTRSW,MSWON        IS IT ENTRY...                       34092021
       BC      ONES,ENTR4N         YES,NOT LEGAL                        34098021
       CLI     GOTTEN,MFILE       NO, FN...                             34104021
       BC      EQ,ENTR4Y           YES,OK                               34110021
       CLI     GOTTEN,MPNU        PN...                                 34116021
       BC      NOTEQ,ENTR4N        NO                                   34122021
ENTR4Y LM      RCS,RW2,SVSO14      YES                                  34128021
       OI      PFNDOP,MSWON       AT LEAST 1 FOUND                      34134021
       BCR     UNCOND,RCS          RETURN                               34140021
ENTR4N BAL     RCS,ISEND          IS IT END                             34146021
       BC      UNCOND,ENTR06        NO                                  34152021
       TM      PFNDOP,MSWON       WAS ANY OP FOUND AFTER 'USING'        34158021
       BC      ONES,ENTR02         YES - OK                             34164021
       OI      NEXTIN,MSWON        NO - LET IDENT COMMANT               34170021
       LA      RIN,CBUSIN                                               34176021
       BC      UNCOND,ENTR02       GENERATE STRING                      34182021
ENTR06   MVI   MODE+NX1,MFF         MODE IRRELEVANT FOR MSG 4 HERE      34188021
         BAL   RCS,ERROR           ERROR - MSG 4                        34194021
       LA      RW1,ELST04                                               34200021
       OI      PFNDOP,MSWON       AVOID IDENT MSG                       34206021
       BC      UNCOND,ENTR03       GET NEXT                             34212021
       EJECT                                                            34218021
*=1    EXIT    VERB                                                     34224021
*******************************************************************     34230021
*                                                                       34236021
*                                                                       34242021
*                                 E X I T                               34248021
*                                                                       34254021
*      NO STRING IS PRODUCED.                                           34260021
*                                                                       34266021
*** ERROR PROCESSING                                                    34272021
*      SYNTAX-CHECK MERELY MAKES SURE PN PRECEDES AND PERIOD FOLLOW     34278021
*                                                                       34284021
*** SUBROUTINES CALLED                                                  34290021
*      GETNXT,ERROR                                                     34296021
*                                                                       34302021
*                                                                       34308021
*                                                                       34314021
*******************************************************************     34320021
       SPACE   6                                                        34326021
       USING   *,RVRB                                                   34332021
EXIT   EQU     *                                                        34338021
       OI      GENRED,MSWON       AVOID 'INCOMPLETE MSG FROM IDENT      34344021
         CLI   SAVLHN,XX00         DID LHN PRECEDE                      34350021
       BC      EQ,EXIT4             NO -ERROR                           34356021
         NI    SAVLHN,XX00                                              34362021
EXIT1    CLC   GOTTEN(LX2),CBEOS      DOES PERIOD FOLLOW                34368021
       BC    NOTEQ,EXIT5           SEE IF PROGRAM FOLLOWS               34374021
       BAL     RCS,GETNXT          YES, GET NEXT INPUT                  34380021
       OI      NEXTIN,MSWON                                             34386021
       CLI     GOTTEN,MPND          YES - DOES PN FOLLOW                34392021
       BC      EQ,EXIT2            YES                                  34398021
       CLI     GOTTEN,MBREAK        OR BREAK                            34404021
       BC      EQ,EXIT2            YES- BREAK                           34410021
         CLC   GOTTEN(LX2),CBDBUG   OR *DEBUG                           34416021
       BC      NOTEQ,EXIT3         NO - ERROR                           34422021
EXIT2  LA      RIN,CBEOS                                                34428021
       BC      UNCOND,IDENT        EXIT                                 34434021
EXIT3  LA      RIN,CBEOS                                                34440021
EXIT4  BAL     RCS,ERROR          NO - ERROR                            34446021
       LA      RW1,ELST16                                               34452021
       BC      UNCOND,IDENT        EXIT                                 34458021
EXIT5    CLC   GOTTEN(LX2),CBPROG                                       34464021
       BNE    EXIT4                NO - ERROR                           34470021
       BAL   RCS,GENDAT            WRITE TO OUTPUT                      34476021
       LA    RW2,EXITPG                                                 34482021
       BAL   RCS,GETNXT            GET NEXT ENTITY                      34488021
       B     EXIT1     SEE IF PERIOD FOLLOWS                            34494021
IKF40E CSECT                                                            34500021
*=1   SEARCH VERB                                                       34506021
*                                                                       34512021
*               SEARCH                                                  34518021
*                                                                       34524021
* STRINGS  PRODUCED-                                                    34530021
* SOURCE-SEARCH ID1 MAX-OCCUR  MIN-OCCUR VARYING INDNM1                 34536021
*         VARYING INDNM2;AT END  GO PN1 ; WHEN COND-1 GO PN2...         34542021
*         WHEN COND-N  GO  PNN.                                         34548021
*                                                                       34554021
*- OUTPUT                                                               34560021
*                GO  RGN1                                               34566021
*  RGN0                                                                 34572021
*                GO  PN1                                                34578021
*         LGN2                                                          34584021
*         WHEN COND-1                                                   34590021
*                IF  COND-1 NOT TRUE  RGN3                              34596021
*                GO  PN2                                                34602021
*         LGN3                                                          34608021
*         WHEN COND-N                                                   34614021
*                IF COND-N NOT  TRUE RGNN                               34620021
*                 GO  PNN                                               34626021
*         VARYINGS                                                      34632021
*         LGNN                                                          34638021
*                 SET INDNM1 UP BY 1                                    34644021
*                 SET INDNM2 UP BY 1                                    34650021
*  LGN1                                                                 34656021
*         IF  COND  FOR  AT END                                         34662021
*   IF INDNM 1 GT MAX-OCCUR RGN0                                        34668021
*                GO RGN2                                                34674021
*                                                                       34680021
* ERROR PROCESSING-                                                     34686021
*         IF IDENTIFIER-1 INVALID, GIVE UP.                             34692021
*         IF USER'S VARYING INVALID,DISCARD AND USE PH3 VARYING.        34698021
*         IF SEARCH CALLED BY PREVIOUS SEARCH,GIVE UP.                  34704021
*         IF GARBAGE BEFORE AT END,DISCARD TILL AT, WHEN,OR NEXT        34710021
*         VERB AND ISSUE MSG ONCE.IF VERB FOUND BEFORE AT OR            34716021
*         WHEN,GIVE UP.                                                 34722021
*         IF VERB DOES NOT FOLLOW 'AT END' OR 'WHEN',WRITE MSG          34728021
*         GENERATE GO NEXT SENTENCE, SEEK WHEN.                         34734021
*         IF WHEN NOT FOUND AT ALL,DISCARD TILL NEXT VERB               34740021
*         AND  GIVE UP.IF GARBAGE BETWEEN VERB FOLLOWING                34746021
*         AT END  OR VERB FOLLOWING PREVIOUS WHEN AND                   34752021
*         THIS WHEN,WRITE MSG,DISCARD TILL WHEN OR NEXT                 34758021
*         VERB.                                                         34764021
*                                                                       34770021
* ROUTINES CALLED: GETNXT,GETALL,ISTRUV,ISEND,NEWNXT,                   34776021
*         PGONXT,ERROR,ISINT,PUPLGN,STLOOP,STOR45,GENDAT,               34782021
*         GENSTR,ISDTOP,IF RTN TO PROCESS WHENS,ID5 OF                  34788021
*         IDENT TO INITIALIZE AND BRANCH TO VERBS                       34794021
*                                                                       34800021
* NOTES:  IF IMPERATIVE STATEMENTS AFTER WHEN,AT END DO                 34806021
*         NOT END WITH GO TO, THIS RTN GENERATES A                      34812021
*         GO TO NEXT SENTENCE.                                          34818021
*                                                                       34824021
* SWITCHES:                                                             34830021
*         ATNDFND- IF ON,PH4,NOT USER WROTE AT END CLAUSE               34836021
*         VRYIND2- '''',USER IS VARYIND INDEXNAME 2                     34842021
*         TWOVRY-  '''',TWO VARYINGS ARE PRESENT                        34848021
*         GOSW-    '''',IF ON,GO WAS LAST VERB AFTER COND               34854021
*                        GO NEXT SENT NOT NEEDED                        34860021
*         WHENSW-''''AT LEAST  ONE WHEN FOUND                           34866021
*         SEARCHSW-TURNED ON BY SEARCH VERB-                            34872021
*                   CHECKED BY IDENT,IF,SEARCH,GO                       34878021
*                                                                       34884021
*                                                                       34890021
       USING *,RVRB                                                     34896021
SEARCH EQU   *                                                          34902021
*INITIALIZE SWITCHES                                                    34908021
       NI    WHENSW,MSWOFF                                              34914021
       NI    SKIPSW,MSWOFF                                              34920021
       NI    TWOVRY,MSWOFF                                              34926021
       NI    ATNDFND,MSWOFF                                             34932021
       NI    VRYIND2,MSWOFF                                             34938021
       NI    GOSW,MSWOFF                                                34944021
       NI    VRYSS,MSWOFF                                               34950021
         XC    WHENGN+NX1(LX2),WHENGN+NX1                               34956021
       BAL   RCS,IFSRCH1      BRANCH TO SAVE GN'S                 5961  34962021
       BAL   RCS,ISTRUV            SEE IF COND ALLOWED                  34968021
       OI    SEARCHSW,MSWON                                             34974021
         XC    DMAX(LX3),DMAX                                           34980021
*SEE IF IDENTIFIER-1 VALID                                              34986021
         CLI   GOTTEN,XX30                                              34992021
       BNE   SRCHERR1              NO-GIVE UP                           34998021
       BAL   RCS,GETNXT            YES, GET MAX-OCCUR                   35004021
       BAL   RCS,GETALL            SAVE MAX OCCUR OR OBJ OF ODO         35010021
       LA    RW2,MAXSAVE                                                35016021
       BAL   RCS,GETNXT            MUST BE VARYING-DISCARD              35022021
       BAL   RCS,GETNXT            INDNM1                               35028021
       BAL   RCS,GETALL            SAVE 1ST VARY OP                     35034021
       LA    RW2,INDVRY1                                                35040021
       BAL   RCS,GETNXT            GET NEXT INPUT                       35046021
         CLC   GOTTEN(LX2),CBVARY   IS THERE ANOTHER VARYING            35052021
       BNE   SRCH6                 NO                                   35058021
       BAL   RCS,GETNXT              PT RIN TO OPERAND                  35064021
*VARYING  FOUND - THIS  IS THE USERS VARYING                            35070021
       BAL   RCS,GETALL            SAVE THE OPERAND                     35076021
       LA    RW2,VARY2SV                                                35082021
*    IF THIS OPERAND IS FOUND TO BE SUBSCRIPTED OR INDEXED              35088021
*   WE WANT TO PRESERVE THE SUBSCRIPTS IN SVSRCHT RATHER THAN IN        35094021
*   DEFSBS TABLE SINCE WE WILL NOT BE GENERATING STRING UNTIL           35100021
*   MUCH LATER- AND DEFSBS WILL BE USED BY VERB ANALYZERS FOLLOWING     35106021
*   AT END AND  WHEN- THEREFORE WE ARE USING A METHOD SIMILASR          35112021
*  TO MOVE OR ADD CORRESPONDING- TURNING ON DRYRUN HER%E-CORRSW         35118021
*   LATER AND OPSSSW IF NEC                                             35124021
       LA    RCS,SVSRCHT                                                35130021
       ST   RCS,THISOP         TELLS SUBSCR TO STORE SS HERE            35136021
       OI    DRYRUN,MSWON                                               35142021
       BAL   RCS,RDUCOP          SEE IF VALID OPERAND                   35148021
       B     ISINDX                NO-SEE IF INDEXNAME                  35154021
       BAL   RCS,ISINT2            IS IT A FIXED POINT INTEGER          35160021
       B     SRCHERR2              NO-ISSUE WARNING AND IGNORE          35166021
       TM    MODE,MLITBT              IS OPERAND A LITERAL              35172021
       BO    SRCHERR2             YES- NO GOOD                          35178021
       CLI   GOTTEN,MSS       WAS IT SUBSCRIPTED                        35184021
       BNE   SRCH4                 NO - OK                              35190021
       OI    VRYSS,MSWON           SIGNAL LATER IN SEARCH               35196021
SRCH4  OI    TWOVRY,MSWON          TWO VALID VARYINGS                   35202021
       BAL   RCS,GETNXT            GET NEXT INPUT                       35208021
       B     SRCH6                 GO TO STORE LGN                      35214021
ISINDX TM    GOTTEN,MDN            DATA OP AT ALL                       35220021
       BC    NOTONE,SRCHERR2       NO-ERRMSG AND IGNORE                 35226021
         CLI   GOTTEN+NX3,USINDX    IDEX DATA ITEM                      35232021
         BNE   SRCH41                     BR SRCH41               43954 35238021
         OI    USINDX1,MSWON          SET DATA ITEM               43954 35244021
         B     SRCH4               BRANCH SRCH4                   43954 35250021
SRCH41   CLI   GOTTEN,XX36           IS IT A INDEX NAME           43954 35256021
       BNE   SRCHERR2              NO, ERROR                            35262021
       OI    VRYIND2,MSWON         SECOND VARY IS INDNM                 35268021
       B     SRCH4                 IT IS VALID                          35274021
SRCH6  BAL   RCS,PUPLGN            STORELGN1 IN STRING                  35280021
         MVC   RGN+NX1(LX2),NXTLGN                                      35286021
       NI    DRYRUN,MSWOFF                                              35292021
       BAL   RCS,GENDAT            WRITE 'GO' TO OUTPUT                 35298021
       LA    RW2,CBGO                                                   35304021
       BAL   RCS,GENDAT            WRITE RGN TO OUTPUT                  35310021
       LA    RW2,RGN               GO RGN                               35316021
         MVC   SVGN1+NX1(LX2),RGN+NX1 SAVE FOR LGN LATER                35322021
       BAL   RCS,PUPLGN            GET NEW GN NUMBER                    35328021
         MVC   LGN+NX1(LX2),NXTLGN                                      35334021
       BAL   RCS,GENDAT            WRITE LGN TO OUTPUT                  35340021
       LA    RW2,LGN        LGN PTS TO IMP STATEMENT ATEND              35346021
         MVC   SVGN2+NX1(LX2),LGN+NX1 SAVE TO REFERENCE LATER           35352021
         CLC   GOTTEN(LX2),CBAT     SEEK AT END (OPTIONAL)              35358021
         BNE   *+NX8               'AT' MISSING, BUT OPTIONAL           35364021
SRCH6A BAL   RCS,GETNXT            GET NEXT INPUT- IS IT END            35370021
         CLC   GOTTEN(LX2),CBEND                                        35376021
       BNE   SRCH9                 NOT 'END'                            35382021
*                                                                       35388021
SRCH7  BAL   RCS,PUPLGN            GET NEXT NEW GN                      35394021
         MVC   WHENGN+NX1(LX2),NXTLGN SAVE RGNID FOR LGN BEFORE WHEN    35400021
         MVC   SVGN3+NX1(LX2),WHENGN+NX1 SAVE FOR FUTURE REF            35406021
       TM    ATNDFND,MSWON         USER'S OR PH4'S AT END               35412021
       BO    SRCH20                MUST GENR GO NXTSENT-PH4 AT END      35418021
       BAL   RCS,GETNXT            VERB SHOULD FOLLOW                   35424021
       B     SRCH10                CHECK IF IT IS VERB                  35430021
*                                                                       35436021
*    AT OR END NOT FOUND-SEE IF NEXT ENTITY IS  WHEN,                   35442021
*    VERB,OR GARBAGE                                                    35448021
SRCH9    CLC   GOTTEN(LX2),CBWHEN                                       35454021
       BE    SRCH9A                OK-AT END OPTIONAL                   35460021
       BAL   RCS,ERROR             WHEN NOT FOUND - DISCARD             35466021
       LA    RW1,ELST68                                                 35472021
SRCHE0 BAL   RCS,ISEND             IS IT VERB,AT END OR WHEN            35478021
       B     SRCHE1                IT IS NOT A VERB                     35484021
       B     SRCH19                VERB- GIVE UP                        35490021
SRCHE1   CLC   GOTTEN(LX2),CBWHEN                                       35496021
       BE    SRCH9A                'WHEN' FOUND                         35502021
         CLC   GOTTEN(LX2),CBAT     MAYBE GARBAGE BEFORE AT END         35508021
       BE    SRCH6A                'AT' FOUND                           35514021
         CLC   GOTTEN(LX2),CBEND                                        35520021
       BE    SRCH7                 'END' FOUND                          35526021
       BAL   RCS,GETNXT            GET NEXT INPUT                       35532021
       BC    UNCOND,SRCHE0         SCAN TILL AT END,WHEN,OR VERB        35538021
SRCH9A OI    ATNDFND,MSWON                                              35544021
       B     SRCH7                 GET NEW GN NUMBER                    35550021
*                                                                       35556021
*      GIVE CONTROL  TO IMPERATIVE STATEMENT                            35562021
*      IF RETURNS CONTROL HERE                                          35568021
*                                                                       35574021
SRCH10 CLI   GOTTEN,MVERB                                               35580021
       BNE   SRCHERR3              ERROR-IMP.STATEMENT MUST FOLLOW      35586021
         CLC   GOTTEN(LX2),CBEOS    CONDITION.                          35592021
       BE    SRCH1B                EOS                                  35598021
SRCH1A   CLC   GOTTEN(LX2),CBSRCH   IS VERB SEARCH                      35604021
       BNE   CKSA                  MAKE SURE NOT SEARCHALL              35610021
SERR   LA    RA0,BCDIMPST                                               35616021
       BAL   RCS,GENDAT            WRITE GN1 TO OUTPUT                  35622021
       LA    RW2,SVGN1                                                  35628021
       BAL   RCS,GENDAT            WRITE WHEN TO OUTPUT                 35634021
       LA    RW2,WHENGN                                                 35640021
       BAL   RCS,ZERPSH         PREVENT VARYGNS FROM BEING GENERATE     35646021
*                                  LATER                                35652021
       NI    SEARCHSW,MSWOFF                                            35658021
       NI    SRCHALSW,MSWOFF                                            35664021
       NI    GOSW,MSWOFF                                                35670021
       BC    UNCOND,IDGVUP         GIVE UP                              35676021
CKSA     CLC   GOTTEN(LX2),CBSRCHA                                      35682021
       BE    SERR                ERROR- GIVE UP                         35688021
         CLC   GOTTEN(LX2),CBIF    IS IT IF                             35694021
       BE    SERR               YES- DONT PROCESS IT                    35700021
       NI    GOSW,MSWOFF                                                35706021
       B     ID5                   HAVE IDENT INITIALIZE AND BRANCH     35712021
SRCH11 EQU   *                                                          35718021
*  VERB ANALYZER RETURNS HERE                                           35724021
         CLC   GOTTEN(LX2),CBEOS                                        35730021
       BE    SRCH1B                EOS                                  35736021
         CLC   GOTTEN(LX2),CBELSE  4408 ELEMENT  COBOL ELSE       56177 35742021
         BNE   SRCHVB              NOT ELSE                       56177 35748021
         TM    IFSW1,MSWON         THIS SEARCH IS IN IF IMP.      56177 35754021
         BO    SRCHVB              YES, FROM IF   PROCESS         56177 35760021
         B     SRCHERR2            ELSE IS SPECIFIED IN SEARCH    56177 35766021
SRCHVB   DS    0H                                                 56177 35772021
       CLI   GOTTEN,MVERB                                               35778021
       BE    SRCH1A                YES - VERB                           35784021
SRCH1B BAL   RCS,PZSTRT            REINIT. STRING AND DFSBS             35790021
       LA    RW2,ASTRNG                                                 35796021
       LA    RW1,ADFSBS                                                 35802021
       NI    STO5SW,MSWOFF                                              35808021
       TM    GOSW,MSWON                                                 35814021
       BZ    SRCH20                GENR GO NEXT SENTENCE                35820021
       NI    GOSW,MSWOFF           LAST VERB WAS 'GO TO '               35826021
*                                                                       35832021
*      SEEK  WHEN                                                       35838021
*                                                                       35844021
SRCH12   CLC   GOTTEN(LX2),CBWHEN                                       35850021
       BNE   SRCH13                NOT 'WHEN'                           35856021
SRCH12A TM   SRCHALSW,MSWON                                             35862021
       BO    SRCH12C               SWITCH IS ON                         35868021
SRCH12B  DS    0H                                                 58946 35874021
         TM    WHENSW,MSWON        IS THIS FIRST WHEN OF SEARCH   58946 35880021
         BO    SRCH12E             NO, GO TO GEN GNLIST           58946 35886021
         BAL   RCS,GENDAT          YES, GEN WHEN GN               58946 35892021
         LA    RW2,WHENGN                                         58946 35898021
         B     SRCH12F             BYPASS GENLIST                 58946 35904021
SRCH12E  DS    0H                                                 58946 35910021
         BAL   RCS,GENLST          GENLIST FROM 2ND WHEN ON       58946 35916021
SRCH12F  DS    0H                                                 58946 35922021
       OI    WHENSW,MSWON          AT LEAST 1 WHEN FOUND                35928021
       NI    TRUVRB,MSWOFF                                              35934021
       BAL   RCS,GETNXT            GET NEXT INPUT                       35940021
        TM   SRCHALSW,MSWON        CHECK SRCHALL BEFORE                 35946021
       BO    *+10                  BRANCH TO IF                         35952021
       L     RVRB,AIF                                                   35958021
       BR    RVRB                  GO TO IF                             35964021
        L    RVRB,ASRCHAL                                               35970021
        USING SRCHAL,RVRB                                               35976021
        BC   UNCOND,WHEN0          WHAT IS FOUND AFTER 'WHEN'           35982021
       USING  SEARCH,RVRB                                               35988021
SRCH12C TM   WHENSW,MSWON                                               35994021
       BZ    SRCH12B               THERE IS NOT EVEN 1 WHEN             36000021
       BC    UNCOND,SRCH30         LET IDENT  FIND GARBAGE              36006021
*                                                                       36012021
* WHEN NOT FOUND                                                        36018021
*                                                                       36024021
SRCH13 TM    WHENSW,MSWON          WAS THERE EVER A WHEN                36030021
       BO    SRCH27                YES-PROCESS VARYINGS                 36036021
       CLI   GOTTEN,MVERB          NO WHEN-IS THIS END                  36042021
       BNE   SRCHERR4              NO-SCAN TILL WHEN OR VERB            36048021
SRCH19 BAL   RCS,GENDAT            ERROR EXIT                           36054021
       LA    RW2,SVGN1                                                  36060021
SRCH19A NI   SEARCHSW,MSWOFF                                            36066021
        NI   SRCHALSW,MSWOFF                                            36072021
       NI    GOSW,MSWOFF                                                36078021
       TM    WHENSW,MSWON                                               36084021
       BO    IDERR     SRCHALL ERROR- MSG ALREADY WRITTEN               36090021
       LA    RA0,CBWHEN                                                 36096021
       BC    UNCOND,IDGVUP         LET IDENT WRITE MESSAGE              36102021
*                                                                       36108021
* GO TO NEXT SENTENCE NEEDED                                            36114021
*                                                                       36120021
SRCH20 BAL   RCS,PGONXT            STORE 'GO NEXT SENTENCE'             36126021
       BAL   RCS,GENSTR            GENERATE STRING                      36132021
       B     SRCH12                SEEK 'WHEN'                          36138021
*                                                                       36144021
* PROCESS VARYINGS                                                      36150021
*                                                                       36156021
*                                                                       36162021
SRCH27 TM    SRCHALSW,MSWON                                             36168021
       BO    SRCH30    SKIP VARYINGS FOR SEACH-ALL                      36174021
         BAL   RCS,GENLST          GEN. GNDEF TXT  FROM TIB 17    38988 36180021
*                                                                 38988 36186021
       BAL   RCS,STLOOP            STORE INDNM1,INDVRY1,NUM-LIT1        36192021
       DC    XL2'3'                STORE  3 ELEMENTS                    36198021
       LA    RW4,SETUP             SET INDNM1 UP BY 1                   36204021
       LA    RW4,INDVRY1                                                36210021
       LA    RW4,NUMLT1                                                 36216021
       BAL   RCS,GENSTR            GENERATE STRING                      36222021
       TM    TWOVRY,MSWON          WERE THERE 2 VARYINGS                36228021
       BZ    SRCH30                NO                                   36234021
       TM    VRYIND2,MSWON         IS SECOND AN INDEX-NAME              36240021
         BO    SRCH281             YES                            43954 36246021
         TM    USINDX1,MSWON             INDEX-DATA-ITEM          43954 36252021
         BZ    SRCH28               NO                            43954 36258021
         BAL   RCS,STLOOP        STORE SET VARY2,VARY1            43954 36264021
         DC    XL2'3'   STORE                                     43954 36270021
         LA    RW4,SETP2           SET FORMAT 1                   43954 36276021
         LA    RW4,VARY2SV                                        43954 36282021
         LA    RW4,INDVRY1                                        43954 36288021
         BAL   RCS,GENSTR          GENERATE STRING                43954 36294021
         BC    UNCOND,SRCH30            GO TO SERCH30             43954 36300021
*                                                                       36306021
SRCH281  BAL   RCS,STLOOP                 OUTPUT STRING           43954 36312021
       DC    XL2'3'                STORE  3 ELEMENTS                    36318021
       LA    RW4,SETUP                                                  36324021
       LA    RW4,VARY2SV                                                36330021
       LA    RW4,NUMLT1                                                 36336021
       BAL   RCS,GENSTR            GENERATE STRING                      36342021
       BC    UNCOND,SRCH30         SEARCHALL                            36348021
*                                                                       36354021
*                                                                       36360021
SRCH28 TM    VRYSS,MSWON          WAS OP FOUND TO BE SUBSCRIPTED        36366021
       BZ    SRCH29                NO                                   36372021
       LA    RCS,SVSRCHT       TELL SUBSCR TO BUILD A STRING            36378021
       ST    RCS,THISOP                                                 36384021
       LA    RIN,VARY2SV                                                36390021
       OI    CORRSW,MSWON                                               36396021
       OI    OPSSSW,MSWON                                               36402021
       BAL   RCS,RDUCOP            IS IT VALID DATA OPERAND             36408021
         BC    UNCOND,*+NX4        NO, NOT A DATA OP                    36414021
         MVC   PSTFLD(LX124),CURENT                                     36420021
         MVC   VARY2SV(LX124),CURENT                                    36426021
         MVC   STRCNT(LX2),N0                                           36432021
       BAL   RCS,DUPSS             CREATE NEW SS-DEFINING STRING        36438021
       B     SRCH29A               PROCESS NON-SUBSCR OP                36444021
* NON-SUBSCRIPTED OP                                                    36450021
SRCH29   MVC   PSTFLD(LX124),VARY2SV                                    36456021
SRCH29A  XC    DMAX(LX3),DMAX                                           36462021
       BAL   RCS,STLOOP            STORE 6 ENTITIES                     36468021
       DC    XL2'6'                STORE 6                              36474021
       LA    RW4,EVAL                                                   36480021
         LA    RW4,EVAL+NX3                                             36486021
       LA    RW4,PSTFLD                                                 36492021
       LA    RW4,ADDVRB                                                 36498021
       LA    RW4,NUMLT1                                                 36504021
       LA    RW4,VARY2SV                                                36510021
       MVI   VARY2SV,MDN                NO 31 HEADER HERE               36516021
       BAL   RCS,PUPIR             INCREMENT IR BY 1                    36522021
         MVI   IRINFO+NX2,XX05      MOVE CODE FOR STORE IN INRINFO      36528021
       BAL   RCS,STLOOP            STORE 6 ENTITIES                     36534021
       DC    XL2'6'                STORE 6                              36540021
       LA    RW4,IR                                                     36546021
       LA    RW4,IRINFO                                                 36552021
       LA    RW4,VARY2SV                                                36558021
       LA    RW4,PSTVRB                                                 36564021
       LA    RW4,IR                                                     36570021
       LA    RW4,PSTFLD                                                 36576021
       BAL   RCS,GENSTR            GENERATE STRING                      36582021
       NI    CORRSW,MSWOFF                                              36588021
       L    RIN,TRUPNT                                                  36594021
*   OK EXIT                                                             36600021
SRCH30 TM    SATOS,MSWON           WAS THIS ORIGINALLY SEARCHALL        36606021
       BO    SRCH31                AVOID LGN BEFORE IF                  36612021
       BAL    RCS,GENDAT           NO, WRITE TO OUTPUT                  36618021
       LA    RW2,SVGN1                                                  36624021
       TM    SRCHALSW,MSWON    CALL FROM SEARCHALL                      36630021
       BO    SRCH32                YES- AVOID IF CLAUSE                 36636021
SRCH31 BAL   RCS,STLOOP            STORE 7 ENTITIES                     36642021
       DC    XL2'7'                GREATER THAN MAXIMUM                 36648021
       LA    RW4,EVAL              NUMBER OCCURENCES                    36654021
         LA    RW4,EVAL+NX3         GO TO TEST WHEN                     36660021
       LA    RW4,INDVRY1           CONDITION-ELSE FALL                  36666021
       LA    RW4,IFGTIND                                                36672021
       LA    RW4,INDVRY1           STATEMENT.                           36678021
       LA    RW4,MAXSAVE                                                36684021
       LA    RW4,SVGN2                                                  36690021
       BAL   RCS,GENSTR            GENERATE STRING                      36696021
SRCH32 BAL   RCS,GENDAT            WRITE GO TO OUTPUT                   36702021
       LA    RW2,CBGO                                                   36708021
       BAL   RCS,GENDAT            WRITE LGN3 TO OUTPUT                 36714021
       LA    RW2,SVGN3                                                  36720021
       NI    SEARCHSW,MSWOFF                                            36726021
       TM    SATOS,MSWON           BAD SRCHLL                           36732021
       BO    SRCH33                YES-ISSUE LGN1-SET IND TO 1          36738021
       NI    GOSW,MSWOFF                                                36744021
       NI    SRCHALSW,MSWOFF                                            36750021
       OI    GENRED,MSWON                                               36756021
       NI    CONDSW,MSWOFF                                              36762021
       BAL   RCS,ZERPSH      PREVENT VARYGNS FROM BEING GENERATED       36768021
*                                  LATER                                36774021
       B     IDENT                 EXIT                                 36780021
ZERPSH   MVC   DSPUSH(LX2),N0                                           36786021
       L     RW1,APUSH       TIB                                        36792021
         L     RW1,DX0(RW1)   TAMM                                      36798021
         MVC   DX4(LX2,RW1),N0         ZERO TAMM DISPLACEMENT           36804021
       BR    RCS           RETURN                                       36810021
SRCH33 BAL   RCS,GENDAT            WRITE LGN1 TO OUTPUT                 36816021
       LA    RW2,SVGN1             NOW ISSUE LGN1                       36822021
       BAL   RCS,STLOOP            STORE 3 ENTITIES                     36828021
       DC    XL2'3'                STORE  3 ELEMENTS                    36834021
       LA    RW4,SETP2              SET                                 36840021
       LA    RW4,INDVRY1           INDNM1   TO                          36846021
       LA    RW4,NUMLT1                                                 36852021
       BAL   RCS,GENSTR            GENERATE STRING                      36858021
       NI    SATOS,MSWOFF                                               36864021
       B     SRCH32                WRITE GO-LGN3 TO OUTPUT              36870021
*                                                                       36876021
* ERRORS FOUND WHILE  PROCESSING  SEARCH                                36882021
*                                                                       36888021
SRCHERR1  NI SEARCHSW,MSWOFF                                            36894021
       LA    RA0,BCDDN             IDENTIFIER-1 INVALID                 36900021
       BC    UNCOND,IDGVUP         GIVE UP                              36906021
SRCHERR2  BAL  RCS,ERROR           WRITE MSG 4                          36912021
          LA   RW1,ELST04          USER-VARYING INVALID                 36918021
       TM    GOTTEN,MOP         IS IT A DATA OPERAND                    36924021
       BZ    SRCH6               NO-SAVE                                36930021
       BAL   RCS,GETNXT           DISCARD INVALID OP                    36936021
       B     SRCH6                 USE PH3'S VARYING                    36942021
SRCHERR3  TM  GOSW,MSWON           EXPECTING VERB TO FOLLOW COND        36948021
           BO  SRCH12              MAYBE IF GENERATED NXTSNT            36954021
SRCHE3A  DS    0H                                                 99998 36960021
         LA    RA0,BCDOR           PARM = OR                      99998 36966021
         TM    SRCHALSW,MSWON      FROM SEARCH ALL                99998 36972021
         BZ    SRCHE3B             NO                             99998 36978021
         LA    RA0,BCDBLNK         YES, RESET PARM EQ BLANK       99998 36984021
SRCHE3B  DS    0H                                                 99998 36990021
         BAL   RCS,ERROR           WRITE ERROR MSG                99998 36996021
           LA  RW1,ELST1E                                               37002021
         B     SRCHE5              GEN. EMSG ERSYM                54395 37008021
SRCHERR4     BAL RCS,ERROR         EXPECTING WHEN (1ST)                 37014021
       LA    RW1,ELST68                                                 37020021
SRCHE4 BAL   RCS,ISEND             VERB, LHN OR BREAK                   37026021
       B     SRCHE5                NOT A VERB                           37032021
       B     SRCH19                VERB-GIVE UP SINCE AT END            37038021
*                                  VERBS HAVE BEEN PROCESSED            37044021
*                                  AND 1ST WHEN NEVER APPEARED          37050021
SRCHE5   CLC   GOTTEN(LX2),CBWHEN                                       37056021
       BE    SRCH12A               YES, WHEN                            37062021
       BAL   RCS,GETNXT            GET NEXT INPUT                       37068021
       BC    UNCOND,SRCHE4         SCAN TILL WHEN OR NEXT VERB          37074021
*=1                  SEARCHALL                                          37080021
*                                                                       37086021
*   SEARCH ALL                                                          37092021
*                                                                       37098021
* STRINGS PRODUCED-                                                     37104021
* SOURCE- SEARCHALL ID1  CT.OF KEYS KEYS INDNM1   MAX-OCCUR             37110021
*         MIN-OCCUR.; AT END GO PN1 ; WHEN KEY1=VALUE GO PN2            37116021
*                                                                       37122021
* OUTPUT   GO RGN1                                                      37128021
*LGN0      GO PN1                                                       37134021
*         LGN2                                                          37140021
*         WHENCOND- WHEN SIGNAL     ID1   MAX OCCUR  RGN0               37146021
*                  EVAL KEY1                                            37152021
*                  EQU  VALUE KEY1                                      37158021
*                  ENDWHEN                                              37164021
*          GO PN2                                                       37170021
*          LGN1-  GO RGN2                                               37176021
*                                                                       37182021
* ERROR PROCESSING-                                                     37188021
*        IF  ID1 INVALID,SKIP STATEMENT.                                37194021
*        IF  MORE THAN 12 KEYS,WRITE MSG, IGNORE-EXCESS.                37200021
*        IF  ERROR IN WHEN CONDITION,WRITE MSG, STOP SCAN.              37206021
*        IF  KEY FLOATING POINT  OR IF  KEY-N  TESTED BEFORE            37212021
*        KEY- N - 1, MSG AND CHANGE TO SEARCH FORMAT-1.                 37218021
*                                                                       37224021
* ROUTINES CALLED:GETNXT,GETALL,ERROR,STLOOP,GENDAT,GNARTH,OKCOMP O     37230021
*                 IF RTN.,SEARCH TO PROCESS AT END AND IMP. STATEMN     37236021
*                 AFTER CONDITIONS,FORMLA,GETMOD,DECMAX                 37242021
*                                                                       37248021
* SWITCHES:       FLKEY- IF KEY FOUND TO BE FLOAT PT                    37254021
*                 NOKEY- IF TERM OF WHEN IS NOT KEY                     37260021
*                 KEYFND- ............... IS A KEY                      37266021
*                 SRCHALSW-TO SHOW IN SEARCH ALL                        37272021
*                 LV88SW-FOR COND NM                                    37278021
*   SATOS-...................SEARCHALL HAS BEEN (WILL BE) CHANGED       37284021
*     TO SEARCH                                                         37290021
*      SPSALL- GETNXT AND GNARTH RECOGNIZE CALL FROM SEARCHALL          37296021
*                                                                       37302021
* NOTES- IF SEARCH ALL CHANGED TO SEARCH- SET INDNM TO 1                37308021
*     IS GENERATED IN SEARCH ROUTINE TO GIVE INDNM1 AN INITIAL VALU     37314021
*                                                                       37320021
       USING *,RVRB                                                     37326021
SRCHAL EQU   *                                                          37332021
       LA    RA0,BCDDN                                                  37338021
       CLI   GOTTEN,MDN            IS  ID1 VALID                        37344021
       BNE   IDGVUP                NO-GIVE UP                           37350021
       BAL   RCS,GETALL     SAVE ID1 TO PASS TO PH5                     37356021
       LA    RW2,SVSRCHT                                                37362021
*      INITIALIZE                                                       37368021
*                                                                       37374021
       BAL   RCS,PZSTRT            REINITIALIZE TAMER TABLES            37380021
       LA    RW1,AKEYTB                                                 37386021
       NI    FLKEY,MSWOFF                                               37392021
       NI    NOKEY,MSWOFF                                               37398021
       NI    KEYFND,MSWOFF                                              37404021
       NI    WHENSW,MSWOFF                                              37410021
       NI    TWOVRY,MSWOFF                                              37416021
       NI    ATNDFND,MSWOFF                                             37422021
       NI    SATOS,MSWOFF                                               37428021
       NI    SPSALL,MSWOFF                                              37434021
       NI    ZERFOUN,MSWOFF                                             37440021
       BAL   RCS,IFSRCH1      BRANCH TO SAVE GN'S                 5961  37446021
       BAL   RCS,ISTRUV           SEARCH-ALL  IS COND ALLOWED           37452021
SRCHA1 BAL   RCS,GETNXT            GET CT. OF # KEYS                    37458021
         CLI   GOTTEN,XXBB                                              37464021
       BNE   IDERR                 NOT NUMERIC LITERAL - ERROR          37470021
         MVC   KEYNO(LX2),GOTTEN+NX1  SAVE FOR LATER                    37476021
       SR    RW4,RW4                                                    37482021
       LH    RW4,KEYNO           NO OF KEYS TO BE INSERTED              37488021
GETKEY BAL   RCS,GETNXT            GET KEY                              37494021
       SR    RW3,RW3                                                    37500021
         IC    RW3,GOTTEN+NX1       CT FOR KEY                          37506021
       BCTR   RW3,RA0              GET CT OF KEYS                       37512021
       AR    RW3,RIN               RW3 PTS TO DICT. PTR. FOR KEY        37518021
         MVC   KEYSAV(LX3),DX0(RW3)                                     37524021
       L    RW1,AKEYTB                                                  37530021
       BAL   RCS,PNSRTF            INSERT KEY WITH FLAG BYTE 0          37536021
       LA    RW4,KEYSAV                                                 37542021
         MVZ   FLTST(LX1),GOTTEN+NX3   MAKE SURE KEY NOT FLOATING PT    37548021
         CLI   FLTST,XX60           OR STERLING-CHECK MONOR CODES       37554021
       BE    SRCHAR2A               INVALID FOR ARCHAL                  37560021
         CLI   FLTST,XXA0          FLOATING POINT?                      37566021
       BE    SRCHAR2A               INVALID FOR ARCHAL                  37572021
         NI    FLTST,XXB0          SEE IF EXT FL OR STERL               37578021
         CLI   FLTST,XX90          IS IT ONE OF THESE                   37584021
       BE    SRCHAR2A               INVALID FOR ARCHAL                  37590021
       BCT   RW4,GETKEY            GET NEXT KEY                         37596021
* AT THIS POINT KEY TABLE HAS BEEN BUILT                                37602021
AFTKY  BAL   RCS,GETNXT            GET NEXT INPUT                       37608021
         CLI   GOTTEN,XX36          IS IT INDNM OR SUPERFLUOUS KEY      37614021
       BNE   AFTKY                 MSG HAS BEEN WRITTEN                 37620021
       BAL   RCS,GETALL            SAVE INDNM                           37626021
       LA    RW2,INDVRY1                                                37632021
       BAL   RCS,GETNXT            GET NEXT INPUT                       37638021
       BAL   RCS,GETALL            SAVE INDVRY1                         37644021
       LA    RW2,MAXSAVE                                                37650021
       BAL   RCS,GETNXT            GET NEXT INPUT                       37656021
*  'AT END' OR  'WHEN' SHOULD FOLLOW                                    37662021
       TM    FLKEY,MSWON           CHANGING TO SEARCH                   37668021
        BO     *+NX8               KEY IS FLOATING POINT                37674021
       OI    SRCHALSW,MSWON        LET SEARCH PROCESS 'AT END'          37680021
       OI    SEARCHSW,MSWON                                             37686021
       L     RVRB,ASRCH                                                 37692021
       USING SEARCH,RVRB                                                37698021
       BC    UNCOND,SRCH6          GO TO STORE LGN OF ORD. SEARCH       37704021
       USING SRCHAL,RVRB                                                37710021
*                                                                       37716021
*  SEARCH RETURNS HERE AFTER HAVING PROCESSED AT END AND AFTER          37722021
*  HAVING FOUND WHEN-RIN PTS TO NEXT AFTER WHEN                         37728021
WHEN0  EQU   *                                                          37734021
         XC    SSKYSV(LX1),SSKYSV  INIT SS FOR KEY1 TO 0                37740021
       NI    SRCHKEY,MSWOFF                                             37746021
       OI    SPSALL,MSWON                                               37752021
WHN1   CLI   GOTTEN,MDN       IS IT A DATA MAME                         37758021
       BNE   WHN2               NO-CANNOT BE KEY                        37764021
         TM    GOTTEN+NX7,XX20      IS DATA NAME A KEY                  37770021
       BO    VALKEY                SEE IF TESTED IN ORDER OF            37776021
*                                  SIGNIFICANCE AND IF KEY IS           37782021
*                                  1ST KEY IN THIS CONDITION            37788021
WHN2   TM    NOKEY,MSWON         WAS NONKEY FOUND LAST?                 37794021
       BO    SRCHAR3               YES-ERROR-KEY MUST BE SUBJECT        37800021
*                                  OR OBJECT OF CONDITION               37806021
*    INITIALIZE TABLES AND SWITCHES BEFORE CALLING FORMLA               37812021
         XC    DMAX(LX3),DMAX                                           37818021
       BAL   RCS,PZSTRT            INITIALIZE TABLES FOR FORMLA         37824021
       LA    RW2,APNOUN                                                 37830021
       LA    RW1,APSGNT                                                 37836021
         XC    PRNLEV(LX2),PRNLEV                                       37842021
         XC    PNOUCT(LX2),PNOUCT                                       37848021
         XC    DMAXSW(LX2),DMAXSW                                       37854021
         MVI   EVAL+NX2,XX02                                            37860021
       BAL   RCS,FORMLA            GO TO FORMULA                        37866021
       B     SRCHAR3               INVALID                              37872021
       B     WHEN1B                NON-NUM DATA NAME                    37878021
       LA    RW2,PRSULT            VALID FORMULA                        37884021
WHN1AA BAL   RCS,COUNT             GET THE COUNT OF BYTES               37890021
*                                                                       37896021
       LA    RW5,PLEFT                                                  37902021
*                                                                       37908021
       LH    RW3,BYTES                                                  37914021
       EX    RW3,WHENMV                                                 37920021
       OI    NOKEY,MSWON                                                37926021
       LR    RW1,RW5                                                    37932021
       BAL   RCS,GETMOD            GET MODE                             37938021
         MVC   MOPLNG-NX3(LX1,RW5),DMAX                                 37944021
         MVC   MOPLNG-NX2(LX2,RW5),MODE                                 37950021
       B     WHEN1                 PLEFT/PRIGHT HAS BEEN PROCSD         37956021
WHENMV   MVC   PLEFT(LX1),DX0(RW2)                                      37962021
WHEN1B LR    RW2,RIN                                                    37968021
       BAL   RCS,GETNXT            GET NEXT INPUT                       37974021
       BC    UNCOND,WHN1AA         GET BYTE COUNT                       37980021
*                                                                       37986021
*  KEY FOUND                                                            37992021
*                                                                       37998021
VALKEY TM    KEYFND,MSWON          WAS 1ST TERM A KEY                   38004021
       BO    SRCHAR3               ERROR                                38010021
       SR    RW3,RW3                                                    38016021
         IC    RW3,GOTTEN+NX1       SEARCH TABLE FOR KEY                38022021
       BCTR   RW3,RA0              KEY FOUND                            38028021
       AR    RW3,RIN               RW3 PTS TO DICT PTR THIS KEY         38034021
       L    RW1,AKEYTB                                                  38040021
         L     RW1,DX0(RW1)                                             38046021
         L     RW2,DX0(RW1)         RW2 PTS TO START OF TABLE           38052021
       LA    RW2,DX0(RW2)          CLEAR OUT FIRST BYTE                 38058021
       ST    RW2,TABADR            SAVE TO SEE WHEN KEY1 FOUND          38064021
       LH      RW4,DX4(RW1)        RW4 POINTS TO END                    38070021
       AR    RW4,RW2                                                    38076021
SRCHVAL  CLC   DX0(LX3,RW2),DX0(RW3)                                    38082021
       BNE   VALKY1                IS NEXT KEY VALID                    38088021
VALKY0   TM    DX3(RW2),MSWON       WAS IT USED BEFORE                  38094021
       BO    SRCHAR2               YES, ERROR                           38100021
         OI    DX3(RW2),MSWON                                           38106021
       BAL   RCS,GETALL            NO, SAVE IT                          38112021
       LA    RW2,PRIGHT                                                 38118021
       BAL   RCS,DECMAX            UPDATE DMAX FIELD                    38124021
       OI    KEYFND,MSWON                                               38130021
       L     RW6,TABADR                                                 38136021
         CLC   DX0(LX3,RW2),DX0(RW6) IS THIS FIRST KEY                  38142021
       BNE    NOTKY1              NO                                    38148021
       OI    KEY1,MSWON        THIS SWITCH HAS SPECIAL MEANING FOR      38154021
*                             SUBSCRIPTING ROUTINE                      38160021
RDUKEY BAL   RCS,RDUCOP        SEE IF VALID OP-REDUCE SS                38166021
       B     SRCHAR3             NO GOOD- ERROR EXIT                    38172021
       NI    KEY1,MSWOFF           1ST ALREADY PROCESSED                38178021
       NI    SRCHKEY,MSWOFF         OFF TILL NEXT KEY FOUND             38184021
       LA    RW5,PRIGHT                                                 38190021
         MVC   MOPLNG-NX3(LX1,RW5),DCURR                                38196021
         MVC   MOPLNG-NX2(LX2,RW5),MODE                                 38202021
       BAL   RCS,GETNXT            GET NEXT INPUT                       38208021
       B     WHEN1                 PROCESS IT                           38214021
NOTKY1 OI    SRCHKEY,MSWON       SPEC MEANING FOR SUBSCR                38220021
*                        SUBSCRIPTS CHECKED FOR BUT NOT PUT IN TABLE    38226021
       B     RDUKEY                SEE IF VALID OPERAND                 38232021
VALKY1   LA    RW2,DX4(RW2)         PT  RW2 TO NEXT                     38238021
       CR    RW2,RW4                                                    38244021
       BE    SRCHAR3               ERROR EXIT                           38250021
       B     SRCHVAL               OK, CHECK IF VALID KEY               38256021
*                                                                       38262021
* AT THIS POINT, PLEFT  AND/OR PRIGHT  HAVE BEEN PROCESSED              38268021
WHEN1    CLC   GOTTEN(LX2),CBEQSN                                       38274021
       BNE   WHEN2                 NOT AN EQUAL SIGN                    38280021
       BAL   RCS,GETNXT            YES, GET NEXT INPUT                  38286021
         CLC   GOTTEN(LX2),CBTO                                         38292021
       BNE   WHN1                  NOT A 'TO'                           38298021
       BAL   RCS,GETNXT            YES, GET NEXT INPUT                  38304021
       BC    UNCOND,WHN1           CHECK IF DATA NAME                   38310021
WHEN2  TM    NOKEY,MSWON           BOTH NOKEY AND KEYFND SHOULD         38316021
       BZ    SRCHAR3               BE ON NOW IF CORRECT                 38322021
       TM    KEYFND,MSWON                                               38328021
       BZ    SRCHAR3               ERROR                                38334021
       NI    KEYFND,MSWOFF                                              38340021
       NI    NOKEY,MSWOFF                                               38346021
       BAL   RCS,STLOOP            STORE EQU,PLEFT,PRIGHT,INFO-HD       38352021
       DC    XL2'4'                STORE 4                              38358021
       LA    RW4,WHENEQU                                                38364021
       LA    RW4,PLEFT                                                  38370021
       LA    RW4,PRIGHT                                                 38376021
         LA    RW4,EVAL+NX3                                             38382021
         XC    DMAX(LX1),DMAX                                           38388021
       TM    LV88SW,MSWON                                               38394021
       BO    AFTCM1                COND NM FOUND - OK                   38400021
       L     RVRB,AIF                                                   38406021
       USING IF,RVRB                                                    38412021
       B     OKREL2                CHECK THE GROUP ITEM                 38418021
       USING SRCHAL,RVRB                                                38424021
AFTCOM B     SRCHAR3               INVALID COMPARISON                   38430021
AFTCM1 NI    LV88SW,MSWOFF         OK-STORE IN STRING                   38436021
         CLC   GOTTEN(LX2),CBAND                                        38442021
        BNE    *+NX12              NOT AN 'AND'                         38448021
       BAL   RCS,GETNXT            YES, GET NEXT INPUT                  38454021
       B     WHN1           836                                         38460021
       TM    SKIPSW,MSWON         SHOULD STRING B E GENR                38466021
       BO    SRCHAR3             NO-ERRORMSG AND EXIT                   38472021
       LH    RW6,KEYNO             GET NO. OF KEYS                      38478021
       L    RW1,AKEYTB             SCAN KEYTBL TO SEE IF ANY KEYS       38484021
         L     RW1,DX0(RW1)         NOT NAMED IN WHEN CONDITION         38490021
         L     RW1,DX0(RW1)         SHOULD HAVE BEEN. RW1 HAS @TBL      38496021
KEYCK    CLC   DX3(LX1,RW1),N0       WAS THIS KEY FOUND                 38502021
       BE    ZERFND                NO- (FLAG BIT OFF)                   38508021
       TM    ZERFOUN,MSWON         YES-BUT WERE ALL PREV KEYS FOUND     38514021
       BO    SRCHAR2               NO- ERROR                            38520021
KEYCK1   LA    RW1,DX4(RW1)         YES-PT RW1 TO NEXT ENTRY            38526021
       BCT    RW6,KEYCK            GO CHECK NEXT KEY                    38532021
       BC    UNCOND,AOK            NO ERRORS                            38538021
ZERFND OI    ZERFOUN,MSWON         THIS KEY WAS NOT TESTED              38544021
       B    KEYCK1                 SEE IF NEXT WAS                      38550021
AOK      CLI   SSKYSV,XX04                                              38556021
       BL    AFTCMZ                KEY1 SS/INDEX TO BE PASSED-NO        38562021
         MVC   WHENVB+NX2(LX1),SSKYSV MOVE IN ELEM CT                   38568021
       B     AFTCMB                WRITE DATA                           38574021
AFTCMZ   MVI   WHENVB+NX2,XX03                                          38580021
AFTCMB BAL   RCS,GENDAT            GENR BEGINNING WHEN SIGNAL           38586021
       LA    RW2,WHENVB                                                 38592021
       BAL   RCS,GENDAT            WRITE ID1                            38598021
       LA    RW2,SVSRCHT                                                38604021
       BAL   RCS,GENDAT            WRITE DMAX                           38610021
       LA    RW2,MAXSAVE                                                38616021
       BAL   RCS,GENDAT            WRITE GN                             38622021
       LA    RW2,SVGN2             GNREF FOR GN POINTING TO ATEND       38628021
         CLI   SSKYSV,XX04   KEY1 SS OR INDEX TO BE PASSED              38634021
       BL    AFTCMA                NO                                   38640021
       BAL   RCS,GENDAT            YES-GENR HIGHEST LEVEL               38646021
       LA    RW2,OPRND1                                                 38652021
         CLI   SSKYSV,XX04          DO WE NEED ANOTHER ONE              38658021
       BE    AFTCMA                NO                                   38664021
       BAL    RCS,GENDAT           WRITE OP2                            38670021
       LA    RW2,OPRND2            YES- GENR IT                         38676021
AFTCMA BAL   RCS,GNARTH            GENERATE ARITHMETIC STRING           38682021
       BAL   RCS,GENDAT            WRITE 'END WHEN'                     38688021
       LA    RW2,ENDWHEN                                                38694021
       BAL   RCS,GENDAT            AND LOWEST LEVEL SUBSCRIPT/INDEX     38700021
       LA    RW2,SS1SV                                                  38706021
       NI    SPSALL,MSWOFF                                              38712021
       CLI   GOTTEN,MVERB                                               38718021
       BNE   AFTCM2                NOT A VERB                           38724021
AFTCM0 L     RVRB,ASRCH                                                 38730021
       USING SEARCH,RVRB                                                38736021
       BC    UNCOND,SRCH10         CONTROL TO IMPERATIVE STMNT          38742021
       USING SRCHAL,RVRB                                                38748021
AFTCM2 BAL   RCS,ISNXTS            CHK IF 'NXT SENTENCE' FOLLOWS        38754021
*                                                                       38760021
       B     AFTCM3                NO                                   38766021
       BAL   RCS,GENDAT            GENR GO NEXT                         38772021
       LA    RW2,CBGO                     SENT                          38778021
       BAL   RCS,NEWNXT            TEST NEXT SENTENCE                   38784021
         MVC   RGN+NX1(LX2),NXTSNT                                      38790021
       BAL   RCS,GENDAT            WRITE GN TO FILE                     38796021
       LA    RW2,RGN                                                    38802021
       OI    GOSW,MSWON                                                 38808021
       B     AFTCM0                LOOK FOR VERB                        38814021
AFTCM3 L     RVRB,ASRCH                                                 38820021
       USING SEARCH,RVRB                                                38826021
       BC    UNCOND,SRCHE3A        PROCESS ERROR                        38832021
       USING SRCHAL,RVRB                                                38838021
SRCHAR2A BAL RCS,ERROR             ERROR                                38844021
       LA    RW1,ELST6D       W-LEVEL                                   38850021
       OI    FLKEY,MSWON                                                38856021
       OI    SATOS,MSWON           BAD SEARCHALL CHANGED TO SEARCH      38862021
       B     AFTKY                 GO TO GET NEXT INPUT                 38868021
SRCHAR2 BAL   RCS,ERROR            ERROR                                38874021
       LA    RW1,ELST6E            ALL PREC. EKYS NOT TESTED            38880021
       BC    UNCOND,SRCHAR4        ERROR EXIT TO SEARCH                 38886021
SRCHAR3 BAL  RCS,ERROR             ERROR                                38892021
       LA    RW1,ELST6F                                                 38898021
SRCHAR4 NI    SPSALL,MSWOFF                                             38904021
       NI    KEY1,MSWOFF                                                38910021
       NI    SRCHKEY,MSWOFF                                             38916021
       NI    KEY10,MSWOFF                                               38922021
       NI    SKIPSW,MSWOFF        TURN OFF SKIPSW                       38928021
       L     RVRB,ASRCH            ** BRANCH SRCH19                     38934021
       USING SEARCH,RVRB                                                38940021
       B     SRCH19                **                                   38946021
*=1             SET                                                     38952021
*                                                                       38958021
*       SET                                                             38964021
*                                                                       38970021
*  SOURCE-  SET INDNM1, INDNM2, INDNM3 TO ID2.                          38976021
*           SET     IDNM1 UP (DOWN) BY ID2.                             38982021
*                                                                       38988021
*   OUTPUT-                                                             38994021
*           SET INDNM1 ID2   SET INDNM2 ID2  SET INDNM3 ID2.            39000021
*            SETUP INDNM1 ID2.                                          39006021
*           SETDWN INDNM1 ID2.                                          39012021
*                                                                       39018021
* ROUTINES CALLED- GETNXT,GETALL,ERROR,RDUCOP,ISINTG,GENSTR             39024021
*                                                                       39030021
* ERROR PROCESSING- IF OP1 INCOMPATIBLE WITH OP2, MSG,                  39036021
*                   DISCARD OP1, SEEK NEW OP1.                          39042021
*                   IF OP2 INVALID, GIVE UP.                            39048021
*                   IF BY OMITTED, WARN BUT PROCESS.                    39054021
*                                                                       39060021
* NOTES- FORMAT2- OP1 INDNM AND OP2 INDEX DATA ITEM- WARN-PROCESS.      39066021
       USING *,RVRB                                                     39072021
SET    EQU *                                                            39078021
         OI    SETSW,MSWON         SET SETSW TO INDICATE FROM SET 58940 39084021
       NI    SETOO,MSWOFF                                               39090021
         NI    RW5SW,MSWOFF        RESET SWITCH                         39096021
       NI    ONESET,MSWOFF                                              39102021
         XC    LEFTDP(LX2),LEFTDP                                       39108021
         XC    SETSVD(LX2),SETSVD   INITIALIZE SAVED DISP IN SETTBL     39114021
         XC    LEFTSS(LX2),LEFTSS                                       39120021
       BAL   RCS,PZSTRT          INITIALIZE SETTBL                      39126021
       LA    RW1,ASETBL                                                 39132021
*                                                                       39138021
*                                                                       39144021
GETSET BAL   RCS,ISEND           SCAN FOR TO, UP, DOWN                  39150021
       B     FNDOUT        NO- SEE IF ONE OF THE KEY WORDS              39156021
       B     SETERA           ENDWORD FOUND BEFORE KEYWORD-ERROR        39162021
FNDOUT EQU   *                                                          39168021
         CLC   GOTTEN(LX2),CBTO                                         39174021
       BE    SETTO          FORMAT 1 ESTABLISHED                        39180021
         CLC   GOTTEN(LX2),CBUP                                         39186021
       BE    UPSET                 FORMAT 2 ESTABLISHED - UP            39192021
         CLC   GOTTEN(LX2),CBDOWN                                       39198021
       BE    STDOWN                'DOWN' FOUND                         39204021
         TM    GOTTEN,X'C0'        OTHER THAN IDENTIFIERS         P0571 39210021
         BNO   FNDOUTA             IT IS POSSIBLE IDENTIFIER      P0571 39216021
         LA    RW2,ELST03          IF NOT SET ERROR MES           P0571 39222021
         B     SETERC              GENERATE ERROR MESSAGE         P0571 39228021
FNDOUTA  DS    0H                                                 P0571 39234021
       L     RW1,ASETBL            SAVE OPERAND                         39240021
         LA    RW2,DX0(RIN)      GET BYTE COUNT FOR THIS ELEMENT        39246021
       BAL   RCS,COUNT             HOW MANY BYTES IN OP                 39252021
         MVC   DX0(LX1,RW1),BYTES+NX1       GIVE INSERT BYTE COUNT      39258021
       BAL   RCS,PNSRTF            INSERT FIXED-LENGTH IN TIB           39264021
         LA    RW4,DX0(RIN)         SETTBL                              39270021
       BAL   RCS,GETNXT           SEE IF NEXT A KEY WORD                39276021
       B     GETSET             TEST FOR KWEY WORD                      39282021
STDOWN LA    RW4,SETDWN                                                 39288021
FNDOP0 BAL   RCS,STOR45         STORE VERB IN STRING                    39294021
         MVC   LEFTDP(LX2),DSPSTR   SAVE TO REUSE IF SEVERAL OP1'S      39300021
       BAL   RCS,GETNXT            GET NEXT INPUT                       39306021
       TM    SETOO,MSWON      FORMAT 1                                  39312021
       BO    FNDOP1   SKIP 'BY' CHECK                                   39318021
         CLC   GOTTEN(LX2),CBBY                                         39324021
       BNE    BYOMIT               NOT 'BY'                             39330021
       BAL   RCS,GETNXT         DISCARD BY- GET OP2                     39336021
FNDOP1 BAL   RCS,GETALL         THIS IS OP2                             39342021
       LA    RW2,PRIGHT        SAVE IT                                  39348021
       BAL   RCS,RDUCOP            IS THIS VALID OP2                    39354021
       B     IFIND           SEE IF INDEXNAME INDEX DATAITEM            39360021
       BAL   RCS,ISINT2      SEE IF INTEGER                             39366021
       B     SETERA       INVALID OP2                                   39372021
*                            RETURNS FROM INTERGER CHECK          44289 39378021
         CLI   GOTTEN,MSS          CHECK LAST INPUT WAS SUB DATA  44289 39384021
         BNE   FNDOP1A             NO  BRANCH                     44289 39390021
         LR    RW2,RIN             YES  RW2 POINTS OUTPUT SUB DATA44289 39396021
         BAL   RCS,COUNT             GET LENGTH OF SUB DATA       44289 39402021
         LH    RW2,BYTES           PICK UP LENGTH OF SUB DATA     44289 39408021
         BCTR  RW2,RA0             DECREMENT BY 1                 44289 39414021
         EX    RW2,SETMOVE         MOVE SUBDATA NAME PRIGHT       44289 39420021
FNDOP1A  DS    0H                                                 44289 39426021
       TM    MODE,MLITBT                                                39432021
       BZ    FNDOP3           IS OP2 A LITERAL                    4189  39438021
       SR    RW3,RW3                                                    39444021
         IC    RW3,DX1(RIN)   SEE IF POSITIVE LITERAL                   39450021
       SH    RW3,N3                                                     39456021
       EX   RW3,ISPOS                                                   39462021
       BC   NOTLO,SETERA           NOT A POS LITERAL - ERROR            39468021
       BAL   RCS,GETNXT            GET NEXT INPUT                       39474021
FNDOP2   MVC   LEFTSS(LX2),DSPSBS                                       39480021
         MVC   MODER(LX2),MODE     SAVE MODE OF OP2                     39486021
       L     RW5,TRUPNT             SAVE TRUPNT                         39492021
         OI    RW5SW,MSWON         SET SWITCH ON                        39498021
       L     RW1,ASETBL            ADDR TIB                             39504021
         L     RW1,DX0(RW1)         TAMM                                39510021
         L     RIN,DX0(RW1)         POINT RIN TO START OF TABLE         39516021
       ST    RIN,TRUPNT          POINT TRUPNT TO START SETTBL           39522021
         LH    RW4,DX4(RW1)         DISPLACEMENT                        39528021
       AR    RW4,RIN               POINT RW4 TO END OF TABLE            39534021
       NI    NEXTIN,MSWOFF                                              39540021
       OI    SETRIN,MSWON     SET SW FOR GETNXT                         39546021
CKOP0    TM    SETRIN,XXFF         END OF TABLE                   45036 39552021
         BNO   CKOP1               NO, IT IS NOT                  45036 39558021
       ST    RW5,TRUPNT             YES-RESTORE REAL TRUPNT             39564021
         XC    SETRIN(LX1),SETRIN                                       39570021
       L     RIN,TRUPNT                                                 39576021
         NI    SETSW,MSWOFF        TURN OFF AT END OF SET VERB    58940 39582021
       BC    UNCOND,IDENT          EXIT                                 39588021
FNDOP3 DS    0H                                                   4189  39594021
       BAL   RCS,GETNXT       GET NEXT ELEMENT                    4189  39600021
       B     FNDOP2           BACK TO MAIN LINE                   4189  39606021
CKOP1  CLI   GOTTEN,MINDNM        IS 1ST OP AN INDEXNAME                39612021
       BE    OPSOK          YES- OK ALL CASES                           39618021
       TM    SETOO,MSWON      SET 'TO' OPTION                           39624021
       BZ    SETER1     NO-ERROR- ONLY SET 'TO' CAN HAVE                39630021
*                        OP1 OTHER THAN INDEXNAME                       39636021
       BAL   RCS,RDUCOP            IS IT VALID DATA NAME                39642021
       B     IFIND1                NOT A DATA-OP                        39648021
       BAL   RCS,ISINT2            YES-OK-CHECK IF INTEGER              39654021
       B     SETERR         OP1 NOT INDEX OR NUMERIC-DISCARD            39660021
       TM    MODE,MLITBT                                                39666021
       BO    SETERR        OP1 CANNOT BE LITERAL                        39672021
       CLI   PRIGHT,MINDNM       OP1 NUMERIC- IS OP2 INDEXNAME          39678021
       BE    OPSOK      YES-OK                                          39684021
*      INCOMPATIBLE                                                     39690021
SETERR BAL   RCS,ERROR             OP1 AND OP2 NOT COMPATIBLE           39696021
       LA    RW1,ELST12        DISCARD OP1,SEEK NEW OP1                 39702021
       BAL   RCS,GETNXT            GET NEXT INPUT                       39708021
       BC    UNCOND,CKOP0         SEEK NEXT OP                          39714021
OPSOK  BAL   RCS,STLOOP            STORE 2 ENTITIES                     39720021
       DC    XL2'2'                STORE  2 ELEMENTS                    39726021
         LA    RW4,DX0(RIN)                                             39732021
       LA    RW4,PRIGHT         OP2                                     39738021
       BAL   RCS,GENSTR            GENERATE STRING                      39744021
       OI    ONESET,MSWON       AT LEAST ONE SET GENERATED              39750021
       L    RW2,ASTRNG                                                  39756021
         L     RW2,DX0(RW2)                                             39762021
         MVC   DX4(LX2,RW2),LEFTDP                                      39768021
         MVC   DSPSTR(LX2),LEFTDP                                       39774021
       L     RW2,ADFSBS                                                 39780021
         L     RW2,DX0(RW2)                                             39786021
         MVC   DX4(LX2,RW2),LEFTSS                                      39792021
         MVC   DSPSBS(LX2),LEFTSS                                       39798021
       BAL   RCS,GETNXT            GET NEXT INPUT                       39804021
       BC    UNCOND,CKOP0          SEE IF TABLE EXHAUSTED               39810021
BYOMIT EQU     *                                                   7875 39816021
       LA      RA0,CBBY                                            7875 39822021
       BAL     RCS,ERROR           'BY' MISSING                    7875 39828021
       LA    RW1,ELST07                                                 39834021
       B     FNDOP1                FIND 2ND OPERAND                     39840021
UPSET  LA    RW4,SETUP                                                  39846021
       B    FNDOP0                 GO TO STORE 'UP'                     39852021
SETTO  OI    SETOO,MSWON                                                39858021
       LA    RW4,SETP2                                                  39864021
       B     FNDOP0                GO TO STORE 'TO'                     39870021
IFIND  TM    SETOO,MSWON     OPTION 1                                   39876021
       BZ    IFIND0   NO- CHECK ELSEWHERE                               39882021
       CLI   GOTTEN,MINDNM                                              39888021
       BE    FNDOP2A       OK                                           39894021
         CLC   MODE(LX2),INDNMD INDEX DATA ITEM                         39900021
         BNE SETERA                NO, NOT INDEX DATA ITEM              39906021
         TM    DX3(RIN),DX4        SUBSCRIPTED ITEM                     39912021
         BZ    FNDOP2A             NO, BRANCH OUT                       39918021
         BAL   RCS,SUBSCR          YES,  IT IS SUBSCRIPTED I.D.I.       39924021
         LR    RW2,RIN             SET ADDR OF INDEX-ITEM               39930021
         BAL   RCS,COUNT           GET LENGTH OF ITEM                   39936021
         LH    RW2,BYTES           PIC UP LENGTH                        39942021
         BCTR  RW2,RA0             DECREMENT BY ONE                     39948021
         EX    RW2,SETMOVE         MOVE TEXT                            39954021
         B     FNDOP2A             VALID OP2                            39960021
SETERA TM    SETOO,MSWON          'TO' OPTION                           39966021
       BO    SETERB            ISSUE ELST66                             39972021
       LA    RW2,ELST65          FORMAT 2                               39978021
SETERC BAL   RCS,ERROR             WRITE ERROR MSG                      39984021
         LA    RW1,DX0(RW2)                                             39990021
         TM    RW5SW,MSWON         RESET BUFFER                         39996021
         BZ    SETERC1             NO                                   40002021
         NI    RW5SW,MSWOFF        TURN SWITCH OFF                      40008021
         ST    RW5,TRUPNT          RESTORE BUFFER PTR                   40014021
SETERC1  DS    0H                                                       40020021
         NI    SETRIN,MSWOFF       TURN OFF SET TABLE SWITCH            40026021
       BC    UNCOND,IDERR          EXIT - ID ERROR                      40032021
SETERB LA    RW2,ELST66           FORMAT 1 MSG                          40038021
       BC    UNCOND,SETERC         GO WRITE MSG AND EXIT                40044021
SETER1 TM    GOTTEN,MDN                                                 40050021
       BO    SETERR                NOT COMPATIBLE                       40056021
       BC    UNCOND,SETERA         GIVE UP                              40062021
IFIND0   CLC   MODE(LX2),INDNMD                                         40068021
       BNE SETERA      INVALID OP2                                      40074021
       BAL   RCS,ERROR             ERROR                                40080021
       LA    RW1,ELST70                                                 40086021
       B     FNDOP2A               GET NEXT INPUT                       40092021
IFIND1   CLC   MODE(LX2),INDNMD    CHECKS OP1- KNOW NOT INDEXNAME       40098021
       BNE    SETER1     INVALID                                        40104021
       TM    MODER,MNUMBT         IS OP2 NUMERIC                        40110021
       BO    SETERR             INCOMPATIBLE                            40116021
         TM    DX3(RIN),DX4        SUBSCRIPTED INDEX ITEM               40122021
         BZ    OPSOK               NO, IT IS NOT SUBSCRIPTED IDEX       40128021
         BAL   RCS,SUBSCR          YES, SUBSCRIPTED INDEX ITEM          40134021
       B     OPSOK            OK                                        40140021
FNDOP2A BAL   RCS,GETNXT          RIN SHOULD POINT TO EOS               40146021
       B     FNDOP2                MODE OF OP2                          40152021
SETMOVE  MVC   PRIGHT(R0),R0(RIN)                                 44289 40158021
ISPOS    CP    PAKZER(LX1),DX4(LX1,RIN)                                 40164021
IKF40D CSECT                                                            40170021
*=1    USE     VERB                                                     40176021
*******************************************************************     40182021
*                                                                       40188021
*                                                                       40194021
*                                 U S E                                 40200021
*                                                                       40206021
*                                                                       40212021
*** STRINGS PRODUCED                                                    40218021
*      VERB CONSTITUTES ENTIRE STRING.                                  40224021
*      THERE ARE 4 DIFFERENT USE VERBS FOR OUTPUT -- USE-LABELS         40230021
*                                                    USE-RANDOM         40236021
*                                                    USE-ERROR          40242021
*                                                    USE-REPORTING      40248021
*                                                                       40254021
*                                                                       40260021
*** SUBROUTINES CALLED                                                  40266021
*      GETNXT,GENDAT,ERROR                                              40272021
*                                                                       40278021
*                                                                       40284021
*** ERROR PROCESSING                                                    40290021
*      SKIP STATEMENT IF NOT IN DECLARATIVES PORTION OF PROGRAM         40296021
*      SKIP STATEMENT IF ONE OF THESE NOT FOUND -- BEGINNING            40302021
*                                                  ENDING               40308021
*                                                  RANDOM               40314021
*                                                  ERROR                40320021
*                                                  REPORTING            40326021
*      SKIP STATEMENT IF INPUT/OUTPUT MISSING AFTER BEGINNING/ENDIN     40332021
*      ASSUME 'PROCESSING' IF ABSENT AFTER 'RANDOM'                     40338021
*      WARN ABOUT CONTRADICTORY OPTIONAL WORDS (E.G., USE FOR ERROR     40344021
*        USE AFTER CREATING,...) BUT ACCEPT                             40350021
*      SKIP STATEMENT IF FILE-NAME NOT FOUND FOR LABEL OR ERROR DEC     40356021
*      TERMINATE ERROR DECL. AT FIRST NON-FILE-NAME.                    40362021
*      SKIP STATEMENT WITHOUT MSG IF RANDOM OPTION AND ITS SECTION      40368021
*       NAME SHOWS RPD =0,(SHOWING PH1 NEVER FOUND THE RIGHT APPLY      40374021
*       CLAUSE AND HAS ALREADY ISSUED MSG).                             40380021
*                                                                       40386021
*                                                                       40392021
*** NOTES                                                               40398021
*      ENDUSE+1 IS USED BOTH AS A SWITCH AND AS STORAGE FOR THE USE     40404021
*       VERB FINALLY DETERMINED. IT IS SET TO 0 AT THE START OF THE     40410021
*       ANALYZER,AND AT THE END IF NO VALID STATEMENT WAS FOUND. EA     40416021
*       OPTIONAL WORD FOUND CAUSES A TENTATIVE VERB-CODE TO BE STOR     40422021
*       IN IT. WHEN THE VERB HAS BEEN FINALLY DETERMINED AND GENERA     40428021
*       A 1 IS PUT IN THE LOW-ORDER BIT. THIS PRODUCES THE END-OF-U     40434021
*       VERB WHICH IS GENERATED BY IDENT WHEN IT FINDS THAT A DECLA     40440021
*       TIVE SECTION HAS ENDED. BEGINNING-USE VERBS ARE EVEN, END-U     40446021
*       ODD. IDENT KNOWS NOT TO GENR END-OF-USE IF ENDUSE+1=0. THIS     40452021
*       SAYS THERE HAS BEEN NO BEGINNING-USE.                           40458021
*                                                                       40464021
*                                                                       40470021
*******************************************************************     40476021
       SPACE   3                                                        40482021
       USING   *,RVRB                                                   40488021
USE    EQU     *                                                        40494021
       CLI     PGMBRK,MDECL       ARE WE IN DECLARATIVES                40500021
       BC      EQ,USE2            YES-OK                                40506021
       BAL     RCS,ERROR          NO-SKIP STATEMENT                     40512021
       LA      RW1,ELST30                                               40518021
       BC      UNCOND,IDERR        ISSUE MESSAGE AND EXIT               40524021
*                                                                       40530021
*              INITIALIZE                                               40536021
*                                                                       40542021
USE2   EQU     *                                                        40548021
         NI    ENDUSE+NX1,XX00     ZERO VERB CODE USED AS SWITCH        40554021
       NI      PFNDOP,MSWOFF      OFF SWITCH FOR FOUND A FILE-NAME      40560021
*      NI    HOLDSW,MSWOFF                                              40566021
       NI      TRCUSW,MSWOFF      OFF SW INHIBITING TRACE CODING        40572021
         XC    ETOPS+NX2(LX1),ETOPS+NX2                                 40578021
         MVI   ENDUSE+NX2,XX00                                          40584021
       LA    RA0,BCDOPT                                                 40590021
*                                                                       40596021
*              SEEK 'FOR', 'AFTER','BEFORE'                             40602021
*                                                                       40608021
USE6     CLC   GOTTEN(LX2),CBAFTR   IS IT AFTER                         40614021
       BNE   USE8          NO-SEE IF BEFORE                             40620021
         MVC   ENDUSE+NX1(LX1),VBCODE+NX2 ASSUME USE AFTER ERROR        40626021
       BAL   RCS,GETNXT            GET NEXT INPUT                       40632021
       BC    UNCOND,USE14          SEEK KEY WORDS                       40638021
USE8     CLC   GOTTEN(LX2),CBEFOR   IS IT BEFORE                        40644021
       BNE   USE14           NO OPTIONAL WORDS-SEEK KEY WORDS           40650021
         OI    ETOPS+NX2,XX80     BEFORE FOUND-SET BIT ON BEF LABEL     40656021
       BAL   RCS,GETNXT            GET NEXT INPUT                       40662021
         MVC   ENDUSE+NX1(LX1),VBCODE SET VBCODE TO BEFORE REPORTING    40668021
*                                                                       40674021
*              SEEK OPTION                                              40680021
*                                                                       40686021
USE14  EQU     *                                                        40692021
         LA    RW4,DX8               RW4  CONTROLS LOOP                 40698021
         LA    RW3,DX8               RW3 PTS  TO WORD FOUND             40704021
       LA    RW2,CBSTND            RW2 PTS SUCCESSIVERLY TO WORDS       40710021
         CLC   GOTTEN(LX2),DX0(RW2) IS IT STANDARD                      40716021
       BNE   USE16                 NO, SEEK ANOTHER KEYWORD             40722021
       BAL   RCS,GETNXT            GET NEXT INPUT                       40728021
USE16    LA    RW2,DX2(RW2)                                             40734021
         CLC   GOTTEN(LX2),DX0(RW2) IS IT ONE OF KEYWORDS               40740021
       BC      EQ,USE18            YES                                  40746021
       BCTR  RW3,RA0               NO                                   40752021
       BCT     RW4,USE16           IS IT A KEYWORD                      40758021
*      CLC   GOTTEN(2),CBRAND                                           40764021
*      BE    USE80                 IS IT RANDOM                         40770021
       BC      UNCOND,USE300      EXIT                                  40776021
USE18  EQU     *                                                        40782021
         LA    RW6,DX2                                                  40788021
       LR      RW4,RW3                                                  40794021
       SH      RW4,N7                                                   40800021
       BC      POS,USE22          RW6=2 FOR ERROR OPTIONS               40806021
       BCTR  RW6,RA0               DECREMENT COUNT BY 1                 40812021
       AH      RW4,N5                                                   40818021
       BC      NOTNEG,USE22       RW6=1 FOR LABEL AND RANDOM OPTION     40824021
       BCTR  RW6,RA0              RW6=0 FOR REPORTING OPTION            40830021
USE22  EQU     *                                                        40836021
       LA      RW6,VBCODE(RW6)                                          40842021
         CLI   ENDUSE+NX1,XX00 WAS ANY OPTIONAL WORD FOUND PREVIOUSL    40848021
       BC    EQ,USE22A             YES                                  40854021
         CLC   ENDUSE+NX1(LX1),DX0(RW6)   WAS IT COMPATIBLE WITH THIS   40860021
       BC      EQ,USE24           YES-OK                                40866021
         CLI   DX0(RW6),XX46     WAS IT USE FOR LABELS                  40872021
       BE    USE24                  OK                                  40878021
       BAL     RCS,ERROR          NO- TRIVIAL ERROR                     40884021
       LA      RW1,ELST31                                               40890021
       B     USE24                 USE FOR LABELS                       40896021
USE22A   CLI   DX0(RW6),XX46       MUST KNOW IF BEFORE-AFTER LABEL      40902021
       BE    USE300                NO, ERROR                            40908021
USE24    MVC   ENDUSE+NX1(LX1),DX0(RW6) SET  VERB CODE AS SWITCH        40914021
         SLA   RW3,DX2             RW3,USED IN BCT, SAYS WHICH KEY-W    40920021
       BC      UNCOND,*(RW3)      RW3 SAYS WHICH KEYWORD FOUND          40926021
       BC      UNCOND,USE30       REPORTING                             40932021
       BC    UNCOND,USE122         LABEL                                40938021
       BC    UNCOND,USE120         FILE                                 40944021
       BC    UNCOND,USE120         REEL                                 40950021
       BC    UNCOND,USE120         UNIT                                 40956021
       BC    UNCOND,USE51          ENDING                               40962021
       BC    UNCOND,USE50          BEGINNING                            40968021
       BC      UNCOND,USE100      ERROR                                 40974021
*                                                                       40980021
*              'REPORTING' FOUND                                        40986021
*                                                                       40992021
USE30  EQU     *                                                        40998021
         TM    SAVLHN+NX3,MRPTBT      YES - DID PH1 LIKE IT             41004021
       BC    ONES,USE200       OK- GENERATE                             41010021
       BC      UNCOND,USE302         NO - DONT GENR                     41016021
*                                                                       41022021
*      BEGINNING, ENDING   FOUND                                        41028021
*                                                                       41034021
USE50    OI    ETOPS+NX2,XX40                                           41040021
        B      *+NX8               BEGINING FOUND, DISCARD IT           41046021
USE51    OI    ETOPS+NX2,XX20                                           41052021
       BAL   RCS,GETNXT            BEGINING/ENDING FOUND, DISCARD       41058021
         LA    RW4,DX4                                                  41064021
         LA    RW3,DX5                                                  41070021
         LA    RW2,CBREEL-NX2                                           41076021
       BC      UNCOND,USE16        CHECK IF KEYWORD FOLLOWS             41082021
*                                                                       41088021
*              'RANDOM' FOUND                                           41094021
*                                                                       41100021
*USE80 EQU   *                                                          41106021
*      CLI   RPD,0                 WAS THERE AN APP-4CLAUSE             41112021
*      BC    EQ,USE302             NO-DONT GENR(PH1 NOTED ERR)          41118021
*      MVC   ENDUSE+1(1),VBCODE+3   SET  VERB CODE                      41124021
*      OI    SWUSRP,MSWON                                               41130021
*      CLC   GOTTEN(2),CBPRNG       IS IT PROCESSING                    41136021
*      BC    EQ,USE200              YES-OK EXIT                         41142021
*      LA    RA0,CBPRNG             NO-TRIVIAL ERROR                    41148021
*      BAL   RCS,ERROR                                                  41154021
*      LA    RW1,ELST07                                                 41160021
*      BC    UNCOND,USE202          EXIT-DONT GETNXT                    41166021
*                                                                       41172021
*              'ERROR' FOUND                                            41178021
*                                                                       41184021
USE100 BAL   RCS,GETNXT            GET NEXT INPUT                       41190021
         CLC   GOTTEN(LX2),CBPROC                                       41196021
         BC    NOTEQ,*+NX8         NOT 'PROCEDURE'                      41202021
       BAL     RCS,GETNXT         DISCARD 'PROCEDURE'                   41208021
         CLC   GOTTEN(LX2),CBON                                         41214021
         BC    NOTEQ,*+NX8         NOT 'ON'                             41220021
       BAL     RCS,GETNXT         AND 'ON'                              41226021
       LA      RA0,BCDFIL         SET RA0 FOR POSSIBLE MSG              41232021
       CLI     GOTTEN,MFILE       DOES FILE-NAME FOLLOW                 41238021
       BC    NOTEQ,USE104          NO                                   41244021
         OI    ETOPS+NX2,XX01       SET SW TO PH5-FILE  FOLLOWS         41250021
         TM    XREFSW,MSWON        XREF REQUESTED                 50787 41256021
         BZ    USE101B             NO, EXIT                       50787 41262021
         MVC   FILEREF1(LX3),DX11(RIN)                            50787 41268021
         BAL   RCS,GENDAT          GEN FILE REF ELEMENT FOR XREF  50787 41274021
         LA    RW2,FILEREF         C8 ELEMENT                     50787 41280021
USE101B  EQU   *                                                  50787 41286021
       BAL   RCS,GETNXT            GET NEXT INPUT                       41292021
         CLC   GOTTEN(LX2),CBGIVE   DOES  GIVING  FOLLOW                41298021
         BE    USE102              YES, LOOK FOR DATA NAME(S)           41304021
USE101 CLI   GOTTEN,MFILE          FOUND FILE-NAME ?                    41310021
       BNE   USE101A               NO, GO TO FINISH STRING              41316021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41322021
       B     USE101                BACK TO CHECK NEXT FILE              41328021
USE101A  MVI   ENDUSE+NX2,XX02                                          41334021
       BAL   RCS,STLOOP            STORE USE,VERB-INFO, AND ZERO        41340021
       DC    XL2'3'                STORE  3 ELEMENTS                    41346021
       LA    RW4,ENDUSE                                                 41352021
       LA    RW4,ETOPS                                                  41358021
       LA    RW4,CBZERO                                                 41364021
       B     USE130                EXIT TO GENERATE STRING              41370021
USE102   MVI   ENDUSE+NX2,XX03     TYPE OF OPTION                       41376021
       LA    RA0,BCDDN             ERROR MESSAGE                        41382021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41388021
       BAL   RCS,STLOOP            STORE USE, VERB-INFO IN STRING       41394021
       DC    XL2'2'                STORE 2 ELEMENTS                     41400021
       LA    RW4,ENDUSE                                                 41406021
       LA    RW4,ETOPS             USE STD ERROR ETOPS                  41412021
       CLI   GOTTEN,MDN            IS IT DN                             41418021
       BNE    USE300               NO, ERROR                            41424021
       LR    RW4,RIN                                                    41430021
       BAL   RCS,STOR45            STORE DN IN STRING                   41436021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41442021
       CLI   GOTTEN,MDN            IS IT DN                             41448021
       BNE   USE103                NO, GO TO STORE ZERO IN STRING       41454021
       LR    RW4,RIN                                                    41460021
       BAL   RCS,STOR45            YES, STORE DN IN STRING              41466021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41472021
       B     USE130                GO TO GENERATE STRING                41478021
USE103 LA    RW4,CBZERO                                                 41484021
       BAL   RCS,STOR45            STORE ZERO IN STRING                 41490021
       B     USE130                EXIT TO GENERATE STRING              41496021
USE104   XC    ETOPS+NX2(LX1),ETOPS+NX2                                 41502021
         MVI   ENDUSE+NX2,XX01                                          41508021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41514021
       B     USE129A          GO GENR STRING                            41520021
USE120 EQU   *                     REEL,UNIT,FILE FOUND                 41526021
         CLC   GOTTEN(LX2),CBFILE                                       41532021
       BE    USE121                FILE FOUND                           41538021
         OI    ETOPS+NX2,XX10       REEL OR   UNIT                      41544021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41550021
       B     USE121A               CHECK IF 'LABELS' FOLLOW             41556021
USE121   OI    ETOPS+NX2,XX08       FILE                                41562021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41568021
USE121A  CLC   GOTTEN(LX2),CBLABL                                       41574021
       BC      EQ,USE122           'LABELS' FOUND                       41580021
       LA      RA0,CBLABL         'LABELS' MISSING                      41586021
       BAL     RCS,ERROR           ERROR                                41592021
       LA      RW1,ELST07                                               41598021
         BC    UNCOND,*+NX8        CHECK IF 'PROCEDURE'                 41604021
USE122 EQU     *                                                        41610021
       BAL     RCS,GETNXT         DISCARD 'LABELS'                      41616021
USE123   CLC   GOTTEN(LX2),CBPROC                                       41622021
        BNE    *+NX8               NO                                   41628021
       BAL   RCS,GETNXT            GET NEXT ELEMENT                     41634021
         CLC   GOTTEN(LX2),CBON     IS IT 'ON'                          41640021
         BC    NOTEQ,*+NX8         NOT 'ON'                             41646021
USE123B BAL   RCS,GETNXT          DISCARD                               41652021
       CLI   GOTTEN,MFILE          FILENAME FOLLOWS   ?                 41658021
       BNE   USE124                NO                                   41664021
         TM    XREFSW,MSWON        XREF REQUESTED                 50787 41670021
         BZ    USE123BB            NO, EXIT                       50787 41676021
         MVC   FILEREF1(LX3),DX11(RIN)                            50787 41682021
         BAL   RCS,GENDAT          GEN FILE XREF ELEMENT TEXT     50787 41688021
         LA    RW2,FILEREF         C8 ELEMENT                     50787 41694021
USE123BB EQU   *                                                  50787 41700021
         TM    DX6(RIN),XX30      ISAM FILE                             41706021
       BC    NOTZER,ERRUS1         ILLEGAL HERE-MSG AND DISCARD FD      41712021
         TM    ETOPS+NX2,XX10       UNIT OR REEL                        41718021
       BZ    USE123A               NO                                   41724021
         TM    DX6(RIN),XXB0        UNIT OR REEL-QSAM,BSAM FILE         41730021
       BC    NOTZER,ERRUS2         ILLEGAL HERE-MSG AND DISCARD FD      41736021
*                                                                       41742021
USE123A OI   PFNDOP,MSWON                                               41748021
       B     USE123B               SEEK NEXT FILE                       41754021
USE124   MVI   ENDUSE+NX2,XX01                                          41760021
       TM    PFNDOP,MSWON                                               41766021
       BO    USE129              OK- GO GENR STRING AND EXIT            41772021
       LA    RA0,BCDINO                                                 41778021
         CLC   GOTTEN(LX2),CBINPT   IS IT 'INPUT'                       41784021
       BNE   USE124A               NO, CHECK IF 'OUTPUT'                41790021
         OI    ETOPS+NX2,XX04      YES                                  41796021
       B     USE128                GO TO GET NEXT ELEMENT               41802021
USE124A  CLC   GOTTEN(LX2),CBOUTP   IS IT 'OUTPUT'                      41808021
       BNE   USE124B               NO, CHECK TO SEE IF 'I/O'            41814021
         OI    ETOPS+NX2,XX02      YES                                  41820021
       B     USE128                GO TO GET NEXT INPUT                 41826021
USE124B  CLC   GOTTEN(LX2),CBIO     IS IT 'I/O'                         41832021
       BNE     USE300              NO, ERROR                            41838021
         OI    ETOPS+NX2,XX01                                           41844021
USE128 BAL     RCS,GETNXT          GET NEXT INPUT                       41850021
USE129   TM    ETOPS+NX2,XX18     WAS REEL OR UNIT OR FILE SPECIFIED    41856021
       BC    NOTZER,USE129A         YES- OK                             41862021
         OI    ETOPS+NX2,XX18  NEITHER SPECOFIED- SIGNAL BOTH TO PH5    41868021
USE129A BAL   RCS,STLOOP           STORE USE, VERB-INFO                 41874021
       DC    XL2'2'                STORE  2 ELEMENTS                    41880021
       LA    RW4,ENDUSE                                                 41886021
       LA    RW4,ETOPS                                                  41892021
USE130 BAL     RCS,GENSTR          GENERATE STRING                      41898021
       B    USE203                 GO TO EXIT                           41904021
ERRUS1 BAL   RCS,ERROR             ERROR                                41910021
       LA    RW1,ELST71                ISAM FILE ILLEGAL/LABELS         41916021
       BC    UNCOND,USE123B       GET NEXT AND SEE IF OK                41922021
ERRUS2 BAL   RCS,ERROR             ERROR                                41928021
       LA    RW1,ELST72          UNIT OR REEL ILLEGAL/BDAM FILE         41934021
       BC    UNCOND,USE123B        GET NEXT AND SEE IF OK               41940021
*                                                                       41946021
*              CORRECT EXIT                                             41952021
*                                                                       41958021
USE200 EQU     *                                                        41964021
       BAL     RCS,GETNXT          GET NEXT INPUT                       41970021
USE202 BAL     RCS,GENDAT         GENR USE VERB AS ENTIRE STRING        41976021
       LA      RW2,ENDUSE                                               41982021
USE203   OI    ENDUSE+NX1,XX01                                          41988021
         MVI   ENDUSE+NX2,XX00      ENDUSE MUST ALWAYSE BE ZERO         41994021
       OI      GENRED,MSWON       AVOID 'INCOMPLETE' MSG                42000021
       BAL     RCS,IDLH09         PROVIDE TRACE CODING FOR SN IF NE     42006021
         BC    UNCOND,IDENT        EXIT                                 42012021
*                                                                       42018021
*              ERROR EXIT - RA0 CONTAINS PARAMETER ADDRESS              42024021
*                                                                       42030021
USE300 EQU     *                                                        42036021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  42042021
       LA      RW1,ELST32                                               42048021
USE302 EQU     *                                                        42054021
         NI    ENDUSE+NX1,XX00     SET USEVERB TO 0 SO IDENT WONT GE    42060021
       BAL     RCS,IDLH09         PROVIDE TRACE CODING FOR SN IF NE     42066021
       BC      UNCOND,IDERR        ERROR EXIT                           42072021
       EJECT                                                            42078021
       EJECT                                                            42084021
IKF40F CSECT                                                            42090021
*=1    DISPLA  VERB                                                     42096021
*******************************************************************     42102021
*                                                                       42108021
*                                                                       42114021
*                           D I S P L A                                 42120021
*                                                                       42126021
*                                                                       42132021
*  DISPLAY VERB ANALYZER. USES STO5 ENTRYS  TO STO ROUTINES.            42138021
*      USES CONTINUOUS SEGMENTED STRING.                                42144021
*                                                                       42150021
*** STRINGS PRODUCED                                                    42156021
*      SOURCE - DISPLAY DN1 'A'                                         42162021
*      OUTPUT - DISPLAY 'FIRST' 'ZERO' DN1 'A' 'END'                    42168021
*      SOURCE - DISPLAY DN1 'A' DN2 'B' DN3 'C' UPON CONSOLE            42174021
*      OUTPUT - DISPLAY 'FIRST' CONSOLE DN1 'A' DN2                     42180021
*               DISPLAY 'B' DN3 'C' 'END'                               42186021
*                                                                       42192021
*                                                                       42198021
*** SUBROUTINES CALLED                                                  42204021
*      GETNXT,STOVRB,STODUM,STO5IN,STO5CU,RDUCOP,ERROR                  42210021
*       ISFLPT                                                          42216021
*                                                                       42222021
*                                                                       42228021
*** ERROR PROCESSING                                                    42234021
*      SKIP STATEMENT IF 1ST OPERAND ILLEGAL                            42240021
*      ASSUME MISSING 'UPON'                                            42246021
*      ASSUME SYSOUT IF 'SYSPCH' OR 'CONSOLE' MISSING                   42252021
*                                                                       42258021
*                                                                       42264021
*** NOTES                                                               42270021
*      ZERO IS STORED AS 1ST ELEMENT FOR SYSOUT                         42276021
*      IF ANY DN IS INT. FLOATING POINT,DISPLAY STRINGS ARE PRECEDE     42282021
*               MOVE ELEMENT PARAM                                      42288021
*      GNOUSW TELLS GENSTR TO GENERATE WHAT IT FINDS IN PNOUNT -- I     42294021
*       THE MOVE STRINGS                                                42300021
*                                                                       42306021
*                                                                       42312021
*******************************************************************     42318021
       SPACE   3                                                        42324021
       USING   *,RVRB                                                   42330021
DISPLA EQU     *                                                        42336021
       OI      GNOUSW,MSWON       ALERT GENSTR TO OUTPUT IN PNOUNS      42342021
       NI      PFNDOP,MSWOFF                                            42348021
       BAL     RCS,PZSTRT          REINITIALIZE TAMER TABLES            42354021
       L     RW1,APNOUN                                                 42360021
         XC    PARSIZ(LX2),PARSIZ   RESTART PARAM DISPL. COUNT AT 0     42366021
       BAL     RCS,STO5BG         STORE VERB AND 'FIRST'                42372021
       OI      STO5CT,MSWON        INITIALIZE SWITCHES FOR STO5         42378021
       SR      RW1,RW1            SW = 1 IF 'UPON' FOUND                42384021
*                                                                       42390021
*      PUT OUT SYSOUT DUMMY (FIGCON ZERO) TO BE OVERWRITTEN             42396021
*              IF ANOTHER OPTION IS ACTUALLY FOUND.                     42402021
       BAL     RCS,STODUM          PUT FIGCON 'ZERO' INTO STRING        42408021
DISP02 BAL     RCS,RDUCOP          IS IT A VALID DATA NAME              42414021
       BC      UNCOND,DISPE4       NOT DN, IS IT OPERAND                42420021
       OI      PFNDOP,MSWON       AT LEAST 1 GOOD OP FOUND              42426021
       BAL     RCS,ISFLPT          IS IT FLOATING POINT                 42432021
       BAL     RCS,STO5IN          STORE IT                             42438021
       BAL     RCS,GETNXT          GET NEXT INPUT                       42444021
       BC      UNCOND,DISP02       CHECK IF VALID DATA NAME             42450021
DISP01   CLC   GOTTEN(LX2),CBUPON   ='UPON'...                          42456021
       BC      EQ,DISP1X           YES                                  42462021
         CLC   GOTTEN(LX2),CBON    IS IT BY NATURAL ERROR 'ON'          42468021
       BC      NOTEQ,DISP03         NO                                  42474021
         LA    RW1,DX1(RW1)         YES - SW WILL BECOME 1 AND CAUSE    42480021
DISP1X EQU     *                                                        42486021
       BAL     RCS,GETNXT          DISCARD 'UPON'                       42492021
       BCTR  RW1,RA0              SET UPON SW                           42498021
DISP03   CLC   GOTTEN(LX2),CBSOUT  ='SYSOUT'                            42504021
       BC      EQ,DISP3X           YES                                  42510021
         CLC   GOTTEN(LX2),CBCNSL   ='CONSOLE'...                       42516021
       BC      EQ,DISP04            YES                                 42522021
         CLC   GOTTEN(LX2),CBSYSP   ='SYSPCH'...                        42528021
       BC      EQ,DISP04           YES                                  42534021
       LTR     RW1,RW1            WAS UPON FOUND                        42540021
       BC      ZERO,DISP05         NO - OK,USE SYSOUT                   42546021
       BC      UNCOND,DISPE3       YES - ERROR,THEN USE SYSOUT          42552021
DISP3X LA      RIN,CBZERO                                               42558021
DISP04 EQU     *                                                        42564021
       LTR     RW1,RW1            WAS UPON FOUND                        42570021
       BC      ZERO,DISPE2         NO - TRIVIAL ERROR                   42576021
DISP4X EQU     *                                                        42582021
       L       RW2,ASTRNG          CURRENT ORGIN OF STRING              42588021
         L     RW2,DX0(RW2)                                             42594021
         L     RW2,DX0(RW2)                                             42600021
         MVC   DX7(LX2,RW2),DX0(RIN) OVERLAY SYSOUT WITH DEVICE FOUND   42606021
       BAL     RCS,GETNXT          GET NEXT INPUT                       42612021
DISP05 EQU     *                                                        42618021
       BAL     RCS,STO5CU             CLEANUP                           42624021
       NI      STO5CT,MSWOFF       RESET CONTINUOUS-SEGMENTED SW        42630021
DISPE1 EQU     *                                                        42636021
       NI      GNOUSW,MSWOFF                                            42642021
       BC      UNCOND,IDENT     *** LEAVE DISPLAY VERB ***              42648021
*                                                                       42654021
*                           ERRORS                                      42660021
*                                                                       42666021
DISPE2 EQU   *                     9D                                   42672021
       LA      RA0,CBUPON                                               42678021
       BAL   RCS,ERROR             WARNING ERROR                        42684021
       LA      RW1,ELST07                                               42690021
       BC      UNCOND,DISP4X       LOOK FOR DEVICE                      42696021
DISPE3 EQU   *                     9E                                   42702021
       BAL   RCS,ERROR             ERROR EARNING                        42708021
       LA      RW1,ELST45                                               42714021
       BC    UNCOND,DISP05         DISPE3                               42720021
DISPE4 TM      GOTTEN,MOP         IS IT OPERAND (EVEN NON-DATA)         42726021
       BC      ONES,DISPE6         YES                                  42732021
       TM      PFNDOP,MSWON        NO - WAS ANY FOUND                   42738021
       BC      ONES,DISP01               YES - LOOK FOR 'UPON'          42744021
       BAL     RCS,ISEND           NO - IS THIS END                     42750021
       BC      UNCOND,DISPE6        NOT END - DISCARD                   42756021
       BC      UNCOND,DISPE1       END - GIVE UP                        42762021
DISPE6 BAL     RCS,ERROR           ERROR - DELETE                       42768021
       LA      RW1,ELST04                                               42774021
       BAL     RCS,GETNXT         DISCARD AND LOOK FOR ANOTHER OP       42780021
       BC      UNCOND,DISP02       CHECK IF VALID DATA NAME             42786021
       EJECT                                                            42792021
*=1    ACCEPT  VERB                                                     42798021
*                                                                       42804021
*******************************************************************     42810021
*                                                                       42816021
*                                                                       42822021
*                           A C C E P T                                 42828021
*                                                                       42834021
*                                                                       42840021
*** STRINGS PRODUCED                                                    42846021
*      SOURCE - ACCEPT DN                                               42852021
*      OUTPUT - ACCEPT DN 'END'                                         42858021
*      SOURCE - ACCEPT DN FROM CONSOLE                                  42864021
*      OUTPUT - ACCEPT DN CONSOLE 'END'                                 42870021
*                                                                       42876021
*                                                                       42882021
*** SUBROUTINES CALLED                                                  42888021
*      GETNXT,STOVRB,STO5IN,STO5CU,RDUCOP,CALCLG,ERROR                  42894021
*                                                                       42900021
*                                                                       42906021
*** ERROR PROCESSING                                                    42912021
*      ASSUME 'FROM' IF MISSING                                         42918021
*      SKIP STATEMENT IF OPERAND ILLEGAL OR TOO LONG                    42924021
*      SKIP 'FROM' OPTION IF DEVICE ILLEGAL                             42930021
*                                                                       42936021
*                                                                       42942021
*******************************************************************     42948021
       SPACE   3                                                        42954021
       USING   *,RVRB                                                   42960021
ACCEPT EQU     *                                                        42966021
       OI      STO5SW,MSWON                                             42972021
       BAL     RCS,STOVRB          STORE VERB 'ACCEPT'                  42978021
       BAL     RCS,RDUCOP          IS THIS DN...                        42984021
       BC      UNCOND,ACCEE1       NO                                   42990021
       TM      MODE,MLITBT                                              42996021
       BC      ONES,ACCEE1          NO                                  43002021
         CLI   MODE+NX1,MANMOD     AN,AL,FIXED-GROUP                    43008021
       BC      NOTHI,ACCE00         YES                                 43014021
         CLI   MODE+NX1,MEDMOD     ED                                   43020021
       BC      EQ,ACCE00             YES                                43026021
         CLI   MODE+NX1,MEFMOD     EF                                   43032021
       BC      NOTEQ,ACCEE1          NO - NOT ACCEPTABLE                43038021
ACCE00 EQU     *                                                        43044021
       BAL     RCS,CALCLG          YES,FIND LENGTH                      43050021
       BC      UNCOND,ACCEE1       ILLEGAL MINOR                        43056021
       BAL     RCS,GETNXT          GET NEXT INPUT                       43062021
       SR      RW1,RW1            RW1 USED AS SW (NONZERO IF 'FROM'     43068021
         CLC   GOTTEN(LX2),CBFROM    IS IT FROM                         43074021
       BC      NOTEQ,ACCE02        NO                                   43080021
       BCTR  RW1,RA0                YES,SET SW AND DISCARD              43086021
       BAL     RCS,GETNXT          GET NEXT INPUT                       43092021
ACCE02   CLC   GOTTEN(LX2),CBCNSL  CONSOLE                              43098021
       BC      EQ,ACCE04            YES                                 43104021
         CLC   GOTTEN(LX2),CBSIN   IS SYSIN SPECIFIED                   43110021
       BC      EQ,ACCE09            YES                                 43116021
       LTR     RW1,RW1              NO - WAS 'FROM' FOUND               43122021
       BC      ZERO,ACCE08               NO - OK                        43128021
       BC      UNCOND,ACCEE3             YES - TRIVIAL ERROR            43134021
*                                                                       43140021
*                           CONSOLE FOUND                               43146021
*                                                                       43152021
ACCE04 LTR     RW1,RW1            DID 'FROM' PRECEDE                    43158021
       BC      NOTZER,ACCE06       YES                                  43164021
       LA      RA0,CBFROM           NO - TRIVIAL ERROR                  43170021
       BAL     RCS,ERROR           PROCESS ERROR                        43176021
       LA      RW1,ELST07                                               43182021
ACCE06   CLC   LENGTH(LX4),ONE19   LEGAL LENGTH                         43188021
       BC      NOTHI,ACCE10         YES - GO CREATE STRING              43194021
       BC      HI,ACCEE4            NO - GIVE UP                        43200021
*                                                                       43206021
*                           SYSIN ASSUMED OR FOUND                      43212021
*                                                                       43218021
ACCE08 OI      NEXTIN,MSWON       SAVE CURRENT INPUT WHEN ASSUMED       43224021
ACCE09 LA      RIN,CBZERO          REPLACE BY SYSIN DUMMY               43230021
*                                                                       43236021
*                           CREATE STRING                               43242021
*                                                                       43248021
ACCE10 LA      RW4,CURENT         DN                                    43254021
       BAL     RCS,STO545          STORE DN                             43260021
       BAL     RCS,STO5IN         DEVICE                                43266021
       BAL     RCS,GETNXT          GET NEXT INPUT                       43272021
       BAL     RCS,STO5CU          'END' INTO STRING                    43278021
       BC      UNCOND,IDENT        EXIT                                 43284021
*                                                                       43290021
*                           ERRORS                                      43296021
*                                                                       43302021
ACCEE1 EQU   *                     A3                                   43308021
       BAL   RCS,ERROR             NOT DN - SKIP STATEMENT              43314021
       LA      RW1,ELST04                                               43320021
       BC    UNCOND,IDERR          ACCEE1                               43326021
ACCEE3 EQU   *                     A5                                   43332021
       BAL   RCS,ERROR             WARNING MESSAGE                      43338021
       LA      RW1,ELST45                                               43344021
       BAL     RCS,THROWE          THROW OUT UNTIL ENDWORD              43350021
       BC      UNCOND,ACCE08       ASSUME OR FOUND SYSIN                43356021
ACCEE4 LA    RA0,EBCDFF            FIND DEVICE                          43362021
       BAL     RCS,ERROR           ERROR - GIVE UP                      43368021
       LA      RW1,ELST51                                               43374021
         CLC   LENGTH(LX4),ONE19     IS LENGTH OVER 114 CHAR            43380021
       BC      NOTHI,ACCE10         NO                                  43386021
         NI    CURENT+NX7,XXFE       YES - CHANGE IT                    43392021
         MVC   CURENT+NX8(LX2),ONE19+NX2                                43398021
       BC      UNCOND,ACCE10       GO TO CREATE STRING                  43404021
*                                                                       43410021
* START                                                                 43416021
* SOURCE- START FILE INVALID KEY GO.. ADD                               43422021
* OUTPUT- START FILE RGN1  RGN2                                         43428021
* LGN1  GO...                                                           43434021
*  LGN2 ADD...                                                          43440021
*  NOTES- FILE MUST BE QISAM                                            43446021
*  IF INVALID KEY NOT PRESENT, GN1 AND 2 PT TO NEXT SENTENCE            43452021
START  EQU   *                                                          43458021
        USING *,RVRB                                                    43464021
       CLI   GOTTEN,MFILE          IS IT AN FD                          43470021
       BNE    STERR                NO- GIVE UP                          43476021
         TM    DX6(RIN),XX10+XX04  QISAM WITH NOMINAL KEY         41077 43482021
         BNO   STERR               NO,  IT IS ERROR               41077 43488021
       BAL   RCS,STOVRB           OK                                    43494021
       BAL   RCS,STOINP        STORE FD IN STRING                       43500021
         BAL   RCS,GETNXT          GET NEXT INPUT                 42031 43506021
         CLC   GOTTEN(LX2),CBINVL      IS IT 'INVALID'            42031 43512021
         BNE   START1                   NO                        42031 43518021
         BAL   RCS,GETNXT         YES  GET NEXT                   42031 43524021
         CLC   GOTTEN(LX2),CBKEY         IS IT 'KEY'              42031 43530021
         BNE   START0                NO                           42031 43536021
         BAL   RCS,GETNXT          YES GET NEXT INPUT             42031 43542021
START0   BAL   RCS,PUPLGN           GET GN OF INVALID             42031 43548021
         MVC   RGN+NX1(LX2),NXTLGN                                42031 43554021
         MVC   GNX(LX2),NXTLGN         SAVE GN FOR INVALID        42031 43560021
         LA    RW4,RGN                                            42031 43566021
         BAL   RCS,STOR45          STORE GN IN STRING             42031 43572021
         BAL   RCS,NEWNXT          GET GN FOR NEXT SENTENCE       42031 43578021
         MVC   RGN+NX1(LX2),NXTSNT                                42031 43584021
         LA    RW4,RGN                                            42031 43590021
         BAL   RCS,STOR45       STORE GN FOR NEXT SENTENCE        42031 43596021
         BC    UNCOND,START2      BRANCH TO START2                42031 43602021
START1   BAL   RCS,NEWNXT          GET GN OF NEXT SENTENCE        42031 43608021
         MVC   RGN+NX1(LX2),NXTLGN                                42031 43614021
         LA    RW4,RGN                                            42031 43620021
         BAL   RCS,STOR45           STORE GN OF NEXT SENTENCE     42031 43626021
         MVC   RGN+NX1(LX2),NXTLGN                                42031 43632021
         MVC   GNX(LX2),NXTLGN                                    42031 43638021
         LA    RW4,RGN                                            42031 43644021
         BAL   RCS,STOR45        SORE GN                          42031 43650021
START2   BAL   RCS,GENSTR                                         42031 43656021
         CLC   NXTSNT(LX2),GNX     IS THERE DIFF INVLID KEY GN    42031 43662021
       BE    IDENT          NO-EXIT WITH GN IN NXTSNT                   43668021
         MVC   LGN+NX1(LX2),GNX          GENR LABEL FOR INVAL KEY 42031 43674021
       BAL   RCS,GENLAB       GENR LGN FOR INVALID                      43680021
*                        (OR NEXT SENTENCE IF NO INVALID PRESENT)       43686021
         MVC   NXTSNT(LX2),RGN+NX1  MOVE SECOND GN INTO NXTSNT          43692021
       BC    UNCOND,IDENT          EXIT                                 43698021
STERR  LA    RA0,BCDQI                                                  43704021
       BC    UNCOND,IDGVUP         GIVE UP                              43710021
*                                                                       43716021
*    FREE                                                               43722021
*   SOURCE-  FREE FILE RECORD                                           43728021
*  OUTPUT-  FREE FILE                                                   43734021
*  NOTES-  FILE MUST BE BISAM                                           43740021
*                                                                       43746021
FREE   EQU   *                                                          43752021
       USING *,RVRB                                                     43758021
       B     IDENT                 EXIT                                 43764021
       EJECT                                                            43770021
*******************************************************************     43776021
*                                                                       43782021
*                            O P E N  /  C L O S E                      43788021
*                                                                       43794021
*                                                                       43800021
*** STRINGS PRODUCED                                                    43806021
*      PRODUCES CONTINUOUS STRINGS OF 5 FILE-NAMES UNTIL END-OF-        43812021
*       STATEMENT IS REACHED. LAST OF THE STRINGS HAS CB WORD 'END'     43818021
*       FOLLOWING LAST FILE-NAME.                                       43824021
*                                                                       43830021
*      GENERATES THE WHOLE SERIES OF STRINGS TWICE.                     43836021
*      FOR EXAMPLE.                                                     43842021
*        SOURCE.  OPEN I-O FN1 FN2 FN3 FN4 FN5 FN6 FN7.                 43848021
*      OUTPUT -OPEN 'FIRST'FN1 FN2 FN3 FN4                              43854021
*              OPEN FN5 FN6 FN7 'END'                                   43860021
*              OPEN 'FIRST' FN1 FN2 FN3 FN4                             43866021
*              OPEN  FN5 FN6 FN7 'END'                                  43872021
*                                                                       43878021
*      PUTS OPTION IN 3RD BYTE, 1ST HALF-WORD OF EACH FILE-NAME         43884021
*    OPEN INPUT    - 0   CLOSE LOCK      - 0   CLOSE-REEL LOCK          43890021
*         REVERSED - 1         REWIND    - 1              REWIND        43896021
*          OUTPUT  -  F        NO-REWIND - 3              NO-REWIND     43902021
*          I-O     - 4                                                  43908021
*                                                                       43914021
*** SUBROUTINES CALLED                                                  43920021
*      GETNXT,SAVCUR,STOVRB,STO545,ISEND,ISOKFL,GNTWIC,ERROR            43926021
*                                                                       43932021
*                                                                       43938021
*** ERROR PROCESSING                                                    43944021
*      ASSUMES 'REWIND' IF 'NO' ALONE IS FOUND                          43950021
*      FOR ANY OTHER ERROR SKIPS THE FILE-NAME INVOLVED                 43956021
*      WRITES NO MESSAGE FOR FILES WHOSE 'ACCESS-METHOD' ATTRIBUTE=     43962021
*       'F' IS A SIGNAL THAT PHASE 2 HAS WRITTEN THE MESSAGE.           43968021
*      DIAGNOSES MISSING REQUIRED OPTIONS                               43974021
*                ILLEGAL OPERANDS (I.E., NON-FILE-NAMES)                43980021
*                I-O OPENED NO REWIND                                   43986021
*                I-O OR OUTPUT OPENED REVERSED                          43992021
*                QSAM OR V-TYPE-RECORD OPENED REVERSED                  43998021
*                                                                       44004021
*                                                                       44010021
*                                                                       44016021
*                                                                       44022021
*                                                                       44028021
*** NOTES                                                               44034021
*        OPTSW   ON     'INPUT','OUTPUT', OR 'I-O' WAS FOUND            44040021
*                OFF    OPTION NOT YET FOUND                            44046021
*        PFNDOP  ON     FILE-NAME (OR ERROR) FOUND AFTER OPTION         44052021
*                OFF    NOTHING FOUND AFTER OPTION                      44058021
*        SKIPSW  ON     CURRENT FILE-NAME SHOULD BE SKIPPED FOR ERR     44064021
*                OFF    CURRENT FILE-NAME OK                            44070021
*        SENDSW  ON     SOMETHING IS TO BE GENERATED                    44076021
*                OFF    STRING IS EMPTY                                 44082021
*        OPCLSW  ON     TELLS ISOKFL ROUTINE VERB IS OPEN OR CLOSE      44088021
*                                                                       44094021
*      STO5SW,STO5CT,MSGSW ARE AS IN OTHER ROUTINES                     44100021
*                                                                       44106021
*      RW6 SET TO 4 FOR OPEN                                            44112021
*                 0     CLOSE                                           44118021
*                                                                       44124021
*******************************************************************     44130021
       SPACE   5                                                        44136021
*=1    CLOSE   VERB                                                     44142021
       USING   *,RVRB                                                   44148021
CLOSE  EQU     *                                                        44154021
       SR      RW6,RW6            TELLS ROUTINE VERB IS 'CLOSE'         44160021
       OI      OPTSW,MSWON   **(TO GET PROPER MSG AT OPEN40)**          44166021
         OI    OPCLSW,XX03         TELL ISOKFL VERB IS CLOSE            44172021
       LA      RVRB,OPEN-CLOSE(RVRB)  SET BASE-REGISTER                 44178021
       USING   OPEN,RVRB                                                44184021
       BC      UNCOND,OPEN2        GO TO PROCESS STRING                 44190021
       SPACE   3                                                        44196021
*=1    OPEN    VERB                                                     44202021
OPEN   EQU     *                                                        44208021
         LA    RW6,DX4             TELLS ROUTINE VERB IS 'OPEN'         44214021
       OI      PFNDOP,MSWON       (AVOID MSG AFTER 1ST OPTION)          44220021
       NI      OPTSW,MSWOFF        TO SAY IF IN,OUT,OR I-O EVER FOU     44226021
         OI    OPCLSW,XX01         TELL ISOKFL VERB IS OPEN             44232021
OPEN2  EQU     *                                                        44238021
       OI      STO5CT,MSWON             CONTINUOUS STRING               44244021
       NI      SENDSW,MSWOFF      NOTHING IN STRING YET                 44250021
       NI      SKIPSW,MSWOFF      NO ERRORS IN FILE-NAME YET            44256021
       BAL     RCS,STO5BG         STORE VERB AND 'FIRST'                44262021
       LTR     RW6,RW6                                                  44268021
       BC      ZERO,OPEN18         BRANCH FOR 'CLOSE'                   44274021
*                                                                       44280021
*                           OPTION EXPECTED  (OPEN)                     44286021
*                                                                       44292021
OPEN5    CLC   GOTTEN(LX2),CBINPT   FOUND 'INPUT' ?                     44298021
       BC      EQ,OPEN12           YES, GO TO SET OPTION                44304021
         CLC   GOTTEN(LX2),CBOUTP   FOUND 'OUTPUT' ?                    44310021
       BC      EQ,OPEN10           YES, GO TO SET OPTION                44316021
         CLC   GOTTEN(LX2),CBIO     FOUND 'I-O' ?                       44322021
       BC      NOTEQ,OPEN38      INPUT IS NOT OPTION,SEEK FN OR END     44328021
*                                                                       44334021
*                           OPTION FOUND     (OPEN)                     44340021
*                                                                       44346021
       MVI     MSKOPT,MIOOPT     I-O =F                                 44352021
       BC      UNCOND,OPEN14       GO TO LOOK FOR FILE NAME(S)          44358021
OPEN10 MVI     MSKOPT,MOUOPT     OUTPUT = 4                             44364021
       BC      UNCOND,OPEN14       GO TO LOOK FOR FILE-NAME(S)          44370021
OPEN12 MVI     MSKOPT,MINOPT     INPUT  = 0                             44376021
OPEN14 TM      PFNDOP,MSWON      DID ANYTHING INTERVENE BETWEEN OPT     44382021
       BC      ONES,OPEN16          YES OK                              44388021
       LA      RA0,BCDOPT                                               44394021
       BAL     RCS,ERROR            NO - MSG SUPERFLUOUS OPTION         44400021
       LA      RW1,ELST08                                               44406021
OPEN16 NI      PFNDOP,MSWOFF     REINIT SW FOR ABOVE MSG                44412021
       OI      OPTSW,MSWON       INDICATE OPTION FOUND                  44418021
       NI      MSGSW,MSWOFF      REINIT SW FOR SINGLE MSG IN ERROR      44424021
*                                                                       44430021
*                           FILE-NAME EXPECTED                          44436021
*                                                                       44442021
OPEN17 BAL     RCS,GETNXT          GET NEXT ELEMENT                     44448021
OPN18X LTR     RW6,RW6             WHICH VERB                           44454021
       BC      ZERO,OPEN18           CLOSE, REINIT MSKOPT               44460021
       TM      MSKOPT,MOUOPT       IS IT OPEN OUTPUT                    44466021
       BC      ONES,OPEN18(RW6)      YES                                44472021
       TM      MSKOPT,MIOOPT       IS IT OPEN I-O                       44478021
       BC      ONES,OPEN18(RW6)      YES                                44484021
OPEN18   NI    MSKOPT,XX00          REINIT MSKOPT, CLOSE OR OPEN INP    44490021
       CLI     GOTTEN,MFILE       IS INPUT FILE-NAME                    44496021
       BC      EQ,OPEN19            YES                                 44502021
       LTR     RW6,RW6              NO - WHICH VERB                     44508021
       BC      NOTZER,OPEN5            OPEN - SEEK NEXT CLAUSE          44514021
       BC      UNCOND,OPEN38          CLOSE - ERROR OR END              44520021
OPEN19   CLI   GOTTEN+NX2,XX89     IS IT A SORT FILE                    44526021
       BE    FILERR               YES, ERROR                            44532021
       OI    PFNDOP,MSWON                                               44538021
       NI      SKIPSW,MSWOFF        REINIT STORE SW FOR THIS FILE       44544021
       NI      MSGSW,MSWOFF                MSG SW FOR ERROR LOOP        44550021
       BAL     RCS,SAVCUR           SAVE FILE-NAME IN CURENT            44556021
       BAL     RCS,ISOKFL         IS THIS OPEN ALLOWED                  44562021
         NI    CURENT+NX2,XX00                                          44568021
       LTR     RW6,RW6             WHICH VERB                           44574021
       BC      ZERO,OPEN20         CLOSE - OK                           44580021
OPN19L TM    MSKOPT,MOUOPT                                              44586021
       BC      ZERO,OPEN20         INPUT - ALL ACCESS METHODS OK        44592021
       BC      ONES,OPN19X         OUTPUT                               44598021
         TM    CURENT+NX6,MBSAM     I-O - IS IT BSAM                    44604021
       BC      ZERO,OPEN20         NO,  OK                              44610021
       LA      RA0,CBIO            YES,  ERROR                          44616021
       LA      RW2,BCDBSA                                               44622021
       BAL     RCS,E28OPN          PROCESS ERROR                        44628021
       BC      UNCOND,OPEN20       GO TO PROCESS ANYWAY                 44634021
OPN19X   TM    CURENT+NX6,MBIBD    OPENED OUTPUT/ IS BDAM OR BISAM      44640021
       BC    ZERO,OPEN20           NO- OK                               44646021
         TM    CURENT+NX6,BDMDIR    IS IT DIRECT BDAM                   44652021
       BC    ONES,OPEN20          YES-OK                                44658021
       LA      RA0,CBOUTP          YES,  ERROR                          44664021
       LA      RW2,CBRAND                                               44670021
       BAL     RCS,E28OPN          GO TO PROCESS ERROR                  44676021
*                                                                       44682021
*              PROCESS OPTIONS FOLLOWING FILE-NAME                      44688021
*                                                                       44694021
OPEN20 BAL     RCS,GETNXT          GET NEXT ELEMENT                     44700021
       LTR     RW6,RW6            WHICH VERB                            44706021
       BC      NOTZER,OPEN21           OPEN                             44712021
         CLC   GOTTEN(LX2),CBUNIT    CLOSE - IS IT UNIT                 44718021
         BC    EQ,*+NX14           YES                                  44724021
         CLC   GOTTEN(LX2),CBREEL                  REEL                 44730021
       BC      NOTEQ,OPEN21            NO - SEEK NO REWIND              44736021
         TM    CURENT+NX6,MQSBS     IS FILE QSAM OR BSAM                44742021
         BC    ZERO,OPN21X           YES - OK                           44748021
         BAL   RCS,ERROR           WRITE ERROR MESSAGE                  44754021
         LA    RW1,ELST61                                               44760021
         BC    UNCOND,*+NX8          NO - SKIP REEL OPTION              44766021
OPN21X   EQU   *                                                        44772021
       OI      MSKOPT,MREEL         UNIT-OR-REEL OPTION                 44778021
       BAL     RCS,GETNXT          GET NEXT ELEMENT                     44784021
OPEN21   CLC   GOTTEN(LX2),CBWITH     WITH                              44790021
         BC    NOTEQ,*+NX8              NO                              44796021
       BAL     RCS,GETNXT              YES                              44802021
         CLC   GOTTEN(LX2),CBNO       NO                                44808021
       BC      NOTEQ,OPEN24            NO                               44814021
       BAL     RCS,GETNXT          YES, GET NEXT ELEMENT                44820021
         CLC   GOTTEN(LX2),CBRWND     REWIND                            44826021
       BC      EQ,OPEN22               YES                              44832021
       LA      RA0,CBRWND              NO                               44838021
       BAL     RCS,ERROR                'REWIND' MISSING                44844021
       LA      RW1,ELST07                                               44850021
         BC    UNCOND,*+NX8        GO TO CHECK VERB                     44856021
OPEN22 BAL     RCS,GETNXT        NO-RWND FOUND OR ASSUMED               44862021
       LTR     RW6,RW6            WHICH VERB                            44868021
       BC    NOTZER,OPEN23         OPEN                                 44874021
       TM    MSKOPT,MREEL           IS IT CLOSE REEL                    44880021
         BC    NOTONE,*+NX12          OPTION CODES DIFFER FOR CLOSE     44886021
*                                  AND CLOSE REEL                       44892021
       OI    MSKOPT,MLEAVE                                              44898021
       B     OPEN33                PREPARE TO PUT OUT STRING            44904021
       OI      MSKOPT,MCLNOR         CLOSE - NO MORE OPTIONS            44910021
       B     OPEN33                GO TO PUT OUT STRING                 44916021
OPEN23 CLI   MSKOPT,MIOOPT        IS IT OPEN I/O                        44922021
       BC      NOTEQ,OPEN24          NO - OK                            44928021
       LA      RW2,CBIO            YES, ERROR                           44934021
       LA      RA0,BCDNOR                                               44940021
         BAL   RCS,E28OPN          WRONG ACCESS METHOD                  44946021
OPEN24 LTR     RW6,RW6            WHICH VERB                            44952021
       BC      NOTZER,OPEN25       GO TO PROCESS ERROR                  44958021
         CLC   GOTTEN(LX2),CBLOCK    CLOSE - IS IT LOCK                 44964021
       BC    NOTEQ,OPEN25B         NO, SEE IF DISP                      44970021
       BAL     RCS,GETNXT             YES                               44976021
       TM    MSKOPT,MREEL                                               44982021
       BO    OPN28P             TREAT AS NO OPTION FOR REEL             44988021
         OI    MSKOPT,XX01        01 FOR CLOSE LOCK                     44994021
       B     OPEN32A            REWIND OPTION                           45000021
OPEN25   CLC   GOTTEN(LX2),CBRVRS    OPEN - IS IT REVERSED              45006021
       BC    NOTEQ,OPEN25A        NO- SEE IF LEAVE, REREAD, DISP        45012021
       TM      MSKOPT,MOUOPT         YES - WAS IT OPEN INPUT            45018021
       BC      NOTZER,OPEN26             NO- ERROR                      45024021
         TM    CURENT+NX6,MQSAM         YES,OK,BUT IS IT QSAM FILE      45030021
       BC      NOTZER,OPEN28             NO- ERROR                      45036021
         TM    CURENT+NX3,MVREC         YES,OK BUT IS RECORD TYPE V     45042021
       BC      ZERO,OPEN30          YES - ERROR                         45048021
       BC    ONES,OPEN29           NO                                   45054021
       OI      MSKOPT,MRVOPT   REVERSED OPTION OK. MODIFY INPUT OPT     45060021
       BC      UNCOND,OPEN20    SEE IF  'NO REWIND' FOLLOWS             45066021
OPEN25A CLI   MSKOPT,MIOOPT        FILE OPENED I/O                      45072021
         BE    OPEN33         DO NOT SEEK ADDNL OPTIONS                 45078021
         CLC   GOTTEN(LX2),CBLEAVE  IS IT 'LEAVE'                       45084021
        BNE    *+NX12              NO                                   45090021
       OI    MSKOPT,MLEAVE         SIGNAL 'LEAVE' FOUND                 45096021
       B     OPEN34                PREPARE TO PUT OUT STRING            45102021
         CLC   GOTTEN(LX2),CBRERD    IS IT REREAD                       45108021
        BNE    *+NX12              NO                                   45114021
       OI    MSKOPT,MRERD          SIGNAL 'REREAD' FOUND                45120021
       B     OPEN34                PREPARE TO PUT OUT STRING            45126021
         CLC   GOTTEN(LX2),CBDISP     IS IT OPEN DISP                   45132021
         BNE   OPEN33         NO                                        45138021
       OI    MSKOPT,MDISP          SIGNAL 'DISP' FOUND                  45144021
       B     OPEN34                GO TO PUT OUT STRING                 45150021
OPEN25B  CLC   GOTTEN(LX2),CBDISP                                       45156021
         BNE   OPEN25C             NOT DISPLAY                          45162021
       TM    MSKOPT,MREEL       DISP FOUND- MAKE SURE NOT REEL          45168021
         BO    OPEN25D             YES - ERROR                          45174021
       OI    MSKOPT,MDISP                                               45180021
         B     OPEN34              OK - PROCESS                         45186021
OPEN25C  CLC   GOTTEN(LX2),CBPOSN   IS IT 'POSITIONING'                 45192021
       BNE   OPEN27              NO OPTIONS SEE IF REEL                 45198021
       TM    MSKOPT,MREEL      POSITIONING- MUST BE REEL                45204021
       BZ    OPEN25D               GO TO PROCESS ERROR                  45210021
       B     OPEN34                GO TO GENERATE STRING                45216021
OPEN27 TM    MSKOPT,MREEL                                               45222021
         BNO   OPEN32A             GO TO SET REWIND               52742 45228021
OPN28P   OI    MSKOPT,XX20         CLOSE REEL (LOCK)-------FEOV LEAVE   45234021
       B     OPEN33                GO TO GENERATE STRING                45240021
OPEN25D BAL   RCS,ERROR            ERROR                                45246021
       LA    RW1,ELST35                                                 45252021
       B    OPEN17                 LOOK FOR ANOTHER FILE                45258021
*                                                                       45264021
*              ERROR FOUND IN OPTIONS-NO USE CONTINUING                 45270021
*                WRITE MSG AND RETURN TO SEEK NEXT FILE                 45276021
*                                                                       45282021
OPEN26   BC    NOTONE,*+NX12       GO TO GET OPTION IN ERROR            45288021
       LA      RW2,CBOUTP          RW2 POINTS TO 'OUTPUT'               45294021
       BC      UNCOND,OPEN31       ERROR                                45300021
       LA    RW2,CBIO              RW2 POINTS TO 'I-O'                  45306021
       BC      UNCOND,OPEN31       ERROR                                45312021
OPEN28 LA    RW2,BCDNOQ            RW2 POINTS TO 'INPUT'                45318021
       BC      UNCOND,OPEN31       ERROR                                45324021
OPEN29 LA    RW2,BCDSPN                                                 45330021
         B     OPEN31             S MODE                                45336021
OPEN30 LA    RW2,BCDVMD                                                 45342021
OPEN31 LA      RA0,CBRVRS                                               45348021
       BAL     RCS,E28OPN          GO TO PROCESS ERROR                  45354021
       LA      RW1,ELST28                                               45360021
       BC      UNCOND,OPEN17      LOOK FOR ANOTHER FILE                 45366021
*                                                                       45372021
*      OPTIONS FOLLOWING FILE-NAME OK. SHALL FILE GO TO STRING          45378021
*       (IF NOT, MSG ALREADY WRITTEN BY PHASE 2 OR ISOKFL)              45384021
OPEN34 BAL   RCS,GETNXT            GET NEXT ELEMENT                     45390021
       B     OPEN33                GO TO PUT OUT STRING                 45396021
OPEN32A OI    MSKOPT,MRWND             REWIND                           45402021
*DEL                                                                    45408021
*DEL                                                                    45414021
OPEN33 TM    SKIPSW,MSWON       WAS SECTION LEGAL                       45420021
       BC      ONES,OPN18X         NO - SEEK NEXT FILE                  45426021
*                                                                       45432021
*              NO ERRORS FOUND. ADD THIS FILE TO STRING                 45438021
*                                                                       45444021
         OC    CURENT+NX2(LX1),MSKOPT PUT OPTION BITS INTO FN           45450021
       LA      RW4,CURENT         STORE FN                              45456021
       BAL     RCS,STO545          STORE FN IN STRING                   45462021
       OI      SENDSW,MSWON       INDICATE SOME OUTPUT TO GENER         45468021
       BC      UNCOND,OPN18X         SEEK NEXT FILE                     45474021
*                                                                       45480021
*                   CHECK IF WE ARE IN SERCH                            45486021
*                                                                       45492021
OPEN37 DS    0H                                                         45498021
         TM    SEARCHSW,MSWON        ARE WE IN SEARCH                   45504021
         BZ    OPEN40               NO                                  45510021
         CLC   GOTTEN(LX2),CBWHEN         IS IT WHEN                    45516021
         BE    OPEN39             YES                                   45522021
         B     OPEN40                 NO                                45528021
*                                                                       45534021
*             'INPUT','OUTPUT',OR 'I-O' NOT FOUND WHERE QUERIED         45540021
*                                                                       45546021
OPEN38 BAL     RCS,ISEND          IS THIS END OF STATEMENT              45552021
         BC    UNCOND,OPEN37              NO                            45558021
OPEN39   DS    0H                                                       45564021
       NI      MSGSW,MSWOFF                                             45570021
       TM      SENDSW,MSWON         YES - IS THERE ANY GOOD OUTPUT      45576021
       BC      ZERO,IDENT             NO (IDENT WILL WRITE MSG)         45582021
       NI      SENDSW,MSWOFF      OFF SWITCH FOR SAFETY                 45588021
       BAL     RCS,GNTWIC         GENERATE WHOLE STRING TWICE           45594021
       BC      UNCOND,IDENT        EXIT                                 45600021
*                                                                       45606021
*      SOME UNACCEPTABLE INPUT HAS TURNED UP                            45612021
*                                                                       45618021
OPEN40 TM      OPTSW,MSWON        WAS AN OPTION EVER FOUND              45624021
       BC      ZERO,OPEN42             NO - KEEP LOOKING                45630021
       OI      PFNDOP,MSWON            YES                              45636021
       BAL     RCS,ERONCE              WRITE MSG ONLY ONCE              45642021
       LA      RW1,ELST2A                                               45648021
       BC      UNCOND,OPEN17      GO SEEK FILE-NAME                     45654021
OPEN42 BAL     RCS,ERONCE         WRITE MSG ONLY ONCE                   45660021
       LA      RW1,ELST29                                               45666021
       BAL     RCS,GETNXT          GET NEXT ELEMENT                     45672021
       BC      UNCOND,OPEN5       GO SEEK OPTION                        45678021
*                                                                       45684021
*     FILE FOUND IS A SORT FILE  WRITE MSG AND EXIT                     45690021
*                                                                       45696021
FILERR  LA    RA0,BCDOP                                                 45702021
       BAL   RCS,ERROR             WRITE ERROR MESSAGE                  45708021
       LA    RW1,ELST6B                                                 45714021
       BC    UNCOND,OPEN17         LOOK FOR ANOTHER FILE                45720021
*              LOCAL SUBROUTINE TO FILL IN ELST28 AND WRITE MSG         45726021
*                                                                       45732021
E28OPN EQU     *                                                        45738021
       STM     RIN,RCS,SVE28       SAVE REGISTERS                       45744021
       LR      RIN,RW2                                                  45750021
       BAL     RCS,ERROR           WRITE ERROR MSG                      45756021
       LA      RW1,ELST28                                               45762021
       OI      SKIPSW,MSWON                                             45768021
       OI    GENRED,MSWON                                               45774021
       LM      RIN,RCS,SVE28                                            45780021
         BCR   UNCOND,RCS          RETURN TO MAINLINE                   45786021
       EJECT                                                            45792021
*                                                                       45798021
*                                                                       45804021
*                 R E A D / W R I T E / R E W R I T                     45810021
*                                                                       45816021
*                                                                       45822021
*** STRINGS PRODUCED                                                    45828021
*      AFTER VERB,                                                      45834021
*      1ST ELEMENT IS FILE-NAME                                         45840021
*      2ND            GN ATTACHED TO NEXT STATEMENT                     45846021
*      3RD            DATA-NAME OR LIT FOR 'AFTER ADVANCING'            45852021
*                     GN OF NEXT SENTENCE FOR 'AT END' OR 'INVALID      45858021
*                     GN OF NEXT STATEMENT WHEN NO OPTION               45864021
*      4TH            RECORD-NAME FOR READ                              45870021
*                     DATA-NAME FOR WRITE(REWRITE)-FROM                 45876021
*                     'ZERO' FOR WRITE(REWRITE) WITHOUT 'FROM'          45882021
*      5TH            'ZERO' FOR READ WITHOUT 'INTO'                    45888021
*                     DATA-NAME FOR READ-INTO                           45894021
*                     RECORD-NAME FOR ALL WRITE/REWRITE                 45900021
*                                                                       45906021
*      WHEN DATA-NAME OPTION IS USED, THIS 5-ELEMENT STRING APPEARS     45912021
*       TWICE, WITH A MOVE STRING INTERVENING                           45918021
*      IF DATA-NAME IS SUBSCRIPTED, THE SUBSCRIPT STRING PRECEDES T     45924021
*  FIRST I/O AND MOVE STRINGS, BUT THE SUBSCRIPT-FORM OF THE DN (HE     45930021
*       31) APPEARS ONLY IN THE MOVE STRING. HEADER 30 IS USED IN       45936021
*       THE I/O STRINGS.                                                45942021
*      IF, IN ADDITION, AFTER-ADVANCING HAS A SUBSCRIPTED OBJECT, T     45948021
*       SUBSCRIPT STRING IS REPEATED BEFORE THE SECOND I/O STRING.      45954021
*                                                                       45960021
*   FOR EXAMPLE                                                         45966021
*      SOURCE - READ INFILE AT END GO TO B,ADD ...  . GO ...            45972021
*      OUTPUT - READ INFILE RGN1 RGN2 ZERO LGN1 ADD ...   LGN2 GO .     45978021
*      SOURCE - READ INFILE INTO DN INVALID KEY GO TO B, ADD ...        45984021
*      OUTPUT - READ INFILE RGN1 RGN2 INRCRD DN                         45990021
*               MOVE INRCRD DN                                          45996021
*               READ INFILE RGN1 RGN2 INRCRD DN LGN1 ADD..LGN2 GO..     46002021
*      SOURCE - WRITE OUTFILE ADD ...  .                                46008021
*      OUTPUT - WRITE OUTFILE RGN1 RGN1 ZERO OUTRCRD LGN1 ADD ...       46014021
*      SOURCE - WRITE OUTFILE FROM DN INVALID KEY GO TO B,ADD ... .     46020021
*      OUTPUT - WRITE OUTFILE RGN1 RGN2 DN OUTRCRD                      46026021
*               MOVE DN OUTRCRD                                         46032021
*               WRITE OUTFILE RGN1 RGN2 DN OUTRCRD LGN1 ADD..LGN2..     46038021
*      SOURCE - WRITE OUTFILE AFTER ADVANCING 2 LINES,ADD...            46044021
*      OUTPUT - WRITE OUTFILE RGN1 2 ZERO OUTRCRD LGN1 ADD...           46050021
*                                                                       46056021
*                                                                       46062021
*** SUBROUTINES CALLED                                                  46068021
*      GETNXT,STOVRB,STOINP,STOR45,GETALL,GENLAB,GENSTR,PCHCNT,GETM     46074021
*      RDUCOP,CALCLG,ISOKFL,ISOKMV,ISATND,ERROR                         46080021
*                                                                       46086021
*                                                                       46092021
*** ERROR PROCESSING                                                    46098021
*      IF FILE-NAME NOT FOUND,SKIP TO NEXT STATEMENT                    46104021
*      IF RECORD-NAME NOT FOUND, SKIP TO NEXT STATEMENT                 46110021
*      IF INTO/FROM MISSING BEFORE DATA-NAME, ASSUME THEM               46116021
*      IF VALID DATA-NAME NOT FOUND AFTER INTO/FROM, IGNORE OPTION      46122021
*      IF RECORD-NAME AND DATA-NAME INCOMPATIBLE FOR MOVE,IGNORE OP     46128021
*      IF READ LACKS 'AT END' FOR BSAM,QSAM,OR QISAM FILE DONT GENR     46134021
*      IF READ OR REWRITE HAS BOTH INVALID KEY AND ERROR DECLARATIV     46140021
*        DONT GENR                                                      46146021
*      IF REWRITE BSAM FILE DONT GENR                                   46152021
*      IF PHASE 2 FOUND SERIOUS INCONSISTENCIES IN FILE (ACCESS MET     46158021
*        SET TO F) DONT GENR                                            46164021
*      IF OPERAND OF 'AFTER ADVANCING' ILLEGAL, SUBSTITUTE 1            46170021
*      IF WRITE WITHOUT 'AFTER' FOR FILE WHICH HAS ANY WRITE-AFTER,     46176021
*       ASSUME WRITE AFTER 1                                            46182021
*      IF WRITE WITHOUT 'FROM' FOR APPLY-WRITE-ONLY FILE,DON'T GENR     46188021
*                                                                       46194021
*                                                                       46200021
*** NOTES                                                               46206021
*      INTOSW  ON MEANS DATA-NAME OPTION FOUND                          46212021
*      SKIPSW  ON MEANS SERIOUS ERROR, KEEP SCANNING BUT DONT GENR      46218021
*      OPCLSW  SET OFF TELLS ISOKFL VERB IS READ,WRITE,OR REWRITE       46224021
*      PRECEDING PHASES HAVE INSERTED RECORD-NAME FOR READ AND FILE     46230021
*        NAME FOR WRITE/REWRITE, SO THAT INPUT IS ALWAYS VERB FILE      46236021
       SPACE   3                                                        46242021
*=1    WRITE   VERB                                                     46248021
       USING   *,RVRB                                                   46254021
WRITE  EQU     *                                                        46260021
         LA    RW3,DX4                   RW3=4 MEANS VERB IS WRITE      46266021
       LA      RVRB,REWRIT-WRITE(RVRB)                                  46272021
       USING   REWRIT,RVRB                                              46278021
       BC      UNCOND,REWRT2       PROCESS REWRITE VERB                 46284021
       SPACE   3                                                        46290021
*=1    REWRIT  VERB                                                     46296021
REWRIT EQU     *                        RW3=8 MEANS VERB IS REWRITE     46302021
         LA    RW3,DX8                                                  46308021
REWRT2 LA      RW5,PLEFT                   RW5 POINTS TO DATA-NAME      46314021
       LA      RW6,PRIGHT                  RW6           RECORD-NAM     46320021
       LA      RA0,CBFROM         SET RA0 FOR ERROR MSG                 46326021
       LA      RVRB,READ-REWRIT(RVRB)                                   46332021
       USING   READ,RVRB                                                46338021
       BC      UNCOND,READ2        GO TO STORE THE VERB                 46344021
*=1    READ FOR UPDATE VERB                                             46350021
READUP EQU *              B                                             46356021
       LA    RVRB,READ-READUP(RVRB)                                     46362021
       USING READ,RVRB                                                  46368021
*=1    READ    VERB                                                     46374021
READ   EQU     *                                                        46380021
       SR      RW3,RW3                  RW3=0 MEANS VERB IS READ        46386021
       LA      RW5,PRIGHT                 RW5 POINTS TO DATA-NAME       46392021
       LA      RW6,PLEFT                  RW6           RECORD-NAME     46398021
       LA      RA0,CBINTO         SET RA0 FOR ERROR MSG                 46404021
*                                                                       46410021
*                             INITIALIZE                                46416021
*                                                                       46422021
READ2  BAL     RCS,STOVRB          STORE VERB IN STRING                 46428021
       NI      SKIPSW,MSWOFF     DONT GENER. IF ON                      46434021
       NI      OPCLSW,MSWOFF     USED BY ISOKFL                         46440021
       NI      INTOSW,MSWOFF     TELLS ROUTINE TO EXPECT DATA-NAME      46446021
       NI    SUBADV,MSWOFF                                              46452021
       NI    EOPSW,MSWOFF                                               46458021
         XC    STRCNT(LX2),STRCNT  IF NOT 0 AT END GENR SUBSCRIPTS T    46464021
*                                                                       46470021
*                    FILE-NAME FOLLOWED BY RECORD-NAME EXPECTED         46476021
*                                                                       46482021
       CLI     GOTTEN,MFILE       IS IT FILE (PH1 GIVES FOR WRITE,      46488021
       BC      EQ,READ5           YES                     / WRITE)      46494021
       LA      RA0,BCDFIL          NO - GIVE UP                         46500021
       LTR     RW3,RW3                                                  46506021
       BC      ZERO,IDGVUP        (READ)                                46512021
READ2X   EQU   *                                                        46518021
       LA      RA0,BCDRCN                                               46524021
       BC      UNCOND,IDGVUP      (WRITE)                               46530021
READ5  EQU   *                                                          46536021
         CLI   GOTTEN+NX2,XX89        IS IT A SORT FILE                 46542021
       BE    FILERR1              YES, ERROR                            46548021
       BAL     RCS,ISOKFL         SEE IF OK (TURNS ON SKIPSW IF NOT     46554021
       BAL     RCS,GETALL           FOR REFERENCE                       46560021
       LA      RW2,PSTFLD                                               46566021
READ5A   XC    PSTFLD+NX7(LX2),PSTFLD+NX7 PUT IN CONVENIENT PLACE       46572021
         MVZ   PSTFLD+NX7(LX1),PSTFLD+NX6  ACCESS METHOD                46578021
         MVN   PSTFLD+NX8(LX1),PSTFLD+NX6  VARIABLE INFO                46584021
         TM    PSTFLD+NX7,MQSAM    FOR QSAM, DELETE POSSIBLE            46590021
         BC    NOTZER,*+NX8         WRITE-AFTER-ADVANCING BIT USED O    46596021
         NI    DX3(RIN),XXEF         FOR ERROR CHECKING                 46602021
         NI    DX2(RIN),XX0F       ZERO OUT CT (PH3)                    46608021
       BAL     RCS,STOINP         FILE NAME TO STRING                   46614021
       CH      RW3,N4              WHICH VERB                           46620021
       BC      LO,READ6            READ                                 46626021
       BC      HI,READ5X           REWRITE                              46632021
         TM    DX6(RIN),MBDAM      WRITE - IS IT BDAM REL. REC.         46638021
       BC      NOTONE,READ6        CONTINUE PROCESSING                  46644021
         TM    DX6(RIN),MBDREL     IS IT BDAM REL.                      46650021
       BC    NOTZER,READ6          YES, CONTINUE PROCESSING             46656021
       LA      RA0,BCDBDR                                               46662021
       BC      UNCOND,READ5Y       GO TO PROCESS ERROR                  46668021
READ5X   TM    DX6(RIN),DBDMW       IS IT DIRECT BDAM D FILE            46674021
       BO    READ5Z           YES- WARN ON REWRITE                      46680021
         CLI   PSTFLD+NX7,MBSAM    IS REWRITE FILE BSAM                 46686021
       BC      NOTEQ,READ6          NO - OK                             46692021
       LA      RA0,BCDBSA                                               46698021
READ5Y EQU     *                                                        46704021
       BAL     RCS,ERROR            YES - ERROR, DONT GENR              46710021
       LA      RW1,ELST2E                                               46716021
       OI      SKIPSW,MSWON                                             46722021
READ6  EQU     *                                                        46728021
       OI      SWRONL,MSWON       TELL ISDTOP NO MSG 5E FOR WRITE-O     46734021
       BAL     RCS,GETNXT          IS NEXT RECORD-NAME (PH3 GIVES F     46740021
       BAL     RCS,RDUCOP          IS DATA OPERAND LEGAL   READ)        46746021
       BC      UNCOND,READ7       NO - NPN-OPERAND OR ERSYMB            46752021
       CLI     GOTTEN,MDN                                               46758021
       BC      EQ,READ8             YES - OK                            46764021
READ7  LTR     RW3,RW3             NO - SUBSCRIPT OR MAYBE LITERAL      46770021
       BC      ZERO,READ7X         VERB IS READ - ERROR                 46776021
         LA    RIN,PSTFLD          (WRITE- PH1 DIDNT FIND REC NAME)     46782021
         BC    UNCOND,READ2X       WRITE MESSAGE                        46788021
READ5Z BAL   RCS,ERROR             ERROR                                46794021
       LA    RW1,ELST2B          REWRITE BDAM D FILE                    46800021
       BC    UNCOND,READ6          CONTINUE PROCESSING                  46806021
READ7X BAL     RCS,ERROR          (READ - PH3 DIDNT FIND RECORD         46812021
       LA      RW1,ELST55                                               46818021
       BC      UNCOND,IDERR        ERROR EXIT - GIVE UP                 46824021
READ8  EQU   *                                                          46830021
         MVC   TEMPSP(LX1),GOTTEN+NX2  CHECK TO SEE IF RECORD GOTTEN    46836021
         NI    TEMPSP,XX0F                    IS A LABEL RECORD         46842021
         CLI   TEMPSP,XX05                                              46848021
       BNE   READ8A               NO                                    46854021
       BAL   RCS,ERROR             WRITE OUT ERROR MSG                  46860021
       LA   RW1,ELST2F                                                  46866021
       BC    UNCOND,IDERR          GIVE UP                              46872021
READ8A   NI    DX7(RIN),WRTOLV                                          46878021
         OI    DX7(RIN),MLEV1 SET LEVEL TO 01 IN CASE WRITE-ONLY        46884021
       BAL     RCS,GETALL         SAVE AS SOURCE OR TARGET              46890021
         LA    RW2,DX0(RW6)                                             46896021
         MVC   MODEL-PLEFT(LX2,RW6),MODE  SAVE MODE AND SCALE FOR IS    46902021
         MVC   DMAXL-PLEFT(LX1,RW6),DCURR                               46908021
       BAL     RCS,GETNXT          GET NEXT INPUT                       46914021
       LTR     RW3,RW3                                                  46920021
       BC      NOTZER,READ12       NOT READ, LOOK FOR 'FROM'            46926021
*                                                                       46932021
         CLC   GOTTEN(LX2),CBRCRD  DISCARD 'RECORD' IN READ STATEMEN    46938021
       BC      NOTEQ,READ10        NO, SEEK 'INTO'                      46944021
       BAL     RCS,GETNXT          GET NEXT INPUT                       46950021
*                                                                       46956021
*              COBOL WORD 'INTO'/'FROM' MAY NOW APPEAR                  46962021
*                                                                       46968021
READ10   CLC   GOTTEN(LX2),CBINTO   IS IT INTO                          46974021
       BC      EQ,READ14           YES, TURN ON SWITCH                  46980021
       BC      NOTEQ,READ16        NO, SEE IF VALID DN                  46986021
READ12   CLC   GOTTEN(LX2),CBFROM   IS IT 'FROM'                        46992021
         BC    NOTEQ,READ16        NOT 'FROM' SEEK DN                   46998021
READ14 OI      INTOSW,MSWON      INTOSW ON SAYS IT WAS FOUND            47004021
       BAL     RCS,GETNXT          GET NEXT INPUT                       47010021
*                                                                       47016021
*                   DOES VALID DATA-NAME FOLLOW                         47022021
*                                                                       47028021
READ16 BAL     RCS,RDUCOP          IS IT A VALID OPERAND                47034021
       BC      UNCOND,READ22      NO - NON OPERAND                      47040021
       TM      INTOSW,MSWON       YES - OK,BUT WAS INTO/FROM FOUND      47046021
       BC      ONES,READ20        YES                                   47052021
       BAL     RCS,ERROR          NO - TRIVIAL ERROR                    47058021
       LA      RW1,ELST07                                               47064021
*                                                                       47070021
*                           PROCESS DATA-NAME                           47076021
*                                                                       47082021
READ20 EQU     *                                                        47088021
* MAKE SURE IDENTIFIER IS NOT DEFINED UNDER SAME FD AS RECDNAME         47094021
       CLI   GOTTEN,MSS            WAS DATA NAME SUBSCRIPTED            47100021
       BNE    READ20A              NO-CHECK BLI OF DNM                  47106021
*   FIND I,D,K FIELD OF SS DNM IN DEFSBS TABLE                          47112021
       L    RW1,ADFSBS                                                  47118021
         L     RW1,DX0(RW1)                                             47124021
         L     RW1,DX0(RW1)                                             47130021
         LA    RIN,DX3(RW1)                                             47136021
         B     READ20B             SKIP CHECKING DMN              02268 47142021
READ20A DS    0H                                                        47148021
         CLI   GOTTEN,MDN          IS THIS DATA ITEM              02268 47154021
         BE    READ20B             YES,   PROCESS                 02268 47160021
         B     READ22              NOT DATA ITEM                  02268 47166021
READ20B  DS    0H                                                 02268 47172021
         TM    DX4(RIN),MBLI        IS BASE LOCATOR FOR DNM A BLI       47178021
       BC    NOTZER,READ21         NO-   OK                             47184021
         CLC   DX6(LX1,RIN),PSTFLD+NX4 ARE BL #'S OF FILE AND DNM EQUAL 47190021
       BL    READ21              DNM BL LESS -  OK                      47196021
       BE    READ21A              THEY ARE EQUAL- ISSUE MSG             47202021
*    SEE IF 1ST BL + # OF BL'S FOR FD IN RANGE OF BL FOR DATANAME       47208021
       SR    RW2,RW2                                                    47214021
         IC    RW2,PSTFLD+NX4       RW2 CONTAINS FIRST BL #             47220021
       MVC     TMPSP1+NX3(LX1),N0    ZERO OUT TEMP AREA                 47226021
         MVN   TMPSP1+NX3(LX1),PSTFLD+NX3 MOVE # OF BL'S TO WORK AREA   47232021
       A    RW2,TMPSP1             ADD THEM                             47238021
       ST    RW2,TMPSP1            STORE RESULT IN TMPSP1               47244021
         CLC   TMPSP1+NX3(LX1),DX6(RIN)   COMPARE BL FOR DNM WITH SUM   47250021
       BNH   READ21                OK-NOT DEFINED UNDER SAME FD         47256021
READ21A BAL   RCS,ERROR            WRITE ERROR MSG                      47262021
       LA   RW1,ELST64            ISSUE MSG BUT ACCEPT                  47268021
READ21 DS 0H                                                            47274021
       L     RIN,ACURNT          RESTORE RIN IN CASE SSTABLE REFD       47280021
       BAL     RCS,GETALL            SAVE DATA-NAME AS TARGET FOR R     47286021
         LA    RW2,DX0(RW5)           SOURCE FOR WRITE,REWRITE          47292021
         MVC   MODEL-PLEFT(LX2,RW5),MODE   SAVE ITS MODE AND SCALE      47298021
         MVC   DMAXL-PLEFT(LX1,RW5),DCURR                               47304021
       BAL     RCS,GETNXT          GET NEXT INPUT                       47310021
       BAL     RCS,ISOKMV            ARE SOURCE AND TARGET COMPATIB     47316021
       BC      UNCOND,READ30              NO - DONT USE OPTION          47322021
       BC      UNCOND,READ34              YES                           47328021
*                                                                       47334021
*                           PROCESS ERRORS OF INTO-FROM OPTION          47340021
*                                                                       47346021
READ22 TM      INTOSW,MSWON       WAS COBOL WORD FOUND WITHOUT DN       47352021
       BC      ZERO,READ34          NO - OK                             47358021
       LA      RA0,BCDDN                                                47364021
       BAL     RCS,ERROR            YES - SKIP OPTION BUT PROCESS N     47370021
       LA      RW1,ELST38                         / MALLY               47376021
       TM      GOTTEN,MOP         WAS IT SOME OPERAND OR ERSYMB         47382021
       BC      ZERO,READ30         NO                                   47388021
       BAL     RCS,GETNXT           YES - DISCARD                       47394021
READ30 NI      INTOSW,MSWOFF                                            47400021
*                                                                       47406021
*              GET GN OF NEXT STATEMENT FOR ALL VERBS                   47412021
*                                                                       47418021
READ34 BAL     RCS,PUPLGN          GET NEW GN NO.                       47424021
         MVC   GNX(LX2),NXTLGN      SAVE TO GENR AT POINT OF DEF.       47430021
         MVC   GNREF+NX1(LX2),NXTLGN                                    47436021
       LA      RW4,GNREF                                                47442021
       BAL     RCS,STOR45          STORE IN STRING AS 2ND ELEMENT       47448021
*                                                                       47454021
*              BRANCH TO SEEK APPROPRIATE 2ND OPTION                    47460021
*                                                                       47466021
         CLI   PSTFLD+NX7,MBISAM    IS FILE BISAM OR BDAM               47472021
       BC      EQ,READ38           YES, SEEK 'VALID KEY'                47478021
         CLI   PSTFLD+NX7,MBDAM                                         47484021
       BC      EQ,READ38           YES -SEEK 'INVALID KEY'              47490021
         BC    UNCOND,*+NX4(RW3)    NO                                  47496021
       BC      UNCOND,READ42           FOR READ SEEK 'AT END'           47502021
         BC    UNCOND,*+NX8        CHECK IF FILE QSAM                   47508021
       BC      UNCOND,READ44           FOR REWRITE NO OPTIONS           47514021
         TM    PSTFLD+NX7,MQSAM                   QSAM                  47520021
       BC    NOTZER,READ38      NO- SEEK INVALID KEY                    47526021
         CLC   GOTTEN(LX2),CBAFTR       YES - IS OPTION 'AFTER'         47532021
       BC      EQ,READ35           YES                                  47538021
         CLC   GOTTEN(LX2),CBEFOR IS IT BEFORE                          47544021
       BE    READ35A               YES, GO TO BEFORE/AFTER RTN          47550021
         TM    PSTFLD+NX8,ADVNCNG NO-WAS ANY ADV OPT EVER USED          47556021
       BZ    READ36                NO- OK IF POSN NOT USED              47562021
       LA    RIN,CBADV                                                  47568021
       BO    BEFSUB           BOTH USED-MAKE BEFORE                     47574021
         TM    PSTFLD+NX8,AFTADV AFTER                                  47580021
       BZ    BEFSUB                MAKE BEFORE                          47586021
       LA    RA0,CBAFTR                                                 47592021
       B     ADVERR                GO TO PROCESS ERROR                  47598021
BEFSUB LA    RA0,CBEFOR                                                 47604021
ADVERR BAL   RCS,ERROR             WRITE MESSAGE                        47610021
       LA      RW1,ELST5D                                               47616021
       LA    RIN,NUMLT1                                                 47622021
       OI    NEXTIN,MSWON                                               47628021
       OI    SUBADV,MSWON                                               47634021
       LA    RW1,CBEFOR                                                 47640021
       CR    RW1,RA0               WAS IT 'BEFORE'                      47646021
       BE    READ35A          YES-SET BIT ON IN FILE                    47652021
       B     READ62                GO TO PROCESS N OF AFTER ADV.        47658021
*                                                                       47664021
*                        'BEFORE OR AFTER' FOUND (WRITE)                47670021
*                                                                       47676021
READ35A  TM    PSTFLD+NX8,XX04      POSN EVER USED                      47682021
       BO    READ35B         ERROR                                      47688021
       L    RW1,ASTRNG       BEFORE- TURN BIT ON IN FILE                47694021
        BAL  RCS,GOBACK            ADDR OF 2ND ENTRY FROM END           47700021
       DC    XL2'2'                                                     47706021
       L     RW2,ADNTRY                                                 47712021
         OI    DX2(RW2),BEFBIT                                          47718021
       TM    SUBADV,MSWON     WAS  BEFORE SUBSTITUTED                   47724021
       BO    READ62           YES                                       47730021
READ35 BAL     RCS,GETNXT          NO, GET NEXT INPUT                   47736021
         CLC   GOTTEN(LX2),CBPOSN     IS IT POSITIONING                 47742021
       BE    WRPOSN                YES                                  47748021
         TM    PSTFLD+NX8,XX04      NO-BUT WAS POSN EVER USED           47754021
        BZ     *+NX16              NO PROCESS ADV                       47760021
READ35B LA    RA0,CBAFTR                                                47766021
       LA    RIN,CBPOSN                                                 47772021
       B     ADVERR                GO TO PROCESS ERROR                  47778021
       LA    RW2,ELST2D                                                 47784021
         CLC   GOTTEN(LX2),CBADV    IS IT 'ADVANCING'                   47790021
         BC    NOTEQ,*+NX8         NO                                   47796021
       BAL     RCS,GETNXT         DISCARD 'ADVANCING'                   47802021
       CLI   GOTTEN,CARGCN   MNEMONIC NAME                              47808021
       BE    READ62            YES-OK                                   47814021
       BAL   RCS,RDUCOP            SEE IF VALID OP                      47820021
       B     READ60                NO                                   47826021
       BAL   RCS,ISINT2            YES- BUT IS IT INTEGER               47832021
       B     READ60            NOT INTEGER                              47838021
       TM    MODE,MLITBT      IS  IT  NUM.LITERAL                       47844021
       BZ    READ62                NO, GO TO PROC N OF AFTER ADV        47850021
         CLI   GOTTEN+NX2,XX03 MORE  THAN 2 DIGITS                      47856021
       BL    READ62           NO-OK                                     47862021
       B     READ60           ERROR                                     47868021
WRPOSN BAL   RCS,GETNXT            GET NEXT INPUT                       47874021
       LA    RW2,ELST33                                                 47880021
       BAL   RCS,RDUCOP            IS IT A VALID OPERAND                47886021
       BC      UNCOND,READ58        NO -ERROR,MAKE IT 1                 47892021
         CLC   GOTTEN(LX4),INTG1L    IS IT 1-DIGIT NUMERIC LITERAL      47898021
       BC      EQ,READ56            YES                                 47904021
         CLC   MODE(LX2),DNANMD    IS IT ALPHANUMERIC DATA-NAME         47910021
       BC      NOTEQ,READ60         NO - ERROR MAKE IT 1                47916021
*                           ALPHANUMERIC DATA-NAME                      47922021
       BAL     RCS,CALCLG         IS LENGTH 1                           47928021
         BC    UNCOND,*+NX4        CHECK IF LENGTH = 1                  47934021
         CLC   LENGTH(LX4),N1-NX2                                       47940021
       BC      NOTEQ,READ60        NO - MAKE OPERAND NLIT 1             47946021
       BC      EQ,READ62           GO TO PROCESS N OF AFTER ADV         47952021
*                           NUMERIC LITERAL                             47958021
READ56 SR      RW4,RW4                                                  47964021
         IC    RW4,DX4(RIN)                                             47970021
         SRA   RW4,DX4                                                  47976021
       SH      RW4,N4             IS IT MORE THAN 3                     47982021
       BC      NEG,READ62           NO - OK                             47988021
       BC      NOTNEG,READ60        YES-ERROR, MAKE IT 1                47994021
READ36   TM    PSTFLD+NX8,XX04                                          48000021
       BZ    READ38           SEE IF INVALID KEY                        48006021
       B     READ35B            WAS USED- ERROR                         48012021
*              SUBSTITUTE 1 FOR ILLEGAL N TIMES                         48018021
READ58 OI      NEXTIN,MSWON       DONT DISCARD NON-OPERAND              48024021
READ60 BAL     RCS,ERROR           ISSUE ERROR MESSAGE                  48030021
         LA    RW1,DX0(RW2)          PT RW1 TO RIGHT ERRMSG             48036021
       LA      RIN,NUMLT1         SET INPOINTER TO 1                    48042021
*                                                                       48048021
*                           PROCESS N OF 'AFTER ADVANCING'              48054021
*                                                                       48060021
READ62   TM    PSTFLD+NX8,MAPP5                                         48066021
       BC    NOTONE,READ62X        GO TO STORE INPUT                    48072021
       L     RW1,ASTRNG       TURN OFF APPLY WRITE ONLY BIT             48078021
       BAL   RCS,GOBACK            ADDR OF 2ND ENTRY FROM END           48084021
       DC    XL2'2'                                                     48090021
       L    RW2,ADNTRY                                                  48096021
*DEL                                                                    48102021
         NI    PSTFLD+NX8,XXDF                                          48108021
READ62X BAL  RCS,STOINP            STORE INPUT IN STRING                48114021
       CLI     GOTTEN,MSS         IS DN SUBSCRIPTED                     48120021
         BC    NOTEQ,*+NX10        NO, GO TO GET NEXT                   48126021
         MVC   STRCNT(LX2),DSPSBS   YES, MIGHT NEED TO GENR SS TWICE    48132021
       BAL     RCS,GETNXT          GET NEXT INPUT                       48138021
         CLC   GOTTEN(LX2),CBLINE   IS IT 'LINE'                        48144021
       BC    NOTEQ,READ45          NO, CHECK FOR EOP                    48150021
       BAL     RCS,GETNXT         DISCARD 'LINES' IF PRESENT            48156021
     B     READ45                 CHECK FOR EOP                         48162021
       BC      UNCOND,READ46      GO FINISH STRING                      48168021
*                                                                       48174021
*                           'INVALID KEY' OPTIONAL HERE                 48180021
*                                                                       48186021
READ38   CLC   GOTTEN(LX2),CBINVL  IS IT INVALID                        48192021
       BC      NOTEQ,READ44         NO -NO OPTIONS                      48198021
       BAL     RCS,GETNXT          GET NEXT INPUT                       48204021
         CLC   GOTTEN(LX2),CBKEY    IS IT 'KEY'                         48210021
         BC    NOTEQ,*+NX8         NO                                   48216021
       BAL     RCS,GETNXT         DISCARD 'KEY' IF PRESENT              48222021
READ40 OI      NEXTIN,MSWON       VALID 'INVALID KEY' -- TREAT LIKE     48228021
       LA      RIN,CBEND            'AT END'                            48234021
         LA    RA0,CBINVL          SET RA0 FOR POSSIBLE MSG             48240021
       BC      UNCOND,RED42X       GO TO 'AT END' RTN                   48246021
*                                                                       48252021
*                           'AT END' REQUIRED HERE                      48258021
*                                                                       48264021
READ42 LA      RA0,CBEND          SET RA0 FOR POSSIBLE MSG              48270021
RED42X   BAL   RCS,ISATND          SET UP AND STORE BRANCH              48276021
       BC      UNCOND,READ43      NOT FOUND                             48282021
       BC      UNCOND,READ46       GO FINISH STRING                     48288021
READ43 OI      TEMPSW,MSWON       EXTRA GNDEF FOR READ66                48294021
       BAL     RCS,PUPLGN            CREATE PHONY NOT-AT-END BRANCH     48300021
         MVC   GNREF+NX1(LX2),NXTLGN                                    48306021
       LA      RW4,GNREF                                                48312021
       BAL     RCS,STOR45          STORE GN IN STRING                   48318021
       BC      UNCOND,READ46       GO FINISH STRING                     48324021
*                                                                       48330021
*                    NOT 'INVALID KEY', 'AT END', OR 'AFTER ADVANCI     48336021
*                                                                       48342021
READ44 LA      RW4,GNREF          STORE GNX (NEXT STATEMENT) AGAIN      48348021
       BAL     RCS,STOR45          STORE GN IN STRING                   48354021
READ45   TM    PSTFLD+NX7,MQSAM    QSAM FILE                            48360021
       BC    NOTZER,READ46        NO                                    48366021
         CLC   GOTTEN(LX2),CBAT      IS IT AT EOP                       48372021
       BNE   *+8                   OPTION                               48378021
       BAL   RCS,GETNXT            GET NEST INPUT                       48384021
         CLC   GOTTEN(LX2),CBEOP    IS IT 'END-OF-PAGE' (EOP)           48390021
       BNE   READ46                NO, GO FINISH STRING                 48396021
       BAL   RCS,ISTRUV            SEE IF CONDITION ALLOWED HERE        48402021
       BAL   RCS,GETNXT            GET NEXT INPUT                       48408021
       OI    EOPSW,MSWON                                                48414021
*                                                                       48420021
*                                 FINISH STRINGS AND EXIT               48426021
*                                                                       48432021
READ46 TM      INTOSW,MSWON       WAS THERE DATA-NAME OPTION            48438021
       BC      ONES,READ48          YES                                 48444021
         TM    PSTFLD+NX8,MAPP5     NO - IS THIS A WRITE-ONLY FILE      48450021
       BC      NOTONE,READ47          NO                                48456021
         TM    PSTFLD+NX7,MQSAM    IS IT A QSAM FILE                    48462021
       BC    NOTZER,READ47         NO                                   48468021
       CH      RW3,N4             IS VERB WRITE                         48474021
       BC      NOTEQ,READ47         NO                                  48480021
       BAL     RCS,ERROR           YES - ILLEGAL                        48486021
       LA      RW1,ELST5F                                               48492021
       OI      GENRED,MSWON        AVOID 'INCOMPLETE' MESSAGE           48498021
       BC      UNCOND,READ66       DISCARD STATEMENT                    48504021
READ47 LTR   RW3,RW3              WHICH VERB                            48510021
       BC      NOTZER,RED47X       WRITE OR REWRITE                     48516021
         MVC   PRIGHT(LX2),CBZERO     READ - PUT DUMMY IN TARGET FIE    48522021
       BC      UNCOND,READ49       GO TO STORE PLEFT, PRIGHT            48528021
RED47X   MVC   PLEFT(LX2),CBZERO    WRITE - PUT DUMMY IN SOURCE FIEL    48534021
       BC      UNCOND,READ49       GO TO STORE PLEFT, PRIGHT            48540021
READ48   MVC   TEMP(LX1),DX0(RW5)   SAVE DN HEADER                      48546021
         MVI   DX0(RW5),MDN        REPLACE POSSIBLE SS BY DN IN I/O     48552021
READ49 LA      RW4,PLEFT          STORE SOURCE FIELD                    48558021
       BAL     RCS,STOR45          STORE PLEFT IN STRING                48564021
READ50 LA      RW4,PRIGHT         STORE TARGET FIELD                    48570021
       BAL     RCS,STOR45          STORE PRIGHT                         48576021
*                                                                       48582021
READ52 TM      SKIPSW,MSWON                                             48588021
       BC      ONES,READ66        DONT GENR AFTER FILE ERROR            48594021
       TM      INTOSW,MSWON       WAS THERE DATA-NAME OPTION            48600021
       BC      ZERO,READ64          NO                                  48606021
       TM    EOPSW,MSWON           WAS EOP FOUND                        48612021
       BZ    READ53                NO   -     OK                        48618021
       BAL   RCS,EOPROC            PROCESS AT EOP                       48624021
READ53 DS    0H                                                         48630021
         MVC   DX0(LX1,RW5),TEMP    RESTORE ORIGINAL DN HEADER          48636021
*                                       MODIFIED AT READ48              48642021
         MVC   STO5VE(LX2),DSPSTR    YES - SAVE PRESENT STRING DISPL    48648021
         MVC   TEMP(LX2),DSPSBS     SAVE PRESENT SBS DISPL.             48654021
       BAL     RCS,GENSTR          GENR I-O VERB                        48660021
         MVC   DSPSBS(LX2),TEMP     RESTORE SBS DISPL                   48666021
       L       RW1,ADFSBS          RESTORE TAMM DISPL OF DEFSBS         48672021
         L     RW1,DX0(RW1)          TO GENR SUBSCRIPTS ONCE MORE       48678021
         MVC   DX4(LX2,RW1),TEMP                                        48684021
         MVC   ATIB(LX4),ADFSBS                                         48690021
       OI      NOTRAL,MSWON                                             48696021
       BAL     RCS,GENALL          GENR SUBSCRIPTS                      48702021
       NI    NOTRAL,MSWOFF                                              48708021
       BAL     RCS,GENDAT          CREATE AND GENR MOVE STRING          48714021
       LA      RW2,MOVEVB             MOVE                              48720021
       BAL     RCS,GENDAT          WRITE MOVE TO FILE                   48726021
       LA      RW2,PLEFT              SOURCE                            48732021
       BAL     RCS,GENDAT          WRITE SOURCE FIELD TO FILE           48738021
       LA      RW2,PRIGHT             TARGET                            48744021
       L       RW1,ASTRNG          WRITE TARGET FIELD TO FILE           48750021
         L     RW1,DX0(RW1)        RESTORE TAMM DISPL. TO GENR ONLY     48756021
         MVC   DX4(LX2,RW1),STO5VE     I-O STRING ONCE MORE             48762021
         MVC   DSPSTR(LX2),STO5VE                                       48768021
         CLC   STRCNT(LX2),N0      WAS AFTER ADVANCING DN SUBSCRIPTE    48774021
       BC      EQ,READ64            NO                                  48780021
       L       RW1,ADFSBS         YES - RESTORE TAMM DISPL OF DEFSB     48786021
         L     RW1,DX0(RW1)          TO GENR SUBSCRIPTS ONCE MORE       48792021
         MVC   DX4(LX2,RW1),STRCNT                                      48798021
         MVC   DSPSBS(LX2),STRCNT                                       48804021
READ64 EQU     *                                                        48810021
       TM    EOPSW,MSWON                                                48816021
       BZ    READ65                GO GENR STRING                       48822021
       TM    INTOSW,MSWON          WAS STRING ALREADY GENERATED         48828021
       BO    READ65                YES- EOP HAS ALREADY BEEN PROCESSED  48834021
       BAL   RCS,EOPROC            NO- GO PROCESS                       48840021
READ65 BAL   RCS,GENSTR            GENERATE STRING                      48846021
       TM    EOPSW,MSWON                                                48852021
       BC    NOTONE,READ66         NOT ON, GO GENR LABEL(S)             48858021
         MVC   NXTSNT(LX2),GNX                                          48864021
         MVC   GNX(LX2),RGN+NX1                                         48870021
READ66 EQU     *                                                        48876021
       OI    GENRED,MSWON                                               48882021
         MVC   GNDEF+NX1(LX2),GNX   GENR LABEL FOR NEXT STATEMENT       48888021
       BAL     RCS,GENLAB          PUT OUT LABEL                        48894021
       TM      TEMPSW,MSWON       IS EXTRA GN NEEDED FOR ERROR CASE     48900021
       BC    ZERO,READ80           NO                              5965 48906021
       NI      TEMPSW,MSWOFF        YES - PUT IT OUT                    48912021
         MVC   GNDEF+NX1(LX2),NXTLGN                                    48918021
       BAL     RCS,GENLAB          GENERATE LABEL                       48924021
READ80 DS    0H                                                    5965 48930021
       CLC   GOTTEN(LX2),CBINVL    IS IT 'INVALID'                 5965 48936021
       BNE   IDENT                 NO, EXIT                        5965 48942021
       CLI   PSTFLD+NX7,MQSAM      QSAM FILE ?                     5965 48948021
       BE    READ85                YES                             5965 48954021
       CLI   PSTFLD+NX7,MQISAM     QISAM FILE ?                    5965 48960021
       BNE   IDENT                 EXIT                            5965 48966021
READ85 DS    0H                                                    5965 48972021
       BAL   RCS,ERROR             WRITE ERROR MESSAGE             5965 48978021
       LA    RW1,ELST8D                                            5965 48984021
READ90 DS    0H                                                    5965 48990021
       BAL   RCS,GETNXT            DISCARD TILL EOS                5965 48996021
       CLC   GOTTEN(LX2),CBEOS     IS IT EOS                       5965 49002021
       BNE   READ90                LOOP BACK                       5965 49008021
       B     IDENT                 EXIT                            5965 49014021
*                                                                       49020021
*      FILE FOUND IS A SORT FILE  WRITE MSG AND EXIT                    49026021
*                                                                       49032021
FILERR1 LA    RA0,BCDRD                                                 49038021
       BAL   RCS,ERROR             ISSUE ERROR MSG                      49044021
       LA    RW1,ELST6B                                                 49050021
       BC    UNCOND,IDERR          ERROR EXIT                           49056021
         EJECT                                                          49062021
*=1    IDENT   PHASE-CONTROLER                                          49068021
       SPACE   10                                                       49074021
IKF401 CSECT                                                            49080021
COMON1 EQU     *                                                        49086021
*******************************************************************     49092021
*                                                                       49098021
*                                                                       49104021
*                      P H A S E - C O N T R O L L E R                  49110021
*                                                                       49116021
*                                                                       49122021
*                                                                       49128021
*                                                                       49134021
*      PROCESSES PROGRAM-BREAKS,VERBS,AND PROCEDURE-NAMES AT POINT      49140021
*        DEFINITION                                                     49146021
*                                                                       49152021
*      LOGICALLY IT IS DIVIDED INTO 4 SECTIONS                          49158021
*                                                                       49164021
*              1. PHINIT - INITIALIZATION. LOADS COMMON BASE REGIST     49170021
*                          (IS AT END OF CONSTANT SECTION, IN ORDER     49176021
*                            KEEP ALL ADCONS IN CSECT4)                 49182021
*                          ESTABLISHES EXTERNAL ADDRESSES, PRIMES T     49188021
*                          TABLES, OPENS FILES, AND READS 1ST RECOR     49194021
*              2. IDENT  - HANDLES PROGRAM-BREAKS, LINKS BETWEEN VE     49200021
*                          DOES INITIALIZATION FOR VERB ANALYZERS.      49206021
*                          VERBS RETURN TO IDENT AFTER PROCESSING T     49212021
*                          OPTIONS AND OPERANDS                         49218021
*              3. IDLHN  - HANDLES PROCEDURE-NAMES AT POINT OF DEFI     49224021
*                          TION.                                        49230021
*              4. EOF    - FINAL HOUSEKEEPING. RELEASES TAMER TABLE     49236021
*                          CLOSES FILES, CALLS PHASE 5.                 49242021
*                                                                       49248021
*                                                                       49254021
*** SUBROUTINES CALLED                                                  49260021
*      VERB ANALYZERS                                                   49266021
*      COS,TABREL                                                       49272021
*      GETNXT,GETALL,COPYIN,GENDAT,GENCRD,GNXTST,ISEND,THROWE,PUPVN     49278021
*      PNSRTF,SRCHTB,PZSTRT,GETPVN,PACKTB,ERROR                         49284021
*                                                                       49290021
*                                                                       49296021
*                                                                       49302021
*                                                                       49308021
*                                                                       49314021
*******************************************************************     49320021
       SPACE   5                                                        49326021
       EJECT                                                            49332021
*******************************************************************     49338021
*                                                                       49344021
*                           I D E N T                                   49350021
*                                                                       49356021
*** ENTRY POINTS                                                        49362021
*      IDENT - NORMAL                                                   49368021
*      IDCOND - WHEN NEXT STATEMENT MUST BE IMPERATIVE                  49374021
*      IDERR - WHEN ANALYZER HAS WRITTEN A MESSAGE THAT IT IS SKIPP     49380021
*                STATEMENT AND NO FURHTER ERROR MESSAGES ARE WANTED     49386021
*      IDGVUP - WHEN ANALYZER GIVES UP WITHOUT WRITING OWN MSG          49392021
*                                                                       49398021
*** EXIT POINTS                                                         49404021
*      VERB ANALYZERS, COS TO PHASE 5                                   49410021
*                                                                       49416021
*                                                                       49422021
*** ERROR PROCESSING                                                    49428021
*      IF INPUT ELEMENT IS NOT VERB, BREAK, OR PNDEF, DISCARD TILL      49434021
*        OF THESE IS FOUND                                              49440021
*      IF SWITCH 'GENRED' IS OFF -- MEANING PRECEDING VERB DID NOT      49446021
*        PRODUCE ITS EXPECTED STRINGS -- CONSIDER STATEMENT INCOMPL     49452021
*        AND WRITE MSG                                                  49458021
*      IF EOS OR 'ELSE' IMMEDIATELY FOLLOWS A CONDITION ('TRUVRB'       49464021
*        SWITCH ON), WARN STATEMENT INCOMPLETE                          49470021
*                                                                       49476021
*                                                                       49482021
*******************************************************************     49488021
       SPACE   3                                                        49494021
SUPER4 EQU     *                                                        49500021
*                                                                       49506021
*                                                                       49512021
IDENT  EQU   *                                                          49518021
       TM    SEARCHSW,MSWON                                             49524021
       BO    CALLSRCH              SEARCH SW ON                         49530021
         NI    SETSW,MSWOFF        TURN OFF  SET SW               58940 49536021
       BAL     RCS,ISEND          IS WORD AN ENDWORD OF ANY KIND        49542021
       BC      UNCOND,IDER4       NO - ERROR                            49548021
       TM      GENRED,MSWON       HAS STATEMENT BEEN GENERATED          49554021
       BC      ZERO,IDER2         IF NO,ERROR                           49560021
*                                                                       49566021
ID3    EQU     *                                                        49572021
       CLI     GOTTEN,MVERB       IS ENTITY VERB                        49578021
       BC    EQ,ID5                YES                                  49584021
       OI      GENRED,MSWON       AVOID FURTHER 'INCOMPLETE' MESSAG     49590021
       CLI     GOTTEN,MPND        IS IT LHN                             49596021
       BC      EQ,IDLHN            YES                                  49602021
       CLI     GOTTEN,MBREAK                                            49608021
       BC      EQ,IDBRK            IS IT A BREAK                        49614021
       CLI     GOTTEN,MLGN        IS IT LGN (Q-ROUTINE VERBS)           49620021
       BC      NOTEQ,IDER4           NO - ERROR                         49626021
       BAL     RCS,GENCRD         GENR CARDNUM IF FROM REPORT WRITE     49632021
       TM    PGMBRK+NX1,MSWON  LGN FOLLOWS END OF DECL. ?          7898 49638021
       BZ      ID40           NO, GENR GNDEF                       7898 49644021
       MVC   GNSV2+NX1(LX2),DX1(RIN)  SAVE INPUT - GNDEF           7898 49650021
       BC    UNCOND,ID41      GET NEXT INPUT                       7898 49656021
ID40   DS    0H                                                    7898 49662021
       BAL   RCS,COPYIN       WRITE FROM CURRENT INPUT             7898 49668021
ID41   DS    0H                                                    7898 49674021
       BAL     RCS,GETNXT          GET NEXT INPUT                       49680021
       BC      UNCOND,IDENT        RETURN                               49686021
*                                                                       49692021
*                           PROGRAM BREAK FOUND                         49698021
*                                                                       49704021
IDBRK  EQU     *                                                        49710021
         CLI   GOTTEN+NX1,MENDCL    IS IT END DECL.                     49716021
       BC      NOTEQ,IDBRK2        NO                                   49722021
         OI    PGMBRK+NX1,MSWON  YES- DEFER STORING TILL IDLHN CLEAN    49728021
       BAL     RCS,GETNXT          GET NEXT INPUT                       49734021
       BC      UNCOND,ID3          RETURN FOR NEXT                      49740021
IDBRK2 EQU     *                                                        49746021
       CLI     PGMBRK,MDECL       WAS LAST BREAK 'DECLARATIVES'         49752021
       BC      NOTEQ,IDBRK4         NO                                  49758021
         CLI   GOTTEN+NX1,SEGBK                                         49764021
       BNE     IDBRK3              NOT SEGMENTATION CONTROL BLOCK       49770021
       BAL     RCS,GETNXT          GET NEXT INPUT                       49776021
       B     IDLHN                 LHN FOUND                            49782021
IDBRK3 BAL   RCS,ERROR             WRITE MESSAGE                        49788021
       LA      RW1,ELST57              MISSING                          49794021
IDBRK4   CLC   GOTTEN(LX2),EOFWD                                        49800021
       BC      EQ,EOF             EXIT FOR EOF                          49806021
         MVC   PGMBRK(LX1),GOTTEN+NX1 SAVE PROGRAM BREAK FOR PN OF TH   49812021
*                                  PROCEDURE BRANCHING STATEMENTS       49818021
         CLI   GOTTEN+NX1,MDUGPK   START OF DEBUG PACKET          48971 49824021
         BE    IDBRK5              YES, IT IS DEBUG PACKET        48971 49830021
         CLI   GOTTEN+NX1,MQRT         IS IT BEGINNING OF Q-RTNS        49836021
         BE    IDBRK5                  YES - DO NOT COPY YET            49842021
         CLI   GOTTEN+NX1,SEGBK             SEGT BK                     49848021
       BE    *+8     YES-DONT COPY YET                                  49854021
       BAL     RCS,COPYIN         COPY BREAK                            49860021
       BAL   RCS,GETNXT            GET NEXT INPUT                       49866021
       CLI     PGMBRK,MPRDIV      IS IT START OF SOURCE PROC. DIV.      49872021
       BC      NOTEQ,IDENT         NO                                   49878021
         MVC   CARDNO(LX2),NXTCRD+NX1 YES - SAVE SEQ FOR ERROR BEFORE   49884021
         XC    NXTCRD+NX1(LX2),NXTCRD+NX1 VERB BUT DONT WRITE ON FILE   49890021
       BC      UNCOND,IDENT        RETURN                               49896021
IDBRK5 TM    SEGLM,NONSEG          SEGT WITH Q-RTN                      49902021
         BO    ID6                     NO - OK                          49908021
         CLC   PTYCEL(LX1),SEGLM           SEGMENT LIMIT          41085 49914021
         BL    ID6                     NO - STILL OK                    49920021
       SR    RW2,RW2              ISSUE DUMMY PN                        49926021
         LH    RW2,NUMER           WITH PRIORITY ZERO                   49932021
         LA    RW2,DX1(RW2)         AND 420D                            49938021
         STH   RW2,NUMER           NEXT PN NUM                          49944021
         MVI   PRIOR,XX00           PRIORITY ZERO                       49950021
       BAL   RCS,GENDAT            GENERATE THE BREAK                   49956021
       LA    RW2,SEGMNBR                                                49962021
         BAL   RCS,COPYIN            COPY Q-RTN BREAK                   49968021
         BAL   RCS,GETNXT                  GET NEXT INPUT               49974021
       BAL   RCS,GENDAT            AND THE PN                           49980021
       LA    RW2,PNDEF                                                  49986021
         L     RW1,COSADR          ESTABLISH BASE ADDRESS         46514 49992021
         MVC   PNCTR(LX2),NUMER    MOVE PN NUMBER                 46514 49998021
         BC    UNCOND,IDENT            RETURN FOR VERB                  50004021
ID6      EQU   *                                                        50010021
         BAL   RCS,COPYIN              COPY Q-RTN BREAK                 50016021
         BAL   RCS,GETNXT              GET NEXT INPUT                   50022021
         BC    UNCOND,IDENT              EXIT                           50028021
*                                                                       50034021
*                                 VERB FOUND                            50040021
*                                                                       50046021
*                                                                       50052021
*                                                                       50058021
ID5    EQU     *                                                        50064021
       NI      MSGSW,MSWOFF       OFF ERR-MSG ONCE-ONLY SW              50070021
         MVC   VERB+NX1(LX1),GOTTEN+NX1 STORE VERB FOR ERROR MSG        50076021
         CLC   GOTTEN(LX2),CBEOS   IS IT '.'                            50082021
       BC      EQ,ID9             YES                                   50088021
         MVC   VERB44(LX2),GOTTEN                                       50094021
         CLC   GOTTEN(LX2),CBELSE  IS IT ELSE                           50100021
       BC      EQ,ID9               YES                                 50106021
       NI      PSKPGO,MSWOFF     OFF 'GO-WAS-LAST' SW EXCEPT FOR EL     50112021
ID8    BAL     RCS,PZSTRT         REINIT. STRING TABLE                  50118021
       LA    RW2,ASTRNG                                                 50124021
       LA    RW1,ADFSBS                 AND DEFSBS                      50130021
         MVI   MODE+NX1,MFF        INIT MODES FOR ERROR MSGS            50136021
         MVI   MODEL+NX1,MFF                                            50142021
         MVI   MODER+NX1,MFF                                            50148021
         XC    STO5CT(LX1),STO5CT   INITIALIZE STO5 ENTRIES             50154021
       NI      STO5SW,MSWOFF       INITIALIZE STO5 SW                   50160021
       NI      GENRED,MSWOFF      OFF 'INCOMPLETE' SW FOR NEXT VERB     50166021
       NI      CONDSW,MSWOFF                                            50172021
       SR    RW1,RW1              GIVE RW1 CODE-BYTE FOR VERB           50178021
       STH     RW1,STO5J           INITIALIZE STO5 ENTRIES              50184021
       STH     RW1,STO5VE          INITIALIZE STO5 ENTRIES              50190021
       BAL     RCS,GENCRD         GENR CARD-NUMBER FOR STATEMENT        50196021
         IC    RW1,GOTTEN+NX1                                           50202021
         SLA   RW1,DX2                                                  50208021
       CH      RW1,HIVERB         IS IT BEYOND IC-TEXT LIMITS           50214021
       BC      LO,ID8X                      NO                          50220021
       BAL     RCS,GETNXT         DISCARD HOPING PH1 COMMENTED          50226021
       BC      UNCOND,ID3         RETURN FOR NEXT                       50232021
ID8X   EQU   *                                                          50238021
       IC      RVRB,AVRB(RW1)     STORE ELEMENT COUNT FOR THIS VERB     50244021
         STC   RVRB,VERB+NX2                                            50250021
       L     RVRB,AVRB(RW1)             LOAD BASE REGISTER FOR VERB     50256021
       BAL   RCS,GETNXT                   ANALYZER, AND GO PROCESS      50262021
       ST    RVRB,VRBASE          SAVE VERB'S BASE REGISTER             50268021
       BCR   UNCOND,RVRB           GO TO VERB ANALYZER RTN              50274021
*                                                                       50280021
*                 PERIOD OR 'ELSE' FOUND                                50286021
*                                                                       50292021
ID9    EQU     *                                                        50298021
       NI      TRUVRB,MSWOFF    IMPERATIVES-ONLY NEED NOW OVER          50304021
       TM      CONDSW,MSWON     WAS CONCLUSION TO A CONDITION NEEDE     50310021
       BC      ZERO,ID8             NO                                  50316021
       BAL     RCS,ERROR           YES - CONDITION HAS NO CONCLUSIO     50322021
       LA      RW1,ELST20                                               50328021
       BC      UNCOND,ID8          GO TO REINIT. STRING TABLE           50334021
*                                                                       50340021
*              GENRED SWITCH OFF ON RETURN FROM ANALYZER - ERROR        50346021
*                                                                       50352021
IDER2  BAL     RCS,ERONCE          INCOMPLETE STATEMENT                 50358021
       LA      RW1,ELST02                                               50364021
       BC      UNCOND,ID3          RETURN FOR NEXT                      50370021
*                                                                       50376021
*              NON-ENDWORD FOUND BY IDENT                               50382021
*                                                                       50388021
IDER4  EQU     *                                                        50394021
         CLC   GOTTEN(LX2),CBON    IS IT AN 'ON' THAT PH1 REJECTED      50400021
       BC      NOTEQ,IDER5         NO                                   50406021
       MVI     GOTTEN,MVERB        YES - CHANGE IT TO VERB              50412021
       BC      UNCOND,IDENT        GO PROCESS                           50418021
IDER5  EQU     *                                                        50424021
       BAL     RCS,ERROR           WRITE MESSAGE                        50430021
       LA      RW1,ELST03                                               50436021
       BC      UNCOND,IDERR        ERROR EXIT                           50442021
*                                                                       50448021
*              ANALYZER GAVE UP, SENDING PARAM IN RA0 AND LETTING       50454021
*                           IDENT WRITE THE MSG                         50460021
*                                                                       50466021
IDGVUP BAL     RCS,ERROR           WRITE MESSAGE                        50472021
       LA      RW1,ELST32                                               50478021
IDERR  TM    SEARCHSW,MSWON                                             50484021
       BO    CALLSRCH              SEARCH SWITCH ON                     50490021
       BAL   RCS,THROWE            DISCARD TILL ENDWORD                 50496021
       BC      UNCOND,ID3          RETURN FOR NEXT                      50502021
CALLSRCH EQU *                                                          50508021
       L     RVRB,ASRCH                                                 50514021
       USING  SEARCH,RVRB                                               50520021
       B     SRCH11                GO TO SEARCH                         50526021
       EJECT                                                            50532021
*                                                                       50538021
*=2    IDLHN   LHN HANDLING                                             50544021
*                                                                       50550021
*                                                                       50556021
*******************************************************************     50562021
*                                                                       50568021
*                                                                       50574021
*                             L H N  FOUND                              50580021
*                                                                       50586021
*                                                                       50592021
*** NOTES                                                               50598021
*      PHASE 1 SETS A BIT IN THE ATTRIBUTES OF EVERY PN FOR EACH OF     50604021
*        THE FOLLOWING CONDITIONS                                       50610021
*                                                                       50616021
*        IT IS A SECTION NAME                                           50622021
*        IT IS ALTERED                                                  50628021
*        IT PRECEDES A SIMPLE GO STATEMENT                              50634021
*        IT PRECEDES AN EXIT STATEMENT                                  50640021
*        IT IS THE END-OF-RANGE OF A PERFORM                            50646021
*        IT IS REFERENCED BY *DEBUG                                     50652021
*        IT IS DEFINED UNDER *DEBUG                                     50658021
*        IT IS A DUMMY CREATED BY PHASE 1                               50664021
*                                                                       50670021
*      ALTER,PERFORM BITS ON AN LHN CAUSE AN ENTRY TO BE MADE IN VN     50676021
*      PERFORM BIT CAUSES ID OF  N E X T  PN TO GO INTO PFMTBL          50682021
*      DEBUG-REFERENCE BIT CAUSES THE PN, ITS RPD NUMBER, AND A GN      50688021
*        GO INTO DBGTBL AND 'CALL GN' TO BE GENERATED                   50694021
*      IF PHASE 1 FOUND A 'READY TRACE' ANYWHERE IN THE PROCEDURE       50700021
*        DIVISION, IT TURNED ON A SWITCH IN COMMON.  IF THIS SWITCH     50706021
*        IS ON PHASE 4 GENERATES A TRACE VERB AFTER EVERY LHN EXCEP     50712021
*        DUMMIES                                                        50718021
*      SECTION NAMES INCLUDE AMONG THEIR ATTRIBUTES THEIR RPD NUMBE     50724021
*        AND THE ID OF THE FOLLOWING SECTION.  THESE ARE SAVED ALON     50730021
*        WITH THE SN'S OWN ID TO ALLOW CHECKING LEGALITY OF PROCEDU     50736021
*        BRANCHING STATEMENTS                                           50742021
*      FIRST 2 BYTES OF ATTRIBUTES ARE ZEROED ON EXIT FROM IDLHN UN     50748021
*        GO OR EXIT BIT IS ON.  THUS ATTRIBUTES TELL GO AND EXIT        50754021
*        ANALYZERS THAT A PN DID OR DID NOT IMMEDIATELY PRECEDE THE     50760021
*        VERB                                                           50766021
*                                                                       50772021
*                                                                       50778021
*******************************************************************     50784021
       SPACE   3                                                        50790021
       DS      0H                                                       50796021
IDLHN  EQU     *                                                        50802021
       NI    SEGSW,MSWOFF                                               50808021
         LH    RW1,SAVLHN+NX4      SAVE OLD ID INCASE NEW IS UNDEFIN    50814021
       BAL     RCS,GETALL          MOVE ENTIRE ENTITY TO STORAGE        50820021
       LA      RW2,SAVLHN           YES -  SAVE IT                      50826021
         TM    DX2(RIN),MFF        IS THIS A GOOD PN                    50832021
       BC      NOTONE,IDLHBG        YES                                 50838021
         XC    SAVLHN+NX2(LX2),SAVLHN+NX2 NO-TURN OFF ITS ATTRIBUTE BIT 50844021
       BAL     RCS,PH3ERP         WRITE CONCLUSION TO PH3 MSG           50850021
         LA    RW1,DX1(RW1)        RECONSTRUCT AND STORE ITS ID         50856021
         STH   RW1,SAVLHN+NX4                                           50862021
         OI    SAVLHN+NX2,MEXTBT   TURN ON EXIT BIT JUST IN CASE        50868021
         CLC   PNUM(LX2),NXTSN      IS IT A SECTION                     50874021
       BC   NOTEQ,IDLHB1    NO                                          50880021
         OI    SAVLHN+NX2,MSNBIT     YES - GIVE IT THE BIT              50886021
         MVC   NXTSN(LX2),NFFFF NEXT GETS MAX ID TO AVOID MSG 10        50892021
IDLHBG TM    SEGLM,NONSEG      IS PROGRAM SEGMENTED                     50898021
       BO    IDLHB1   NO- AVOID FURTHER CHECKING                        50904021
         CLC   PNUM(LX2),N1 IS THIS DUMMY PN1                           50910021
       BE    IDLH0A                YES                                  50916021
         CLC   PTYCEL(LX1),PNPTY    HAS PRIORITY CHANGED                50922021
       BE    IDLHB1   NO                                                50928021
       OI    SEGSW,MSWON    SET SW TO LATER GENERATE 420D               50934021
*                          AND GO TO NEXT SECTION BEFORE PNDEF          50940021
         CLC   SAVLHN+NX2(LX2),SECDUMMY    DUMMY SEC PN TXT       57827 50946021
         BNE   IDLHBG1             NO  SKIP                       57827 50952021
         BAL   RCS,GETNXT          GETTING NEXT REC               57827 50958021
         OI    NEXTIN,MSWON        INDICATES INPUT IS NEXT REC    57827 50964021
         CLC   GOTTEN(LX2),DBGPKT    DEBUG PACKET FOLLOWS         57827 50970021
         BNE   IDLHBG1             NO SKIP                        57827 50976021
         MVC   PNPTY(LX1),PTYCEL   YES INSERT CURRENT PRIORITY    57827 50982021
IDLHBG1  DS    0H                                                 57827 50988021
       B     IDLHB1                DO NOT CHECK ANY MORE                50994021
*                                                                       51000021
*                                                                       51006021
IDLHB0   MVC   PTYCEL(LX1),PNPTY                                        51012021
       BAL    RCS,GENDAT   GENERATE GO TO                               51018021
       LA    RW2,GOSEGT                                                 51024021
         MVC   RNUMER(LX2),PNUM   NEXT SECTION                          51030021
         MVC   RPRIOR(LX1),PNPTY                                        51036021
       BAL    RCS,GENDAT           GENERATE PN REF                      51042021
       LA    RW2,PNREF                                                  51048021
IDLH0A BAL   RCS,GENDAT           ISSUE SEGT CONTROL BK                 51054021
       LA    RW2,SEGMNBR                                                51060021
       TM    SEGSW,MSWON   PN1 OR OTHER                                 51066021
       BO    IDLH8Y                OTHER- ALREADY PROCESSED             51072021
       BAL    RCS,IDLH1A           PN1                                  51078021
       BC    UNCOND,IDLH02         INITIALIZE NEW SECTION NAME          51084021
IDLHB1 BAL   RCS,IDLH01            MOVE PN TO RHN,MOVE PRIORTY-N        51090021
       BC      UNCOND,IDLH02       INIT NEW SECTION NAME                51096021
*                                                                       51102021
*              PROVIDE END-OF-PERFORM CODING IF APPLICABLE              51108021
*              (THIS BLOCK ALSO CALLED BY DEBUGG)                       51114021
*                                                                       51120021
IDLH01   MVC   RNUMER(LX2),PNUM     MOVE IN PN ID TO RHN                51126021
         MVC   RPRIOR(LX1),PNPTY    MOVE IN PRIORITY NUM                51132021
IDLH1A   MVC   SRCHNM(LX2),SAVLHN+NX4                                   51138021
       ST      RCS,SVIDLH                                               51144021
       L       RW1,APFMTB                                               51150021
       BAL     RCS,SRCHTB          IS IT IN PFMTBL                      51156021
       BC      UNCOND,IDLH00       NOT IN TABLE                         51162021
       BAL     RCS,GENDAT          YES, WRITE OUTPUT                    51168021
       LA      RW2,CBGO            YES - GENR GO                        51174021
         MVC   VNID(LX2),VNNUM VNNUM GIVEN BY SRCHTB                    51180021
         MVC   VNPTY(LX1),PTYCEL      MOVE CURENT PTY INTO EQU VN       51186021
         MVC   DVNID(LX2),VNNUM SET UP VN DEF                           51192021
         MVC   DVNPTY(LX1),PNPTY                                        51198021
       BAL     RCS,GENDAT          WRITE 'GO' TO OUTPUT                 51204021
       LA      RW2,VNREF                      VN (REF)                  51210021
       BAL     RCS,GENDAT          WRITE 'EQU' TO OUTPUT                51216021
       LA      RW2,EQUVRB                     EQU                       51222021
       CLI   PTYCEL,INDEP          IS CURRENT PTY INDEP                 51228021
       BL    IDLH1B                NO- OK                               51234021
         OI    VNPTY,XX80           YES-TURN ON HIGH ORDER BIT          51240021
IDLH1B BAL   RCS,GENDAT            WRITE VN-REF TO OUTPUT               51246021
       LA      RW2,VNREF          VN(REF)                               51252021
         CLI   PGMBRK,MDECL        ARE WE IN DECLARATIVES               51258021
         BC    NOTEQ,IDLH0X          NO                                 51264021
       BAL     RCS,PUPLGN         YES                                   51270021
         MVC   GNREF+NX1(LX2),NXTLGN                                    51276021
         MVC   GNDEF+NX1(LX2),NXTLGN                                    51282021
       BAL     RCS,GENDAT         EQU  VN                               51288021
       LA      RW2,GNREF           GN                                   51294021
       BAL     RCS,GENDAT          WRITE GN-DEF TO OUTPUT               51300021
       LA      RW2,GNDEF          GNDEF TO ATTACH TO DEBUG RETURN       51306021
       BC      UNCOND,IDLH0Y       REMOVE ENTRIES FROM PFMTBL           51312021
IDLH0X EQU     *                                                        51318021
         OI    SAVLHN+NX2,MNDPFM    MARK PN AS END-PERFORM              51324021
       BAL     RCS,GENDAT          WRITE PN-REF                         51330021
       LA      RW2,PNREF                      PN (REF)                  51336021
IDLH0Y EQU     *                                                        51342021
       BAL     RCS,PACKTB          REMOVE ENTRY FROM PFMTBL             51348021
       L       RW3,TABADR             MOVE UP FROM TABADR+4             51354021
         LA    RW2,DX4(RW3)                      TO TABADR              51360021
IDLH00 L       RCS,SVIDLH                                               51366021
       BCR     UNCOND,RCS          RETURN TO CALLER                     51372021
*                                                                       51378021
*                           INITIALIZE NEW SECTION-NAME                 51384021
*                                                                       51390021
IDLH02 EQU     *                                                        51396021
         TM    SAVLHN+NX2,MSNBIT   IS IT SECTION                        51402021
       BC    ZERO,IDLH8Y           GENR THE LHN                         51408021
       CLI     PGMBRK,MDECL        ARE WE IN DECLARATIVES               51414021
       BC      NOTEQ,IDLH06        NO                                   51420021
       OI      TRCUSW,MSWON       PREVENT TRACE-CODING TILL AFTER U     51426021
         CLI   ENDUSE+NX1,XX00     IS END-OF-USE VERB NEEDED (USE AN    51432021
       BC      EQ,IDLH06                   YZER STORED IT)              51438021
       BAL     RCS,GENDAT           YES - GENR IT AND ZERO IT           51444021
       LA      RW2,ENDUSE                                               51450021
         MVI   ENDUSE+NX1,XX00                                          51456021
IDLH06 EQU     *                                                        51462021
         MVC   THISSN(LX2),SAVLHN+DX4     SAVE SECTION ID         57827 51468021
IDLH8X   TM    PGMBRK+NX1,MSWON                                         51474021
       BC    ZERO,IDLH8A           SEE IF DUMMY PN                      51480021
         NI    PGMBRK+NX1,MSWOFF                                        51486021
       MVI     PGMBRK,MENDCL         YES - STORE FOR MAIN BODY          51492021
       NI      TRCUSW,MSWOFF                                            51498021
       CLC   GNSV2+DX1(LX2),N0     ANY STMT IN DECL                     51504021
       BE    IDLHBK           NO                                        51510021
       BAL   RCS,GENDAT       WRITE OUT GNDEF                           51516021
       LA    RW2,GNSV2                                                  51522021
IDLHBK DS    0H                                                         51528021
       BAL     RCS,GENDAT         WRITE OUT END-DECLARATIVES            51534021
       LA      RW2,NDCBRK                                               51540021
*                                                                       51546021
*                        GENERATE THE LHN                               51552021
*                                                                       51558021
IDLH8A   TM    SAVLHN+NX3,MDUMBT                                        51564021
       BC    ZERO,IDLH08           SEE IF SEGT CODE NEC                 51570021
         TM    SAVLHN+NX2,MNDPFM    YES- IS IT NEEDED FOR EQU VN PN     51576021
       BC    ONES,IDLH8Y             YES-GENR IT                        51582021
       TM    SEGLM,NONSEG      IS PN1 NEEDED FOR SEGT                   51588021
       BO    IDLHP    NO- PUT OUT CARD NUMBER ONLY                      51594021
         CLC   PNUM(LX2),N1 SEGT, BUT IS THIS PN1                       51600021
       BE    IDLH8Y    YES PUT IT OUT                                   51606021
IDLHP  BAL   RCS,GENCRD            GENERATE CARD NUMBER                 51612021
       BC      UNCOND,IDLH18       GO TO RETURN TO IDENT                51618021
IDLH08 TM    SEGSW,MSWON           HAS PRIORITY CHANGED                 51624021
       BO    IDLHB0                 YES- GO ISSUE SEGT CODE             51630021
IDLH8Y   MVC   NUMER(LX2),PNUM      SETS UP PN DEF                      51636021
         MVC   PRIOR(LX1),PNPTY                                         51642021
       BAL     RCS,GENCRD         GENR CARD-NUMBER FOR PN,IF ANY        51648021
       BAL     RCS,GENDAT          WRITE PN DEF                         51654021
       LA      RW2,PNDEF                                                51660021
*                                                                       51666021
*                        PROCESS TRACE AND DEBUG,IF APPLICABLE          51672021
       TM      TRCUSW,MSWON        IS IT SN OF DECLARATIVE              51678021
       BC      ONES,IDLH12          YES-DEFER TILL AFTER USE STATEM     51684021
       BAL     RCS,IDLH09          NO- FURTHER CHECKING                 51690021
       BC      UNCOND,IDLH12       IS IT END OF PROGRAM                 51696021
*                                                                       51702021
*                       (THIS BLOCK ALSO CALLED BY USE ANALYZER)        51708021
*                                                                       51714021
IDLH09 EQU     *                                                        51720021
       ST      RCS,SVIDLH                                               51726021
         TM    SAVLHN+NX3,MDUMBT    IS IT DUMMY NAME                    51732021
       BCR     ONES,RCS              YES - NO TRACE OR DEBUG            51738021
       L       RW1,COSADR                                               51744021
       TM    SWITCH,MB128   WAS THERE ANY 'READY TRACE'                 51750021
       BC      ZERO,IDLH10           NO                                 51756021
       BAL     RCS,GENDAT           YES-GENR                            51762021
       LA      RW2,TRACVB                     TRACE                     51768021
       BAL     RCS,GENDAT          GENERATE PN REF                      51774021
       LA      RW2,PNREF                      RHN                       51780021
*                                                                       51786021
IDLH10   TM    SAVLHN+NX3,MDBGBT    IS IT REFERENCED BY DEBUG           51792021
       BC      ZERO,IDLH11           NO                                 51798021
         TM    SAVLHN+NX3,MDBUGU   IS IT IN A DEBUG PACKET              51804021
       BC      ONES,IDLH11         YES,DONT USE (DEBUGG WRITES MSG)     51810021
       L       RW1,ADBGTB           YES-PUT INTO DBGTBL                 51816021
       BAL     RCS,PNSRTF          INSERT LHN ID IN TABLE               51822021
         LA    RW4,SAVLHN+NX4        LHN  ID                            51828021
       BAL     RCS,PUPLGN          GET NEW GN NUMBER                    51834021
       BAL     RCS,PNSRTF          INSERT NEXT LGN                      51840021
       LA      RW4,NXTLGN                   NEXT LGN NUMBER             51846021
         MVC   GNREF+NX1(LX2),NXTLGN                                    51852021
       BAL     RCS,GENDAT           GENR                                51858021
       LA      RW2,CALLVB                     CALL                      51864021
       BAL     RCS,GENDAT          WRITE GN REF                         51870021
       LA      RW2,GNREF                      RGN                       51876021
       BAL   RCS,PUPLGN            GET NEW GN FOR RETURN                51882021
         MVC   GNDEF+NX1(LX2),NXTLGN SET LABEL UP                       51888021
       BAL    RCS,GENLAB           GENERATE IT                          51894021
IDLH11 L       RCS,SVIDLH          EXIT                                 51900021
       BCR     UNCOND,RCS          EXIT                                 51906021
*                                                                       51912021
*              UPDATE VNTBL AND PFMTBL IF END-OF-PERFORM                51918021
*                                                                       51924021
IDLH12 EQU     *                                                        51930021
         TM    SAVLHN+NX2,MPFMBT    IS IT END-OF-PERFORM                51936021
       BC      ZERO,IDLH14         NO                                   51942021
         MVC   THRUPN(LX10),SAVLHN  YES- GIVE PN ID TO GETPVN           51948021
       BAL     RCS,GETPVN            GET ITS ASSOCIATED VN, AND MAK     51954021
       BC      UNCOND,IDLH18         ENTRIES IN VNTBL AND PFMTBL IF     51960021
*                                   IT IS NOT ALREADY IN                51966021
*                                                                       51972021
*                   UPDATE VNTBL IF PN IS ALTERED                       51978021
*                                                                       51984021
IDLH14 EQU     *                                                        51990021
         TM    SAVLHN+NX2,MALTBT    IS IT ALTERED                       51996021
       BC      ZERO,IDLH18           NO - EXIT                          52002021
       L       RW1,AVNTBL                                               52008021
       BAL     RCS,SRCHTB         IS IT ALREADY IN VNTBL                52014021
         BC    UNCOND,*+NX8        NO                                   52020021
       BC      UNCOND,IDLH16      YES                                   52026021
       BAL     RCS,PNSRTF           NO - INSERT IT                      52032021
         LA    RW4,SAVLHN+NX4                                           52038021
       BAL     RCS,PUPVNC         STEP THE VN COUNTER                   52044021
       BAL     RCS,PNSRTF          INSERT VN-NUM                        52050021
       LA      RW4,VNNUM                                                52056021
IDLH16   MVC   VNID(LX2),VNNUM SAVE VN FOR ALTERED GO                   52062021
         MVC   VNPTY(LX1),PNPTY MOVE IN PTY NUMBER                      52068021
*                                                                       52074021
*              RETURN TO IDENT -- LHN PROCESSING DONE                   52080021
*                                                                       52086021
IDLH18 EQU     *                                                        52092021
         TM    SAVLHN+NX2,MEXTBT   IS IT FOR EXIT                       52098021
         BC    NOTZER,*+NX8        NO                                   52104021
         NI    SAVLHN,XX00                                              52110021
       BAL     RCS,GETNXT           GET RID OF POSSIBLE PERIODS         52116021
         CLC   GOTTEN(LX2),CBEOS                                        52122021
       BC      EQ,IDLH18           YES                                  52128021
       BC      UNCOND,IDENT       RETURN TO SEEK VERB                   52134021
DBGPKT   DC    X'4209'             DEBUG PACKET                   57827 52140021
SECDUMMY DC    X'4020'             SECTION BIT AND DUMMY BIT      57827 52146021
       EJECT                                                            52152021
*=2    EOF     EOF HOUSEKEEPING                                         52158021
*******************************************************************     52164021
*                                                                       52170021
*                                                                       52176021
*                                                                       52182021
*                               E O F                                   52188021
*                                                                       52194021
*              END-OF-FILE HOUSEKEEPING                                 52200021
*                                                                       52206021
*******************************************************************     52212021
       SPACE   5                                                        52218021
EOF    EQU     *                                                        52224021
EOF1   EQU     *                                                        52230021
       L       RAS,ARELES         RELEASE ALL TAMER TABLES              52236021
       LA      RW2,TAMNUM                                               52242021
       SR      RW3,RW3                                                  52248021
EOF3   L       RW1,ASTRNG(RW3)                                          52254021
       BALR    RCS,RAS             RELEASE STRING TABLE                 52260021
         LA    RW3,DX8(RW3)                                             52266021
       BCT     RW2,EOF3            RETURN                               52272021
EOF4   L     RW1,COSADR           UPDATE COMMON AREA                    52278021
         MVC   GNCTR(LX2),NXTLGN  LGN COUNTER                           52284021
       L       RW1,COSADR         CALL PHASE 5                          52290021
       BALR  RA0,RW1               GO TO CALL PH5                       52296021
       DC      X'A000'                                                  52302021
*                                                                       52308021
       EJECT                                                            52314021
*                                                                       52320021
       SPACE   5                                                        52326021
*******************************************************************     52332021
*                                                                       52338021
*                                                                       52344021
*                   COMMONLY USED  S U B R O U T I N E S                52350021
*                                                                       52356021
*      BAL   RCS,SUBR    BAL  RCS,SUBR            BAL  RCS,SUBR         52362021
*      (SINGLE RETURN)   (NO RETURN - 4 BYTES)   (INSTRUCTION TO BE     52368021
*                        (YES RETURN)            (SINGLE OR NO RETU     52374021
*                                                (YES RETURN,IF 2)      52380021
*                                                                       52386021
*                                                                       52392021
*******************************************************************     52398021
         EJECT                                                          52404021
*=2    GETNXT    READ ROUTINE                                           52410021
*******************************************************************     52416021
*                                                                       52422021
*                        G E T N X T                                    52428021
*                                                                       52434021
*      BAL     RCS,GETNXT                                               52440021
*      (RETURN)                                                         52446021
*                                                                       52452021
*                                                                       52458021
*      COPIES 'NOISE' ON OUTPUT FILE, GETS ANOTHER ENTITY               52464021
*      STORES SEQUENCE NUMBER AT NXTCRD,THEN GETS ANOTHER               52470021
*      UPDATES RIN TO POINT TO NEXT SIGNIFICANT ENTRY                   52476021
*      COMPUTES BYTCNT, TOTAL NUMBER OF BYTES IN ENTITY WHOSE ADDRE     52482021
*        IS STORED AT PNTIN                                             52488021
*      MOVES FIRST HALF-WORD OF THIS ENTITY TO GOTTEN                   52494021
*                                                                       52500021
*                                                                       52506021
*      (IF NEXTIN SW IS ON, TURNS IT OFF, MOVES NXTWRD TO GOTTEN,MO     52512021
*       NXTCNT TO BYTCNT, MOVES GOTTEN TO ITS ORIGINAL PLACE IN         52518021
*       INPUT BUFFER, AND EXITS)                                        52524021
*                                                                       52530021
*      N O T E .  THERE ARE 2 POINTERS AND 2 BYTE COUNTERS.             52536021
*                                                                       52542021
*      RIN AND BYTCNT ARE REFERENCED BY MOST ROUTINES AND MAY           52548021
*       OCCASIONALLY BE CHANGED BY THEM IF THEY WISH TEMPORARILY TO     52554021
*       PRETEND INPUT IS SOMEWHERE ELSE THAN IN THE BUFFER, E.G., A     52560021
*       CURENT.                                                         52566021
*                                                                       52572021
*       TRUPNT AND TRUCNT ALWAYS REFER TO THE TRUE INPUT BUFFER.        52578021
*       GETNXT ALWAYS RESETS RIN AND BYTCNT TO THE VALUE OF TRUPNT      52584021
*       AND TRUCNT.                                                     52590021
*                                                                       52596021
*** SUBROUTINES CALLED                                                  52602021
*      COS,GENCRD,COPYIN                                                52608021
*                                                                       52614021
*                                                                       52620021
*******************************************************************     52626021
       SPACE   5                                                        52632021
       DS      0H                                                       52638021
GETNXT   EQU   *                                                        52644021
       STM     RCS,RW2,SVGET                                            52650021
       TM    SETRIN,MSWON          IS SETTBL BEING USED                 52656021
       BZ    GET1           NO                                          52662021
         CLC   SETSVD(LX2),N0     IS THIS FIRST TIME                    52668021
       BE    GET1              YES                                      52674021
       L     RW1,ASETBL           NAKE SURE DONT GET GARBAGE            52680021
         L     RW1,DX0(RW1)                                             52686021
         L     RW2,DX0(RW1)                                             52692021
         LH    RW1,DX4(RW1)         RW1 PTS TO NO. BYTES USED           52698021
       AH    RW2,SETSVD                                                 52704021
       ST    RW2,TRUPNT          RESTORE TRUPNT IN CASE CLOBBERED       52710021
*    BY A CALL TO TAMER                                                 52716021
       AR    RW2,RW1          RW2 POINTS TO END OF TABLE                52722021
         SH    RW2,SETSVD          ADJUST TABLE PTR               45036 52728021
       CL    RW2,TRUPNT           ARE WE AT END OF TABLE                52734021
       BNE   GET1          NO- OK TO UPDATE PTR                         52740021
       OI    SETRIN,MSWOFF         SET ALL BITS ON                      52746021
GET1   TM    NEXTIN,MSWON                                               52752021
       BC      ZERO,GET2           NEXT WORD NOT THERE                  52758021
       NI      NEXTIN,MSWOFF      NEXT WORD ALREADY THERE               52764021
       L       RIN,TRUPNT                                               52770021
       BC      UNCOND,GET4        EXIT                                  52776021
*                                                                       52782021
*              GET NEW ENTITY                                           52788021
*                                                                       52794021
GET2   L       RW2,TRUPNT         TRUPNT AND TRUCNT PRESERVE THE RE     52800021
       BAL     RCS,COUNT           GET NUMBER OF BYTES                  52806021
       AH      RW2,BYTES         I/P-BUFFER VALUES,                     52812021
       TM    SETRIN,MSWON          SHOULD SETSVD BE UPDATED             52818021
       BZ    GET3                  NO-BYPASS UPDATE                     52824021
       LH    RW1,BYTES             ADD BYTE CT TO SETSVD                52830021
       AH    RW1,SETSVD                                                 52836021
       STH   RW1,SETSVD                                                 52842021
         CLC   SETSVD(LX2),DSPSET   ARE WE NOW AT END                   52848021
       BNE    GET3                 NO                                   52854021
       OI    SETRIN,MSWOFF        SIGNAL TO IGNORE WHATEVER RIN         52860021
*       MIGHT BE POINTING TO                                            52866021
GET3   EQU     *                                                        52872021
         LA RW1,LX16+LX10(RA0)     PUT VALUE 36                   99999 52878021
         EX    RW1,CURRTEXT        MOVE CURRENT ITEM TO CURRTEXT  99999 52884021
       LR      RIN,RW2            SET RIN                               52890021
       ST      RW2,TRUPNT          BYTCNT MAY GET PHONIED BY SAVCUR     52896021
       TM    SETRIN,MSWON          ARE WE SCANNING SETTBL               52902021
       BO    GET4              NO NEED TO SCAN FURTHER                  52908021
       TM      GOTTEN,MFF                                               52914021
       BC      ZERO,GET10         NEW ENTITY IS ERROR-MSG               52920021
       BC      ONES,GET6                        END-OF-BUFFER           52926021
         CLI   GOTTEN,MATEXT       LISTING A-TEXT                       52932021
         BE    GET13               YES                                  52938021
       CLI     GOTTEN,MCARD       IS IT CARD NUMBER                     52944021
       BC      EQ,GET8             YES                                  52950021
         CLC   GOTTEN(LX2),CBTHEN    DISCARD FUTILE OPTIONAL WORDS      52956021
       BC      EQ,GET2             YES, GET NEW WORD                    52962021
         CLC   GOTTEN(LX2),CBIS                                         52968021
       BC      EQ,GET2             YES, 'IS'                            52974021
       TM      PLOGIC,MSWON                                             52980021
       BC      ONES,GET4           ON, DO NOT BYPASS                    52986021
       TM    SPSALL,MSWON          BYPASS 'AND' CHECK                   52992021
       BC    ONES,GET4             DO NOT BYPASS                        52998021
         CLC   GOTTEN(LX2),CBAND   DISCARD 'AND' EXCEPT IN CONDITION    53004021
       BC      NOTEQ,GET4          NOT 'AND'                            53010021
       LA    RA0,CBAND           PARAM FOR MSG 8                        53016021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  53022021
       LA      RW1,ELST08                                               53028021
       BC      UNCOND,GET2         GET NEW                              53034021
*                                                                       53040021
GET4   LM      RCS,RW2,SVGET      EXIT                                  53046021
       BCR     UNCOND,RCS          EXIT                                 53052021
*                                                                       53058021
*                             END-OF-BUFFER                             53064021
*                                                                       53070021
GET6   L       RW1,COSADR         READ IN ANOTHER BLOCK                 53076021
       BALR  RA0,RW1               GET ANOTHER BLOCK                    53082021
       DC      X'0300'                                                  53088021
       BC      ZERO,GET12           BRANCH FOR EOF                      53094021
       LR      RW2,RA0                                                  53100021
         LA    RW2,DX0(RW2)        (CLEAR 1ST BYTE FOR OCCASIONAL AH    53106021
       ST      RW2,TRUPNT         REINIT TRUPNT                         53112021
       BC      UNCOND,GET3        GO BACK STORE TRUPNT,ETC.             53118021
*                                                                       53124021
*              CARD-NUMBER                                              53130021
*                                                                       53136021
GET8   BAL     RCS,GENCRD         GENR PREVIOUS CARD IF NECESSARY       53142021
         MVC   NXTCRD+NX1(LX2),DX1(RW2) SAVE THIS ONE                   53148021
       L     RW1,COSADR                                                 53154021
         MVC   CURCRD(LX2),DX1(RW2)                                     53160021
         NI    CURCRD,XX7F          TURN OFF HI ORDER BIT FOR CURCRD    53166021
       BC      UNCOND,GET2         GET NEW                              53172021
*                                                                       53178021
*              ERROR MESSAGE - COPY ON OUTPUT FILE                      53184021
*                                                                       53190021
GET10  EQU     *                                                        53196021
       BAL     RCS,GENCRD         GENR CARD NUM IF NECESSARY            53202021
GET11  BAL     RCS,COPYIN          COPY TO OUTPUT                       53208021
       BC      UNCOND,GET2        GET NEXT ENTITY                       53214021
*                                                                       53220021
*                                E O F                                  53226021
*                                                                       53232021
GET12  EQU     *                                                        53238021
       LA      RIN,EOFWD                                                53244021
       BC      UNCOND,GET4         GO TO EXIT                           53250021
GET13    DS    0H                                                       53256021
         CLC   NXTCRD+NX1(LX2),N0    IS THERE A CARD NO.                53262021
         BE    GET11               NO                                   53268021
         SR    RW1,RW1             CLEAR REGISTER1                      53274021
         IC    RW1,DX1(RW2)        GET COUNT                            53280021
         LA    RW1,DX1(RW1)        ADD 1 TO IT                          53286021
         EX    RW1,MVCATXT         SAVE A-TEXT                          53292021
         B     GET2                GET NEXT ELEMENT                     53298021
MVCATXT  MVC   ATXTSVD(RA0),DX0(RW2)  SAVE A-TXT 37 ITEM                53304021
CURRTEXT MVC   ACURRTXT(RA0),DX0(RW2)  SAVE CURRENT ITEM          99999 53310021
       SPACE   12                                                       53316021
*                                                                       53322021
*                                                                       53328021
*                              S A V C U R                              53334021
*                                                                       53340021
*      ROUTINE TO PRESERVE CURRENT INPUT ENTITY AT 'CURENT'. USE BE     53346021
*        CALL TO GETNXT IF THERE IS A POSSIBILITY WE MAY NEED CURRE     53352021
*        ONE AGAIN                                                      53358021
*                                                                       53364021
*      TEMPORARILY SUBSTITUTES ADDR. OF CURENT FOR PNTIN (SO THAT S     53370021
*       ROUTINES AS STOINP,GETALL,PUTNIN,ISDTOP,ETC.,WILL TREAT CUR     53376021
*       JUST LIKE INPUT.  HOWEVER, GETNXT RESTORES BUFFER ADDRESS T     53382021
*       RIN SO THAT ANY ROUTINE NEEDING CURENT AGAIN AS ASSUMED         53388021
*       INPUT AFTER A CALL TO GETNXT MUST  LA  RIN,CURENT               53394021
*                                                                       53400021
*      ROUTINE'S CHIEF USER IS SUBSCR, BUT OTHERS MIGHT CALL ON IT      53406021
*        IF THEY NEED TO SUBSTITUTE FOR CURRENT INPUT A LONGER          53412021
*        ENTITY.                                                        53418021
*                                                                       53424021
*                                                                       53430021
*      BAL     RCS,SAVCUR                                               53436021
*      (RETURN)                                                         53442021
*                                                                       53448021
*** SUBROUTINES CALLED                                                  53454021
*      GETALL                                                           53460021
*                                                                       53466021
*                                                                       53472021
SAVCUR EQU     *                                                        53478021
       ST      RCS,SVSAV                                                53484021
       BAL     RCS,GETALL          MOVE ENTITY TO STORAGE               53490021
       LA      RW2,CURENT                                               53496021
       L       RIN,ACURNT         SET RIN POINTING TO CURENT            53502021
         MVC   CURMOD(LX3),MODE                                         53508021
       L       RCS,SVSAV                                                53514021
       BCR     UNCOND,RCS          RETURN                               53520021
       SPACE  5                                                         53526021
*                                                                       53532021
*                                                                       53538021
*                             G E T A L L                               53544021
*                                                                       53550021
*                                                                       53556021
*      BAL   RCS,GETALL                                                 53562021
*      LA      RW2,TARGET-FIELD                                         53568021
*      (RETURN)                                                         53574021
*                                                                       53580021
*      LOADS BYTES INTO RW3 AND EXECUTES THE                            53586021
*        INSTRUCTION AT 0(RCS), THUS MOVING AN ENTIRE ENTITY FROM       53592021
*        THE INPUT BUFFER TO THE STORAGE LOCATION INDICATED BY          53598021
*        THE PROGRAM.                                                   53604021
*                                                                       53610021
*      DOES NOT TOUCH PNTIN. IF INPUT IS NOT NEEDED AFTER A CALL TO     53616021
*        GETALL, GETNXT MUST BE CALLED TO UPDATE PNTIN.                 53622021
*                                                                       53628021
*                                                                       53634021
GETALL   EQU   *                                                        53640021
       STM     RCS,RW3,SVGET                                            53646021
       LR      RW2,RIN                                                  53652021
       BAL     RCS,COUNT           GET TOTAL COUNT OF BYTES             53658021
       LH      RW3,BYTES         SET RW3 TO EXECUTE MVC INSTRUCTION     53664021
       BCTR  RW3,RA0               DECR COUNT BY 1                      53670021
       L       RCS,SVGET                                                53676021
         EX    RA0,DX0(RCS)          ( LA RW2 ... )                     53682021
       EX      RW3,MVGTAL          ( MVC 0(RW2), 0(RIN)                 53688021
       LM      RCS,RW3,SVGET                                            53694021
         BC    UNCOND,DX4(RCS)     RETURN                               53700021
*                                                                       53706021
MVGTAL   MVC   DX0(LX1,RW2),DX0(RIN)                                    53712021
       SPACE   5                                                        53718021
*                                                                       53724021
*                                                                       53730021
*                             T H R O W E                               53736021
*                        (THROW TILL ENDWROD)                           53742021
*                                                                       53748021
*      BAL   RCS,THROWE                                                 53754021
*      (RETURN)                                                         53760021
*                                                                       53766021
*      GETS NEXT UNTIL CURRENT ENTITY IS ENDWORD                        53772021
*                                                                       53778021
*                                                                       53784021
*** SUBROUTINES CALLED                                                  53790021
*      GETNXT,ISEND                                                     53796021
*                                                                       53802021
*                                                                       53808021
THROWE EQU   *                                                          53814021
       ST    RCS,SVRCS4                                                 53820021
THRE2    BAL   RCS,ISEND          IS GOTTEN AN ENDWROD                  53826021
         BC    UNCOND,*+NX8        NO                                   53832021
       BC    UNCOND,THRE4          YES, RETURN                          53838021
       BAL   RCS,GETNXT           NO, GET NEXT AND SEEK ENDWORD         53844021
       BC    UNCOND,THRE2          SEEK ENDWORD                         53850021
THRE4  L     RCS,SVRCS4                                                 53856021
       BCR   UNCOND,RCS           EXIT - ENDWORD FOUND                  53862021
       EJECT                                                            53868021
*                                                                       53874021
       SPACE   3                                                        53880021
*******************************************************************     53886021
*                                                                       53892021
*                                                                       53898021
*      ROUTINES TO WRITE ON FILES                                       53904021
*                                                                       53910021
*                                                                       53916021
*******************************************************************     53922021
       SPACE   6                                                        53928021
*=2    GENDAT    WRITE ROUTINE                                          53934021
*                                                                       53940021
*                           G E N D A T                                 53946021
*                                                                       53952021
*                                                                       53958021
*                                                                       53964021
*      BAL     RCS,GENDAT                                               53970021
*      LA      RW2,SOURCE-FIELD                                         53976021
*      (RETURN)                                                         53982021
*                                                                       53988021
*                                                                       53994021
*      BASIC ROUTINE TO WRITE ON FILE-1                                 54000021
*                                                                       54006021
*                                                                       54012021
*** SUBROUTINES CALLED                                                  54018021
*      COS,COUNT                                                        54024021
*                                                                       54030021
*                                                                       54036021
*                                                                       54042021
GENDAT STM     RCS,RW4,SAVGEN                                           54048021
         EX    RA0,DX0(RCS)        RW2 GETS SOURCE ADDR                 54054021
       BAL     RCS,COUNT           GET TOTAL COUNT OF BYTES             54060021
       L       RW1,COSADR                                               54066021
       LH      RW3,BYTES                                                54072021
       BALR  RA0,RW1               WRITE                                54078021
         DC    X'11'                   WRITE FILE 1                     54084021
       LM      RCS,RW4,SAVGEN                                           54090021
         BC    UNCOND,DX4(RCS)     RETURN                               54096021
         EJECT                                                          54102021
*                                                                       54108021
*=2    COPYIN    GROUP OF ROUTINES CALLING GENDAT                       54114021
*                                                                       54120021
*                                                                       54126021
*                           C O P Y I N                                 54132021
*                           G E N S T R                                 54138021
*                                                                       54144021
*                                                                       54150021
*                                                                       54156021
*      SPECIALIZED ROUTINES TO GENERATE MATERIAL                        54162021
*                                                                       54168021
*      BAL   RCS,COPYIN       PUTS CURRENT ENTITY FROM INPUT BUFFER     54174021
*      (RETURN)               OUTPUT FILE. UPDATES PNTOUT.              54180021
*                                                                       54186021
*      BAL     RCS,GENSTR    PUTS ENTIRE CONTENTS OF TAMER TABLES       54192021
*      (RETURN)               DEFSBS AND STRING ON OUTPUT FILE          54198021
*                             TURNS ON GENRED SWITCH, TESTED BY IDE     54204021
*                                                                       54210021
*                                                                       54216021
*            THESE ROUTINES SIMPLY SET THE VARIOUS POINTERS AND         54222021
*              BAL TO GENDAT TO DO THE ACTUAL WRITING                   54228021
*                                                                       54234021
*** SUBROUTINES CALLED                                                  54240021
*      GENDAT,COUNT,QTBHAS,GENALL                                       54246021
*                                                                       54252021
*                                                                       54258021
COPYIN   EQU   *                                                        54264021
       ST      RCS,SVGEN2                                               54270021
         BAL   RCS,GENDAT          WRITE TO OUTPUT                      54276021
         LA    RW2,DX0(RIN)                                             54282021
       L       RCS,SVGEN2                                               54288021
         BCR   UNCOND,RCS          RETURN TO MAINLINE                   54294021
*                                                                       54300021
*                                  EXIT                                 54306021
GENSTR   EQU   *                                                        54312021
       ST      RCS,SVGEN2                                               54318021
         CLC   DSPSTR(LX2),N0      ANY OUTPUT                           54324021
       BCR     EQ,RCS               NO - EXIT. D O N T  G E N R  SS     54330021
       OI      GENRED,MSWON       SW SAYS VERB PRODUCED OUTPUT          54336021
         CLC   DSPSBS(LX2),N0       ANY SUBSCRIPTS                      54342021
       BC      EQ,GENST1            NO                                  54348021
         MVC   ATIB(LX4),ADFSBS      YES - GIVE GENALL TABLE ADDR.      54354021
       OI      NOTRAL,MSWON        TELL IT NO TRAILING BYTE-COUNT       54360021
       BAL     RCS,GENALL         GENR. ALL SUBSCRIPT STRINGS IN TA     54366021
         XC    DSPSBS(LX2),DSPSBS  ZERO SAVED DISPL.                    54372021
       NI      NOTRAL,MSWOFF                                            54378021
GENST1 TM      GNOUSW,MSWON       (ON FOR DISPLAY AND EXHIBIT)          54384021
       BC      ZERO,GENST2         NOT DISPLAY OR EXHIBIT               54390021
         XC    DSPNOU(LX2),DSPNOU   YES - ZERO SAVED DISPL. AND GENR    54396021
         MVC   ATIB(LX4),APNOUN     THEM BEFORE MAIN STRINGS            54402021
       BAL     RCS,GENALL          GO TO WRITE ENTIRE TABLE             54408021
GENST2 TM    CLEVMSG,MSWON         MOVE ZERO TO OP2                     54414021
       BZ    GENST2A     NO- NORML STRING GEN                           54420021
       BAL   RCS,GENDAT            WRITE TO OUTPUT                      54426021
       LA    RW2,MOVEVB                                                 54432021
       BAL   RCS,GENDAT            WRITE TO OUTPUT                      54438021
       LA    RW2,CBZERO                                                 54444021
       BAL   RCS,GENDAT            WRITE TO OUTPUT                      54450021
       LR    RW2,RIN                                                    54456021
         BCR   R0,RW2              NOP                                  54462021
       B     GENST3     EXIT                                            54468021
GENST2A  MVC   ATIB(LX4),ASTRNG                                         54474021
       BAL     RCS,GENALL          GENERATE ALL                         54480021
         XC    DSPSTR(LX2),DSPSTR  ZERO SAVED DISPL.                    54486021
GENST3 L       RCS,SVGEN2                                               54492021
       BCR   UNCOND,RCS            RETURN                               54498021
       SPACE   3                                                        54504021
*                                                                       54510021
*                                                                       54516021
*                                                                       54522021
*                           G N T W I C                                 54528021
*                                                                       54534021
*                                                                       54540021
*      BAL     RCS,GNTWIC                                               54546021
*      (RETURN)                                                         54552021
*                                                                       54558021
*      GENERATES TWICE THE ENTIRE CONTENTS OF DEFSBS, STRING, AND -     54564021
*        IF GNOUSW IS ON  -- PNOUNS                                     54570021
*                                                                       54576021
*** SUBROUTINES CALLED                                                  54582021
*      STO5CU                                                           54588021
*                                                                       54594021
*** NOTES                                                               54600021
*      CAN BE USED ONLY BY ROUTINES WHICH EMPLOY THE STO5 ROUTINES      54606021
*        TO PUT MATERIAL IN STRING                                      54612021
*                                                                       54618021
*                                                                       54624021
GNTWIC EQU     *                                                        54630021
       STM     RCS,RAS,SVGNTW                                           54636021
       L       RAS,ASTRNG                                               54642021
         L     RAS,DX0(RAS)                                             54648021
         MVC   STRCNT(LX2),DX4(RAS)   SAVE TAMM DISPL.                  54654021
       L       RAS,ADFSBS                                               54660021
         L     RAS,DX0(RAS)                                             54666021
         MVC   STRCNT+NX4(LX2),DX4(RAS)                                 54672021
       L       RAS,APNOUN                                               54678021
         L     RAS,DX0(RAS)                                             54684021
         MVC   STRCNT+NX6(LX2),DX4(RAS)                                 54690021
         MVC   STRCNT+NX2(LX2),STO5J  SAVE STO5J                        54696021
       BAL     RCS,STO5CU           APPEND 'END' AND GENR ONCE          54702021
         MVC   DSPSTR(LX2),STRCNT                                       54708021
         MVC   DSPSBS(LX2),STRCNT+NX4                                   54714021
         MVC   DSPNOU(LX2),STRCNT+NX6                                   54720021
       L     RAS,ASTRNG            GET ADDR OF TAMM                     54726021
         L     RAS,DX0(RAS)        TO MOVE IN SAVED DISPLACEMENT        54732021
         MVC   DX4(LX2,RAS),STRCNT    RESTORE TAMM DISPL                54738021
       L     RAS,ADFSBS          GET TAMM ADDRESS                       54744021
         L     RAS,DX0(RAS)                                             54750021
         MVC   DX4(LX2,RAS),STRCNT+NX4                                  54756021
       L     RAS,APNOUN      GET TIB,TAMM ADRR PNOUNT                   54762021
         L     RAS,DX0(RAS)    TO MOVE IN SAVED DISLACEMENT             54768021
         MVC   DX4(LX2,RAS),STRCNT+NX6                                  54774021
         MVC   STO5J(LX2),STRCNT+NX2  RESTORE STO5J                     54780021
       BAL     RCS,STO5CU         GENR AGAIN                            54786021
       LM      RCS,RAS,SVGNTW                                           54792021
       BCR     UNCOND,RCS          RETURN                               54798021
       SPACE   3                                                        54804021
*                                                                       54810021
*                           G E N A L L                                 54816021
*                                                                       54822021
*                                                                       54828021
*                                                                       54834021
*                                                                       54840021
*      BAL     RCS,GENALL                                               54846021
*      (RETURN)                                                         54852021
*                                                                       54858021
*      WRITES ON OUTPUT FILE ENTIRE CONTENTS OF TABLE WHOSE TIB-ADD     54864021
*        IT FINDS AT ATIB                                               54870021
*                                                                       54876021
*** SUBROUTINES CALLED                                                  54882021
*      GENDAT,COUNT                                                     54888021
*                                                                       54894021
*                                                                       54900021
GENALL EQU     *                                                        54906021
       STM     RCS,RW2,SVGNAL                                           54912021
       L       RW1,ATIB           RW1 GETS TIB ADDR.                    54918021
         L     RW1,DX0(RW1)        RW1 NOW GETS TAMM ADDR.              54924021
         CLC   DX4(LX2,RW1),N0       IS ANYTHING IN TABLE               54930021
       BC      EQ,GENAL4           NO - EXIT                            54936021
         L     RW2,DX0(RW1)        RW2 GETS START ADDR. OF TABLE        54942021
       TM    CLEVMSG,MSWON   MOVE ZERO TO OP2                           54948021
       BZ    GENAL2    NO-OK                                            54954021
       AH    RW2,LEFTSS   BYPASS LEFT SS STRING                         54960021
GENAL2 BAL     RCS,COUNT           COMPUTE BYTE-COUNT OF ENTRY          54966021
       LH      RA0,BYTES                                                54972021
       BAL     RCS,GENDAT         GENERATE ONE ENTRY                    54978021
         LA    RW2,DX0(RW2)                                             54984021
*                                                                       54990021
       TM      NOTRAL,MSWON       IS THERE TRAILING BYTE-COUNT          54996021
         BC    ONES,*+NX8              NO                               55002021
       AH      RA0,N1             ADD 1 TO COUNT FOR TRAILING BYTE-     55008021
       AR      RW2,RA0            COUNT IN TABLE. UPDATE SOURCE ADD     55014021
       LNR     RA0,RA0            DOWNDATE DISPL. FIELD OF TAMM         55020021
         AH    RA0,DX4(RW1)                                             55026021
         STH   RA0,DX4(RW1)                                             55032021
       BC      NOTZER,GENAL2      RETURN FOR NEXT ENTRY IF ANY          55038021
GENAL4 EQU     *                                                        55044021
       LM      RCS,RW2,SVGNAL                                           55050021
       BCR     UNCOND,RCS          RETURN                               55056021
       SPACE   3                                                        55062021
*                                                                       55068021
*                                                                       55074021
*                                 G E N C R D                           55080021
*                                                                       55086021
*      BAL     RCS,GENCRD                                               55092021
*      (RETURN)                                                         55098021
*                                                                       55104021
*      GENERATES LAST CARD NUMBER FOUND BY GETNXT AND SAVED IN NXTC     55110021
*        SETS NXTCRD TO 0 SO AS NOT TO GENR IT MORE THAN ONCE.          55116021
*                                                                       55122021
*** SUBROUTINES CALLED                                                  55128021
*      GENDAT                                                           55134021
*                                                                       55140021
*                                                                       55146021
GENCRD EQU     *                                                        55152021
         CLC   NXTCRD+NX1(LX2),N0   IS THERE A CARD NUMBER WAITING      55158021
       BCR     EQ,RCS             NO - EXIT                             55164021
       ST      RCS,SVGNCD                                               55170021
       CLI     PGMBRK,MQRT        DONT GENR CARD NUMBERS IN Q-ROUTI     55176021
       BC      EQ,GNCRD2           WHICH FOLLOW END OF SOURCE PROGR     55182021
       BAL     RCS,GENDAT         YES - GENR IT                         55188021
       LA      RW2,NXTCRD                                               55194021
         CLI   ATXTSVD,XX00        IS THERE A 37 ITEM                   55200021
         BE    GNCRD2              NO                                   55206021
         BAL   RCS,GENDAT          YES, WRITE IT OUT                    55212021
         LA    RW2,ATXTSVD                                              55218021
         XC    ATXTSVD,ATXTSVD     CLEAN UP                             55224021
GNCRD2 EQU     *                                                        55230021
         MVC   CARDNO(LX2),NXTCRD+NX1 SAVE IT FOR ERROR MSG             55236021
         XC    NXTCRD+NX1(LX2),NXTCRD+NX1 ZERO IT SO AS NOT TO GENR AGA 55242021
       L       RCS,SVGNCD                                               55248021
       BCR     UNCOND,RCS          RETURN                               55254021
ATXTSVD  DC    36X'00'             37 ITEM SAVE AREA                    55260021
ACURRTXT DC    36X'00'             CURRENTLY PROCESSING ITEM      99999 55266021
       SPACE   3                                                        55272021
*                                                                       55278021
*                                                                       55284021
*                           G E N L A B                                 55290021
*                                                                       55296021
*                                                                       55302021
*                                                                       55308021
*                                                                       55314021
*      BAL   RCS,GENLAB       GENERATES LABEL AT POINT OF DEFINITIO     55320021
*      (RETURN)               CALLER MUST HAVE STORED VARIABLE INFO     55326021
*                                 LOCATION LGN BEFORE CALLING           55332021
*                                                                       55338021
*                                                                       55344021
*** SUBROUTINES CALLED                                                  55350021
*      GENDAT                                                           55356021
*                                                                       55362021
*                                                                       55368021
GENLAB   EQU   *                                                        55374021
         ST    RCS,SVGEN2                                               55380021
         BAL   RCS,GENDAT          GENERATE LGN                         55386021
       LA      RW2,LGN                                                  55392021
         L     RCS,SVGEN2                                               55398021
         BCR   UNCOND,RCS          RETURN                               55404021
       SPACE   3                                                        55410021
*                                                                       55416021
*                                                                       55422021
*                           G E N L S T                                 55428021
*                                                                       55434021
*                                                                       55440021
*                                                                       55446021
*      BAL   RCS,GENLST       GENERATES FROM PSHTBL THE LAST LABEL      55452021
*      (RETURN)               ENTERED AND ALL LABELS EQU TO IT. REM     55458021
*                             THEN FROM PSHTBL                          55464021
*                                                                       55470021
*                                                                       55476021
*** SUBROUTINES CALLED                                                  55482021
*      GENLAB,QTBHAS,PREMVF                                             55488021
*                                                                       55494021
*                                                                       55500021
GENLST   EQU   *                                                        55506021
         STM   RCS,RW2,SVGLST                                           55512021
       L       RW1,APUSH                                                55518021
GNLST2   CLC   DSPUSH(LX2),N0      ANY LABELS LEFT IN TABLE             55524021
       BC      EQ,GNLST4            NO - EXIT                           55530021
       BAL     RCS,PREMVF         MOVE TO TEMP FROM TABLE               55536021
       LA      RW4,TMPLAB                                               55542021
         MVC   LGN+NX1(LX2),TMPLAB+NX1 MOVE ID TO LGN SKELETON          55548021
         BAL   RCS,GENLAB          GENERATE                             55554021
       TM      TMPLAB,MASTER       WAS THIS A MASTER                    55560021
         BC    ZERO,GNLST2         NO-RETURN FOR NEXT EQU TO MASTER     55566021
GNLST4   LM    RCS,RW2,SVGLST      YES-EXIT                             55572021
         BCR   UNCOND,RCS          RETURN                               55578021
       SPACE   3                                                        55584021
*                                                                       55590021
*                           G N X T S T                                 55596021
*                                                                       55602021
*                                                                       55608021
*                                                                       55614021
*      BAL   RCS,GNXTST       GENERATES LABEL FOR NEXT SENTENCE IF      55620021
*      (RETURN)               IS STORED AT NXTSNT. ZEROES NXTSNT.       55626021
*                             GENERATES ALL LABELS REMAINING IN PSH     55632021
*                             AND EMPTIES THE TABLE                     55638021
*                                                                       55644021
*                                                                       55650021
*** SUBROUTINES CALLED                                                  55656021
*      GENLAB,GENLST                                                    55662021
*                                                                       55668021
*                                                                       55674021
GNXTST   EQU   *                                                        55680021
         ST    RCS,SVGNXT                                               55686021
         CLC   NXTSNT(LX2),N0      IS NXTSNT IN USE                     55692021
         BC    EQ,GENXT2           NO                                   55698021
         MVC   LGN+NX1(LX2),NXTSNT    YES - MOVE ITS ID TO LGN SKELET   55704021
         XC    NXTSNT(LX2),NXTSNT  ZERO IT                              55710021
         BAL   RCS,GENLAB          GENERATE IT                          55716021
GENXT2   BAL   RCS,GENLST          GENERATE LAST PSHTBL LABEL AND E     55722021
         CLC   DSPUSH(LX2),N0      IS PSHTBL EMPTY                      55728021
       BC      NOTEQ,GENXT2       NO-RETURN FOR NEXT PSHTBL LABEL       55734021
         L     RCS,SVGNXT          YES- EXIT                            55740021
         BCR   UNCOND,RCS          RETURN                               55746021
       SPACE   3                                                        55752021
*                                                                       55758021
*                                                                       55764021
*****                                                                   55770021
*              ROUTINES TO GENERATE SHORT COMPILER-CREATED STRINGS      55776021
*                                                                       55782021
*****                                                                   55788021
*                                                                       55794021
*                           G E N G O                                   55800021
*                           G E N M O V                                 55806021
*                                                                       55812021
*                                                                       55818021
*                                                                       55824021
*      BAL     RCS,GENGO         GENERATES GO TO GN,PN,OR VN            55830021
*      LA      RW1,ADDR. OF A GN,PN,OR VN AT POINT OF REF.              55836021
*      (RETURN)                                                         55842021
*                                                                       55848021
*                                                                       55854021
*      BAL     RCS,GENMOV         GENERATES ALTER GN(VN,PN)TO GN(VN     55860021
*      LA      RW1,ADDR. OF LABEL1 AT POINT OF REF.                     55866021
*      LA      RW1,ADDR. OF LABEL2 AT POINT OF REF.                     55872021
*      (RETURN)                                                         55878021
*                                                                       55884021
***SUBROUTINES CALLED                                                   55890021
*      GENDAT                                                           55896021
*                                                                       55902021
*                                                                       55908021
GENGO  EQU     *                                                        55914021
       STM     RCS,RW1,SVGNMV                                           55920021
         EX    RA0,DX0(RCS)        LOAD RW1 FROM CALLING SEQUENCE       55926021
       BAL     RCS,GENDAT          WRITE'GO' TO OUTPUT                  55932021
       LA      RW2,CBGO           GO                                    55938021
       BAL     RCS,GENDAT          WRITE GN, PN OR VN TO OUTPUT         55944021
         LA    RW2,DX0(RW1)        WHEREVER                             55950021
       LM      RCS,RW1,SVGNMV                                           55956021
         BC    UNCOND,DX4(RCS)     RETURN                               55962021
*                                                                       55968021
GENMOV EQU     *                                                        55974021
       STM     RCS,RW1,SVGNMV                                           55980021
       LR      RAS,RCS            PRESERVE RCS FOR EXECUTES             55986021
       BAL     RCS,GENDAT          WRTIE 'ALTER' TO OUTPUT              55992021
       LA      RW2,MOVEVN         ALTER                                 55998021
         EX    RA0,DX0(RAS)          GET 1ST LABEL-ADDR. IN RW1         56004021
       BAL     RCS,GENDAT          WRITE LABEL-1 TO OUTPUT              56010021
         LA    RW2,DX0(RW1)        LABEL-1                              56016021
         EX    RA0,DX4(RAS)          GET 2ND LABEL-ADDR. IN RW2         56022021
       BAL     RCS,GENDAT          WRITE LABEL-2 TO OUTPUT              56028021
         LA    RW2,DX0(RW1)        LABEL-2                              56034021
       LM      RCS,RW1,SVGNMV                                           56040021
         BC    UNCOND,DX8(RCS)     RETURN                               56046021
       EJECT                                                            56052021
*=2    GNARTH    PRODUCE SPECIAL ARITHMETIC STRINGS                     56058021
*                                                                       56064021
*                                                                       56070021
*                           G N A R T H                                 56076021
*                                                                       56082021
*                                                                       56088021
*                                                                       56094021
*              ROUTINE TO GENERATE STRINGS FOR ARITHMETIC VERBS AND     56100021
*               ATTACHING TO EACH IR-RESULT THE OP-CODE OF ITS USE      56106021
*               THE OTHER OPERAND USED WITH IT                          56112021
*                                                                       56118021
*      BAL     RCS,GNARTH                                               56124021
*      (RETURN)                                                         56130021
*                                                                       56136021
*** OUTPUT PRODUCED                                                     56142021
*      FOR EXAMPLE,                                                     56148021
*              STORED STRINGS ARE              GENERATED STRINGS AR     56154021
*                                                                       56160021
*                                        (EVAL E)                       56166021
*         +  A   B   IR1                  +  A   B   IR1 *  IR2         56172021
*         /  C   D   IR2                  /  C   D   IR2 *  IR1         56178021
*         *  IR1 IR2 IR3                  *  IR1 IR2 IR3 ST E           56184021
*         ST IR3 E                        ST IR3 E                      56190021
*                                                                       56196021
*                                                                       56202021
*** SUBROUTINES CALLED                                                  56208021
*      GENDAT,GENSBS,GENALL,QTBHAS,COUNT                                56214021
*                                                                       56220021
*                                                                       56226021
*** NOTES                                                               56232021
*      DECIDES IF EVAL-STRING NEEDED IN IF (YES, IF COMPARISON IS N     56238021
*        MERIC)                                                         56244021
*      SETS DRSULT=DMAX WHEN STORE-FIELD IS FLOATING-POINT              56250021
*      GENERATES EVAL STRING AND ON-SIZE-ERROR BRANCH. THEN             56256021
*      GENERATES WHOLE DEFSBS TABLE. THEN                               56262021
*      GENERATES STRING BY STRING WITH APPENDED INFO ON IR'S.           56268021
*      AT EXIT RESTORES TO TAMM DISPL. OF DEFSBS THE VALUE STORED I     56274021
*        LEFTSS AND TO TAMM DISPL. OF STRING THE VALUE STORED IN        56280021
*        LEFTDP. THIS ALLOWS EVERYTHING PERTAINING TO THE LEFT TERM     56286021
*        AN IF TO BE GENERATED AGAIN IF THE TERM IS USED AS AN IMPL     56292021
*        SUBJECT.  (WHEN IF FINDS A NEW LEFT TERM IT UPDATES LEFTSS     56298021
*        LEFTDP, AND THE 2 TAMMS.)                                      56304021
*                                                                       56310021
*                                                                       56316021
*                                                                       56322021
*                                                                       56328021
GNARTH EQU     *                                                        56334021
       STM     RCS,RW6,SVGNAR                                           56340021
GNAR0  L     RW4,ASTRNG                                                 56346021
         L     RW4,DX0(RW4)                                             56352021
*                                                                       56358021
         L     RW2,DX0(RW4)                                             56364021
         LA    RW2,DX0(RW2)        RW2 STARTS AT HEAD OF STRING         56370021
       ST    RW2,TABADR             SAVE FOR LATER IN SRCHAL PROC       56376021
       TM      PLOGIC,MSWON       FOR 'IF' FIND OUT IF EVAL STRING      56382021
       BC      ONES,GNAR20        IS NEEDED FOR EITHER TERM OR BOTH     56388021
       TM    SPSALL,MSWON          IS CALL FROM SRCHAL                  56394021
       BO    COMEVL                YES                                  56400021
*                                                                       56406021
*                                 GENERATE EVAL STRING                  56412021
*                                                                       56418021
GNEVAL EQU     *                                                        56424021
         CLC   PSTFLD(LX2),CBTALY  IS STORE-FIELD FLOATING-POINT        56430021
       BC      EQ,GNEV3            NO                                   56436021
         CLI   PSTFLD+NX3,XX09                                          56442021
       BC      LO,GNEV2           NO                                    56448021
         CLI   PSTFLD+NX3,XX0A                                          56454021
       BC      HI,GNEV2           NO                                    56460021
         MVC   DRSULT(LX1),DMAX      YES - MAKE DRSULT = DMAX           56466021
GNEV2  EQU     *                                                        56472021
GNEV3  BAL     RCS,GENDAT         GENR EVAL,DMAX,DRSULT,ROUND OPTIO     56478021
       LA      RW2,EVAL                                                 56484021
       BAL     RCS,GENDAT          WRITE DATA-INFO                      56490021
         LA    RW2,EVAL+NX3                                             56496021
       BAL     RCS,GENDAT          WRITE STORE-FIELD TO OUTPUT          56502021
       LA      RW2,PSTFLD         GENR STORE-FIELD                      56508021
         CLI   EVAL+NX2,XX03       WAS THERE SIZE-ERROR                 56514021
       BC      NOTEQ,GNAR1         NO                                   56520021
       BAL     RCS,GENDAT          YES - GENR BRANCH                    56526021
       LA      RW2,RGN                                                  56532021
*                                                                       56538021
GNAR1    L     RW1,DX0(RW4)        SET RW1 TO END OF STRING             56544021
         LA    RW1,DX0(RW1)           (CLEAR 1ST BYTE)                  56550021
         AH    RW1,DX4(RW4)                                             56556021
*                                                                       56562021
*                           GENERATE ALL SUBSCRIPTS                     56568021
*                                                                       56574021
         CLC   DSPSBS(LX2),N0      ANY SUBSCRIPTS IN DEFSBS             56580021
       BC      EQ,GNAR2             NO                                  56586021
         MVC   ATIB(LX4),ADFSBS    GIVE GENALL TABLE ADDR.              56592021
       OI      NOTRAL,MSWON         TELL IT NO TRAILING BYTE-COUNT      56598021
       BAL     RCS,GENALL         GENR ALL SUBSCRIPTS IN DEFSBS         56604021
       NI      NOTRAL,MSWOFF                                            56610021
*                                                                       56616021
*      GENERATE 4 ELEMENTS                                              56622021
*                                                                       56628021
GNAR2  EQU     *                                                        56634021
       LH      RW6,N4             RESET RW6 TO LOOP THRU 4              56640021
GNAR5  EQU     *                                                        56646021
       BAL     RCS,GENDAT         GENERATE IT                           56652021
         LA    RW2,DX0(RW2)                                             56658021
       BAL     RCS,COUNT           GET COUNT OF BYTES                   56664021
       AH      RW2,BYTES          POINT RW2 AT NEXT                     56670021
         LA    RW2,DX1(RW2)        SKIP TRAILING BYTE-COUNT             56676021
       CR      RW2,RW1            WAS IT LAST STRING OF WHOLE GROUP     56682021
       BC      EQ,GNAR16            YES -EXIT                           56688021
         CLC   DX0(LX2,RW2),EVAL+NX3 IS IT VERB INFO FROM SEARCHALL     56694021
       BE    COMEVL0               YES-SPEC PROCESSING                  56700021
       BCT     RW6,GNAR5           BACK TO LOOP                         56706021
       LR      RW6,RW2            POINT RW6 AT THE IR                   56712021
       SH      RW6,N4                                                   56718021
       SR      RW3,RW3            INIT OPERAND COUNTER                  56724021
       BC      UNCOND,GNAR7       GO SEEK THE = IR BELOW                56730021
*                                                                       56736021
*      TEST NEXT ELEMENT - IS IT OPERAND OR VERB                        56742021
*                                                                       56748021
GNAR6  BAL     RCS,COUNT           GET BYTE COUNT                       56754021
       AH      RW2,BYTES                                                56760021
         LA    RW2,DX1(RW2)        POINT RW2 TO NEXT                    56766021
GNAR7    TM    DX0(RW2),MDN        IS IT OPERAND                        56772021
       BC      ONES,GNAR8           YES                                 56778021
*                                                                       56784021
*                           VERB FOUND                                  56790021
*                                                                       56796021
         MVC   IRINFO+NX2(LX1),DX1(RW2) MOVE VERB-CODE TO IRINFO        56802021
       SR      RW3,RW3              INIT RW3, OPERAND COUNTER           56808021
       BC      UNCOND,GNAR6         GO TEST NEXT ELEMENT                56814021
*                                                                       56820021
*                           OPERAND FOUND                               56826021
*                                                                       56832021
GNAR8    LA    RW3,DX1(RW3)          UPDATE OPERAND COUNTER             56838021
         CLI   DX0(RW2),MIR          IS IT AN IR                        56844021
       BC      NOTEQ,GNAR6          NO, GO TEST NEXT ELEMENT            56850021
*                                                                       56856021
*                           IR FOUND                                    56862021
*                                                                       56868021
         CLC   DX1(LX2,RW2),DX1(RW6) DOES IT = PRESERVED RESULT-IR      56874021
       BC      NOTEQ,GNAR6        NO, KEEP LOOKING                      56880021
       CH      RW3,N2             WHICH OPERAND IS IT                   56886021
       BC      LO,GNAR10           FIRST                                56892021
       BCTR  RW2,RA0                 2ND - POINT RW2 AT PRECEDING O     56898021
         IC    RW3,DX0(RW2)                                             56904021
       SR      RW2,RW3                                                  56910021
       BC      UNCOND,GNAR12       GO TO GENR APPENDED ELEMENTS         56916021
GNAR10 BAL     RCS,COUNT            1ST - POINT RW2 AT NEXT OPRND       56922021
       AH      RW2,BYTES                                                56928021
         LA    RW2,DX1(RW2)                                             56934021
*                                                                       56940021
*                           GENERATE APPENDED ELEMENTS                  56946021
*                                                                       56952021
GNAR12 EQU     *                                                        56958021
       BAL     RCS,GENDAT           GENR VERB CODE                      56964021
       LA      RW2,IRINFO                                               56970021
         CLI   DX0(RW2),MSS          IS OPERAND AN SSID                 56976021
       BC      NOTEQ,GNAR14        NO                                   56982021
         MVI   DX0(RW2),MDN        PH5 DOESNT WANT SS HEADER HERE       56988021
       BAL     RCS,GENDAT           GENR IT                             56994021
         LA    RW2,DX0(RW2)                                             57000021
         MVI   DX0(RW2),MSS        RESTORE SS HEADER                    57006021
       BC      UNCOND,GNAR15       YES, OPERAND IS SSID                 57012021
GNAR14 BAL     RCS,GENDAT         GENR NON-SS OPERAND                   57018021
         LA    RW2,DX0(RW2)                                             57024021
GNAR15 LR      RW2,RW6            RESTORE RW2 TO POINT TO ELEMENT A     57030021
       AH      RW2,N4               THE PROCESSED RESULT-IR             57036021
       BC      UNCOND,GNAR2       RETURN FOR NEXT RESULT-IR             57042021
*                                                                       57048021
*              ENTIRE GROUP OF IR'S NOW PROCESSED                       57054021
*                                                                       57060021
*                                                                       57066021
GNAR16 OI      GENRED,MSWON                                             57072021
       TM    REMSW,MSWON           DIVIDE REMAINDER FOUND               57078021
       BO    GNAR17                RESTORE TO LEFT                      57084021
       TM      PLOGIC,MSWON                                             57090021
       BO    GNAR17     YES-RESTORE TAMM TO LEFTDP                      57096021
       TM    STFLD1,MSWON     1ST REAL STOREFIELD PROCESSED             57102021
       BZ    GNAR19    NO    EXIT                                       57108021
GNAR17   MVC   DX4(LX2,RW4),LEFTDP IMPLIED LEFT                         57114021
         MVC   DSPSTR(LX2),LEFTDP                                       57120021
       TM    RECSW,MSWON                                                57126021
       BO    GNAR19     DONT RESTORE SS TO LEFTSS                       57132021
       L       RW4,ADFSBS         ALSO, ANY SUBSCRIPT STRINGS FOR L     57138021
         L     RW4,DX0(RW4)                                             57144021
         MVC   DX4(LX2,RW4),LEFTSS                                      57150021
         MVC   DSPSBS(LX2),LEFTSS                                       57156021
*      N O T E .   LEFTDP IS 0 UNLESS LEFT TERM IN IF IS AN IR.         57162021
*         IN THAT CASE, STRING PRODUCING THE IR MUST BE PRESERVED       57168021
*        FOR POSSIBLE USE IF THIS IR BECOMES AN IMPLIED SUBJECT.        57174021
GNAR19 EQU     *                                                        57180021
       LM      RCS,RW6,SVGNAR                                           57186021
       BCR     UNCOND,RCS          RETURN                               57192021
*                                                                       57198021
*      SEE IF THERE ARE NUMERIC OPERANDS IN IF STATEMENT                57204021
*        IF SO - AN EVAL STRING IS NEEDED                               57210021
*                                                                       57216021
GNAR20   CLI   PRLVRB+NX1,MNUMRL   IS VERB NUMERIC RELATIONAL           57222021
       BC      NOTHI,GNAR26         YES - EVAL NEEDED                   57228021
       BC      UNCOND,GNAR1         NO - DONT GENR EVAL                 57234021
*                                                                       57240021
*                         COMPARISON IS NUMERIC                         57246021
*              TO WHICH TERM SHALL EVAL STRING REFER                    57252021
*                                                                       57258021
GNAR26 EQU     *                                                        57264021
       LA      RW6,PLEFT          POINT RW6 PROVISIONALLY TO LEFT       57270021
       CLI     PLEFT,MIR          IS LEFT AN IR                         57276021
       BC      EQ,GNAR28          YES - USE LEFT                        57282021
       CLI     PRIGHT,MIR         IS RIGHT AN IR                        57288021
       BC      EQ,GNAR27           YES - USE RIGHT                      57294021
       TM      MODEL,MFGMOD       IS LEFT A DATA-NAME                   57300021
       BC      ZERO,GNAR28         YES - MIGHT AS WELL USE LEFT         57306021
GNAR27 LA      RW6,MOPLNG(RW6)     NO - USE RIGHT                       57312021
*                                                                       57318021
*      MOVE LEFT OR RIGHT TERM RESPECTIVELY TO PSTFLD FROM WHICH        57324021
*        GNEVAL GENERATES IT.  MOVE RESPECTIVE DMAX TO DMAX AND         57330021
*        DRSULT FIELDS OF EVAL STRING                                   57336021
*                                                                       57342021
GNAR28 EQU     *                                                        57348021
         MVC   PSTFLD(LX122),DX0(RW6)                                   57354021
         CLC   DMAXL(LX1),DMAXR    CHOOSE THE HIGHER DMAX FOR STRING    57360021
       BC      LO,GNAR30           TAKE DMAXR AS DMAX                   57366021
         MVC   DMAX(LX1),DMAXL                                          57372021
       BC      UNCOND,GNAR32       GO TO MOVE DMAX TO DRSULT            57378021
GNAR30   MVC   DMAX(LX1),DMAXR                                          57384021
GNAR32   MVC   DRSULT(LX1),DMAX    DRSULT SAME AS DMAX FOR IR           57390021
       BC      UNCOND,GNEVAL       GO TO GENR EVAL STRING               57396021
*                                                                       57402021
COMEVL LR    RW3,RW2               SAVE RW2                             57408021
COMPEV   CLC   DX0(LX2,RW2),WHENEQU                                     57414021
       BE    EVCOM1                YES                                  57420021
       BAL   RCS,COUNT             GET BYTE COUNT                       57426021
       AH    RW2,BYTES                                                  57432021
         LA    RW2,DX1(RW2)         POINT RW2 TO NEXT                   57438021
       B     COMPEV                SEEK WHEN-SIGNAL                     57444021
EVCOM1   LA    RW5,DX2                                                  57450021
EVCOM2 BAL   RCS,COUNT             GET BYTE COUNT                       57456021
       AH    RW2,BYTES                                                  57462021
         LA    RW2,DX1(RW2)                                             57468021
       BCT   RW5,EVCOM2            LOOP BACK                            57474021
       BAL   RCS,FNDKEY            SEE IF THIS IS THE KEY WE WANT       57480021
       BC    UNCOND,COMEVL         NO-TRY NEXT KEY                      57486021
       BAL   RCS,COUNT             RW2 POINTS TO KEY                    57492021
       LH    RW5,BYTES                                                  57498021
       EX    RW5,EVMVC             MOVE KEY TO PSTFLD FOR EVAL          57504021
       AR    RW2,RW5                                                    57510021
         LA    RW2,DX1(RW2)                                             57516021
         MVC   EVAL+NX5(LX3),DX2(RW2) MOVE INFO FOR THIS EVAL IN        57522021
       LR    RW2,RW3               RESTORE RW2                          57528021
       ST    RW2,KEYSVSTR         SAVE DISPL TO PACK STRING TABLE       57534021
       BC    UNCOND,GNEV3          GO TO GENR EVAL,DMAX,DRSULT..        57540021
EVMVC    MVC   PSTFLD(LX1),DX0(RW2)                                     57546021
COMEVL0 BAL  RCS,COUNT             BYPASS LAST EVAL INFO                57552021
       AH    RW2,BYTES                                                  57558021
         LA    RW2,DX1(RW2)                                             57564021
         MVC   DSPSBS(LX2),N0       GENR  ALL SS ONCE                   57570021
       ST    RW1,TEMP                                                   57576021
       L     RW1,ASTRNG            PACK STRING TABLE DELETING LAST      57582021
       L    RW3,KEYSVSTR           #OF STRING JUST GENR                 57588021
       S    RW3,TABADR             DISP BETWEEN BEG STR AND STR GENR    57594021
       ST    RW2,KEYSVSTR         SAVE RW2                              57600021
       S    RW2,TABADR            DISP BETWEEN #STRNG AND #AFTER        57606021
*                  LAST STRING GENR                                     57612021
       BAL   RCS,PACKTB            PACK STRING TABLE                    57618021
         LA    RW3,DX0(RW3)        PACK FROM LAST STRING                57624021
         LA    RW2,DX0(RW2)            GENR TO NEXT LEMENT IN STRING    57630021
       L    RW2,KEYSVSTR                                                57636021
       L    RW1,TEMP         RESTORE REGISTER 1                         57642021
         CLC   DSPSTR(LX2),N0       END OF STRING TABLE                 57648021
       BE    GNAR16                YES- EXIT                            57654021
       BC    UNCOND,GNAR0         START AT HEAD OF STRING               57660021
*                  FNDKEY                                               57666021
*   THIS ROUTINE CHECKS TO SEE IF NEXT STRING IN STRING TABLE           57672021
* APPLIES TO NEXT SIGNIFICANT KEY IN KEYTBL- USER MUST NAME ALL         57678021
* PRECEDING KEYS IN KEY CLAUSE BUT NEED NOT NAME THEM IN ORDER          57684021
* HOWEVER, STRINGS FOR KEYS MUST BE PASSED TO PHASE 5 IN ORDER,         57690021
* HENCE THE NECESSITY OF THIS ROUTINE                                   57696021
*                                                                       57702021
*                                                                       57708021
FNDKEY STM   RCS,RW5,SVFNKY                                             57714021
       L    RW1,AKEYTB             GET ADDRESS OF KEYTBL                57720021
         L     RW4,DX0(RW1)        TAMM                                 57726021
         L     RW4,DX0(RW4)                                             57732021
       SR    RW5,RW5                                                    57738021
         IC    RW5,DX1(RW2)    RW2, POINTS TO KEY- GET DICT PTR         57744021
       BCTR    RW5,RA0            OF KEY IN STRING AND COMPARE TO       57750021
       AR    RW5,RW2               FIRST ENTRY IN KEYTBL                57756021
         CLC   DX0(LX3,RW5),DX0(RW4) ARE THEY EQUAL                     57762021
       BE    FNDKEY1            YES- GO PACK KEYTBL                     57768021
         LA    RW4,DX2              BYPASS THIS KEY AND EVAL TO         57774021
BYPASS BAL   RCS,COUNT             POINT RW2 TO NEXT STRING             57780021
       AH    RW2,BYTES             SO SEARCH CAN BE MADE FOR NEXT       57786021
         LA    RW2,DX1(RW2)         KEY-SEE F EUQAL COMPARE ON THAT     57792021
       BCT    RW4,BYPASS           BYPASS                               57798021
         ST    RW2,SVFNKY+NX16     PT RW2 IN SVAREA TO NEXT STRING      57804021
       LM    RCS,RW5,SVFNKY       NO- EXIT TO FIND NEXT KEY IN          57810021
         BC    UNCOND,DX0(RCS)      STRING                              57816021
FNDKEY1       BAL   RCS,PACKTB     DELETE 1ST ENTRY IN KEYTBL           57822021
         LA    RW3,DX0                                                  57828021
         LA    RW2,DX4             7MOVE NXT ENTRY UP TO BEG KEYTBL     57834021
       LM    RCS,RW5,SVFNKY                                             57840021
         BC    UNCOND,DX4(RCS)   GO GENT STRING FOR THIS KEY            57846021
       EJECT                                                            57852021
*                                                                       57858021
       SPACE   5                                                        57864021
*=2    PZSTRT    ROUTINES TO MANIPULATE TAMER TABLES                    57870021
       SPACE   5                                                        57876021
*                                                                       57882021
*******************************************************************     57888021
*                                                                       57894021
*                                                                       57900021
*                                                                       57906021
*      ROUTINES TO INSERT MATERIAL IN OR REMOVE MATERIAL FROM           57912021
*        LAST ENTRY OF TAMER TABLE                                      57918021
*                                                                       57924021
*                                                                       57930021
*              PNSRTF       INSERT IN   TABLE WITH FIXED-LENGTH ENT     57936021
*              PREMVF       REMOVE FROM    .    .  FIXED-   .     .     57942021
*              PNSRTV       INSERT IN      .    .  VARIABLE-.     .     57948021
*              PREMVV       REMOVE FROM    .    .  VARIABLE-.     .     57954021
*                                                                       57960021
*                                                                       57966021
*      TAMER TABLES WITH VARIABLE-LENGTH ENTRIES HAVE BYTE-COUNT        57972021
*        OF EACH ENTRY APPENDED AT END OF ENTRY TO ALLOW COUNTING       57978021
*        BACKWARDS TO ENTRIES BEFORE THE LAST.                          57984021
*                                                                       57990021
*                                                                       57996021
*      ALL CALLING SEQUENCES CONSIST OF                                 58002021
*        L     RW1,ADDR. OF TIB FOR TABLE                               58008021
*        BAL   RCS,ROUTINE                                              58014021
*        LA    RW4,TARGET OR SOURCE                                     58020021
*        (RETURN)                                                       58026021
*                                                                       58032021
*                                                                       58038021
*******************************************************************     58044021
       EJECT                                                            58050021
*                                                                       58056021
*                           P N S R T F                                 58062021
*                                                                       58068021
*                                                                       58074021
*                                                                       58080021
*      L       RW1,ADDR. OF TIB                                         58086021
*      BAL     RCS,PNSRTF         INSERT FIXED-LENGTH                   58092021
*      LA      RW4,SOURCE                                               58098021
*      (RETURN)                                                         58104021
*                                                                       58110021
*      FINDS BYTE-COUNT AT TIB                                          58116021
*      MOVES SPECIFIED NUMBER OF BYTES FROM SOURCE ADDR. IN  LA         58122021
*        INSTRUCTION TO NEXT AVAILABLE SPOT IN TABLE                    58128021
*      UPDATES SAVED DISPLACEMENT OF TABLE IN QUESTION                  58134021
*                                                                       58140021
*** SUBROUTINES CALLED                                                  58146021
*      CALLS ON INSERT TO FIND SPACE AND UPDATE TAMM                    58152021
*                                                                       58158021
*                                                                       58164021
PNSRTF EQU     *                                                        58170021
       STM     RCS,RW4,SVTAME                                           58176021
         EX    RA0,DX0(RCS)                                             58182021
       L       RAS,ANSERT         MAKE ROOM (GET TARGET ADDR. IN RW     58188021
       BALR    RCS,RAS             GO TO MAKE ROOM IN TABLE             58194021
         IC    RW3,DX0(RW1)                                             58200021
       BCTR  RW3,RA0               DECR RW3 BY 1                        58206021
       EX      RW3,NSRTMV                                               58212021
       BC      UNCOND,PREMV4       UPDATE SAVED DISPLACEMENT            58218021
*                                                                       58224021
*                                                                       58230021
*                           P R E M V F                                 58236021
*                                                                       58242021
*                                                                       58248021
*      L       RW1,ADDR. OF TIB                                         58254021
*      BAL     RCS,PREMVF         REMOVE FIXED-LENGTH                   58260021
*      LA      RW4,TARGET                                               58266021
*      (RETURN)                                                         58272021
*                                                                       58278021
*      FINDS BYTE-COUNT AT TIB                                          58284021
*      MOVES LAST ENTRY OF TABLE TO TARGET ADDR. SPECIFIED IN MVC       58290021
*        INSTRUCTION                                                    58296021
*      DECREMENTS DISPLACEMENT FIELD OF TAMM                            58302021
*      UPDATES SAVED DISPLACEMENT OF TABLE IN QUESTION                  58308021
*                                                                       58314021
*                                                                       58320021
PREMVF EQU     *                                                        58326021
       STM     RCS,RW4,SVTAME                                           58332021
       SR      RW3,RW3                                                  58338021
         IC    RW3,DX0(RW1)        RW3 GETS BYTE-COUNT OF ENTRY         58344021
         L     RW4,DX0(RW1)        RW4 GETS TAMM ADDR.                  58350021
         LH    RW2,DX4(RW4)        RW2 GETS NO. BYTES USED SO FAR       58356021
       SR      RW2,RW3               - BYTE-COUNT = NO. LEFT AFTER      58362021
         STH   RW2,DX4(RW4)        'UPDATE TAMM)                        58368021
         A     RW2,DX0(RW4)          + TABLE START = ADDR. LAST NTRY    58374021
       BCTR  RW3,RA0               DECR BYTE CT OF ENTRIES OF ENTRY     58380021
         EX    RA0,DX0(RCS)                                             58386021
       EX      RW3,REMVMV                                               58392021
       BC      UNCOND,PREMV4       UPDATE DISPLACEMENT                  58398021
*                                                                       58404021
*                                                                       58410021
*                           P N S R T V                                 58416021
*                                                                       58422021
*                                                                       58428021
*      L       RW1,ADDR. OF TIB                                         58434021
*      BAL     RCS,PNSRTV         INSERT VARIABLE-LENGTH                58440021
*      LA      RW4,SOURCE                                               58446021
*      (RETURN)                                                         58452021
*                                                                       58458021
*      MOVES I-C TEXT ENTITY FROM SOURCE ADDRESS TO NEXT AVAILABLE      58464021
*        IN TABLE. APPENDS ITS BYTE-COUNT AT END OF ENTRY               58470021
*      UPDATES SAVED DISPLACEMENT OF TABLE IN QUESTION                  58476021
*                                                                       58482021
*                                                                       58488021
*** SUBROUTINES CALLED                                                  58494021
*      CALL ON INSERT TO FIND SPACE AND UPDATE TAMM                     58500021
*      COUNT                                                            58506021
*                                                                       58512021
*                                                                       58518021
PNSRTV EQU     *                                                        58524021
       STM     RCS,RW4,SVTAME                                           58530021
         EX    RA0,DX0(RCS)                                             58536021
       LR      RW2,RW4                                                  58542021
       BAL     RCS,COUNT           GET BYTE COUNT                       58548021
       LH      RW3,BYTES                                                58554021
         LA    RW3,DX1(RW3)                                             58560021
         STC   RW3,DX0(RW1)                                             58566021
       L       RAS,ANSERT                                               58572021
       BALR    RCS,RAS             MAKE ROOM, GET TARGET ADDR. IN R     58578021
       LH      RW3,BYTES                                                58584021
       EX      RW3,NSRTMV                                               58590021
       AR      RW2,RW3            ADDR. BYTE-COUNT BYTE ' ADDR. ENT     58596021
*                                   + BYTE-COUNT OF ENTRY               58602021
         STC   RW3,DX0(RW2)        STORE BYTE-COUNT IN LAST BYTE        58608021
       BC      UNCOND,PREMV4       UPDATE DISPLACEMENT                  58614021
*                                                                       58620021
*                                                                       58626021
*                           P R E M V V                                 58632021
*                                                                       58638021
*                                                                       58644021
*      L       RW1,ADDR. OF TIB                                         58650021
*      BAL     RCS,PREMVV         REMOVE VARIABLE-LENGTH                58656021
*      LA      RW4,TARGET                                               58662021
*      (RETURN)                                                         58668021
*                                                                       58674021
*      MOVES LAST ENTRY OF TABLE TO SPECIFIED TARGET ADDRESS.           58680021
*      IF TARGET FIELD IS ZERO, DOES NOT DO ANY MOVING BUT              58686021
*        SIMPLY UPDATES TAMM AND TIB                                    58692021
*      DECREMENTS DISPLACEMENT FIELD OF TAMM                            58698021
*      UPDATES SAVED DISPLACEMENT OF TABLE IN QUESTION                  58704021
*                                                                       58710021
*** SUBROUTINES CALLED                                                  58716021
*      GOBACK,COUNT                                                     58722021
*                                                                       58728021
*                                                                       58734021
*                                                                       58740021
PREMVV EQU     *                                                        58746021
       STM     RCS,RW4,SVTAME                                           58752021
         EX    RA0,DX0(RCS)                                             58758021
       BAL     RCS,GOBACK         POINT RW2 TO PRECEDING ENTRY          58764021
       DC    XL2'1'                GO BACK  1                           58770021
       L     RW2,ADNTRY                                                 58776021
       BAL     RCS,COUNT          GET BYTE-COUNT IN LOC. 'BYTES'        58782021
       LTR     RW4,RW4                                                  58788021
       BC      ZERO,PREMV2         TARGET FLD IS 0,UPDATE TAMM          58794021
       LH      RAS,BYTES          YES - EXECUTE IT                      58800021
         BCTR  RAS,RA0             MAKE ROOM                            58806021
       EX      RAS,REMVMV                                               58812021
PREMV2   L     RW3,DX0(RW1)                                             58818021
         LH    RAS,DX4(RW3)        GIVE RAS TAMM DISPL.                 58824021
       SH      RAS,BYTES             - BYTES REMOVED                    58830021
       BCTR  RAS,RA0               DECR  COUNT BY 1                     58836021
         STH   RAS,DX4(RW3)        UPDATE TAMM DISPL.                   58842021
*                                                                       58848021
*             FOR ALL THESE ROUTINES AND FOR PACKTB UPDATE              58854021
*              SAVED DISPLACEMENT                                       58860021
*                                                                       58866021
PREMV4 EQU     *                                                        58872021
       LA      RW3,ASTRNG                                               58878021
PREMV6   C     RW1,DX0(RW3)        FIND ADDR OF THE ADCON IN RW1        58884021
       BC      EQ,PREMV8           YES, GET ADDR OF TAMM                58890021
         LA    RW3,DX8(RW3)                                             58896021
       BC      UNCOND,PREMV6       GO TO FIND ADDRESS                   58902021
PREMV8   L     RW1,DX0(RW1)        GET TAMM ADDR                        58908021
         MVC   DX4(LX2,RW3),DX4(RW1) MOVE TAMM DISPL. TO SAVED DISPL.   58914021
       LM      RCS,RW4,SVTAME                                           58920021
         BC    UNCOND,DX4(RCS)     RETURN                               58926021
*                                                                       58932021
NSRTMV   MVC   DX0(LX1,RW2),DX0(RW4)                                    58938021
REMVMV   MVC   DX0(LX1,RW4),DX0(RW2)                                    58944021
         EJECT                                                          58950021
*                                                                       58956021
*                                                                       58962021
*                                                                       58968021
*                                 S R C H T B                           58974021
*                                                                       58980021
*      ROUTINE TO SEARCH FOR A GIVEN PROCEDURE-NAME ID IN ANY OF TH     58986021
*        PROCEDURE-NAME TAMER TABLES (VNTBL,PFMTBL,DBGTBL).             58992021
*                                                                       58998021
*      L       RW1,ADDR. OF TIB                                         59004021
*      .                                                                59010021
*      .                                                                59016021
*      BAL     RCS,SRCHTB                                               59022021
*      (RETURN ID NOT IN TABLE)                                         59028021
*      (RETURN ID FOUND IN TABLE)                                       59034021
*                                                                       59040021
*      BEFORE CALLING SRCHTA, CALLER MUST STORE WANTED P-N ID AT        59046021
*        SRCHNM.                                                        59052021
*                                                                       59058021
*      IF THE P-N ID IS FOUND AND THE TABLE SEARCHED IS                 59064021
*        VNTBL OR                                                       59070021
*        PFMTBL - THE VNNUMBER FOLLOWING THE P-N ID IN THE TABLE IS     59076021
*                      STORED AT VNNUM                                  59082021
*        DBGTBL - THE GN NUMBER FOLLOWING THE P-N ID IN THE TABLE I     59088021
*                      STORED AT VNNUM AND THE RPD NUMBER AT DBGRPD     59094021
*                            THEN THE ENTRY IS ZEROED TO PREVENT RE     59100021
*                                                                       59106021
*      FOR ALL 3 TABLES, THE TABLE DISPLACEMENT OF THE  PN-ID IS ST     59112021
*        AT TABADR                                                      59118021
*                                                                       59124021
*      VNTBL CONSISTS OF DOUBLE 2-BYTE ENTRIES. THE 1ST OF EACH PAI     59130021
*        IS THE ID OF A PROCEDURE-NAME WHICH IS ALTERED OR IS THE E     59136021
*        OF-RANGE OF A PERFORM.  THE 2ND IS A UNIQUE VN-NUMBER ASSO     59142021
*        TED WITH THIS PN.                                              59148021
*                                                                       59154021
*      PFMTBL CONSISTS OF DOUBLE 2-BYTE ENTRIES. THE 1ST OF EACH PA     59160021
*        IS THE ID OF THE PROCEDURE NAME FOLLOWING THE END-OF-RANGE     59166021
*        OF A PERFORM. THE 2ND IS THE VN NUMBER CORRESPONDING TO TH     59172021
*        END-OF-RANGE PN IN THE VN TABLE.                               59178021
*                                                                       59184021
*      DBGTBL CONSISTS OF TRIPLE 3-BYTE ENTRIES. THE 1ST IS THE ID      59190021
*        THE PN REFERENCED BY A *DEBUG. THE 2ND THE RPD NUMBER OF T     59196021
*        PN. THE 3RD A GN NUMBER USED WITH 'CALL GN' WHEN THE DEBUG     59202021
*        PN WAS FOUND AT POINT OF DEFINITION                            59208021
*                                                                       59214021
*                                                                       59220021
SRCHTB EQU     *                                                        59226021
       STM     RW1,RW4,SVSRCH                                           59232021
*                                                                       59238021
         LA    RW2,DX4             WHICH TABLE IS IT                    59244021
*                                                                       59250021
SRCHT1 EQU     *                                                        59256021
         L     RW1,DX0(RW1)                                             59262021
         LH    RW3,DX4(RW1)                                             59268021
         L     RW1,DX0(RW1)        POINT RW1 AT BEGINNING OF TABLE      59274021
       ST      RW1,TABADR          SAVE BEGINNING ADDR. TILL SRCHT4     59280021
       LR      RW4,RW1            SAVE BEGINNING ADDR. IN RW4           59286021
       AR      RW3,RW1            POINT RW3 AT END                      59292021
       CR      RW1,RW3            IS ANYTHING IN TABLE                  59298021
       BC      EQ,SRCHT3           NO - EXIT                            59304021
*                                                                       59310021
*                                 SEEK INDICATED P-N ID                 59316021
*                                                                       59322021
SRCHT2   CLC   DX0(LX2,RW1),SRCHNM    IS THIS TABLE ENTRY THE ONE WAN   59328021
       BC      EQ,SRCHT4            YES                                 59334021
       AR      RW1,RW2              NO - POINT RW1 AT NEXT              59340021
       CR      RW1,RW3            IS TABLE EXHAUSTED                    59346021
       BC      LO,SRCHT2            NO - LOOK AT NEXT                   59352021
*                                                                       59358021
SRCHT3 LM      RW1,RW4,SVSRCH       YES - EXIT NOT-FOUND                59364021
       BCR     UNCOND,RCS          RETURN                               59370021
*                                                                       59376021
*              ID FOUND IN TABLE. SET UP EXIT PARAMETERS                59382021
*                                                                       59388021
SRCHT4 EQU     *                                                        59394021
         MVC   VNNUM(LX2),DX2(RW1)  SET VNNUM                           59400021
       S     RW1,TABADR                                                 59406021
       ST      RW1,TABADR               OF ENTRY FOUND                  59412021
       LM      RW1,RW4,SVSRCH                                           59418021
         BC    UNCOND,DX4(RCS)       EXIT FOUND-RETURN                  59424021
       SPACE   3                                                        59430021
*                                                                       59436021
*                                                                       59442021
*                           G E T P V N                                 59448021
*                                                                       59454021
*      BAL     RCS,GETPVN                                               59460021
*      (RETURN)                                                         59466021
*                                                                       59472021
*      USED BY PERFORM AND IDLHN TO PROCESS PN'S WHOSE PERFORM-BIT      59478021
*       ON.                                                             59484021
*      IF THE PN IS IN THE VNTBL AND THE NEXT PN (OR SN)IS IN THE       59490021
*              PFMTBL, DOES NOTHING                                     59496021
*      IF THE PN IS IN THE VNTBL AND THE NEXT PN IS NOT IN THE PFMT     59502021
*              AND THIS IS POINT-OF-DEFINITION OR A FORWARD REFEREN     59508021
*              PUTS THE VN AND THE NEXT PN IN THE PFMTBL                59514021
*      IF THE PN IS NOT IN THE VNTBL, PUTS IT IN ALONG WITH             59520021
*              THE VN STORED WITH NEXT PN IN PFMTBL IF PRESENT,OR       59526021
*              A NEW VN, WHICH IS THEN ALSO ENTERED IN PFMTBL IF TH     59532021
*               IS POINT OF DEFINITION OR FORWARD REFERENCE             59538021
*                                                                       59544021
*** SUBROUTINES CALLED                                                  59550021
*      SRCHTB,PUPVNC,PNSRTF                                             59556021
*                                                                       59562021
*                                                                       59568021
*** NOTES                                                               59574021
*      BEFORE CALLING, PN WITH PERFORM BIT MUST BE STORED ST            59580021
*       THRUPN                                                          59586021
*                                                                       59592021
*                                                                       59598021
GETPVN EQU     *                                                        59604021
       STM     RCS,RW1,SVGTPV                                           59610021
*                                                                       59616021
*        GET ID OF PN WHERE END-OF-PERFORM CODING GOES                  59622021
*                                                                       59628021
         TM    THRUPN+NX2,MSNBIT    IS THIS PN A SECTION-NAME           59634021
       BC      ONES,GTPV02         YES                                  59640021
         LH    RW1,THRUPN+NX4         NO- END-OF-PERFORM GOES AT NEX    59646021
         LA    RW1,DX1(RW1)                                             59652021
       STH     RW1,PFMEND                                               59658021
       BC      UNCOND,GTPV04       CHECK IF PN IN VNTBL                 59664021
GTPV02   MVC   PFMEND(LX2),THRUSN                                       59670021
*                                                                       59676021
*                        IS THIS PN IN VNTBL                            59682021
*                                                                       59688021
GTPV04   MVC   SRCHNM(LX2),THRUPN+NX4                                   59694021
       L       RW1,AVNTBL                                               59700021
       BAL     RCS,SRCHTB          GO TO SEARCH TABLE                   59706021
       BC      UNCOND,GTPV06        NO                                  59712021
       BC      UNCOND,GTPV08        YES                                 59718021
*                                                                       59724021
*        PN IS NOT IN VNTBL - BUT IS END-OF-PFM PN IN PFMTBL            59730021
*                                                                       59736021
GTPV06   MVC   SRCHNM(LX2),PFMEND                                       59742021
         L     RW1,APFMTB                                               59748021
         BAL   RCS,SRCHTB          GO TO SEARCH TABLE                   59754021
         BAL   RCS,PUPVNC          NO - GET A NEW VN                    59760021
         L     RW1,AVNTBL          YES- USE VN FOUND IN PFMTBL          59766021
         BAL   RCS,PNSRTF      ENTER THIS PN AND VN IN VNTBL            59772021
         LA    RW4,THRUPN+NX4                                           59778021
         BAL   RCS,PNSRTF          ENTER PN,VN IN VNTBL                 59784021
         LA    RW4,VNNUM                                                59790021
*                                                                       59796021
*              SHALL WE MAKE AN ENTRY IN PFMTBL                         59802021
*                                                                       59808021
GTPV08   MVC   SRCHNM(LX2),PFMEND   IS END-OF-PFM PN ALREADY IN         59814021
       L       RW1,APFMTB                                               59820021
       BAL     RCS,SRCHTB          GO TO SEARCH TABLE                   59826021
         BC    UNCOND,*+NX8        NO                                   59832021
       BC      UNCOND,GTPV10         YES - EXIT                         59838021
         CLC   PFMEND(LX2),SAVLHN+NX4  NO - IS THIS A FORWARD REFEREN   59844021
       BC      NOTHI,GTPV10            NO - THEN PFMTBL ENTRY HAS A     59850021
*                                  READY BEEN PROCESSED AND DELETED     59856021
*                                  WHEN LHN WAS FOUND                   59862021
       BAL     RCS,PNSRTF              YES - ENTER ENDOFPFM PN AND      59868021
       LA      RW4,PFMEND                    IN PFMTBL                  59874021
       BAL     RCS,PNSRTF          ENTER VN NUMBER IN TABLE             59880021
       LA      RW4,VNNUM                                                59886021
GTPV10 EQU     *                                                        59892021
       LM      RCS,RW1,SVGTPV       EXIT                                59898021
       BCR     UNCOND,RCS          RETURN                               59904021
       SPACE   3                                                        59910021
*                                                                       59916021
*                                                                       59922021
*                                                                       59928021
*                           P A C K T B                                 59934021
*                                                                       59940021
*      L       RW1,ADDR. OF TIB                                         59946021
*      .                                                                59952021
*      .                                                                59958021
*      BAL     RCS,PACKTB                                               59964021
*      ( 2 4-BYTE INSTRUCTIONS WHICH WILL LOAD RW2 AND RW3 WITH THE     59970021
*      (  FROM- AND TO- DISPLACEMENTS IN THE TABLE)                     59976021
*      (RETURN AT 8(RCS) )                                              59982021
*                                                                       59988021
*      DELETES ENTRIES WITHIN A TABLE BY MOVING ALL ENTRIES STARTIN     59994021
*       AT TABLE-ADDRESS(RW2) TO TABLE-ADDRESS(RW3)                     60000021
*      UPDATES TAMM AND SAVED DISPLACEMENT AT DSP...                    60006021
*                                                                       60012021
*                                                                       60018021
PACKTB EQU     *                                                        60024021
       STM     RW2,RW6,SVPKTB                                           60030021
         EX    RA0,DX0(RCS)                                             60036021
         EX    RA0,DX4(RCS)                                             60042021
       LR      RW4,RW2                                                  60048021
       SR      RW4,RW3            RW4 NOW HAS NUMBER TO DELETE          60054021
       BC      ZERO,PKTB8         EXIT IF NONE                          60060021
         L     RW6,DX0(RW1)        RW6 HAS ADDR. OF TAMM                60066021
         LH    RW5,DX4(RW6)                                             60072021
       SR      RW5,RW4            RW5 NOW HAS NUMBER REMAINING          60078021
         LH    RW4,DX4(RW6)                                             60084021
       BC      NEG,PKTB8           IMPOSSIBLE I HOPE                    60090021
         STH   RW5,DX4(RW6)        STORE TAMM DISPL. FOR EXIT           60096021
       BC      ZERO,PKTB6         NO MOVING TO DO                       60102021
*                                                                       60108021
       SR      RW4,RW2            RW4 NOW HAS NUMBER TO MOVE            60114021
         AL    RW2,DX0(RW6)        RW2 NOW HAS SOURCE ADDR.             60120021
         AL    RW3,DX0(RW6)        RW3 NOW HAS TARGET ADDR.             60126021
*                                                                       60132021
PKTB2  CH      RW4,N256                                                 60138021
       BC      NOTHI,PKTB4         LESS THAN 256                        60144021
         MVC   DX0(LX256,RW3),DX0(RW2) MOVE BLOCKS OF 256 BYTES         60150021
         LA    RW2,DX256(RW2)                                           60156021
         LA    RW3,DX256(RW3)                                           60162021
       SH      RW4,N256                                                 60168021
       BC      UNCOND,PKTB2        IS IT NOW LESS THAN 256              60174021
*                                                                       60180021
PKTB4  LTR     RW4,RW4                                                  60186021
       BC      ZERO,PKTB6          RW4 NOW CONTAINS ZERO                60192021
       BCTR  RW4,RA0               DECR NO. OF BYTES LEFT BY 1          60198021
       EX      RW4,PKTBMV          MOVE REMAINDER MOD 256               60204021
*                                                                       60210021
PKTB6  EQU     *                                                        60216021
       LM      RW2,RW6,SVPKTB                                           60222021
         LA    RCS,DX4(RCS)                                             60228021
       STM     RCS,RW4,SVTAME     GO UPDATE SAVED DISPL.                60234021
       BC      UNCOND,PREMV4       GO UPDATE DISPLACEMENT               60240021
PKTB8  LM      RW2,RW6,SVPKTB                                           60246021
         BC    UNCOND,DX8(RCS)     RETURN                               60252021
*                                                                       60258021
PKTBMV   MVC   DX0(LX1,RW3),DX0(RW2)                                    60264021
       SPACE   3                                                        60270021
*                                                                       60276021
*                                                                       60282021
*              ROUTINE TO REINITIALIZE A TAMER TABLE                    60288021
*                                                                       60294021
*                                                                       60300021
*                             P Z S T R T                               60306021
*                                                                       60312021
*        BAL   RCS,PZSTRT                                               60318021
*      LA      N,ADDR. OF TIB-1    N IS NUMBER OF TABLES                60324021
*      LA      X,ADDR. OF TIB-2    X IS IGNORED,MAY BE 0-15             60330021
*      .       .                                                        60336021
*      .       .                                                        60342021
*      LA      X,ADDR. OF TIB-N                                         60348021
*        (RETURN)                                                       60354021
*                                                                       60360021
*      SETS DISPL. FIELD OF TAMM TO 0 FOR EACH TABLE                    60366021
*      SETS SAVED DISPL. TO 0 FOR EACH TABLE                            60372021
*                                                                       60378021
*                                                                       60384021
PZSTRT EQU     *                                                        60390021
       STM     RAS,RW3,SVPZST                                           60396021
       SR      RA0,RA0                                                  60402021
         IC    RA0,DX1(RCS)        RA0 CONTROLS LOOP                    60408021
         SRA   RA0,DX4                                                  60414021
       LA      RW1,X'F0'          RW1 EFFECTIVELY MAKES PZS2  L 15,     60420021
*                                                                       60426021
PZS2     EX    RW1,DX0(RCS)                                             60432021
         XC    DX4(LX2,RAS),DX4(RAS) ZERO SAVED DISPL.                  60438021
         L     RW3,DX0(RAS)        GIVE RW3 TAMM ADDR                   60444021
         L     RW3,DX0(RW3)                                             60450021
         XC    DX4(LX2,RW3),DX4(RW3) STORE 0 AS DISPL                   60456021
         LA    RCS,DX4(RCS)         POINT RCS AT NEXT INSTR.            60462021
       BCT     RA0,PZS2            RETURN FOR NEXT TABLE                60468021
       LM      RAS,RW3,SVPZST                                           60474021
         BCR   UNCOND,RCS          RETURN                               60480021
       SPACE   3                                                        60486021
*                                                                       60492021
*                             C O U N T                                 60498021
*      L       RW2,ADDR.                                                60504021
*      .                                                                60510021
*      .                                                                60516021
*      BAL     RCS,COUNT                                                60522021
*      (RETURN)                                                         60528021
*                                                                       60534021
*                                                                       60540021
*      COMPUTES TOTAL BYTE-COUNT OF ENTITY AT 0(RW2), STORES IT IN      60546021
*        HALF-WORD LOCATION 'BYTES'.                                    60552021
*                                                                       60558021
*                                                                       60564021
*                                                                       60570021
COUNT    EQU   *                                                        60576021
       STM     RCS,RW1,SVCONT                                           60582021
         SR    RW1,RW1                                                  60588021
         IC    RW1,DX0(RW2)                                             60594021
         SRA   RW1,DX6                                                  60600021
         LA    RW1,DX1(RW1)                                             60606021
       BC      NOTZER,COUNT2      FIXED-LENGTH                          60612021
         IC    RW1,DX1(RW2)        VARIABLE-LENGTH                      60618021
       LTR     RW1,RW1                                                  60624021
       BC      ZERO,CNTDMP        CATASTROPHE IF COUNT=0                60630021
         LA    RW1,DX2(RW1)                                             60636021
COUNT2 STH     RW1,BYTES                                                60642021
       LM      RCS,RW1,SVCONT                                           60648021
       BCR     UNCOND,RCS          RETURN                               60654021
*                                                                       60660021
CNTDMP EQU     *                                                        60666021
       BAL     RCS,ERROR           ISSUE ERROR MESSAGE                  60672021
       LA      RW1,ELST58                                               60678021
       BC    UNCOND,EOF1              EXIT FROM PHASE4                  60684021
       SPACE   3                                                        60690021
*                                                                       60696021
*                                                                       60702021
*                                 G O B A C K                           60708021
*                                                                       60714021
*      L       RW1,ADDR. OF TIB                                         60720021
*      .                                                                60726021
*      .                                                                60732021
*      BAL     RCS,GOBACK                                               60738021
*      DC      XL2'N'                                                   60744021
*                                                                       60750021
*                                                                       60756021
*      STORES AT ADNTRY THE ADDRESS OF THE NTH ENTRY                    60762021
*        FROM THE END OF A VARIABLE-LENGTH TAMER TABLE                  60768021
*                                                                       60774021
*                                                                       60780021
GOBACK EQU     *                                                        60786021
       STM   RW2,RW4,SVGOBK                                             60792021
         L     RW2,DX0(RW1)                                             60798021
         LH    RW3,DX4(RW2)                                             60804021
         L     RW2,DX0(RW2)                                             60810021
       AR      RW2,RW3            RW2 GETS ADDR. OF END OF TABLE        60816021
         LH    RW4,DX0(RCS)        RW4 KEEPS TRACK OF N                 60822021
       SR      RW3,RW3                                                  60828021
GOBAK2 BCTR  RW2,RA0               SUBTRACT ONE                         60834021
         IC    RW3,DX0(RW2)        PUT TRAILING BYTE-COUNT IN RW3       60840021
       SR      RW2,RW3            POINT RW2 AT START OF PRECEDING E     60846021
       BCT     RW4,GOBAK2         RETURN FOR PRECEDING ENTRY TO THI     60852021
       ST    RW2,ADNTRY                                                 60858021
       LM    RW2,RW4,SVGOBK                                             60864021
         BC    UNCOND,DX2(RCS)     RETURN                               60870021
       EJECT                                                            60876021
*=2    STOINP    ROUTINES TO STORE OUTPUT BEFORE GENERATING             60882021
IKF402   CSECT                                                          60888021
COMON2   EQU   *                                                        60894021
*                                                                       60900021
*                                                                       60906021
*                                                                       60912021
*                           S T O I N P                                 60918021
*                           S T O R 4 5                                 60924021
*                           S T P N I N                                 60930021
*                           S T L O O P                                 60936021
*                                                                       60942021
*                                                                       60948021
*      ROUTINE TO STORE SOMETHING AT NEXT POSITION OF VERB-STRING       60954021
*                                                                       60960021
*      THERE ARE FOUR ENTRANCES TO THIS ROUTINE                         60966021
*                                                                       60972021
*      BAL   RCS,STOINP       TO STORE CURRENT ENTITY FROM INPUT        60978021
*      (RETURN)                                                         60984021
*                                                                       60990021
*      BAL     RCS,STOR45    TO STORE ENTITY AT 0(RW4)                  60996021
*      (RETURN)                                                         61002021
*                                                                       61008021
*      BAL     RCS,STPNIN         TO STORE THE P2-TEXT EQUIVALENT O     61014021
*      (RETURN)                   CURRENT INPUT ENTITY WHEN IT IS (     61020021
*                                 MAY BE) ONE WHOSE P2 DIFFERS FROM     61026021
*                                                                       61032021
*                                                                       61038021
*      BAL     RCS,STLOOP         TO STORE IN SUCCESSION THE N ENTI     61044021
*      DC      XL2'N'              WHOSE ADDRESSES ARE INDICATED BY     61050021
*      LA      RW4,ENTITY-1        LA INSTRUCTION. (CALLS STOR45)       61056021
*      LA      RW4,ENTITY-2                                             61062021
*      .                                                                61068021
*      .                                                                61074021
*      LA      RW4,ENTITY-N                                             61080021
*                                                                       61086021
*                                                                       61092021
*            VERB-STRING IS A TAMER TABLE WHERE OUTPUT IS COLLECTED     61098021
*            BEFORE BEING GENERATED                                     61104021
*                                                                       61110021
*** SUBROUTINES CALLED                                                  61116021
*      ALL ROUTINES CALL PNSRTV ROUTINE, WHICH  UPDATES TAMER           61122021
*      TABLE POINTERS AND APPENDS BYTE-COUNT OF ENTITY AT END OF        61128021
*      ENTRY BEING STORED                                               61134021
*      STLOOP CALLS STOR45                                              61140021
*                                                                       61146021
*                                                                       61152021
STOR45   EQU   *                                                        61158021
       TM      STO5SW,MSWON        DOES STO5 APPLY, THIS VERB...        61164021
       BC      ONES,STO545          YES, BRANCH TO STO5 ROUTINES        61170021
STOR4A STM     RCS,RW5,SVSTO       SAVE REGISTERS                       61176021
       BC      UNCOND,STO2         GO TO STORE IN VERB STRING           61182021
*                                                                       61188021
STPNIN EQU     *                                                        61194021
       TM      STO5SW,MSWON       DOES STO5 APPLY                       61200021
       BC      ONES,ST5PNI          YES - BRANCH                        61206021
STPNIA STM     RCS,RW5,SVSTO                                            61212021
         CLI   DX0(RIN),MPNU       IS IT RHN                            61218021
       BC      EQ,STPNI2            YES                                 61224021
         CLI   DX0(RIN),MPND       IS IT LHN                            61230021
       BC      NOTEQ,STO1          NO - GO TO ORDINARY STOINP           61236021
       LA      RW4,PNDEF                                                61242021
         BC    UNCOND,*+NX8        MOVE IN PN NO,PRTY NO,THEN STORE     61248021
STPNI2 LA      RW4,PNREF          POINT RW4 TO PROPER HEADER            61254021
         MVC   PROCNM(LX2,RW4),PNIDEN(RIN) MOVE IN PN NUMBER            61260021
         MVC   PRIOTY(LX1,RW4),PTYPN(RIN) PRIORITY NUMBER               61266021
       BC      UNCOND,STO2        GO STORE                              61272021
*                                                                       61278021
STOINP   EQU   *                                                        61284021
       TM      STO5SW,MSWON        DOES STO5 APPLY, THIS VERB...        61290021
       BC      ONES,STO5IN          YES, BRANCH TO STO5 ROUTINES        61296021
STOINA STM     RCS,RW5,SVSTO       SAVE REGISTERS                       61302021
STO1   LR      RW4,RIN                                                  61308021
*                                                                       61314021
*              STORE IN VERB STRING                                     61320021
*                                                                       61326021
STO2     L     RW1,ASTRNG                                               61332021
       BAL     RCS,PNSRTV         INSERT IN STRING TABLE                61338021
         LA    RW4,DX0(RW4)                                             61344021
       LM      RCS,RW5,SVSTO                                            61350021
         BCR   UNCOND,RCS          RETURN                               61356021
*                                                                       61362021
*                                                                       61368021
*                                                                       61374021
STLOOP EQU     *                                                        61380021
       STM     RCS,RW4,SVSTLP                                           61386021
         LH    RW3,DX0(RCS)        GIVE COUNT TO RW3                    61392021
         LA    RAS,DX2(RCS)         SAVE RCS AND POINT RAS AT 1ST LA    61398021
STLOP2   EX    RA0,DX0(RAS)            LOAD RW4                         61404021
       BAL     RCS,STOR45           GO STORE                            61410021
         LA    RAS,DX4(RAS)        POINT RAS AT NEXT                    61416021
       BCT     RW3,STLOP2         LOOP BACK TILL FINISHED               61422021
       LR      RCS,RAS            RESTORE RCS TO RETURN ADDR.           61428021
         LM    RAS,RW4,SVSTLP+NX4                                       61434021
       BCR     UNCOND,RCS          RETURN                               61440021
         EJECT                                                          61446021
*******************************************************************     61452021
*                                                                       61458021
*                                                                       61464021
*                           S T O 5 I N                                 61470021
*                           S T O 5 4 5                                 61476021
*                           S T 5 P N I                                 61482021
*                                                                       61488021
*                                                                       61494021
*      THIS ROUTINE SERVES TO BREAK LONG STRINGS UP INTO A SERIES       61500021
*              OF SUBSTRINGS EACH OF WHICH HAS A VERB, AN ELEMENT       61506021
*              COUNT = TO STO5LM                                        61512021
*                                                                       61518021
*      THE CALLING SEQUENCE IS...                                       61524021
*              FOR  STOINP,...                                          61530021
*      BAL     RCS,STO5IN                                               61536021
*              FOR STOR45...                                            61542021
*      BAL     RCS,STO545                                               61548021
*              FOR STPNIN                                               61554021
*      BAL     RCS,ST5PNI                                               61560021
*                                                                       61566021
*      REMAINDER OF CALLING SEQUENCE IS THE SAME AS                     61572021
*        FOR STOINP,STOR45,STPNIN                                       61578021
*                                                                       61584021
*                                                                       61590021
*** SUBROUTINES CALLED                                                  61596021
*      STOINP,STOR45,STPNIN,GENSTR,STOVRB                               61602021
*                                                                       61608021
*                                                                       61614021
*** NOTES                                                               61620021
*      STO5LM = 5 UNLESS SOME VERB ANALYZER CHANGES IT. VERB ANALYZ     61626021
*       MUST RESTORE THE 5 BEFORE EXIT.                                 61632021
*      STO5J IS THE ELEMENT COUNTER.IT IS INITIALIZED AT 0 BY IDENT     61638021
*        AND REINITIALIZED HERE EVERY TIME THE LIMIT OF ELEMENTS IS     61644021
*        REACHED AND A VERB IS STORED AGAIN                             61650021
*      STO5VE IS THE DISPLACEMENT OF THE LAST VERB STORED               61656021
*      STO5CT IS TURNED OFF BY IDENT, ON BY VERBS NEEDING IT.           61662021
*        WHEN OFF EACH STRING OF 5 ELEMENTS IS GENERATED WHEN COMPL     61668021
*        WHEN ON, STRINGS ARE LEFT TO PILE UP IN THE TABLE              61674021
*                                                                       61680021
*                                                                       61686021
*******************************************************************     61692021
STO5IN EQU     *                                                        61698021
       STM     RCS,RW2,SVSTO5      SAVE REGISTERS                       61704021
         LA    RW1,DX0              3 TO I IN RW1                       61710021
       BC      UNCOND,STO51        GO TO COMMON CODING                  61716021
STO545 EQU     *                                                        61722021
       STM     RCS,RW2,SVSTO5      SAVE REGISTERS                       61728021
         LA    RW1,DX4              I = 1 (*4)                          61734021
       BC      UNCOND,STO51        GO TO COMMON CODING                  61740021
ST5PNI EQU     *                                                        61746021
       STM     RCS,RW2,SVSTO5      SAVE REGISTERS                       61752021
         LA    RW1,DX8              I = 2 (*4)                          61758021
STO51  LH      RW2,STO5J           J TO RW2     COMMON CODING ENTRY     61764021
         CLC   STO5J+NX1(LX1),VERB+NX2 DOES J = MAX ELEMENT COUNT FOR V 61770021
       BC      EQ,STO52             YES, GO BREAK STRING                61776021
         LA    RW2,DX1(RW2)         J = J + 1  IN RW2                   61782021
STO53  STH     RW2,STO5J           SAVE NEW J FOR NEXT TIME THRU        61788021
       BC      UNCOND,STO54(RW1)   TRANSFER VECTOR TO STO ROUTINES      61794021
STO54  BC      UNCOND,STO55        KEEP                                 61800021
       BC      UNCOND,STO56             THESE                           61806021
       BC      UNCOND,STO57                  CONSECUTIVE.               61812021
STO55  LM      RCS,RW2,SVSTO5      EXITS                                61818021
       BC      UNCOND,STOINA             TO                             61824021
STO56  LM      RCS,RW2,SVSTO5               STO                         61830021
       BC      UNCOND,STOR4A                    SUB-                    61836021
STO57  LM      RCS,RW2,SVSTO5                       ROUTINES            61842021
       BC      UNCOND,STPNIA       STORE                                61848021
STO52  TM      STO5CT,MSWON        IS STRING CONTIN-SEGMENTED...        61854021
       BC      ONES,STO58           YES, DO NOT BREAK                   61860021
       BAL     RCS,GENSTR           NO, BREAK                           61866021
STO58    MVC   STO5VE(LX2),DSPSTR   SAVE THIS VERB'S DISPL.             61872021
       BAL     RCS,STOVRB          ENSTRING CURRENT VERB                61878021
*                                  IS A REPEAT OF THE CURRENT VERB.     61884021
         LA    RW2,DX1              START NEW J COUNT OF 1              61890021
       BC      UNCOND,STO53        CONTINUE PROCESSING                  61896021
       SPACE   3                                                        61902021
*                                                                       61908021
*                                                                       61914021
*                           S T O 5 C U                                 61920021
*                                                                       61926021
*      BAL     RCS,STO5CU                                               61932021
*      (RETURN)                                                         61938021
*                                                                       61944021
*      APPENDS COBOL WORD 'END' AS LAST ELEMENT OF A SEGMENTED STRI     61950021
*       CREATED BY THE STO5.. ROUTINES. ENTERS THE ELEMENT COUNT OF     61956021
*       THE LAST SUBSTRING INTO THE VERB. REINITIALIZES STO5J.          61962021
*       GENERATES                                                       61968021
*                                                                       61974021
*                                                                       61980021
*** SUBROUTINES CALLED                                                  61986021
*      CALLS STO545 TO STORE THE 'END'                                  61992021
*      GENSTR                                                           61998021
*                                                                       62004021
*                                                                       62010021
*                                                                       62016021
STO5CU STM     RCS,RW4,SVSTCU                                           62022021
       LA      RW4,CBEND           PUT C.W. 'END' IN AS TERMINATOR      62028021
       BAL     RCS,STO545          STORE 'END' IN STRING                62034021
       L       RW1,ASTRNG          J REPLACES COUNT IN STRING           62040021
         L     RW1,DX0(RW1)                                             62046021
         L     RW1,DX0(RW1)                                             62052021
       AH      RW1,STO5VE          ADD DISPL OF LAST VERB IN STRING     62058021
         MVC   DX2(LX1,RW1),STO5J+NX1 SET J IN AS NEW ELEMENT COUNT     62064021
       BAL     RCS,GENSTR          GENERATE THIS STRING SEGMENT         62070021
         XC    STO5J(LX2),STO5J    SET J = 0                            62076021
       LM      RCS,RW4,SVSTCU                                           62082021
       BCR     UNCOND,RCS          RETURN                               62088021
       SPACE   3                                                        62094021
*                                                                       62100021
*                           S T O 5 B G                                 62106021
*                                                                       62112021
*      BAL     RCS,STO5BG                                               62118021
*      (RETURN)                                                         62124021
*                                                                       62130021
*      STARTS A CONTINUOUS STRING BY STORING VERB AND COBOL WORD        62136021
*       'FIRST' AS ITS 1ST OPERAND                                      62142021
*                                                                       62148021
*** SUBROUTINES CALLED                                                  62154021
*      STOVRB,STO545                                                    62160021
*                                                                       62166021
STO5BG STM     RCS,RW4,SVSTCU                                           62172021
       OI      STO5SW,MSWON                                             62178021
       BAL     RCS,STOVRB          STORE VERB IN STRING                 62184021
       LA      RW4,CBFRST                                               62190021
       BAL     RCS,STO545          STORE FIRST IN STRING                62196021
       LM      RCS,RW4,SVSTCU                                           62202021
       BCR     UNCOND,RCS          RETURN                               62208021
       SPACE   3                                                        62214021
*                                                                       62220021
*                                                                       62226021
*                           S T O D U M                                 62232021
*                                                                       62238021
*      BAL     RCS,STODUM                                               62244021
*      (RETURN)                                                         62250021
*                                                                       62256021
*      PLACES A FIGCON ZERO INTO STRING AS A DUMMY ELEMENT.             62262021
*                                                                       62268021
*** SUBROUTINES CALLED                                                  62274021
*      STOR45                                                           62280021
*                                                                       62286021
*                                                                       62292021
STODUM STM     RCS,RW5,ONSVRG                                           62298021
       LA      RW4,CBZERO          STARTING SOURCE ADDR                 62304021
       BAL     RCS,STOR45          PUT ZERO INTO STRING                 62310021
       LM      RCS,RW5,ONSVRG                                           62316021
       BCR     UNCOND,RCS          LEAVE STODUM                         62322021
       SPACE   3                                                        62328021
*                                                                       62334021
*                                                                       62340021
*                           S T O V R B                                 62346021
*                                                                       62352021
*                                                                       62358021
*      ROUTINE TO STORE VERB ALONG WITH ELEMENT COUNT                   62364021
*        IN STRING TAMER-TABLE                                          62370021
*                                                                       62376021
*      BAL     RCS,STOVRB                                               62382021
*      (RETURN)                                                         62388021
*                                                                       62394021
*                                                                       62400021
*** SUBROUTINES CALLED                                                  62406021
*      STOR45                                                           62412021
*                                                                       62418021
*                                                                       62424021
*                                                                       62430021
STOVRB ST      RCS,SVSTVB                                               62436021
         ST    RW4,SVSTVB+NX4                                           62442021
       LA      RW4,VERB                                                 62448021
       BAL     RCS,STOR4A         AVOID STO5 CHECK                      62454021
       L       RCS,SVSTVB                                               62460021
         L     RW4,SVSTVB+NX4                                           62466021
       BCR     UNCOND,RCS          RETURN                               62472021
       SPACE   3                                                        62478021
*                                                                       62484021
*                                                                       62490021
*                             P G O N X T                               62496021
*                                                                       62502021
*      ROUTINE TO STORE                                                 62508021
*                'GO'                                                   62514021
*                'COUNT-1'                                              62520021
*                'RGN-NEXT-SENTENCE'    IN VERB STRING                  62526021
*                                                                       62532021
*        BAL   RCS,PGONXT                                               62538021
*        (RETURN)                                                       62544021
*                                                                       62550021
*** SUBROUTINES CALLED                                                  62556021
*      STOR45,NEWNXT                                                    62562021
*                                                                       62568021
PGONXT   ST    RCS,SVGONX                                               62574021
         ST    RW4,SVGONX+NX4                                           62580021
       LA      RW4,CBGO                                                 62586021
       BAL     RCS,STOR45          STORE 'GO' IN STRING                 62592021
         BAL   RCS,NEWNXT          GET NXTSNT IF NONE EXISTS            62598021
         MVC   RGN+NX1(LX2),NXTSNT                                      62604021
       LA      RW4,RGN                                                  62610021
       BAL     RCS,STOR45          STORE GN REF IN STRING               62616021
         L     RW4,SVGONX+NX4                                           62622021
         L     RCS,SVGONX                                               62628021
         BCR   UNCOND,RCS          RETURN                               62634021
         EJECT                                                          62640021
*=2    RDUCOP    CONTROL ROUTINE FOR DATA-OPERANDS                      62646021
*                                                                       62652021
*                             R D U C O P                               62658021
*                                                                       62664021
*      BAL     RCS,RDUCOP                                               62670021
*      (RETURN NOT A DATA-OPERAND)                                      62676021
*      (RETURN OK OPERAND)                                              62682021
*                                                                       62688021
*                                                                       62694021
*** SUBROUTINES CALLED                                                  62700021
*      ISDTOP,SUBSCR                                                    62706021
*                                                                       62712021
*        ISDTOP,WHICH REDUCES 'ALL 'CHAR' ' TO A FIGCON                 62718021
*                             '+ (-) NUMERIC OR FLOATING LIT' TO LI     62724021
*        SUBSCR,WHICH REDUCES SUBSCRIPTED DATA-NAME TO SSID             62730021
*                                                                       62736021
*                                                                       62742021
*** NOTES                                                               62748021
*      UPON EXIT, THE ENTITY AT 0+PNTIN IS THE REDUCED OPERAND, AND     62754021
*        MODE AND DCURR CONTAIN THE SUMMARY OF ITS ATTRIBUTES.          62760021
*        (NOTE THAT IF SUBSCR WAS CALLED PNTIN HAS THE ADDR. OF         62766021
*         CURENT RATHER THAN OF INPUT BUFFER.)                          62772021
*                                                                       62778021
*                                                                       62784021
*                                                                       62790021
RDUCOP EQU          *                                                   62796021
       ST      RCS,SVRDUC                                               62802021
       BAL     RCS,ISDTOP         IS INPUT A DATA-NAME,LIT OR FIGCO     62808021
       BC      UNCOND,RDUCO4        NO - EXIT NO GOOD                   62814021
       TM      MODE,MLITBT        IS IT DATA-NAME                       62820021
       BC      ONES,RDUCO2          NO - EXIT OK                        62826021
       BAL     RCS,SUBSCR           YES- REDUCE TO SSID IF SUBSCRIP     62832021
RDUCO2 L       RCS,SVRDUC           NO - EXIT OK                        62838021
         BC    UNCOND,DX4(RCS)     RETURN                               62844021
RDUCO4 L       RCS,SVRDUC                                               62850021
       BCR     UNCOND,RCS          RETURN                               62856021
       EJECT                                                            62862021
*=2    SUBSCR    TURN SUBSCRIPTED DN TO SSID,TABLE SS-DEFINING STRI     62868021
*******************************************************************     62874021
*                                                                       62880021
*                                                                       62886021
*                                S U B S C R                            62892021
*                                                                       62898021
*      BAL     RCS,SUBSCR                                               62904021
*      (RETURN)                                                         62910021
*                                                                       62916021
*      CALLED BY RDUCOP                                                 62922021
*                                                                       62928021
*** SUBROUTINES CALLED                                                  62934021
*      GETNXT,SAVNXT,SAVCUR,COUNT,PNSRTF,ISINTG,ERROR                   62940021
*                                                                       62946021
*                                                                       62952021
*** ERROR PROCESSING                                                    62958021
*      ANY ERROR FOUND CAUSES INPUT (AT CURENT) TO BE REPLACED BY       62964021
*        ERROR-SYMBOL AND MODE BY 0. VERB ANALYZERS WILL THEN TREAT     62970021
*        THE INCORRECTLY SUBSCRIPTED NAME AS A LEPER.                   62976021
*      A SUBSCRIPT GROUP IS CONSIDERED TO START ONLY IF ( FOLLOWS       62982021
*        THE DATA NAME AND TO END AT THE FIRST NON-OPERAND (OPERAND     62988021
*        INCLUDES DATA OPERANDS,NON-DATA OPERANDS, AND ERROR SYMBOL     62994021
*      ERRORS DIAGNOSED ARE                                             63000021
*              INCORRECT NUMBER OF SUBSCRIPTS                           63006021
*              NON-NUMERIC SUBSCRIPT                                    63012021
*              NON-INTEGER SUBSCRIPT                                    63018021
*              SUBSCRIPT WHICH ITSELF SHOULD BE SUBSCRIPTED             63024021
*              INCORRECT TERMINATOR                                     63030021
*                                                                       63036021
*                                                                       63042021
*** NOTES                                                               63048021
*      DECIDES WHETHER DATA-NAME IS SUBSCRIPTED.IF NOT,EXITS.           63054021
*      IF SO,FOR ALL CASES EXCEPT MOVE-,ADD-,SUBTRACT-CORRESPONDING     63060021
*       PUTS INTO THE SUBSCRIPT-DEFINING TABLE FOR CORRECTLY WRITTE     63066021
*       SUBSCRIPTED VARIABLES,THE FOLLOWING STRING.                     63072021
*                   SSVERB    (EL.COUNT=2+NO. OF SUBSCRIPTS)            63078021
*                   DATA-NAME    (SUBSCRIPTED VARIABLE)                 63084021
*                   DN OR NUMLIT (SUBSCRIPT 1)                          63090021
*                   DN OR NUMLIT (SUBSCRIPT 2 IF PRESENT)               63096021
*                   DN OR NUMLIT (SUBSCRIPT 3 IF PRESENT)               63102021
*                   SSID         (SAME AS DATA-NAME ABOVE,BUT WITH      63108021
*                                  HEADER OF 31 INSTEAD OF 30,AND W     63114021
*                                  A 2-BYTE BINARY UNIQUE IDENTIFIE     63120021
*                                 REPLACING ADDRESSING PARAMETERS)      63126021
*       SUBSTITUTES THE SSID FOR THE ORIGINAL DATA-NAME IN 'INPUT',     63132021
*       WHICH,THROUGH SAVCUR ROUTINE,IS DESIGNATED AS BEING AT LOC.     63138021
*       CURENT.                                                         63144021
*                                                                       63150021
*     WHEN VERB ANALYZERS CREATE THEIR STRINGS, THEY USE THE SSID       63156021
*       INSTEAD OF THE ORIGINAL INPUT.                                  63162021
*                                                                       63168021
*      GENSTR GENERATES ENTIRE CONTENTS OF SUBSCRIPT-DEFINING TABLE     63174021
*     DEFSBS, B E F O R E  CONTENTS OF STRING TABLE.                    63180021
*                                                                       63186021
*      IDENT REINITIALIZES (EMPTIES) DEFSBS.                            63192021
*      VERB ANALYZERS WHICH NEED TO SAVE THE SUBSCRIPT-DEFINING STR     63198021
*       FOR A RE-USABLE OPERAND-1 (EG.,'MOVE SUBSCRIPTED-VARIABLE T     63204021
*       X,Y,Z ... IF SUBSCRIPTED-VARIABLE = X OR Y AND Z') SAVE DIS     63210021
*       GIVEN BY THE SUBSCR ROUTINE, AT LEFTSS AND REINITIALIZE DEF     63216021
*       AS NEEDED.                                                      63222021
*                                                                       63228021
*                                                                       63234021
*      IF ANY ERROR IN SUBSCRIPTING IS FOUND,NOTHING IS PUT IN DEFS     63240021
*       AND ERROR-SYMBOL IS SUBSTITUTED FOR THE DATA-NAME IN 'CUREN     63246021
*       RDUCOP REJECTS THIS AS AN OPERAND.                              63252021
*                                                                       63258021
*                             **********                                63264021
*                                                                       63270021
*      MOVE-, ADD-, SUBTRACT-CORRESPONDING REQUIRE SPECIAL HANDLING     63276021
*       SINCE PHASE-3 SENDS ON THE SOURCE-PROGRAM FORM TO PHASE 4 F     63282021
*       SYNTAX ANALYSIS,BUT NO STRINGS CAN BE GENERATED FROM THIS.      63288021
*       THEN IT SENDS THE CORRESPONDING-SERIES EXPANSIONS BUT WITHO     63294021
*       INCLUDING THEIR SUBSCRIPTS.                                     63300021
*                                                                       63306021
*      WHEN THE 3  ANALYZERS FIND THE WORD 'CORRESPONDING' IMMEDIAT     63312021
*       AFTER THE VERB, THEY TURN ON DRYRUN SWITCH, INDICATING SYNT     63318021
*       CHECK BUT NO STRING PRODUCTION. WHEN THEY ARE ABOUT TO EXIT     63324021
*       IDENT AND DRYRUN IS ON, THEY TURN IT OFF AND TURN ON CORRSW     63330021
*       INDICATING THAT WHAT FOLLOWS IS PHASE-3 EXPANSION. THE NEXT     63336021
*     OCCURRENCE OF THE WORD'CORRESPONDING' INDICATES THE END OF        63342021
*       PHASE-3 EXPANSIONS.                                             63348021
*                                                                       63354021
*      EACH ANALYZER BEFORE CALLING RDUCOP,STORES AT LOC. THISOP TH     63360021
*       ADDRESS OF EITHER LOC. OPRND1 OR LOC. OPRND2, ACCORDING TO      63366021
*       WHICH OF ITS OPERANDS IT IS PROCESSING.                         63372021
*                                                                       63378021
*      DURING A 'DRY-RUN' SUBSCR, INSTEAD OF PUTTING A SUBSCRIPT-DE     63384021
*       ING STRING IN DEFSBS, SIMPLY PRESERVES THE SUBSCRIPTS THEM-     63390021
*       SELVES AT WHICHEVER LOC. THISOP INDICATES. THE ANALYZERS NO     63396021
*       FOR THEMSELVES WHETHER,DURING DRY-RUN, OPERAND-1,OPERAND-2,     63402021
*       BOTH WERE SUBSCRIPTED.                                          63408021
*                                                                       63414021
*      ON THE NEXT TIME THRU, WHEN CORRSW IS ON, THEY TURN ON OPSSS     63420021
*       IF THE RESPECTIVE OPERAND WAS SHOWN TO BE SUBSCRIPTED DURIN     63426021
*       THE DRY-RUN.  NOW SUBSCR, FINDING OPSSSW ON,GETS THE SUBSCR     63432021
*       FOR THE OPERANDS CREATED BY PHASE-3 FROM THE LOC. INDICATED     63438021
*       BY THISOP (RATHER THAN FROM THE INPUT STREAM AS IN ORDINARY     63444021
*       CASES).IT THEN CREATES THE SUBSCRIPT-DEFINING STRING FOR EA     63450021
*       OF THESE IN TURN AND SUBSTITUTES AN SSID FOR EACH OPERAND       63456021
*       SENT AS PHASE-3 CORRESPONDING-EXPANSION.                        63462021
*                                                                       63468021
*******************************************************************     63474021
       SPACE   3                                                        63480021
SUBSCR EQU     *                 SUBSCRIPT ROUTINE                      63486021
       CLI     GOTTEN,MSS         EXIT IF SUBSCR HAS ALREADY PROCES     63492021
       BCR     EQ,RCS                   THIS INPUT                      63498021
       STM     RCS,RW6,SVSUBS                                           63504021
       NI    MININDEX,MSWOFF                                            63510021
         NI    INDSW,MSWOFF                                             63516021
         XC    SIZ35S(LX2),SIZ35S  ZERO COUNTERS FOR SPECIAL EXHIBIT    63522021
         XC    CNT35S(LX2),CNT35S    STRINGS                            63528021
         MVC   SSNUMB+NX2(LX2),DSPSBS SAVE PRESENT SBS TABLE DISPL.     63534021
       BAL     RCS,KEEP35         STORE DN FOR EXHIBIT-NAMED            63540021
         CLI   DX0(RIN),MSPDN      FOR STANDARD NAMES, DONT SEEK SS     63546021
       BC      EQ,SUBS15           GO TO EXIT                           63552021
       LR      RW1,RIN                                                  63558021
         IC    RW6,DX3(RW1)                                             63564021
         SRL   RW6,DX2            GET ELEMENTARY ITEM MBS BITS 12,13    63570021
         STC   RW6,MBS+NX1                                              63576021
         NI    MBS+NX1,MB3                                              63582021
         MVN   BCDMBS+NX3(LX1),MBS+NX1   SAVE FOR ERROR MSG             63588021
       BAL   RCS,SAVCUR          PRESERVE CURRENT INPUT ENTITY ROUT     63594021
       TM    CORRSW,MSWON                                               63600021
       BC    ONES,SUBS17         CORRESPONDING SWITCH ON, DRYRUN OF     63606021
       BAL     RCS,GETNXT          GET NEXT INPUT                       63612021
       TM    SETRIN,MFF            WAS LAST ENTRY SETTBL ALREADY        63618021
*                    READ                                               63624021
       BO    SUBS04                GO CHECK IF SS NEEDED                63630021
         CLC   GOTTEN(LX2),CBLPRN IS IT LEFT PAREN '('                  63636021
       BC    EQ,SUBS20           '(' IS FOUND                           63642021
SUBS04   CLI   MBS+NX1,MZERO      IS SUBSCRIPTING NEEDED                63648021
       BC      NOTEQ,SUBS94        GO TO SUBSCRIPT ERROR                63654021
SUBS05 OI      NEXTIN,MSWON                                             63660021
SUBS10 NI    OPSSSW,MSWOFF       SET SWITCH OPSSSW OFF                  63666021
         MVC   MODE(LX3),CURMOD   CURRENT MODE TO MODE                  63672021
       L       RIN,ACURNT         SET RIN TO CURENT                     63678021
SUBS15 LM      RCS,RW6,SVSUBS                                           63684021
       BCR   UNCOND,RCS          EXIT                                   63690021
SUBS17 TM    OPSSSW,MSWON                                               63696021
       BC    ZERO,SUBS15         GO TO EXIT                             63702021
       L     RW5,THISOP          GET POINTER OF OPRND-1 OR 2            63708021
         BC    UNCOND,SUBS60       CONTINUE                             63714021
SUBS20 EQU     *                                                   7894 63720021
       TM      PLOGIC,MSWON   ARE WE IN IF                         7894 63726021
       BC      ZERO,SUBS22         NO                                   63732021
         CLI   MBS+NX1,XX00         YES - IS DN TO BE SUBSXRIPTED       63738021
       BC      EQ,SUBS05           NO - EXIT IT IS A LOGICAL PAREN      63744021
SUBS22 OI    SBSW,MSWON         TELL FORMLA DN WAS SUBSCRIPTED          63750021
       TM    EXHBNS,MSWON       ARE WE IN EXHIBIT NAMED                 63756021
         BC    ZERO,*+NX8          GO TO GET NEXT                       63762021
       BAL     RCS,KEP35L         STORE SPECIAL ( FOR EXHIBIT-NAMED     63768021
       BAL     RCS,GETNXT          GET NEXT INPUT                       63774021
       LR      RW5,RIN                                                  63780021
       TM    SRCHKEY,MSWON     IS THIS A KEY FROM SRCHALL               63786021
       BO    SUBS35                 YES/ DONT STORE IN SS TABLE/        63792021
*                                  JUST CHECK SYNTAX                    63798021
       TM      DRYRUN,MSWON        IS IT SOURCE-FORM OF CORRESPONDI     63804021
       BC    ZERO,SUBS60         OFF                                    63810021
       L       RVRB,THISOP        GET STORE-POINTER OF OP1 OR 2         63816021
SUBS35   XC    MBSCT(LX2),MBSCT   INITALIZE COUNT OF MBS TO ZERO        63822021
SUBS40 LR      RIN,RW5            SET RIN FOR GETMOD                    63828021
       BAL   RCS,ISDTOP          IS IT DATA OPERAND                     63834021
       BC    UNCOND,SUBS65       NOT A DATA OPERAND                     63840021
       TM    INDSW,MSWON     SS FOUND-WAS INDNM FOUND BEFORE            63846021
       BO    SBS105           YES-ERROR                                 63852021
       TM      CORRSW,MSWON                                             63858021
         BC    ONES,*+NX6          YES, GO CHECK IF IT IS INTEGER       63864021
       LR      RW5,RIN            SAFE-GUARD IF ISDTOP FOUND COND-N     63870021
       BAL     RCS,ISINT2          IS IT AN INTEGER                     63876021
       BC      UNCOND,SUBS92     NOT INTEGER                            63882021
         CLI   DX0(RW5),MDN                                             63888021
       BC      NOTEQ,SUBS46        NOT DN, STORE FOR EXHIBIT-N          63894021
         TM    DX3(RW5),MB12       IS SUBSCRIPT  SUBSCRIPTED            63900021
       BC    NOTZER,SUBS82         YES - ERROR                          63906021
SUBS46 BAL     RCS,KEEP35         SUBSCRIPT OK. STORE FOR EXHIBIT-N     63912021
SUB4   LH    RW6,MBSCT                                                  63918021
       AH    RW6,N1                                                     63924021
       STH   RW6,MBSCT           ADVANCE MBS COUNT BY 1                 63930021
       CH    RW6,MBS             COMPARE MBS COUNT WITH MBS BIT         63936021
       BC      HI,SUBS98          COUNT GREATER THAN MBS                63942021
       TM      DRYRUN,MSWON                                             63948021
       BC      ONES,SUBS75       DRYRUN IS ON                           63954021
       TM    SRCHKEY,MSWON        KEY FROM SRCHALL                      63960021
       BO    SUBS50          DO NOT INSERT KEY IN SS TABLE              63966021
       L       RW1,ADFSBS                                               63972021
       LR      RW2,RW5            GET COUNT FOR TIB                     63978021
       BAL     RCS,COUNT           GET BYTE COUNT                       63984021
         MVC   DX0(LX1,RW1),BYTES+NX1                                   63990021
       BAL     RCS,PNSRTF        INSERT FIXED-LENGTH ROUTINE            63996021
         LA    RW4,DX0(RW5)          STORE ENTITY IN SS TABLE           64002021
       TM    KEY1,MSWON            SS ASSOCIATED W/1ST KEY SRCHALL      64008021
       BZ    SUBS50                NO- CONTINUE NORMALLY                64014021
         CLI   MBS+NX1,XX02         HOW MANY SUBSCRIPTS WILL THERE BE   64020021
       BE    SUBS47                WILL BE 2 ALTOGETHER                 64026021
       BH    SUBS48                THREE                                64032021
SBS46A BAL   RCS,GETALL            LOWEST LEVEL SS                      64038021
       LA    RW2,SS1SV             LAST SS SAVED HERE                   64044021
       BC    UNCOND,SUBS50         GO PROCESS                           64050021
SUBS47   CLI   MBSCT+NX1,XX02       IS THIS 1ST OR 2ND OF TWO           64056021
       BE    SBS46A                SECOND OR LOWEST-SAVE IN SS1SV       64062021
SBS47A BAL   RCS,GETALL            1ST OF 2 OR 3-OPRND1                 64068021
       LA    RW2,OPRND1                                                 64074021
       BC    UNCOND,SUBS50         GO PROCESS                           64080021
SUBS48   CLI   MBSCT+NX1,XX02       WHICH OF 3 SS IS THIS ONE           64086021
       BH    SBS46A                LAST-SAVE IN SS1SV                   64092021
       BL    SBS47A                FIRST-OPRND1                         64098021
       BAL   RCS,GETALL            SECOND-PUT IN OPRND2                 64104021
       LA    RW2,OPRND2                                                 64110021
SUBS50 TM      CORRSW,MSWON                                             64116021
       BC      ONES,SUBS55       ON,                                    64122021
       BAL     RCS,GETNXT        OFF                                    64128021
       LR      RW5,RIN            UPDATE GET-POINTER                    64134021
       BC      UNCOND,SUBS40       GO CHECK THE OPERAND                 64140021
SUBS55 LR      RW2,RW5           LOAD ADDRESS                           64146021
       BAL     RCS,COUNT         COMPUTE BYTE COUNT ROUTINE             64152021
       AH      RW5,BYTES         UPDATE GET POINTER                     64158021
       BC      UNCOND,SUBS40       GO CHECK THE OPERAND                 64164021
SUBS60 L     RW6,ADFSBS                                                 64170021
         L     RW6,DX0(RW6)       SAVE PRESENT DISPLACEMENT OF SS TA    64176021
         MVC   SSNUMB+NX2(LX2),DX4(RW6)                                 64182021
       LH    RW3,MBS                                                    64188021
       AH    RW3,N2              ELEMENT COUNT = MBS + 2                64194021
         STC   RW3,SSVERB+NX2     SAVE ELEMENT COUNT INTO SSVERB+2      64200021
       L     RW1,ADFSBS          ADDRESS OF SS TABLE                    64206021
         MVI   DX0(RW1),MB3       BYTE COUNT IS 3 OF SSVERB             64212021
       BAL   RCS,PNSRTF          INSERT FIXED LENGTH ROUTINE            64218021
       LA      RW4,SSVERB           STORE SSVERB IN SS TABLE            64224021
       LA      RW2,CURENT         GET COUNT FOR TIB                     64230021
       BAL     RCS,COUNT           GET BYTE COUNT                       64236021
         MVC   DX0(LX1,RW1),BYTES+NX1                                   64242021
       BAL   RCS,PNSRTF            STORE SS VARIBLE IN STRING           64248021
       LA      RW4,CURENT           STORE SUBSCRIPTED VARIABLE IN S     64254021
       TM    SETRIN,MSWON         IS SETTBL BEING USED                  64260021
       BZ    SUBS35               NO- OK                                64266021
       BAL   RCS,UPDTSET          RESTORE TRUPNT AFTER TAMER CALL       64272021
       L     RW5,TRUPNT           POINT RW5 TO IT                       64278021
*                                                                       64284021
       BC    UNCOND,SUBS35         GO TO REINIT COUNT OF MBS            64290021
SUBS65   CLI   DX0(RW5),XX36       IS IT AN INDEX NAME                  64296021
       BE    SUBS66A           PROCESS INDEXING                         64302021
         CLC   DX0(LX2,RW5),CBRPRN IS IT )                              64308021
       BC    NOTEQ,SUBS96          NO                                   64314021
         CLC   MBSCT(LX2),MBS     COMPARE MBSCOUNT WITH MBS             64320021
       BC    NOTEQ,SUBS98          NOT EQUAL                            64326021
       TM    SRCHKEY,MSWON       IS THIS A KEY FOR SRCHALL              64332021
       BO    SUBS10       YES- DO NOT ENTER SSID INTO TABLE             64338021
       MVI   CURENT,MSS          MOVE SS DN CODE '31' IN CURENT HEA     64344021
       TM    DRYRUN,MSWON                                               64350021
       BC    ZERO,SUBS70         OFF                                    64356021
         MVC   DX0(LX2,RVRB),CBRPRN  STORE ')' IN OPRND1 OR 2           64362021
       BC    UNCOND,SUBS10         GO TO EXIT                           64368021
SUBS66A TM    CORRSW,MSWON         CORR OR SRCH VARYING                 64374021
       BO    SUB4                 SYNTAX ALREADY CHECKED-DONT MESSUP    64380021
         CLC   MBSCT(LX2),N0        IS THIS FIRST TIME                  64386021
       BE    SUBS67      YES                                            64392021
       TM    INDSW,MSWON      WAS INDNM FOUND BEFORE                    64398021
       BO    SUBS68A     YES-OK                                         64404021
       B     SBS105        ERROR                                        64410021
SUBS67 OI    INDSW,MSWON    1ST TIME-SW SAYS INDNM FOUND                64416021
SUBS68A BAL  RCS,GETALL            SAVE THE ENTITY                      64422021
       LA   RW2,SVINDNM                                                 64428021
       BAL   RCS,KEEP35            STORE 3K EQUIV IF EXH NAMED          64434021
       BAL   RCS,GETNXT            GET NEXT INPUT                       64440021
       CLI   GOTTEN,MSIGN    ARITH OPERATOR                             64446021
       BE    SUBS68B               YES                                  64452021
       OI    NEXTIN,MSWON                                               64458021
       LA    RIN,SVINDNM                                                64464021
       LR    RW5,RIN                                                    64470021
       B     SUB4                  INSERT IN SS TABLE                   64476021
SUBS68B  CLI   GOTTEN+NX1,XX01                                          64482021
       BH    SBS106A               GET NEXT INPUT - ERROR               64488021
       BL    SUBS68C               PLUS OR MINUS FOUND, GET NEXT        64494021
       OI    MININDEX,MSWON                                             64500021
SUBS68C BAL  RCS,GETNXT            GET NEXT INPUT                       64506021
       CLI   GOTTEN,MNLIT    PLUS OR MINUS FOUND- NEXT NUM LITERAL      64512021
       BNE    SBS106     NO                                             64518021
       LR    RW1,RIN                                                    64524021
       BAL   RCS,ISINTG            INTEGER CHECK ROUTINE                64530021
       B     SBS106   ERROR- NOT INTEGER                                64536021
       SR    RW4,RW4                                                    64542021
         IC    RW4,GOTTEN+NX1                                           64548021
       BCTR  RW4,RA0               DECR NO OF BYTES BY 1                64554021
       BCTR  RW4,RA0           GET NUMBER OF BYTES TO ZAP               64560021
       EX    RW4,ZAPLIT                                                 64566021
       CVB   RW4,TEMPZ    CONVERT RESULT TO BINARY FOR PH5              64572021
       TM    MININDEX,MSWON    WAS IT MINUS LITERAL                     64578021
       BZ    AFTERZAP              NO                                   64584021
       NI    MININDEX,MSWOFF                                            64590021
       LCR   RW4,RW4     TWOS COMPLEMENT                                64596021
AFTERZAP STH  RW4,TEMPZ                                                 64602021
         MVC   SVINDNM+NX10(LX2),TEMPZ                                  64608021
         MVI   SVINDNM+NX1,XX0A UPDATE COUNT TO REFLECT LIT ATTACHED    64614021
       LA    RIN,SVINDNM                                                64620021
       LR    RW5,RIN                                                    64626021
       B     SUB4                  INSERT IN SS TABLE                   64632021
ZAPLIT   ZAP   TEMPZ(LX8),DX3(LX0,RIN)                                  64638021
SUBS70 LH    RW6,SSNUMB                                                 64644021
       AH    RW6,N1              ADD 1 TO SSNUMB                        64650021
       STH   RW6,SSNUMB                                                 64656021
       LA      RW2,CURENT         GIVE COUNT ROUTINE ADDR.              64662021
         MVC   DX4(LX3,RW2),SSNUMB-NX1                                  64668021
         OI    DX4(RW2),XX80        TURN ON HIGH ORDER BIT              64674021
       L     RW1,ADFSBS                                                 64680021
       LA      RW2,CURENT         GET COUNT FOR TIB                     64686021
       BAL     RCS,COUNT           GET BYTE COUNT                       64692021
         MVC   DX0(LX1,RW1),BYTES+NX1                                   64698021
       BAL   RCS,PNSRTF            STORE SSID                           64704021
       LA      RW4,CURENT           STORE SSID IN TABLE                 64710021
       TM    KEY1,MSWON       IS THIS  1ST SRCHALL KEY                  64716021
       BO    SUBS72            YES- REQUIRES SPECIAL HANDLING           64722021
       TM      EXHBNS,MSWON                                             64728021
       BC      ZERO,SUBS10         OFF                                  64734021
       BAL     RCS,KEP35R         STORE SPECIAL ) FOR EXHIBIT-NAMED     64740021
       BC    UNCOND,SUBS10         GO TO EXIT                           64746021
*                  INDICATES NO SUBSCRIPTS PASSED TO PH5 FOR THIS       64752021
*                  KEY- JUST DONT PUT OUT SS STRING                     64758021
*                                                                       64764021
* IF MORE THAN ONE LEVEL OF SUBSCRIPTING OR INDEXING ON FIRST KEY       64770021
*  MUST PASS PH5 SUBSCRIPTS OR INDEXES FOR HIGHEST LEVEL AND NEXT       64776021
* LEVEL IF 3 LEVELS PRESENT- FOR HIGHEST LEVEL ONLY IF 2 LEVELS         64782021
*  PRESENT- DEFSBS TABLE WILL NOT BE USED TO PASS THIS INFO- INFO       64788021
*  WILL BE GENERATED AS OPERANDS OF BEGINNING OF WHEN VERB              64794021
*                                                                       64800021
SUBS72   MVC   SSKYSV(LX1),SSVERB+NX2  SAVE ELEM CT FOR SRCHALL         64806021
       BC    UNCOND,SBS103        RESTORE ORIG DISPL TO DEFSBS          64812021
SUBS75 LR      RW2,RW5                                                  64818021
       BAL     RCS,COUNT           GET TOTAL NO OF BYTES                64824021
       LH      RW1,BYTES                                                64830021
       BCTR  RW1,RA0               DECR NO OF BYTES BY 1                64836021
         EX    RW1,*+NX12           STORE INPUT IN OPRND1 OR 2          64842021
       AH      RVRB,BYTES        UPDATE STORE POINTER THISOP            64848021
       BC    UNCOND,SUBS50         SEE IF WE ARE CORR SERIES            64854021
         MVC   DX0(LX1,RVRB),DX0(RW5)                                   64860021
*                                                                       64866021
*                             SUBSCRIPT ERRORS                          64872021
*                                                                       64878021
SUBS82 LA      RW1,ELST4D         SUBSCRIPT IS SUBSCRIPTED              64884021
       BC      UNCOND,SBS100       GO TO WRITE ERROR MESSAGE            64890021
SUBS92 LA      RW1,ELST4E         NOT AN INTEGER                        64896021
       BC      UNCOND,SBS100       GO TO WRITE ERROR MESSAGE            64902021
SUBS94 LA      RW1,ELST4C         WRONG NUMBER OF SUBSCRIPTS            64908021
       BC      UNCOND,SBS100       GO TO WRITE ERROR MESSAGE            64914021
SUBS96 TM    SETRIN,MFF            INCASE NONOP AT END OF SETTBL        64920021
       BO    SUBS98                DONT WRITE MSG 4F-COULD CAUSE        64926021
*                   BLOWUP IF 0'S FOLLOW IN SETTBL                      64932021
       LA    RW1,ELST4F                                                 64938021
       BC      UNCOND,SBS100       GO TO WRITE ERROR MESSAGE            64944021
SUBS98   CLI   MBS+NX1,XX00                                             64950021
       BC      NOTEQ,SUBS94        SUBSCRIPT ERROR                      64956021
       LA      RW1,ELST52                                               64962021
*                                                                       64968021
SBS100 BAL     RCS,ERROR           WRITE ERROR MESSAGE                  64974021
         LA    RW1,DX0(RW1)                                             64980021
SBS102 TM    SETRIN,MFF            AT END OF SETTBL                     64986021
       BO    SBS103           GET OUT OF SCAN                           64992021
       TM    GOTTEN,MB32                                                64998021
       BC      ZERO,SBS104           NO                                 65004021
       BAL     RCS,GETNXT            YES - DISCARD TILL FIRST NON-O     65010021
       BC      UNCOND,SBS102       SEE IF IT IS END OF TABLE            65016021
SBS104   CLC   GOTTEN(LX2),CBRPRN   IS IT PAREN                         65022021
         BC    EQ,*+NX8              YES                                65028021
       OI      NEXTIN,MSWON        NO - SAVE FOR IDENT                  65034021
       TM    KEY1,MSWON          IS THIS 1ST KEY SRCHALL                65040021
       BZ    SBS103               NO                                    65046021
       OI    SKIPSW,MSWON          LET SRCHALL NOT GENR STRINGS         65052021
SBS103 L     RW6,ADFSBS           RESTORE ORIG DEFSBS DISPL             65058021
         L     RW6,DX0(RW6)                                             65064021
         MVC   DX4(LX2,RW6),SSNUMB+NX2                                  65070021
         MVC   DSPSBS(LX2),SSNUMB+NX2                                   65076021
         MVC   CNT35S(LX2),N1      LEAVE ONLY DN IN 35'S AREA           65082021
       BC      UNCOND,SUBS10      GO USE WITHOUT SUBSCRIPTS             65088021
SBS105 LA    RW1,ELST69                                                 65094021
       B     SBS100                WRITE ERROR MESSAGE                  65100021
SBS106A BAL   RCS,GETNXT           GET NEXT INPUT                       65106021
SBS106 LA    RW1,ELST6A                                                 65112021
       B     SBS100                WRITE ERROR MESSAGE                  65118021
*                                                                       65124021
       SPACE 3                                                          65130021
*                                                                       65136021
*      SUB-SUBROUTINE OF SUBSCR TO PRESERVE BCD-EQUIVALENTS OF DN'S     65142021
*               USED IN EXHIBIT-NAMED                                   65148021
*                                                                       65154021
KEP35L   MVI   PRN35+NX2,XX4D      CREATE BCD-FORM (                    65160021
         BC    UNCOND,*+NX8        GO TO STORE REGISTERS                65166021
KEP35R   MVI   PRN35+NX2,XX5D      CREATE BCD-FORM )                    65172021
       STM     RCS,RW3,SVKP35                                           65178021
       LA      RW2,PRN35          RW2 POINTS TO 35-ITEM TO STORE        65184021
       BC      UNCOND,KEP352       GO TO GET COUNT                      65190021
KEEP35 TM      EXHBNS,MSWON       ARE WE IN EXHIBIT-NAMED               65196021
       BCR     ZERO,RCS              NO - EXIT                          65202021
       STM     RCS,RW3,SVKP35        YES                                65208021
       BAL     RCS,GETALL         SAVE CURRENT OPERAND                  65214021
       LA      RW2,OPRND2                                               65220021
       TM      MODE,MLITBT        IS IT A LITERAL                       65226021
         BC    ONES,*+NX8           YES - INPUT DOES NOT HAVE 35 FOR    65232021
       BAL     RCS,GETNXT          NO - GET ITS 35-EQUIVALENT           65238021
       LR      RW2,RIN            RW2 IS STORE POINTER                  65244021
       LA      RIN,OPRND2         POINT RIN AT PRESERVED OPERAND        65250021
KEP352 BAL     RCS,COUNT           GET COUNT OF BYTES                   65256021
       LA      RW3,PLEFT               GIVE RW3 TARGET ADDR. ...        65262021
       AH      RW3,SIZ35S                 + PREVIOUS 35'S               65268021
       LH      RW1,SIZ35S                                               65274021
       AH      RW1,BYTES                                                65280021
       STH     RW1,SIZ35S         UPDATE SIZE OF STORED AREA            65286021
       LH      RW1,BYTES                                                65292021
       EX      RW1,KPMOVE         MOVE IN THE 35-ITEM                   65298021
       LH      RW1,CNT35S                                               65304021
         LA    RW1,DX1(RW1)                                             65310021
       STH     RW1,CNT35S         UPDATE COUNT OF ITEMS STORED          65316021
       LM      RCS,RW3,SVKP35                                           65322021
       BCR     UNCOND,RCS          RETURN                               65328021
*                                                                       65334021
KPMOVE   MVC   DX0(LX1,RW3),DX0(RW2)                                    65340021
*                         UPDTSET                                       65346021
* THIS ROUTINE WILL RESTORE REGISTER 12 TO POINT TO WHERE IT WAS        65352021
* IN THE SETTBL BEFORE A CALL TO TAMER WAS ISSUED.                      65358021
* IT IS CALLED AS A SAFEGUARD AGAINST TAMER RELOCATING SETTBL           65364021
UPDTSET STM  RCS,RW2,SAVEUP        SAVE REGISTERS                       65370021
       L     RW1,ASETBL                                                 65376021
         L     RW1,DX0(RW1)  ADDR TAMM                                  65382021
         L     RW2,DX0(RW1)        RW2 PTS TO ADDR TABLE                65388021
       AH    RW2,SETSVD           ADD SAVED DISPLACEMENT                65394021
       ST    RW2,TRUPNT           UPDATE TRUPNT                         65400021
       LM    RCS,RW2,SAVEUP                                             65406021
       BR    RCS          RETURN                                        65412021
       EJECT                                                            65418021
*=2    GETMOD    SET BIT PATTERN OF 'MODE' FOR VARIOUS DATA TYPES       65424021
*******************************************************************     65430021
*                                                                       65436021
*                                                                       65442021
*                               G E T M O D                             65448021
*                                                                       65454021
*                                                                       65460021
*                                                                       65466021
*      ROUTINE TO STORE AT HALF-WORD M O D E, THE MODE                  65472021
*      OF AN OPERAND AT 0(RW1)                                          65478021
*                                                                       65484021
*                                                                       65490021
*      L       RW1,ADDR.                                                65496021
*      .                                                                65502021
*      .                                                                65508021
*      .                                                                65514021
*      BAL     RCS,GETMOD                                               65520021
*      (RETURN)                                                         65526021
*                                                                       65532021
*                                                                       65538021
*        *****     *****     *****     *****     *****     *****        65544021
*                                                                       65550021
*                                                                       65556021
*      THE FIRST BYTE OF MODE                                           65562021
*      =   08                    IF OPERAND INDEX NAME                  65568021
*      =   16                    IF OPERAND INDEX DATA ITEM             65574021
*      =   32                      IF OPERAND IS A REPORT ITEM          65580021
*                                  OR STERLING REPORT                   65586021
*                                                                       65592021
*                                                                       65598021
*      =    35                     IF OPERAND IS OTHER FIGCON           65604021
*      =    96                     IF OPERAND IS A DN OR SS EITHER      65610021
*                                  ALPHABETIC OR ALPHANUMERIC           65616021
*      =    97                     IF OPERAND IS ALPHANUMERIC LITER     65622021
*      =    99                     IF OPERAND IS FIGCON SPACE           65628021
*      =   114                   IF OPERAND ALPHANUMERIC EDITED         65634021
*      =    112                    IF OPERAND IS GROUP                  65640021
*      =   128                     IF OPERAND IS EITHER NUMERIC, GD     65646021
*                                  TALLY, VLC, OR INTERNAL REGISTER     65652021
*      =   129                     IF OPERAND IS NUMERIC LITERAL        65658021
*                                  OR FLOATING POINT LITERAL            65664021
*      =   163                     IF OPERAND IS ZERO                   65670021
*                                                                       65676021
*                                                                       65682021
*      THE SECOND BYTE OF MODE                                          65688021
*                                                                       65694021
*                                                                       65700021
*      =     0                     ERROR                                65706021
*      =     1                     GROUP FIXED LENGTH                   65712021
*      =     2                     ALPHABETIC OR SPACE                  65718021
*      =     3                     AN., AN LIT., FIGCON, ALL            65724021
*      =     4                     GROUP VARIABLE LENGTH                65730021
*      =     5                     REPORT ITEM                          65736021
*      =     6                     STERLING REPORT                      65742021
*      =     7                     ZERO                                 65748021
*      =     8                     EXTERNAL DECIMAL                     65754021
*      =     9                     EXTERNAL FLOATING POINT              65760021
*      =    10                     INT. FL. PT. OR FL. PT. LIT.         65766021
*      =    11                     BINARY, VLC, GDN, INT.REG., TALL     65772021
*      =    12                     INT. DEC., NUM. LIT.                 65778021
*      =    13                     STERLING NON REPORT                  65784021
*      =   14                     ALNUM EDITED                          65790021
*      =   15                    IF BAD MODE, INDEXNAME INDEX DNM       65796021
*                                                                       65802021
*                                                                       65808021
*        *****     *****     *****     *****     *****     *****        65814021
*                                                                       65820021
*                                                                       65826021
*******************************************************************     65832021
       SPACE   5                                                        65838021
GETMOD EQU     *                                                        65844021
       STM     RCS,RW2,SVGTMD                                           65850021
         XC    DCURR(LX1),DCURR     INITIALIZE DCURR TO ZERO            65856021
         MVC   MODE(LX2),N0         INITIALIZE MODE TO ZERO             65862021
         CLI   DX0(RW1),MDN         RW1 CONTAINS CURRENT ENTITY ADDR    65868021
       BC      EQ,GTMD04           IT IS DATA NAME                      65874021
         CLI   DX0(RW1),MSS                                             65880021
       BC      EQ,GTMD04           IT IS SUBSCRIPTED DATA NAME          65886021
         CLC   DX0(LX2,RW1),CBTALY                                      65892021
       BC      EQ,GTMD08           IT IS TALLY                          65898021
         CLI   DX0(RW1),MIR                                             65904021
       BC      EQ,GTMD08           IT IS INTERNAL REGISTER              65910021
         CLI   DX0(RW1),MVLC                                            65916021
       BC      EQ,GTMD08           IT IS VARI LENGTH CHARACTER          65922021
         CLI   DX0(RW1),MGDN                                            65928021
       BC      EQ,GTMD08           IT IS GENERATED DATA NAME            65934021
         CLI   DX0(RW1),MNLIT                                           65940021
       BC      EQ,GTMD10           IT IS NUMERIC LITERAL                65946021
         CLI   DX0(RW1),MFLIT                                           65952021
       BC      EQ,GTMD14           IT IS FLOATING PT. LITERAL           65958021
         CLI   DX0(RW1),MALIT                                           65964021
       BC      EQ,GTMD16           IT IS ALPHANUMERIC LITERAL           65970021
         CLI   DX0(RW1),MFGCON                                          65976021
       BC      EQ,GTMD20           IT IS FIGURATIVE CONSTANT            65982021
         CLI   DX0(RW1),MINDNM      IS IT AN INDEX-NAME                 65988021
       BE    GTMD03                YES                                  65994021
         CLI   DX0(RW1),XX79        IS IT OTHER STANDARD DATA-NAME      66000021
       BC      EQ,GTMD01            YES - DISCARD AS NON-OPERAND        66006021
         CLC   DX0(LX1,RW1),ERSYMB  UNDEFINED OR ILLEGAL WORD           66012021
       BC      NOTEQ,GTMD02        COMPILER ERROR                       66018021
         TM    DX1(RW1),MFF        IS IT TRUE UNDEFINED                 66024021
       BC      ZERO,GTMD26          YES - MODE 0                        66030021
GTMD01 EQU     *                                                        66036021
         MVI   MODE+NX1,XXFF                                            66042021
       BC      UNCOND,GTMD05       GO TO ZERO OUT DCURR & EXIT          66048021
GTMD02 LR      RA0,RW1                                                  66054021
       BAL     RCS,ERROR          COMPILER ERROR                        66060021
       LA      RW1,ELST44                                               66066021
       BC      UNCOND,GTMD06       GO TO EXIT                           66072021
GTMD03   MVI   MODE,XX08                                                66078021
         MVI   MODE+NX1,XXFF                                            66084021
       B     GTMD05                GO TO ZERO OUT DCURR & AXIT          66090021
GTMD04 SR      RW2,RW2                                                  66096021
         IC    RW2,DX3(RW1)         LOAD DATA NAME,S MODE IN RW2        66102021
         SRL   RW2,DX4              RIGHT JUSTIFIED 4 DIGIT             66108021
         STC   RW2,MODE+NX1         STORE MODE INTO MODE+1              66114021
         CLI   MODE+NX1,XX00                                            66120021
       BC      EQ,GTMD26           ERROR                                66126021
         CLI   MODE+NX1,MB1         IS IT DN GROUP FIXED LENGTH         66132021
       BC      EQ,GTMD27           YES                                  66138021
         CLI   MODE+NX1,MB4         IS IT DN GROUP VARI. LENGTH         66144021
       BC      EQ,GTMD27           YES                                  66150021
         CLI   MODE+NX1,MB2         IS IT DN ALPHABETIC                 66156021
       BC      EQ,GTMD28           YES                                  66162021
         CLI   MODE+NX1,MB3         IS IT DN ALPHANUMERIC               66168021
       BC      EQ,GTMD28           YES                                  66174021
         CLI   MODE+NX1,MB5         IS IT DN REPORT ITEM                66180021
       BC      EQ,GTMD30           YES                                  66186021
         CLI   MODE+NX1,MB6         IS IT DN STERLING REPORT            66192021
       BC      EQ,GTMD32           YES                                  66198021
         CLI   MODE+NX1,MB14  IS IT DN ALHANUMERIC EDITED               66204021
       BC    NOTEQ,GTMD3           NO                                   66210021
         MVI   MODE,XX72                                                66216021
       B     GTMD06   EXIT                                              66222021
GTMD3    CLI   MODE+NX1,MB8   IS IT DN NUMERIC                          66228021
       BC      NOTLO,GTMD36        YES                                  66234021
         MVC   MODE(LX2),INDNMD                                         66240021
GTMD05   XC    DCURR(LX1),DCURR     TALLY,FL PT.,ZERO,VLC,GDN,IR,ERR    66246021
*                                  ANY DATA NAME WHICH IS AN INTEGE     66252021
GTMD06 LM      RCS,RW2,SVGTMD                                           66258021
       BCR     UNCOND,RCS          EXIT                                 66264021
GTMD08   MVI   MODE+NX1,MB11        MOVE BINARY TO MODE+1               66270021
         MVI   MODE,XX80            DN NUM,TALLY,GDN,VLC,INT.REG.       66276021
       BC      UNCOND,GTMD05       SET MODE BIT 0 ON                    66282021
GTMD10   MVI   MODE+NX1,MB12        MOVE INT. DEC. IN MODE+1            66288021
         MVC   DCURR(LX1),DX3(RW1)   NUMERIC LITERAL                    66294021
GTMD12   MVI   MODE,XX81            NL, FL.PT.LIT.  MODE BITS 0,7 ON    66300021
       BC      UNCOND,GTMD06       GO TO EXIT                           66306021
GTMD14   MVI   MODE+NX1,XX0A        MOVE INT. FL. PT. TO MODE+1         66312021
         XC    DCURR(LX1),DCURR     ZERO TO DCURR                       66318021
       BC      UNCOND,GTMD12       MODE IS NUMERIC LITERAL              66324021
GTMD16   MVI   MODE,XX61            AN. LIT. SET MODE BITS 1,2,7 ON     66330021
GTMD18   MVI   MODE+NX1,XX03        MOVE ALPHANUMERIC TO MODE+1         66336021
       BC      UNCOND,GTMD06       GO TO EXIT                           66342021
GTMD20   CLC   DX0(LX2,RW1),CBC0   IS IT IN ALPHABETIC SCOPE            66348021
       BC    NOTHI,GTMD42        NOT A LETTER                           66354021
         CLC   DX0(LX2,RW1),CBC9   IS IT BETWEEN A TO I                 66360021
       BC    NOTHI,GTMD24        IT IS A LETTER                         66366021
         CLC   DX0(LX2,RW1),CBD0   IS IT BETWEEN J TO R                 66372021
       BC    NOTHI,GTMD45        OTHERS                                 66378021
         CLC   DX0(LX2,RW1),CBD9                                        66384021
       BC    NOTHI,GTMD24        IT IS A LETTER                         66390021
         CLC   DX0(LX2,RW1),CBE1   IS IT BETWEEN S TO Z                 66396021
       BC    NOTHI,GTMD45        OTHERS                                 66402021
         CLC   DX0(LX2,RW1),CBE9                                        66408021
       BC    NOTHI,GTMD24        IT IS A LETTER                         66414021
         CLC   DX0(LX2,RW1),CBZERO IS IT A ZERO                         66420021
       BC    EQ,GTMD22             YES                                  66426021
         CLC   DX0(LX2,RW1),CBF9   IS IT A NUMBER BETWEEN 1 TO 9        66432021
       BC    NOTHI,GTMD46          IT IS A NUMBER                       66438021
       BC    UNCOND,GTMD45       OTHERS                                 66444021
GTMD22   MVI   MODE,XXA3          ZERO, MODE BITS 0,2,6,7 ON            66450021
GTMD23   MVI   MODE+NX1,XX08      EXT. DEC. TO MODE+1                   66456021
       BC      UNCOND,GTMD05       GO TO ZERO OUT DCURR AND EXIT        66462021
GTMD24   MVI   MODE+NX1,XX02        MOVE ALPHABETIC TO MODE+1           66468021
         MVI   MODE,XX63           ALL LETTER,SPACE MODE BITS           66474021
*                                  1, 2, 6, 7 ON                        66480021
       BC      UNCOND,GTMD06       GO TO EXIT                           66486021
GTMD26   XC    MODE(LX2),MODE       ZERO TO MODE                        66492021
       BC      UNCOND,GTMD05       GO TO ZERO OUT DCURR AND EXIT        66498021
GTMD27   MVI   MODE,XX70           GROUP - SET ON BITS 1,2,3            66504021
       BC      UNCOND,GTMD06       GO TO EXIT                           66510021
GTMD28   MVI   MODE,XX60           AL,AN - SET ON BITS 1 AND 2          66516021
       BC      UNCOND,GTMD06       GO TO EXIT                           66522021
GTMD30 EQU     *                   DN REPORT                            66528021
         TM    DX10(RW1),XX80                                           66534021
       BC      ONES,GTMD33          INTEGER                             66540021
         MVC   DCURR(LX1),DX10(RW1)  REPORT ITEM WITH DECIMAL PLACES    66546021
       BC      UNCOND,GTMD33       REPORT ITEM                          66552021
GTMD32   MVC   DCURR(LX1),DX13(RW1)  DN STERLING REPORT                 66558021
GTMD33   MVI   MODE,XX20           REPORT-ITEM INDICATOR                66564021
       BC      UNCOND,GTMD06       GO TO EXIT                           66570021
GTMD36   MVI   MODE,XX80            DN NUMERIC MODE BIT 0 ON            66576021
         CLI   MODE+NX1,XX08                                            66582021
       BC    EQ,GTMD40             EXTERNAL DECIMAL                     66588021
         CLI   MODE+NX1,XX0A                                            66594021
       BC      NOTHI,GTMD05        INT. OR EXT. FLOATING POINT          66600021
         CLI   MODE+NX1,XX0C                                            66606021
       BC      NOTHI,GTMD40        BINARY OR INTERNAL DECIMAL           66612021
         CLI   MODE+NX1,XX0D                                            66618021
       BC      NOTEQ,GTMD02        NO, COMPILER ERROR                   66624021
         MVC   PTEMP(LX1),DX8(RW1)  STERLING NON-REPORT                 66630021
         NI    PTEMP,XX1F                                               66636021
         MVC   DCURR(LX1),PTEMP                                         66642021
       BC      UNCOND,GTMD06       GO TO EXIT                           66648021
GTMD40   TM    DX8(RW1),XX80                                            66654021
       BC      ONES,GTMD05         INTEGER                              66660021
         MVC   DCURR(LX1),DX8(RW1)                                      66666021
       BC      UNCOND,GTMD06       GO TO EXIT                           66672021
GTMD42   CLC   DX0(LX2,RW1),CBSPCE                                      66678021
       BC    EQ,GTMD24           IT IS A SPACE                          66684021
GTMD45   MVI   MODE,XX23            ALL, OTHER FIGCON MODE BITS 2,6,    66690021
       BC    UNCOND,GTMD18         ALPHANUMERIC                         66696021
GTMD46   MVI   MODE,XX23          ALL'NUMBER'  MODE BITS 2,6,7 ON       66702021
       BC    UNCOND,GTMD23         EXTERNAL DECIMAL                     66708021
               EJECT                                                    66714021
*                                                                       66720021
       SPACE   3                                                        66726021
*******************************************************************     66732021
*                                                                       66738021
*                                                                       66744021
*                    ' ISIT ' ROUTINES                                  66750021
*                                                                       66756021
*                                                                       66762021
*******************************************************************     66768021
       SPACE   3                                                        66774021
*=2    ISDTOP    DECIDE IF INPUT IS DATA-OP,REDUCE SIGNED LIT AND '     66780021
*******************************************************************     66786021
*                                                                       66792021
*                                                                       66798021
*                                                                       66804021
*                                I S D T O P                            66810021
*                                                                       66816021
*                                                                       66822021
*                                                                       66828021
*                         ( IS IT A DATA OPERAND )                      66834021
*                                                                       66840021
*                                                                       66846021
*                                                                       66852021
*          BAL     RCS,ISDTOP                                           66858021
*          (RETURN,NO)                                                  66864021
*          (RETURN,YES)                                                 66870021
*                                                                       66876021
*                                                                       66882021
*                                                                       66888021
*      ********        ********        ********        ********         66894021
*                                                                       66900021
*                                                                       66906021
*                                                                       66912021
*      DETERMINES WHETHER CURRENT INPUT ENTITY IS A DATA OPERAND        66918021
*      PROCESSES UNATTACHED SIGNS                                       66924021
*      PROCESSES 'ALL' BY ATTACHING FIGCON HEADER TO LITERAL THAT       66930021
*        FOLLOWS                                                        66936021
*      SETS MODE=X'FF' WHEN ELEMENT IS NOT A DATA OPERAND               66942021
*                                                                       66948021
*                                                                       66954021
*** SUBROUTINES CALLED                                                  66960021
*      GETNXT,GETMOD,MINLIT,ERROR                                       66966021
*                                                                       66972021
*                                                                       66978021
*** ERROR PROCESSING                                                    66984021
*      DELETES 'ALL' NOT FOLLOWED BY NON-NUM-LIT OR FIGCON              66990021
*      SUPPLIES TO 'ALL' LAST CHARACTER  OF LITERAL LONGER THAN 1       66996021
*      DELETES SUPERFLUOUS + SIGNS (NOTE THAT UNARY SIGNS ARE PROCE     67002021
*        BY FORMLA WHEN LEGAL  B E F O R E  ISPTOP IS CALLED).          67008021
*      REVERSES SIGN OF LITERAL IF - PRECEDES IT                        67014021
*      FOR CONDITION-NAMES OUTSIDE OF 'IF', SUBSTITUTES THE DN WHIC     67020021
*       CONTROLS THEM.                                                  67026021
*                                                                       67032021
*                                                                       67038021
*                                                                       67044021
*******************************************************************     67050021
       SPACE   6                                                        67056021
*                                                                       67062021
ISDTOP EQU   *                   IS IT A DATA OPERAND ROUTINE           67068021
*                                                                       67074021
       STM   RCS,RW4,SVDTOP                                             67080021
         MVI   MODE+NX1,XXFF       ERR CODE IN CASE OF NON-OPERAND      67086021
       TM    OKMVSW,MSWON          SPECIAL CALL FROM ISOKMV             67092021
       BO    ISDO39                YES- GO SCAN AN LIT                  67098021
       TM      SWRONL,MSWON       IS CALL FROM WRITE FOR REC-NAME       67104021
         MVI   SWRONL,XX00           (OFF SW AT ONCE)                   67110021
       BC      ONES,ISDO00        YES - SKIP FOLLOWING CHECK            67116021
       CLI     GOTTEN,MDN         IS THIS A DATA-NAME FROM A WRITE-     67122021
       BC      NOTEQ,ISDO00        NO                                   67128021
         TM    DX2(RIN),MWONLY                                          67134021
       BC      NOTONE,ISDO10      NO - OK                               67140021
       BAL     RCS,ERROR            YES - WARNING, MAY BE ILLEGAL       67146021
       LA      RW1,ELST5E                                               67152021
ISDO00   TM    GOTTEN,XX30        IS IT A DATA OPERAND                  67158021
       BC    NOTONE,ISDO30       NOT DATA OPERAND                       67164021
         CLI   GOTTEN,XX39    IS IT COND NM EXPANSION OF ALL CHAR       67170021
       BNE    ISDO10               NO- NORMAL OPERAND GET MODE          67176021
         MVC   MODE(LX2),ALLGTMD    MOVE ALPHANUM FIGCON MODE IN        67182021
       BC    UNCOND,EXALL                     EXIT GOOD MODE            67188021
ISDO10 LR      RW1,RIN            GIVE GETMOD ADDRESS OF ENTITY         67194021
       BAL   RCS,GETMOD          GET MODE ROUTINE                       67200021
         CLI   GOTTEN,MDN          DATA NAME                      58940 67206021
         BNE   ISDO15A             IF NOT DO NOT BOTHER           58940 67212021
         TM    IFSW1,MSWON         IS THIS FROM IF                58940 67218021
         BZ    ISDO15A             NO THEN DON'T  CHECK           58940 67224021
         TM    SETSW,MSWON         SET VERB IN IF IMPERATIVE      58940 67230021
         BO   ISDO15A              YES  BRANCH                    58940 67236021
         CLC   MODE(LX2),INDNMD    MODE VALUE FOR INDEXED D. I.   58940 67242021
         BNE   ISDO15A             USAGE INDEX                    58940 67248021
         TM DX3(RIN),DX12          ANY SUBSCRIPED LEVEL           58940 67254021
         BM    ISDO15B             YES  IT IS GOOD TO ROUDOP      58940 67260021
ISDO15A  DS    0H                                                 58940 67266021
         TM    MODE+NX1,MFF      FF=PH1 REJECT, 0=PH2 REJECT            67272021
       BC      NOTMXD,ISDO20       BAD CODE                             67278021
ISDO15B  DS    0H                                                 58940 67284021
       LM    RCS,RW4,SVDTOP                                             67290021
         BC    UNCOND,DX4(RCS)      GOOD MODE                           67296021
ISDO20 LM      RCS,RW2,SVDTOP                                           67302021
         BC    UNCOND,DX0(RCS)      BAD MODE - - ERROR                  67308021
ISDO30   CLC   GOTTEN(LX2),CBALL    IS IT COBOL WORD ALL                67314021
       BC    NOTEQ,ISDO60          NO                                   67320021
       BAL   RCS,GETNXT            YES, GET NEXT INPUT                  67326021
       LR      RW1,RIN            RW1 GETS ADDR. OF INPUT               67332021
       CLI     GOTTEN,MALIT        IS IT ALPHANUMERIC LITERAL           67338021
       BC    EQ,ISDO40             YES                                  67344021
       CLI     GOTTEN,MFGCON       IS IT FIGCON                         67350021
       BC    EQ,ISDO10             YES                                  67356021
       BAL     RCS,ERROR          ILLEGAL 'ALL' DELETED                 67362021
       LA    RW1,ELST67                                                 67368021
       BC    UNCOND,ISDO00         CHECK IF DATA OPERAND                67374021
ISDO39 LR    RW1,RIN               PT RW1 TO AN LIT FOR GETMOD          67380021
ISDO40   CLI   GOTTEN+NX1,XX01    IS IT ONE CHARACTER                   67386021
       BC    NOTEQ,ISDO55          NO                                   67392021
       LR      RW2,RW1                                                  67398021
       BAL     RCS,COUNT           GET BYTE COUNT                       67404021
       AH      RW1,BYTES         ADVANCE CURRENT ENTITY WITH BYTE C     67410021
       BCTR  RW1,RA0               BACKSPACE 1 BYTE                     67416021
         MVC   FIGALL+NX1(LX1),DX0(RW1) MOVE TO FIGCON HEADER           67422021
       LA      RIN,FIGALL                                               67428021
       BC    UNCOND,ISDO10         GET THE MODE                         67434021
ISDO50 BAL     RCS,ERROR           WRITE ERROR MESSAGE                  67440021
       LA    RW1,ELST67                                                 67446021
       BC      UNCOND,ISDO00       CHECK IF DATA OPERAND                67452021
ISDO55   MVC   ALLGT1+NX1(LX1),DX1(RW1) MOVE IN CNT OF BYTES FOLLOWING  67458021
       SR    RW2,RW2                                                    67464021
         IC    RW2,DX1(RW1)   GET COUNT OF BYTES TO BE TESTED           67470021
       EX    RW2,MVALLGT     ATTACH LITERAL TO FIGCON HEADER            67476021
       LA    RIN,ALLGT1   POINT RIN TO IT                               67482021
         LA    RW3,DX2(RW1)  RW3 PTS TO 1ST BYTE OF LITERAL ITSELF      67488021
       SR    RW4,RW4    RW4 WILL CONTAIN VALUES DEPENDING               67494021
*                 ON WHAT GETMOD HAS FOUND                              67500021
       LA    RW1,FIGALL                                                 67506021
ALLOOP   MVC   FIGALL+NX1(LX1),DX0(RW3) MOVE IN A BYTE TO BE TESTED     67512021
       BAL   RCS,GETMOD    GET MODE OF BYTE                             67518021
         LA    RW3,DX1(RW3)  INCR. RW3 TO PT TO NEXT BYTE               67524021
         CLI   MODE+NX1,MB3   ALPHANUMERIC                              67530021
       BNE    CKRSLT               NO                                   67536021
EXALL  LM    RCS,RW4,SVDTOP                                             67542021
         BC    UNCOND,DX4(RCS)     RETURN                               67548021
CKRSLT CH    RW4,N0          FIRST TIME                                 67554021
       BNE   CKRS2    NO                                                67560021
         CLI   MODE+NX1,MB8 WAS NUMERIC FOUND                           67566021
       BNE   CKRS1    NO- MUST BE ALPHABETIC                            67572021
         LA    RW4,DX1        RW4=1, NUMERIC FOUND                      67578021
CKRS0  BCT   RW2,ALLOOP            TEST BYTE                            67584021
CKRS2    CLI   MODE+NX1,MB8 IS IT NUMERIC                               67590021
       BNE   CKRS3      NO                                              67596021
       CH    RW4,N1          WAS NUMERIC FOUND LAST TIME                67602021
       BNE   EXALL2   NO-MIXED                                          67608021
CKRS4  CH    RW2,N0          YES-ARE THERE MORE BYTES TO TEST           67614021
       BNE   CKRS0           YES                                        67620021
       B     EXALL   NO-EXIT                                            67626021
CKRS3   CH   RW4,N2          WAS ALPHAB FOUND LAST TIME                 67632021
       BNE   EXALL2      NO                                             67638021
       B     CKRS4                 MORE BYTES TO BE TESTED              67644021
CKRS1    LA    RW4,DX2        RW4=2,ALPH FOUND                          67650021
         B     CKRS0               YES                                  67656021
EXALL2 MVI   MODE,MB35       MIXED, SET MODE TO ALPHNUMERIC             67662021
         MVI   MODE+NX1,MB3                                             67668021
       BC    UNCOND,EXALL          GO TO EXIT                           67674021
MVALLGT  MVC   ALLGT1+NX2(LX1),DX2(RW1)                                 67680021
ISDO60   CLC   GOTTEN(LX2),CBPLUS IS IT A PLUS SIGN                     67686021
       BC    EQ,ISDO70             YES                                  67692021
         CLC   GOTTEN(LX2),CBMINS IS IT A MINUS SIGN                    67698021
       BC    EQ,ISDO90             YES                                  67704021
ISDO65 EQU     *                                                        67710021
         MVC   MODE(LX2),NFFFF     BAD MODE -OVERLAY PREVIOUS           67716021
       BC      UNCOND,ISDO20        BAD DATA                            67722021
ISDO70 BAL RCS,GETNXT              GET NEXT INPUT                       67728021
ISDO80 BAL     RCS,ERROR          SIGN IGNORED                          67734021
       LA      RW1,ELST14                                               67740021
       BC    UNCOND,ISDO00         IS IT DATA OPERAND                   67746021
ISDO90 BAL   RCS,GETNXT            GET NEXT INPUT                       67752021
       LR      RW1,RIN                                                  67758021
       CLI     GOTTEN,MNLIT        IS IT NUMERIC LITERAL                67764021
       BC    EQ,ISDO96             YES                                  67770021
       CLI     GOTTEN,MFLIT        IS IT FLOATING POINT LITERAL         67776021
       BC    NOTEQ,ISDO80          NO                                   67782021
ISDO96 BAL     RCS,MINLIT         REVERSE THE SIGN                      67788021
       BAL     RCS,ERROR          SPACE BEFORE SIGN                     67794021
       LA      RW1,ELST15                                               67800021
       BC    UNCOND,ISDO00         CHECK IF DATA OPERAND                67806021
       EJECT                                                            67812021
*=2    ISOPST    VARIOUS IS-IT ROUTINES,E.G., 'AT END',LEGAL ARITH      67818021
*                                                                       67824021
*                                                                       67830021
*                                                                       67836021
*                                                                       67842021
*                                 I S O P S T                           67848021
*                                                                       67854021
*                                                                       67860021
*                                                                       67866021
*      BAL     RCS,ISOPST                                               67872021
*      (RETURN NOT A DATA OPERAND)                                      67878021
*      (RETURN LEGAL STORE-FIELD)                                       67884021
*                                                                       67890021
*      CALLED BY ARITHMETIC VERBS AND IF TO DETERMINE WHETHER CURRE     67896021
*        ENTITY IS A LEGAL STORE-FIELD.                                 67902021
*      IF IT IS LEGAL, MOVES IT TO PSTFLD,RECOMPUTES DECMAX, GETS N     67908021
*        AND EXITS TO 4(RCS)                                            67914021
*                                                                       67920021
*** SUBROUTINES CALLED                                                  67926021
*      GETNXT,GETALL,RDUCOP,PMKTAL,DECMAX,ERROR                         67932021
*                                                                       67938021
*                                                                       67944021
*                                                                       67950021
ISOPST EQU     *                                                        67956021
       STM     RCS,RA0,SVISOP                                           67962021
       LR      RA0,RIN            FOR MSG                               67968021
       BAL     RCS,RDUCOP         IS IT DATA-OPERAND AT ALL             67974021
       BC      UNCOND,ISOPS6        NO                                  67980021
       CLI     MODE,MDNUM           YES - IS IT NUMERIC                 67986021
       BC      EQ,ISOPS2                   YES,OK                       67992021
       CLI     MODE,MDREP           NO  - IS IT REPORT ITEM             67998021
       BC      NOTEQ,ISOPS4         NO- GO SUBSTITUTE 'TALLY'           68004021
ISOPS2 BAL     RCS,DECMAX         LEGAL - UPDATE DECMAX                 68010021
       BAL     RCS,GETALL          SAVE IT                              68016021
       LA      RW2,PSTFLD         MOVE IT TO PSTFLD                     68022021
       BAL     RCS,GETNXT          GET NEXT INPUT                       68028021
       LM      RCS,RA0,SVISOP       YES - EXIT                          68034021
         BC    UNCOND,DX4(RCS)     EXIT - LEGAL STORE FIELD             68040021
*                                                                       68046021
ISOPS6 EQU     *                                                        68052021
ISOPS4 BAL     RCS,ERROR           WRITE ERROR MESSAGE                  68058021
       LA      RW1,ELST17                                               68064021
       LM      RCS,RA0,SVISOP                                           68070021
       BCR     UNCOND,RCS          RETURN                               68076021
       SPACE   3                                                        68082021
*                                                                       68088021
*                                                                       68094021
*                                 I S O P A R                           68100021
*                                                                       68106021
*                                                                       68112021
*                                                                       68118021
*      BAL     RCS,ISOPAR                                               68124021
*      (RETURN NO)                                                      68130021
*      (RETURN LEGAL ARITHMETIC OPERAND                                 68136021
*                                                                       68142021
*      CALLED BY ARITHMETIC VERBS AND IF TO DETERMINE WHETHER CURRE     68148021
*        ENTITY IS A LEGAL ARITHMETIC OPERAND.                          68154021
*      LEAVES ERROR HANDLING TO CALLING ROUTINE                         68160021
*                                                                       68166021
*                                                                       68172021
*** SUBROUTINES CALLED                                                  68178021
*      RDUCOP                                                           68184021
*                                                                       68190021
*                                                                       68196021
ISOPAR EQU     *                                                        68202021
       ST      RCS,SVISOP                                               68208021
       BAL     RCS,RDUCOP         IS IT A VALID DATA-OPERAND AT ALL     68214021
       BC      UNCOND,ISOPA4      NO                                    68220021
       TM      MODE,MDNUM         YES - IS IT NUMERIC                   68226021
       BC      ZERO,ISOPA4        NO                                    68232021
       L       RCS,SVISOP           YES EXIT                            68238021
         BC    UNCOND,DX4(RCS)     LEGAL ARITH OPERAND                  68244021
*                                                                       68250021
ISOPA4 L       RCS,SVISOP          NO-EXIT                              68256021
       BCR     UNCOND,RCS          OPERAND NOT LEGAL                    68262021
       SPACE   3                                                        68268021
*                                                                       68274021
*                           I S F L P T                                 68280021
*                                                                       68286021
*      ROUTINE USED BY DISPLA AND EXHIBT TO PROCESS INTERNAL FLOATI     68292021
*        POINT DATA-NAMES                                               68298021
*                                                                       68304021
*      BAL     RCS,ISFLPT                                               68310021
*      (RETURN)                                                         68316021
*                                                                       68322021
*** OUTPUT PRODUCED                                                     68328021
*      (IF ITEM NOT INTERNAL FLOATING DN, NO OUTPUT)                    68334021
*                                                                       68340021
*         ' MOVE INPUT PARAM ' IS STORED IN PNOUNT                      68346021
*                                                                       68352021
*** SUBROUTINES CALLED                                                  68358021
*      PNSRTV                                                           68364021
*                                                                       68370021
*** NOTES                                                               68376021
*      FOR NON-FLOATING EXIT WITHOUT DOING ANYTHING                     68382021
*      FOR FLOATING, UPDATE LOCAL PARAM COUNT,PUT MOVE STRING IN        68388021
*       PNOUNT, POINT RIN TO PARAM  SO THAT IT  GOES INTO NORMAL        68394021
*       STRING.                                                         68400021
*      GENSTR TESTS GNOUSW TURNED ON BY DISPLAY AND EXHIBIT VERBS.      68406021
*       WHEN ON, GENERATES PNOUNT BETWEEN SUBSCRIPTS AND STRING.        68412021
*      SPECIAL IC-TEXT FOR PHASE5 MAKES 2ND BYTE OF PARAM 1D FOR SI     68418021
*       AND 1E FOR DOUBLE PRECISION.                                    68424021
*                                                                       68430021
*                                                                       68436021
ISFLPT EQU     *                                                        68442021
         CLC   MODE(LX2),MODIFL    IS IT FLOATING POINT DN              68448021
       BCR     NOTEQ,RCS             NO                                 68454021
*                                                                       68460021
*                           UPDATE PARAM COUNTER                        68466021
*                                                                       68472021
       STM     RCS,RW1,SVISFP                                           68478021
       LH      RAS,PARSIZ         STORE CURRENT PARAM DISPL.            68484021
         STH   RAS,PARAM+NX2                                            68490021
         LA    RAS,DX14(RAS)       ADD 14 FOR SINGLE PRECISION          68496021
         MVI   PARAM+NX1,XX1D      CODE FOR SINGLE                      68502021
         TM    DX9(RIN),MFPRBT                                          68508021
       BC      ZERO,ISFLP4         NOT FLOATING POINT PRECISION         68514021
         LA    RAS,DX9(RAS)         ADD 23 FOR DOUBLE                   68520021
         MVI   PARAM+NX1,XX1E      CODE FOR DOUBLE                      68526021
ISFLP4 EQU     *                                                        68532021
       STH     RAS,PARSIZ                STORE FOR NEXT USE             68538021
*                                                                       68544021
*                           STORE 'MOVE INPUT PARAM'                    68550021
*                                                                       68556021
       L       RW1,APNOUN                                               68562021
       BAL     RCS,PNSRTV          INSERT 'MOVE' IN STRING              68568021
       LA      RW4,MOVEVB          MOVE                                 68574021
       BAL     RCS,PNSRTV          INSERT 'INPUT' IN STRING             68580021
         LA    RW4,DX0(RIN)         INPUT                               68586021
       BAL     RCS,PNSRTV          INSERT PARAM IN STRING               68592021
       LA      RW4,PARAM           PARAM                                68598021
       LA      RIN,PARAM          POINT INPUT REGISTER AT PARAM         68604021
       LM      RCS,RW1,SVISFP                                           68610021
       BCR     UNCOND,RCS          EXIT                                 68616021
       SPACE   3                                                        68622021
*                                                                       68628021
*                           I S I N T G                                 68634021
*                                                                       68640021
*                                                                       68646021
*      SUBROUTINE TO DISCOVER WHETHER AN OPERAND IS AN INTEGER          68652021
*                                                                       68658021
*      L       RW1,ADDR.     OR   . (NO L INSTR. NEEDED)                68664021
*      .                          .                                     68670021
*      .                          .                                     68676021
*      BAL     RCS,ISINTG         BAL RCS,ISINT2                        68682021
*      (NO RETURN)                (NO RETURN)                           68688021
*      (YES RETURN)               (YES RETURN)                          68694021
*                                                                       68700021
*                                                                       68706021
*      ENTRANCE AT ISINTG CAUSES GETMOD TO BE CALLED                    68712021
*                  ISINT2 ASSUMES MODE AND DCURR FOR ENTITY ARE CUR     68718021
*                                                                       68724021
*                                                                       68730021
*** SUBROUTINES CALLED                                                  68736021
*      GETMOD                                                           68742021
*                                                                       68748021
*                                                                       68754021
ISINTG EQU     *                                                        68760021
       ST      RCS,SVISIN                                               68766021
       BAL     RCS,GETMOD         FIND MODE AND DCURR                   68772021
       L       RCS,SVISIN                                               68778021
*                                                                       68784021
ISINT2 EQU     *                                                        68790021
       TM      MODE,MNUMBT         IS IT NUMERIC                        68796021
         BC    ZERO,DX0(RCS)        NO                                  68802021
         CLI   MODE+NX1,MEDMOD     IS IT EXT. DEC.                      68808021
       BC      EQ,ISINT6           YES                                  68814021
         CLI   MODE+NX1,MIFMOD     NO- IS IT FLOATING POINT             68820021
       BCR     NOTHI,RCS            YES - EXIT NOT AN INTEGER           68826021
         CLI   MODE+NX1,MSNMOD     IS IT STERLING NON-REPORT            68832021
       BCR     EQ,RCS                 YES - DONT CONSIDER INTEGER       68838021
ISINT4 TM      DCURR,MFF          DOES DCURR=0                          68844021
         BC    ZERO,DX4(RCS)         YES - EXIT YES                     68850021
       BCR     UNCOND,RCS           NO  - EXIT NOT INTEGER              68856021
ISINT6 TM      MODE,MFGMOD     EXT. DECIMAL MODE- IS IT FIGCON          68862021
       BCR     ONES,RCS             YES - EXIT NOT INTEGER              68868021
       BC      UNCOND,ISINT4        NO - GO EXAMINE DCURR               68874021
       SPACE   3                                                        68880021
*                                                                       68886021
*                           O K P F O P                                 68892021
*                                                                       68898021
*                                                                       68904021
*                                                                       68910021
*      ROUTINE TO ANALYZE OPERANDS OF PERFORM-VARYING.                  68916021
*                                                                       68922021
*                                                                       68928021
*      BAL     RCS,OKPFOP                                               68934021
*      (RETURN)                                                         68940021
*                                                                       68946021
*      IF INTGSW IS ON, INTEGER IS REQUIRED. TURNS IT OFF               68952021
*      SUBSTITUTES 'TALLY' FOR ILLEGAL OPERANDS                         68958021
*                                                                       68964021
*** SUBROUTINES CALLED                                                  68970021
*      ISOPAR,ISINTG,ERROR                                              68976021
*                                                                       68982021
*                                                                       68988021
*                                                                       68994021
OKPFOP EQU     *                                                        69000021
       STM     RCS,RA0,SVOKPF                                           69006021
       BAL     RCS,ISOPAR         IS IT NUMERIC OPERAND                 69012021
       BC      UNCOND,OKPFO4       NO                                   69018021
        TM     INTGSW,MSWON        IS INTEGER REQUIRED                  69024021
        BZ     OKPFO2              NO - EXIT                            69030021
        NI     INTGSW,MSWOFF       YES, REINITIALIZE SW                 69036021
        BAL    RCS,ISINT2          IS IT INTEGER                        69042021
        BC     UNCOND,OKPF01       NO - ISSUE ERROR MESSAGE             69048021
        BC     UNCOND,OKPFO2       YES - EXIT                           69054021
OKPF01  EQU    *                                                        69060021
        LR     RA0,RIN                                                  69066021
        BAL    RCS,ERROR           FOR MSG 40                           69072021
        LA     RW1,ELST40          RW1 POINTS TO PARM LIST              69078021
        LA     RIN,NUMLT1          SUBSTITUTE 1                         69084021
OKPFO2 LM      RCS,RA0,SVOKPF       EXIT                                69090021
       BCR     UNCOND,RCS          EXIT                                 69096021
*                                                                       69102021
OKPFO4 EQU     *                                                        69108021
         TM    DX0(RIN),MOP                                             69114021
         BC    ONES,*+NX8          CHECK IF INDEX NAME                  69120021
       OI      NEXTIN,MSWON       SAVE IF NOT AN OPERAND                69126021
       CLI   GOTTEN,MINDNM       IS IT INDEXNAME                        69132021
       BE    OKPFOA                YES                                  69138021
OKPF05 BAL   RCS,ERROR             WRITE ERROR MESSAGE                  69144021
       LA      RW1,ELST27                                               69150021
       BAL     RCS,PMKTA2         SUBSTITUTE 'TALLY'                    69156021
       BC      UNCOND,OKPFO2       GO TO EXIT                           69162021
*                                                                       69168021
OKPFOA   CLI   VARYSW+NX1,XX0C       1ST OP VARY                        69174021
        BNE    *+NX12              NO                                   69180021
         OI    INDSW1,MSWON       TURN ON INDEX SW                      69186021
       B     OKPFO2                GO TO EXIT                           69192021
         TM    INDSW1,MSWON        INDEX SW ON                          69198021
       BZ    OKPF05              ERRMSG                                 69204021
       B     OKPFO2                GO TO EXIT                           69210021
       SPACE   3                                                        69216021
*                                                                       69222021
*                                                                       69228021
*                            I S O K F L                                69234021
*                                                                       69240021
*      ROUTINE TO DISCOVER IF FILE-NAME INPUT IS IN LEGAL SECTION       69246021
*        AND CERTIFIED HEALTHY BY PHASE 2                               69252021
*                                                                       69258021
*      BAL     RCS,ISOKFL                                               69264021
*      (RETURN)                                                         69270021
*                                                                       69276021
*      TURNS ON SKIPSW IF FILE IS NO GOOD. ROUTINES CALLING             69282021
*        ISOKFL MUST TURN SKIPSW OFF BEFORE COMING HERE                 69288021
*                                                                       69294021
*      OPEN SETS OPCLSW TO 1, CLOSE TO 3, OTHER VERBS TO 0              69300021
*                                                                       69306021
*      CALLS ERROR TO WRITE MSG IF IN ILLEGAL SECTION                   69312021
*                                                                       69318021
ISOKFL EQU     *                                                        69324021
       STM     RCS,RW2,SVISOK                                           69330021
         TM    DX6(RIN),XXF0       WAS FILE ACCEPTABLE TO PHASE 2       69336021
       BC      ONES,ISOKF6          NO                                  69342021
         CLI   SAVLHN+NX6,XX00     ARE WE IN RPD SECTION (OR DEBUG O    69348021
*                                  ERROR DECLARATIVE FOR RPD)           69354021
       BC    EQ,ISOKF8             GO TO EXIT                           69360021
       BC    UNCOND,ISOKF8         GO TO EXIT                           69366021
ISOKF6 OI      SKIPSW,MSWON                                             69372021
ISOKF8 LM      RCS,RW2,SVISOK                                           69378021
       OI    GENRED,MSWON                                               69384021
       BCR     UNCOND,RCS          RETURN                               69390021
*                                                                       69396021
       SPACE   3                                                        69402021
*                                                                       69408021
*                                                                       69414021
*                             I S E N D                                 69420021
*                                                                       69426021
*      BAL   RCS,ISEND                                                  69432021
*      (RETURN NO)                                                      69438021
*      (RETURN YES)                                                     69444021
*                                                                       69450021
*      TESTS WHETHER GOTTEN HEADS VERB, LHN, OR BREAK                   69456021
*                                                                       69462021
*                                                                       69468021
ISEND    EQU   *                                                        69474021
       CLI   GOTTEN,MVERB                                               69480021
         BC    EQ,DX4(RCS)          YES IF VERB                         69486021
       CLI     GOTTEN,MPND                                              69492021
         BC    EQ,DX4(RCS)          YES IF PN                           69498021
       CLI   GOTTEN,MBREAK                                              69504021
         BC    EQ,DX4(RCS)          YES IF BREAK                        69510021
       CLI     GOTTEN,MLGN         YES IF LGN (Q-VERBS,ETC.)            69516021
         BC    EQ,DX4(RCS)         EXIT - OK                            69522021
       BCR     UNCOND,RCS         OTHERWISE NO                          69528021
       SPACE   3                                                        69534021
*                                                                       69540021
*                                                                       69546021
*                              I S T R U V                              69552021
*                                                                       69558021
*      BAL     RCS,ISTRUV                                               69564021
*      (RETURN)                                                         69570021
*                                                                       69576021
*      CALLED WHEN CONDITION IS FOUND (IF,ON,END,SIZE ERROR,INVALID     69582021
*      TESTS SW TRUVRB. IF ON, ONLY IMPERATIVES ARE LEGAL               69588021
*      TURNS ON TRUVRB FOR ALL CONDITIONS EXCEPT IF                     69594021
*      TURNS ON CONDSW FOR ALL CONDITIONS - TELLING IDENT,THAT A VE     69600021
*        OTHER THAN . OR ELSE MUST FOLLOW                               69606021
*                                                                       69612021
*                                                                       69618021
ISTRUV EQU     *                                                        69624021
       OI      CONDSW,MSWON       SW FOR IDENT TO CHECK . AND ELSE      69630021
       TM      TRUVRB,MSWON       IS CONDITION LEGAL HERE               69636021
       BC      ZERO,ISTRU2          YES                                 69642021
       ST      RCS,SVISTR           NO - MSG BUT ACCEPT                 69648021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  69654021
       LA      RW1,ELST56                                               69660021
       L       RCS,SVISTR                                               69666021
       NI      TRUVRB,MSWOFF      OFF SW TO AVOID REPEATED MSGS         69672021
       BCR     UNCOND,RCS          EXIT                                 69678021
ISTRU2 TM      PLOGIC,MSWON       WAS CALL FROM IF                      69684021
       BCR     ONES,RCS            YES                                  69690021
       OI      TRUVRB,MSWON        NO - ILLEGALIZE CONDITIONS TILL      69696021
       BCR     UNCOND,RCS           . OR ELSE                           69702021
       SPACE   3                                                        69708021
*                                                                       69714021
*                                                                       69720021
*                                                                       69726021
*                             I S N X T S                               69732021
*                                                                       69738021
*        BAL   RCS,ISNXTS                                               69744021
*        (RETURN NO)                                                    69750021
*        (RETURN YES)                                                   69756021
*                                                                       69762021
*        TESTS INPUT FOR 'NEXT SENTENCE',RETURNS WITH WORD FOLLOWIN     69768021
*          'SENTENCE',(OR WORD FOLLOWING 'NEXT'IF'SENTENCE' IS          69774021
*           MISSING)                                                    69780021
*                                                                       69786021
*** SUBROUTINES CALLED                                                  69792021
*      GETNXT,ERROR                                                     69798021
*                                                                       69804021
*                                                                       69810021
*** ERROR PROCESSING                                                    69816021
*      ASSUMES 'SENTENCE' IF ONLY 'NEXT' IS FOUND                       69822021
*                                                                       69828021
*                                                                       69834021
*                                                                       69840021
ISNXTS   EQU   *                                                        69846021
         ST    RCS,SVISNX                                               69852021
         CLC   GOTTEN(LX2),CBNEXT   IS IT 'NEXT'                        69858021
         BCR   NOTEQ,RCS                NO, EXIT TO 0(RCS)              69864021
         BAL   RCS,GETNXT          YES                                  69870021
       NI      CONDSW,MSWOFF    'NEXT SENTENCE'= IMPERATIVE VERB        69876021
         CLC   GOTTEN(LX2),CBSENT   IS NEXT 'SENTENCE'                  69882021
         BC    NOTEQ,ISNXT4             NO- ERROR                       69888021
         BAL   RCS,GETNXT          YES - DISCARD                        69894021
ISNXT2 BAL     RCS,ISEND           CHECK IF VERB,LHN OR BREAK           69900021
       BC      UNCOND,ISNXT3      IDENT OR ANALYZER WILL FIND GARBA     69906021
         CLC   GOTTEN(LX2),CBEOS        IS IT PERIOD                    69912021
       BC      EQ,ISNXT3                 YES - OK                       69918021
         CLC   GOTTEN(LX2),CBELSE       IS IT ELSE                      69924021
       BC      EQ,ISNXT3                 YES - OK                       69930021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  69936021
       LA      RW1,ELST60              SOME VERB THAT WONT BE EXECU     69942021
ISNXT3 L       RCS,SVISNX         EXIT TO 4(RCS)                        69948021
         BC    UNCOND,DX4(RCS)     EXIT                                 69954021
*                                                                       69960021
*              'SENTENCE'MISSING                                        69966021
*                                                                       69972021
ISNXT4 LA      RA0,CBSENT                                               69978021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  69984021
       LA      RW1,ELST07                                               69990021
       BC      UNCOND,ISNXT2       GO TO ISEND                          69996021
       SPACE   3                                                        70002021
*                                                                       70008021
*                           I S I Z E R                                 70014021
*                                                                       70020021
*                                                                       70026021
*                                                                       70032021
*      BAL     RCS,ISIZER                                               70038021
*      (RETURN NO)                                                      70044021
*      (RETURN YES)                                                     70050021
*                                                                       70056021
*      TESTS INPUT STREAM FOR 'SIZE ERROR' OR 'ON SIZE ERROR'           70062021
*                                                                       70068021
*      GETS NEXT AFTER EACH OF THE THREE WORDS IN CORRECT ORDER         70074021
*      WRITES MESSAGE IF ANY IS FOUND NOT FOLLOWED BY WHAT IT SHOUL     70080021
*                                                                       70086021
*      MOVES 2 TO ELEMENT-COUNT OF EVAL FOR NO AND ERROR CONDITIONS     70092021
*            3                              YES                         70098021
*                                                                       70104021
*** SUBROUTINES CALLED                                                  70110021
*      GETNXT,ERROR                                                     70116021
*                                                                       70122021
*                                                                       70128021
*                                                                       70134021
*                                                                       70140021
ISIZER EQU     *                                                        70146021
       STM     RCS,RA0,SVISIZ                                           70152021
*A SWITCH, SIZERROR IS SET ON IF CALL WAS FROM A MULT REC               70158021
*EXPANSION TO  ELIMINATE THE NEED FOR MULTIPLE CALLS TO ISIZER          70164021
*STORAN CHECKS SWITCH IF RECSW IS ON                                    70170021
       TM   ONSIZER,MSWON     WAS SIZE ERROR FOUND FOR DIV. WITH        70176021
*                             REMAINDER, ROUNDED OPTIONS                70182021
       BO   ERCHKED                YES                                  70188021
       TM    RECSW,MSWON  CALL FROM MULT REC                            70194021
       BZ    ISIZ1    NO                                                70200021
       OI    SIZERROR,MSWON  TELL MULT REC SIZERR CHECKED FOR           70206021
ISIZ1  SR    RA0,RA0                                                    70212021
         CLC   GOTTEN(LX2),CBON                                         70218021
         BC    NOTEQ,*+NX8         'ON' NOT PRESENT                     70224021
       BAL     RCS,GETNXT             DISCARD 'ON' IF PRESENT           70230021
         CLC   GOTTEN(LX2),CBSIZE                                       70236021
       BC      NOTEQ,ISIZ2         'SIZE' NOT PRESENT                   70242021
         LA    RA0,DX1             SW SAYS FOUND 'SIZE'                 70248021
       BAL     RCS,GETNXT         DISCARD 'SIZE'                        70254021
ISIZ2    CLC   GOTTEN(LX2),CBEROR                                       70260021
       BC      EQ,ISIZ4            'ERROR' FOUND                        70266021
       LTR     RA0,RA0            NOT'ERROR' - WAS 'SIZE' FOUND         70272021
       BC      ZERO,ISIZ10           NO - OK                            70278021
       LA      RA0,CBEROR            YES - MSG,ASSUME IT                70284021
       BC      UNCOND,ISIZ6        GO TO WRITE ERROR MESSAGE            70290021
ISIZ4  BAL     RCS,GETNXT         DISCARD 'ERROR'                       70296021
       LTR     RA0,RA0            WAS 'SIZE' FOUND                      70302021
       BC      NOTZER,ISIZ8          YES - OK                           70308021
       LA      RA0,CBSIZE            NO - MSG, ASSUME IT                70314021
*                                                                       70320021
*              ERROR -- 'SIZE' OR 'ERROR' MISSING                       70326021
*                                                                       70332021
ISIZ6  BAL     RCS,ERROR           WRITE ERROR MESSAGE                  70338021
       LA      RW1,ELST07                                               70344021
*                                                                       70350021
*              'ON SIZE ERROR' ESTABLISHED. DISCARD 'NEXT SENTENCE'     70356021
*                                                                       70362021
ISIZ8  LA      RA0,CBEROR       PARAM FOR MSGS                          70368021
       BAL     RCS,ISTRUV       CHECK IF CONDITION ALLOWED              70374021
       BAL     RCS,ISNXTS          GO TO TEST 'NEXT SENTENCE'           70380021
       BC      UNCOND,ISIZ12       NO - OK                              70386021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  70392021
       LA      RW1,ELST4B                                               70398021
*                                                                       70404021
*                           EXIT  NO-SIZE-ERROR                         70410021
*                                                                       70416021
ISIZ10   MVI   EVAL+NX2,XX02       EVAL STRING ELEMENT COUNT=2          70422021
       LM      RCS,RA0,SVISIZ                                           70428021
       BCR     UNCOND,RCS          RETURN                               70434021
*                                                                       70440021
*                           EXIT  YES-SIZE-ERROR                        70446021
*                                                                       70452021
ISIZ12   MVI   EVAL+NX2,XX03       EVAL STRING ELEMENT COUNT=3          70458021
        TM   REMSW,MSWON           IS REMAINDER SW ON                   70464021
        BZ   ISIZ14                NO                                   70470021
        OI   ONSIZER,MSWON         DIVIDE WITH REM AND ON SIZE          70476021
*                                  ERROR OPTIONS                        70482021
ISIZ14  LM   RCS,RA0,SVISIZ        RESTORE REGISTERS                    70488021
       LM      RCS,RA0,SVISIZ                                           70494021
         BC    UNCOND,DX4(RCS)     YES-SIZE-ERROR EXIT                  70500021
ERCHKED NI   ONSIZER,MSWOFF   TURN SW OFF                               70506021
         MVI   EVAL+NX2,MB3         EVAL STRING ELEMENT COUNT = 3       70512021
         XC    NXTSNT(LX2),NXTSNT        ZERO IT OUT                    70518021
        BC     UNCOND,ISIZ14       RETURN                               70524021
       SPACE   3                                                        70530021
*                                                                       70536021
*                                                                       70542021
*                           I S A T N D                                 70548021
*                                                                       70554021
*                                                                       70560021
*      THIS ROUTINE TESTS THE INPUT STREAM FOR 'AT END' AND,            70566021
*      IF FOUND, PLACES NEXT SENTENCE GN INTO STRING.                   70572021
*              IF NOT FOUND, AN ERROR MESSAGE IS ISSUED STATING         70578021
*              THAT =AT END' WAS NOT FOUND WHERE REQUIRED.              70584021
*      AS A SPECIAL CASE, IF 'AT END NEXT SENTENCE' IS FOUND            70590021
*      THE WHOLE CLAUSE IS DISCARDED AND THE 'NO' EXIT IS TAKEN.        70596021
*                                                                       70602021
*      THE CALLING SEQUENCE IS...                                       70608021
*                                                                       70614021
*      BAL     RCS,ISATND                                               70620021
*      (NO EXIT)       WITH ERROR MESSAGE ALREADY ISSUED                70626021
*      (YES EXIT)                                                       70632021
*                                                                       70638021
*** SUBROUTINES CALLED                                                  70644021
*      GETNXT,NEWNXT,ISNXTS,ERROR                                       70650021
*                                                                       70656021
*                                                                       70662021
ISATND EQU     *                                                        70668021
       ST      RCS,SVISIZ          SHARE ISIZER REG SV AREA             70674021
         CLC   GOTTEN(LX2),CBAT     IS IT 'AT'...                       70680021
       BC      NOTEQ,ISATN1         NO, OPTIONAL WORD ANYWAY            70686021
       BAL     RCS,GETNXT          DISCARD 'AT'                         70692021
ISATN1   CLC   GOTTEN(LX2),CBEND    IS IT 'END'...                      70698021
       BC      NOTEQ,ISATE1         NO, GO ISSUE ERROR MESSAGE          70704021
       BAL     RCS,GETNXT          DISCARD 'END'                        70710021
       BAL     RCS,ISNXTS         DOES NEXT SENTENCE FOLLOW             70716021
       BC      UNCOND,ISATN4        NO                                  70722021
       BAL     RCS,ERROR           YES - ERROR                          70728021
       LA      RW1,ELST4B                                               70734021
ISATN5 EQU   *                                                          70740021
       L       RCS,SVISIZ           YES, IGNORE WHOLE CLAUSE            70746021
       BCR   UNCOND,RCS            TAKE 'NO' EXIT                       70752021
ISATN4 BAL   RCS,NEWNXT            SET UP NEXT SENTENCE GN              70758021
         MVC   RGN+NX1(LX2),NXTSNT                                      70764021
       LA    RW4,RGN                                                    70770021
         CLI   VERB44+NX1,XX2A      IS VERB RETURN                      70776021
       BE    ISATN3              YES- DONT USE STO5 ROUTINES            70782021
       BAL   RCS,STO545            NO, STORE IN STRING                  70788021
ISATN2 BAL   RCS,ISTRUV           CHECK IF CONDITION ALLOWED            70794021
       L       RCS,SVISIZ          RESTORE RCS                          70800021
         BC    UNCOND,DX4(RCS)      YES EXIT                            70806021
ISATN3 BAL   RCS,STOR45             STORE GN IN STRING                  70812021
       BC    UNCOND,ISATN2         CHECK IF CONDITION ALLOWED           70818021
ISATE1 EQU   *                     9F                                   70824021
       BAL   RCS,ERROR             WRITE ERROR MESSAGE                  70830021
       LA      RW1,ELST46                                               70836021
       BC    UNCOND,ISATN5         TAKE 'NO' EXIT                       70842021
       SPACE   3                                                        70848021
*                                                                       70854021
*                                                                       70860021
*                           I S N I L                                   70866021
*                                                                       70872021
*                                                                       70878021
*      THIS ROUTINE DETERMINES WHETHER THE CURRENT INPUT UNIT IS        70884021
*      A POS. NUMERIC INTEGER LITERAL WHICH WILL FIT INTO 4 BYTES       70890021
*      AFTER CONVERSION TO BINARY SIGNED.                               70896021
*           THE CALLING SEQUENCE IS ...                                 70902021
*      BAL     RCS,ISNIL                                                70908021
*      (NO RETURN)                                                      70914021
*      (YES RETURN)                                                     70920021
*                                                                       70926021
*                                                                       70932021
ISNIL    STM   RCS,RAS,SVISNI                                           70938021
       BAL     RCS,RDUCOP         IS IT DATA OPERAND                    70944021
       BC      UNCOND,ISNIL1        NO                                  70950021
         CLI   DX0(RIN),MNLIT      IS IT NUMLIT                         70956021
       BC      NOTEQ,ISNIL2         DISCARD                             70962021
         CLI   DX3(RIN),XX00       INTEGER                              70968021
         BC    NOTEQ,ISNIL2         NO                                  70974021
         SR    RAS,RAS                                                  70980021
         IC    RAS,DX1(RIN)        RAS GETS BYTE-COUNT OF DEC. NUMBE    70986021
         SH    RAS,N3               ITSELF (-1 FOR THE EX)              70992021
         EX    RAS,ISNIL4          IS IT GREATER THAN 0                 70998021
       BC      NOTLO,ISNIL2        NO                                   71004021
         EX    RAS,ISNIL6          IS IT GREATER THAN MAX CONTAINAB     71010021
       BC      LO,ISNIL2           YES                                  71016021
         LM    RCS,RAS,SVISNI                                           71022021
         BC    UNCOND,DX4(RCS)          EXIT OK                         71028021
ISNIL1   CLC   GOTTEN(LX2),ERSYMB    DISCARD ERROR SYMBOL               71034021
       BC      NOTEQ,ISNIL3          BUT NOT OTHER NON-DATA OPERAND     71040021
ISNIL2 BAL     RCS,GETNXT          GET NEXT ELEMENT                     71046021
ISNIL3 LM      RCS,RAS,SVISNI     EXIT NEG,0,TOO BIG, OR NOT INTG       71052021
         BCR   UNCOND,RCS              EXIT NEG,0,TOO BIG,OR NOT IN     71058021
*                                                                       71064021
ISNIL4   CP    PAKZER(LX1),DX4(LX1,RIN)                                 71070021
ISNIL6   CP    ISNILM(LX6),DX4(LX1,RIN)                                 71076021
       EJECT                                                            71082021
*                                                                       71088021
*                                                                       71094021
*                                    I S O K S C                        71100021
*                                                                       71106021
*                                                                       71112021
*                                                                       71118021
*      THIS ROUTINE TESTS WHETHER OPERAND OF A PROCEDURE                71124021
*      BRANCHING STATEMENT IS IN ALLOWABLE SECTION.                     71130021
*                                                                       71136021
*                                                                       71142021
*      BAL     RCS,ISOKSC     (OR BAL    RCS,ISSC06 FOR PERFORM)        71148021
*      (RETURN)        WITH WARNING ISSUED IF ILLEGAL                   71154021
*                                                                       71160021
*                                                                       71166021
*** SUBROUTINES CALLED                                                  71172021
*      ERROR                                                            71178021
*                                                                       71184021
*                                                                       71190021
ISOKSC EQU     *                                                        71196021
*                                                                       71202021
*                          SPECIAL RESTRICTIONS FOR GO                  71208021
*                                                                       71214021
       CLI     PGMBRK,MDECL       (CAN'T TELL EXCEPT WITHIN DECL IT     71220021
       BCR   NOTEQ,RCS             NO - EXIT                            71226021
         TM    SAVLHN+NX3,MLABRP   ARE WE IN A LABEL OR RPT DECL        71232021
       BCR   ZERO,RCS              NO - EXIT                            71238021
         CLC   NXTSN(LX2),DX4(RIN)  IS PN DEFINED IN A LATER SECTION    71244021
       BC      LO,ISSC04          YES                                   71250021
         CLC   THISSN(LX2),DX4(RIN)   OR IN A PREVIOUS SECTION          71256021
       BCR   NOTHI,RCS             EXIT                                 71262021
*                                                                       71268021
*      IS PN A DUMMY (IF SO, STATEMENT IS COMPILER-CREATED AND OK)      71274021
*                                                                       71280021
ISSC04   TM    DX3(RIN),MDUMBT      IS IT A DUMMY NAME                  71286021
         BC    ONES,DX4(RCS)        YES, OK                             71292021
*                                                                       71298021
ISERSC EQU     *                                                        71304021
*                                                                       71310021
       ST      RCS,SVOKSC                                               71316021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  71322021
       LA      RW1,ELST10          PN IS IN NOT ALLOWABLE SECTION       71328021
       L       RCS,SVOKSC                                               71334021
       BCR     UNCOND,RCS          RETURN                               71340021
*                                                                       71346021
*                          RPD'S MUST BE ALIKE FOR ALL VERBS            71352021
*                                                                       71358021
       EJECT                                                            71364021
IKF403 CSECT                                                            71370021
COMON3 EQU     *                                                        71376021
*                                                                       71382021
*                                                                       71388021
*                           I S O K M V                                 71394021
*                                                                       71400021
*      CALLED BY MOVE, READ, WRITE, AND REWRITE ANALYZERS TO DETERM     71406021
*        WHETHER SOURCE AND TARGET FIELDS IN MOVE ARE COMPATIBLE        71412021
*                                                                       71418021
*                                                                       71424021
*                  BAL     RCS,ISOKMV                                   71430021
*                  (RETURN NO)       ERROR MESSAGE ALREADY ISSUED       71436021
*                  (RETURN, YES)                                        71442021
*                                                                       71448021
*                                                                       71454021
*** SUBROUTINES CALLED                                                  71460021
*      GETNXT,ISINTG,ERROR                                              71466021
*                                                                       71472021
*                                                                       71478021
*** NOTES                                                               71484021
*      CALLING ROUTINE HAS PLACED SOURCE FIELD AT PLEFT AND TARGET      71490021
*        AT PRIGHTAND THEIR 2-BYTE 'MODES' AT MODEL AND MODER,          71496021
*        RESPECTIVELY.                                                  71502021
*      SEE COMMENTS ON GETMOD ROUTINE FOR MEANING OF CONFIGURATIONS     71508021
*                                                                       71514021
*                                                                       71520021
ISOKMV EQU     *                                                        71526021
       STM     RCS,RAS,SVOKMV                                           71532021
       NI    CLEVMSG,MSWOFF       INIT MSG SW OFF                       71538021
       LA      RAS,ELST34         SET RAS TO MSG FOR ISOKM8             71544021
         CLI   MODER+NX1,MB1        IS OP2 DN MODE IS 1 OR 4            71550021
       BC      EQ,ISOKMC           OP2 DN IS A GROUP FIXED, OK          71556021
         CLI   MODER+NX1,MB4                                            71562021
       BC      EQ,ISOKMC           OP2 DN IS A GROUP VARIABLE           71568021
         CLI   MODEL+NX1,MB1  IS OP1 GROUP FIXED                        71574021
       BE    ISOKMC          OK                                         71580021
         CLI   MODEL+NX1,MB4 IS OP1 GROUP VAR                           71586021
       BE    ISOKMC          OK                                         71592021
         CLC   MODEL(LX2),MANDNM IS OP1 ALPHNUMERIC DNM                 71598021
       BE    ISOKMC          YES- OK MOVE                               71604021
         CLI   MODER+NX1,MB5        IS OP2 DN MODE IN 5 TO 13 SCOPE     71610021
       BC      NOTLO,ISOKM2        YES                                  71616021
         CLI   MODER+NX1,MB3   IS OP2 DN AN ALPHANUMERIC                71622021
       BC      EQ,ISOKM4           YES                                  71628021
         CLI   MODER+NX1,MB2        IS OP2 DN AN ALPHABETIC             71634021
       BC      EQ,ISOKM6           YES                                  71640021
       BC      NOTEQ,ISOKM8        INVALID DN                           71646021
ISOKM2   CLI   MODER+NX1,MB13    ****  STERLING NON REPORT IS INCLUD    71652021
       BC      NOTHI,ISOKMA        OP2 DN IS A NUMERIC OR REPORT        71658021
       BC    UNCOND,ISOKM5   SEE IF OP2 ANE                             71664021
ISOKM4 LA      RAS,ELST59         SET RAS TO WARNING 59 IF TARGET I     71670021
       TM      MODEL,MB32        IS OP1 AN,AL,GR,ZERO,SPACE,FIGCON,     71676021
       BC      ONES,ISOKMC         YES, OK                              71682021
         CLI   MODEL+NX1,MB8        IS OP1 EXT DEC DN                   71688021
       BC      EQ,ISOKME           YES                                  71694021
         CLI   MODEL+NX1,MB11       IS OP1 BIN DN                       71700021
       BC      EQ,ISOKME           YES                                  71706021
         CLI   MODEL+NX1,MB12       IS OP1 INT DEC DN                   71712021
       BC      EQ,ISOKME           YES                                  71718021
         CLI   MODEL+NX1,MSNMOD    IS OP1 ST-NON-RPT                    71724021
       BC      EQ,ISOKMC           YES - OK                             71730021
       BC      UNCOND,ISOKM8       INVALID DN                           71736021
ISOKM5   CLI   MODER+NX1,MB14 IS OP2 ANE                                71742021
       BC    NOTEQ,ISOKM8    INVALID OP                                 71748021
         CLI   MODEL+NX1,MB13 IS OP1 ST-NON-RPT                         71754021
       BC    EQ,ISOKM8             YES                                  71760021
       B     ISOKM4                NO                                   71766021
ISOKM6 TM    MODEL,MB64    OP1 GR,AL,AN,SPACE,ALL LETTER                71772021
       BC    ONES,ISOKMC     YES-OK                                     71778021
ISOKM8 EQU     *                                                        71784021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  71790021
         LA    RW1,DX0(RAS)                                             71796021
       LM      RCS,RAS,SVOKMV                                           71802021
       TM    CLEVMSG,MSWON    WAS C-LEVEL MSG ISSUED                    71808021
         BC    ONES,DX4(RCS)  EXIT OK                                   71814021
         CLI   MODER+NX1,MB3       WAS OP2 AN                           71820021
       BCR     NOTEQ,RCS           NO - EXIT                            71826021
         BC    UNCOND,DX4(RCS)       YES - EXIT OK AFTER WARNING        71832021
ISOKMA TM      MODEL,MB128         IS OP1 ZERO OR NUMERIC               71838021
       BC      ONES,ISOKMC         YES                                  71844021
       BC    UNCOND,ISOKMF   SEE IF FIGCON OR AN LIT                    71850021
ISOKMC LM      RCS,RAS,SVOKMV                                           71856021
         BC    UNCOND,DX4(RCS)      OK EXIT                             71862021
ISOKME   MVC   MODE(LX2),MODEL      OP1 EITHER EXT DEC, BIN OR INT D    71868021
         MVC   DCURR(LX1),DMAXL                                         71874021
       BAL     RCS,ISINT2          TEST OP1, IS IT AN INTEGER           71880021
         B     ISOKMH1             SET CLEVMSG BEFORE GEN EMSG    53551 71886021
       BC      UNCOND,ISOKMC       YES, IT IS AN INTEGER                71892021
ISOKMF CLI   MODEL,MB35      FIGCON AN OR NUM                           71898021
       BE    ISOKMG          EITHER ONE-FIND OUT WHICH                  71904021
       CLI   PLEFT,MFGCON    IS OP1 ALL LETT%ER OR SPACES               71910021
       BE    ISOKMH          YES- SUBSTITUTE ZERO FOR INVALID OPS       71916021
       CLI   PLEFT,MALIT     OP1 ALPHANUMERIC LITERAL                   71922021
       BE    ISOKMI                YES                                  71928021
         CLC   PLEFT(LX1),ALLGT1  POSSIBLY ALL LETTERS                  71934021
       BNE   ISOKM8          NO-ERROR                                   71940021
ISOKMH LA    RAS,ELST2C      ISSUE C-LEVEL MSG SUBSTIT F0               71946021
ISOKMH1  DS    0H                                                 53551 71952021
       OI     CLEVMSG,MSWON                                             71958021
       B     ISOKM8                GO TO ERROR                          71964021
ISOKMG   CLI   MODEL+NX1,MB8 IS IT ALL NUMERICS                         71970021
       BNE   ISOKMH                NO                                   71976021
ISOKMM   CLI   MODER+NX1,XX09   MAKE SURE REC NOT FL PT                 71982021
       BE    ISOKMH                YES - ERROR                          71988021
         CLI   MODER+NX1,XX0A                                           71994021
       BE    ISOKMH                YES - ERROR                          72000021
         CLI   MODER+NX1,XX06      CHECK FOR OP2 STERLING               72006021
       BE    ISOKMH                YES - ERROR                          72012021
         CLI   MODER+NX1,MB13                                           72018021
       BE    ISOKMH                YES - ERROR                          72024021
       B     ISOKMC                OK - GO TO EXIT                      72030021
ISOKMI OI    OKMVSW,MSWON          SIGNAL TO ISDTOP-SPEC CASE           72036021
       LA    RIN,PLEFT             POINT RIN TO AN LIT                  72042021
       BAL   RCS,ISDTOP            CHECK IF DATA OPERAND                72048021
       B    ISOKMJ                 GO TO RESTORE RIN                    72054021
ISOKMJ LA    RIN,CURENT      RESTORE RIN                                72060021
       NI    OKMVSW,MSWOFF                                              72066021
         CLI   MODE+NX1,MB8   WERE ALL BYTES FOUND TO BE NUMERIC        72072021
       BE    ISOKMM         YES- OK                                     72078021
       B      ISOKMH       NO- SUBSTITUTE ZERO                          72084021
*                                                                       72090021
*                           I S S O R K                                 72096021
*                                                                       72102021
*      BAL     RCS,ISSORK                                               72108021
*      (RETURN NOT VALID)                                               72114021
*      (RETURN OK)                                                      72120021
*                                                                       72126021
*                                                                       72132021
* THIS SR CHECKS VALIDITY OF SORT KEYS                                  72138021
*                                                                       72144021
*                                                                       72150021
ISSORK   ST    RCS,SVSO14                                               72156021
         BAL   RCS,RDUCOP         IS IT DATA-NAME                       72162021
         BC    UNCOND,ISORK2        NO                                  72168021
         CLI   DX0(RIN),MDN                                             72174021
         BC    NOTEQ,ISORK2         NO                                  72180021
       TM      DX2(RIN),XX0E  DEFINED UNDER SD                          72186021
       BNZ     ISORK2         NO                                        72192021
       TM      DX2(RIN),XX01  DEFINED UNDER SD                          72198021
       BZ      ISORK2         NO                                        72204021
         L     RCS,SVSO14           NO - ALL OK                         72210021
         BC    UNCOND,DX4(RCS)           OK EXIT                        72216021
ISORK2 L       RCS,SVSO14                                               72222021
         BCR   UNCOND,RCS               NOT-OK EXIT                     72228021
       SPACE   5                                                        72234021
*                                                                       72240021
*                           I S I T X N                                 72246021
*                                                                       72252021
*                                                                       72258021
* DETERMINES WHETHER CURR UNIT IS AN EX.NAME                            72264021
*      (AN LIT OF MAX SIZE 8)                                           72270021
*                                                                       72276021
*                                                                       72282021
*      BAL     RCS,ISITXN                                               72288021
*      (NO RETURN)                                                      72294021
*      (YES RETURN)                                                     72300021
*                                                                       72306021
ISITXN CLI     GOTTEN,MALIT                                             72312021
       BCR     NOTEQ,RCS           NOT AN LIT                           72318021
         CLI   DX1(RIN),MB8        LONGER THAN 8 CHAR...                72324021
       BCR     HI,RCS              ERROR                                72330021
         BC    UNCOND,DX4(RCS)     OK - EXIT                            72336021
       EJECT                                                            72342021
       SPACE   5                                                        72348021
*=2            IF-COMPUTE ROUTINES                                      72354021
*******************************************************************     72360021
*                                                                       72366021
*                                                                       72372021
*                             P F I N D L                               72378021
*                                                                       72384021
*      BAL     RCS,PFINDL                                               72390021
*      (RETURN)                                                         72396021
*                                                                       72402021
*      CALLED BY IF                                                     72408021
*      EXAMINES PTRFLS FROM THE ENTRY AT PTRFLS+PLOW THRU THE ENTRY     72414021
*        AT PTRFLS+HILEV. (IF HAS SET PLOW TO REFLECT FALL-THRU OR      72420021
*        BYPASS SIDE OF TABLE AND THE TYPE OF TERMINATOR -- 'OR',       72426021
*        'AND', OR END.)                                                72432021
*                                                                       72438021
*** SUBROUTINES CALLED                                                  72444021
*      PUPLGN,INSERT,PACKTB                                             72450021
*                                                                       72456021
*                                                                       72462021
*** NOTES                                                               72468021
*  THE EFFECTIVE ADDRESS CALCULATED FROM PLOW IS                        72474021
*          START-OF-TABLE + PARENTHESIS-LEVEL * 5 +                     72480021
*                                                                       72486021
*      3  ON BYPASS, 1  ON FALL-THRU BRANCH FOR 'END'                   72492021
*      3             6                          'AND'                   72498021
*      1             3                          'OR'                    72504021
*      6             8                          'NOT AND'               72510021
*      3             6                          'NOT OR'                72516021
*                                                                       72522021
*                                                                       72528021
*        FOR BYPASS-BRANCHES,  THE 1ST NON-ZERO PTRFLS LABEL FOUND      72534021
*      IS LOCATED IN OR  ENTERED INTO PSHTBL AND GIVEN A MASTER-BIT     72540021
*      (INDICATING THAT ALL LABELS FOLLOWING IT IN PSHTBL UP TO THE     72546021
*      NEXT MASTER ARE EQU'D TO IT).  MOVES THIS LABEL TO PTRFLS +      72552021
*      PLOW + PRNLEV.  SEARCHES PSHTBL FOR ALL NON-ZERO LABELS          72558021
*      FOUND AT HIGHER PTRFLS LEVELS, REMOVES THEIR MASTER BITS AND     72564021
*      MOVES THEM AND NON-MASTERS FOLLOWING THEM ADJACENT TO THE NE     72570021
*      MASTER. ZEROES ALL PTRFLS LABELS PROCESSED EXCEPT THE NOW NE     72576021
*      MASTER.                                                          72582021
*                                                                       72588021
*        FOR FALL-THRU LABELS, GENERATES AS LGN'S ALL LABELS FOUND      72594021
*      PTRFLS AT OR AFTER PTRFLS + PLOW + PRNLEV. SEARCHES PSHTBL       72600021
*      FOR THESE LABELS,GENERATES ALL NON-MASTERS FOLLOWING UP TO N     72606021
*      MASTER IN PSHTBL.  ZEROES GENERATED LABELS FROM PTRFLS AND       72612021
*      PSHTBL.  AT EXIT CLOSES PSHTBL TO ELIMINATE ZEROED GAPS.         72618021
*                                                                       72624021
*      IF NO LABEL IS FOUND IN PTRFLS,AND FALL-THRU BRANCH IS SOUGH     72630021
*        JUST EXITS. IF BYPASS BRANCH IS SOUGHT,UPDATES LGN AND STO     72636021
*        IT AS A MASTER IN PTRFLS AND PSHTBL                            72642021
*                                                                       72648021
*      ON EXIT, BYPASS BRANCH IDENTIFIER IS IN DISPL. OF RGN            72654021
*                                                                       72660021
*                                                                       72666021
*      THIS PROCESS INSURES THAT THERE ARE NO DUPLICATIONS IN PSHTB     72672021
*      AND THAT NO MASTER IS EQU'D TO ANOTHER MASTER. WHEN LABELS A     72678021
*      MOVED FROM PSHTBL ('FIRST-IN-LAST-OUT'), NO FURTHER ANALYSIS     72684021
*      IS NEEDED. THE MASTER BIT STOPS THE PROCESS                      72690021
*                                                                       72696021
*                                                                       72702021
*        PTRFLS CONSISTS OF 5-BYTE ENTRIES,ONE FOR EACH PAREN LEVEL     72708021
*           BYTE 0=1  IF 'NOT' IS ACTIVE AT THIS LEVEL,0 OTHERWISE      72714021
*           BYTES 1-2 CONTAIN THE ID FOR 'FALL-THRU' BRANCH             72720021
*           BYTES 3-4   ..     .  .   .  'BYPASS'     ..                72726021
*                                                                       72732021
*      THE FIRST BYTE (NOT-INDICATOR) IS IRRELEVANT FOR PFINDL          72738021
*                                                                       72744021
*        PSHTBL CONSISTS OF 3-BYTE ENTRIES                              72750021
*           BYTE 0=16 FOR A MASTER LABEL, 0 OTHERWISE                   72756021
*           BYTES 1-2 CONTAIN THE BRANCH ID                             72762021
*                                                                       72768021
*                                                                       72774021
*      IF TURNS IFBYPS ON WHEN BYPASS LABELS ARE TO BE PROCESSED        72780021
*                      OFF  .  FALLTHRU  .    .  .  .  .                72786021
*                                                                       72792021
*******************************************************************     72798021
       SPACE   6                                                        72804021
PFINDL   EQU   *                                                        72810021
       STM     RCS,RW6,SVPFND                                           72816021
*                                                                       72822021
*                        INITIALIZE INDEXES                             72828021
*                                                                       72834021
         LH    RW3,PLOW                                                 72840021
       AH      RW3,PRNLEV                                               72846021
         LH    RW4,HILEV                                                72852021
         L     RW1,APTFLS                  ( T1B OF PTRFLS)             72858021
         L     RW1,DX0(RW1)                 (TAMM OF PTRFLS)            72864021
         L     RW1,DX0(RW1)                 (STARTING ADDR. OF TABLE    72870021
         LA    RW1,DX0(RW1)        ZERO 1ST BYTE FOR LATER CR INSTR.    72876021
         AR    RW3,RW1        RW3  HOLDS ADDR. OF 1ST ENTRY TO CONS     72882021
         LR    RW5,RW3        RW5 STARTS AT .  .   .    .   .    .      72888021
         AR    RW4,RW1        RW4  HOLDS  .    . LAST   .    .    .     72894021
         LA    RW4,DX3(RW4)        POINT TO 2ND OF LABELS AT HILEV      72900021
         L     RW2,APUSH                    (T1B OF PSHTBL)             72906021
         L     RW2,DX0(RW2)                 (TAMM OF PSHTBL)            72912021
         L     RW1,DX0(RW2)    RW1  HOLDS ADDR. OF START OF PSHTBL      72918021
         LA    RW1,DX0(RW1)        ZERO 1ST BYTE FOR LATER CR INSTR.    72924021
         LH    RW2,DX4(RW2)                                             72930021
         AR    RW2,RW1        RW2    .     .   .  NEXT ENTRY FOR PS     72936021
       BC      UNCOND,PFND4        CHECK IF ZERO ENTRY                  72942021
*                                                                       72948021
*      FIND FIRST NON-ZERO PTRFLS ENTRY ON SIDE IN QUESTION             72954021
*                                                                       72960021
PFND2    LA    RW5,DX5(RW5)                                             72966021
       CR      RW5,RW4            HAVE ALL ENTRIES BEEN EXAMINED        72972021
       BC      HI,PFND6             YES                                 72978021
PFND4    CLC   DX0(LX2,RW5),N0      IS ENTRY 0                          72984021
       BC      EQ,PFND2           YES - LOOK AT NEXT                    72990021
       BC      UNCOND,PFND14      NO - GO PROCESS                       72996021
*                                                                       73002021
*              ALL PTRFLS ENTRIES HAVE BEEN EXAMINED                    73008021
*                                                                       73014021
PFND6  TM      IFBYPS,MSWON       WAS BYPASS BRANCH SOUGHT              73020021
       BC      ONES,PFND8         YES                                   73026021
       BAL     RCS,PAKPSH         NO - ELIMINATE ZEROES FROM PSHTBL     73032021
       BC      UNCOND,PFND10        EXIT                                73038021
PFND8    CLC   DX0(LX2,RW3),N0      WAS MASTER BYPASS FOUND             73044021
       BC      EQ,PFND12            NO - GO CREATE IT                   73050021
         MVC   RGN+NX1(LX2),DX0(RW3) YES - MOVE ITS ID TO RGN FOR STRIN 73056021
       NI      IFBYPS,MSWOFF      SW OFF FOR NEXT TIME THRU             73062021
PFND10 LM      RCS,RW6,SVPFND       EXIT                                73068021
       BCR     UNCOND,RCS          EXIT                                 73074021
*                                                                       73080021
*           NO MASTER BYPASS LABELS WAS FOUND.  CREATE IT               73086021
*                                                                       73092021
PFND12 SH      RW5,N5             POINT TO LAST PTRFLS ENTRY            73098021
       BAL     RCS,PUPLGN         GET NEW LGN ID                        73104021
         MVC   DX0(LX2,RW5),NXTLGN  STORE IN LAST PTRFLS ENTRY AND TR   73110021
       BC      UNCOND,PFND15             AS IF NORMAL                   73116021
*                                                                       73122021
*              NON-ZERO PTRFLS ENTRY FOUND                              73128021
*                                                                       73134021
PFND14 TM      IFBYPS,MSWON       IS BYPASS SOUGHT                      73140021
       BC      ZERO,PFND28     NO                                       73146021
PFND15   CLC   DX0(LX2,RW3),N0        YES -- DOES LOWEST ENTRY YET HA   73152021
       BC      EQ,PFND16            NO                 /MASTER          73158021
       CR      RW3,RW5            YES - IS CURRENT ENTRY 1ST BEING      73164021
       BC      NOTEQ,PFND28         NO                     /CONSIDE     73170021
       BC      EQ,PFND18             YES- MAKE IT MASTER BUT AVOID      73176021
*                                       ZEROING IT OUT OF PTRFLS        73182021
*                                                                       73188021
*                                                                       73194021
*      LOWEST NON-ZERO LABEL FOUND IN PTRFLS. MAKE IT MASTER FOR        73200021
*              THIS GROUP.  LOCATE IT OR INSERT IT IN PSHTBL            73206021
*              AND GET PSHTBL ADDRESS FOR ITS EQU'S                     73212021
*                                                                       73218021
PFND16   MVC   DX0(LX2,RW3),DX0(RW5) MOVE MASTER TO LOWEST PTRFLS SPOT  73224021
         XC    DX0(LX2,RW5),DX0(RW5) ZERO NON-LOWEST ENTRY              73230021
PFND18 EQU     *                                                        73236021
       CR      RW1,RW2             IS PSHTBL EXHAUSTED                  73242021
       BC      NOTLO,PFND19         YES                                 73248021
         CLC   DX0(LX2,RW3),DX1(RW1)  NO - DOES IT = NEXT PSHTBL ENTR   73254021
*                                   IS ALWAYS LEFT POINTING AT NEXT     73260021
       BC      EQ,PFND20            YES                                 73266021
         LA    RW1,DX3(RW1)        POINT RW1 TO NEXT PSHTBL ENTRY       73272021
       BC      UNCOND,PFND18            RETURN FOR NEXT                 73278021
PFND19 EQU     *                                                        73284021
       STM     RAS,RW3,SVPFN2     YES - INSERT AT END OF PSHTBL         73290021
       L       RW1,APUSH                                                73296021
       L       RAS,ANSERT                                               73302021
       BALR    RCS,RAS            MAKE ROOM (TABLE MAY NOW MOVE IN      73308021
       L       RAS,SVPFN2                                               73314021
         LA    RW3,DX3(RW3)                                             73320021
       STH     RW3,DSPUSH         UPDATE SAVED DISPL.                   73326021
         L     RW3,SVPFN2+NX16     RESTORE SOURCE ADDR. RW2 NOW HAS     73332021
         XC    DX0(LX2,RW2),DX0(RW2)   TARGET ADDR. GIVEN BY INSERT     73338021
         MVC   DX1(LX2,RW2),DX0(RW3) MOVE PTRFLS MASTER TO PSHTBL       73344021
         LA    RW1,DX0(RW2)        REINIT. RW1 TO LAST ENTRY IN PSHT    73350021
         LA    RW2,DX3(RW2)        UPDATE POINTER TO END OF PSHTBL      73356021
PFND20   OI    DX0(RW1),MASTER     GIVE MASTER BIT TO PSHTBL ENTRY      73362021
         LA    RW6,DX3(RW1)        POINT RW6 TO SPOT FOR 1ST EQU        73368021
       BC      UNCOND,PFND2       RETURN FOR NEXT PTRFLS ENTRY          73374021
*                                                                       73380021
*                                                                       73386021
*      REARRANGE PSHTBL,DELETING FALL-THRU LABELS, MOVING MASTER        73392021
*        BYPASS LABELS TO FOLLOW FIRST MASTER OF THIS GROUP             73398021
*                                                                       73404021
*                                                                       73410021
PFND28   CLC   DX0(LX2,RW5),DX1(RW1) FIND THIS LABEL IN PSHTBL ( MUST   73416021
       BC      EQ,PFND29          THERE,BYPASS ALWAYS ENTERED)          73422021
         LA    RW1,DX3(RW1)        POINT RW1 AT NEXT                    73428021
       BC      UNCOND,PFND28       GO TO FIND LABEL IN PSHTBL           73434021
*                                                                       73440021
PFND29 TM      IFBYPS,MSWON       IS BYPASS SOUGHT                      73446021
       BC      ONES,PFND30         YES                                  73452021
         MVC   LGN+NX1(LX2),DX1(RW1)  NO - GENERATE THIS LABEL          73458021
       BAL     RCS,GENLAB          GENERATE LABEL                       73464021
         XC    DX0(LX3,RW1),DX0(RW1) ZERO IT IN PSHTBL                  73470021
       BC      UNCOND,PFND32      SEEK ITS EQU'S                        73476021
PFND30   XC    DX0(LX1,RW1),DX0(RW1) YES - ZERO MASTER BIT              73482021
         MVC   TEMP(LX4),DX0(RW1)   SAVE IT TEMPORARILY                 73488021
       BAL     RCS,OPENTB         MOVE UP LABELS FROM THE PLACE IT      73494021
*                                 WILL GO TO THE PLACE IT IS NOW        73500021
         MVC   DX0(LX3,RW6),TEMP    MOVE IT INTO EQU SLOT               73506021
         LA    RW6,DX3(RW6)        POINT RW6 AT NEXT EQU SLOT           73512021
PFND32   LA    RW1,DX3(RW1)        POINT RW1 AT NEXT PSHTBL ENTRY       73518021
       CR      RW1,RW2            IS PSHTBL EXHAUSTED                   73524021
       BC      EQ,PFND34          YES                                   73530021
         TM    DX0(RW1),MASTER     IS NEXT ENTRY A MASTER               73536021
       BC      ZERO,PFND29        NO - PROCESS AS NEXT EQU              73542021
PFND34   XC    DX0(LX2,RW5),DX0(RW5) ZERO NON-LOWEST ENTRY              73548021
       BC      UNCOND,PFND2        GO TO EXAMINE ENTRIES                73554021
*                                                                       73560021
*                                                                       73566021
*      ROUTINES USED BY PFINDL.  PUT HERE AS SUBROUTINES ONLY           73572021
*      FOR THE SAKE OF READABILITY, SINCE EACH IS CALLED ONLY ONCE      73578021
*                                                                       73584021
*      OPENTB MOVES PSHTBL ENTRIES 0(RW6) TO 0(RW1) DOWN ONE 3-BYTE     73590021
*           SLOT.  CURRENT ONE FROM 0(RW1) IS SAVED AT TEMP             73596021
*      PAKPSH ELIMINATES ZEROED ENTRIES FROM PSHTBL                     73602021
*                                                                       73608021
*                                                                       73614021
OPENTB STM     RW4,RW5,SVPFN2                                           73620021
       LR      RW5,RW1            RW5 HOLDS LAST RECEIVINF FIELD        73626021
       LR      RW4,RW5                                                  73632021
       SR      RW4,RW6            RW4 GETS NUMBER OF BYTES TO MOVE      73638021
       BC      ZERO,OPNTB6         GO TO EXIT                           73644021
OPNTB4 SH      RW5,N3                                                   73650021
         MVC   DX3(LX3,RW5),DX0(RW5)                                    73656021
       SH      RW4,N3             ARE ALL MOVED                         73662021
       BC      NOTZER,OPNTB4         NO                                 73668021
OPNTB6 LM      RW4,RW5,SVPFN2                                           73674021
       BCR     UNCOND,RCS          EXIT                                 73680021
*                                                                       73686021
*                                                                       73692021
PAKPSH EQU     *                                                        73698021
       ST      RCS,SVPAKP                                               73704021
       L       RW1,APUSH          RW1 KEEPS TIB ADDR.                   73710021
         L     RW3,DX0(RW1)                                             73716021
         L     RW3,DX0(RW3)                                             73722021
         LA    RW3,DX0(RW3)        RW3 POINTS TO TABLE ENTRY            73728021
       LR      RW4,RW3            SAVE START IN RW4                     73734021
*                                                                       73740021
PAKP2  CR      RW3,RW2            IS TABLE EXHAUSTED                    73746021
       BC      NOTLO,PAKP4           YES                                73752021
         CLC   DX1(LX2,RW3),N0      IS ENTRY 0                          73758021
       BC      EQ,PAKP6              YES                                73764021
         LA    RW3,DX3(RW3)          NO - POINT AT NEXT                 73770021
       BC      UNCOND,PAKP2       EXAMINE NEXT ENTRY                    73776021
*                                                                       73782021
PAKP4  L       RCS,SVPAKP            YES - EXIT                         73788021
       BCR     UNCOND,RCS          EXIT                                 73794021
*                                                                       73800021
PAKP6  BAL     RCS,PACKTB         PACK, MOVE ALL BACK                   73806021
       SR      RW3,RW4            TO 0 ENTRY (GIVE RW3 TABLE DISPL      73812021
        BCR    NOP,RA0    OF 0 ENTRY AS TARGET) THIS NOP FILLER         73818021
         LA    RW2,DX3(RW3)          FROM ENTRY AFTER 0 ENTRY           73824021
       SH      RW2,N3             MOVE BACK END-OF-TABLE POINTER        73830021
       BC      UNCOND,PAKP2       RETURN TO REEXAMINE ENTRY (WE MAY     73836021
*                                        HAVE MOVED IN ANOTHER 0)       73842021
         EJECT                                                          73848021
*=2    FORMLA    REDUCTION OF ARITHMETIC EXPRESSIONS                    73854021
*******************************************************************     73860021
*                                                                       73866021
*                                                                       73872021
*                             F O R M L A                               73878021
*                                                                       73884021
*        BAL   RCS,FORMLA                                               73890021
*        (RETURN ERROR OR NOT FORMULA)                                  73896021
*        (RETURN SINGLE NON-NUMERIC DATA-OPERAND)                       73902021
*        (RETURN VALID FORMULA)                                         73908021
*                                                                       73914021
*        ROUTINE IS CALLED BY COMPUTE,IF,ON,UNTIL,TO ANALYZE AND        73920021
*         EVALUATE FORMULAS.                                            73926021
*                                                                       73932021
*        'FORMULA' HERE MEANS SINGLE OPERAND,OR SEVERAL OPERANDS OR     73938021
*         FORMULAS,SEPARATED BY OPERATORS (+,-,*,/,**)                  73944021
*        'OPERAND' HERE MEANS DATA-NAME OR NUMERIC OR FLOATING LITE     73950021
*         SURROUNDED AT OPTION BY PARENS AND PRECEDED AT OPTION BY      73956021
*         UNARY MINUS.                                                  73962021
*                       OUTLINE OF SYNTAX ANALYSIS                      73968021
*        IS ENTITY         .  YES                       .  NO           73974021
*                          .                            .               73980021
*     2  -                 .  PROCESS,GET NEXT,GO TO 4. .GO TO 4        73986021
*     4  (                 .  PROCESS,GET NEXT,GO TO 2. .GO TO 6        73992021
*     6  DATA-NAME OR LIT  .  PROCESS,GET NEXT,GO TO 8. .EXIT,ERR.O     73998021
*     8  )                 .  PROCESS,GET NEXT,GO TO 8. .GO TO 10       74004021
*     10 OPERATOR          .  PROCESS,GET NEXT,GO TO 4. .EXIT,FINIS     74010021
*                                                                       74016021
*                                                                       74022021
*** SUBROUTINES CALLED                                                  74028021
*      GETNXT,PUTSGN,PUTNIN,PEMPTY,PMKTAL,DECMAX                        74034021
*                                                                       74040021
*        CALLS ON  PUTNIN TO ENTER OPERAND  IN NOUNS TABLE              74046021
*                  PUTSGN TO ENTER OPERATOR IN SIGNS TABLE AND TO       74052021
*                    DECIDE THE MOMENT TO CREATE A VERB STRING AND      74058021
*                    DELETE FROM SIGNS AND NOUNS TABLE                  74064021
*                 PEMPTY,AT END OF FORMULA, TO CREATE ALL REMAINING     74070021
*                    STRINGS AND EMPTY THE TABLES                       74076021
*                                                                       74082021
*** NOTES                                                               74088021
*      DMAXSW IS A 2-BYTE SWITCH WHICH = 0 WHEN THE PART OF AN EXPR     74094021
*       SION BEING PROCESSED IS NOT PART OF AN EXPONENT OR DIVISOR.     74100021
*       WHEN / OR ** IS FOUND AND IT = 0, IT IS SET TO PRNLEV+5, OT     74106021
*      WISE LEFT ALONE. WHEN +,-,OR * IS FOUND AND DMAXSW IS NOT        74112021
*       LOWER THAN PRNLEV+5 IT IS SET BACK TO 0, OTHERWISE LEFT ALO     74118021
*       WHEN DMAXSW IS NOT 0, DECMAX IS NOT CALLED FOR AN OPERAND.      74124021
*       THUS NO PART OF A PARENTHESIZED DIVISOR OR EXPONENT PARTICI     74130021
*       PATES IN THE CALCULATION OF DMAX.                               74136021
*                                                                       74142021
*                                                                       74148021
*                                                                       74154021
*      IF ANY NUMERIC OPERAND AT ALL WAS FOUND PFNDOP SWITCH IS ON.     74160021
*        AT EXIT 1 CALLING ROUTINE MAY NEED TO TEST PFNDOP FOR          74166021
*        ERROR CONDITIONS.  EXIT 2 REPRESENTS ERROR FOR COMPUTE BUT     74172021
*        NOT FOR IF.                                                    74178021
*        AT EXIT 3 THE CONTROL-BYTE OF PRSULT SHOWS WHETHER THIS        74184021
*        WAS A TRUE MULTI-OPERAND FORMULA ( RESULT IS AN IR),  A        74190021
*        SINGLE DATA-NAME, OR A SINGLE NUMERIC LITERAL.                 74196021
*                                                                       74202021
*                                                                       74208021
*      IN CASE FORMLA FINDS A NON-NUMERIC OPERAND AFTER FINDING         74214021
*        A NUMERIC ONE AND A SIGN, IT WRITES AN ERROR MESSAGE AND       74220021
*        SUBSTITUTES 'TALLY' FOR THE OFFENDING OPERAND.  EXIT IN TH     74226021
*        CASE IS TO EXIT 3 AS IF THERE HAD BEEN NO ERROR.               74232021
*                                                                       74238021
*                                                                       74244021
*******************************************************************     74250021
       SPACE   6                                                        74256021
FORMLA EQU     *                                                        74262021
       STM     RCS,RA0,SVFRML                                           74268021
       NI      PFNDOP,MSWOFF                                            74274021
       NI    UMINSW,MSWOFF         INITIALIZE UMINUS SWITCH OFF         74280021
       NI    SBSW,MSWOFF        OFF SBSW                                74286021
*                                                                       74292021
*                                 IS IT UNARY SIGN                      74298021
*                                                                       74304021
FRML2    CLC   GOTTEN(LX2),CBPLUS                                       74310021
       BC      EQ,FRML3           JUST DISCARD +                        74316021
         CLC   GOTTEN(LX2),CBMINS  IS IT -                              74322021
       BC      NOTEQ,FRML4        NO                                    74328021
       OI      UMINSW,MSWON       YES, TURN ON SWITCH                   74334021
FRML3  BAL     RCS,GETNXT          GET NEXT INPUT                       74340021
*                                                                       74346021
*                                 IS IT (                               74352021
*                                                                       74358021
FRML4    CLC   GOTTEN(LX2),CBLPRN                                       74364021
       BC      NOTEQ,FRML8        NO                                    74370021
       TM      UMINSW,MSWON       YES, DID MINUS PRECEDE                74376021
       BC      ZERO,FRML6         NO                                    74382021
       BAL     RCS,FRML50           YES, ENTER IN TABLES                74388021
       NI      UMINSW,MSWOFF                                            74394021
FRML6  BAL     RCS,PUTSGN         ENTER THIS AND ALL FOLLOWING (S I     74400021
       BC      UNCOND,FRML2        PSIGNS AND RETURN TO SEEK MINUS      74406021
*                                                                       74412021
*              IS IT LEGAL OPERAND                                      74418021
*                                                                       74424021
FRML8  BAL   RCS,ISOPAR           IS IT NUMERIC DATA OPERAND            74430021
       BC      UNCOND,FRML20      NO - ERROR OR NOT FORMULA             74436021
FRML10   CLC   DMAXSW(LX2),N0      ARE WE WITHIN PARENTHESIZED          74442021
         BC    NOTZER,*+NX8        YES             /EXPONENT OR DIVI    74448021
       BAL     RCS,DECMAX         NO - UPDATE DMAX                      74454021
       OI      PFNDOP,MSWON   SWITCH SAYS AT LEAST 1 OPRND FOUND        74460021
         TM    UMINSW,MSWON        DID MINUS PRECEDE IT                 74466021
       BC      ZERO,FRML14        NO                                    74472021
       TM      MODE,MFGMOD        IS IT LITERAL (BUT NOT FIGCON)        74478021
       BC      MIXED,FRML12        YES - GO CHANGE ITS SIGN             74484021
       BAL     RCS,FRML50         NO - ENTER UNARY MINUS IN TABLES      74490021
       TM    SBSW,MSWON         WAS DN SUBSCRIPTED BY 'SUBSCR'          74496021
       BC    ONES,FRML11        YES - LEAVE NEXTIN OFF                  74502021
       OI      NEXTIN,MSWON       (PUTSGN CALLED GETNXT IN FRML50)      74508021
FRML11 L     RIN,ACURNT         POINT TO OPERAND (POINTER0 CLOBBER      74514021
*                                                        BY GETNXT      74520021
       BC      UNCOND,FRML13      GO SEEK SIGN                          74526021
FRML12 BAL     RCS,MINLIT         CHANGE SIGN OF NEGATIVE LITERAL       74532021
FRML13 NI      UMINSW,MSWOFF                                            74538021
FRML14 BAL     RCS,PUTNIN         ENTER OPERAND IS PNOUNS               74544021
       NI    SBSW,MSWOFF        OFF S&0W                                74550021
*                                                                       74556021
*                                  IS IT SIGN                           74562021
*                                                                       74568021
       CLI   GOTTEN,MSIGN                                               74574021
       BC      NOTEQ,FRML19       NO - END OF FORMULA                   74580021
         CLI   GOTTEN+NX1,MDVCOD   YES - SHALL NEXT OPRND UPDATE DMA    74586021
       BC      LO,FRML17          MAYBE - SIGN IS +, -, OR *            74592021
         CLC   GOTTEN+NX1(LX1),UMIN+NX1                                 74598021
       BC      EQ,FRML17           UNARY MINUS FOUND                    74604021
         CLC   DMAXSW(LX2),N0      NO - IS SW ON FROM LOWER ( LEVEL     74610021
       BC      NOTEQ,FRML18           YES - LEAVE AS IS                 74616021
       LH      RA0,PRNLEV              NO - SET IT ON FOR THIS LEVE     74622021
       AH      RA0,N5             (DMAXSW ALWAYS=PRNLEV+5 WHEN SET)     74628021
       STH     RA0,DMAXSW                                               74634021
       BC      UNCOND,FRML18       GO TO ENTER SIGN                     74640021
FRML17 LH      RA0,PRNLEV         SIGN IS +, -, OR *, WILL NEED DMA     74646021
       AH      RA0,N5              ON NEXT OP UNLESS WE ARE INSIDE      74652021
       CH      RA0,DMAXSW            PARENS UNDER CONTROL OF / OR *     74658021
         BC    HI,*+NX10           NO                                   74664021
         XC    DMAXSW(LX2),DMAXSW    UNDER CONTROL OF / OR **           74670021
FRML18 BAL     RCS,PUTSGN         ENTER SIGN IN PSIGNS TABLE            74676021
       BC      UNCOND,FRML2       RETURN TO SEEK OPERAND                74682021
*                                                                       74688021
*               NO SIGN FOUND WHERE EXPECTED. END OF FORMULA            74694021
*                                                                       74700021
FRML19 BAL     RCS,PEMPTY         CREATE REMAINING STRINGS              74706021
       LM      RCS,RA0,SVFRML                                           74712021
         BC    UNCOND,DX8(RCS)     VALID FORMULA                        74718021
*                                                                       74724021
*                      NUMERIC OPERAND NOT FOUND WHERE EXPECTED         74730021
*                                                                       74736021
*                                                                       74742021
FRML20 TM      GOTTEN,MDN         IS IT DATA OPERAND AT ALL             74748021
       BC      ONES,FRML22          YES                                 74754021
FRML21 EQU     *                                                        74760021
       LM      RCS,RA0,SVFRML       NO - EXIT ERROR OR NOT FORMULA      74766021
       BCR     UNCOND,RCS          ERROR OR NOT FORMULA                 74772021
*                                                                       74778021
*      NON-NUMERIC OPERAND FOUND.  MAY BE RECOVERABLE                   74784021
*           ERROR OR SIMPLY A NON-FORMULA                               74790021
*                                                                       74796021
FRML22 EQU     *                                                        74802021
       TM      PFNDOP,MSWON       WAS ANY NUMERIC OPERAND FOUND         74808021
       BC      ONES,FRML24        YES - THIS IS AN ERROR                74814021
       TM      UMINSW,MSWON       NO, BUT WAS A MINUS SIGN FOUND        74820021
       BC      ONES,FRML24        YES, THEN THIS IS AN ERROR            74826021
         CLC   GOTTEN(LX1),ERSYMB  IS IT A PH1 OR PH3 ERROR SYMBOL      74832021
       BC      EQ,FRML21            YES - GIVE UP                       74838021
*                                                                       74844021
       LM      RCS,RA0,SVFRML                                           74850021
         BC    UNCOND,DX4(RCS)     EXIT SINGLE NON-NUMERIC OPERAND      74856021
*                                                                       74862021
*      NON-NUMERIC OPERAND IS AN ERROR. SUBSTITUTE 'TALLY'              74868021
*                                                                       74874021
FRML24 BAL     RCS,PMKTAL          SUBSTITUTE TALLY                     74880021
       BC      UNCOND,FRML10      CONTINUE NORMALLY                     74886021
*                                                                       74892021
*      UNARY MINUS HAS BEEN DETERMINED. ENTER 'ZERO - ' BEFORE CURR     74898021
*        OPERAND.                                                       74904021
*                                                                       74910021
FRML50 ST      RCS,SVFR50                                               74916021
       OI      NEXTIN,MSWON       SAVE CURRENT ENTITY                   74922021
       LA      RIN,CBZERO         PRETEND INPUT IS 'ZERO'               74928021
       BAL     RCS,PUTNIN         ENTER IN NOUNS TABLE                  74934021
       OI      NEXTIN,MSWON       SAVE AGAIN (PUTNIN GOT NEXT)          74940021
       LA      RIN,UMIN           PUT UNARY MINUS IN TABLE              74946021
       BAL     RCS,PUTSGN          PUT SIGN INTO TABLE                  74952021
       L       RCS,SVFR50                                               74958021
       BCR     UNCOND,RCS          EXIT-ERROR OR NOT FORMULA            74964021
SBSW   DC    XL1'00'            TELLS FORMLA DN WAS SUBSCRIPTED         74970021
         EJECT                                                          74976021
*=2    PUTNIN    STORING AND RELEASE OF FORMULA ELEMENTS                74982021
*******************************************************************     74988021
*                                                                       74994021
*                                                                       75000021
*                            P U T N I N                                75006021
*                            P U T N 4 5                                75012021
*                                                                       75018021
*                                                                       75024021
*        ROUTINES TO ENTER OPERAND IN TAMER TABLE PNOUNT                75030021
*                                                                       75036021
*        CALLED BY COMPUT,IF,UNTIL,ON                                   75042021
*                                                                       75048021
*      BAL     RCS,PUTNIN                                               75054021
*      (RETURN)                                                         75060021
*                                                                       75066021
*        PUTNIN TAKES ENTRY FROM INPUT, PUTN45 FROM NORMAL STORAGE      75072021
*                                                                       75078021
*** SUBROUTINES CALLED                                                  75084021
*      GETNXT,PNSRTV,PUTSGN                                             75090021
*                                                                       75096021
*                                                                       75102021
*** NOTES                                                               75108021
*      PUTSGN IS CALLED TO PROCESS )'S - IF ANY - FOLLOWING OPERAND     75114021
*        BOTH APPEND BYTE-COUNT OF ENTRY AT END OF ENTRY, FOR FACIL     75120021
*          OF GOING BACKWARDS WHEN ENTRIES ARE REMOVED                  75126021
*        BOTH UPDATE PNOUCT TO NUMBER OF ENTRIES CURRENTLY IN TABLE     75132021
*      BOTH GET NEXT BEFORE EXIT                                        75138021
*                                                                       75144021
*                                                                       75150021
*******************************************************************     75156021
       SPACE   5                                                        75162021
PUTNIN STM     RCS,RW5,SVPUTN                                           75168021
       LR      RW4,RIN            RW4  STARTING SOURCE ADDR             75174021
*                                                                       75180021
       L       RW1,APNOUN                                               75186021
       BAL     RCS,PNSRTV         INSERT ENTRY                          75192021
         LA    RW4,DX0(RW4)                                             75198021
       LH      RW2,PNOUCT                                               75204021
         LA    RW2,DX1(RW2)         ADD 1 TO OPERAND COUNT              75210021
       STH     RW2,PNOUCT                                               75216021
       TM      PNOTSW,MSWON       DID 'NOT' PRECEDE THIS NOUN           75222021
       BC      ZERO,PUTN3         NO                                    75228021
         XC    PNEGSW(LX1),N1+NX1   YES - REVERSE NEGSW, CAUSING        75234021
       NI      PNOTSW,MSWOFF        RELATIONAL TO BE REVERSED           75240021
PUTN3  BAL     RCS,GETNXT          GET NEXT INPUT                       75246021
         CLC   GOTTEN(LX2),CBRPRN   PROCESS )S THAT MAY FOLLOW OPERA    75252021
       BC      NOTEQ,PUTN4         NOT ), GO TO EXIT                    75258021
       TM      UMINSW,MSWON       IS CALL FROM FRML50 INVENTING 'ZE     75264021
       BC      ONES,PUTN4           YES - THEN ) BELONGS LATER          75270021
       BAL     RCS,PUTSGN          PUT SIGN INTO TABLE                  75276021
PUTN4    LM    RCS,RW5,SVPUTN      EXIT                                 75282021
         BCR   UNCOND,RCS          RETURN                               75288021
         EJECT                                                          75294021
*******************************************************************     75300021
*                                                                       75306021
*                                                                       75312021
*                                                                       75318021
*                             P U T S G N                               75324021
*                                                                       75330021
*        BAL   RCS,PUTSGN                                               75336021
*        (RETURN)                                                       75342021
*                                                                       75348021
*        CALLED BY IF,COMPUT,UNTIL,ON                                   75354021
*      IF LESS THAN TWO NOUNS ARE IN OPERAND TABLE, EXITS.  OTHERWI     75360021
*          ANALYZES HIERARCHY OF OPERATORS                              75366021
*                                                                       75372021
*        ENTERS OPERATOR IN TAMER TABLE PSIGNT (EXCEPT RPREN),          75378021
*        IF OPERATOR IS = OR LESS IN CODE THAN LAST OPERATOR IN         75384021
*          TABLE, CREATES VERB FROM LAST OPERATOR, AND STORES IN        75390021
*          STRING VERB,LAST 2 OPERANDS IN NOUN TABLE, NEW IR.           75396021
*          REPLACES LAST TWO OPERANDS IN NOUN TABLE BY IR               75402021
*        IF OPERATOR IS ), CREATES STRINGS TILL LAST IN TABLE IS (,     75408021
*          THEN DELETES (.                                              75414021
*                                                                       75420021
*** SUBROUTINES CALLED                                                  75426021
*      GETNXT,STOR45,INSERT,PNSRTF,PNSRTV,PREMVV,PUPIR,ERROR            75432021
*                                                                       75438021
*                                                                       75444021
*** ERROR PROCESSING                                                    75450021
*      IDENTIFIES UNPAIRED PARENS,THEORETICALLY SUPPLIES THE MISSIN     75456021
*                                                                       75462021
*                                                                       75468021
*** NOTES                                                               75474021
*      WHEN ITS INPUT (GOTTEN) IS (,PROCESSES ALL IMMEDIATELY SUCCE     75480021
*        ING ('S. SIMILARLY WITH ).                                     75486021
*      UPDATES DMAXSW FOR ) -- SEE FORMLA                               75492021
*      WITHIN IF, ADJUSTS NOT-BIT IN PTRFLS TABLE WHEN PRNLEV CHANG     75498021
*        OPERATOR CODES,FROM LOW TO HIGH ARE      (                     75504021
*                                                 +                     75510021
*                                                 -                     75516021
*                                                 *                     75522021
*                                                 /                     75528021
*                                                 **                    75534021
*      UPDATES PSGCNT -- SIGNS-TABLE DISPLACEMENT                       75540021
*                                                                       75546021
*      GETS NEXT BEFORE RETURN                                          75552021
*                                                                       75558021
*                                                                       75564021
*******************************************************************     75570021
       SPACE   5                                                        75576021
PUTSGN   STM   RCS,RW6,SVPTSG                                           75582021
         L     RW1,APSGNT          GIVE RW1 ADDR. OF TIB FOR SIGNS      75588021
         CLC   GOTTEN(LX2),CBLPRN                                       75594021
       BC      EQ,PTSG20           YES, GO TO (FOUND                    75600021
PTSGN0   CLC   PNOUCT(LX2),N2       IF 0 OR 1 OPERANDS, JUST ENTER S    75606021
       BC      NOTLO,PTSGN6        MORE THAN ONE OPERAND                75612021
         CLC   GOTTEN(LX2),CBRPRN     UNLESS IT IS RIGHT PAREN          75618021
       BC      EQ,PTSG40           GO TO ) FOUND                        75624021
*                                                                       75630021
*                                     EXIT                              75636021
*                                                                       75642021
PTSGN2 BAL     RCS,PNSRTF          INSERT IN TABLE                      75648021
       LA      RW4,GOTTEN         INSERT SIGN IN TABLE                  75654021
PTSGN4   BAL   RCS,GETNXT          GET NEXT AND EXIT                    75660021
PTSGN5   LM    RCS,RW6,SVPTSG                                           75666021
       NI      PMSGSW,MSWOFF                                            75672021
         BCR   UNCOND,RCS          EXIT                                 75678021
*                                                                       75684021
*        MORE THAN 1 OPERAND ALREADY IN NOUNS TABLE                     75690021
*        COMPARE HIERARCHY OF SIGNS                                     75696021
*                                                                       75702021
PTSGN6   L     RW6,DX0(RW1)         RW6 GETS ADDR. OF  TAMM FOR SIGN    75708021
         L     RW4,DX0(RW6)         RW4  .    .    .   NEXT ENTRY       75714021
         AH    RW4,DX4(RW6)                                             75720021
         SH    RW4,N2         POINT RW4 TO PREVIOUS ENTRY               75726021
         CLC   GOTTEN(LX2),DX0(RW4)                                     75732021
       BC      NOTHI,PTSGN8       CREATE STRINGS IF GOTTEN = OR LOW     75738021
         MVC   TEMP(LX2),DX0(RW4)   TEMP WILL BE 1 FOR HIERARCHICALLY   75744021
         XC    TEMP(LX2),GOTTEN     EQUAL PAIRS, + AND ', OR * AND /    75750021
         CLC   TEMP(LX2),N1                                             75756021
       BC      NOTEQ,PTSGN2       GOTTEN IS NOT OF PAIR,ENTER IN  T     75762021
         CLC   GOTTEN(LX2),CBRPRN   IF PAIR IS (), CLOSE UP             75768021
       BC      EQ,PTSG40           GO TO ) FOUND                        75774021
*                                                                       75780021
*        GOTTEN IS = OR LESS THAN LAST SIGN. CREATE VERB STRING         75786021
*                                                                       75792021
PTSGN8 EQU     *                                                        75798021
         CLC   DX1(LX1,RW4),UMIN+NX1 IS IT UNARY MINUS                  75804021
         BC    NOTEQ,*+NX10         NO                                  75810021
         MVC   DX1(LX1,RW4),CBMINS+NX1 YES - CHANGE IT TO SUBTRACTION   75816021
         MVI   DX0(RW4),MVBOUT     CHANGE SIGN-HEAD TO VERB HEAD        75822021
         MVC   TEMPSAVE(LX2),DX0(RW4)  SAVE TABLE ENTRIES         P0205 75828021
         MVI   TEMPSAVE+NX2,XX05     APPEND ELEMENT COUNT OF 5    P0205 75834021
         LA    RW4,TEMPSAVE        PICK UP TEMPSAVE ADDR          P0205 75840021
         BAL   RCS,STOR45     STORE VERB AND COUNT IN STRING            75846021
*DEL                                                                    75852021
         LH    RW4,DX4(RW6)                                             75858021
         SH    RW4,N2         REDUCE DISP. IN TAMM BY 2                 75864021
         STH   RW4,DX4(RW6)                                             75870021
       STH     RW4,DSPSGN                                               75876021
*                                                                       75882021
*        MOVE 2 OPERANDS FROM NOUN TABLE TO STRING                      75888021
*                                                                       75894021
         LA    RW3,DX2(RA0,RA0)      RW3 LOOPS THRU 2 OPERANDS          75900021
PSTG10 L       RW1,APNOUN                                               75906021
       BAL     RCS,PREMVV         REMOVE FROM NOUNS TABLE               75912021
         LA    RW4,DX0               (DUMMY-JUST UPDATE TIB AND TAMM    75918021
         L     RW4,DX0(RW1)        GIVE RW4 SOURCE-ADDR.                75924021
         L     RW4,DX0(RW4)          = TABLE ADDR. + SAVED DISPL.       75930021
       AH      RW4,DSPNOU                                               75936021
         LR    RW2,RW4                                            P0205 75942021
         BAL   RCS,COUNT           GET COUNT OF BYTES TO MOVE     P0205 75948021
         LH    RW2,BYTES                                          P0205 75954021
         EX    RW2,MVTEMP          SAVE PNCOUNT ENTRY IN TEMP     P0205 75960021
         LA    RW4,TEMPSAVE                                       P0205 75966021
       BAL     RCS,STOR45         STORE IN STRING TABLE                 75972021
       BCT     RW3,PSTG10         RETURN FOR 2ND OPERAND                75978021
       LH      RW3,PNOUCT                                               75984021
         BCT   RW3,*+NX4           REDUCE NOUN-TABLE COUNT BY 1         75990021
       STH     RW3,PNOUCT           (TOOK 2 OUT BUT WILL INSERT IR)     75996021
*                                                                       76002021
*        MOVE IR TO VERB-STRING AND TO NOUNS-TABLE                      76008021
*                                                                       76014021
         BAL   RCS,PUPIR      UPDATE TO NEXT IR-ID                      76020021
       LA      RW4,IR             STORE IR IN STRING                    76026021
       BAL     RCS,STOR45          STORE IR IN STRING                   76032021
       L       RW1,APNOUN                                               76038021
       BAL     RCS,PNSRTV         INSERT IR IN NOUNS TABLE              76044021
       LA      RW4,IR                                                   76050021
       L       RW1,APSGNT                                               76056021
         BC    UNCOND,PTSGN0  RETURN TO EXAMINE PRECEDING SIGN          76062021
MVTEMP   MVC   TEMPSAVE(LX1),DX0(RW4)       SAVE                  P0205 76068021
*                                                                       76074021
*                                  (  FOUND                             76080021
*                                                                       76086021
PTSG20 LH      RW6,PRNLEV         ( FOUND, UPDATE LEVEL                 76092021
         LA    RW6,DX5(RW6)                                             76098021
       STH     RW6,PRNLEV                                               76104021
       BAL     RCS,PNSRTF          PUT IN TABLE                         76110021
       LA      RW4,GOTTEN                                               76116021
       TM      PLOGIC,MSWON       SKIP LEVEL ADJUSTMENTS WHEN NOT I     76122021
       BC      ZERO,PTSG30         GO TO RESTORE POINTER                76128021
       CH      RW6,HILEV          IS THIS LEVEL HIGHER THAN HIGHEST     76134021
       BC      LO,PTSG24           NO                                   76140021
         LA    RW6,DX5(RW6)        (ALWAYS KEEP HILEV AT PRNLEV+5)      76146021
       STH     RW6,HILEV          YES - UPDATE HILEV                    76152021
       L       RW1,APTFLS         MAKE ROOM FOR INSERTION OF BYPASS     76158021
       L       RAS,ANSERT         AND FALL-THRU BRANCHES AT NEXT LE     76164021
*                   (POSSIBLY TO BE USED FOR AND,NOT AND, NOT OR)       76170021
       BALR    RCS,RAS             BRANCH TO TARGET ADDRESS             76176021
         LA    RW3,DX5(RW3)                                             76182021
       STH     RW3,DSPTRF         UPDATE SAVED DISPL.                   76188021
         XC    DX0(LX5,RW2),DX0(RW2) EVICT FORMER TENANT                76194021
       SH      RW2,N10             POINT RW2 AT PREVIOUS LEVEL          76200021
       BC      UNCOND,PTSG26       GET NEW LEVEL                        76206021
PTSG24 L       RW1,APTFLS         FIND NEW PAREN LEVEL IN PTRFLS        76212021
         L     RW2,DX0(RW1)                                             76218021
         L     RW2,DX0(RW2)                                             76224021
       AR      RW2,RW6                                                  76230021
       SH      RW2,N5              POINT RW2 AT PREVIOUS LEVEL          76236021
PTSG26   MVC   DX5(LX1,RW2),DX0(RW2) GIVE NEW LEVEL POS-NEG BIT OF PRE  76242021
       TM      PNOTSW,MSWON       DID 'NOT' PRECEDE THIS (              76248021
       BC      ZERO,PTSG30        NO                                    76254021
         XC    DX5(LX1,RW2),N1+NX1  YES - REVERSE POS-NEG BIT           76260021
       NI      PNOTSW,MSWOFF                                            76266021
PTSG30 L       RW1,APSGNT         RESTORE SIGNS TABLE POINTER           76272021
       BAL     RCS,GETNXT          GET NEXT INPUT                       76278021
         CLC   GOTTEN(LX2),CBLPRN     RETURN TO PUT ALL FOLLOWING (S    76284021
       BC      EQ,PTSG20             IN TABLE                           76290021
       BC      UNCOND,PTSGN5       GO TO EXIT                           76296021
*                                                                       76302021
*                                 GOTTEN IS  )                          76308021
*      IF HIGHER THAN LAST IN TABLE, LAST MUST BE )                     76314021
*      IF ONLY 1 OPERAND REMAINS IN NOUNS TABLE, PROCESS IS COMPLET     76320021
*                                                                       76326021
PTSG40 TM      PMTYSW,MSWON       IS FINAL REDUCTION CALLED FOR         76332021
       BC      ZERO,PTSG42        NO                                    76338021
         CLC   PNOUCT(LX2),N2      YES - IS NOUN TABLE REDUCED          76344021
       BC      LO,PTSGN4          YES - EXIT (THIS IS PHONY RIGHT       76350021
*                                   PAREN NOT AFFECTING PAREN LEVEL     76356021
       BAL     RCS,ERONCE         NO - ERROR,UNCLOSED ('S.              76362021
*                                 WRITE MSG ONLY ONCE                   76368021
       LA      RW1,ELST06                                               76374021
PTSG42   CLC   PRNLEV(LX2),DMAXSW  ARE WE CLOSING A DIVISOR OR EXPON    76380021
         BC    HI,*+NX10             NO                                 76386021
         XC    DMAXSW(LX2),DMAXSW   YES - DMAX WILL AGAIN BE NEEDED     76392021
       LH      RW6,PRNLEV         DOWNDATE PAREN LEVEL                  76398021
       SH      RW6,N5                                                   76404021
       BC      NEG,PTSG50         ERROR - EXTRA RIGHT PAREN             76410021
       STH     RW6,PRNLEV                                               76416021
       TM      PLOGIC,MSWON       ARE WE IN IF                          76422021
       BC      ZERO,PTSG44        NO                                    76428021
       L       RW1,APTFLS         YES - ADJUST NEGATIVES IN LABEL T     76434021
         L     RW1,DX0(RW1)        RW1 GETS TAMM ADDR.                  76440021
         L     RW1,DX0(RW1)        NOW GETS STARTING ADDR. OF TABLE     76446021
       AR      RW1,RW6            + PRESENT PAREN LEVEL = ADDR. THI     76452021
         MVC   PTEMP(LX1),DX0(RW1)    LEVEL. IS THIS LEVEL SAME AS TH   76458021
         XC    PTEMP(LX1),DX5(RW1)  NEXT HIGHER -- BOTH POS OR BOTH N   76464021
       TM      PTEMP,MSWON                                              76470021
       BC      ZERO,PTSG44        YES - LEAVE AS IS                     76476021
         XC    PNEGSW(LX1),N1+NX1   NO - REVERSE PNEGSW CAUSING NEGAT   76482021
*                                         OF RELATIONAL                 76488021
PTSG44 L       RW1,APSGNT         ELIMINATE ( FROM TABLE BY REDUCIN     76494021
       BAL     RCS,PREMVF         DISP. OF NEXT ENTRY BY 2              76500021
         LA    RW4,DX0(RW2)          (DUMMY)                            76506021
       TM      PMTYSW,MSWON       IF CALL WAS FROM PEMPTY, GO BACK      76512021
       BC      ONES,PTSGN6          AND REDUCE TABLE                    76518021
       BAL     RCS,GETNXT          GET NEXT INPUT                       76524021
         CLC   GOTTEN(LX2),CBRPRN                                       76530021
       BC      EQ,PTSGN0          PROCESS ANY )S THAT FOLLOW            76536021
       BC      UNCOND,PTSGN5       EXIT FROM PUTSGN                     76542021
PTSG50 BAL     RCS,ERROR          TOO MANY )'S                          76548021
       LA      RW1,ELST0A                                               76554021
PTSG52 BAL     RCS,GETNXT         DISCARD THIS AND SUCCEEDING )S        76560021
         CLC   GOTTEN(LX2),CBRPRN                                       76566021
       BC      EQ,PTSG52           RIGHT PAREN - DISCARD IT             76572021
       BC      UNCOND,PTSGN5       NO, GO TO EXIT                       76578021
*                                                                       76584021
         EJECT                                                          76590021
*******************************************************************     76596021
*                                                                       76602021
*                             P E M P T Y                               76608021
*                                                                       76614021
*        BAL   RCS,PEMPTY                                               76620021
*        (RETURN)                                                       76626021
*                                                                       76632021
*        CALLED BY IF ,COMPUT,UNTIL,ON                                  76638021
*      CAUSES TAMER TABLE PSIGNS TO BE EMPTIED OF ALL BUT NON-MATCH     76644021
*        LEADING (S AND ALL REMAINING VERB STRINGS TO BE CREATED        76650021
*                                                                       76656021
*** SUBROUTINES CALLED                                                  76662021
*      SAVNXT,PUTSGN,PREMVV                                             76668021
*                                                                       76674021
*                                                                       76680021
*** NOTES                                                               76686021
*      PMTYSW TELLS PUTSGN THAT ) IS A PHONY -- NOT TO TOUCH PRNLEV     76692021
*        BUT TO FLUSH OUT THE TABLES                                    76698021
*      LAST REMAINING OPERAND IN PNOUNT IS STORED AT PRSULT             76704021
*                                                                       76710021
*                                                                       76716021
*                                                                       76722021
*******************************************************************     76728021
       SPACE   5                                                        76734021
PEMPTY ST      RCS,SVPMTY                                               76740021
       OI      NEXTIN,MSWON       SET GOTTEN TO ),CAUSING IT TO EMP     76746021
       LA      RIN,CBRPRN         TABLES UNTIL NOUN TABLE IS REDUCE     76752021
       OI      PMTYSW,MSWON       TO A SINGLE OPERAND                   76758021
         BAL   RCS,PUTSGN          GO CREATE ALL STRINGS                76764021
       NI      PMTYSW,MSWOFF                                            76770021
         XC    PNOUCT(LX2),PNOUCT    ZERO NOUN-COUNT                    76776021
       L       RW1,APNOUN                                               76782021
       BAL     RCS,PREMVV         MOVE LAST NOUN TO PRSULT              76788021
       LA      RW4,PRSULT                                               76794021
         L     RW1,SVPTSG+NX12     (RW1 WAS SAVED  BY PUTSGN)           76800021
         XC    DMAXSW(LX2),DMAXSW     REINIT FOR DMAX                   76806021
       L       RCS,SVPMTY                                               76812021
         BCR   UNCOND,RCS          RETURN                               76818021
       EJECT                                                            76824021
*                                                                       76830021
*=2              MISCELLANEOUS SMALL ROUTINES                           76836021
*                                                                       76842021
       SPACE   5                                                        76848021
*                                                                       76854021
*                                                                       76860021
*                           D U P S S                                   76866021
*                                                                       76872021
*      BAL     RCS,DUPSS                                                76878021
*      (RETURN)                                                         76884021
*                                                                       76890021
*      CALLED BY ARITH AND PERFORM(VARYING) TO CREATE AN ADDITIONAL     76896021
*       SUBSCRIPT-DEFINING STRING FOR A STORE-FIELD WHICH IS IDENTI     76902021
*       TO AN OPERAND -- E.G., SUBTRACT X FROM Y(1).                    76908021
*      STRCNT  ON ENTRANCE MUST CONTAIN THE TABLE DISPLACEMENT OF T     76914021
*       WANTED SS STRING, WHICH MUST BE THE LAST IN THE TABLE.          76920021
*      PSTFLD CONTAINS THE STORE-FIELD AND IS MODIFIED.                 76926021
*                                                                       76932021
DUPSS  EQU     *                                                        76938021
       CLI     PSTFLD,MSS         IS STORE-FIELD SUBSCRIPTED            76944021
       BCR     NOTEQ,RCS           NO - EXIT                            76950021
       STM     RCS,RW4,SVDUPS                                           76956021
       LH      RW1,SSNUMB       YES - DUPLICATE ITS SS-DEFINING STR     76962021
         LA    RW1,DX1(RW1)          WITH NEW SSID                      76968021
       STH     RW1,SSNUMB                                               76974021
         MVC   PSTFLD+NX5(LX2),SSNUMB PUT NEW ID INTO PSTFLD            76980021
         OI    PSTFLD+NX4,XX80      TURN ON HIGH ORDER BIT              76986021
       L       RW1,ADFSBS                                               76992021
         L     RW4,DX0(RW1)                                             76998021
         L     RW4,DX0(RW4)                                             77004021
       AH      RW4,STRCNT   RW4 GETS TABLE ADDR. OF LAST SS             77010021
       SR      RW3,RW3               (STRCNT SAVED ITS DISPL.)          77016021
         IC    RW3,DX2(RW4)        RW3 GETS ELEMENT COUNT,CONTROLS L    77022021
         MVI   DX0(RW1),XX03       SSVERB IS 3 BYTES LONG               77028021
         MVC   BYTES(LX2),N3                                            77034021
DUPSS2 BAL     RCS,PNSRTF         INSERT ELEMENT AT NEXT AVAILABLE      77040021
         LA    RW4,DX0(RW4)                                             77046021
       AH      RW4,BYTES                                                77052021
       LR      RW2,RW4                                                  77058021
       BAL     RCS,COUNT           GET COUNT OF BYTES                   77064021
         MVC   DX0(LX1,RW1),BYTES+NX1 GIVE TIB THE COUNT FOR TAMER INSE 77070021
       BCT     RW3,DUPSS2         GO STORE NEXT ELEMENT                 77076021
         MVC   SVSUBS(LX2),DSPSBS   SAVE DISP BEG OF SSID               77082021
       BAL     RCS,PNSRTF                 /INSERT IN TABLE              77088021
         LA    RW4,DX0(RW4)                                             77094021
         L     RW1,DX0(RW1)  GET ADDR OF TAMM                           77100021
         L     RW4,DX0(RW1)        PT RW4 TO TABLE                      77106021
       AH    RW4,SVSUBS          RW4 SHOULD POINT TO SSID               77112021
         MVC   DX5(LX2,RW4),SSNUMB  PUT NEW SSID IN 1ST OF SS PAIR      77118021
       LM      RCS,RW4,SVDUPS                                           77124021
       BCR     UNCOND,RCS          RETURN                               77130021
       SPACE   3                                                        77136021
*                                                                       77142021
*                                                                       77148021
*                           C A L C L G                                 77154021
*                                                                       77160021
*      BAL     RCS,CALCLG                                               77166021
*      (RETURN NOT TYPE TO HAVE LENGTH)                                 77172021
*      (RETURN HAS LENGTH)                                              77178021
*                                                                       77184021
*      ON EXIT LENGTH IS STORED AT LOC LENGTH (FULL WORD)               77190021
*         LENGTH = 1 FOR FIGCONS                                        77196021
*                  4 FOR SPECIAL NAMES                                  77202021
*                                                                       77208021
*                                                                       77214021
*        CALCULATES THE LENGTH OF  CURRENT UNIT.                        77220021
*                                                                       77226021
CALCLG CLI     GOTTEN,MDN          MUST BE A DN                         77232021
       BC      EQ,CALG00           DN, GO TO FIND LENGTH                77238021
       CLI     GOTTEN,MSS         OR SUBSCRIPTED DN                     77244021
       BC      NOTEQ,CALG01        NO, CHECK IF LITERAL                 77250021
* FIND THE LENGTH FROM MINOR,DN'S ONLY                                  77256021
CALG00 EQU     *                                                        77262021
       STM     RCS,RW2,SVSO14                                           77268021
       LR      RW1,RIN            CURR UNIT POINTER                     77274021
       SR      RW2,RW2             ISOLATE MINOR                        77280021
         IC    RW2,DX3(RW1)                                             77286021
         SRL   RW2,DX4                                                  77292021
         SLL   RW2,DX2              MINOR*4                             77298021
       BC      UNCOND,SOR24(RW2)   TRANS. VECTOR BY MINOR               77304021
SOR24  BC      UNCOND,SOR21        PREV. DETECTED ERROR                 77310021
       BC      UNCOND,SOR16        GROUP FIX                            77316021
       BC      UNCOND,SOR16        ALPHA                                77322021
       BC      UNCOND,SOR16        AN                                   77328021
       BC      UNCOND,SOR23        GROUP VAR                            77334021
       BC      UNCOND,SOR15        RPT                                  77340021
       BC      UNCOND,SOR15        STERLING RPT                         77346021
       BC      UNCOND,SOR21        UNASSIGNED                           77352021
       BC      UNCOND,SOR17        XD                                   77358021
       BC      UNCOND,SOR17        XFP                                  77364021
       BC      UNCOND,SOR20        IFP                                  77370021
       BC      UNCOND,SOR19        BIN                                  77376021
       BC      UNCOND,SOR18        ID                                   77382021
       BC      UNCOND,SOR14        STERLING NON-RPT                     77388021
       BC      UNCOND,SOR21        UNASSIGNED                           77394021
       BC      UNCOND,SOR21        UNASSIGNED                           77400021
SOR14    IC    RW2,DX10(RW1)        L IS IN BITS 83-87                  77406021
       N     RW2,HEX1F             ZERO ALL BUT LOW ORDER 5 BITS        77412021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77418021
SOR15  SR      RW2,RW2                                                  77424021
         IC    RW2,DX11(RW1)        LENGTH IS IN 88-95                  77430021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77436021
SOR16    MVC   HTEMP(LX2),DX8(RW1)   L IS IN BITS 64-79                 77442021
       LH    RW2,HTEMP                                                  77448021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77454021
SOR17  SR      RW2,RW2             L IS IN BITS 72-79                   77460021
         IC    RW2,DX9(RW1)                                             77466021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77472021
SOR18  SR      RW2,RW2             P.D.9 COUNT IS IN 72-79              77478021
         IC    RW2,DX9(RW1)         CONVERT TO BYTES                    77484021
         LA    RW2,DX2(RW2)                                             77490021
         SRA   RW2,DX1              L= (C+2)/2                          77496021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77502021
SOR19  SR      RW2,RW2             BIN 9 COUNT IS IN 72-79              77508021
         IC    RW2,DX9(RW1)         CONVERT TO BYTES                    77514021
       CH      RW2,N5                                                   77520021
       BC      LO,SOR19A           2 BYTES                              77526021
       CH      RW2,N10                                                  77532021
       BC      LO,SOR19B           4 BYTES                              77538021
         LA    RW2,DX8              8 BYTES                             77544021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77550021
SOR19A   LA    RW2,DX2                                                  77556021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77562021
SOR19B   LA    RW2,DX4                                                  77568021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77574021
SOR20    LA    RW2,DX4              FL.PT.,PREC IS BIT 70               77580021
         TM    DX9(RW1),XX01        TEST PREC BIT                       77586021
       BC      ZERO,SOR22          SINGLE,4 BYTES                       77592021
         LA    RW2,DX8              DOUBLE,8 BYTES                      77598021
SOR22  ST      RW2,LENGTH          SAVE LENGTH                          77604021
       LM      RCS,RW2,SVSO14                                           77610021
         BC    UNCOND,DX4(RCS)      LENGTH FOUND EXIT                   77616021
SOR21  SR      RW2,RW2             ERROR                                77622021
       ST      RW2,LENGTH          MAKE LENGTH = 0                      77628021
       LM      RCS,RW2,SVSO14                                           77634021
       BCR     UNCOND,RCS          ERROR EXIT                           77640021
SOR23    MVC   HTEMP(LX2),DX8(RW1)   VLC IS IN BITS 64-79               77646021
       LH    RW2,HTEMP                                                  77652021
       N       RW2,SORMSK          ZERO HI ORDER BITS                   77658021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77664021
CALG01 CLI     GOTTEN,MNLIT                                             77670021
       BC      EQ,CALG02           NUM LIT                              77676021
       CLI     GOTTEN,MFLIT                                             77682021
       BC      EQ,CALG02           FL PT LIT                            77688021
       CLI     GOTTEN,MALIT                                             77694021
       BC      EQ,CALG02           AN LIT                               77700021
       CLI     GOTTEN,MFGCON                                            77706021
       BC      NOTEQ,CALG03        NOT A FIGCON                         77712021
         MVI   LENGTH+NX3,XX01      FIG-CON, LENGTH = 1                 77718021
CALG04   XC    LENGTH(LX3),LENGTH                                       77724021
         BC    UNCOND,DX4(RCS)      TAKE 'YES' EXIT                     77730021
CALG02 STM     RCS,RW2,SVSO14                                           77736021
       SR      RW2,RW2                                                  77742021
         IC    RW2,GOTTEN+NX1                                           77748021
       BC      UNCOND,SOR22        GO TO LENGTH FOUND EXIT              77754021
CALG03 CLI     GOTTEN,MSPDN                                             77760021
       BCR     NOTEQ,RCS           NOT A TYPE WORD THAT HAS A LENGT     77766021
         MVI   LENGTH+NX3,XX04      SP NAMES HAVE LENGTH=4              77772021
       BC      UNCOND,CALG04       GO TO EXIT - OK                      77778021
       SPACE   5                                                        77784021
*                                                                       77790021
*                                 M I N L I T                           77796021
*                                                                       77802021
*      BAL     RCS,MINLIT                                               77808021
*      (RETURN)                                                         77814021
*                                                                       77820021
*      REVERSES SIGN OF NUMERIC OR FLOATING LITERAL IN INPUT            77826021
*                                                                       77832021
*                                                                       77838021
MINLIT STM     RCS,RW2,SVMINL                                           77844021
       CLI     GOTTEN,MNLIT       IS IT NUMERIC                         77850021
       BC      NOTEQ,MINLT2        NO                                   77856021
       LR      RW2,RIN                                                  77862021
       BAL     RCS,COUNT           GET BYTE COUNT                       77868021
       AH      RW2,BYTES            YES                                 77874021
       BCTR  RW2,RA0              POINT RW2 TO LAST BYTE                77880021
         TM    DX0(RW2),XX0F       LITERAL UNSIGNED OR +                77886021
       BC    NOTONE,MINLT1           'C'                                77892021
         NI    DX0(RW2),XXFD            CHANGE TO D                     77898021
        B      *+NX8               GO TO EXIT                           77904021
MINLT1   XI    DX0(RW2),MINMSK      C TO D                              77910021
       LM      RCS,RW2,SVMINL                                           77916021
       BCR     UNCOND,RCS          RETURN                               77922021
MINLT2   XI    DX2(RIN),XX80       FLOATING                             77928021
       BCR     UNCOND,RCS          RETURN                               77934021
       SPACE   3                                                        77940021
*                                                                       77946021
*                           D E C M A X                                 77952021
*                                                                       77958021
*                                                                       77964021
*      BAL     RCS,DECMAX                                               77970021
*      (RETURN)                                                         77976021
*                                                                       77982021
*      CALLED BY ARITHMETIC VERBS AND IF TO UPDATE DMAX FIELD OF EV     77988021
*        AFTER A LEGAL OPERAND IS FOUND AND ITS SCALING FACTOR HAS      77994021
*        BEEN PLACED IN DCURR.                                          78000021
*                                                                       78006021
*                                                                       78012021
DECMAX EQU     *                                                        78018021
         CLC   DMAX(LX1),DCURR     IS MAX SCALING LOWER THAN CURRENT    78024021
       BCR     NOTLO,RCS          NO - EXIT                             78030021
         MVC   DMAX(LX1),DCURR     YES - MAKE CURRENT SCALING THE MA    78036021
       BCR     UNCOND,RCS          YES, EXIT                            78042021
       SPACE   3                                                        78048021
*                                                                       78054021
*                                                                       78060021
*                                 P M K T A L                           78066021
*                                                                       78072021
*      BAL     RCS,PMKTAL                                               78078021
*      (RETURN)                                                         78084021
*                                                                       78090021
*      CALLED WHEN AN OPERAND WHICH SHOULD BE NUMERIC IS FOUND TO       78096021
*        HAVE THE WRONG ATTRIBUTES                                      78102021
*                                                                       78108021
*      WRITES ERROR MESSAGE                                             78114021
*      SUBSTITUTES 'TALLY' FOR OFFENDING OPERAND IN INPUT STREAM        78120021
*                                                                       78126021
*** SUBROUTINES CALLED                                                  78132021
*      ERROR                                                            78138021
*                                                                       78144021
*                                                                       78150021
*                                                                       78156021
PMKTAL ST      RCS,SVMKTA                                               78162021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  78168021
       LA      RW1,ELST13                                               78174021
       L       RCS,SVMKTA                                               78180021
PMKTA2 EQU     *                                                        78186021
       LA      RIN,CBTALY                                               78192021
         XC    DCURR(LX1),DCURR    MAKE DCURR = 0                       78198021
         MVC   MODE(LX2),TALMOD    PROVIDE ITS MODE                     78204021
       BCR     UNCOND,RCS          EXIT                                 78210021
       SPACE   3                                                        78216021
*                                                                       78222021
*                             P C H C N T                               78228021
*                                                                       78234021
*        BAL   RCS,PCHCNT                                               78240021
*        DC    XL2'NEW-COUNT'                                           78246021
*        (RETURN)                                                       78252021
*                                                                       78258021
*      CHANGES ELEMENT-COUNT OF FIRST VERB-STRING TO VALUE AT 1(RCS     78264021
*                                                                       78270021
PCHCNT   STM   RW1,RW2,SVPCHG                                           78276021
         L     RW1,ASTRNG          GIVE RW1 ADDR. OF TIB                78282021
         L     RW1,DX0(RW1)           .  RW1   .   .  TAMM              78288021
         L     RW2,DX0(RW1)           .  RW2  .    .  TABLE             78294021
         MVC   DX2(LX1,RW2),DX1(RCS) MOVE NEW COUNT OT BYTE-3 OF STRI   78300021
         LM    RW1,RW2,SVPCHG                                           78306021
         BC    UNCOND,DX2(RCS)     EXIT                                 78312021
       SPACE   3                                                        78318021
*                                                                       78324021
*                                                                       78330021
*                             P U P I R                                 78336021
*                                                                       78342021
*        BAL   RCS,PUPIR                                                78348021
*        (RETURN)                                                       78354021
*                                                                       78360021
*        INCREMENTS  INTERNAL-REGISTER IDENTIFIER BY 1                  78366021
*                                                                       78372021
*                                                                       78378021
PUPIR    ST    RW1,SVPUPI                                               78384021
         LH    RW1,IR+NX1                                               78390021
         LA    RW1,DX1(RW1)                                             78396021
         STH   RW1,IR+NX1                                               78402021
         L     RW1,SVPUPI                                               78408021
         TM    IR+NX1,XX80         RETURN TO 1 AFTER 7FFF               78414021
       BCR     ZERO,RCS            RETURN - HIGH ORDER BIT NOT ON       78420021
         MVC   IR+NX1(LX2),N1                                           78426021
         BCR   UNCOND,RCS          SET IR BACK TO 1 AND EXIT            78432021
*                                                                       78438021
*                                                                       78444021
*      PUPTR                                                            78450021
*                                                                       78456021
*    BAL  RCS,PUPTR                                                     78462021
*   (RETURN)                                                            78468021
*                                                                       78474021
* CALLED BY ARITHMETIC VERB ANALYZER TO INCREMENT TEMPORARY             78480021
*   REGISTER IDENTIFIER BY 1                                            78486021
*                                                                       78492021
*                                                                       78498021
PUPTR  ST  RW1,SVPUPTR                                                  78504021
         LH    RW1,TR+NX1                                               78510021
         LA    RW1,DX1(RW1)                                             78516021
         STH   RW1,TR+NX1                                               78522021
       L RW1,SVPUPTR                                                    78528021
         TM    TR+NX1,XX80                                              78534021
       BCR ZERO,RCS                RETURN - HIGH ORDER BIT NOT ON       78540021
         MVC   TR+NX1(LX2),N1                                           78546021
       BCR  UNCOND,RCS             SET TR BACK TO 1 AND EXIT            78552021
       SPACE   3                                                        78558021
*                                                                       78564021
*                                                                       78570021
*                              P U P L G N                              78576021
*                                                                       78582021
*      BAL     RCS,PUPLGN                                               78588021
*      (RETURN)                                                         78594021
*                                                                       78600021
*      INCREMENTS NXTLGN (ID OF GN'S) BY 1.                             78606021
*      NXTLGN IS INITIALIZED FROM COMMON GNCTR AT PHINIT, AND RETUR     78612021
*        TO COMMON AT EOF                                               78618021
*                                                                       78624021
*                                                                       78630021
PUPLGN   ST    RW1,SVPLGN                                               78636021
       LH      RW1,NXTLGN                                               78642021
         LA    RW1,DX1(RW1)                                             78648021
       STH     RW1,NXTLGN                                               78654021
         L     RW1,SVPLGN                                               78660021
         BCR   UNCOND,RCS          RETURN                               78666021
*                                                                       78672021
*         EOPROC                                                        78678021
*                                                                       78684021
*   BAL   RCS,EOPROC                                                    78690021
*   (RETURN)                                                            78696021
*                                                                       78702021
*  GETS A GN AND ATTACHES IT TO RECORDNAME ATTRIBUTES IMMEDIATELY       78708021
*   FOLLOWING DICTIONARY POINTER.                                       78714021
*     CALLED BY WRITE WHEN EOP OPTION IS FOUND.                         78720021
*   IF NXTSNT IS NOT 0, CHANGES GNREFS TO NEXT SENTENCE IN WRITE        78726021
*   STRING AND IN GNX TO GN NUMBER IN NXTSNT.                           78732021
EOPROC ST    RCS,EOPSV                                                  78738021
       BAL   RCS,ISNXTS            DOES 'NEXT SENTENCE' FOLLOW EOP      78744021
       B     EOPROC1               NO     OK                            78750021
       LA    RA0,CBEOP             YES                                  78756021
       BAL   RCS,ERROR             WRITE MSG AND IGNORE OPTIONN         78762021
       LA    RW1,ELST4B                                                 78768021
       NI    EOPSW,MSWOFF                                               78774021
       BC    UNCOND,EOPR1          EXIT WITH EOPSW OFF                  78780021
EOPROC1 DS    0H                                                        78786021
       BAL   RCS,PUPLGN            GET A GN NUMBER                      78792021
         MVC   RGN+NX1(LX2),NXTLGN   GIVE IT A GNREF HEADER             78798021
       LA    RW4,PRIGHT            PRIGHT WILL HOLD RECDNM WITH GN      78804021
       L    RW1,ASTRNG             RECDNM IN STRING IS LAST             78810021
       BAL   RCS,PREMVV            REMOVE IT FROM STRING                78816021
         LA    RW4,DX0                                                  78822021
       SR    RW2,RW2                                                    78828021
         IC    RW2,PRIGHT+NX1       GET CT # BYTES FOLLOW IN RECD       78834021
       AR    RW4,RW2                                                    78840021
         LA    RW4,DX2(RW4)         RW4 PTS TO NEXT BYTE AFTER DICTPT   78846021
         MVC   DX0(LX3,RW4),RGN      ATTACH RGN                         78852021
         LA    RW2,DX3(RW2)                                             78858021
         STC   RW2,PRIGHT+NX1       INCREMENT CT FIELD TO REFLECT RGN   78864021
       LA    RW4,PRIGHT                                                 78870021
       BAL   RCS,STOR45            STORE AGAIN IN STRING                78876021
         CLC   NXTSNT(LX2),N0       IS THERE ANYTHING IN NXTSNT         78882021
       BE   EOPR1                  NO- EXIT                             78888021
       BAL   RCS,GOBACK            GO BACK                              78894021
       DC    XL2'4'                CHANGE GN IN WRITE TO PT TO NXTSN    78900021
       L    RW2,ADNTRY                                                  78906021
         MVC   DX1(LX2,RW2),NXTSNT                                      78912021
         LA    RW2,DX4(RW2)         SEE IF NEXT DOP GNREF TOO           78918021
         CLC   DX0(LX1,RW2),GNREF    IS IT                              78924021
       BNE    EOPR0                NO                                   78930021
         MVC   DX1(LX2,RW2),NXTSNT   YES- REPLACE WITH NXTSNT           78936021
EOPR0    MVC   GNX(LX2),NXTSNT      MOVE NXTSNT ID TO GNX               78942021
EOPR1  L    RCS,EOPSV                                                   78948021
       BCR   UNCOND,RCS            RETURN                               78954021
*                                                                       78960021
*                                                                       78966021
*                                 P U P V N C                           78972021
*                                                                       78978021
*      BAL     RCS,PUPVNC                                               78984021
*      (RETURN)                                                         78990021
*                                                                       78996021
*      INCREMENTS VNCTR IN COMTBL BY 1, STORES UPDATED VN NUMBER AT     79002021
*        HALF-WORD VNNUM                                                79008021
*                                                                       79014021
*                                                                       79020021
PUPVNC EQU     *                                                        79026021
       STM     RW1,RW2,SVPUPV                                           79032021
       L       RW1,COSADR                                               79038021
       LH    RW2,VNCTR                                                  79044021
         LA    RW2,DX1(RW2)                                             79050021
       STH   RW2,VNCTR                                                  79056021
       STH     RW2,VNNUM                                                79062021
       LM      RW1,RW2,SVPUPV                                           79068021
       BCR     UNCOND,RCS          RETURN                               79074021
       SPACE   3                                                        79080021
*                                                                       79086021
*                               N E W N X T                             79092021
*                                                                       79098021
*      BAL     RCS,NEWNXT                                               79104021
*      (RETURN)                                                         79110021
*                                                                       79116021
*      TESTS NXTSNT                                                     79122021
*      IF NON-ZERO EXITS                                                79128021
*      IF ZERO,UPDATES LGN AND STORES ITS DISPLACEMENT IN NXTSNT        79134021
*                                                                       79140021
*** SUBROUTINES CALLED                                                  79146021
*      PUPLGN                                                           79152021
*                                                                       79158021
*                                                                       79164021
*                                                                       79170021
NEWNXT   EQU   *                                                        79176021
         CLC   NXTSNT(LX2),N0      IS NXTSNT 0                          79182021
         BCR   NOTEQ,RCS           NO - ID ALREADY STORED               79188021
         ST    RCS,SVNWNX          YES- NO ID YET                       79194021
         BAL   RCS,PUPLGN           GET NEXT ID FOR LGN                 79200021
         MVC   NXTSNT(LX2),NXTLGN    MOVE TO NXTSNT                     79206021
         L     RCS,SVNWNX                                               79212021
         BCR   UNCOND,RCS          RETURN                               79218021
    EJECT                                                         5961  79224021
*                                                                 5961  79230021
*                                                                 5961  79236021
*       IFSRCH1                                                   5961  79242021
*                                                                 5961  79248021
*                                                                 5961  79254021
*       BAL  RCS,IFSRCH1                                          5961  79260021
*       (RETURN)                                                  5961  79266021
*                                                                 5961  79272021
*                                                                 5961  79278021
*     THIS ROUTINE SAVES ENTRIES (IF ANY) IN PSHTBL               5961  79284021
*     WHEN PROCESSING IF...SEARCH/SEARCH ALL                      5961  79290021
*                                                                 5961  79296021
*                                                                 5961  79302021
IFSRCH1 DS   0H                                                   5961  79308021
       TM    IFSW1,MSWON      ARE WE IN IF                        5961  79314021
       BZ    DX0(RCS)         NO                                  5961  79320021
       L     RW1,APUSH        TIB                                 5961  79326021
       L     RW1,DX0(RW1)     TAMM                                5961  79332021
       LH    RW2,DX4(RW1)     DISPLACEMENT                        5961  79338021
       LTR   RW2,RW2          IS IT ZERO                          5961  79344021
       BZ    DX0(RCS)         YES                                 5961  79350021
       STH   RW2,SAVLNG       SAVE LENGTH                         5961  79356021
       L     RW1,DX0(RW1)     TABLE ADDRESS                       5961  79362021
       EX    RW2,PSHMOVE      SAVE LABELS                         5961  79368021
       BR    RCS              RETURN                              5961  79374021
PSHMOVE MVC  PSHSAVE(LX1),DX0(RW1)   SAVE ENTRIES IN PSHTBL       5961  79380021
*                                                                 5961  79386021
*                                                                 5961  79392021
*      IFSRCH                                                     5961  79398021
*                                                                 5961  79404021
*                                                                 5961  79410021
*       BAL   RCS,IFSRCH                                          5961  79416021
*      (RETURN)                                                   5961  79422021
*                                                                 5961  79428021
*                                                                 5961  79434021
*                                                                 5961  79440021
*     THIS ROUTINE DOES A SPECIAL PROCESS FOR IF...SEARCH         5961  79446021
*     IT CHECKS IF THERE WAS ANY GN SAVED IN PSHSAVE              5961  79452021
*        YES - MOVES SAVED GN BACK TO PSHTBL AND RETURN           5961  79458021
*        NO - RETURN TO CALLER                                    5961  79464021
*                                                                 5961  79470021
*                                                                 5961  79476021
*                                                                 5961  79482021
IFSRCH DS    0H                                                   5961  79488021
       TM    IFSW1,MSWON      IS IF SWITCH ON                     5961  79494021
       BZ    DX0(RCS)         RETURN                              5961  79500021
       NI    IFSW1,MSWOFF     TURN OFF IF SWITCH                  5961  79506021
       LH    RW2,SAVLNG       GET SAVED LENGTH                    5961  79512021
       LTR   RW2,RW2          IS LENGTH ZERO                      5961  79518021
       BZ    DX0(RCS)         RETURN                              5961  79524021
       L     RW1,APUSH        TIB                                 5961  79530021
       L     RW1,DX0(RW1)     TAMM                                5961  79536021
       STH   RW2,DSPUSH       STORE LENGTH TO PSHTBL DISP         5961  79542021
       STH   RW2,DX4(RW1)     STORE LENGTH INTO TAMM              5961  79548021
       L     RW1,DX0(RW1)     TABLE ADDRESS                       5961  79554021
       EX    RW2,MOVGN        EXECUTE MOVE GN                     5961  79560021
       XC    SAVLNG(LX2),SAVLNG    ZERO OUT LENGTH                5961  79566021
       BR    RCS                                                  5961  79572021
MOVGN  MVC   DX0(LX1,RW1),PSHSAVE  MOVE SAVED LABELS BACK         5961  79578021
*                                                                       79584021
         EJECT                                                          79590021
*=1    ERROR   ERROR MESSAGE ROUTINE                                    79596021
*                             E R R O R                                 79602021
*                                                                       79608021
*                                                                       79614021
*      (LA     RA0,PARAM)         IF PARAM LIST CONTAINS DC   AL3'1     79620021
*      .                                                                79626021
*      .                                                                79632021
*      BAL     RCS,ERROR       (OR  BAL RCS,ERONCE  OR  BAL RCS,ERR     79638021
*      LA      RW1,PARAMETER-LIST                                       79644021
*      (RETURN)                                                         79650021
*                                                                       79656021
*                                                                       79662021
*** SUBROUTINES CALLED                                                  79668021
*      COUNT,GENDAT                                                     79674021
*                                                                       79680021
*** NOTES                                                               79686021
*          PARAMETER LIST HAS THE FOLLOWING FORM                        79692021
*      DC      XL3'PZMMSN'                                              79698021
*      DC      AL3(PARAM)                                               79704021
*      .                                                                79710021
*      .                                                                79716021
*      DC      AL3(PARAM)                                               79722021
*        WHERE   MM IS MESSAGE NUMBER                                   79728021
*                 S    SEVERITY CODE                                    79734021
*                 N    NUMBER OF PARAMETERS                             79740021
*                 Z    CONCLUSION NUMBER FOR UNDEFINED                  79746021
*                 P    CONCLUSION PARAMETER POINTER FOR UNDEFINED       79752021
*                                                                       79758021
*        IF THE ADDRESS OF A PARAMETER IS 0, ERROR WILL TAKE IT AS      79764021
*          CURRENT INPUT, I.E., THE ADDRESS CONTAINED IN PNTIN.         79770021
*                                                                       79776021
*       IF THE ADDRESS OF A PARAMETER IS 1, ERROR WILL TAKE ITS REA     79782021
*         ADDRESS TO BE IN RA0.                                         79788021
*                                                                       79794021
*        IF THE ADDRESS OF A PARAMETER IS 2, ERROR WILL INTERPRET I     79800021
*         AS THE VERB FOR THE CURRENT STATEMENT.                        79806021
*                                                                       79812021
*        IF THE ADDRESS OF A PARAMETER IS 3,4, OR 5, ERROR WILL TAK     79818021
*          IT AS THE MODE OF AN OPERAND AND PICK IT UP FROM LOC. MO     79824021
*          MODEL, OR MODER, RESPECTIVELY.                               79830021
*                                                                       79836021
*        SOME MESSAGES HAVE NO PARAMETERS                               79842021
*                                                                       79848021
*                                                                       79854021
*      WHEN ANY OF THE PARAMETERS IS ERROR-SYMBOL (INDICATING AN UN     79860021
*       SOLVABLE OPERAND FOUND IN A PREVIOUS PHASE), PHASE 4 DOES N     79866021
*       WRITE A MESSAGE BUT MERELY APPENDS ONE OF SEVERAL STANDARD      79872021
*       CLUSIONS TO THE PREVIOUS PHASE'S MESSAGE. IF THE CONCLUSION     79878021
*       ITSELF HAS PARAMETERS, P TELLS HOW MANY TO SKIP OVER TO GET     79884021
*       TO THE WANTED ONE. IF THE QTH PARAMETER IS WANTED IN A MESS     79890021
*       HAVING N PARAMETERS, THEN P = N + 1 - Q.                        79896021
*        4 OR ONE OF ITS PREDECESSORS HAD ALREADY WRITTEN A MESSAGE     79902021
*                                                                       79908021
*      ENTRANCE AT ERONCE CAUSES MSGSW TO BE TESTED. IF IT IS ON, N     79914021
*        MESSAGE IS WRITTEN. IF IT IS OFF IT IS TURNED ON AND A MES     79920021
*        IS WRITTEN AS USUAL. THIS ENTRANCE IS USED BY ROUTINES WHI     79926021
*        LOOP LOOKING FOR A SPECIFIC ELEMENT AND DO NOT WISH TO WRI     79932021
*        A MESSAGE MORE THAN ONCE. MSGSW MUST BE TURNED  O F F  BY      79938021
*        EACH ROUTINE WHICH USES ERONCE.                                79944021
*      ENTRANCE AT ERRIF FROM IF ANALYZER.  CERTAIN MESSAGES SHOULD     79950021
*       CASCADE IF THE ASSUMPTIONS OF IFERR ARE ILL-ADVISED. IFERSW     79956021
*       IS TURNED ON AND OFF BY IF ANALYZER.                            79962021
*                                                                       79968021
*                                                                       79974021
*      THE FORM OF A PHASE-4 ERROR MESSAGE IS                           79980021
*                                                                       79986021
*              00 06 00 MMMM CCCC S4                                    79992021
*              00 0N XX XX ...                                          79998021
*              .                                                        80004021
*              .                                                        80010021
*              00 0N YY YY ...                                          80016021
*              0002CC0Z                                                 80022021
*                                                                       80028021
*        WHERE CCCC IS 2-BYTE CARD NUMBER                               80034021
*              MMMM IS 2-BYTE MESSAGE NUMBER                            80040021
*              XXXX AND YYYY ARE PARAMETERS IN INTERNAL TEXT            80046021
*              Z IS CONCLUSION NUMBER                                   80052021
*      CONCLUSIONS ARE - 1  ASSUMED                                     80058021
*                        2  IGNORED                                     80064021
*                        3  DISCARDED                                   80070021
*                        4  TEST DISCARDED                              80076021
*                        5  -- OPTION DISCARDED                         80082021
*                        6  STATEMENT DISCARDED                         80088021
*                        7  DELETING TILL LEGAL ELEMENT                 80094021
*                        8  DELETING TILL ONE OF THESE IS FOUND         80100021
*                        9  SUBSTITUTING --                             80106021
*                        A  SUBSTITUTING FIRST OCCURRENCE OF --         80112021
*                        B  STATEMENT ACCEPTED AS WRITTEN               80118021
*                        C  SYSTEM UNIT ASSUMED                         80124021
*                        D  PERFORMS AND DECLARATIVES MAY GIVE WRON     80130021
*                              CODING                                   80136021
*                        E  CARD DELETED AND FOLLOWING STATEMENTS A     80142021
*                            ACHED TO PRECEDING PACKET                  80148021
*                                                                       80154021
*                                                                       80160021
*                                                                       80166021
*                                                                       80172021
*                                                                       80178021
*                                                                       80184021
*                                                                       80190021
*      RATHER THAN THE NORMAL INTERNAL TEXT ELEMENT, ETEXT HAS          80196021
*                                                                       80202021
*      3407 L I T E R A L         RATHER THAN THE LITERAL ITSELF        80208021
*      3415 A R I T H M E T I C   E X P R E S S I O N   RATHER THAN     80214021
*      FE------      THAT IS, DICTIONARY POINTER,RATHER THAN DATA-N     80220021
*      BF----      THAT IS, SUBSCRIPT NUMBER, RATHER THAN ENTIRE SS     80226021
*                                                                       80232021
*      A SPECIAL ELEMENT HEADER OF 3F INTERNAL TO PHASE 4 ALLOWS        80238021
*        ACTUAL CHARACTER STRINGS TO BE INSERTED INTO ETEXT.            80244021
*        35 SIMPLY PRECEDES THE NORMAL INTERNAL VERSION OF THE          80250021
*        CHARACTER STRING.  THUS TO GET THE WORD 'SIGN' INTO MESSAG     80256021
*        THE PARAMETER-LIST ENTRY MIGHT BE AL3(BCDSGN) AND              80262021
*        BCDSGN DC      XL3'3F3404'                                     80268021
*               DC      CL4'SIGN'                                       80274021
*                                                                       80280021
*                                                                       80286021
*                                                                       80292021
ERRIF  TM      IFERSW,MSWON                                             80298021
         BC    ONES,DX4(RCS)       EXIT                                 80304021
       BC      UNCOND,ERROR        GO TO PROCESS ERROR                  80310021
ERONCE TM      MSGSW,MSWON                                              80316021
         BC    ONES,DX4(RCS)       EXIT                                 80322021
       OI      MSGSW,MSWON                                              80328021
*                                                                       80334021
ERROR  EQU     *                                                        80340021
       STM     RCS,RW6,SVERR                                            80346021
         EX    RA0,DX0(RCS)        GIVE RW1 ADDR. OF PARAMETER LIST     80352021
       LR      RW5,RW1               SAVE RW1 IN RW5                    80358021
       SR      RAS,RAS            SET RAS=0 - ONE-TIME SWITCH           80364021
         IC    RA0,DX2(RW1)        SAVE IN RA0 NUMBER OF PARAMETERS     80370021
       N       RA0,M4BITS                                               80376021
       BC      ZERO,ERR14             IF NONE-SIMPLY GENR HEADER MS     80382021
       LR      RW4,RA0            GIVE RW4 NUMBER OF PARAMS,FOR LOO     80388021
*                                                                       80394021
*      LOOP THRU PARAMETER LIST, FIRST TIME SEEKING ERROR-SYMBOL,SE     80400021
*       TIME-IF NO ERSYMB FOUND- GENRING PARAMETERS                     80406021
*                                                                       80412021
ERR02    LA    RW1,DX3(RW1)        POINT RW1 TO NEXT PARAM.LIST ITEM    80418021
         MVC   ERTEMP+NX1(LX3),DX0(RW1) PUT PARAM AT WORD BOUNDARY      80424021
       L       RW2,ERTEMP                                               80430021
       CH      RW2,N256             IS IT REAL ADDRESS (OVER 100 HE     80436021
       BC      NOTLO,ERR06           YES, USE AS IS                     80442021
         SLA   RW2,DX2                NO, SET RW2 TO ADDR. INDICATED    80448021
       EX    RA0,ERRLA(RW2)           VARIOUS INTERNAL CODES            80454021
         CLC   ERTEMP+NX3(LX1),N3+NX1 IS PARAM 3,4,5                    80460021
       BC      LO,ERR06              NO, DONE                           80466021
       CH    RW2,N14              IS IT REAL MODE                       80472021
         BC    NOTHI,*+NX8              YES                             80478021
         LA    RW2,DX7                  NO, SET TO 7  (I.E.,BLANK)      80484021
         SLA   RW2,DX3                GET IN RW2 BCD EQUIVALENT OF M    80490021
       LA      RW2,BCDMOD(RW2)                                          80496021
ERR06  LTR     RAS,RAS            IS THIS 1ST TIME THRU LOOP            80502021
       BC      NOTZER,ERR07       NO - GENR PARAM                       80508021
         CLC   DX0(LX2,RW2),ERSYMB     YES- IS THIS PARAM ERROR-SYMBO   80514021
       BC      NOTEQ,ERR11        NO - LOOK AT NEXT                     80520021
       BC      EQ,ERR18            YES - GO GENR ENDING TO PH3 MSG      80526021
*                                                                       80532021
*              INSTRUCTIONS EXECUTED UNDER ERR02 TO LOAD ADDR. INTO     80538021
*                                                                       80544021
ERRLA    LA    RW2,DX0(RIN)    PARAM=0 POINT RW2 TO INPUT               80550021
         L     RW2,SVERR+NX8         1              WHAT RA0 POINTS     80556021
       LA      RW2,VERB44           2              VERB                 80562021
         IC    RW2,MODE+NX1          3              MODE                80568021
         IC    RW2,MODEL+NX1         4              MODEL               80574021
         IC    RW2,MODER+NX1         5              MODER               80580021
*                                                                       80586021
*                                                                       80592021
*                                 REDUCE PARAMETER IF NECESSARY         80598021
*                                                                       80604021
ERR07  EQU     *                                                        80610021
         CLI   DX0(RW2),MDN                                             80616021
       BC      EQ,ERDN            IT IS DATA-NAME                       80622021
         CLI   DX0(RW2),MSS                                             80628021
       BC      EQ,ERDN            IT IS SSID, USE DICT POINTER          80634021
         CLI   DX0(RW2),MFILE                                           80640021
       BC      EQ,ERDN            IT IS FILE-NAME, USE DICT. POINTE     80646021
         CLI   DX0(RW2),MINDNM      IT IS INDEX NAME                    80652021
       BC    EQ,ERDN               YES                                  80658021
         CLI   DX0(RW2),MALIT                                           80664021
         BC    EQ,ERALIT          IT IS AN LIT                          80670021
         CLI   DX0(RW2),MFLIT                                           80676021
         BC    EQ,ERFLIT          IT IS FLOATING LIT                    80682021
         CLI   DX0(RW2),XX32         IS IT NUMERIC LITERAL              80688021
       BC    EQ,ERNLIT             YES- GO PROCESS                      80694021
         CLI   DX0(RW2),MOWNLT                                          80700021
       BC      EQ,EROWNL          IT IS PHASE4 SPECIAL LIT              80706021
         CLI   DX0(RW2),MIR                                             80712021
       BC      EQ,ERIR            IT IS AN IR                           80718021
         CLC   DX0(LX1,RW2),ERSYMB                                      80724021
       BC      EQ,EROWNL          IT IS PH1 ILLEGAL WORD                80730021
       B     ERNODO                                    SEE IF PN        80736021
ERIR   LA      RW2,BCDEXP                                               80742021
       BC      UNCOND,ERR09        GO TO GENERATE PARAMETER             80748021
ERDN   BAL     RCS,COUNT          DATA-NAME                             80754021
       AH      RW2,BYTES                                                80760021
       SH      RW2,N3             USE DICT. POINTER FOR PARAM           80766021
         MVC   DICTP+NX1(LX3),DX0(RW2)                                  80772021
       LA      RW2,DICTP                                                80778021
       BC      UNCOND,ERR09        GO TO GENERATE PARAMETER             80784021
ERALIT   LA    RW2,BCDALT                                               80790021
         BC    UNCOND,ERR09        GO TO GENERATE PARAMETER             80796021
ERNLIT   LA    RW2,BCDNLT                                               80802021
         BC    UNCOND,ERR09        GO TO GENERATE PARAMETER             80808021
ERFLIT   LA    RW2,BCDFLT                                               80814021
       BC      UNCOND,ERR09        GO TO GENERATE PARAMETER             80820021
EROWNL   LA    RW2,DX1(RW2)        SPECIAL PHASE4 CHARACTER STRING      80826021
       BC      UNCOND,ERR09        GO TO GENERATE PARAMETER             80832021
ERNODO   CLI   DX0(RW2),MPND                                            80838021
       BC      EQ,ERRLHN           GET PN DEF                           80844021
         CLI   DX0(RW2),MPNU                                            80850021
       BC      NOTEQ,ERR09         GO TO GENERATE PARAMETER             80856021
         LA    RW2,BCDPNU+NX1      PNREF                                80862021
       BC      UNCOND,ERR09        GO TO GENERATE PARAMETER             80868021
ERRLHN   LA    RW2,BCDPN+NX1       PNDEF                                80874021
*                                                                       80880021
*                    GENERATE PARAMETER                                 80886021
*                                                                       80892021
ERR09  EQU     *                                                        80898021
         CLI   DX0(RW2),MCNDRL     IS PARAM '5106' FROM CONDITION-NA    80904021
         BC    NOTEQ,*+NX8          NO                                  80910021
         LA    RW2,BCDCND+NX1      YES - SUBSTITUTE WORD 'CONDITION'    80916021
       BAL     RCS,COUNT           GET BYTE COUNT                       80922021
         MVC   ERPARM+NX1(LX1),BYTES+NX1                                80928021
       LH      RW3,BYTES                                                80934021
       EX      RW3,ERRMOV         MOVE PARAM ITSELF TO PARAM-AREA       80940021
       BAL     RCS,GENDAT          WRITE ERROR PARAMETER                80946021
       LA      RW2,ERPARM                                               80952021
ERR11  BCT     RW4,ERR02          RETURN FOR NEXT PARAMETER             80958021
*                                                                       80964021
*              LOOP THRU PARAMETER LIST COMPLETED                       80970021
*                                                                       80976021
       LTR     RAS,RAS            IS IT 1ST TIME THRU                   80982021
       BC      ZERO,ERR14           YES - GO GENR HEADER MSG,AND RE     80988021
ERR12  LM      RCS,RW6,SVERR     NO, ALL DONE, EXIT                     80994021
         BC    UNCOND,DX4(RCS)     EXIT                                 81000021
*                                                                       81006021
ERRMOV   MVC   ERPARM+NX2(LX1),DX0(RW2)                                 81012021
*                                                                       81018021
*      NO ERSYMB FOUND - GENERATE THE MESSAGE                           81024021
*                                                                       81030021
ERR14  LR      RW1,RW5            RESTORE RW1 TO START OF LIST          81036021
         MVC   MSGNUM+NX1(LX1),DX1(RW1) MOVE IN MESSAGE NUMBER          81042021
         MVZ   CARDNO+NX2(LX1),DX2(RW1)            SEVERITY CODE        81048021
ERR16  BAL     RCS,GENDAT          GENR ERROR MSG DEFINING STRING       81054021
       LA      RW2,PMSG                                                 81060021
       LTR     RW4,RA0            RESTORE RW4 TO PARAMETER COUNT        81066021
       BC      ZERO,ERR12           IF NO PARAMS,EXIT                   81072021
       BCT     RAS,ERR02          SET 1-TIME SWITCH NON-ZERO            81078021
*                                                                       81084021
*                           ERROR SYMBOL FOUND AMONG PARAMETERS         81090021
*                                                                       81096021
ERR18  SR      RA0,RA0                                                  81102021
         IC    RA0,DX0(RW5)        RW4 GETS CONCLUSION NUMBER,IF ANY    81108021
       LTR     RA0,RA0                                                  81114021
       BC      ZERO,ERR12             NONE - EXIT                       81120021
         MVN   MSG3ND+NX3(LX1),DX0(RW5) GENR CONCLUSION NUMBER FOR PH6  81126021
       BAL     RCS,GENDAT          GENR MSG CONCLUSION FOR UNDEF.       81132021
       LA      RW2,MSG3ND                                               81138021
         SRA   RA0,DX4             ARE ANY PARAMETERS NEEDED IN CONC    81144021
       BC      ZERO,ERR12           NO - EXIT                           81150021
       SH      RW1,N3             POINT RW1 BACK 1 PARAM (ERR02...L     81156021
ERR20  CR      RA0,RW4                                                  81162021
       BC      EQ,ERR22            OMIT SOME PARAMETERS                 81168021
         LA    RW1,DX3(RW1)        SKIP OVER PARAMS TILL RW1 POINTS     81174021
       BCT     RW4,ERR20           WANTED ONE AND RW4 = WANTED COUN     81180021
ERR22  BCT     RAS,ERR02           LOOP THRU PARAMS                     81186021
*                                                                       81192021
*      SPECIAL CASE OF MULTIPLY-DEFINED LHN, NEEDING UNIQUE ENDING      81198021
*        PH3 MESSAGE.                                                   81204021
*                                                                       81210021
*              'EVEN IF NOT REFERENCED MAY CAUSE WRONG CODING TO BE     81216021
*               PRODUCED FOR DECLARATIVES OR PERFORMED PROCEDURES       81222021
*                ON EITHER SIDE OF IT.'                                 81228021
*                                                                       81234021
PH3ERP EQU     *                                                        81240021
       ST      RCS,SVERR                                                81246021
         MVI   MSG3ND+NX3,XX0D       ACTION ENDING B                    81252021
       BAL     RCS,GENDAT          GENERATE MESSAGE                     81258021
       LA      RW2,MSG3ND                                               81264021
       L       RCS,SVERR                                                81270021
       BCR     UNCOND,RCS          RETURN TO CALLER                     81276021
       EJECT                                                            81282021
*                                                                       81288021
*                                                                       81294021
*                                O P E R R                              81300021
*                                                                       81306021
*      BAL     RCS,OPERR                                                81312021
*      (RETURN IF OPERAND-2 IS ERROR SYMBOL OR NON-DATA-OPERAND)        81318021
*              IN ALL OTHER CASES EXIT DIRECTLY TO IDENT                81324021
*                                                                       81330021
*      CALLED BY MOVE AND BY ADD-, SUBTRACT-CORRESPONDING DURING        81336021
*        'DRY RUN' WHEN ILLEGAL OPERAND IS FOUND                        81342021
*                                                                       81348021
*      DISCARDS PHASE-3 EXPANSIONS OF CORRESPONDING                     81354021
*                                                                       81360021
*** SUBROUTINES CALLED                                                  81366021
*      GETNXT,SAVNXT,SAVCUR,THROWE,ERROR                                81372021
*                                                                       81378021
*                                                                       81384021
OPERR  EQU     *                                                        81390021
       ST      RCS,SVOPER                                               81396021
       TM      CORRSW,MSWON       ARE WE IN CORRESPONDING-EXPANSION     81402021
       BC      ONES,OPER2          YES                                  81408021
       TM      DRYRUN,MSWON       ARE WE IN DRY-RUN BEFORE EXPANSIO     81414021
       BC      ONES,OPER6          YES                                  81420021
*                                                                       81426021
*              ORDINARY VERB, NOT CORRESPONDING                         81432021
*                                                                       81438021
       LA      RCS,OPRND1         WHICH OPERAND IS IN ERROR             81444021
       C       RCS,THISOP                                               81450021
       BC      EQ,OPER0            OP1 IS IN ERROR                      81456021
       BAL     RCS,ISEND           OP2 - IS IT END                      81462021
         BC    UNCOND,*+NX8        NO                                   81468021
       BC      UNCOND,IDENT        YES - GIVE UP                        81474021
       TM    SEARCHSW,MSWON                                             81480021
       BO    OPER0A                SEARCH SWITCH IS ON                  81486021
       L       RCS,SVOPER          NO - RETURN TO ANALYZER              81492021
       BCR     UNCOND,RCS          EXIT                                 81498021
OPER0  BAL     RCS,ERROR           WRITE ERROR MESSAGE                  81504021
       LA      RW1,ELST04                                               81510021
       BC      UNCOND,IDERR        EXIT TO IDERR                        81516021
OPER0A L     RVRB,ASRCH                                                 81522021
       USING SEARCH,RVRB                                                81528021
       BC    UNCOND,SRCH11         GO TO SEARCH                         81534021
       DROP  RVRB                                                       81540021
*                                                                       81546021
*                      CORRESPONDING-EXPANSION.ERROR IS 'ERSYMB' AN     81552021
*                        PHASE 3 WROTE THE MESSAGE                      81558021
*                                                                       81564021
OPER2    CLC   GOTTEN(LX2),CBCORR                                       81570021
       BC      EQ,OPER4            'CORRESPONDING' FOUND                81576021
       BAL     RCS,GETNXT        DISCARD TILL 'CORRESPONDING', WHIC     81582021
       BC      UNCOND,OPER2        INDICATES END OF ONE EXPANSION       81588021
OPER4  BAL     RCS,GETNXT          GET NEXT ELEMENT                     81594021
       NI      CORRSW,MSWOFF                                            81600021
       BC      UNCOND,IDERR        EXIT TO IDERR                        81606021
*                                                                       81612021
*              ERROR IS IN DRY-RUN OF SOURCE-PROGRAM STATEMENT          81618021
*                                                                       81624021
OPER6  NI      DRYRUN,MSWOFF                                            81630021
       BAL     RCS,ERROR           WRITE ERROR MESSAGE                  81636021
       LA      RW1,ELST04                                               81642021
OPER8  BAL     RCS,THROWE         DISCARD TILL VERB GIVEN BY PHASE-     81648021
OPER10   CLC   GOTTEN(LX2),CBCORR                                       81654021
       BC      EQ,OPER12           'CORRESPONDING' FOUND                81660021
         CLC   GOTTEN(LX2),CBEOS   END OF SENTENCE                18067 81666021
         BE    ID3                                                18067 81672021
       BAL     RCS,GETNXT         DISCARD TILL 'CORRESPONDING',INDI     81678021
       BC      UNCOND,OPER10       ING END OF ONE EXPANSION             81684021
OPER12 BAL     RCS,GETNXT          GET NEXT INPUT                       81690021
       LA      RCS,OPRND1        WHICH OPERNAD IS IN ERROR              81696021
       C       RCS,THISOP                                               81702021
       BC      NOTEQ,IDERR         OP2-THERE MAY BE OTHER EXPANSION     81708021
         CLC   GOTTEN(LX2),CBMOVE   OP1-HOPELESS FOR ALL EXPANSIONS     81714021
       BC      NOTEQ,IDERR          NEXT IS NOT 'MOVE', ALL DONE        81720021
       BAL     RCS,GETNXT          GET NEXT INPUT                       81726021
         CLC   GOTTEN(LX2),CBSAME    IS NEXT 'SAME'                     81732021
       BC      EQ,OPER8           YES. DISCARD ANOTHER SERIES           81738021
       OI      NEXTIN,MSWON        NO,ALL DONE. SAVE IT TO GET AGAI     81744021
       LA      RIN,CBMOVE         RESTORE AS INPUT THE 'MOVE'           81750021
       BC      UNCOND,IDERR        EXIT TO IDERR                        81756021
TEMPSAVE DS    6F                                                 P0205 81762021
         EJECT                                                          81768021
IKF404 CSECT                                                            81774021
COMON4 EQU     *                                                        81780021
*=1    CONSTANT AREA                                                    81786021
*                                                                       81792021
*                                                                       81798021
*                                 C O N S T A N T S                     81804021
*                                                                       81810021
*                                                                       81816021
         DS    0F                                                       81822021
*                                                                       81828021
*                                                                       81834021
*                        ERROR-PARAMETER LISTS                          81840021
*                                                                       81846021
*                                                                       81852021
       SPACE   3                                                        81858021
*                                                                       81864021
*=E    0001    OUTCOME OF A PRECEDING CONDITION LEADS TO NON-EXISTE     81870021
*=               'NEXT SENTENCE'.  'STOP RUN' INSERTED.                 81876021
*                                                                       81882021
ELST01 DC      XL3'000110'                                              81888021
*                                                                       81894021
*=E    0002    -- STATEMENT INCOMPLETE. STATEMENT DELETED.              81900021
*                                                                       81906021
ELST02 DC      XL3'000221'        -- STATEMENT INCOMPLETE               81912021
       DC      AL3(2)                                                   81918021
*                                                                       81924021
*=E    0003    EXPECTING END OF STATEMENT. FOUND --. DELETING TILL      81930021
*=               NEXT VERB OR PROCEDURE-NAME.                           81936021
*                                                                       81942021
ELST03 DC      XL3'070321'                                              81948021
       DC      AL3(0)                                                   81954021
*                                                                       81960021
*=E    0004    -- -- IS ILLEGALLY USED IN -- STATEMENT. DELETED.        81966021
*                                                                       81972021
ELST04 DC      XL3'030423'                                              81978021
       DC      AL3(0)                                                   81984021
       DC      AL3(3)                                                   81990021
       DC      AL3(2)                                                   81996021
*                                                                       82002021
*=E    0005    -- AND -- VIOLATE RULE ABOUT LENGTH OF TRANSFORM         82008021
*=              OPERANDS. STATEMENT DELETED.                            82014021
*                                                                       82020021
ELST05 DC      XL3'060522'                                              82026021
       DC      AL3(PLEFT)                                               82032021
       DC      AL3(0)                                                   82038021
*                                                                       82044021
*=E    0006    -- STATEMENT CONTAINS UNPAIRED LEFT PARENTHESES. OUT     82050021
*=              MOST IGNORED.                                           82056021
ELST06 DC      XL3'000611'                                              82062021
       DC      AL3(2)                                                   82068021
*                                                                       82074021
*=E    0007    -- MISSING OR MISPLACED IN -- STATEMENT. ASSUMED IN      82080021
*=              REQUIRED POSITION.                                      82086021
*                                                                       82092021
ELST07 DC      XL3'000712'                                              82098021
       DC      AL3(1)                                                   82104021
       DC      AL3(2)                                                   82110021
*                                                                       82116021
*                                                                       82122021
*=E    0008    SUPERFLUOUS -- FOUND IN -- STATEMENT.IGNORED             82128021
*                                                                       82134021
ELST08 EQU     *                                                        82140021
       DC      XL3'000802'                                              82146021
       DC      AL3(1)                                                   82152021
       DC      AL3(2)                                                   82158021
*                                                                       82164021
*=E    0009    EXAMINE STATEMENT REQUIRES FIGURATIVE CONSTANT OR SI     82170021
*              ALPHANUMERIC CHARACTER OR 1-DIGIT UNSIGNED NUMERIC       82176021
*              INTEGRAL LITERAL. FOUND __. STATEMENT DELETED.           82182021
*                                                                       82188021
ELST09 DC      XL3'060921'                                              82194021
       DC      AL3(0)                                                   82200021
*                                                                       82206021
*=E    000A    -- STATEMENT CONTAINS UNPAIRED RIGHT PARENTHESES. OU     82212021
*=              MOST IGNORED.                                           82218021
*                                                                       82224021
ELST0A DC      XL3'000A11'                                              82230021
       DC      AL3(2)                                                   82236021
*                                                                       82242021
*=E    000B    -- IS NOT AN ALLOWABLE CHARACTER FOR --. STATEMENT D     82248021
*=              LETED                                                   82254021
*                                                                       82260021
ELST0B DC      XL3'060B22'                                              82266021
       DC      AL3(0)                                                   82272021
       DC      AL3(PLEFT)                                               82278021
*                                                                       82284021
*=E    000C    COMPARISON BETWEEN TWO LITERALS IS ILLEGAL.              82290021
*=              TEST IS DELETED.                                        82296021
*                                                                       82302021
ELST0C DC      XL3'000C20'                                              82308021
*                                                                       82314021
*=E    000D    RELATIONAL MISSING IN IF STATEMENT. '=' ASSUMED.         82320021
*                                                                       82326021
ELST0D DC      XL3'000D10'                                              82332021
*                                                                       82338021
*=E    000E    EXAMINE STATEMENT REQUIRES DATA-NAME WHOSE USAGE IS      82344021
*=              PLAY. FOUND -- --. STATEMENT DELETED.                   82350021
*                                                                       82356021
ELST0E DC      XL3'060E22'                                              82362021
       DC      AL3(0)                                                   82368021
       DC      AL3(3)                                                   82374021
*                                                                       82380021
*=E    000F    'GO TO .' IS ILLEGAL UNLESS IT IS ALTERED.               82386021
*=              STATEMENT DELETED.                                      82392021
*                                                                       82398021
ELST0F DC      XL3'000F20'                                              82404021
*                                                                       82410021
*=E    0010    OPERAND OF -- APPEARS IN WRONG SEGMENT OF PROGRAM, B     82416021
*=               STATEMENT ACCEPTED.                                    82422021
*                                                                       82428021
ELST10 DC      XL3'001011'                                              82434021
       DC      AL3(2)                                                   82440021
*                                                                       82446021
*=E    0011    'ELSE' UNMATCHED BY CONDITION IS IGNORED.                82452021
*                                                                       82458021
ELST11 DC      XL3'001120'                                              82464021
*                                                                       82470021
*=E    0012     SET STATEMENT HAS AN ILLEGAL OPERAND BEFORE 'TO'        82476021
*              OR INCOMPATIBLE OPERANDS. OPERAND BEFORE TO DISCARDE     82482021
*                                                                       82488021
ELST12 DC       XL3'001220'                                             82494021
*                                                                       82500021
*=E    0013    -- -- MAY NOT BE USED AS ARITHMETIC OPERAND IN -- ST     82506021
*=              MENT. ARBITRARILY SUBSTITUTING TALLY.                   82512021
*                                                                       82518021
ELST13 DC      XL3'191324'                                              82524021
       DC      AL3(0)                                                   82530021
       DC      AL3(3)                                                   82536021
       DC      AL3(2)                                                   82542021
       DC      AL3(CBTALY)                                              82548021
*                                                                       82554021
*=E    0014    SIGN BEFORE -- IS IGNORED.                               82560021
*                                                                       82566021
ELST14 EQU     *                                                        82572021
       DC      XL3'001411'                                              82578021
       DC      AL3(0)                                                   82584021
*                                                                       82590021
*=E    0015    MINUS SIGN FOLLOWED BY SPACE ACCEPTED AS REVERSING       82596021
*=              SIGN OF FOLLOWING LITERAL.                              82602021
*                                                                       82608021
ELST15 EQU     *                                                        82614021
       DC      XL3'001500'                                              82620021
*                                                                       82626021
*                                                                       82632021
*=E    0016    EXIT MUST BE A SINGLE-WORD PARAGRAPH PRECEDED BY A       82638021
*=              PROCEDURE NAME. STATEMENT DISCARDED.                    82644021
*                                                                       82650021
ELST16 DC    XL3'001610'                                                82656021
*                                                                       82662021
*=E    0017    SYNTAX REQUIRES STORE-FIELD TO BE NUMERIC DATA-NAME      82668021
*=              REPORT ITEM. FOUND -- --. STATEMENT DELETED.            82674021
*                                                                       82680021
ELST17 DC      XL3'061722'                                              82686021
       DC      AL3(1)                                                   82692021
       DC      AL3(3)                                                   82698021
*                                                                       82704021
*=E    0018    TWO OPERANDS ARE REQUIRED BEFORE 'GIVING'. STATEMENT     82710021
*=              DELETED.                                                82716021
*                                                                       82722021
ELST18 DC      XL3'001820'                                              82728021
*                                                                       82734021
*=E    0019    HOLD ALL ILLEGAL WHEN NO RANDOM-PROCESSING DECLARATI     82740021
*=               EXIST. STATEMENT DELETED.                              82746021
*                                                                       82752021
ELST19 DC      XL3'001920'                                              82758021
*                                                                       82764021
*                                                                       82770021
*=E    001A    -- -- IS ILLEGALLY USED IN -- TEST. TEST DELETED.        82776021
*                                                                       82782021
ELST1A DC      XL3'001A23'                                              82788021
       DC      AL3(PLEFT)                                               82794021
       DC      AL3(4)                                                   82800021
       DC      AL3(1)                                                   82806021
*                                                                       82812021
*=E    001B    RIGHT TERM OF A CONDITION MAY NOT BE NEGATED.            82818021
*=              NEGATION IS APPLIED TO THE RELATIONAL.                  82824021
*                                                                       82830021
ELST1B DC      XL3'001B10'                                              82836021
*                                                                       82842021
*=E    001C    TWO 'NOT'S FOUND IN SUCCESSION. ACCEPTED AS CANCELLI     82848021
*=              EACH OTHER.                                             82854021
*                                                                       82860021
ELST1C DC      XL3'001C10'                                              82866021
*                                                                       82872021
*=E    001D    -- -- MAY NOT BE COMPARED WITH -- --.                    82878021
*=              TEST IS DELETED.                                        82884021
*                                                                       82890021
ELST1D DC      XL3'001D24'                                              82896021
       DC      AL3(PLEFT)                                               82902021
       DC      AL3(4)                                                   82908021
       DC      AL3(PRIGHT)                                              82914021
       DC      AL3(5)                                                   82920021
*                                                                       82926021
*=E    001E    SYNTAX REQUIRES 'OR','AND', OR VERB AFTER CONDITION.     82932021
*=              FOUND --. DELETING TILL ONE OF THESE IS FOUND.          82938021
*                                                                       82944021
ELST1E   DC    XL3'071E22'         MSG 30 - SEV 2                 99998 82950021
       DC      AL3(0)                                                   82956021
         DC    AL3(1)              PARM ADDR IN RA0               99998 82962021
*                                                                       82968021
*=E    001F    PN NOT THAT OF A SINGLE GO PARAGRAPH                     82974021
*=              MAY NOT BE ALTERED. STATEMENT DELETED.                  82980021
*                                                                       82986021
ELST1F DC      XL3'001F20'                                              82992021
*                                                                       82998021
*=E    0020    NO ACTION INDICATED IF PRECEDING CONDITION IS TRUE.      83004021
*=              STATEMENT ACCEPTED WITH TRUE AND FALSE OUTCOMES IDE     83010021
*=              CAL.                                                    83016021
*                                                                       83022021
ELST20 DC      XL3'002010'                                              83028021
*                                                                       83034021
*=E    0021    PROCEDURE NAME WHICH IS THE END-OF-RANGE OF A PERFOR     83040021
*=              MAY NOT BE ALTERED. STATEMENT DELETED                   83046021
*                                                                       83052021
ELST21 DC      XL3'002120'                                              83058021
*                                                                       83064021
*=E    0022    GO DEPENDING ON MUST BE FOLLOWED BY NUMERIC INTEGRAL     83070021
*=              4 DIGITS OR LESS IN LENGTH. FOUND --. STATEMENT DEL     83076021
*                                                                       83082021
ELST22 DC      XL3'062211'                                              83088021
       DC      AL3(0)                                                   83094021
*                                                                       83100021
*=     0023    COBOL LANGUAGE FORBIDS VARYING MORE THAN 3 DATA-NAME     83106021
*               BUT STATEMENT IS ACCEPTED AS WRITTEN.                   83112021
*                                                                       83118021
ELST23 DC      XL3'002300'                                              83124021
*                                                                       83130021
*=E    0024    PERFORM RANGE IS FROM -- TO --, WHICH PRECEDES IT.       83136021
*=              STATEMENT ACCEPTED AS WRITTEN.                          83142021
*                                                                       83148021
ELST24 DC      XL3'002402'                                              83154021
       DC      AL3(THRUPN)                                              83160021
       DC      AL3(0)                                                   83166021
*                                                                       83172021
*=E    0025    SYNTAX REQUIRES PROCEDURE-NAME TO FOLLOW 'THRU'. FOU     83178021
*=              'THRU' OPTION DISCARDED.                                83184021
*                                                                       83190021
ELST25 DC      XL3'152522'                                              83196021
       DC      AL3(0)                                                   83202021
       DC      AL3(CBTHRU)                                              83208021
*                                                                       83214021
*=E    0026    VARYING OPTION REQUIRES NUMERIC DATA-NAME.FOUND LITE     83220021
*=              ARBITRARILY SUBSTITUTING TALLY.                         83226021
*                                                                       83232021
ELST26 DC      XL3'002621'                                              83238021
       DC      AL3(CBTALY)                                              83244021
*                                                                       83250021
*=E    0027    -- -- IN VARYING OPTION IS NOT NUMERIC. ARBITRARILY      83256021
*=              SUBSTITUTING TALLY.                                     83262021
*                                                                       83268021
ELST27 DC      XL3'192723'                                              83274021
       DC      AL3(0)                                                   83280021
       DC      AL3(3)                                                   83286021
       DC      AL3(CBTALY)                                              83292021
*                                                                       83298021
*=E    0028    -- FILE MAY NOT BE OPENED -- AND IS SKIPPED.             83304021
*                                                                       83310021
ELST28 DC      XL3'002823'                                              83316021
       DC      AL3(0)                                                   83322021
       DC      AL3(CURENT)                                              83328021
       DC      AL3(1)                                                   83334021
*                                                                       83340021
*=E    0029    SYNTAX REQUIRES 'INPUT','OUTPUT',OR 'I-O' AFTER OPEN     83346021
*=              VERB. FOUND --. DELETING TILL ONE OF THESE IS FOUND     83352021
*                                                                       83358021
ELST29 DC      XL3'072921'                                              83364021
       DC      AL3(0)                                                   83370021
*                                                                       83376021
*=E    002A    SYNTAX REQUIRES FILE-NAME IN -- STATEMENT. FOUND --.     83382021
*=              DELETING TILL LEGAL ELEMENT FOUND.                      83388021
*                                                                       83394021
ELST2A DC      XL3'072A22'                                              83400021
       DC      AL3(2)                                                   83406021
       DC      AL3(0)                                                   83412021
*                                                                       83418021
*                                                                       83424021
*=E    002B    DIRECT BDAM-D FILE SHOULD NOT BE USED IN REWRITE         83430021
*              STATEMENT. STATEMENT ACCEPTED AS WRITTEN.                83436021
*                                                                       83442021
ELST2B DC    XL3'002B00'                                                83448021
*                                                                       83454021
*                                                                       83460021
*                                                                       83466021
*                                                                       83472021
*=E    002C      --,-- MAY NOT BE MOVED TO NUMERIC                      83478021
*                FIELD.  SUBSTITUTING ZERO.                             83484021
*                                                                       83490021
ELST2C DC    XL3'192C13'                                                83496021
       DC    AL3(PLEFT)                                                 83502021
       DC    AL3(4)                                                     83508021
       DC   AL3(CBZERO)                                                 83514021
*                                                                       83520021
*=E    002D    'ADVANCING' OPTION MUST BE FOLLOWED BY MNEMONIC NAME     83526021
*              NUMERIC INTEGRAL DATA-NAME OR INTEGER LESS THAN 100.     83532021
*              FOUND__.SUBSTITUTING 1.                                  83538021
*                                                                       83544021
ELST2D DC      XL3'192D12'                                              83550021
       DC      AL3(0)                                                   83556021
       DC      AL3(BCD1)                                                83562021
*                                                                       83568021
*=E    002E    ILLEGAL TO -- -- FILE --. STATEMENT DELETED              83574021
*                                                                       83580021
ELST2E DC    XL3'002E23'                                                83586021
       DC    AL3(2)                                                     83592021
       DC    AL3(1)                                                     83598021
       DC      AL3(PSTFLD)                                              83604021
*                                                                       83610021
*=E    0030    USE VERB MAY NOT APPEAR EXCEPT IN DECLARATIVES SECTI     83616021
*=              STATEMENT DELETED.                                      83622021
*                                                                       83628021
*=E    002F    READ OR WRITE VERB ILLEGAL FOR LABEL RECORDS.            83634021
*=             STATEMENT DELETED.                                       83640021
*                                                                       83646021
ELST2F DC    XL3'002F20'                                                83652021
*                                                                       83658021
ELST30 DC      XL3'003020'                                              83664021
*                                                                       83670021
*=E    0031    INAPPROPRIATE OPTIONAL WORDS PRECEDING--IGNORED.         83676021
*                                                                       83682021
ELST31 DC      XL3'003101'                                              83688021
       DC      AL3(0)                                                   83694021
*                                                                       83700021
*=E    0032    SYNTAX REQUIRES --. FOUND --. STATEMENT DELETED.         83706021
*                                                                       83712021
ELST32 DC      XL3'063222'                                              83718021
       DC      AL3(1)                                                   83724021
       DC      AL3(0)                                                   83730021
*                                                                       83736021
*=E    0033    'AFTER POSITIONING' REQUIRES 1-CHARACTER ALPHANUMERI     83742021
*      DATA NAME OR INTEGER LESS THAN 4. FOUND __.                      83748021
*              SUBSTITUTING --.                                         83754021
*                                                                       83760021
ELST33 DC    XL3'193322'                                                83766021
       DC    AL3(0)                                                     83772021
       DC    AL3(BCD1)                                                  83778021
*                                                                       83784021
*=E    0034    -- -- MAY NOT BE TARGET FIELD FOR -- -- IN -- STATEM     83790021
*=              AND IS SKIPPED.                                         83796021
*                                                                       83802021
ELST34 DC      XL3'033425'                                              83808021
       DC      AL3(PRIGHT)                                              83814021
       DC      AL3(5)                                                   83820021
       DC      AL3(PLEFT)                                               83826021
       DC      AL3(4)                                                   83832021
       DC      AL3(2)                                                   83838021
*                                                                       83844021
*=E    0035       POSITIONING VALID FOR CLOSE REEL WHILE DISP           83850021
*               VALID FOR CLOSE.___FILE SKIPPED.                        83856021
*                                                                       83862021
ELST35 DC    XL3'003521'                                                83868021
       DC    AL3(CURENT)                                                83874021
*                                                                       83880021
*=E    0036    SYNTAX REQUIRES SORT-FILE NAME. FOUND --. STATEMENT      83886021
*=             DELETED.                                                 83892021
*                                                                       83898021
ELST36 DC      XL3'063621'                                              83904021
       DC      AL3(0)                                                   83910021
*                                                                       83916021
*=E    0037    SORT SEQUENCE NOT SPECIFIED. ASCENDING ASSUMED.          83922021
*                                                                       83928021
ELST37 DC      XL3'003710'                                              83934021
*                                                                       83940021
*=E    0038    SYNTAX REQUIRES --. FOUND --. DISCARDED.                 83946021
*                                                                       83952021
ELST38 DC      XL3'033822'                                              83958021
       DC      AL3(1)                                                   83964021
       DC      AL3(0)                                                   83970021
*                                                                       83976021
*=E    0039    SORT KEYS LIMITED TO 12 OR TO 256 BYTES. -- DISCARDE     83982021
*                                                                       83988021
ELST39 DC      XL3'003921'                                              83994021
       DC      AL3(0)                                                   84000021
*                                                                       84006021
*=E    003A   SYNTAX REQUIRES USING ( GIVING) TO BE FOLLOWED BY         84012021
*              STANDARD SEQUENTIAL FILENAME DEFINED UNDER AN FD.        84018021
*              FOUND ___. SATEMENT DELELTED.                            84024021
*                                                                       84030021
ELST3A DC      XL3'063A21'                                              84036021
       DC      AL3(0)                                                   84042021
*                                                                       84048021
*=E      003B  SORT-KEY MUST BE NON-SUBSCRIPTED FIXED-LENGTH DATA-N     84054021
*=              DEFINED UNDER AN SD. FOUND --. DISCARDED.               84060021
*                                                                       84066021
ELST3B DC      XL3'033B21'                                              84072021
       DC      AL3(0)                                                   84078021
*                                                                       84084021
*=E    003C    -- IS NOT A POSITIVE NUMERIC LITERAL OF LESS THAN 10     84090021
*=              DIGITS. 'UNTIL' OPTION DELETED.                         84096021
*                                                                       84102021
ELST3C DC      XL3'153C12'                                              84108021
       DC      AL3(1)                                                   84114021
       DC      AL3(CBUNTL)                                              84120021
*                                                                       84126021
*=E    003D    NEITHER NAMED NOR CHANGED SPECIFIED. STATEMENT ACCEP     84132021
*=              WILL BE TREATED AS FORMATTED DISPLAY.                   84138021
*                                                                       84144021
ELST3D DC      XL3'003D00'                                              84150021
*                                                                       84156021
*=E    003E    'NAMED CHANGED' ACCEPTED AS 'CHANGED NAMED'.             84162021
*                                                                       84168021
ELST3E DC      XL3'003E00'                                              84174021
*                                                                       84180021
*=E    003F    PREVIOUS DEBUG PACKET REFERS TO SAME PN. CARD DELETE     84186021
*=              AND FOLLOWING STATEMENTS ATTACHED TO IMMEDIATELY PR     84192021
*=              CEDING PACKET.                                          84198021
*                                                                       84204021
ELST3F DC      XL3'003F00'                                              84210021
*                                                                       84216021
*=E    0040    -- IS NOT A POSITIVE NUMERIC LITERAL OF REQUIRED LEN     84222021
*=              SUBSTITUTING 1.                                         84228021
*                                                                       84234021
ELST40 DC      XL3'194022'                                              84240021
       DC      AL3(1)                                                   84246021
       DC      AL3(BCD1)                                                84252021
*                                                                       84258021
*=E    0041    NUMERIC LITERAL IN EXAMINE STATEMENT SHOULD BE           84264021
*              UNSIGNED. SIGN IGNORED.                                  84270021
*                                                                       84276021
ELST41 DC      XL3'004100'                                              84282021
*                                                                       84288021
*=E    0042    SYNTAX REQUIRES 01 LEVEL SD DATA-NAME IN RELEASE STA     84294021
*=              MENT. FOUND --. STATEMENT DELETED.                      84300021
*                                                                       84306021
ELST42 DC      XL3'064221'                                              84312021
       DC      AL3(0)                                                   84318021
*                                                                       84324021
*=E    0043    ALL 'CHARACTER' SHOULD NOT BE USED AS LITERAL IN         84330021
*              EXAMINE STATEMENT. STATEMENT ACCEPTED AS WRITTEN.        84336021
*                                                                       84342021
ELST43 DC      XL3'004300'                                              84348021
*                                                                       84354021
*=E    0044    COMPILER ERROR. PHASE 4 TRYING TO GET DATA ATTRIBUTE     84360021
*=              FOR --.                                                 84366021
*                                                                       84372021
ELST44 EQU     *                                                        84378021
       DC      XL3'004481'                                              84384021
       DC      AL3(1)                                                   84390021
*                                                                       84396021
*=E    0045    SYNTAX REQUIRES DEVICE-NAME. FOUND -- IN -- STATEMEN     84402021
*=              SYSTEM UNIT ASSUMED.                                    84408021
*                                                                       84414021
ELST45 DC      XL3'0C4512'                                              84420021
       DC      AL3(0)                                                   84426021
       DC      AL3(2)                                                   84432021
*                                                                       84438021
*=E      0046  'AT END' CLAUSE MISSING. 'AT END NEXT VERB' ASSUMED.     84444021
*                                                                       84450021
ELST46 DC      XL3'004610'                                              84456021
*                                                                       84462021
*=E    0047    -- EXCEEDS LEGAL LENGTH. STATEMENT DELETED.              84468021
*                                                                       84474021
ELST47 DC      XL3'004721'                                              84480021
       DC      AL3(0)                                                   84486021
*                                                                       84492021
*=E    0048    EXIT FROM -- PROCEDURE ASSUMED BEFORE --.                84498021
*                                                                       84504021
ELST48 DC      XL3'004802'                                              84510021
       DC      AL3(1)                                                   84516021
       DC      AL3(0)                                                   84522021
*                                                                       84528021
*=E    0049    --SHOULD NOT APPEAR IN DECLARATIVES SECTION,BUT STAT     84534021
*=              MENT IS ACCEPTED AS WRITTEN.                            84540021
*                                                                       84546021
ELST49 DC      XL3'004901'                                              84552021
       DC      AL3(2)                                                   84558021
*                                                                       84564021
*=E     004A   --STATEMENT CONTAINS FLOATING POINT DATA ITEM.           84570021
*              REMAINDER IGNORED.                                       84576021
*                                                                       84582021
ELST4A  DC     XL3'004A11'                                              84588021
        DC     AL3(2)                                                   84594021
*                                                                       84600021
*=E      004B  'NEXT SENTENCE' ILLEGAL AND DISCARDED. BOTH -- AND N     84606021
*=              -- WILL CAUSE EXECUTION OF NEXT VERB.                   84612021
*                                                                       84618021
ELST4B DC      XL3'004B12'                                              84624021
       DC      AL3(1)                                                   84630021
       DC      AL3(1)                                                   84636021
*                                                                       84642021
*=E    004C    __REQUIRES__LEVELS OF SUBSCRIPTING OR INDEXING.          84648021
*              SUBSTITUTING FIRST OCCURENCE OF __.                      84654021
*                                                                       84660021
ELST4C EQU     *                                                        84666021
       DC      XL3'004C23'                                              84672021
       DC      AL3(CURENT)                                              84678021
       DC      AL3(BCDMBS)                                              84684021
       DC      AL3(CURENT)                                              84690021
*                                                                       84696021
*=E    004D    -- MAY NOT BE USED AS A SUBSCRIPT SINCE IT NEEDS SUB     84702021
*=              SCRIPTING ITSELF.SUBSTITUTING 1ST OCCURRENCE OF --.     84708021
*                                                                       84714021
ELST4D EQU     *                                                        84720021
       DC      XL3'004D22'                                              84726021
       DC      AL3(0)                                                   84732021
       DC      AL3(CURENT)                                              84738021
*                                                                       84744021
*=E    004E    SUBSCRIPT MUST BE INTEGRAL DATA-NAME OR LITERAL. FOU     84750021
*=               NON-INTEGER --. SUBSTITUTING 1ST OCCURENCE OF --.      84756021
*                                                                       84762021
ELST4E DC      XL3'1A4E22'                                              84768021
       DC      AL3(0)                                                   84774021
       DC      AL3(CURENT)                                              84780021
*                                                                       84786021
*=     004F    -- FOUND AMONG SUBSCRIPTS. SUBSTITUTING 1ST OCCURREN     84792021
*=              OF --.                                                  84798021
*                                                                       84804021
ELST4F DC      XL3'1A4F22'                                              84810021
       DC      AL3(0)                                                   84816021
       DC      AL3(CURENT)                                              84822021
*                                                                       84828021
*=E    0050    DEBUG PACKET MAY NOT REFER TO --,WHICH ITSELF IS IN      84834021
*=              DEBUG PACKET. CARD DELETED AND FOLLOWING STATEMENTS     84840021
*=              ATTACHED TO IMMEDIATELY PRECEDING PACKET                84846021
*                                                                       84852021
ELST50 DC      XL3'005000'                                              84858021
*                                                                       84864021
*=E    0051   __EXCEEDS __CHARACTERS . UP TO 114 ACCEPTED               84870021
*                                                                       84876021
ELST51 DC      XL3'005112'                                              84882021
       DC      AL3(CURENT)                                              84888021
       DC      AL3(1)                                                   84894021
*                                                                       84900021
*=E    0052    __IS NOT DEFINED AS SUBSCRIPTED OR INDEXED.              84906021
*              SUBSCRIPTS DISCARDED.                                    84912021
*                                                                       84918021
ELST52 DC      XL3'005221'                                              84924021
       DC      AL3(CURENT)                                              84930021
*                                                                       84936021
*=E    0053    OCCURS-DEPENDING-ON VARIABLE MUST BE INTEGRAL NON-SU     84942021
*=              SCRIPTED DATA-NAME. FOUND --. ARBITRAILY SUBSTITUT-     84948021
*=              ING TALLY.                                              84954021
*                                                                       84960021
ELST53 DC      XL3'195322'                                              84966021
       DC      AL3(0)                                                   84972021
       DC      AL3(CBTALY)                                              84978021
*                                                                       84984021
*=E    0054    ILLOGICAL USE OF PARENTHESES ACCEPTED WITH DOUBTS AS     84990021
*=              MEANING.                                                84996021
*                                                                       85002021
ELST54 DC      XL3'005410'                                              85008021
*                                                                       85014021
*=E    0055    RECORD DESCRIPTION FOR FILE -- MISSING OR ILLEGAL.       85020021
*=               STATEMENT DISCARDED.                                   85026021
*                                                                       85032021
ELST55 DC      XL3'005521'                                              85038021
       DC      AL3(PSTFLD)                                              85044021
*                                                                       85050021
*=E    0056    -- CONDITION USED WHERE ONLY IMPERATIVE STATEMENTS A     85056021
*=              LEGAL MAY CAUSE ERRORS IN PROCESSING.                   85062021
*                                                                       85068021
ELST56 DC      XL3'005611'                                              85074021
       DC      AL3(1)                                                   85080021
*                                                                       85086021
*=E    0057    END DECLARATIVES MISSING OR MISPLACED. PROGRAM CANNO     85092021
*=               BE EXECUTED.                                           85098021
*                                                                       85104021
ELST57 DC      XL3'005720'                                              85110021
*                                                                       85116021
*=E    0058    COMPILER ERROR. COUNT FIELD 0. PH4 DISCONTINUING.        85122021
*                                                                       85128021
ELST58 DC      XL3'005880'                                              85134021
*                                                                       85140021
*=E    0059    -- -- SHOULD NOT BE TARGET FIELD FOR -- -- IN --         85146021
*              STATEMENT. STATEMENT DISCARDED.                          85152021
*                                                                       85158021
ELST59   DC    XL3'035905'                                        0321  85164021
       DC      AL3(PRIGHT)                                              85170021
       DC      AL3(5)                                                   85176021
       DC      AL3(PLEFT)                                               85182021
       DC      AL3(4)                                                   85188021
       DC      AL3(2)                                                   85194021
*                                                                       85200021
*=E    005A    SORT-KEY MUST BE IN FIXED POSITION NOT MORE THAN 409     85206021
*=              BYTES FROM START OF RECORD. -- DISCARDED.               85212021
*                                                                       85218021
ELST5A DC      XL3'005A21'                                              85224021
       DC      AL3(0)                                                   85230021
*                                                                       85236021
*=E    005B    SYNTAX REQUIRES OPERAND. FOUND --. TEST DISCARDED.       85242021
*                                                                       85248021
ELST5B DC      XL3'045B21'                                              85254021
       DC      AL3(0)                                                   85260021
*                                                                       85266021
*                                                                       85272021
*=E    005C    EXTERNAL DECIMAL NAME USED IN TRANSFORM STATEMENT.       85278021
*=               STATEMENT ACCEPTED                                     85284021
*                                                                       85290021
ELST5C DC      XL3'005C00'                                              85296021
*                                                                       85302021
*=E    005D    ALL WRITE STATEMENTS FOR__SHOULD HAVE ADVANC-            85308021
*              ING OPTION.__ADVANCING 1 LINE ASSUMED.                   85314021
*                                                                       85320021
ELST5D DC    XL3'005D14'                                                85326021
       DC      AL3(PSTFLD)                                              85332021
       DC    AL3(0)                                                     85338021
       DC    AL3(1)                                                     85344021
       DC    AL3(0)                                                     85350021
*                                                                       85356021
*=E    005E    -- IS IN A RECORD OF AN APPLY-WRITE-ONLY FILE AND        85362021
*=              REFERRING TO IT MAY CAUSE ERRORS IF FILE IS OPENED      85368021
*=              OUTPUT WHEN -- STATEMENT IS EXECUTED.                   85374021
*                                                                       85380021
ELST5E DC      XL3'005E02'                                              85386021
       DC      AL3(0)                                                   85392021
       DC      AL3(2)                                                   85398021
*                                                                       85404021
*=E    005F    WRITE FROM DATA-NAME REQUIRED FOR --, TO WHICH WRITE     85410021
*=              ONLY IS APPLIED. STATEMENT DELETED.                     85416021
*                                                                       85422021
ELST5F DC      XL3'005F21'                                              85428021
       DC      AL3(PSTFLD)                                              85434021
*                                                                       85440021
*=E    0060    -- STATEMENT WILL NOY BE EXECUTED                        85446021
*                                                                       85452021
ELST60 DC      XL3'006001'                                              85458021
       DC      AL3(0)                                                   85464021
*                                                                       85470021
*=E      0061  UNIT (REEL) OPTION ILLEGAL FOR --. DISCARDED.            85476021
*                                                                       85482021
ELST61   DC    XL3'006111'                                              85488021
         DC    AL3(CURENT)                                              85494021
*                                                                       85500021
*=E    0062    ALTER STATEMENT REFERS TO A 'GO TO' IN A DIFFERENT       85506021
*              INDEPENDENT SEGMENT,STATEMENT IGNORED.                   85512021
*                                                                       85518021
ELST62 DC      XL3'006220'                                              85524021
*                                                                       85530021
*                                                                       85536021
*                                                                       85542021
*                                                                       85548021
*=E     0064    IDENTIFIER FOLLOWING INTO (FROM) IN READ (WRITE)        85554021
*              STATEMENT SHOULD NOT BE DEFINED UNDER SAME FD AS         85560021
*              RECORDNAME. STATEMENT ACCEPTED AS WRITTEN.               85566021
*                                                                       85572021
*                                                                       85578021
ELST64 DC    XL3'006400'                                                85584021
*                                                                       85590021
*                                                                       85596021
*                                                                       85602021
*=E    0065   SET STATEMENT REQUIRES OPERAND AFTER 'UP' OR 'DOWN' TO    85608021
*              BE NUMERIC INTEGRAL DATA NAME OR POSITVE NUMERIC         85614021
*              LITERAL.FOUND__.STATEMENT DISCARDED.                     85620021
ELST65 DC    XL3'006521'                                                85626021
       DC    AL3(0)                                                     85632021
*                                                                       85638021
*                                                                       85644021
*=E     0066    SET STATEMENT REQUIRES OPERAND     AFTER 'TO' TO BE     85650021
*              INDEX NAME, INDEX DATA ITEM, NUMERIC INTEGRAL DATA       85656021
*              NAME OR POSITIVE NUM LITERAL.FOUND__.STATEMENTEN DISC    85662021
*              ARDED.                                                   85668021
ELST66 DC    XL3'006621'                                                85674021
       DC    AL3(0)                                                     85680021
*                                                                       85686021
*                                                                       85692021
*=E    0067    ALL MUST BE FOLLOWED BY ALPHANUMERIC LITERAL.            85698021
*=               FOUND --.  DISCARDING 'ALL'.                           85704021
*                                                                       85710021
ELST67 DC      XL3'036711'                                              85716021
       DC      AL3(0)                                                   85722021
*=E    0068    SEARCH OR SEARCH-ALL STATEMENT HAS EITHER SUBSCRIPTE     85728021
*      OR INDEXED IDENTIFIER-1 OR ILLEGAL OPERAND. SCANNING TILL        85734021
*              'AT END' OR 'WHEN'. DELETING TILL ONE OF THESE FOUND     85740021
*                                                                       85746021
ELST68 DC      XL3'006820'                                              85752021
*                                                                       85758021
*=E    0069    DATA-NAME CANNOT BE BOTH INDEXED AND SUBSCRIPTED         85764021
*              IN __ STATEMENT. SUBSCRIPTS DISCARDED.                   85770021
*                                                                       85776021
ELST69  DC      XL3'006921'                                             85782021
       DC       AL3(2)                                                  85788021
*                                                                       85794021
*=E    006A    DATA-NAME MUST BE INDEXED BY INDEXNAME OR INDEXNAME      85800021
*              PLUS OR MINUS INTEGRAL NUMERIC LITERAL. SUBSTITUTING     85806021
*              FIRST OCCURENCE OF__.                                    85812021
*                                                                       85818021
ELST6A DC      XL3'006A21'                                              85824021
       DC      AL3(CURENT)                                              85830021
*                                                                       85836021
*=E    006B       -------ILLEGAL FOR SORT FILE. STATEMENT DELETED.      85842021
*                                                                       85848021
ELST6B  DC  XL3'006B21'                                                 85854021
       DC   AL3(1)                                                      85860021
*                                                                       85866021
*=E    006C    CALLED PROGRAM MAY NOT BE SEGMENTED.ENTRY STATEMENT      85872021
*              IGNORED.                                                 85878021
*                                                                       85884021
*                                                                       85890021
*                                                                       85896021
ELST6C DC    XL3'006C20'                                                85902021
*                                                                       85908021
*                                                                       85914021
*                                                                       85920021
*=E    006D    KEY IN SEARCH-ALL FLOATING POINT. STATEMENT              85926021
*              CHANGED  TO  SEARCH  STATEMENT.                          85932021
*                                                                       85938021
ELST6D DC    XL3'006D20'                                                85944021
*                                                                       85950021
*=E     006E    CONDITION IN SEARCH ALL STATEMENT TESTS KEY WITHOUT     85956021
*              TESTING ALL PRECEDING KEYS. STATEMENT DISCARDED.         85962021
ELST6E DC    XL3'006E20'                                                85968021
*                                                                       85974021
*=E    006F    INVALID CONDITION OR INVALID FORMULA IN                  85980021
*              CONDITION IN SEARCH-ALL STATEMENT. STATEMENT             85986021
*              DISCARDED.                                               85992021
*                                                                       85998021
ELST6F DC      XL3'006F20'                                              86004021
*                                                                       86010021
*=E    0070       SET UP OR DOWN SHOULD NOT INCREMENT INDEXNAME BY      86016021
*              INDEX DATA ITEM. ACCEPTED AS WRITTEN.                    86022021
*                                                                       86028021
*                                                                       86034021
ELST70 DC    XL3'007000'                                                86040021
*                                                                       86046021
*=E     0071    LABEL DECLARATIVE ILLEGAL FOR ISAM FILE___.FILE         86052021
*              SKIPPED.                                                 86058021
*                                                                       86064021
*                                                                       86070021
ELST71 DC    XL3'007121'                                                86076021
       DC    AL3(0)                                                     86082021
*                                                                       86088021
*=E    0072    LABEL DECLARATIVE FOR BDAM FILE SHOULD NOT HAVE UNIT     86094021
*              OR REEL OPTION.___FILE SKIPPED.                          86100021
*                                                                       86106021
ELST72 DC    XL3'007221'                                                86112021
       DC    AL3(0)                                                     86118021
*                                                                       86124021
*=E    0073    -- STATEMENT REQUIRES IDENTIFIER WHOSE USAGE IS          86130021
*              DISPLAY.  FOUND SPECIAL REGISTER.  STATEMENT DISCARDED.  86136021
*                                                                       86142021
ELST73 DC      XL3'067321'                                              86148021
         DC    AL3(2)                                                   86154021
*                                                                       86160021
*                                                                       86166021
*                                                                       86172021
*                                                                       86178021
*                                                                  5965 86184021
*                                                                  5965 86190021
ELST8D DC    XL3'008D00'                                           5965 86196021
*=E    008D    INVALID KEY CLAUSE IN REWRITE USING QSAM/QISAM IGNORED   86202021
*                                                                  5965 86208021
*                                                                  5965 86214021
*        EXPECTING ... FOUND ... STATEMENT ACCEPTED AS WRITTEN    50782 86220021
ELST83   DC    XL3'008302'                                        50782 86226021
         DC    AL3(1)                                             50782 86232021
         DC    AL3(0)                                             50782 86238021
*                    ADCONS FOR VERB ANALYZERS                          86244021
*                                                                       86250021
*                                                                       86256021
         DS    0F                                                       86262021
AVRB   EQU     *                  CODE      ELEMENT-COUNT               86268021
       DC      XL1'5'                       5                           86274021
       DC      AL3(ADD)           0                                     86280021
       DC      XL1'5'                       5                           86286021
       DC      AL3(SUBTR)         1                                     86292021
       DC      XL1'5'                       5                           86298021
       DC      AL3(MULT)          2                                     86304021
       DC      XL1'5'                      5                            86310021
       DC      AL3(DIV)           3                                     86316021
       DC      A(COMPUT)          4                                     86322021
ASTOR  DC      XL1'2'                       2                           86328021
       DC      AL3(STORAN)        5                                     86334021
       DC      A(EOS)             6                                     86340021
AIF    DC      A(IF)              7                                     86346021
       DC      A(ELSE)            8                                     86352021
       DS      7F                 CODES FOR RELATIONALS                 86358021
       DC      XL1'1'                       1                           86364021
       DC      AL3(STOP)          10                                    86370021
       DC      XL1'1'                       1                           86376021
       DC      AL3(GO)            11                                    86382021
ACB1   EQU     *                                                        86388021
       DS      10F                CODES FOR GO-DEPENDING,AND RELATS     86394021
       DC      XL1'2'                       2                           86400021
       DC      AL3(ALTER)         1C                                    86406021
       DC      XL1'2'                       2                           86412021
       DC      AL3(MOVE)          1D                                    86418021
       DC      XL1'4'                            4                      86424021
       DC      AL3(EXAMIN)        1E                                    86430021
       DC      XL1'4'                       4                           86436021
       DC      AL3(TRFORM)        1F                                    86442021
       DC      XL1'5'                       5                           86448021
       DC      AL3(READ)          20                                    86454021
       DC      XL1'5'                       5 CONTINUOUS-SEGM'TED       86460021
       DC      AL3(OPEN)          21                                    86466021
       DC      XL1'5'                       5 CONTINUOUS SEGM'TED       86472021
       DC      AL3(CLOSE)         22                                    86478021
       DC      XL1'5'                       5                           86484021
       DC      AL3(WRITE)         23                                    86490021
       DC      XL1'5'                       5                           86496021
       DC      AL3(REWRIT)        24                                    86502021
       DC      XL1'5'              5- SEGMENTED STRING                  86508021
       DC      AL3(ACCEPT)         25                                   86514021
       DC      XL1'5'                       5 CONTINUOUS-SEGM'TED       86520021
       DC      AL3(DISPLA)         26                                   86526021
       DC      XL1'4'                       SEGMENTED-4                 86532021
       DC      AL3(EXHIBT)   27                                         86538021
         DC    XL1'0'              0                                    86544021
       DC      AL3(RESET)    28                                         86550021
         DC    XL1'0'              0                                    86556021
       DC      AL3(READY)    29                                         86562021
       DC    XL1'1'                                                     86568021
       DC    AL3(RETURN)           2A                                   86574021
       DC      XL1'4'                       4                           86580021
       DC      AL3(ONVRB)         2B                                    86586021
AENTRY DC      XL1'5'              SEGMENTED STRING                     86592021
       DC    AL3(ENTRY)            2C                                   86598021
       DC      XL1'5'              SEGMENTED STRING                     86604021
       DC    AL3(CALL)             2D                                   86610021
       DS    1F                      ENTER WAS HERE                     86616021
       DS    2F                     HOLD,PROCESS WERE HERE              86622021
       DC      A(USE)             31                                    86628021
       DC      A(EXIT)            32                                    86634021
       DC      XL1'1'                       1                           86640021
       DC      AL3(MOVRPT)        33                                    86646021
ACB2   EQU     *                                                        86652021
       DS    2F                    TO BE USED AS ORG                    86658021
ASORT  DC    XL1'3'                                                     86664021
       DC    AL3(SORT)             36                                   86670021
       DC    XL1'1'                1                                    86676021
       DC      AL3(RLEASE)        37                                    86682021
APRFRM DC      A(PRFORM)          38                                    86688021
       DS      1F                 (SUBSCRIPT VERB)                      86694021
       DC    A(LINKVB)            3A                                    86700021
       DC      XL1'2'                       2                           86706021
       DC      AL3(DEBUGG)        3B                                    86712021
ACB3   EQU     *                                                        86718021
       DS    3F                    USED AS ORG                          86724021
*              INTERNAL Q- AND R- ROUTINE VERBS                         86730021
       DC      XL1'2'                       2                           86736021
       DC      AL3(MOVRPT)        3F                                    86742021
       DC      XL1'2'                       2                           86748021
       DC      AL3(MOVRPT)        40                                    86754021
         DC    XL1'4'              4                               4758 86760021
       DC      AL3(MOVRPT)        41                                    86766021
       DC      XL1'2'                       2                           86772021
       DC      AL3(MOVRPT)        42                                    86778021
       DC      XL1'4'                       4                           86784021
       DC      AL3(UPDATE)                                              86790021
ACB4   EQU     *                                                        86796021
       DS    8F                    USED    AS ORG                       86802021
*              INTERNAL VERBS Q-ROUTINE AND REPORT GENERATOR            86808021
* VERBS FROM HERE UP TO ASRCH GO TO MOVRPT,ARE CONVERTED TO P-2         86814021
* TEXT AND JUST  PASSED  ON.                                            86820021
       DC      XL1'1'                       1                           86826021
       DC      AL3(MOVRPT)                                              86832021
       DC      XL1'0'                       0                           86838021
       DC      AL3(MOVRPT)                                              86844021
       DC      XL1'0'                       0                           86850021
       DC      AL3(MOVRPT)                                              86856021
       DC      XL1'1'                                                   86862021
       DC      AL3(MOVRPT)                                              86868021
       DC      XL1'0'                       0                           86874021
       DC      AL3(MOVRPT)                                              86880021
       DC      XL1'0'                       0                           86886021
       DC      AL3(MOVRPT)                                              86892021
       DC      XL1'0'                       0                           86898021
       DC      AL3(MOVRPT)                                              86904021
       DC      XL1'0'                       0                           86910021
       DC      AL3(MOVRPT)                                              86916021
       DC      XL1'0'                       0                           86922021
       DC      AL3(MOVRPT)                                              86928021
       DC      XL1'0'                       0                           86934021
       DC      AL3(MOVRPT)                                              86940021
       DC      XL1'0'                       0                           86946021
       DC      AL3(MOVRPT)                                              86952021
       DC      XL1'0'                       0                           86958021
       DC      AL3(MOVRPT)                                              86964021
       DC      XL1'0'                       0                           86970021
       DC      AL3(MOVRPT)                                              86976021
       DC      XL1'0'                       0                           86982021
       DC      AL3(MOVRPT)                                              86988021
       DC      XL1'0'                       0                           86994021
       DC      AL3(MOVRPT)                                              87000021
       DC      XL1'0'                       0                           87006021
       DC      AL3(MOVRPT)                                              87012021
       DC      XL1'3'                       3                           87018021
       DC      AL3(MOVRPT)        5C                                    87024021
       DC      XL1'0'                       0                           87030021
       DC      AL3(MOVRPT)        5D                                    87036021
ASRCH  DC    A(SEARCH)             K   5E                               87042021
ASRCHAL DC     A(SRCHAL)           5F                                   87048021
ASET  EQU   *      SET,SET UP                                           87054021
       DS    1F                                                         87060021
       DC    XL1'2'                                                     87066021
       DC    AL3(SET)                                                   87072021
       DC    XL1'1'                                                     87078021
       DC    AL3(FREE)              L 62                                87084021
       DS    1F                                                         87090021
       DC    XL1'3'                                                     87096021
        DC    AL3(START)          64                                    87102021
       DC    XL1'5'                                                     87108021
       DC    AL3(READUP)       65                                       87114021
       DS    6F                                                         87120021
       DC    XL1'2'                                                     87126021
       DC    AL3(MOVRPT)             VIRTUAL DEFINITION                 87132021
       DS    4F                                                         87138021
       DC    XL1'5'                                                     87144021
       DC    AL3(READ)            READ CHECKPOINT                       87150021
       DC    XL1'5'                                                     87156021
       DC    AL3(WRITE)            WRITE CHECKPOINT                     87162021
    DC    A(MOVRPT)           GOBACK- NO OPERANDS                       87168021
       DS    1F                                                         87174021
       DC    XL1'5'                                                     87180021
       DC    AL3(READUP)           READ UPDATE CHECKPOINT               87186021
       DC    XL1'5'                                                     87192021
       DC    AL3(MOVRPT)          76                                    87198021
LASTAD EQU     *                                                        87204021
*                                                                       87210021
*                        OTHER ADCONS                                   87216021
*                                                                       87222021
       ORG     AIF+8         (USE SLACK OF RELATIONALS IN VERB LIST     87228021
APRYME DC      A(APRIME-COS)                                            87234021
ANSERT DC      A(AINSRT-COS)                                            87240021
       DC      A(ADSTAT-COS)                                            87246021
ARELES DC      A(RELADD-COS)                                            87252021
APFNDL DC      A(PFINDL)                                                87258021
ACURNT DC      A(CURENT)                                                87264021
COSADR DC      A(0)                                                     87270021
         EJECT                                                          87276021
*                                                                       87282021
*                                 COBOL WORDS                           87288021
*                                                                       87294021
* L O O K  O U T  F O R  O R G'S  I N  M A K I N G  I N S E R T I O     87300021
*                                                                       87306021
       ORG     ACB1         *     USE 10-WORD SLACK IN ADCON LIST       87312021
CBADV  DC      XL2'5473'          ADVANCING                             87318021
CBALF  DC      XL2'5455'           ALPHABETIC                           87324021
CBALL  DC      XL2'5479'           'ALL'                                87330021
CBAND  DC      XL2'545D'           AND                                  87336021
CBCHAR DC      XL2'5492'           CHARACTERS                           87342021
CBCNSL DC      XL2'5478'           CONSOLE                              87348021
CBCORR DC      XL2'547A'          CORRESPONDING                         87354021
CBDEPN DC      XL2'5494'           DEPENDING                            87360021
CBELSE DC      XL2'4408'          ELSE                                  87366021
CBEOS  DC      XL2'4406'          .                                     87372021
CBEQSN DC      XL2'5006'           =                                    87378021
CBFRST DC      XL2'5496'           'FIRST'                              87384021
CBGIVE DC      XL2'5481'          GIVING                                87390021
CBIF   DC      XL2'4407'           IF                                   87396021
CBINVL DC      XL2'5471'          INVALID                               87402021
CBIO   DC      XL2'546B'          I-O                                   87408021
CBIS   DC      XL2'549C'           IS                                   87414021
CBKEY  DC      XL2'549F'          KEY                                   87420021
CBLEAD DC      XL2'547C'           'LEADING'                            87426021
CBLESS DC      XL2'500A'           LESS                                 87432021
       ORG     ACB2         *     USE 3-WORD  SLACK IN ADCON LIST       87438021
CBLINE DC      XL2'5495'          LINE                                  87444021
CBLPRN   DC    XL2'5200'      (                                         87450021
CBMINS   DC    XL2'5301'      -                                         87456021
CBMORE DC      XL2'5008'           GREATER                              87462021
       ORG     ACB3         *     USE 3-WORD  SLACK IN ADCON LIST       87468021
CBMOVE DC      XL2'441D'           MOVE                                 87474021
CBNEG  DC      XL2'5458'           NEGATIVE                             87480021
CBNEXT DC      XL2'5497'           NEXT                                 87486021
CBNO   DC      XL2'549E'          NO                                    87492021
CBNOT  DC      XL2'545C'           NOT                                  87498021
CBNUM  DC      XL2'5456'           NUMERIC                              87504021
       ORG     ACB4               USE 8-WORD SLACK                      87510021
CBON   DC      XL2'542B'          ON                                    87516021
CBOR   DC      XL2'545E'           OR                                   87522021
CBPLUS   DC    XL2'5300'      +                                         87528021
CBPOS  DC      XL2'5457'           POSITIVE                             87534021
CBPRCD DC      XL2'5486'           PROCEED                              87540021
CBPROG DC    XL2'540D'             PROGRAM                              87546021
CBPRNG DC      XL2'5468'          PROCESSING                            87552021
CBQUOT DC      XL2'757D'          QUOTE                                 87558021
CBSECT DC      XL2'54A5'          SECTION                               87564021
CBRCRD DC      XL2'54CD'          RECORD                                87570021
CBRPLC DC      XL2'547E'           'REPLACING'                          87576021
CBROUN DC      XL2'5482'           ROUNDED                              87582021
CBRPRN   DC    XL2'5201'      )                                         87588021
CBRUN  DC      XL2'5485'           RUN                                  87594021
CBSAME DC      XL2'5410'          DUMMY USED IN MOVE-CORRESPONDING      87600021
CBSENT DC      XL2'54FB'           SENTENCE                             87606021
       ORG     LASTAD                                                   87612021
CBSIZE DC      XL2'5483'           SIZE                                 87618021
CBSPCE DC      XL2'7540'           FIGCON SPACE                         87624021
CBSIN  DC      XL2'5418'          SYSIN                                 87630021
CBSOUT DC      XL2'5419'          SYSOUT                                87636021
CBTALY DC      XL2'7905'          TALLY                                 87642021
CBTLYG DC      XL2'547B'           'TALLYING                            87648021
CBTHAN DC      XL2'5453'           THAN                                 87654021
CBTHEN DC      XL2'5450'           THEN                                 87660021
CBTHRU DC      XL2'5487'           THROUGH (THRU)                       87666021
CBTIME DC      XL2'5493'           TIMES                                87672021
CBVARY DC      XL2'5488'           VARYING                              87678021
CBWITH DC      XL2'546C'          WITH                                  87684021
*              KEEP THESE 4 TOGETHER. ARITH INDEXES THRU THEM           87690021
CBTO   DC      XL2'549B'     *4     TO                                  87696021
CBFROM DC      XL2'549D'     *4     FROM                                87702021
CBBY   DC      XL2'547F'     *4     BY                                  87708021
CBINTO DC      XL2'546F'     *4     INTO                                87714021
CBUNTL DC      XL2'547D'           'UNTIL'                              87720021
CBZERO DC      XL2'75F0'           ZERO                                 87726021
CBASCD DC    XL2'548D'             'ASCENDING'                          87732021
CBAT   DC      XL2'5470'           'AT'                                 87738021
CBCHGD DC      XL2'548F'           CHANGED                              87744021
CBCOBO DC      XL2'548A'           'COBOL'                              87750021
CBDSCD DC    XL2'548C'             'DESCENDING'                         87756021
CBEND  DC      XL2'54A1'          END           VISIBILITY              87762021
CBEVER DC      XL2'549A'          EVERY                                 87768021
CBINPT DC    XL2'5466'             'INPUT'                              87774021
CBLINK DC      XL2'5491'          LINKAGE                               87780021
CBMORL DC      XL2'5463'          MORE-LABELS                           87786021
CBLOCK DC      XL2'5476'          LOCK                                  87792021
CBNAMD DC      XL2'5490'           NAMED                                87798021
CBOUTP DC    XL2'5464'             'OUTPUT'                             87804021
CBPROC DC      XL2'5499'           'PROCEDURE'                          87810021
CBRVRS DC      XL2'546E'          REVERSED                              87816021
CBRWND DC      XL2'546D'          REWIND                                87822021
CBSYSP DC      XL2'5477'           SYSPCH                               87828021
CBTRAC DC      XL2'548E'           TRACE                                87834021
CBTRY  DC      XL2'541B'                                                87840021
CBLEAVE DC    XL2'544A'            LEAVE                                87846021
CBRERD DC    XL2'544B'             REREAD                               87852021
CBDISP DC    XL2'544C'             DISP                                 87858021
CBEOP  DC    XL2'545A'             END-OF-PAGE (EOP)                    87864021
CBPOSN DC    XL2'54DC'             POSITIONING                          87870021
CBUPON DC      XL2'5498'          UPON                                  87876021
CBUSIN DC    XL2'5489'             'USING'                              87882021
CBWHEN DC    X'54E2'               WHEN                                 87888021
CBUP     DC  X'543A'      UP                                            87894021
CBDOWN   DC  X'543B'      DOWN                                          87900021
CBSRCH DC    X'445E'               SEARCH                               87906021
CBSRCHA DC   X'445F'               SEARCH ALL (P-1 FORMAT)              87912021
CBDBUG DC      XL2'443B'          DEBUG                                 87918021
ERSYMB DC      XL2'B900'          1ST 2 BYTES OF 'UNDEFINED' (3RD=0     87924021
CBREM  DC    XL2'543E'                         REMAINDER                87930021
EOFWD  DC      XL2'42FF'           PROGRAM BREAK                        87936021
UMIN   DC      XL2'5307'          DUMMY FOR UNARY MINUS - HIGHEST S     87942021
*                                                                       87948021
*                        WORDS USED IN USE-ANALYZER LOOPS               87954021
*                                                                       87960021
CBAFTR DC      XL2'5472'          AFTER   *                             87966021
CBEFOR DC    XL2'5469'        BEFORE  *                                 87972021
CBSTND DC      XL2'54D5'          STANDARD    *                         87978021
CBEROR DC      XL2'5484'          ERROR       *                         87984021
       DC      XL2'5461'          BEGINNING   *                         87990021
       DC      XL2'5462'          ENDING      *                         87996021
CBREEL DC    XL2'5417'         *                                        88002021
CBUNIT DC    XL2'54A2'         *                                        88008021
CBFILE DC    XL2'543C'             *                                    88014021
CBLABL DC    XL2'54D1'             *                                    88020021
       DC    XL2'546A'          *                                       88026021
CBRAND EQU     *                                                        88032021
       DC      XL2'5467'          RANDOM      *                         88038021
VBCODE DC      X'4A'              USE-REPORT    *                       88044021
       DC      X'46'              USE-LABELS    *                       88050021
       DC      X'44'              USE-ERROR     *                       88056021
       DC      X'48'              USE-RANDOM    *                       88062021
*                                                                       88068021
*                                                                       88074021
*  M I S C E L L A N E O U S   D E F I N I T I O N S                    88080021
*                                                                       88086021
       DS      0F                                                       88092021
M4BITS DC      XL4'F'                                                   88098021
INTG1L DC      XL4'32030100'      1ST 4-BYTES OF U DIGIT LITERAL        88104021
PSTVRB DC      XL3'840502'    STORE-VERB WITH COUNT=2                   88110021
ADDVRB DC      XL3'840005'         ADD VERB                             88116021
CBGO   DC      XL3'841101'        'GO' WITH ELEMENT-COUNT=1             88122021
EQUVRB DC      XL3'843E02'         EQUATE                               88128021
TRACVB DC      XL3'843D01'        TRACE VERB FOR PHASE 5                88134021
CALLVB DC      XL3'842D01'         CALL                                 88140021
MOVEVB DC      XL3'841D02'         MOVE                                 88146021
MOVEVN DC      XL3'841C02'        ALTER VERB FOR PHASE 5                88152021
GOTIME DC      XL3'843803'        GO VERB FOR PERFORM N TIMES           88158021
EXITPG DC    XL3'847400'           EXIT PROGRAM                         88164021
       DS      0H                                                       88170021
HIVERB DC      AL2(LASTAD-AVRB)   IC-TEXT LIMIT FOR VERBS               88176021
CLEAN    XC    DX0(LX1,RW2),DX0(RW2) ZEROES AREA                        88182021
NDCBRK DC      XL2'4208'             END-DECLARATIVES BREAK             88188021
TALMOD DC      XL2'800B'          MODE OF 'TALLY'                       88194021
DNANMD DC      XL2'6003'     STORED MODE OF ALPHANUMERIC DATA NAME      88200021
MODIFL DC      XL2'800A'          MODE FOR INTERNAL FL-PT               88206021
INDNMD DC    X'10FF'              MODE FOR INDEX DATA ITEM              88212021
CBC0   DC      XL2'75C0'           OTHER FIGCON                         88218021
CBC9   DC      XL2'75C9'           I                                    88224021
CBD0   DC      XL2'75D0'           J                                    88230021
CBD9   DC      XL2'75D9'           R                                    88236021
CBE1   DC      XL2'75E1'           S                                    88242021
CBE9   DC      XL2'75E9'           Z                                    88248021
CBF9   DC      XL2'75F9'           9                                    88254021
*                                                                       88260021
*                                 NUMBERS                               88266021
*                                                                       88272021
         DS    0F                                                       88278021
N0     DC      XL4'0'                                                   88284021
N1     DC      XL2'1'                                                   88290021
N2       DC    XL2'2'                                                   88296021
N3     DC      XL2'3'                                                   88302021
N4     DC      XL2'4'                                                   88308021
N5     DC      XL2'5'                                                   88314021
N6     DC      XL2'6'                                                   88320021
N7     DC      XL2'7'                                                   88326021
N10    DC      XL2'A'                                                   88332021
NDEC12 DC      XL2'C'                                                   88338021
N13    DC      XL2'D'                                                   88344021
N14    DC    XL2'E'                                                     88350021
N200   DC      XL2'C8'                                                  88356021
NFF    DC      XL4'FF'                                                  88362021
N256   DC      XL2'100'                                                 88368021
N400B  DC      XL2'400B'                                                88374021
N4092  DC      H'4092'                                                  88380021
NFFFF  DC      XL2'FFFF'                                                88386021
ONE19  DC    XL4'72'                                                    88392021
ISNILM   DC    XL6'02147483647C' MAX DEC NUMBER CONTAINED IN 4 BYTE     88398021
PAKZER   DC    XL1'0C'               PACKED-DEC. 0                      88404021
NX7FFF DC      XL3'32767C'         32,767 PACKED                        88410021
*                                                                       88416021
*                                                                       88422021
*              BCD WORDS FOR ERROR MESSAGES                             88428021
*                                                                       88434021
*                                                                       88440021
BCDCLS DC      XL3'3F3405'                                        *     88446021
       DC      CL5'CLASS'                                         *     88452021
BCDSGN DC      XL3'3F3404'                                      *       88458021
       DC      CL4'SIGN'                                        *       88464021
KEYWRD DC      XL3'3F3407'        *                                     88470021
       DC      CL7'KEYWORD'       *                                     88476021
BCDNLT   DC    X'340F'             *                                    88482021
         DC    C'NUMERIC LITERAL'  *                                    88488021
BCDALT   DC    X'3414'               *                                  88494021
         DC    C'ALPHANUMERIC LIT'   *                                  88500021
         DC    C'ERAL'               *                                  88506021
BCDFLT   DC    X'3416'                 *                                88512021
         DC    C'FLOATING-POINT L'     *                                88518021
         DC    C'ITERAL'               *                                88524021
BCDOP  DC    XL3'3F340D'                                                88530021
       DC    C'OPEN OR CLOSE'                                           88536021
BCDRD  DC    XL3'3F340D'                                                88542021
       DC    C'READ OR WRITE'                                           88548021
BCDPFD DC      XL3'3F3409'                                              88554021
       DC      C'PERFORMED'                                             88560021
BCDECL DC      XL3'3F340B'                                              88566021
       DC      C'DECLARATIVE'                                           88572021
BCDDN  DC      XL3'3F3409'                *                             88578021
       DC      C'DATA-NAME'               *                             88584021
BCDNOP DC      XL3'3F340F'          *                                   88590021
       DC      C'NUMERIC OPERAND'   *                                   88596021
BCDSRK DC      XL3'3F3408'            *                                 88602021
       DC      C'SORT-KEY'            *                                 88608021
BCDSFL DC      XL3'3F3409'              *                               88614021
       DC      C'SORT-FILE'             *                               88620021
BCD1   DC      XL3'3F3401'                                              88626021
       DC      C'1'                                                     88632021
EBCDFF DC    XL3'3F3403'               *                                88638021
       DC    C'114'                                                     88644021
BCDCND DC      XL3'3F340E'             *                                88650021
       DC      CL14'CONDITION-NAME'    *                                88656021
BCDEXP DC      XL2'3415'                                                88662021
       DC    CL11'ARITHMETIC '                                          88668021
       DC    CL10'EXPRESSION'                                           88674021
BCDOPT DC      XL3'3F3406'    *                                         88680021
       DC      CL6'OPTION'    *                                         88686021
BCDNOR DC      XL3'3F3409'      *                                       88692021
       DC      CL9'NO-REWIND'   *                                       88698021
BCDNOQ DC      XL3'3F3408'        *                                     88704021
       DC      CL8'NON-QSAM'      *                                     88710021
BCDVMD DC      XL3'3F3406'  *                                           88716021
       DC      CL6'V-MODE'  *                                           88722021
BCDBSA DC      XL3'3F3404'         *                                    88728021
       DC      C'BSAM'             *                                    88734021
BCDBIS DC      XL3'3F3405'       *                                      88740021
       DC      C'BISAM'  '       *                                      88746021
BCDBDR DC      XL3'3F3413'                                 *            88752021
       DC      C'RELATIVE-TRACK B'                         *            88758021
       DC      C'DAM'                                      *            88764021
BCDQI    DC    XL3'3F341B'                                        41077 88770021
         DC    CL27'QISAM-FILE WITH NOMINAL KEY'                  41077 88776021
BCDSPN DC    XL3'3F3406'                                                88782021
       DC    CL6'S-MODE'                                                88788021
BCDFIL DC      XL3'3F3409'        *                                     88794021
       DC      CL9'FILE-NAME'     *                                     88800021
BCDRCN DC      XL3'3F340B'                                              88806021
       DC      C'RECORD-NAME'                                           88812021
BCDINO DC      XL3'3F3403'         *                                    88818021
       DC      CL3'I-O'            *                                    88824021
BCDTPR DC      XL3'3F340D'          *                                   88830021
       DC      CL13'TO-PROCEED-TO'  *                                   88836021
BCDPN  DC      XL3'3F340E'                         *                    88842021
       DC      CL14'PROCEDURE-NAME'                *                    88848021
BCDPNU DC      XL3'3F3418'             *                                88854021
       DC      CL15'PROCEDURE-NAME '   *                                88860021
       DC      CL9'REFERENCE'          *                                88866021
BCDUSE DC      XL3'3F340E'               *                              88872021
       DC      C'USING OR INPUT'         *                              88878021
BCDGIV DC      XL3'3F3410'                  *                           88884021
       DC      C'GIVING OR OUTPUT'          *                           88890021
BCDXTN DC  XL3'3F3412'      *                                      1926 88896021
       DC  C'NONNUMERIC '    *                                     1926 88902021
       DC  C'LITERAL'    *                                         1926 88908021
BCDIMPST DC  XL3'3F3414'                                                88914021
       DC    C'IMPERATIVE STATE'                                        88920021
       DC    C'MENT'                                                    88926021
BCDOR    DC    XL3'3F3405'         OR                             99998 88932021
         DC    C'''OR'','                                         99998 88938021
BCDBLNK  DC    XL3'3F3401'         BLANK                          99998 88944021
         DC    C' '                                               99998 88950021
BCDSEC   DC    XL3'3F340C'                                        50782 88956021
         DC    CL12'SECTION-NAME'                                 50782 88962021
         DS    0F                                                 50782 88968021
BCDMOD EQU     *                                                        88974021
       DC      XL3'3F3405'       *                                      88980021
       DC      CL5'(ERR)'        * ERROR,DETECTED IN PHASE 2            88986021
       DC      XL3'3F3405'       *                                      88992021
       DC      CL5'(GRF)'        * GROUP-FIXED                          88998021
       DC      XL3'3F3404'       *                                      89004021
       DC      CL5'(AL) '        * ALPHABETIC                           89010021
       DC      XL3'3F3404'       *                                      89016021
       DC      CL5'(AN) '        * ALPHANUMERIC                         89022021
       DC      XL3'3F3405'       *                                      89028021
       DC      CL5'(GRV)'        * GROUP-VARIABLE                       89034021
       DC    XL3'3F3404'                                                89040021
       DC    CL5'(NE) '            * NUMERIC EDITED                     89046021
       DC      XL3'3F3405'       *                                      89052021
       DC      CL5'(STR)'        * STERLING-REPORT                      89058021
       DC      XL3'3F3401'       *                                      89064021
       DC      CL5' '            * BLANK (NOT DATA-OPERAND)             89070021
       DC      XL3'3F3404'       *                                      89076021
       DC      CL5'(ED) '        * EXT. DECIMAL                         89082021
       DC      XL3'3F3405'       *                                      89088021
       DC      CL5'(EFL)'        * EXT. FLOATING                        89094021
       DC      XL3'3F3405'       *                                      89100021
       DC      CL5'(IFL)'        * INT. FLOATING                        89106021
       DC      XL3'3F3405'       *                                      89112021
       DC      CL5'(BIN)'        * BINARY                               89118021
       DC      XL3'3F3404'       *                                      89124021
       DC      CL5'(ID) '        * INT. DECIMAL                         89130021
       DC      XL3'3F3404'       *                                      89136021
       DC      CL5'(ST) '        * STERLING NON-REPORT                  89142021
       DC    XL3'3F3405'          *                                     89148021
       DC    CL5'(ANE)'            * ALPHANUMERIC EDITED                89154021
       EJECT                                                            89160021
PATCH4   DS    0F                  PATCH4 - REG10 POINT                 89166021
IKFPATCH EQU   *                                                        89172021
         B     PATCH4              BRANCH                               89178021
PATUT1   DC    XL40'0'                                                  89184021
PATUT2   DC    XL40'0'                                                  89190021
PATUT3   DC    XL40'0'                                                  89196021
PATUT4   DC    XL40'0'                                                  89202021
PATUT5   DC    XL40'0'                                                  89208021
PATUT6   DC    XL40'0'                                                  89214021
PATUT7   DC    XL40'0'                                                  89220021
PATUT8   DC    XL40'0'                                                  89226021
PATUT9   DC    XL40'0'                                                  89232021
PATUT10  DC    XL40'0'                                                  89238021
PATUT11  DC    XL40'0'                                                  89244021
PATUT12  DC    XL40'0'                                                  89250021
PATUT13  DC    XL40'0'                                                  89256021
PATUT14  DC    XL40'0'                                                  89262021
PATUT15  DC    XL40'0'                                                  89268021
*DEL                                                                    89274021
*DEL                                                                    89280021
*DEL                                                                    89286021
       DS    0F                                                         89292021
*=1    PHINIT  PHASE INITIALIZATION                                     89298021
*                                                                       89304021
*                                                                       89310021
*                           P H I N I T                                 89316021
*                                                                       89322021
*                                                                       89328021
*              INITIALIZATION OF PHASE 4                                89334021
*                                                                       89340021
*                                                                       89346021
*** SUBROUTINES CALLED                                                  89352021
*      COS,PRIME,INSERT                                                 89358021
*      GETNXT - (WHICH CALLS DIRECTLY OR INDIRECTLY                     89364021
*                  COS,COUNT,GENCRD,COPYIN,GENDAT)                      89370021
*                                                                       89376021
*                                                                       89382021
*                                                                       89388021
*                                                                       89394021
PH4    EQU   *                                                          89400021
IKFCBL40 EQU   PH4                                                      89406021
CBLIKF40 EQU   *                                                        89412021
PHINIT EQU     *                                                        89418021
         STM   RCS,RIN,DX12(R13)  SAVE REGISTERS IN PH0 SAVE AREA       89424021
       CNOP  0,4                                                        89430021
       LR    RW2,R13             SAVE ADDR OF PH0 SAVE AREA IN R2       89436021
       BALR  RW6,RA0               ADDRESSABILITY                       89442021
       USING   *,RW6                                                    89448021
         BC    UNCOND,*+NX8        BRANCH AROUND CONSTANT               89454021
       DC    A(PH4SAV)                                                  89460021
         L     R13,DX4(RW6)       SET R13 TO ADDR OF PHASE SAVE-AREA    89466021
         ST    RCS,DX12(R13)     SAVE SYSTEM RETURN ADR IN PHASE SV     89472021
         ST    RW2,DX4(R13)       PUT PTR TO PH0 SV AREA IN PHASE SV    89478021
         ST    R13,DX8(RW2)       PUT PTR TO PHASE SV AREA IN PH0 SV    89484021
       LM    RB1,RB5,ASUPER       LOAD PERMANENT BASE REGISTERS         89490021
         L     RW1,DX0(RW1)        GET COS ADDRESS                      89496021
       ST      RW1,COSADR                                               89502021
         MVC   APRYME(LX16),APRIME                                      89508021
            LR    RCS,RW1                                               89514021
            L     RW1,APH4BG                                            89520021
         BALR  RA0,RCS             INITIALIZE PRIME AREA                89526021
            DC    X'06'                                                 89532021
         LA    RCS,*+NX12                                               89538021
       ST      RCS,SVGET                                                89544021
       BAL     RCS,GET6           GET FIRST ENTITY                      89550021
       L       RW1,COSADR         INIT. AREAS DEPENDING ON COMMON       89556021
         MVC   NXTLGN(LX2),GNCTR   LGN COUNTER                          89562021
         MVC   SEGLM(LX1),SEGLMT    SAVE SEGLMT                         89568021
       DROP    RIN                                                      89574021
         XC    IR+NX1(LX2),IR+NX1                                       89580021
         XC    TR+NX1(LX6),TR+NX1                                       89586021
       LA    RW1,LASTSW                                                 89592021
       LA    RW2,FRSTSW                                                 89598021
       SR    RW1,RW2                                                    89604021
       EX      RW1,CLEAN                                                89610021
       L       RAS,APRYME                                               89616021
       LA      RW2,TAMNUM         PRIME ALL TAMER TABLES                89622021
       SR      RW3,RW3                                                  89628021
         L RW1,COSADR                                             50787 89634021
         TM    PHZSW1,XREF         XREF ?                         50787 89640021
         BZ    PHINT6              NO, BRANCH                     50787 89646021
         OI    XREFSW,MSWON        YES, INDIC WRT FILE REF ELMNT  50787 89652021
PHINT6 EQU     *                                                        89658021
       LA      RW1,ASTRNG(RW3)                                          89664021
       BALR    RCS,RAS             PRIME TAMER TABLES                   89670021
         LA    RW3,DX8(RW3)                                             89676021
       BCT     RW2,PHINT6          LOOP BACK TILL TAMNUM = 0            89682021
       LA      RW2,TAMNUM          ZERO 2ND WORD OF EACH TAMER-LIST     89688021
         LA    RW3,ASTRNG+NX4        NOW TO BE USED TO SAVE DISPLACE    89694021
PHINT8   XC    DX0(LX2,RW3),DX0(RW3)                                    89700021
         LA    RW3,DX8(RW3)                                             89706021
       BCT     RW2,PHINT8          ZERO 2ND WORD OF TAMER LIST          89712021
*                                                                       89718021
       L       RAS,ANSERT         PROVIDE ZERO-LEVEL ENTRY FOR PTRF     89724021
       L       RW1,APTFLS                                               89730021
       BALR    RCS,RAS             PROVIDE ONE SLOT FOR PTRFLS          89736021
       BALR    RCS,RAS       PROVIDE ONE MORE PTRFLS SLOT               89742021
         MVI   DSPTRF+NX1,XX0A      SET ITS DISPLACEMENT                89748021
*                                                                       89754021
       BC      UNCOND,ID3          GO TO IDENT                          89760021
*                                                                       89766021
*                                                                       89772021
ASUPER DC    A(COMON1)             IKF401                               89778021
       DC    A(COMON2)             IKF402                               89784021
       DC    A(COMON3)             IKF403                               89790021
       DC    A(COMON4)             IKF404                               89796021
       DC    A(COMON5)             IKF405                               89802021
APH4BG   DC    A(PH4BEG)                                                89808021
       DROP    RW6                                                      89814021
       EJECT                                                            89820021
IKF405 CSECT                                                            89826021
COMON5 EQU     *                                                        89832021
*=1    DATA AREA                                                        89838021
*                                                                       89844021
*                                                                       89850021
*                            D A T A AREAS                              89856021
*                                                                       89862021
*                                                                       89868021
*                                                                       89874021
       SPACE   3                                                        89880021
       DS      0F                                                       89886021
DATA   EQU     *                                                        89892021
PH4SAV DS    18F                   PH4 SAVE AREA                        89898021
TAMDEF EQU     *                                                        89904021
*                                                                       89910021
*                                                                       89916021
*                                 DEFINITIONS FOR TAMER                 89922021
*                                                                       89928021
*      THE DOUBLE-WORD FIELDS BELOW ARE USED BY THE TAMER PRIME ROU     89934021
*       TO SET UP THE TIBS AND TAMMS FOR EACH TABLE. PRIME ALSO STO     89940021
*       THE TRUE TIB ADDRESSES IN THE AL3 FIELDS. AFTER A TABLE IS      89946021
*       PRIMED PHASE 4 ZEROES THE 2ND WORD OF EACH SET AND USES ITS     89952021
*       FIRST 2 BYTES AS A SAVE AREA FOR THE TAMM DISPLACEMENT FIEL     89958021
*       EVERY ROUTINE THAT AFFECTS THE TAMM MUST UPDATE THIS SAVE-A     89964021
*       TIB-ADCON + 4. THESE DSP... FIELDS ARE USED THROUGHOUT WHEN     89970021
*       THE DISPLACEMENT OF SOME PARTICULAR ELEMENT IS WANTED.          89976021
*                                                                       89982021
*                                                                       89988021
*      INITIAL (PRIMED) TABLE LENGTH IS ASSEMBLED AT 3RD HALF-WORD      89994021
*       GROWTH FACTOR AT 4TH HALF-WORD OF EACH FIELD.                   90000021
*                                                                       90006021
*      TABLE NAMES (E.G., STRING,VARYTB) ARE EQUATED TO TIBS.           90012021
*                                                                       90018021
       SPACE   3                                                        90024021
*                                                                       90030021
*       VARIABLE-LENGTH WITH TRAILING BYTE-COUNT                        90036021
*         USED TO COLLECT OUTPUT BRFORE GENERATION                      90042021
*                                                                       90048021
ASTRNG DC      XL1'80'                                                  90054021
       DC      AL3(STRING)         ADDR OF STRING TABLE                 90060021
DSPSTR EQU     *                                                        90066021
         DC    XL2'12C'                PRIME = 300                      90072021
         DC    XL2'100'                PRIME = 256                      90078021
*                                                                       90084021
*       FIXED-LENGTH, 12-BYTE ENTRIES                                   90090021
*         HOLDS 4 BRANCH-ID'S FOR EACH 'VARYING' IN PERFORM             90096021
*                                                                       90102021
AVARYT DC      XL1'C'                                                   90108021
       DC      AL3(VARYTB)         ADDR OF VARYTBL                      90114021
DSPVAR EQU     *                                                        90120021
       DC      XL2'60'                                                  90126021
       DC      XL2'0C'                                                  90132021
*                                                                       90138021
*       FIXED-LENGTH, 2 2-BYTE ENTRIES PER LOGICAL ENTRY                90144021
*         HOLDS PN-IDS WHICH ARE ALTERED OR ARE END-OF-RANGE OF A       90150021
*          PERFORM, AND VN NUMBER CORRESPONDING TO THE PN-ID            90156021
*                                                                       90162021
AVNTBL DC      XL1'2'                                                   90168021
       DC      AL3(VNTBL)                                               90174021
DSPVNT EQU     *                                                        90180021
         DC    FL2'64'                 PRIME = 100                      90186021
       DC      XL2'10'                                                  90192021
*                                                                       90198021
*       FIXED-LENGTH, 2 2-BYTE ENTRIES PER LOGICAL ENTRY                90204021
*         HOLDS P-N ID AND CORRESPONDING VN NUMBER FOR PERFORMS         90210021
*                                                                       90216021
APFMTB DC      XL1'2'                                                   90222021
       DC      AL3(PFMTBL)                                              90228021
DSPPFM EQU     *                                                        90234021
         DC    FL2'64'                 PRIME = 100                      90240021
       DC      XL2'10'                                                  90246021
*                                                                       90252021
*       FIXED-LENGTH, 3 2-BYTE ENTRIES PER LOGICAL ENTRY                90258021
*         HOLDS PN-ID AND CORRESPONDING GN AND RPD FOR *DEBUG           90264021
*                                                                       90270021
ADBGTB DC      XL1'2'                                                   90276021
       DC      AL3(DBGTBL)                                              90282021
DSPDBG EQU     *                                                        90288021
       DC      XL2'60'                                                  90294021
       DC      XL2'06'                                                  90300021
*                                                                       90306021
*       VARIABLE-LENGTH WITH TRAILING BYTE-COUNT                        90312021
*         USED TO STACK OPERANDS FOR IF AND COMPUTE                     90318021
*                                                                       90324021
APNOUN DC      XL1'80'                                                  90330021
       DC      AL3(PNOUNT)                                              90336021
DSPNOU EQU     *                                                        90342021
         DC    XL2'12C'                PRIME = 300                      90348021
         DC    XL2'100'                PRIME = 256                      90354021
*                                                                       90360021
*       FIXED-LENGTH, 2-BYTE ENTRIES                                    90366021
*         USED TO STACK OPERATORS FOR IF AND COMPUTE                    90372021
*                                                                       90378021
APSGNT DC      XL1'2'                                                   90384021
       DC      AL3(PSIGNT)                                              90390021
DSPSGN EQU     *                                                        90396021
       DC      XL2'40'                                                  90402021
       DC      XL2'8'                                                   90408021
*                                                                       90414021
*       FIXED-LENGTH, 5-BYTE ENTRIES                                    90420021
*         USED FOR SELECTION OF TRUE AND FALSE BRANCHES IN IF           90426021
*                                                                       90432021
APTFLS DC      XL1'5'                                                   90438021
       DC      AL3(PTRFLS)                                              90444021
DSPTRF EQU     *                                                        90450021
       DC      XL2'50'                                                  90456021
       DC      XL2'20'                                                  90462021
*                                                                       90468021
*       FIXED-LENGTH  3-BYTE ENTRIES                                    90474021
*         PUSH-DOWN STACK OF GN NUMBERS OF FALSE-BRANCHES FOR IF        90480021
*                                                                       90486021
APUSH  DC      XL1'3'                                                   90492021
       DC      AL3(PSHTBL)                                              90498021
DSPUSH EQU     *                                                        90504021
       DC      XL2'50'                                                  90510021
       DC      XL2'10'                                                  90516021
*                                                                       90522021
*       VARIABLE-LENGTH WITHOUT TRAILING BYTE-COUNT                     90528021
*         HOLDS SUBSCRIPT-DEFINING STRINGS UNTIL GENERATION             90534021
*                                                                       90540021
ADFSBS DC      XL1'80'                                                  90546021
       DC      AL3(DEFSBS)                                              90552021
DSPSBS EQU     *                                                        90558021
         DC    XL2'12C'                PRIME = 300                      90564021
         DC    XL2'100'                PRIME = 256                      90570021
*                                                                       90576021
* FIXED-LENGTH 4-BYTE ENTRIES -DICT PTRS FOR KEYS FOR SEARCH ALL        90582021
* AND 1 FLAG BYTE USED TO CHECK ORDER OF TESTING KEYS                   90588021
*                                                                       90594021
AKEYTB DC    XL1'4'                                                     90600021
       DC    AL3(KEYTBL)                                                90606021
DSPKEY EQU   *                                                          90612021
       DC    XL2'30'                                                    90618021
       DC    XL2'04'                                                    90624021
*                                                                       90630021
*  FIXED LENGTH  3-BYTE ENTRIES--BYTE 1 IS PTY                          90636021
*  BYTE 2 IS PNID- PASSED FROM PHASE3. USED FOR                         90642021
*  SEGT SYNTAX CHECKING IN PERFORM.                                     90648021
*                                                                       90654021
*                                                                       90660021
*                                                                       90666021
* VARIABLE LENGTH WITHOUT TRAILING BYTE COUNT                           90672021
* HOLDS OPERANDS BEFORE 'TO','UP', OR 'DOWN' IN SET STATEMENT           90678021
*                                                                       90684021
*                                                                       90690021
ASETBL DC    XL1'80'                                                    90696021
       DC    AL3(SETTBL)                                                90702021
DSPSET   DC    XL2'C8'                 PRIME = 200                      90708021
       DC    XL2'30'                                                    90714021
       EJECT                                                            90720021
*                                                                       90726021
*                        SAVE-AREAS                                     90732021
*                                                                       90738021
* THE FOLLOWING  WORK AREAS  ARE SAVE AREAS USED BY THE                 90744021
* VARIOUS COMMON SUBROUTINES TO SAVE REGISTERS OF CALLING RTNS          90750021
SVGET  DS    6F                    USED BY GETNXT AND GETALL            90756021
SAVGEN DS    7F                    GENDAT                               90762021
SVGEN2 DS      1F                                                       90768021
SVGNCD DS      1F                                                       90774021
SVCONT DS    4F                    COUNT                                90780021
SVERR  DS    9F                    ERROR                                90786021
SVSTVB DS      2F                                                       90792021
SVSTO  DS    9F                    STOR RTNS                            90798021
SVGNAL DS      5F                                                       90804021
SVRCS4 DS      1F                                                       90810021
SVTAME DS    7F                    RTNS WHICH CALL TAMER                90816021
SVPTSG   DS    9F                                                       90822021
SVFRML DS    3F                    FORMLA                               90828021
SVPZST DS      6F                                                       90834021
SVPUTN DS      8F                                                       90840021
SVPMTY   DS    1F                                                       90846021
SVPCHG DS    2F                    PCHCNT                               90852021
SVPUPI   DS    1F                                                       90858021
SVNWNX   DS    1F                                                       90864021
SVPLGN DS    1F                    PUPLGN                               90870021
SVPUPV DS      2F                                                       90876021
SVSRCH DS    4F                    SRCHTB                               90882021
SVSTCU DS      7F                                                       90888021
SVISNO DS      1F                                                       90894021
SVISNX DS    1F                    ISNXTSNT                             90900021
SVGNXT DS      1F                                                       90906021
SVGONX DS      2F                                                       90912021
SVGLST DS      5F                                                       90918021
SVFR50 DS      4F                                                       90924021
SVMINL DS    5F                    MINLIT                               90930021
SVMKTA DS      1F                                                       90936021
EOPSV  DS    1F                                                         90942021
SVPFND DS      9F                                                       90948021
SVPFN2 DS      6F                                                       90954021
SVGNAR DS    9F                    GNARTH                               90960021
SVFNKY DS    8F                                                         90966021
SVISOP DS      3F                                                       90972021
SVISIZ DS    3F                    ISIZER                               90978021
SVGOBK DS      3F                                                       90984021
SVGTMD DS      5F                                                       90990021
SVIFRT DS      1F                                                       90996021
SVSAV  DS      1F                                                       91002021
PFMGOSV DS   1F                                                         91008021
SVISIN DS      1F                                                       91014021
SVDTOP DS    7F                    ISDTOP                               91020021
SVISPR DS      1F                                                       91026021
SVOKPR DS      5F                                                       91032021
SVRDUC DS    1F                    RDUCOP                               91038021
SVSUBS DS      15F               SAVE INDEX FOR SUBSCRIPT RTN           91044021
SVISNI   DS    2F                                                       91050021
SVOPER DS      1F                                                       91056021
SVSO14 DS      5F                  REGSAVER FOR SMALL IS IT'S           91062021
ONSVRG DS    9F                    STODUM                               91068021
SVSTO5 DS    5F                    STO5                                 91074021
SVUNTL DS      9F                                                       91080021
SVSTLP DS      7F                                                       91086021
DMSRSV DS    1F                                                         91092021
SVOKPF DS      3F                                                       91098021
SVVROP DS      4F                                                       91104021
SVGNMV DS      4F                                                       91110021
SVGNTW DS      2F                                                       91116021
SVISOK DS      5F                                                       91122021
SVOKSC DS      1F                                                       91128021
SVOKMV DS      2F                                                       91134021
SVGTPV DS      4F                                                       91140021
SVPKTB DS      5F                                                       91146021
SVIDLH DS    1F                    IDLHN                                91152021
SVPAKP DS      1F                                                       91158021
SVISFP DS      4F                                                       91164021
INDSW1   DC    X'00'                INDEX NAME SW IN PERFORM VARING     91170021
SVISTR DS      1F                                                       91176021
SVDUPS DS    7F                    DUPSS                                91182021
SVE28  DS      3F                                                       91188021
SVSTFD  DS 1F                                                           91194021
SVRSFD DS 1F                                                            91200021
SVPUPTR DS   1F                    PUPTR                                91206021
SAVEUP DS    5F                                                         91212021
RW2SAV   DC   F'0'                                                      91218021
GNSAV    DC    XL6'0'                                                   91224021
VNSAV    DC    XL8'DB000000DB000000'                                    91230021
VRBASE  DS   1F               SAVE-AREA FOR VERB'S BASE REGISTER        91236021
GNSAVE  DC  XL2'0'                 GN SAVE AREA                         91242021
RW1SAVE DS     1F             *    RW1 SAVE AREA                        91248021
RW2SAVE DS     F              *    RW2 SAVE AREA                        91254021
PSHSAVE DS   30X              SAVE AREA FOR PSHTBL ENTRIES        5961  91260021
SAVLNG DC    H'0'             LENGTH OF PSHTBL                    5961  91266021
       EJECT                                                            91272021
*                                                                       91278021
*                          MISCELLANEOUS DATA                           91284021
*                                                                       91290021
       SPACE   3                                                        91296021
*                                                                       91302021
*  ...UPDATERS...                                                       91308021
*                                                                       91314021
*                  D O N T  MAKE INSERTIONS BETWEEN ITEMS MARKED        91320021
*                    WITH *. EITHER SOME ROUTINE INDEXES THRU THEM      91326021
*                    OR THEY ARE NAMED PARTS OF A NAMED BLOCK WHICH     91332021
*                    IS SOMETIMES REFERENCED AS A WHOLE                 91338021
*                                                                       91344021
*                                                                       91350021
*                       LARGE WORK-AREAS TO HOLD OPERANDS               91356021
*                                                                       91362021
       SPACE   3                                                        91368021
PLEFT  DS      CL124              HOLDS LEFT TERM  OF STATEMENT         91374021
DMAXL  EQU     *-1                DMAX FIELD FOR LEFT TERM              91380021
MODEL  DC      XL2'0'             MODE OF LEFT                          91386021
PRIGHT DS      CL124             HOLDS RIGHT TERM  OF STATEMENT         91392021
DMAXR  EQU     *-1                DMAX FIELD FOR RIGHT TERM             91398021
MODER  DC      XL2'0'             MODE OF RIGHT                         91404021
PSTFLD DS      CL124             HSTORE-FIELD OF VERBS                  91410021
PRSULT DS      CL124             HRESULT-FIELD OF VERBS                 91416021
OPRND1 DS      64F      HOLDS OP-1 SUBSCRIPTS FOR CORRESPONDING         91422021
OPRND2 DS      64F      HOLDS OP-2 SUBSCRIPTS FOR CORRESPONDING         91428021
       ORG     *-28                DMAX FIELD FOR EXHIBIT-NAMED         91434021
SVKP35 DS      6F            *    FIELDS USED ONLY FOR EXHIBIT-NAME     91440021
SIZ35S DS      1H            *                                          91446021
CNT35S DS      1H            *                                          91452021
MAXSAVE DC   XL124'0'              HOLDS MAX OR ODO FOR SEARCH          91458021
VARY2SV DC    XL124'0'             HOLDS OP OF 2ND VARY-SEARCH          91464021
SVSRCHT DC   XL124'0'              HOLDS ID1 FOR SEARCHALL              91470021
INDVRY1 DC   XL10'0'               HOLDS INDNM1 VARY-SEARCH             91476021
KEYSAV DC    XL4'00'               USED IN SEARCHALL KEY PROC           91482021
CURENT DS      31F                STORAGE FOR CURRENT OPERAND           91488021
SAVE1OP  DS  CL124  SAVES FIRST OPND FOR MULT REC FIELDS                91494021
SAVESTOR  DS CL124  SAVES STORE FLD FOR MULT REC FIELDS                 91500021
THISOP DS      1F        GETS ADDR. OF OP-1 OR OP-2 IN CORR. STATEM     91506021
ATIB   DS      1F                 HOLDS ADDR. OF TIB WHEN VARIABLE      91512021
TRUPNT DC      A(0)               INPUT POINTER FILLED BY GETNXT        91518021
ADNTRY DS      1F             STORAGE FOR GOBACK ROUTINE                91524021
DUMVB  DC    XL3'840000'           SORT DUMMY I/P,O/P VERB SKELETON     91530021
OPEVB  DC    XL2'2103'             DUMMY OPEN                           91536021
DUMRD  DC    XL2'2005'             READ                                 91542021
RELDM  DC    XL2'3701'             RELEASE                              91548021
CLSDM  DC    XL2'2203'             CLOSE                                91554021
DMRET  DC    XL2'2A01'             RETURN                               91560021
DMWR   DC    XL2'2305'             WRITE                                91566021
SVGNS  DC    XL10'0'                                                    91572021
* GNSV1 THRU GNSV3   USED TO SAVE GNS LATER GENERATED                   91578021
GNSV1  DC    XL3'AA0000'                                                91584021
GNSV2  DC    XL3'880000'                                                91590021
GNSV3  DC    XL3'880000'                                                91596021
SVTFLN DC      F'0'                                                     91602021
       DS    0D                                                         91608021
TEMPZ  DS    1D                    CVB WORK AREA                        91614021
SVINDNM DC    XL12'0'   HOLDS INDEXNAME FOR SUBSCR                      91620021
PMSG   DC      XL3'000600'     * ERRMSG. DEFINING STRING                91626021
MSGNUM DC      XL2'0'          *                                        91632021
CARDNO DC      XL3'4'          *  2 BYTES HOLD SEQ.NUM,3RD SEVER.,P     91638021
ERPARM DC      XL2'0'       *    ERRMSG. PARAM HEADER                   91644021
       DS      CL124        *           PARAM ITSELF                    91650021
MSG3ND DC      XL4'0002CC00'      MSG CONCLUSION FOR UNDEFINED          91656021
       DS      0H          *     PUT LHN+4 AT HW BOUNDARY               91662021
LHN    DC      XL12'0'     *    HOLDS LAST LHN FROM INPUT               91668021
SAVLHN EQU     LHN                                                      91674021
THISSN DC      XL2'00'             ID OF SECTION BEING PROCESSED        91680021
PNCAR1 EQU   SAVLHN+2              1ST BYTE CHARACTERISICTS             91686021
PNCAR2 EQU   SAVLHN+3                                                   91692021
PNUM   EQU   SAVLHN+4     PROC NAME NUMBER ASSIGNED BY PH1              91698021
PNRPD  EQU   SAVLHN+6                                                   91704021
PNPTY  EQU   SAVLHN+7              PRIORITY NUMBER                      91710021
NXTSN  EQU   SAVLHN+8              HOLDS NEXT SN ID.                    91716021
THRUPN DS      0H   *         HOLDS PN WHICH HAS PERFORM BIT DURING     91722021
       DS    CL10                  IDLHN AND PRFORM.USED BY GETPVN      91728021
THRUSN EQU   THRUPN+8              USED BY GETPVN                       91734021
THRPTY EQU   THRUPN+7                                                   91740021
PFMEND DS      1H             USED BY GETPVN TO HOLD ID OF NEXT PN      91746021
ALLGT1 DC    X'3900'         FIGCON HEADER FOR ALL AN GT 1              91752021
       DS    CL124      STORAGE TO HOLD AN LITERAL ATTACHED TO ALL      91758021
SVF1   DC    XL40'0'                          USE/GIVE FILE-SORT        91764021
GNDEF  DC      XL3'880000'        SKELETON FOR LGN                      91770021
GNREF  DC      XL3'AA0000'                     RGN                      91776021
LGN    EQU     GNDEF                                                    91782021
RGN    EQU     GNREF                                                    91788021
       CNOP    2,4                                                      91794021
       DC      XL1'0'                                                   91800021
GOD1   DC      XL5'8412022402'     GO-DEPEDNING-ON FIRST                91806021
GOCTR  DC      XL2'0'             GO-DEPENDING-ON COUNTER               91812021
       DS    0F                                                         91818021
       DC    XL1'0'           (KEEP IR+1 AT H-W BOUNDARY)               91824021
IR     DC    XL3'BA0000'           INTERMEDIATE RESULT REF              91830021
     DC  XL1'0'  KEEP TR+1 AT H-W BOUNDARY                              91836021
TR   DC  XL3'BC0000'  TEMP RESULT FOR OPNDS BEFORE 'TO'-MULT REC        91842021
NXTSNT DC      XL2'0'             HOLDS ID FOR NEXT SENTENCE            91848021
       DC      XL2'0'             *   EMPTY BYTE USED FOR INSERTION     91854021
NXTLGN DC      XL2'0'             *  OF NXTLGN IN PSHTBL. NXTLGN HO     91860021
*                                 *  GN-ID GOTTEN BY PUPLGN             91866021
       DS      0D                                                       91872021
KEYSVSTR   DC    XL4'0'                                                 91878021
PTEMP    DS    1F                 LOCAL TEMPORARY STORAGE               91884021
TEMP   EQU     PTEMP                                                    91890021
TMPLAB DS      1F                  LOCAL STORAGE FOR GENLST             91896021
ERTEMP DC      XL4'0'             USED BY ERROR TO LOAD REG.            91902021
HTEMP  DS    1F                    TEMPORARY LOCAL STORAGE              91908021
TMPSP1 DC    XL4'00000000'         TEMPERARY STORAGE                    91914021
SO256  DS      1F                  COUNT MAX SORT KEY BYTES             91920021
LENGTH DS      1F                  BYTE LENGTH FROM CALCLG              91926021
       DS      0F                                                       91932021
HEX1F  DC    XL4'0000001F'   MASK, FULL WORD, LO ORDER 5 BITS           91938021
SORMSK DC      XL4'0FFFFFFF'       MASK                                 91944021
VERB   DC      XL3'840000'        HOLDS CURRENT VERB AND ELEMENT CO     91950021
       DS    0H                                                         91956021
KEYNO  DC    XL2'0'         HOLDS NO. KEYS FOR SRCHALL                  91962021
GOSEGT DC    XL3'846F01'      GO VRB FOR BRANCH TO OTHER SEGMENT        91968021
SEGLM  DC    X'0'              HOLDS SEGLMT FIELD FROM COMMON           91974021
       DS      0H                                                       91980021
SEGMNBR DC    XL2'420D'            END-OF-SEGMENT                       91986021
ALLGTMD DC    XL2'2303'     MODE FOR ALL GT 1 CHAR (AN)                 91992021
VERB44 DC      XL2'5496'     VERB FOR MSGS. INIT AT CB WORD 'FIRST'     91998021
SCLVLU DC      1H'0'               HOLDS NUMERIC DN SCALE VALUE         92004021
       DC      XL2'0'          *     (LEADING BYTE FOR SSNUMB)          92010021
SSNUMB DC      XL2'0'           *   HOLDS LAST NUMBER USED FOR          92016021
*                                           SUBSCRIPT IDENTIFIER        92022021
       DC      XL2'0'          *  HOLDS DISPL. IN DEFSBS OF START O     92028021
*                                  LAST STRING ENTERED                  92034021
LEFTSS DC      XL2'0'             SAVES DISPSS FOR OPERAND 1            92040021
TRSS   DC    XL2'0'   HOLDS DSPSBS FOR FIRST STOREFIELD WHEN            92046021
*                     TR IS USED                                        92052021
MODE   DC      XL3'FF00'     **   HOLDS MODE AND MODE-ANANLYSIS BIT     92058021
DCURR  EQU     *-1           **         DEC. PLACES OF CURRENT ENTI     92064021
CURMOD DC      XL3'0'             HOLDS MODE AND DCURR FOR 'CURENT'     92070021
RPD    DC      XL1'0'             HOLDS RPD OF SECTION BEING PROCES     92076021
PARSIZ DC      H'0'               PARAMETER SIZE COUNTER (DISPLA,EX     92082021
PARAM  DC      XL4'FA1C0000'       GLOBAL TABLE REF TYPE2 PARAM         92088021
BYTES    DC    XL2'0'              USED BY 'COUNT' FOR BYTE-COUNT       92094021
TRUREF   DC    XL4'D4000000'    DUMMY PNREF FOR THRU/ALTER/GO      2962 92100021
TPRIOR   EQU   TRUREF+1          PRIORITY NUM                      2962 92106021
TNUMER   EQU   TRUREF+2          PN NUM                            2962 92112021
PRVSCT   DC    XL2'0'         SAVES SIGN-TABLE COUNT IN IF FOR ERRO     92118021
PNOUCT   DC    XL2'0'             HOLDS NO. OF OPERANDS IN NOUNS TA     92124021
PRNLEV   DC    XL2'0'             HOLDS PAREN LEVEL FOR IF AND COMP     92130021
HILEV  DC      XL2'0'             HOLDS CURRENT HIGHEST ( LEVEL FOR     92136021
OPLEV  DC      XL2'0'       * PAREN LEVEL IN IF FOR OPERAND             92142021
ENDLEV DC      XL2'0'       *                       AND/OR              92148021
LFTLEV DC      XL2'0'       *                       LEFT TERM           92154021
RELLEV DC      XL2'0'       *                       RELATIONAL          92160021
PRVLEV EQU     ENDLEV                                                   92166021
PLOW   DC      XL2'0'          HOLDS POINTER TO LEVEL OF PTRFLS FOR     92172021
LEFTDP DC      XL2'0'             CONTAINS SIZE OF STRING FOR LEFT      92178021
*                                    TERM OF 'IF'                       92184021
MBS    DC      XL2'0'            FOR SAVE MBS BIT                       92190021
MBSCT  DC      XL2'0'            MBS COUNT                              92196021
SRCHNM DC      XL2'0'             HOLDS PN ID FOR SRCHTA ROUTINE        92202021
TEMPSP DC    XL2'0'               CHK MAJOR CODE IF LABEL REC           92208021
FIGALL DC      XL2'7500'           FIG. CONSTANT                        92214021
ALPNUM DC      XL2'3401'            ALPHANUMERIC LITERAL DATA OPERA     92220021
STO5J  DC      1H'0'              J COUNTER FOR STO5 ROUTINES           92226021
STO5VE DC      1H'0'               DISPL OF LAST VERB, STO5             92232021
STO5CT DC      XL1'0'              CONTINUOUS-SEGMENTED SW, STO5        92238021
PRLVRB DC      XL3'840003'        RELATION VERB AND COUNT. PRELAT       92244021
*                                   SUPPLIES ITS CODE                   92250021
PNDEF  DC    XL4'C7000000'         SKELETON FOR OUTPUTTING LHN          92256021
PRIOR  EQU   PNDEF+1               CONTAINS PRIORITY NUM                92262021
NUMER  EQU   PNDEF+2               CONTAINS PN ID                       92268021
PNREF  DC    XL4'D0000000'         RHN SKELETON                         92274021
RPRIOR EQU   PNREF+1               PRIORITY NUM                         92280021
RNUMER EQU   PNREF+2               PN ID                                92286021
PNREF1 DC    X'D0000001'           DUMMY PN REF FOR ALTER               92292021
VNREF  DC    XL4'DB000000'    SKELETON FOR VN AT PT OF USE              92298021
VNPTY  EQU    VNREF+1    PRIORITY NUMBER                                92304021
VNID   EQU   VNREF+2     VN NUMBER                                      92310021
VNDEF  DC    XL4'C9000000'        VN SKELETON AT PT OF DEFINITION       92316021
DVNPTY EQU   VNDEF+1                                                    92322021
DVNID  EQU   VNDEF+2                                                    92328021
RPDREF DC      XL3'240100'         VERB-INFO                            92334021
       DS    0H                                                         92340021
SAVEPN DC    XL4'D0000000'         HOLDS PN1 FOR PERFORM                92346021
SPRIOR EQU   SAVEPN+1              PRIORITY BYTE                        92352021
SNUMER EQU   SAVEPN+2              PN ID                                92358021
GNX    EQU     THRUPN             HOLDS ID OF NEXT STATEMENT,I-O VE     92364021
SAVEVN  DC   XL4'DB000000'   HOLDS RETURN VN FOR B PERFORM              92370021
SVNPTY EQU   SAVEVN+1     PTY NUM IN SAVEVN                             92376021
SVNID  EQU   SAVEVN+2    ID IN SAVEVN                                   92382021
BLNUM  DC      XL3'0'             BL WORK AREA FOR SORT                 92388021
TABADR DC      F'0'               WHERE SRCHTA STORES PN ID ADDR.       92394021
VNNUM  DC      H'0'                                   VN NUMBER OF      92400021
DBGRPD EQU     RPDREF                                                   92406021
       DS      0F                                                       92412021
PFMSAV DC      XL4'FA100000'       GLOBAL TABLE REF TYPE2 PFMSAV        92418021
ETOPTS DC    XL3'2401FF'           VERB INFO                            92424021
IRINFO EQU     ETOPTS                                                   92430021
ETOPS  EQU ETOPTS                                                       92436021
PRELAT   DC    XL1'0'         HOLDS TEST CODE FOR IF                    92442021
SETSVD DC    XL2'0'            HOLDS SAVED DISPL FROM BEG SETTBL        92448021
MSKOPT DC      XL1'0'             HOLDS OPTION CODE FOR I-O VERBS       92454021
BCDMBS DC      XL3'3F3401'        DIGIT FOR ERROR MSG        *          92460021
       DC      CL1'0'                                         *         92466021
NXTCRD DC      XL3'810000'        CARD NO. FOR VERB ANALYZER            92472021
       DS      0F             * 8-BYTE EVAL STRING                      92478021
EVAL   DC      XL3'841500'        *   EVAL VERB                         92484021
        DC   XL2'2405'        *    INFO-HEAD                            92490021
DMAX   DC      XL1'0'         *                                         92496021
DRSULT DC      XL2'0000'      *    2ND BYTE IS ROUND OPTION             92502021
        DC   XL2'0'           *    TR NO.                               92508021
SDMAX  DC    XL1'0'                                                     92514021
PRN35  DC      XL3'350100'        PAREN FOR EXHIBIT NAMED               92520021
GODM   DC    XL3'841301'           GO-DEP-MIDDLE                        92526021
SSVERB DC    XL3'843900'           SUBSCRIPT VERB                       92532021
ENDUSE DC      XL3'840000'        CODE IS SUPPLIED BY USE ANALYZER      92538021
FILEREF  DC    XL4'C8000000'       FILE REF FOR  XREF             50787 92544021
FILEREF1 EQU   FILEREF+1                                          50787 92550021
SUBTRVB DC   XL3'840105'             VERB CODE FOR SUBTRACT             92556021
DICTP  DC      XL4'FE000000'      DICT POINTER FOR ERROR MESSAGES       92562021
WHENGN DC    XL3'880000'           PRECEDES WHEN COND                   92568021
SVGN1  DC    XL3'880000'           1ST GN GONE TO IN SEARCH,SRCHALL     92574021
SVGN2  DC    XL3'AA0000'           POINTS TO IMP STATEMENT AFTER        92580021
*                                  AT END IN SRCH,SRCHALL               92586021
SVGN3  DC    XL3'AA0000'           POINTS TO 1ST WHEN IN SRCH,SRCHA     92592021
WHENVB DC    XL3'845E03'           BEGINING OF WHEN IN SEARCH ALL       92598021
WHENEQU DC   XL3'846D02'           EQUATE IN SEARCH ALL                 92604021
ENDWHEN DC    XL3'845F01'          END OF WHEN IN SEARCH ALL            92610021
SS1SV  DC    XL40'00'              SPEC SUBSCR PROC-SEARCHALL           92616021
IFGTIND DC   XL3'846803'           IF GREATER (INDEX NAME)              92622021
SETP2  DC   XL3'846002'            P2 TXT FORMAT OF SET FORMAT1         92628021
SETUP  DC    XL3'846102'           SET UP BY (FORMAT 2)                 92634021
SETDWN DC    XL3'846E02'           SET DOWN BY (FORMAT 2)               92640021
STRCNT DS      2F                 SAVES TAMM DISPLACEMENTS              92646021
NUMLT1 DC      XL5'320301001C'     NUMERIC LITERAL 1                    92652021
       DS    0H                                                         92658021
SORPX1 DC    XL2'0000'             DISP OF I/P DUMMY, SORT              92664021
SORPX2 DC    XL2'0000'             DISP OF O/P DUMMY, SORT              92670021
FRSTPN DC      XL2'0000'           HOLD 1ST PN ID AFTER END DECLARA     92676021
MANDNM DC    XL2'6003'   MODE OF ALPHANUMERIC DNM                       92682021
PGMBRK DC    XL2'0'                PROGRAM BEAK SAVE-CELL AND SWITC     92688021
PTYCEL DC    XL1'0'   HOLDS PTY NUM FOR CURRENT SECTION                 92694021
       EJECT                                                            92700021
*                                                                       92706021
*                                  SWITCHES                             92712021
*                                                                       92718021
FRSTSW EQU   *                                                          92724021
       DS      0H                                                       92730021
DMAXSW DC      XL2'0'             WHEN NOT = 0, DMAX IS NOT COMPUTE     92736021
PFNDIS DC      XL1'0'             TRIGGERS MSG IN 'IF' WHEN 'IS'        92742021
*                                     WITHOUT A RELATIONAL              92748021
PNDREL   DC    XL1'0'         USED IN IF WHEN IMPLIED SUBJECT IS LE     92754021
PRTURN   DC    XL1'0'         USED BY IF IN ANALYZING IMPLIED RELAT     92760021
PSKPGO   DC    XL1'0'              SWITCH TO SAY STOP OR GO WAS LAS     92766021
RECSW  DC X'0' SET WHEN ANOTHER STORE FIELD FOLLOWS LAST IN ARITH       92772021
STFLD1  DC X'0'     SET WHEN FIRST STORE FIELD PUT IN PSTFLD            92778021
RNDSW  DC    X'0'                  KEEP TRACK'ROUNDING'ADD SERIES       92784021
LITSW  DC    X'0'    IF LITERAL 1ST OP IN ADD SERIES                    92790021
SIZERROR   DC X'0'       SW SET BY ISIZER IF RECSW IS ON                92796021
GIVESW DC    X'0'    SET ON WHEN 'GIVING' STOREFIELD HAS BEEN FOUND     92802021
IFBYPS DC      XL1'0'             DETERMINES ACTION IN PFINDL           92808021
GENRED DC      XL1'1'     ERROR SW = 0 WHEN VERB STATEMENT INCOMPLE     92814021
NEXTIN   DC    XL1'0'      SWITCH FOR GETNXT SAYING GOTTEN WAS SAVE     92820021
PFNDOP DC      XL1'0'             USED BY FORMLA TO SAY OPERAND FOU     92826021
PMTYSW DC      XL1'0'             TELLS PUTSGN TO REDUCE FORMULA TO     92832021
*                                    SINGLE OPERAND                     92838021
PNEGSW DC      XL1'0'             USED BY IF                            92844021
PNOTSW DC      XL1'0'             USED BY IF                            92850021
PLOGIC DC      XL1'0'             WHEN OFF CERTAIN ROUTINES BYPASS      92856021
*                                 SPECIAL IF-PROCESSING                 92862021
CORRSW DC      XL1'0'              ON IF IN CORRESPONDING SERIES        92868021
ADDSW  DC      XL1'0'             ERROR SW FOR ADD VERB                 92874021
ALTSW1 DC      XL1'0'              USED BY ALTER                        92880021
ALTSW2 DC      XL1'0'              USED BY ALTER                        92886021
GOSW1  DC      XL1'0'              SWITCH FOR VERB GO ROUTINE           92892021
UMINSW DC      XL1'0'             USED BY FORMLA TO PROCESS MINUS S     92898021
SUBADV DC    XL1'0'                ON IF BEFORE SUBSTITUTED             92904021
EOPSW  DC    XL1'0'      IF ON, AT EOP PRESENT                          92910021
EXMSW1 DC      XL1'0'              USED IN EXAMINE CHECKING CHAR. 1     92916021
EXMSW2 DC      XL1'0'              SWITCH ON IF DN IS NUMERIC           92922021
EXMSW3 DC      XL1'0'              SWITCH ON IF DN IS OTHER DISPLAY     92928021
RW5SW    DC    X'00'               BUFFER PTR RESETSW (SET)             92934021
TFMSW1 DC      XL1'0'              ON , COBOL WORD MISSING              92940021
TREDSW DC      XL1'0'             FOR TRANSFORM EXT. DEC.               92946021
MOVSW1 DC      XL1'0'              ON, OPERAND 2 WAS FOUND              92952021
LV88SW DC      XL1'0'             FOR IF                                92958021
SIGNSW DC      XL1'0'             FOR IF                                92964021
CLASSW DC      XL1'0'             FOR IF                                92970021
NOTRSW DC      XL1'0'             ERRSW FOR 'NOT' BEFORE RIGHT TERM     92976021
NOTRAL DC      XL1'0'             INDICATES THAT A TAMER TABLE LACK     92982021
*                                  THE TRAILING BYTE-COUNT              92988021
UGSW   DC    XL1'0'                USING/GIVING  SORT                   92994021
SOROPT DC    XL1'0'                USING/GIVING  SORT                   93000021
OSW    DC    XL1'0'                ON IF OUTPUT HAS BEEN GENR'ED        93006021
OP1SS  DC      XL1'0'              USED FOR 'CORRESPONDING' STATEME     93012021
OP2SS  DC      XL1'0'                .   .     .     .          .       93018021
DRYRUN DC      XL1'0'             SAYS THIS IS SOURCE-FORM OF 'CORR     93024021
OPSSSW DC      XL1'0'             TELLS SUBSCR NOT TO USE INPUT FOR     93030021
INDSW  DC    X'0'    TURNED ON IF DNM INDEXED BY INDNM                  93036021
MININDEX DC  X'0'   ON IF DNM IND BY INDNM MINUS NUMERIC LITERAL        93042021
ENTRSW DC      XL1'0'              DISTINGUISHES CALL FROM ENTRY        93048021
ZERFOUN DC   XL1'0'                ON IF KEY WAS NOT TESTED             93054021
EXHBCS DC      XL1'0'              EXHIBIT 'CHANGED' OR 'NAMED' SW      93060021
EXHBS1 DC      XL1'0'              EXHIBIT SW                           93066021
CONDSW  DC     XL1'0'         TELLS IDENT VERB (NOT . OR ELSE) NEED     93072021
TRUVRB DC      XL1'0'         TELLS ISTRUV, CONDITION IS ILLEGAL        93078021
VARYSW DC      H'0'        TRANSFER VECTOR SWITCH FOR OPTIONS 1-3 O     93084021
*                                  OPERANDS 1-3 OF OPTION 4 IN PERF     93090021
SORTSW DC      XL1'0'             WHEN ON TELLS PERFORM TO RETURN T     93096021
*                                      SORT ANALYZER                    93102021
THRUSW   DC    XL1'0'            SWITCH FOR THRU OPTION            2962 93108021
INTGSW DC      XL1'0'             TELLS OKPFOP INTEGER IS NEEDE         93114021
PERFSW DC      XL1'0'             TELLS 'IF' TO RETURN TO PERFORM       93120021
ERVASW DC      XL1'0'             ONCE-ONLY ERROR SWITCH FOR PERFOR     93126021
PRERSW DC      XL1'0'       ONCE-ONLY ERR SW FOR PARENS IN IF           93132021
INTOSW DC      XL1'0'         ON SAYS DN OPTION FOR READ,WRITE,REWR     93138021
EXHBNS DC      XL1'00'             NAMED SWITCH FOR EXHIBIT             93144021
SO12SW DC    XL1'00'               SORT 12-COUNT AND MISC SW            93150021
OPTSW  DC      XL1'0'             USED BY OPEN FINDING INPT,OUTPT,I     93156021
SENDSW DC      XL1'0'             ON SAYS STRING CONTAINS STUFF TO      93162021
SKIPSW DC      XL1'0'             ON SAYS DONT STORE IN STRING          93168021
MSGSW  DC      XL1'0'             ON SAYS EMIT MSG ONLY ONCE PER LO     93174021
PMSGSW EQU     MSGSW                                                    93180021
ATNDFND DC   XL1'0'                USERS 'AT END'-SEARCH                93186021
SETOO  DC    XL1'0'                                                     93192021
SETSW    DC    X'00'               SET ROUTIN SW                  58940 93198021
ONESET DC    XL1'0'                IF ON,AT LEAST 1 SET COMPLETED       93204021
VRYIND2    DC  XL1'0'                                                   93210021
USINDX1  DC    XL1'0'                                             43954 93216021
TWOVRY     DC  XL1'0'                                                   93222021
XREFSW   DC    XL1'0'              SW TO WRITE FILE REF ELEMENT   50787 93228021
GOSW   DC    XL1'0'                LAST WAS GO                          93234021
WHENSW     DC  XL1'0'                                                   93240021
SEARCHSW DC  XL1'0'                SEARCH IS IN CONTROL                 93246021
SATOS  DC   XL1'0'                 SRCHALL TO SEARCH                    93252021
SRCHALSW DC  XL1'0'                IN SEARCH ALL                        93258021
NOKEY   DC   XL1'0'                TERM OTHER THAN KEY FOUND SRCHAL     93264021
KEYFND DC    XL1'0'                KEY  FND IN SRCHALL-WHEN             93270021
FLKEY  DC    XL1'0'                KEY  FL PT IN SRCHALL                93276021
SPSALL DC    XL1'0'                                                     93282021
OPCLSW DC      XL1'0'             ON TELLS ISOKFL VERB IS OPEN OR C     93288021
REMSW  DC    XL1'0'                INDICATES IN DIVIDE REMAINDER        93294021
GNOUSW DC      XL1'0'      SET ON BY DISPLA,EXHIBT TO SAY PNOUNS MA     93300021
*                             HAVE SOME OUTPUT                          93306021
HOLDSW DC      XL1'0'     COUNTS 'HOLD' STATEMENTS IN A RANDOM DECL     93312021
STO5SW DC      XL1'0'              STRING SEGMENTATION                  93318021
TRCUSW DC      XL1'0'             INHIBITS TRACING SN OF A 'USE'        93324021
VRYSS  DC    XL1'0'          LETS SRCH KNOW VARYING OP WAS SSED         93330021
TEMPSW DC      XL1'0'             LOCAL TEMPORARY SWITCH                93336021
SWRONL DC      XL1'0'    WRITE SETS TO TELL ISDTOP NOT TO REJECT A      93342021
*                          FROM A WRITE-ONLY RECORD. ISDTOP SETS OF     93348021
FLTST  DC    XL1'0'           TO SEE IF KEY IN SRCHAL FLPT OR STERL     93354021
OKMVSW DC    XL1'0'                                                     93360021
SPSEGT DC    X'0'             USED IN SEGT SYNTAX CHECKING-PERF         93366021
SEGSW  DC   X'0'   TELLS IDLHN TO GO BACK AND GENR INIT FOR SEGT        93372021
SWDBUG DC      XL1'0'             MARKS START OF DEBUG PACKET           93378021
CLEVMSG DC   XL1'0'   SW IN ISOKKMV TO DETERMINE EXIT                   93384021
IFERSW DC      XL1'0'             TO AVOID CASCADING MESSAGES IN IF     93390021
VRY1ST   DC     XL1'0'     SWITCH FOR 1ST VARY IN PERFORM               93396021
KEY10  DC    XL1'0'      SIGNALS SRCHALL 1ST KEY NOT PROCESSED YET      93402021
SSKYSV DC    XL1'0'           TELLS SRCHALL NO. SS FOR KEY 1            93408021
KEY1   DC    XL1'0'      TELLS SUBSCR SPEC PROC FOR 1ST SRCHALLKEY      93414021
SRCHKEY DC    XL1'0'       TELLS SUBSCR SRCHALL KEY OTHER THAN FIRST    93420021
SETRIN DC    XL1'0'                DOES RIN PT TO BUF OR SETTBL         93426021
ONSIZER  DC  XL1'0'                REM. ON SIZE ERROR SPEC IN DIV       93432021
GNDEFSW  DC  XL1'0'                MORE THAN 1 GN NEEDED                93438021
MASK    DC   XL1'0'                USED IN OC INST. TO TURN ON          93444021
*                                  PROPER SWITCH                        93450021
FLPTSW  DC     XL1'0'         FLOATING POINT SWITCH                     93456021
DNMODE  DC     XL1'0'         MODE OF DATA NAME                         93462021
DIVSW   DC     XL1'0'         SWITCH FOR DIVIDE                         93468021
IFSW1  DC    X'00'            IF SWITCH, IT REMAINS ON TILL EOS   5961  93474021
LASTSW EQU   *                                                          93480021
GOTTEN DS      2C          SYMBOLIC NAME FOR 1ST 2 BYTES OF INPUT       93486021
*                                                                       93492021
*                                                                       93498021
*                                                                       93504021
*                                                                       93510021
*                                                                       93516021
P4PTCH EQU     *                                                        93522021
*                                                                       93528021
LASTIN EQU     DATA+4095                                                93534021
*                                                                       93540021
*                                                                       93546021
*                                                                       93552021
*                                                                       93558021
*                                                                       93564021
       END     PHINIT                                                   93570021
