*$MODULE       PHASE2                                                   00006021
         IHBCOB                                                         00012021
IKF200   CSECT                                                          00018021
         USING COS,R1                                                   00024021
       ENTRY PH2                                                        00030021
ENTPH2   DC    C'IKFCBL20'                                              00036021
         DC    C'B'                                                     00042021
         DC    X'1C'                                                    00048021
*                                                                       00054021
*                                                                       00060021
*                                                                       00066021
*                                                                       00072021
*                                                                       00078021
*                                                                       00084021
*                                                                       00090021
*                                                                       00096021
*                                                                       00102021
*                                                                       00108021
*=3                                                                     00114021
*                                                                       00120021
*                                                                       00126021
*                                                                       00132021
*TITLE                                                                  00138021
*                                                                       00144021
*   'IEGCBL20' -PHASE 2                                                 00150021
*                                                                       00156021
*STATUS                                                                 00162021
*                                                                       00168021
*   CHANGE LEVEL 000                                                    00174021
*                                                                       00180021
*FUNCTION/OPERATION                                                     00186021
*                                                                       00192021
*   CHECK SYNTAX OF DATA DIVISION ENTRIES, COMPUTES THE ATTRIBUTES      00198021
*   ADDRESSING PARAMETERS OF THESE ENTRIES, AND STORES THEM IN A        00204021
*   DICTIONARY WHERE THEY CAN BE REFERRED TO BY THE LATER PHASES WH     00210021
*   DEAL WITH THE PROCEDURE DIVISION. PHASE 2 ALSO FORMATS THE DATA     00216021
*   CONTROL BLOCKS (DCB), DATA EVENT CONTROL BLOCKS (DECB), AND BUF     00222021
*   FOR FILES  SPECIFIED IN THE FILE SECTION.                           00228021
*                                                                       00234021
*                                                                       00240021
*   THE FUNCTION/OPERATION AND GENERAL CONSIDERATION OF THE ACCESS      00246021
*   ARE DESCRIBED IN DETAIL IN PLM AND PHASE 1 LISTING.                 00252021
*                                                                       00258021
*ENTRY POINTS                                                           00264021
*                                                                       00270021
*        PH2                                                            00276021
*                                                                       00282021
*INPUT                                                                  00288021
*                                                                       00294021
*   'SYSUT3'-DATA IC TEXT AND E-TEXT FROM 'IEGCBL10' (PHASE 1)          00300021
*                                                                       00306021
*OUTPUT                                                                 00312021
*                                                                       00318021
*   'SYSUT4'- DATA-TEXT FOR 'IEGCBL60'(PHASE 6)                         00324021
*             E-TEXT                                                    00330021
*   'SYSUT2'- P0-TEXT FOR OBJECT TIME VARIABLE LENGTH COMPUTATIONS      00336021
*             FOR OCCURS DEPENDING ON ITEMS                             00342021
*                                                                       00348021
*EXTERNAL ROUTINES                                                      00354021
*                                                                       00360021
*        'IEGCBL00' (PHASE 0)-LINK TO I/O AND INTERPHASE COMMON REG     00366021
*        'PRIME'              *                   PREPARE TABLE         00372021
*        'INSERT'             *TABLE-HANDLING*    PROVIDE SPACE         00378021
*        'TABREL'                                 RELEASE TABLE         00384021
*                                                                       00390021
*EXITS-NORMAL      VIA 'IEGCBL00' TO 'IEGCBL30' (PHASE 3)               00396021
*                            L      1,=A(IEGCBL00)     L   1,COSADR     00402021
*                            BALR   0,1                                 00408021
*                            DC     X'0A'                               00414021
*                                                                       00420021
*EXITS-ERROR       IF UNTRANSLATABLE  DATA IC-TEXT INPUT GO TO          00426021
*                  NORMAL EXIT.                                         00432021
*                                                                       00438021
*                                                                       00444021
*TABLES/WORKAREAS                                                       00450021
*                                                                       00456021
*   TABLES DESCRIBED UNDER TAMER TABLES IN CONSTANTS SECTION OF         00462021
*   LISTING                                                             00468021
*   WORKAREAS DESCRIBED UNDER PH2SAV                                    00474021
*                                                                       00480021
*ATTRIBUTES                                                             00486021
*                                                                       00492021
*                                                                       00498021
*NOTES                                                                  00504021
*                                                                       00510021
*                                                                       00516021
*        1.  ALL ROUTINES USE  REGISTER 15  FOR BASE REGISTER.          00522021
*        2.  ALL INTRA-PHASE ROUTINES CALLED BY-                        00528021
*                                  L         15,A(CALLED ROUTINE)       00534021
*                                  BALR      14,15                      00540021
*                                  L         15,A(CALLER)               00546021
*        3.  PHASE SAVEAREA AND CONSTANTS UNDER REGISTER 13.            00552021
*        4.  CALLED ROUTINE SAVES CALLER'S  REGISTERS.                  00558021
*                                                                       00564021
*   PHASE 2 USES THE ACCESS TO MAKE ENTRIES FOR DATA-NAMES              00570021
*   INTO THE DICTIONARY AND TO LOCATE DATA-NAMES ALREADY IN THE         00576021
*   DICTIONARY.                                                         00582021
*                                                                       00588021
PH20     TITLE 'IKFCBL20'                                               00594021
*                                                                       00600021
*  EQUATES FOR COMMON AREA CELLS.                                       00606021
         SPACE 1                                                        00612021
* STERLING REPORT PICTURE SUBROUTINE  EQUATES FOR INFORMATION BYTE      00618021
SFBWZ    EQU   X'80'                                                    00624021
SSDELC   EQU   X'40'                                                    00630021
SLDELC   EQU   X'20'                                                    00636021
SLNOTP   EQU   X'10'                                                    00642021
         SPACE 1                                                        00648021
*  LITERAL PREFIX CODES                                                 00654021
ANCODE   EQU   X'01'                                                    00660021
FIGCON   EQU   X'FF'                                                    00666021
HEXCOD   EQU   X'00'                                                    00672021
STEPVB   EQU   X'42'                                                    00678021
RCOM     EQU   11                                                       00684021
R0       EQU   0                                                        00690021
R1       EQU   1                                                        00696021
R2       EQU   2                                                        00702021
R3       EQU   3                                                        00708021
R4       EQU   4                                                        00714021
R5       EQU   5                                                        00720021
R6       EQU   6                                                        00726021
R7       EQU   7                                                        00732021
R8       EQU   8                                                        00738021
R9       EQU   9                                                        00744021
R10      EQU   10                                                       00750021
R11      EQU   11                                                       00756021
R12      EQU   12                                                       00762021
R13      EQU   13                                                       00768021
R14      EQU   14                                                       00774021
R15      EQU   15                                                       00780021
NEWMSG   EQU   300                DUMMY NEW ERROR MESSAGE               00786021
NOTLO    EQU   11                                                       00792021
UNCOND   EQU   15                                                       00798021
HI       EQU   2                                                        00804021
LO       EQU   4                                                        00810021
EQ       EQU   8                                                        00816021
NOTHI    EQU   13                                                       00822021
NOTEQ    EQU   7                                                        00828021
OV       EQU   1                                                        00834021
POS      EQU   2                                                        00840021
NEG      EQU   4                                                        00846021
ZERO     EQU   8                                                        00852021
NOTOV    EQU   14                                                       00858021
NOTPOS   EQU   13                                                       00864021
NOTNEG   EQU   11                                                       00870021
ONES     EQU   1                                                        00876021
MIXED    EQU   4                                                        00882021
NOTONE   EQU   14                                                       00888021
NOTMXD   EQU   11                                                       00894021
NOTZER   EQU   7                                                        00900021
NOP      EQU   0                                                        00906021
COPYEQ   EQU   57                                                       00912021
EOCPEQ   EQU   58                                                       00918021
FXLEN    EQU   16                  FIXED LENHTG    = 00010000           00924021
VLC      EQU   64                  VARIABLE LENGTH = 01000000           00930021
FILSEC   EQU   7                   FILE SECTION    = BIT PATTERN =      00936021
WKSSEC   EQU   4                   WK-STORAGE SECT = BIT PATTERN 10     00942021
AM       EQU   3                                                        00948021
SYNCH    EQU   1                                                        00954021
RERUNC   EQU   2                                                        00960021
BSCODE   EQU   X'0B'               BSAM TABLE PTR. CODE                 00966021
RSDUPC EQU   X'96'                COUNT+MASCD FOR LD-REPORT             00972021
TOTLTBL  EQU   TIB2-COS                                                 00978021
REORGTBL EQU   TIB3-COS                                                 00984021
APPTBL   EQU   TIB4-COS                                                 00990021
SMRCDTBL EQU   TIB5-COS                                                 00996021
VALGRP   EQU   TIB6-COS                                                 01002021
PIOTBL   EQU   TIB7-COS                                                 01008021
CHKTBL   EQU   TIB8-COS                                                 01014021
OD2TBL   EQU   TIB9-COS                                                 01020021
GPLSTK   EQU   TIB10-COS                                                01026021
TIBR     EQU   TIB11-COS                                                01032021
TIBP     EQU   TIB12-COS                                                01038021
RNMTBL   EQU   TIBP                                                     01044021
RDFSTK   EQU   TIBR                                                     01050021
LABTBL   EQU   TIB13-COS                                                01056021
RCKTBL   EQU   TIB14-COS                                                01062021
KEYTBL   EQU   TIB15-COS                                                01068021
KEYRAN   EQU   TIB16-COS                                                01074021
BSAMTB   EQU   TIB17-COS                                                01080021
TRKTBL   EQU   TIB18-COS                                                01086021
SAMETB   EQU   TIB19-COS                                                01092021
QRTN     EQU   TIB21-COS                                                01098021
QITBL    EQU   TIB22-COS                                                01104021
QFILE    EQU   TIB23-COS                                                01110021
QVAR     EQU   TIB24-COS                                                01116021
QSBL     EQU   TIB25-COS                                           4758 01122021
INDKEY   EQU   TIB31-COS                                                01128021
TTLDTBL  EQU   TIB32-COS          TOTALED AREA TABLE TIB                01134021
VALTRU   EQU   TIB33-COS                                                01140021
KEYTAB   EQU   TIB34-COS                                                01146021
RUNTBL   EQU   TIB35-COS                                                01152021
       ACCESS   2                                                       01158021
       EJECT                                                            01164021
         EJECT                                                          01170021
         EJECT                                                          01176021
*                                                                       01182021
*                                                                       01188021
*=1    PHASE 2  ENTRY POINT AND INITIALIZATION                          01194021
IKF201 CSECT                                                            01200021
       USING PH2SAV,R13                                                 01206021
PH2    EQU   *                                                          01212021
IKFCBL20 EQU   PH2                                                      01218021
BEGIN    STM   R14,R12,DX12(R13)  SAVE REGISTERS IN PH0 SAVE AREA       01224021
       CNOP  0,4                                                        01230021
       LR    R2,R13             SAVE ADDR OF PH0 SAVE AREA IN R2        01236021
       BALR  R15,R0                MOVE ADDRESS OF BEGADC TO R15        01242021
       USING *,R15                                                      01248021
BEGADC   BC    M15,DX8(R15)   BRANCH AROUND ADCON TO LOAD INST          01254021
       DC    A(PH2SAV)                                                  01260021
         L     R13,DX4(R15)      SET R13 TO ADDR OF PHASE  SAVE AREA    01266021
         ST    R14,DX12(R13)     SAVE SYSTEM RETURN ADR IN PHASE SV     01272021
         ST    R2,DX4(R13)       PUT PTR TO PH0 SV AREA IN PHASE SV     01278021
         ST    R13,DX8(R2)       PUT PTR TO PHASE SV AREA IN PH0 SV     01284021
         L     R1,DX0(R1)           R1= A(PHASE 0)                      01290021
         ST    R1,COSADR           SAVE A(PHASE 0)                      01296021
         L     R2,ADPARS                                                01302021
         ST    R1,DX0(R2)           STORE A(PHASE 0) IN ACCESS CELL     01308021
         MVC   BPRIME(LX20),APRIME                                      01314021
         LA    R3,ADPIOT           PUT TIB ADCONS                       01320021
         LA    R4,DX5              IN PHASE2                            01326021
BEGINA   LR    R2,R1                   FOR ALL                          01332021
         A     R2,DX0(R3)                  TABLES                       01338021
         ST    R2,DX0(R3)                   THAT                        01344021
         LA    R3,DX4(R3)                    ARE NOT                    01350021
         BCT   R4,BEGINA                      PRIMED                    01356021
         ST    R15,TSAVER                                               01362021
         L     R15,BINTAC          INITIALIZE ACCESS FOR PHASE 2        01368021
         BALR  R14,R15             LINK TO BEGADC                       01374021
         L     R15,TSAVER                                               01380021
         LR    RCOM,R1                                                  01386021
        L  R1,BEGPH2                                                    01392021
        BALR  R0,RCOM              LINK TO RCOM                         01398021
        DC  X'06'                                                       01404021
         DROP  R1                                                       01410021
         USING COS,RCOM                                                 01416021
         L     R3,ONE              LENGTH OF LISTING A-TEXT             01422021
         LA    R2,ONE+NX3          ADDR OF LISTING A-TEXT               01428021
         BALR  R0,RCOM             END OF A-TEXT INDICATOR              01434021
         DC    X'14'               ON FILE 4                            01440021
         CLI   COMMAD,XX4B                                              01446021
         BC    NOTEQ,BEGINB        NO                                   01452021
         MVC   CONCOM(LX1),COMMAD                                       01458021
         MVC   CONPER(LX1),COMMAD+NX1                                   01464021
         MVI   BPICTR+NX107,XX08            AND BPICTR (SCAN)           01470021
         MVI   BPICTR+NX75,XX10                                         01476021
*                                                                       01482021
* CHECK TO SEE IF CURRENCY SIGN OTHER THAN DOLLAR SIGN                  01488021
*                                                                       01494021
BEGINB   CLI   CURSGN,XX5B          CURRENCY SIGN                       01500021
         BE    BIGINB              YES, IT IS $                         01506021
         MVC   BRATAB(LX1),CURSGN   CHANGE $                            01512021
         MVI   BPICTR+NX91,XXFF     MAKE $ SIGN ILLEGAL                 01518021
         SR    R1,R1                                                    01524021
         IC    R1,CURSGN                                                01530021
         MVI   SRANO,XX00          RESET SD SAME REC AREA NO            01536021
         A     R1,ABPICT           POINT TO ENTRY IN TABLE              01542021
         MVI   DX0(R1),XX10         CURRENCY SIGN                       01548021
BIGINB   MVI   SECTSW,XX02          INIT SECTSW TO 2 FOR FILE SECTION   01554021
         XC    PTBLSW(LX3),PTBLSW   CLEAR TABLE SW                      01560021
         XC    PRMSW(LX1),PRMSW                                         01566021
         MVI   COPYSW,XX00          CLEAR SWITCH                        01572021
         XC    LID(LX24),LID                                            01578021
         XC    RPTRDF(LX3),RPTRDF                                       01584021
         MVI   NXTLEV,XX00          SET NEXT LEVEL NUMBER TO ZERO       01590021
         MVI   PLEVNM,XX00          SET PCI LEVEL NUMBER TO 0           01596021
         MVI   SRCELN,XX00          SET CURRENT LEVEL NUMBER TO 0       01602021
         MVI   PCOUNT,XX00                                              01608021
         TM    PH1BYTE,INITBIT    ANY CORE-INDEX IN PROGRAM?            01614021
         BZ    BIGINB1            NO.                                   01620021
         L     R1,LOCCTR          YES.                                  01626021
         LA    R1,INITSIZE(R1)          ADD SIZE OF CORE-IDX RTN  41095 01632021
         ST    R1,LOCCTR          LOCCTR=SIZE OF INIT1                  01638021
BIGINB1  LH    R1,BLCTR                                                 01644021
         A     R1,ONE                     ONE (FIRST BL)                01650021
         STC   R1,BASLOC+NX2                                            01656021
         MVC   BLLCTR(LX2),TWO+NX2  BLL STARTS FROM 3                   01662021
         STH   R1,FDBL                                                  01668021
         MVC   APAF(LX7),BASLOC     INITIALIZE ADDR. PARAM. FIELD       01674021
         MVC   FAPAF(LX7),APAF                                          01680021
         XC    MAXIM(LX8),MAXIM                                         01686021
         XC    SDAPAF(LX7),SDAPAF                                       01692021
         XC    FDDICT(LX4),FDDICT                                       01698021
         XC    LID(LX24),LID                                            01704021
         LA    R1,GPARAM           CALL TAMER                           01710021
         L     R15,BPRIME                  GROUP LENGTH STACK           01716021
         BALR  R14,R15                         TABLE                    01722021
         L     R1,GPARAM                                                01728021
         L     R15,BINSRT          CALL TAMER                           01734021
         BALR  R14,R15                  TO INSERT                       01740021
         L     R15,TSAVER                 ZERO ENTRY INTO               01746021
         XC    DX0(LX36,R2),DX0(R2)          GROUP LENGTH STACK         01752021
         ST    R2,MTEMP                                                 01758021
         XC    DICND2(LX4),DICND2                                       01764021
         L     R10,AOD2TB          GET A(OD2TBL'S TIB)                  01770021
         CLC   DX1(LX3,R10),ZEROS    IS A(TAMM) FIELD ZERO              01776021
         BE    BEGINC             PROCESS CHKPT                         01782021
         L     R10,DX0(R10)         NO, CHECK TAMM DISP. FOR 0          01788021
         CLC   ZEROS(LX2),DX4(R10)                                      01794021
         BE    BEGINC             PROCESS CHKPT                         01800021
         OI    PTBLSW+NX1,XX08      SET PRIMED TABLE SW ON              01806021
BEGINC   L     R10,ACHKPT                                               01812021
         CLC   DX1(LX3,R10),ZEROS                                       01818021
         BE    INITRD              = 0,GO TO INITRD                     01824021
         L     R10,DX0(R10)                                             01830021
         CLC   ZEROS(LX2),DX4(R10)                                      01836021
         BE    INITRD              = 0,GO TO INITRD                     01842021
         OI    PTBLSW+NX1,XX02     TABLE EXISTS                         01848021
         LH    R6,DX4(R10)                                              01854021
CHKPT    L     R10,DX0(R10)                                             01860021
         N     R10,MK0932                                               01866021
         AR    R6,R10                                                   01872021
CHKPT0   L     R9,LOCCTR          GET NEXT LOCCTR VALUE                 01878021
         CR    R10,R6                                                   01884021
         BNL   INITRD             EOT                                   01890021
         CLC   DX10(2,R10),ZEROS                                        01896021
         BNE   CHKPT9              NOT = 0, GO TO CHKPT9                01902021
         LH    R8,DCBCTR                                                01908021
         LA    R8,DX1(R8)                                               01914021
         STH   R8,DX10(R10)                                             01920021
         LR    R3,R10                                                   01926021
CHKPT7   LA    R3,DX16(R3)         CHECK NEXT ENTRY                     01932021
         CR    R3,R6              EOT?                                  01938021
         BNL   CHKPT8             YES.                                  01944021
         CLC   DX0(8,R3),DX0(R10)  NO. COMPARE EXTERNAL NAMES           01950021
         BNE   CHKPT7              EXT NAMES UN=,CHK NXT ENTRY          01956021
         STH   R8,DX10(R3)                                              01962021
         B     CHKPT7              GO TO CHKPT7 TO CHK NXT ENTRY        01968021
CHKPT8   MVC   DCBC+NX40(8),DX0(R10) MOVE EXTERNAL NAME TO DCB          01974021
         STC   R8,DCBDEF+NX4                                            01980021
         STH   R8,DCBCTR                                                01986021
         ST    R9,DCBDEF                                                01992021
         ST    R9,DCBCCN                                                01998021
         MVI   DCBDEF,XX04                                              02004021
         MVI   DCBCCN,XX28                                              02010021
         LA    R3,DX5                                                   02016021
         BAL   R14,MASPUT         OUTPUT DCB ADEF                       02022021
         LA    R2,DCBCCN                                                02028021
         LA    R3,DX107                                                 02034021
         BAL   R14,MASPUT+NX4      BR TO COMMON                         02040021
         LA    R9,DX100(R9,R0)                                          02046021
         ST    R9,LOCCTR                                                02052021
CHKPT9   LA    R10,DX16(R10)                                            02058021
         B     CHKPT0              BRANCH TO CHKPT0                     02064021
INITRD   EQU   *                                                        02070021
         SR    R5,R5                                                    02076021
         BAL   R6,BREAD            READ RECORD FROM FILE 3              02082021
BEGIN0   TM    COPYSW,XX10          END OF FILE                         02088021
         USING ICLDST,R7                                                02094021
         BC    NOTONE,BEGN01       BRH TO SET OFF END OF SECT SW        02100021
         L     R15,APHTRM                                               02106021
         BALR  R14,R15             LINK TO BEGADC                       02112021
BEGN01   NI    COPYSW,XXFD          TURN OFF END OF SECT. SW(CPB)       02118021
         CLI   DX0(R7),XX42         NO, IS RECORD A DIV. OR SECT. HD    02124021
         BC    EQ,BEGIN1           YES                                  02130021
         CLI   DX0(R7),XX03         NO, IS RECORD IC-TEXT               02136021
         BCR   EQ,R8               YES, GO TO SECTION ROUTINE           02142021
         BC    UNCOND,BEGERR       NO, ERROR                            02148021
         BCR   UNCOND,R8           YES, BRANCH TO SECTION               02154021
BEGIN1   CLI   DX1(R7),XX01         IS RECORD DATA DIVISION             02160021
         BC    NOTEQ,BEGIN2        NO                                   02166021
BEGA     LA    R4,DX2(R0,R0)        YES                                 02172021
         LR    R5,R4                                                    02178021
         BAL   R6,BSUBRN           GET NEXT RECORD                      02184021
         BC    UNCOND,BEGIN0       GO TO BEGIN0 TO TEST FOR EOF         02190021
*BEGIN2      DETERMINES THE SECTION WHEN A SECTION HEADER IS            02196021
*ENCOUNTERED AND PUTS A(SECTION) IN REG 8. A BRANCH IS TAKEN TO BEG     02202021
*WHICH CALLS FOR THE NEXT IC-TEXT ELEMENT. IF IT IS LD-TEXT BEGIN0      02208021
*BRANCHES TO THE SECTION, IF ANOTHER SECTION HEADER BEGIN2 IS ENTER     02214021
*AGAIN.                                                                 02220021
BEGIN2   EQU   *                                                  44287 02226021
         SR    R5,R5                    PUT SECTION NUMBER        44287 02232021
         IC    R5,SECTSAV                FROM IC-TXT IN R5        44287 02238021
         CLC   DX1(LX1,R7),SECTSW       IS SECT HDR SAME AS BEF   44287 02244021
         BC    LO,BEGERR           ERROR OUT OF SEQUENCE         SE     02250021
         BC    EQ,BEGIN3           YES                                  02256021
         STC   R5,SECTSW           HIGHER, MOVE THIS SECTION TO SEC     02262021
         S     R5,TWO                                                   02268021
         BC    UNCOND,BEGIN4       GO TO BG4 TO GET R5 MULT OF 4        02274021
BEGIN3   LA    R5,DX1(R5,R0)                                            02280021
         STC   R5,SECTSW           STORE SECTION+1 INTO SECTSW          02286021
         S     R5,THREE                                                 02292021
BEGIN4   SLL   R5,DX2               GET R5 MULTIPLE OF 4 FOR INDEX T    02298021
         LA    R9,SECTTB           R9= SECTION TABLE ADDRESS            02304021
         AR    R9,R5                                                    02310021
         L     R8,DX0(R9)                                               02316021
         BC    UNCOND,BEGA         BRH TO BEGA TO LOAD 2 IN REG4        02322021
BEGERR DS    0H                                                         02328021
*=1    FILE SECTION INITIALIZATION  - FILEST                            02334021
FILEST   XC    SCAR(LX14),SCAR          CLEAR SCAR                      02340021
         MVC   SAV01L(LX4),LOCCTR                                       02346021
*                                  MAJOR CODE(MCI) IS ZERO FOR FD       02352021
*FILES1      DETERMINES THE TYPE OF FILE SECTION TEXT AND BRANCHES      02358021
*THERE.       ROUTINE   IC-TEXT    SOURCE LANGUAGE EQUIVALENT           02364021
*             FSTEXT    FS-TEXT    FD(FILE DESCRIPTION)                 02370021
*             SDTEXT    SD-TEXT    SD(SORT DESCRIPTION)                 02376021
*             LDTEXT    LD-TEXT    01-49(LEVEL DESCRIPTION)             02382021
FILES1   TM    COPYSW,XX12          IS END OF FILE SWITCH OR CPB SW     02388021
         BC    NOTZER,FSTERM       YES, DO FULE SECTION TERMINATION     02394021
         NI    BPERRO,XXFD          TURN OFF SA DICT. PTR. SW           02400021
FILE1X   CLI   DX2(R7),XX38        IS RECORD FS-TEXT                    02406021
         BC    EQ,FSTEXT           YES, BRANCH                          02412021
         CLI   DX2(R7),XX36         NO, IS RECORD SD-TEXT               02418021
         BC    EQ,SDTEXT           YES                                  02424021
         CLI   DX2(R7),XX32          O,IS RECORD A '77' ITEM            02430021
         BC    NOTEQ,FILES2        NO                                   02436021
         MVI   DX2(R7),XX01         YES, ERROR THERE ARE NO 77'S ALL    02442021
         BAL   R4,LDEROR           LDTEXT ERROR ROUTINE                 02448021
         DC    X'101E'             30                                   02454021
FILES2   CLI   DX2(R7),XX01        01 ITEM                              02460021
         BNE   FDNON01            NO.                                   02466021
         CLI   MCI,XX01            01 UNDER SD?                         02472021
         BE    FILES3             YES.                                  02478021
         TM    LBLSW,XX80     YES. LABEL RECORDS ARE ON CCAUSE?         02484021
         BZ    FDDN001            01 - DATA RECORD                      02490021
         L     R4,LPARAM          NO. COMPARE DATA NAMES. A(TIB)        02496021
         L     R4,DX0(R4)          R4=A(TAMM)                           02502021
         LH    R5,DX4(R4)          R4=SIZE OF TBL USED(IN TAMM)         02508021
         L     R4,DX0(R4)          R4=A(LABTBL)                         02514021
         N     R4,MK0932                                                02520021
         AR    R5,R4              R5=A(END OF TABLE)                    02526021
LBLTST1  SR    R3,R3                                                    02532021
         IC    R3,DX2(R4)          R3=NAME COUNT                        02538021
         BCTR  R3,R0               SUBTRACT 1 FROM NAME COUNT           02544021
         CLC   ICLDCT(LX1),DX2(R4)  NAME COUNT AGREE?                   02550021
         BNE   LBLTST2            NO.                                   02556021
         EX    R3,LBLCLC          SAME DATA NAMES?                      02562021
         BE    LBLDN01            YES. 01 LABEL RECORD.                 02568021
LBLTST2  EQU   *                                                  45043 02574021
         TM    COPYSW,XX01              IS COPY SW ON             45043 02580021
         BZ    LBLTST3                    NO, BR                  45043 02586021
         EX    R3,LBLCOPY               IS LABEL NM A COPY        45043 02592021
*  COMPARE DATA NAME THAT SPECIFIED COPY ( SAVED IN BSAVEC) WITH  45043 02598021
*  LABEL NAMES SAVED IN THE LABEL NAME TABLE                      45043 02604021
         BE    LBLDN01                  YES-01 LABEL RECORD       45043 02610021
LBLTST3  AR    R4,R3                    R3 = NAME CNT - 1         45043 02616021
         LA    R4,DX4(R4)          R4=A(NEXT ENTRY)                     02622021
         CR    R5,R4              EOT                                   02628021
         BH    LBLTST1            MORE ENTRY                            02634021
         B     FDDN001            01 DATA RECORD                        02640021
LBLCLC   CLC   ICLDCT+NX1(LX0),DX3(R4)                                  02646021
LBLCOPY  CLC   BSAVEC+NX1(LX0),DX3(R4)  COMPARE NAMES             45043 02652021
* 01 FOR LABEL RECORD                                                   02658021
LBLDN01  XC    SCAR(LX14),SCAR          CLEAR SCAR                      02664021
         MVI   MCI,XX05            SET MAJOR CODE = LINKAGE SECT.       02670021
*                                  COPY CLAUSE INDICATED                02676021
         TM    DX6(R7),XX10        COPY CLAUSE PRESENT ??               02682021
         BO    FILES3              YES,  DO NOT SAVE LBLSW              02688021
         MVC   PLBLSW(LX1),LBLSW                                        02694021
         OI    LBLSW,XX40          PROCESSING LABEL RCD.                02700021
         B     FILES3              BR TO PROCESS LD TEXT                02706021
* 01 FOR DATA RECORD                                                    02712021
FDDN001  EQU   *                                                        02718021
         L     R15,ASUBRTN                                              02724021
         BALR  R14,R15             CHECK FOR MISSING FD                 02730021
FILES3   BAL   R4,LDTEXT           PROCESS LD TEXT                      02736021
         B     FILES1              DETER. TYPE OF FILE SECT. TXT        02742021
* NON 01 LD TEXT UNDER FD                                               02748021
FDNON01  B     FILES3              PROCESS LD TEXT                      02754021
FSTEXT L     R15,AFSTXT                                                 02760021
       BALR  R14,R15              CALL FSTXT ROUTINE TO PROCESS FD      02766021
         L     R15,AMAIN                                                02772021
         EJECT                                                          02778021
* GET THE DICTIONARY PTR FOR THE FD AND CALL DICTIONARY BUILD           02784021
FS012    MVI   SRCELN,XX38          SET FD LEVEL NUMBER                 02790021
         MVI   BCIPRM,XX0C          MOVE GROUP ITEM CODE TO GETPTR P    02796021
         XC    FESB(LX1),FESB       IN CASE NO 01                       02802021
         BAL   R4,GETDPT           GET DICTIONARY POINTER AND CHECK     02808021
*                                   CONDITIONAL VARIABLE DELIMITOR      02814021
         MVC   LSTQUL(LX3),HIQUAL  SAVE OLD FD DICTPT FOR KEYCHK        02820021
         MVC   HIQUAL(LX3),DICTPT+NX1 SAVE DICT. PTR. OF FD, SD, OR SA  02826021
         MVI   NOFDSW,XX01          THERE IS AN FD, SD, OR SA-BOTH      02832021
*                                  FOR ELIODO RTN                       02838021
         TM    BPERRO,XX02          IF LEGAL SA                         02844021
         BC    NOTONE,*+NX10        REPLACE SA-NAME IN APPLY TABLE      02850021
         MVC   DX35(LX4,R10),DICTPT   WITH SA DICT. PTR.                02856021
         BAL   R4,BCONDE           CHECK FOR COND. VARIABLE DELIMIT     02862021
         OI    FDNOBL,XX01                                              02868021
         MVC   SAV01L(LX4),LOCCTR                                       02874021
         ST    R15,DSAVE                                                02880021
         L     R15,ADICTB                                               02886021
         BALR  R14,R15             CALL DICTIONARY BUILD TO ENTER       02892021
         L     R15,DSAVE                FD ENTRY INTO THE DICTIONAR     02898021
         BC    UNCOND,FILES1       DETER. TYPE OF FILE SECT. TXT        02904021
FSTERM   OI    FSTSW,XX20           SET END OF FILE SECTION SW ON FO    02910021
         SR    R2,R2                                                    02916021
         L     R1,COSADR                                                02922021
         BALR  R0,R1               BRANCH TO COMMON                     02928021
         DC    X'FF'                                                    02934021
         BC    UNCOND,BEGIN0        DICT. BUILD AND GO TO SECT. DET     02940021
         EJECT                                                          02946021
*                                                                       02952021
* HANDLES  SD  SORT DESCRIPTION ENTRY                                   02958021
*                                                                       02964021
         USING ISDTXT,R7                                                02970021
SDTEXT   XC    BUFCAL(LX30),BUFCAL                                      02976021
         MVI   SRANO,XX00          RESET SD SAME REC AREA NO            02982021
         ST    R15,DSAVE                                                02988021
         XC    CI(LX160),CI             CLEAR AREA                      02994021
         SR    R6,R6               * MOVE SORT FILE                     03000021
         IC    R6,ISDNCT           * NAME TO CI FOR                     03006021
         EX    R6,SDMOVE           * DICTIONARY CHECKING AND ENTRY      03012021
         MVC   CARDNO(LX2),ISDCDN   CARD NUM FOR ERROR IDENTIFICATION   03018021
*                                                                       03024021
         L     R1,ALTNPRM          * CALL 'LATRNM' TO CHECK             03030021
         L     R15,ALATRN          *  IF SD IS                          03036021
         BALR  R14,R15             *  DUPLICATE                         03042021
         LR    R3,R15              SAVE RETURN CODE                     03048021
         L     R15,DSAVE                                                03054021
         C     R3,ZEROS            DUPLICATE SD?                        03060021
         BC    NOTEQ,SDTXT1        NO - CONTINUE PROCESSING             03066021
         LH    R0,MSG44            * GENERATE                           03072021
         L     R15,AERRTN          * MESSAGE FOR                        03078021
         BALR  R14,R15             * DUPLICATE SD                       03084021
         L     R15,DSAVE           GET BASE REG                         03090021
         LA    R4,DX51              TOTAL COUNT                         03096021
         LR    R5,R4               CALL BSUBRN TO INCREMENT TO          03102021
         BAL   R6,BSUBRN             NEXT IC-TEXT FIELD                 03108021
         B     FILES1              SEE WHAT'S NEXT                      03114021
*                                                                       03120021
*                                                                       03126021
SDTXT1   EQU   *                                                        03132021
         OI    FSTSW,XX44           SET FS SW FOR BCOPY AND PHTERM      03138021
         MVC   LOCCTR(LX4),SAV01L                                       03144021
         MVI   MCI,XX01             SET MAJOR CODE INDICATOR TO SD      03150021
         MVC   PLBLSW(LX1),LBLSW                                        03156021
         NI    LBLSW,XXBF          LBL RCD SW OFF                       03162021
         IC    R2,ISDFL2          GET RECORDING MODE                    03168021
         SRL   R2,DX1                                                   03174021
         STC   R2,BUFCAL+NX10                                           03180021
         NI    BUFCAL+NX10,XX0F                                         03186021
         MVC   BUFCAL+NX28(LX2),ISDCDN   AND BUFCAL                     03192021
         MVC   BUFCAL+NX4(LX4),ISDRC1 MOVE RECORD CONTAINS TO BUFCAL    03198021
         MVI   CI+NX32,XX89         SET MAJOR CODE AND COUNT            03204021
         SR    R9,R9                                                    03210021
         IC    R9,ISDNCT           R9=DATA NAME CT                      03216021
         EX    R9,SDMOVE          MOVE SORT-FILE NAME TO CI             03222021
         MVI   SRCELN,XX36          MOVE LEVEL NUMBER TO WORKAREA       03228021
*                                  SMRCDTBL (TIB5) SAME REC AREA        03234021
         TM    ISDFL1,XX02         IS THIS SAME REC SD FILE             03240021
         BZ    SDTXT1A             DO NOT MOVE SRA NO.                  03246021
         MVC    SRANO,ISDSMNO      SAVE SRA NO                          03252021
         XC    SMRCDAR(LX10),SMRCDAR   LEAR SMRCDTBL WORKING AREA       03258021
         MVC    SMRCDAR(LX1),ISDSMNO   INSERT SRANO                     03264021
SDTXT1A  DS    0H                                                       03270021
         SR    R4,R4                      CLEAR REG 4             45078 03276021
         IC    R4,PRDCBNO               INCR DCB NO IN CASE       45078 03282021
         LA    R4,DX1(R4)               THERE IS A PREV FD WITH A 45078 03288021
         STC   R4,PRDCBNO               GROUP TO RESOLVE WITH     45078 03294021
*      OCCURS OR REDEFINES                                        45078 03300021
         LA    R4,DX51                                                  03306021
         LR    R5,R4               CALL BSUBRN TO INCREMENT REG 7 T     03312021
         BAL   R6,BSUBRN             NEXT IC-TEXT FIELD                 03318021
         BC    UNCOND,FS012+NX4    PROCESS IC TEXT                      03324021
SDMOVE   MVC   CI(LX0),ISDNCT                                           03330021
         EJECT                                                          03336021
         EJECT                                                          03342021
*                                                                       03348021
* HANDLES  RD  REPORT DESCRIPTION                                       03354021
*              AND ALL ITEMS IN REPORT SECTION- 01-49 LEVELS            03360021
*                                               RSDUP TEXT              03366021
*                                                                       03372021
REPORT   XC    SCAR(LX14),SCAR          CLEAR SCAR                      03378021
         OI    WSRSW,XX02                                               03384021
         MVI   MCI,XX06             SET MAJOR CODE IND. TO REPORT SE    03390021
         TM    WSRSW,XX01           WAS THERE A WS SECTION              03396021
         BC    ONES,REPR01         YES, BRANCH                          03402021
         XC    APAF(LX7),APAF       NO, SET APAF TO                     03408021
         LH    R1,BLCTR                                                 03414021
         LA    R1,DX1(R1)                                               03420021
         STH   R1,BLCTR                                                 03426021
         STC   R1,APAF+NX2                                              03432021
         STC   R1,FAPAF+NX2                                             03438021
         TM    FSTSW,XX20           IS END OF FILE SECT. SW ON          03444021
         BC    ZERO,REPR00         NO, BRANCH                           03450021
         MVC   LOCCTR(LX4),SAV01L                                       03456021
REPR00   L     R1,LOCCTR                                                03462021
         S     R1,XTRA                  SUBT XTRA BYTES FROM LOCCTR     03468021
*  IN CASE THERE WAS A LINKAGE SECTION & XTRA BYTES WERE ADDED    42660 03474021
         A     R1,SEVEN                AND 1ST BL=                      03480021
         N     R1,MK0129               OF REPORT SECTION                03486021
         ST    R1,LOCCTR                                                03492021
         ST    R1,WS                                                    03498021
         MVC   WS+NX4(LX1),APAF+NX2                                     03504021
         BC    UNCOND,REPRT1       CHECK FOR EOF SW                     03510021
REPR01   MVC   APAF(LX7),RAPAF      APAF CONTINUES WHERE WS LEFT OFF    03516021
*  THE NEXT 3 INSTRUCTIONS WILL RESTORE THE LOCATION COUNTER      42660 03522021
*  AS IT SHOULD BE IF THERE WAS A LINKAGE SECTION AND IF          42660 03528021
*  UNNECESSARY BYTES WERE ADDED TO THE PROGRAM. IF THERE WAS      42660 03534021
*  NO LINKAGE SECTION AND NO UNNECESSARY STORAGE WAS ADDED,       42660 03540021
*  THEN ZEROES WILL BE SUBTRACTED FROM LOCCTR, THEREFORE          42660 03546021
*  NOT ALTERING THE CORRECT VALUE OF THE LOCATION COUNTER.        42660 03552021
         L     R1,LOCCTR                CURRENT LOCATION COUNTER  42660 03558021
         S     R1,XTRA                   SUBTRACT XTRA BYTES      42660 03564021
         ST    R1,LOCCTR                LOCCTR AS IT SHLD BE      42660 03570021
REPRT1   TM    COPYSW,XX12          IS END OF FILE OR SECTION SW ON     03576021
         BC    NOTZER,RPTERM       YES, GO TO TERMINATION RTN           03582021
         CLI   DX2(R7),XX38         NO, IS THIS IC-TEXT ELEMENT RSDU    03588021
         BC    EQ,RSDUP0           YES, BRANCH TO RSDUP PROCESSOR       03594021
         CLI   DX2(R7),XX34         RD                                  03600021
         BC    NOTEQ,REPRT2        NO                                   03606021
* RD                                                                    03612021
         XC    CI(LX160),CI             CLEAR AREA                      03618021
         OI    FSTSW,XX04           SET FS SW FOR PHTERM                03624021
         MVC   CARDNO(LX2),DX3(R7)   SAVE CARD =                        03630021
         SR    R9,R9                                                    03636021
         IC    R9,DX5(R7)                                               03642021
         EX    R9,RPMOVE                                                03648021
         MVI   CI+NX32,XX8E         COUNT, MAJOR CODE                   03654021
         MVI   SRCELN,XX34          INTERNAL LEVEL =                    03660021
         LA    R4,DX7(R9)                                               03666021
         LR    R5,R4                                                    03672021
         BAL   R6,BSUBRN           BUFFER SUBROUTINE                    03678021
         MVI   BCIPRM,XX0C          SET GROUP ITEM CODE FOR GETDPT      03684021
         BAL   R4,GETDPT           GET DICTIONARY POINTER               03690021
         BAL   R4,BCONDE           CHECK FOR CONDITIONAL VARIABLE       03696021
         ST    R15,DSAVE                                                03702021
         L     R15,ADICTB                                               03708021
         BALR  R14,R15             BR TO DICTIONARY BUILD RTN           03714021
         L     R15,DSAVE                                                03720021
         BC    UNCOND,REPRT1       CHECK NEXT RD ENTRY                  03726021
RPMOVE   MVC   CI(LX0),DX5(R7)                                          03732021
* 01-49 LEVEL                                                           03738021
REPRT2   DS    0H                                                 34194 03744021
         L     R15,AREPRTCK        PERFORM TO CHECK REPPORT WRITER34194 03750021
         BALR  R14,R15             ITEM LENGTH                    34194 03756021
*                                                                 34194 03762021
         BAL   R4,LDTEXT           PERFORM LD TEST PROCESS        34194 03768021
*                                                                 34194 03774021
         BC    UNCOND,REPRT1       CHECK NEXT RD ENTRY                  03780021
RPTERM   BC    UNCOND,BEGIN0       RETURN TO SECTION DETERMINER         03786021
* RSDUP TEXT                                                            03792021
RSDUP0   XC    CI(LX160),CI             CLEAR AREA                      03798021
         XC    ELITEM(LX215),ELITEM                                     03804021
         SR    R4,R4                                                    03810021
         SR    R9,R9                                                    03816021
         MVC   CARDNO(LX2),DX3(R7)   MOVE CARD = TO CI                  03822021
         IC    R9,DX5(R7)           GET DATA-NAME COUNT                 03828021
         EX    R9,RSMOVN           MOVE DATA-NAME TO CI                 03834021
         LA    R7,DX6(R9,R7)        SET BUFFER PTR TO ORIGINAL NAME     03840021
         LR    R8,R7                                                    03846021
         CLI   DX0(R7),XXFF         IS RSDUP-TEXT SPLIT ACROSS 2 BUF    03852021
         BC    NOTEQ,RSDUP1        NO                                   03858021
         LR    R1,R11              YES                                  03864021
         BALR  R0,R1               READ FILE 3                          03870021
         DC    X'03'                                                    03876021
         LR    R7,R0               BUFFER ADDRESS                       03882021
         LR    R8,R7                                                    03888021
RSDUP1   IC    R9,DX0(R7)           SCAN ORIGINAL NAME FIELD AND ITS    03894021
         LTR   R9,R9                QUALIFIERS. AT END OF SCAN          03900021
         BC    ZERO,RSDUP2             R4= LGN. OF ORIGINAL NAME        03906021
         LA    R4,DX1(R4,R9)            R7= ADDRESS OF LAST CHAR IN     03912021
         LA    R7,DX1(R7,R9)                 RSDUP-TEXT                 03918021
         BC    UNCOND,RSDUP1       CONTINUE SCAN                        03924021
RSDUP2   LA    R4,DX1(R4)                                               03930021
         STH   R4,FULLWD           PUT R4(LGN OF ORIG. NAME FLD)        03936021
         S     R8,TWO                  BEVORE ORIG. NAME FLD            03942021
         MVC   DX0(LX2,R8),FULLWD                                       03948021
         LR    R1,R8                                                    03954021
         ST    R15,TSAVER                                               03960021
         L     R15,AQUAL           CALL QUALIFIER RTN TO FIND           03966021
         BALR  R14,R15               ADDRESS OF ORIGINAL DATA-NAME      03972021
         LTR   R14,R15             TEST RETURN CODE                     03978021
         L     R15,TSAVER                                               03984021
         BC    NOTZER,RSDUP4       RETURN CODE = ERROR                  03990021
         L     R2,INPUT                                                 03996021
*                                  R2= ADDRESS OF ATTRIBUTES IN DIC     04002021
         MVC   MINCOD(LX1),DX1(R2)   MOVE DICT. MINOR CODE TO CI        04008021
         NI    MINCOD,XXF0          ZERO OUT OCCURS, REDEFINES, AND     04014021
*                                    SUBSCRIPT FIELDS                   04020021
         MVC   LEVNUM(LX3),DX6(R2)                                      04026021
         NI    LEVNUM,XX01          ZERO LEV NUM AND QUANTITY BIT       04032021
         MVI   COUNT,RSDUPC        MOVE COUNT MAJOR CODE TO CI          04038021
         CLI   MINCOD,XX40          IS ORIG. ITEM A VAR. LGN GROUP      04044021
         BC    EQ,RSDUP5           YES, ERROR BRANCH                    04050021
         CLI   MINCOD,XX10          NO, IS ITEM A GROUP(FIXED LGN)      04056021
         BC    NOTEQ,*+NX8          NO                                  04062021
RSDP2A   MVI   MINCOD,XX30          YES, MAKE THIS ITEM ALPHANUM. EL    04068021
         OI    LEVNUM,XXC8          SET LEVEL = 77                      04074021
         MVI   SRCELN,XX32                                              04080021
         XC    ITMCLS(LX2),ITMCLS   CLEAR CLAUSE BYTES                  04086021
       STH   R1,CILGN                   SET ITEM'S MACH LNGTH           04092021
*                                       R1 SET BY QUAL ROUTINE          04098021
         MVI   BCIPRM,XX08          SET ACCESS PAR. FOR GETPTR TO EL    04104021
         BAL   R4,GETDPT           GET ITEM'S DICTIONARY PTR.           04110021
         BAL   R4,BCONDE           CHECK FOR COND. VAR. DELIMITOR       04116021
         ST    R15,BSAVE4                                               04122021
         L     R15,ADICTB          CALL DICTIONARY BUILD                04128021
         BALR  R14,R15             BR TO DICT BUILD RTN                 04134021
         L     R15,BSAVE4                                               04140021
RSDUP3   LA    R4,DX1                                                   04146021
         LR    R5,R4               CALL BSUBRN TO INCREMENT BUFFER      04152021
         BAL   R6,BSUBRN            PTR TO NEXT IC-TEXT ELEMENT         04158021
         BC    UNCOND,REPRT1       CHECK NEXT RD ENTRY                  04164021
RSDUP4   BAL   R4,LDEROR           ORIGINAL NAME NOT FOUND IN DICT.     04170021
         DC    X'202D'             45                                   04176021
         BC    UNCOND,RSDUP3       BR TO RTN TO GET NEXT IC-TXT         04182021
RSDUP5   BAL   R4,LDEROR           ORIGINAL NAME IS VARIABLE NAME G     04188021
         DC    X'202E'             46                                   04194021
         BC    UNCOND,RSDP2A       CONTINUE PROCESSING                  04200021
RSMOVN   MVC   CI(LX0),DX5(R7)                                          04206021
*                                                                       04212021
* HANDLES 01-49 LEVELS IN LINKAGE SECTION                               04218021
*                                                                       04224021
LINKST   XC    SCAR(LX14),SCAR          CLEAR SCAR                      04230021
         MVI   MCI,XX05             SET MAJOR CODE IND. TO LINKAGE S    04236021
         NI    FSTSW,XXFB           TURN OFF NEED TO DELIMIT SW         04242021
LINKS1   BAL   R4,LDTEXT           CALL LEVEL 01-49,77 PROCESSOR        04248021
         TM    COPYSW,XX12          IS IT END OF SECTION(CPB) OR END    04254021
*                                                         FILE 3        04260021
         BC ZERO,LINKS1            NO, PROCESS NEXT ITEM                04266021
LSTERM   BC    UNCOND,BEGIN0       YES, DO LINKAGE TERMINATION          04272021
PREMAS   MVI   ACONDF,XX2C          ADCON CODE                          04278021
         MVI   ACONDF+NX4,XX04      ADCON LGN                           04284021
         LA    R3,DX8               ADCON DEF. LGN                      04290021
MASPUT   LA    R2,DECBDF                                                04296021
         L     R1,COSADR                                                04302021
         BALR  R0,R1               BRANCH TO COMMON                     04308021
         DC    X'14'                                                    04314021
         BCR   UNCOND,R14          RETURN                               04320021
         EJECT                                                          04326021
*=1    WORKING STORAGE INITIALIZATION --WSTSCT                          04332021
*WSTSCT      INITIALIZES AREAS, SWITCHES, AND TABLES NEEDED IN THE      04338021
*WORKING-STORAGE SECTION.                                               04344021
WSTSCT   STM   R0,R14,BSAVE                                             04350021
         MVI   SRANO,XX00          RESET SD SAME REC AREA NO            04356021
         XC    BPERRO(LX1),BPERRO                                       04362021
         NI    FSTSW,XXFB           TURN OFF NEED TO DELIMIT SW         04368021
         XC    SCAR(LX14),SCAR          CLEAR SCAR                      04374021
         TM    FSTSW,XX20           IF END FILE SECT. SW ON SET LOCC    04380021
         BC    NOTONE,WSTSC0        TO VALUE OF LAST 01 IN FILE SEC     04386021
         MVC   LOCCTR(LX4),SAV01L                                       04392021
WSTSC0   L     R1,LOCCTR                                                04398021
       A     R1,SEVEN              ON R0 BOUNDARY                       04404021
         N     R1,MK0129              AND                               04410021
         ST    R1,LOCCTR                                                04416021
         ST    R1,WS                     IN WS ( START ADDR. OF WS      04422021
         LH    R1,BLCTR                                                 04428021
         A     R1,ONE                  WORKING STORAGE                  04434021
         STC   R1,FAPAF+NX2                                             04440021
         STH   R1,BLCTR                                                 04446021
         XC    APAF(LX7),APAF                                           04452021
         STC   R1,APAF+NX2                                              04458021
         MVI   MCI,XX04        SET MAJOR CODE INDICATOR IN SCAR TO W    04464021
WSTSC1   BAL   R4,LDTEXT           CALL LEVEL 1-49 PROCESSOR            04470021
         TM    COPYSW,XX12          IS END OF SECTION(CPB) OR END OF    04476021
*                                   FILE SWITCH ON                      04482021
         BC    ZERO,WSTSC1         NO, BRANCH                           04488021
         BC    NOTZER,BDDTAB       YES, GO TO TERMINATION RTN           04494021
*LDTEXT(GETNXT)  GETS LD-TEXT FROM BUFFER AND DISTRIBUTES IT TO WOR     04500021
*AREAS TO BE PROCESSED AT A LATER TIME. PICTURES ARE CONVERTED FROM     04506021
*SOURCE LANGUAGE TO INTERNAL LANGUAGE SO THAT THEY MAY BE PROCESSED     04512021
*BY THEIR RESPECTIVE PICTURE ANALYSIS ROUTINES. THE SUBSCRIPTING        04518021
*REQUIREMENTS ARE DETERMINED IN LDTEXT BY A CALL TO BMBSRN.             04524021
*TITLE 'LDTEXT'   -LEVEL DESCRIPTION TEXT PROCESSOR                     04530021
*STATUS                                                                 04536021
*FUNCTION/OPERATION- PHASE 2 RECEIVES ALL 01-49,77,88 ITEMS IN LD-T     04542021
*   THIS ROUTINE DETERMINES THE ATTRIBUTES OF THE ITEM AS FOLLOWS.      04548021
*   A.-GETNXT-TAKES THE LD-TEXT AND DISTRIBUTES IT INTO WORK AREAS.     04554021
*     THERE IS A PICTURE IN THE ITEM  -GSPICT- IS CALLED TO CHECK A     04560021
*     ENCODE IT. THE ROUTINE -BMBSRN- IS CALLED FOR ALL ITEMS TO        04566021
*     DETERMINE  THE SUBSCRIPTING REQUIREMENTS FOR THE ITEM             04572021
*   B.-COPYRN-IF 01 LEVEL HAS A COPY CLAUSE, ITS DATA-NAME IS SAVED     04578021
*     AND REPLACES THE DATA-NAME OF THE NEXT 01 LEVEL ITEM.             04584021
*   C.-BUSAGE-CHECKS THE USAGE CLAUSE COMPATIBILITY. IF A GROUP ITE     04590021
*     HAS A USAGE CLAUSE, ITS SUBORDINATE ITEMS MUST HAVE SAME USAG     04596021
*     APPROPRIATE PICTURE ANALYSIS RTN. IF ANALYSIS RTN. RETURNS WI     04602021
*     AN ERROR CODE, THE PICTURE IS CHANGED TO '9'.                     04608021
*     THE ITEM.                                                         04614021
*ENTRY POINT- -LDTEXT-   BAL  R14,LDTEXT                                04620021
*INPUT-      REG 7  POINTS TO  LD-TEXT IN BUFFER  (FILE 3 BUFFER)       04626021
*OUTPUT-     PARTIALLY BUILT DICTIONARY ENTRY                           04632021
*EXTERNAL ROUTINES                                                      04638021
*   -BMBSRN-  SUBSCRIPTING REQUIREMENTS                                 04644021
*   -GSPICT-  TRANSLATE SOURCE PICTURE TO CODE                          04650021
*EXITS- 1 NORMAL EXIT AT END OF PROCESSING                              04656021
*TABLES/WORK AREAS                                                      04662021
*   CI     -CURRENT ITEM WORKAREA FOR BUILDING THE DICTIONARY ITEM.     04668021
*   ELITEM -WORKAREA FOR PICTURE ANALYSIS AND VALUE CLAUSE ANALYSIS     04674021
*   SCAR   -COMMUNICATION WORK AREA FOR SECTIONS.                       04680021
*ATTRIBUTES                                                             04686021
*NOTES                                                                  04692021
         USING ICLDST,R7                                                04698021
LDTEXT   ST    R4,GETSAV+NX4                                            04704021
GETNXT SR    R4,R4                                                      04710021
         ST    R7,VALSV2                SET VALSV2 FOR LEV 88     38991 04716021
         XC    CI(LX160),CI             CLEAR AREA                      04722021
         XC    ELITEM(LX216),ELITEM   CLEAR ELITEM FIELDS               04728021
         MVC   SRCELN(LX1),ICLLEV   MOVE LEVEL NUMBER FROM BUFFER       04734021
         CLI   COD01,XX01                LEV 01 FOUND BEFORE            04740021
       BC    EQ,LEV01                   YES                             04746021
         CLI   SRCELN,XX01                LEVEL01                       04752021
       BC    NOTEQ,LEV01                 NO                             04758021
         MVI   COD01,XX01                 YES-FLAG 01 FOUND             04764021
LEV01  DS    0H                                                         04770021
         MVC   CARDNO(LX2),ICLCDN   MOVE CARD-NO FROM BUFFER            04776021
         MVC   ITMCLS(LX2),ICLFL1   MOVE CLAUSE FIELD FROM BUFFER       04782021
         MVC   NOC(LX2),ICLNOC      MOVE NUMBER OF OCCURRENCES          04788021
         MVC   NOIDNM(LX2),ICLNOI    MOVE NUM IDNAMES                   04794021
         MVC   ITMCL3(LX1),ICLFL3   MOVE FLAG BYTE                      04800021
         TM    ITMCLS+NX1,XX80          IS THERE OCCURS DEP ON    47955 04806021
         BC    NOTONE,OCCURS2                NO, BR               47955 04812021
OCCURS1  OI    MINCOD,XX02              OCCURS OR OCCURS DEP ON   47955 04818021
         LH    R3,NOC                      TEST NO. OF            47955 04824021
         LTR   R3,R3                    OCCURRENCES FOR 0         47955 04830021
         BC    NOTZER,OCCURS3             NOT 0 --- OK            47955 04836021
         BAL   R4,LDEROR                OCCURS 0 ILLEGAL          47955 04842021
         DC    X'10E0'                  MSG. NO. 224              47955 04848021
         MVI   NOC+NX1,XX01             ASSUME 1 OCCURRENCE       47955 04854021
         B     OCCURS3                       CONTINUE             47955 04860021
OCCURS2  TM    ITMCL3,XX04              IS THERE OCCURS CL        47955 04866021
         BC    ONES,OCCURS1             YES-CHK NO OF OCCURS.     47955 04872021
OCCURS3  SR    R4,R4                      CLEAR REG 4             47955 04878021
         IC    R4,ICLDCT           GET DATA-NAME LENGTH CT              04884021
         EX    R4,LDMOVD       EXECUTE MOVE OF COUNT AND NAME TO CI     04890021
         LA    R7,ICLDCT+NX1(R4)    INCREMENT BUFFER PTR TO NEXT FIE    04896021
         CLI   DX0(R7),XX00     IS A PICTURE PRESENT                    04902021
         BC    EQ,BLDPCT       NO                                       04908021
         TM    ITMCLS+NX1,XX04      YES                                 04914021
         BC    NOTONE,BCGSPC       GO TO BCGSPC                         04920021
         IC    R4,DX0(R7)                                               04926021
         EX    R4,LDRMOV                                                04932021
         BC    UNCOND,BLDPCT+NX4   CONTINUE                             04938021
BCGSPC   ST    R15,RSAVE+NX60                                           04944021
         L     R15,AGSPIC      CALL GSPICT TO VALIDATE                  04950021
         BALR  R14,R15          AND DISTRIBUTE PICTURE                  04956021
         L     R15,RSAVE+NX60      LOAD BASE REGISTER             34194 04962021
         TM    MCI,XX06            MAJOR CODE  RD                 34194 04968021
         BZ    BCGSPCUA            BRANCH TO BYPASS               34194 04974021
         L     R4,AREPRT2A         REPORT WTR CHECK RTN           34194 04980021
         L     R15,AREPRTCK        ESTABLISHES BASE REGISTER      34194 04986021
         BALR  R14,R4             LINK TO REPORT WTR CHECK RTN    34194 04992021
         L     R15,RSAVE+NX60                                           04998021
BCGSPCUA DS    0H                                                 34194 05004021
*                                                                 34194 05010021
BLDPCT   IC    R4,DX0(R0,R7)                                            05016021
         LA    R7,DX1(R4,R7)                                            05022021
         IC    R4,DX0(R0,R7)   YES, GET VALUE COUNT                     05028021
         EX    R4,LDMOVV       MOVE VALUE AND COUNT TO ELITEM(LITVA     05034021
         LA    R7,DX1(R4,R7)                                            05040021
         CLI   DX0(R7),XX00     IS REDEFINES GIVEN                      05046021
         BC    EQ,BNORED       NO                                       05052021
         XC    REDEFA(LX32),REDEFA                                      05058021
         OI    MINCOD,XX01          SET REDEFINES CLAUSE BIT ON         05064021
         IC    R4,DX0(R0,R7)     GET NUMBER OF CHARS IN OBJECT NAME     05070021
         EX    R4,LDMOVR         MOVE OBJECT NAME TO SAVE AREA          05076021
         LA    R7,DX1(R4,R7)                                            05082021
         OI    RDFSW,SWON          SET SW ON                            05088021
         BC    UNCOND,BNORED+NX4   DO NOT INCREMENT BUFFER PTR          05094021
BNORED   LA    R7,DX1(R7,R0)                                            05100021
         ST    R15,RSAVE+NX60                                           05106021
         L     R15,AMBSRN                                               05112021
         BALR  R14,R15        CALL MUST BE SUBSCRIPTED ROUTINE          05118021
         L     R15,RSAVE+NX60                                           05124021
BOCDEP   TM    ITMCLS+NX1,XX80      DOES THIS ITEM HAVE AN OCCURS...    05130021
         BC    NOTONE,BOCDP3       NO, BRANCH                           05136021
         TM    MINCOD,XX02          YES, IS IT LEGAL(CHECKED BY BMBS    05142021
         BC    NOTONE,BOCDP2       NO, BRANCH                           05148021
         MVC   OBJDIS(LX2),DX0(R7)   YES, MOVE OD2TBL POINTER TO CI     05154021
         CLI   NOIDNM,XX00          ANY ID NAMES                        05160021
         BE    BOCDP5              NO                                   05166021
         L     R15,ASRCHT           GO BUILD TBLSCH                     05172021
         BALR  R14,R15             LINK TO ADDR IN REG 15               05178021
         L     R15,RSAVE+NX60                                           05184021
BOCDP1   LA    R7,DX2(R7)           INCR. BUFFER PTR TO NEXT IC-TEXT    05190021
         BAL   R6,COMPFF           LOOK AHEAD TO NEXT IC-TEXT FOR N     05196021
*                                   LEVEL NUMBER                        05202021
         BC    UNCOND,COPYRN       BRH TO COPYRN                        05208021
BOCDP2   NI    ITMCLS+NX1,XX7F      TURN OFF OCC...DEP ON BIT           05214021
         BC    UNCOND,BOCDP1       BRH TO INCR BUFFER PTR               05220021
BOCDP3   TM    ITMCLS+NX1,XX08      IS THIS A REPORT SECT REDEFINES     05226021
         BC    NOTONE,BOCDP4       NO                                   05232021
         MVC   REDPLS(LX2),DX0(R7)   YES, SAVE + FIELD                  05238021
         BC    UNCOND,BOCDP1       BRH TO INCR BUFFER PTR               05244021
BOCDP4   BCTR  R7,R0               SUBTRACT 1 FROM BUFFER PTR           05250021
         TM    MINCOD,XX02               ITEM HAVE OCCURS               05256021
         BZ     BOCDP1                  NO                              05262021
         CLI   NOIDNM,XX00               YES, INDEXED BY CLAUSE         05268021
         BE     BOCDP5                  NO                              05274021
         L     R15,ASRCHT           GO BUILD TBLSCH                     05280021
         BALR  R14,R15             LINK TO ADDR IN REG 15               05286021
         L     R15,RSAVE+NX60                                           05292021
         B     BOCDP1              BRH TO INCR BUFFER PTR               05298021
BOCDP5   CLI   NOKEYS,XX00               ANY KEYS                       05304021
         BE    BOCDP1              NO                                   05310021
         LH    R0,MSG108           MESSAGE 108                          05316021
         L     R15,AERRTN                                               05322021
         BALR  R14,R15             LINK TO ADDR IN REG 15               05328021
         L     R15,RSAVE+NX60                                           05334021
         LA    R7,DX2(R7)           UPDATE PTR                          05340021
         SR    R4,R4                                                    05346021
         IC    R4,NOKEYS                                                05352021
BOCDP6   L     R15,ABYPAS                                               05358021
         BALR  R14,R15             LINK TO ADDR IN REG 15               05364021
         L     R15,RSAVE+NX60                                           05370021
         BCT   R4,BOCDP6           AT END YET                           05376021
         S     R7,TWO                                                   05382021
         B     BOCDP1              BRH TO INCR BUFFER PTR               05388021
*                                   CLAUSE NOT PRESENT                  05394021
LDMOVV   MVC   LITVAL(LX0),DX0(R7)   VALUE                              05400021
LDMOVD   MVC   NUMBCD(LX0),ICLDCT                                       05406021
LDMOVR   MVC   REDEFA(LX0),DX0(R7) REDEFINES OBJECT                     05412021
LDRMOV   MVC   IPT+NX2(LX0),DX0(R7)  REPORT S.NAME MOVE                 05418021
BSUBRN   AR    R7,R4          INCREMENT BUFFER POINTER TO NEXT FIEL     05424021
         SR    R5,R4          DECREMENT BUFFER COUNT BY LAST FIELD      05430021
         BC    NOTHI,COMPFF    BRANCH IF BUFFER COUNT ZERO              05436021
         BCR   UNCOND,R6           BRH TO ADDR IN REG 6                 05442021
COMPFF   CLI   DX0(R7),XXFF    END OF LOGICAL RECORDS IN BUFFER         05448021
         BC    NOTEQ,BTYPRC   NO                                        05454021
BREAD    L     R1,COSADR      YES                                       05460021
         BALR  R0,R1               BRH TO ADDR IN REG 1                 05466021
         DC    X'03'          READ FILE F3                              05472021
         BC    EQ,ENDDIV          BRANCH IF END OF FILE CONDITION       05478021
         LR    R7,R0          OTHERWISE PUT BUFFER PNTR INTO REG 7      05484021
BTYPRC   SR    R5,R5                                                    05490021
         IC    R5,DX1(R7)                                               05496021
         STC   R5,SECTSAV                SAVE SECTION CDE         44287 05502021
         CLI   DX0(R7),XX03    IS THIS RECORD LD-TEXT                   05508021
         BC    NOTEQ,BNWITM   NO                                        05514021
         MVC   SAVCDNO(LX2),DX3(R7)  SAVE CARD NO                       05520021
         MVC   NXTLEV(LX1),DX2(R7)  YES                                 05526021
         TM    RNAMSW,SWON         WAS LAST ENTRY RENAMES               05532021
         BCR   NOTONE,R6           BRH TO ADDR IN REG 6                 05538021
         CLI   SRCELN,XX01          IS IT 01                            05544021
         BC    NOTHI,BTYPR1        YES, 01 OR FD IS OK                  05550021
         CLI   SRCELN,XX32          IS IT 77                            05556021
         BE    BTYPR1              YES, OK                              05562021
         CLI   SRCELN,XX39          IS IT 66                            05568021
         BE    BTYPR1              YES, OK                              05574021
         CLI   SRCELN,XX36         IS THIS SD                     36000 05580021
         BE    BTYPR1              GO AND RETURN                  36000 05586021
         BAL   R4,LDEROR           NO                                   05592021
         DC    X'206A'             MSG 106                              05598021
         L     R4,GETSAV+NX4                                            05604021
         L     R15,ABEGIN                                               05610021
         BR    R4                  RETURN WITH NEXT ELEMENT             05616021
BTYPR1   XC    RNAMSW(LX1),RNAMSW   TURN OFF SW                         05622021
         BR    R6                  GO PROCESS                           05628021
RENAMT   L     R15,ARNAMS                                               05634021
         BALR  R14,R15             LINK TO ADDR IN REG 15               05640021
         L     R15,RSAVE+NX60                                           05646021
         TM    COPYSW,XX10          EOF                                 05652021
         BO    RENAM1              YES                                  05658021
         XC    RNAMSW(LX1),RNAMSW                                       05664021
         BAL   R6,COMPFF                 K                              05670021
         TM    COPYSW,XX02          END OF SECTION                      05676021
         BO    RENAM1              YES, DON'T TURN SW ON                05682021
         OI    RNAMSW,SWON                                              05688021
RENAM1   L     R4,GETSAV+NX4        RETURN ADDRESS                      05694021
         BR    R4                  BRH TO RETURN ADDR                   05700021
BNWITM   CLI   DX0(R7),XX42    IS CODE CRITICAL PROGRAM BREAK           05706021
         BC    NOTEQ,JFETXT        NOERROR TEXT FROM PHASE 1            05712021
         OI    COPYSW,XX02          TURN ON END OF SECTION(CPB) SWIT    05718021
         MVI   NXTLEV,XX00          SET NEXT LEVEL TO 0                 05724021
         BCR   UNCOND,R6           RETURN TO CALLER                     05730021
ENDDIV   OI    COPYSW,XX10          TURN ON END OF FILE SWITCH          05736021
         MVI   NXTLEV,XX00          SET NEXT LEVEL NUMBER TO 0          05742021
         BCR   UNCOND,R6      RETURN TO CALLER                          05748021
JFETXT   CLI   DX0(R7),XX00         IS CODE E-TEXT                      05754021
         BNE   ISITVL              NOT =,TEST IF VALUE=SERIES           05760021
*                                  BRANCH TO CKECK ERROR MESG           05766021
         L     R15,ACKETXT             LOAD R15 WITH ADD OF CKETXT      05772021
         BALR  R14,R15                 EXCUTE CKETXT RTN                05778021
*                                                                       05784021
         BC    UNCOND,BSUBRN       BRH TO BSUBRN                        05790021
ISITVL   TM    ITMCLS,XX38          VALUE IS SERIES                     05796021
         BC    NOTONE,ISTRNM       SEE IF RENAMES                       05802021
         MVI   NXTLEV,XX01          YES, DUMMY NEXT LEVEL               05808021
         BR    R6                  RETURN                               05814021
ISTRNM   CLI   SRCELN,XX39          IS IT RENAMES                       05820021
         BE    RENAMT              YES, GO PROCESS                      05826021
         B     STOPPH              BRH TO STOPPH                        05832021
BHALTA   EQU   *                                                        05838021
         DROP  R7                                                       05844021
         EJECT                                                          05850021
STOPPH   DS    0H                  ISSUES * D * MESSAGE                 05856021
         MVC   CARDNO(LX2),SAVCDNO   RESTORE CARD NO. OF LAST IC TXT    05862021
         BAL   R4,LDEROR                                                05868021
         DC    X'8098'                                                  05874021
         L     R15,APHTRM                                               05880021
         L     R5,ABHALT                                                05886021
         BR    R5                  TERMINATE PROCESSING                 05892021
*                                                                       05898021
*                                                                       05904021
*                                                                       05910021
*                                                                       05916021
*=2      COPY ROUTINE-COPYRN                                            05922021
*COPYN--COPY CLAUSE ROUTINE                                             05928021
*COPYRN CHECKS FOR COPY CLAUSE IN 01/77 LEVELS. THE COPY NAME IS SA     05934021
* AND REPLACES THE DATA-NAME OF THE NEXT 01/77 LEVEL. COPYRN IS A       05940021
* SUBPROGRAM OF LDTEXT.                                                 05946021
COPYRN   ST    R7,GETSAV                                                05952021
         CLI   SRCELN,XX01                                              05958021
         BC    EQ,BCOPY       YES                                       05964021
         CLI   SRCELN,XX31     NO, IS SOURCE LEVEL NUMBER LESS THAN     05970021
         BC    HI,COPYR0           NO, BRANCH                           05976021
         TM    COPYSW,XX01          YES, IS COPY SW ON                  05982021
         BC    NOTONE,BUSGE                NO, BRANCH                   05988021
         NI    COPYSW,XXFE          YES, ERROR 01 OR 77 NOT AFTER CO    05994021
         BAL   R4,LDEROR           LINK TO GET MESS# IN REG 0           06000021
         DC    X'0094'             148                                  06006021
         BC    UNCOND,BUSGE             GO TO TEST IF LEV01 HAS APPRD   06012021
COPYR0   CLI   SRCELN,XX32          NO, IS SOURCE LN 77                 06018021
         BC    EQ,BTESTP      YES                                       06024021
         CLI   SRCELN,XX33     NO, IS SOURCE LN 88                      06030021
         BC    EQ,BCNAN       YES                                       06036021
         CLI   SRCELN,XX39          IS IT STILL 66                      06042021
         BNE   COPYR1              NO                                   06048021
         L     R4,GETSAV+NX4        RETURN                              06054021
         BR    R4                    TO CALLER                          06060021
COPYR1   L     R15,APHTRM                                               06066021
         L     R5,ABHALT                                                06072021
         BR    R5                  BRH TO ADDR IN REG 5                 06078021
BCOPY    CLI   MCI,XX04             FILE SECTION                        06084021
         BC    NOTLO,BCOPY2        NO, BRANCH                           06090021
         CLI   ODOCCT,XX02          DID LAST 01 HAVE MORE THAN 1 OCC    06096021
*                                  DEPENDING ON CLAUSE SUBORDINATE      06102021
         BC    LO,BCOPY0           NO, BRANCH                           06108021
         OI    OD2SW,XX01           YES, SET SW FOR RECORD CONT. PRO    06114021
BCOPY0   MVI   ODOCCT,XX00          SET CTR TO 0                        06120021
         TM    FSTSW,XX40           YES, IS THIS 1ST 01 UNDER FD, SD    06126021
         BC    ONES,BCOPY1         YES                                  06132021
         MVC   LOCCTR(LX4),SAV01L                                       06138021
         BC    UNCOND,BCOPY2       BRH TO SET LEVEL 01 SW ON            06144021
BCOPY1   L     R3,LOCCTR                                                06150021
       A     R3,SEVEN              ON R0                                06156021
         N     R3,MK0129               BOUNDARY                         06162021
         ST    R3,LOCCTR                                                06168021
         ST    R3,SAV01L           SAVE IT                              06174021
         NI    FSTSW,XXBF           TURN OFF SW                         06180021
BCOPY2   OI    FESB,XX02            SET LEVEL 01 SW ON                  06186021
         TM    GNSW,XX01            WAS A QRTN PUT OUT FOR LAST 01      06192021
         BC    NOTONE,BCOPY3       NO, BRANCH                           06198021
         NI    GNSW,XXFE            TURN OFF GN= SW FOR QBUILD RTN A    06204021
*                                   THE OCCURRENCE OF AN 01 LEVEL       06210021
BCOPY3   TM    ITMCLS+NX1,XX10      IS COPY CLAUSE PRESENT              06216021
         BC    NOTONE,BTESTC  NO                                        06222021
         MVC   BSAVEC(LX32),CI      YES, SAVE COPY DATA-NAME            06228021
         OI    COPYSW,XX01     TURN ON COPY SWITCH                      06234021
         L     R4,GETSAV+NX4        RETURN TO CALLER OF LDTEXT ROUTI    06240021
         BCR   UNCOND,R4           RTN TO CALLR OF LDTEXT ROUTINE       06246021
BTESTC   TM    COPYSW,XX01     IS COPY SW ON                            06252021
         BC    NOTONE,BUSGE                 NO                          06258021
BSUBST   MVC   BLDCOP(LX31),CI YES, MOVE COPY,ED NAME TO SAVE AREA      06264021
         CLI   BSAVEC,XX00          DID COPY HAVE A DATA-NAME           06270021
         BC    EQ,*+NX10            NO, DON'T REPLACE DATA-NAME         06276021
         MVC   CI(LX32),BSAVEC MOVE COPY NAME AND COUNT TO CI           06282021
         NI    COPYSW,XXFE          TURN OFF COPY SWITCH                06288021
         BC    UNCOND,BUSGE             GO TO TEST IF LEV01 HAS APPRD   06294021
BTESTP   TM    FESB,XX02            HAS AN 01-49 LEVEL APPEARED         06300021
         BC    ONES,BMAKE1    YES                                       06306021
         OI    FESB,XX01            NO, SET LEVEL 77 SWITCH ON          06312021
         BC    UNCOND,BCOPY2+NX4   TEST FOR QRTN FOR LAST 01            06318021
BMAKE1   MVI   SRCELN,XX01     YES, SET CURRENT ITEM LN TO 1            06324021
         NI    MINCOD,XXF1          TURN OFF MBS AND OCCURS BITS IF     06330021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   06336021
         DC    X'101E'             30                                   06342021
         BC    UNCOND,BCOPY        GO TO COMPARE FILE SECTION           06348021
BCNAN    TM    FESB,XX03            HAS LEVEL 01 OR 77 APPEARED         06354021
         BC    NOTZER,BCNANG  YES                                       06360021
         MVI   SRCELN,XX01     NO, MAKE LEVEL 88 A LEVEL 01             06366021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   06372021
         DC    X'101F'             31                                   06378021
         BC    UNCOND,BCOPY        GO TO COMPARE FILE SECTION           06384021
BCNANG   TM    ERR88,SWON          ERROR SW ON                          06390021
         BO    B88ER2              YES                                  06396021
         TM    ITMCLS+NX1,XXF0      NO, ANY OTHRR CLAUSE PRESENT        06402021
         BC    NOTZER,B88ERR        THE VALUE CLAUSE IS PRESENT         06408021
         TM    ITMCLS,XXC7            IT IS DELETED AND AN ERROR IS     06414021
         BC    NOTZER,B88ERR         GENERATED                          06420021
BCNANK   TM    ITMCLS,XX38          IS VALUE CLAUSE PRESENT             06426021
         BC    NOTZER,*+NX10            YES,  BRANCH AROUND ERR     944 06432021
         BAL   R4,LDEROR                BAL  TO ERROR RTN          9441 06438021
         DC    X'10C4'             MSG 196                              06444021
BCNANH   DS    0H                                                       06450021
BCNANI   MVI   LEVNUM,XXCC                                              06456021
         BC    UNCOND,BCALDB       BRH TO STORE REG 15                  06462021
B88ERR   BAL   R4,LDEROR           CALL ERROR ROUTINE                   06468021
         DC    X'2020'             32                                   06474021
         B     BCNANK              TEST FOR VALUE CLAUSE                06480021
B88ER2   L     R4,GETSAV+NX4                                            06486021
         BR    R4                  RETURN TO PROCESS NEXT               06492021
*     GO TO BUSAGE TO CHECK USAGE CLAUSE COMPATIBILITY                  06498021
BUSGE    L     R4,ABUSAGE               ADDR OF BUSAGE                  06504021
         L     R15,ACKETXT              ADDRESSABILITY                  06510021
         BR    R4                       BRANCH                          06516021
ABUSAGE  DC    A(BUSAGE)                                                06522021
*=2      ITEM ANALYSIS-ITEMAN                                           06528021
*ITEMAN      CHECKS FOR LEGALITY OF CLAUSES FOR GROUP AND ELEMENTAR     06534021
*ITEMS.                                                                 06540021
ITEMAN   SR    R3,R3                                                    06546021
         SR    R4,R4                                                    06552021
         SR    R8,R8                                                    06558021
         TM    SW88,XX01            IS COND. VAR. SWITCH ON             06564021
         BC    NOTONE,ITEMAA       NO, BRANCH                           06570021
         XI    SW88,XX03            YES, TURN IT OFF AND TURN ON        06576021
         XC    ERR88(LX1),ERR88     TURN OFF ERROR SW                   06582021
         TM    GRP88,SWON                                               06588021
         BZ    ITEMAA              BRH ON 0 TO COMP-1 USAGE COMPR       06594021
         XC    GRP88(LX1),GRP88                                         06600021
         L      R1,PVALTR                                               06606021
         L     R1,DX0(R1)                                               06612021
         MVC   END88+NX2(LX2),DX4(R1)                                   06618021
ITEMAA   LA    R6,DX4               REG 6 USED FOR COMP-1 USAGE COMP    06624021
       LH    R9,CON9000           COUNT IS 0 OR 3 AT THIS POINT         06630021
       AH    R9,COUNT             ADD 9 TO COUNT                        06636021
       STH   R9,COUNT             STORE UPDATED COUNT                   06642021
         LA    R9,DX3              R9 USED FOR COMP-1 USAGE TEST        06648021
         CLC   NXTLEV(LX1),SRCELN  COMPARE CURRENT ITEM LEVEL NUMBER    06654021
         BC    NOTHI,BELEMI       NEXT ITEM LEVEL NUM , IF NXTLEV I     06660021
         CLI   NXTLEV,XX32         GREATER THAN CURRENT LEVEL AND NO    06666021
         BC    NOTLO,BELEMI        AN FD, SD, SA, RD, OR 88,THE CUR     06672021
*                                 ITEM IS A GROUP ITEM, OTHERWISE I     06678021
*                                 AN ELEMENTARY ITEM.                   06684021
*BGROUP      IF ITEM IS ON GROUP LEVEL, THE MINOR CODE IS MADE          06690021
*FIXED LGN GROUP AND THE DICTIONARY ACCESS PARAMETER IS MADE GROUP.     06696021
BGROUP   OI    MINCOD,XX10     SET MINOR CODE IN ATTR TO FIXED LGN G    06702021
         MVI   BCIPRM,XX0C     MOVE GROUP CODE TO ACCESS PARAMETER      06708021
         CLI   LEVSAV,XX00   LAST LEVEL HAVE CONDVAR?             07271 06714021
         BC    EQ,BGRCOM     NO - CHK GROUP COMPATIBILITY         07271 06720021
         CLC   LEVSAV(LX1),SRCELN  CI SUBORDINATE TO LAST?        07271 06726021
         BC    NOTLO,BGRP1   NO - CHK GROUP COMPATIBILITY         07271 06732021
         TM    PITMCL+NX1,XX20  PIC CLAUSE ON LAST LEVEL?         07271 06738021
         BC    ZERO,BGRP1    NO                                   07271 06744021
         BAL   R4,LDEROR                                          07271 06750021
         DC    X'20E1'       MSG 225                              07271 06756021
BGRP1    MVI   LEVSAV,XX00   RESET SAVE LEVEL                     07271 06762021
         BC    UNCOND,BGRCOM  BRANCH TO GROUP COMPATIBILITY RTN--GR     06768021
BELEMI   EQU   *                                                  07271 06774021
         CLI   LEVSAV,XX00   PREVIOUS ITEM WITH CONDVAR?          07271 06780021
         BC    EQ,BELM1      NO                                   07271 06786021
         CLI   SRCELN,XX33   CURRENT ITEM AN 88?                  07271 06792021
         BC    EQ,BELM1      YES                                  07271 06798021
         CLC   LEVSAV(LX1),SRCELN  NO- LAST LEVEL REALLY A GROUP? 07271 06804021
         BC    NOTLO,BELM0   NO - PROCESS CURRENT ITEM            07271 06810021
         TM    PITMCL+NX1,XX20  YES- PIC CLAUSE ON LAST LEVEL?    07271 06816021
         BC    ZERO,BELM0    NO - VALID GROUP WITH 88'S           07271 06822021
         CLI   SRCELN,XX32         IS CURRENT ITEM 77             07271 06828021
         BE    BELM0               IF SO, NOT SUBORDINATE ITEM    07271 06834021
         BAL   R4,LDEROR                                          07271 06840021
         DC    X'20E1'       MSG 225                              07271 06846021
BELM0    MVI   LEVSAV,XX00   RESET SAVE LEVEL                     07271 06852021
BELM1    CLI   NXTLEV,XX33   IS NEXT ITEM A LEVEL 88?             07271 06858021
         BC    NOTEQ,BELEM3        NO                                   06864021
         MVI   BCIPRM,XX0C          YES, ITEM WILL BE ENTERED INTO T    06870021
         OI    SW88,XX01             DICTIONARY AS A GROUP ITEM         06876021
         MVC   LEVSAV(LX1),SRCELN   SAVE ITEM'S LEVEL UNTIL NEXT        06882021
*                                   NON-88 ITEM IS GOTTEN TO CHECK      06888021
*                                   THIS ITEM IS REALLY  ELEMENTARY     06894021
         TM    ITMCLS,XX07          USAGE IS INDEX                      06900021
         BC    NOTONE,BELEM2       NO                                   06906021
         OI    ERR88,SWON          TURN ERROR SW ON                     06912021
         BAL   R4,LDEROR           LNK TO GET MESS# IN REG 0            06918021
         DC    X'200B'             MSG 11                               06924021
         B     BELEMJ              GO PROCESS                           06930021
BELEM2   TM    ITMCLS+NX1,XX20      PICTURE CLAUSE PRESENT?             06936021
         BO    BELEMJ              YES                                  06942021
       SR    R8,R8                                                      06948021
       IC    R8,ITMCLS             INSERT USAGE                         06954021
       N     R8,MK3032             ZERO OUT ALL OUT                     06960021
       CR    R8,R9                 COMP-1                               06966021
       BE    BELEMJ                YES, OK                              06972021
       CR    R8,R6                 COMP-2                               06978021
       BE    BELEMJ                YES, OK                              06984021
         CLI   SRCELN,LEV77        IS IT 77 IN ERROR                    06990021
         BE    BELEMJ              YES, OK                              06996021
         OI    MINCOD,XX10          NO, ASSUME GROUP                    07002021
         OI    GRP88,SWON          TURN SW ON                           07008021
         B     BGRCOM              GO CHK IF GRP ITM HAS PIC CLSE       07014021
BELEM3   MVI   BCIPRM,XX08                                              07020021
BELEMJ   TM    ITMCLS,XX07          USAGE IS INDEX                      07026021
         BC    NOTONE,BELM4        NO                                   07032021
         OI    MINCOD,XX70          SET MINOR CODE                      07038021
         MVI   USGIND+NX1,XXE2      SET SIGH                            07044021
         MVI   USGIND+NX2,XXF9      SET 9                               07050021
         TM    ITMCLS,XX80          BLANK WHEN ZERO                     07056021
         BO    BELEME              YES, ERROR                           07062021
BELEMA   TM    ITMCLS,XX40          JUSTIFIED                           07068021
         BO   BELEMF               YES, ERROR                           07074021
BELEMB   TM    ITMCLS,XX38          VALUE                               07080021
         BC    NOTZER,BELEMG       YES                                  07086021
BELEMC   TM    ITMCLS+NX1,XX20      PICTURE CLAUSE                      07092021
         BO    BELEMH              YES                                  07098021
         OI    ITMCLS+NX1,XX20      SET PICTURE BIT ON                  07104021
BELEMD   LR    R8,R7               SAVE R7                              07110021
         LA    R7,USGIND           FOR GSPICT RTN                       07116021
         ST    R15,RSAVE+NX60                                           07122021
         L     R15,AGSPIC          GO                                   07128021
         BALR  R14,R15                 VALIDATE                         07134021
         L     R15,RSAVE+NX60               PICTURE                     07140021
         LR    R7,R8               RESTORE R7                           07146021
         B     PICTAN              GO TO CLEAR PICTURE ERROR BYTE       07152021
BELEME   NI    ITMCLS,XX7F          ZERO OUT BLANK WHEN ZERO CLAUSE     07158021
         BAL   R4,LDEROR           LNK TO GET MESS# IN REG 0            07164021
         DC    X'2072'                                                  07170021
         B     BELEMA              BRH TO TEST ITMCLS                   07176021
BELEMF   NI    ITMCLS,XXBF          ZERO OUT JUSTIFIED CLAUSE           07182021
         BAL   R4,LDEROR           LNK TO GET MESS# IN REG 0            07188021
         DC    X'2072'                                                  07194021
         B     BELEMB              BRH TO TEST ITMCLS FOR X'38'         07200021
BELEMG   NI    ITMCLS,XXC7          ZERO OUT VALUE CLAUSE           002 07206021
         BAL   R4,LDEROR           LNK TO GET MESS# IN REG 0            07212021
         DC    X'2072'                                                  07218021
         B     BELEMC              BRH TO TEST AND SET PIC BIT ON       07224021
BELEMH   BAL   R4,LDEROR           LNK TO GET MESS# IN REG 0            07230021
         DC    X'2072'                                                  07236021
         B     BELEMD              BRH, SET UP REGS TO VALID.PIC        07242021
BELM4    TM    ITMCLS+NX1,XX20      IS THERE PICT CLAUSE                07248021
         BC    ONES,PICTAN    YES                                       07254021
         IC    R8,ITMCLS           NO, INSERT CLAUSE FIELD INTO REG     07260021
         N     R8,MK3032           ZERO ALL BITS EXCEPT USAGE BITS      07266021
         CR    R8,R9                  IS USAGE COMP-1                   07272021
         BC    EQ,BSHTPR      YES                                       07278021
         CR    R8,R6               NO, IS USAGE COMP-2                  07284021
         BC    EQ,BLNGPR           YES                                  07290021
         BAL   R4,LDEROR           NO, CALL ERROR                       07296021
         DC    X'1097'             151                                  07302021
         BC    UNCOND,BFIXPD       GO TO PICTURE ERROR                  07308021
BLNGPR   SLA   R6,DX1          YES, SHIFT REG 6 TO MAKE CONTENTS = 8    07314021
         STH   R6,CILGN       STORE 8 IN MACHINE LGN FIELD OF CI        07320021
         OI    MINCOD,XXA0    SET MINOR CODE TO INTERNAL FLOATING PO    07326021
         MVI   VILGN+NX1,XX01  SET DOUBLE PRECISION BIT ON IN ATTRIB    07332021
         TM    ITMCLS,XX80          BLANK WHEN ZERO                     07338021
         BZ    BELCOM              NO                                   07344021
         BAL   R4,LDEROR           YES, ERROR                           07350021
         DC    X'2025'             MSG 37                               07356021
         BC    UNCOND,BELCOM       BRH, TEST FOR JUSTIFY CLAUSE         07362021
BELEM4   BAL   R4,LDEROR           CALL ERROR RTN- COMP-1 HAS PICTU     07368021
         DC    X'0071'             113            PICTURE DROPPED       07374021
         XC    GRP88(LX1),GRP88     TURN OFF SW                         07380021
         B     BELEMJ              COMP ROUTINES                        07386021
BSHTPR   STH   R6,CILGN       STORE 4 IN MACHINE LGN FIELD OF CI        07392021
         OI    MINCOD,XXA0    SET MINOR CODE TO INTERNAL FLOATING PO    07398021
         TM    ITMCLS,XX80          BLANK WHEN ZERO                     07404021
         BZ    BELCOM              BRH ON 0,TEST FOR JUSTIFY CLSE       07410021
         BAL   R4,LDEROR           YES, ERROR                           07416021
         DC    X'2025'             MSG 37                               07422021
         BC    UNCOND,BELCOM  THE PRECISION BIT IN ATTRIBUTES IS ZE     07428021
*                                                                       07434021
* CHECK TO SEE IF GROUP ITEM HAS ILLEGAL CLAUSES                        07440021
*                                                                       07446021
BGRCOM   TM    ITMCLS+NX1,XX20 DOES GROUP ITEM HAVE PICTURE CLAUSE      07452021
         BC    ONES,BGRPIC    YES                                       07458021
BGRCON   TM    ITMCLS,XX80     DOES GRP ITEM HAVE BLANK WHEN ZERO CL    07464021
         BC    ONES,BGRBWZ    YES                                       07470021
BGRPJU   TM    ITMCLS,XX40     NO, DOES GRP ITEM HAVE JUSTIFIED CLAU    07476021
         BC    NOTONE,BMAJOR  NO, GO TO MAJOR CODE ROUTINE              07482021
         NI    ITMCLS,XXBF     YES, ZERO OUT JUSTIFIED CLAUSE BIT (E    07488021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   07494021
         DC    X'2024'             36                                   07500021
         BC    UNCOND,BMAJOR  GO TO MAJOR CODE ROUTINE                  07506021
BGRBWZ   NI    ITMCLS,XX7F     ZERO OUT BLANK WHEN ZERO CLAUSE (E-TE    07512021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   07518021
         DC    X'2023'             35                                   07524021
         BC    UNCOND,BGRPJU       BRH,GRP ITEM HAS JUSTIFY CLSE?       07530021
BGRPIC   NI    ITMCLS+NX1,XXDF DELETE PICTURE CLAUSE(ETEXT)             07536021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   07542021
         DC    X'2022'             34                                   07548021
         BC    UNCOND,BGRCON       BRH,GRP ITM HAS BLANK WHEN 0?        07554021
*=2      PICTURE TYPE ANALYSIS-PICTAN                                   07560021
PICTAN   MVI   BPERRO,XX00     CLEAR PICTURE ERROR BYTE                 07566021
         CLI   PCTYPE,XX04          IS PICTURE REPORT                   07572021
         BC    NOTEQ,PICTA                NO, BR                  46170 07578021
         TM    ITMCLS,XX06          YES, IS USAGE DISPLAY-ST            07584021
         BC    NOTONE,PICTA               NO, BR                  46170 07590021
         MVI   PCTYPE,XX07          YES, SET PCTYPE TO STERL REPORT     07596021
*                                      ( USAGE ON GROUP ITEM )          07602021
PICTA    EQU   *                                                  46170 07608021
         CLI   PCTYPE,XX06              IS IT STER-NON-REPT       46170 07614021
         BNE   PICTA1                     NO, BR                  46170 07620021
         TM    ITMCLS,XX06              IS USAGE DISP-ST          46170 07626021
         BO    PICTA1                     YES, BR                 46170 07632021
         MVI   PCTYPE,XX08              NO, CHNGE TO EDITED       46170 07638021
PICTA1   TM    ITMCLS+NX1,XX04      IS IT SPECIAL REPORT S.NAME         07644021
         BC    ONES,PICTRP         YES, BRANCH                          07650021
         TM    ITMCLS,XX80     IS BWZ CLAUSE SPECIFIED                  07656021
         BC    NOTONE,BPICAL  NO                                        07662021
         CLI   PCTYPE,XX03     YES, IS PICTURE TYPE NUMERIC             07668021
         BC    EQ,BPICNM      YES                                       07674021
         CLI   PCTYPE,XX04     NO, IS PICTURE TYPE REPORT               07680021
         BC    EQ,BLDPTY      YES                                       07686021
         CLI   PCTYPE,XX07          NO, IS PICTURE TYPE STERL. REPOR    07692021
         BC    EQ,BLDPTY           YES                                  07698021
         NI    ITMCLS,XX7F     NO, DELETE BLANK WHEN ZERO CLAUSE        07704021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   07710021
         DC    X'2025'             37                                   07716021
BPICAL   CLI   PCTYPE,XX01     IS PICTURE TYPE ALPHABETIC               07722021
         BC    NOTEQ,BPICAN   NO                                        07728021
         LA    R3,DX32(R0,R0)  YES,SET BITS 24-27 OF REG3 TO MINOR C    07734021
         BC    UNCOND,BLDPTY       BRH,SET UP FOR PIC ANAL RTN          07740021
BPICAN   CLI   PCTYPE,XX02     IS PICTURE TYPE ALPHANUMERIC             07746021
         BC    NOTEQ,BPICFF   NO                                        07752021
         LA    R3,DX48(R0,R0)  YES, SET BITS 24-27 OF REG3 TO MINOR     07758021
         BC    UNCOND,BLDPTY       BRH, SET UP FOR PIC ANAL RTN         07764021
BPICFF   CLI   PCTYPE,XXFF     IS PICTURE TYPE ILLEGAL                  07770021
         BC    EQ,BYTERR           BRH ON = TO CALL ERROR RTN           07776021
BLDPTY   SR    R4,R4               NO                                   07782021
         IC    R4,PCTYPE             INSERT PICTURE TYPE CODE INTO      07788021
         SLA   R4,DX2          MULTIPLY BY 4 FOR FULL WORD BNDRY        07794021
         LA    R8,BPICTB      LOAD PICTURE TABLE ADDRESS IN REG 8       07800021
         AR    R8,R4          ADD INDEX(R4) TO ADDRESS OF ADDRESS T     07806021
         ST    R15,RSAVE+NX60  SAVE REG 15                              07812021
         L     R15,DX0(R0,R8) PUT TABLE ADDRESS IN R15                  07818021
         BALR  R14,R15        CALL CURRENT PICTURE ANALYSIS RTN         07824021
         LTR   R14,R15        IF PICTURE ROUTINE DROPS CURRENT ITEM     07830021
         L     R15,RSAVE+NX60   PICTURE, REG 15 WILL BE SET TO ZERO     07836021
         BC    ZERO,BFIXPC      A BRANCH WILL BE TAKEN TO BFIXPC        07842021
         BC    UNCOND,BELCOM       BRH,TEST FOR JUSTIFY CLAUSE          07848021
BPICNM   MVI   PCTYPE,XX04     CHANGE PICTURE TYPE TO REPORT            07854021
         BC    UNCOND,PICTAN       BRH, TO CLEAR PIC ERROR BYTE         07860021
BELCOM   TM    ITMCLS,XX40     IS JUSTIFIED CLAUSE SPECIFIED            07866021
         BC    NOTONE,BMAJOR  NO, GO TO MAJOR CODE ROUTINE              07872021
         CLI   PCTYPE,XX02     YES, IS ITEM ALPHABETIC OR ALPHANUMER    07878021
         BH    BDRPJB              NO, SEE IF EDITED                    07884021
         CLI   PCTYPE,XX00     MAYBE, IS ITEM INTERNAL FLT PT           07890021
       BE    BDRPJC                YES, ERROR                           07896021
       B     BDRPJD                NO, GO SET BIT ON                    07902021
BDRPJB   CLI   PCTYPE,XX08          AN EDITED                           07908021
         BNE   BDRPJC              NO, ERROR                            07914021
BDRPJD   OI    LEVNUM,XX01          NO, SET JUSTIFIED CLAUSE BIT ON     07920021
         BC    UNCOND,BMAJOR    GO TO MAJOR CODE ROUTINE                07926021
BDRPJC   NI    ITMCLS,XXBF     DROP JUSTIFIED CLAUSE                    07932021
         BAL   R4,LDEROR           CALL ERROR ROUTINE                   07938021
         DC    X'2028'             40                                   07944021
         BC    UNCOND,BMAJOR       BRH TO MOVE MAJ CDE TO ATTRIB        07950021
BYTERR   BAL   R4,LDEROR           CALL ERROR ROUTINE                   07956021
         DC    X'1027'             39                                   07962021
         BC    UNCOND,BFIXPD       BRH TO CHG PIC TYPE TO NUMERIC       07968021
BFIXPC   BAL   R4,LDEROR+NX4        CALL ERROR RTN                      07974021
         DC    X'0000'             ERROR NUMBER IS IN REG 0             07980021
BFIXPD   MVI   PCTYPE,XX03          CHANGE PICTURE TYPE TO NUMERIC      07986021
         MVC   IPT(LX2),BFIXCN LOAD 1 BYTE CONSTANT PICTURE 9           07992021
         MVC   IPLT(LX4),BFIXCN+NX2  INTO ELITEM                        07998021
         MVI   BPERRO,XX01     SET PICTURE ERROR SWITCH TO ONE          08004021
         TM    ITMCLS,XX06                                              08010021
         BC    NOTONE,BLDPTY       NOT 1,SET UP FOR PIC ANAL RTN        08016021
         MVI   PCTYPE,XX07                                              08022021
         BC    UNCOND,BLDPTY       BRH TO SET UP FOR PIC ANAL RTN       08028021
BMAJOR   OC    COUNT(LX1),MCI  MOVE MAJOR CODE TO ATTRIBUTES            08034021
*=2      GET DICTIONARY POINTER-BGETDP                                  08040021
BGETDP   BAL   R4,GETDPT           GET DICTIONARY POINTER FOR ITEM      08046021
         BAL   R4,BCONDE           CHECK FOR COND. VAR. DELINITOR       08052021
BLEVNM   SR    R3,R3                                                    08058021
         IC    R3,SRCELN           SOURCE LEVEL =                       08064021
         CLI   SRCELN,XX31          IS LEVEL 01-49                      08070021
         BC    HI,BLEVN1           NO                                   08076021
         ST    R15,RSAVE+NX60                                           08082021
         L     R15,ANORML          YES, NORMALIZE LEVEL NUMBER          08088021
         BALR  R14,R15             LNK TO ADDR IN REG 15                08094021
         L     R15,RSAVE+NX60                                           08100021
BLEVN1   SLA   R3,DX2               PUT IN HI 6 BITS OF                 08106021
         EX    R3,BLEVEL             LEVNUM IN ATTRIBUTES               08112021
         TM    MINCOD,XX02     DOES ITEM HAVE AN OCCURS CLAUSE          08118021
         BC    NOTONE,BCALDB  NO                                        08124021
         SR    R9,R9               YES, MOVE THE DICTIONARY POINTER     08130021
         IC    R9,OCT                   OF CI TO                        08136021
         M     R8,THREE                   TABLE FOR                     08142021
         LA    R8,BDPTAB                    MBS                         08148021
         AR    R8,R9                          ROUTINE                   08154021
         MVC   DX0(LX3,R8),DICTPT+NX1                                   08160021
BCALDB   ST    R15,DSAVE                                                08166021
         L     R15,ADICTB                                               08172021
         BALR  R14,R15        CALL DICTIONARY BUILD                     08178021
         L     R15,DSAVE                                                08184021
DUMP   DS    0H                                                         08190021
         L     R4,GETSAV+NX4        GET RETURN ADDRESS                  08196021
         BCR   UNCOND,R4           RETURN                               08202021
GETDPT   EQU   *                                                        08208021
         ST    R15,SAVE15                SAVE BASE REG                  08214021
         L     R15,ASUBRTN                SET UP NEW BASE               08220021
         ST    R4,SAVE4                   SAVE RETURN REG               08226021
         L     R4,AGETDP                   ADDRESSIBILITY               08232021
         BALR  R14,R4                   BR TO GET DICT PT               08238021
         L     R15,SAVE15                  RESTORE BASE                 08244021
         L     R4,SAVE4                  RETURN ADDRESS                 08250021
         BR    R4                          RETURN                       08256021
BCONDE   TM    SW88,XX02            IS THIS ITEM A CONDITIONAL VARIA    08262021
         BC    NOTONE,BGETD2       NO,BRANCH                  DELIM     08268021
         NI    SW88,XXFD            YES, TURN SW OFF                    08274021
         MVC   DEL88(LX4),DICTPT    STORE COND VAR DELIMITER            08280021
         LA    R1,CONVAR                                                08286021
         ST    R15,TSAVER          CALL ENTDEL TO STORE DELIMITOR       08292021
         L     R15,AENTDE            IN DICTIONARY FOR COND. VAR.       08298021
         BALR  R14,R15             LNK TO ADDR IN REG 15                08304021
         L     R15,TSAVER                                               08310021
BGETD2   TM    SW88,XX01            IS THIS ITEM A CONDITIONAL VARIA    08316021
         BCR   NOTONE,R4           NO, RETURN                           08322021
         MVC   CONVAR(LX4),DICTPT   YES, SAVE  DICTIONARY  POINTER      08328021
         BCR   UNCOND,R4           BRH TO ADDR IN REG 4                 08334021
BDDTAB   MVC   WS+NX4(LX1),FAPAF+NX2 1ST BL= FOR WSADEF                 08340021
         OI    WSRSW,XX01           SET WS SW ON                        08346021
         MVC   RAPAF(LX7),APAF      SAVE APAF FOR REPORT SECTION        08352021
         BC    UNCOND,BEGIN0       GO TO SECTION DETERMINER             08358021
BLEVEL   OI    LEVNUM,XX00                                              08364021
*                                                                       08370021
* COMMON ERROR ROUTINE FOR LDTEXT                                       08376021
*                                                                       08382021
LDEROR   LH    R0,DX0(R4)           GET MESSAGE NUMBER IN REG 0         08388021
         ST    R15,TSAVER                                               08394021
         L     R15,AERRTN                                               08400021
         BALR  R14,R15             CALL ERROR ROUTINE                   08406021
         L     R15,TSAVER                                               08412021
         LA    R4,DX2(R4)                                               08418021
         BCR   UNCOND,R4           RETURN TO CALLER                     08424021
PICTRP   MVC   IPT(LX2),EIGHT+NX2                                       08430021
         STM   R2,R15,RSAVE+NX8                                         08436021
         LA    R1,IPT                                                   08442021
         L     R15,AQUAL           CALL QUAL TO,LOOK UP ATTRIBUTES      08448021
         BALR  R14,R15              E.NAME, CHANGE TO EQUIVALENT IN     08454021
         LM    R2,R15,RSAVE+NX8      INTERNAL DECIMAL                   08460021
         MVC   LEVNUM(LX3),IPLT                                         08466021
         STH   R1,CILGN                                                 08472021
         OI    MINCOD,XXC0          SET MINOR CODE TO INTERNAL DECIM    08478021
         OI    LEVNUM,XX01               SET ON S FOR S.NNNN            08484021
         BC    UNCOND,BELCOM       BRH TO TEST FOR JUSTIFY CLAUSE       08490021
*DEL                                                                    08496021
*DEL                                                                    08502021
       EJECT                                                            08508021
*SUBRTN - SUBROUTINE CSECT                                              08514021
*                                                                       08520021
*CHKFD - SUBROUTINE TO DETERMINE IF FD IS MISSING OR DISCARDED          08526021
*        FROM SOURCE - WILL PROCESS RECORD DESCRIPTION AS IF FD         08532021
*        WERE PRESENT.                                                  08538021
*                                                                       08544021
IKF201A  CSECT                                                          08550021
         USING *,R15                                                    08556021
SUBRTN   EQU   *                                                        08562021
CHKFD    EQU   *                                                        08568021
         TM    NOFDSW,FSTFDBIT                                          08574021
         BO    FIL095              YES. BRANCH                          08580021
         TM    NOFDSW,NOFDBIT      NO. IS THIS THE FIRST SUCH REC       08586021
         BO    FIL095              NO. BRANCH                           08592021
*                                                                       08598021
* THE FD IS MISSING FROM SOURCE OR DISCARDED  -  THE FOLLOWING          08604021
* WILL SET UP CONDITIONS AS IF IT WERE PRESENT IN ORDER TO PROCESS      08610021
* THE RECORD DESCRIPTION.                                               08616021
*                                                                       08622021
         OI    NOFDSW,NOFDBIT      YES-SET SW&PROCESS REC W/OUT FD      08628021
         XC    FD(LX4),FD          INITIALIZE                           08634021
         LH    R1,BLCTR-COS(RCOM)                                       08640021
         LA    R1,DX1(R1)          INCREMENT                            08646021
         STC   R1,FD+NX2              AND                               08652021
         STC   R1,FAPAF+NX2              SAVE                           08658021
         STH   R1,BLCTR-COS(RCOM)           BL NUMBER                   08664021
FIL095   DS    0H                                                       08670021
         TM    DX6(R7),XX10        COPY CLAUSE PRESENT ??               08676021
         BO    FIL095A                                                  08682021
         MVC   PLBLSW(LX1),LBLSW                                        08688021
         NI    LBLSW,XXBF                                               08694021
FIL095A  DS    0H                                                       08700021
         MVI   MCI,XX00            SET MAJOR CODE = FD                  08706021
         L     R15,ABEGIN                                               08712021
         BR    R14                           RETURN                     08718021
         EJECT                                                          08724021
GETDP    EQU   *                                                        08730021
         ST    R14,SAVE14                SAVE RETURN ADDR               08736021
         MVC   BCIPRM+NX1(LX3),ACI      ADDR OF BCD NAME                08742021
         SR    R1,R1                                                    08748021
         IC    R1,COUNT                  GET ATTRIBUTE CNT              08754021
         SRL   R1,DX4                          IN REG 1                 08760021
         LTR   R1,R1                        TEST COUNT                  08766021
         BC    POS,GETDP1                GET COUNT FROM N FIELD         08772021
         IC    R1,VILGN                 IN VILGN AND ADD 8 FOR TOT      08778021
         LA    R1,DX8(R1)               ATTRIB CNT (REPT PIC)           08784021
GETDP1   TM    ATTRIB,XX08                TEST MAJOR CODE               08790021
         BZ    GETDP2                     NOT FD ENTRY                  08796021
         TM    ATTRIB,XX05              IS THIS FD ENTRY                08802021
         BC    NOTZER,GETDP2            NO, SOMETHING ELSE              08808021
         SR    R3,R3                    YES- CALC ATTRIB CNT            08814021
         SR    R1,R1                                                    08820021
         IC    R3,FDVCNT                VARIABLE PORTION COUNT          08826021
         IC    R1,FDCUNT                FIXED PORTION CNT               08832021
         SRL   R3,DX4                                                   08838021
         SRL   R1,DX4                                                   08844021
         AR    R1,R3                    ADD TO GET TOTAL CNT            08850021
GETDP2   STC   R1,BCIPRM+NX4            STORE CNT IN PARM LIST          08856021
         L     R1,ACIPRM                R1 = A(PARMATER LIST)           08862021
         ST    R15,TSAVER                                               08868021
         L     R15,BGETPT               CALL GETPTR OF ACCESS           08874021
         BALR  R14,R15                  LNK TO ADDR IN REG 15           08880021
         L     R15,TSAVER               R1 = DICTPTR FROM GETPTR        08886021
         ST    R1,DICTPT                  SAVE DICTPTR                  08892021
         ST    R1,REALPTR                                               08898021
         L     R3,COSADR                                                08904021
         TM    PHZSW1,XREF              IS XREF SPEC'D                  08910021
         BZ    GETDP3                    NO, BR                         08916021
         LA    R1,CI                    A(BCDNAME)                      08922021
         L     R15,AXREF                   YES                          08928021
         BALR  R14,R15                  GENERATE XREF ELEMENT           08934021
         L     R15,TSAVER                                               08940021
GETDP3   L     R14,SAVE14                    RETURN ADDR                08946021
         BR    R14                          RETURN                      08952021
SAVE14   DC    F'0'                     SAVE RETURN REG                 08958021
         EJECT                                                          08964021
         EJECT                                                          08970021
*                                                                       08976021
         EJECT                                                          08982021
*                                                                       08988021
IKF201B  CSECT                                                          08994021
CKETXTA  DS    0H                                                       09000021
*                                                                       09006021
*                                                                       09012021
*SUBRTN - CHETXT CSECT                                                  09018021
*CKETXT - ALL ERROR TEXT COMING I TO PH2 ARE HANDLED BY THIS RTN        09024021
*                                                                       09030021
         USING *,R15                                                    09036021
         USING ICLDST,R7                                                09042021
CKETXT   EQU   *                                                        09048021
ERR010   DS    0H                      PUT HIGHEST SEVERITY             09054021
*                                      ON F3 INTO ERRSEV FOR PH6        09060021
         ST    R14,SVR14           SAVE REG14                           09066021
         CLI   DX2(R7),XX00            PARAMETER ??                     09072021
         BNE   ERR030                  YES, SKIP CHECK                  09078021
         SR    R1,R1                                                    09084021
         IC    R1,DX7(R7)              PIC UP SEVERITY                  09090021
         SRL   R1,DX4                  GET RID OF PHASE #               09096021
         LA    R1,DX1(R1)              ADD 1                            09102021
         SLL   R1,DX2                  MULTIPLY BY 4                    09108021
         CH    R1,TWELVE+NX2           12 OR HIGHER ??                  09114021
         BNH   ERR020                  NO                               09120021
         LA    R1,DX16                 RETURN HIGHEST SEVERITY          09126021
ERR020   DS    0H                                                       09132021
         STC   R1,FULLWD                                                09138021
         CLC   FULLWD(LX1),ERRSEV                                       09144021
         BNH   ERR030                  THIS SEVERITY LOWER THAN LAST    09150021
         STC   R1,ERRSEV               NEW HIGH SEVERITY INTO ERRSEV    09156021
ERR030   DS    0H                                                       09162021
         L     R1,COSADR                                                09168021
         LR    R2,R7                   CALL COS TO                      09174021
         BALR  R0,R1                   PUT OUT THE E-TEXT               09180021
         DC    X'24'                                                    09186021
         LR    R4,R5                   LOAD E-TEXT COUNT                09192021
*                                                                       09198021
*                                                                       09204021
*                                                                       09210021
         CLC   DX3(LX2,R7),SRLIB       SOURCE LIB  ???                  09216021
         BNE   RETURN1                 NO, BRANCH                       09222021
         EX    R4,MOVETXT              SAVE ETXT OF COPY SOURCE LIB     09228021
         LA    R7,DX2(R4,R7)           UPDATE PTR FOR NEXT ITEM         09234021
         CLI   DX0(R7),XXFF            END OF BUFFER ???                09240021
         BE    COMPFF1                 YES, BRANCH                      09246021
CKCONT   CLC   SRLIBSV+DX3(LX2),DX3(R7)   NO, CHECK CARD NO             09252021
         IC    R4,DX1(R7)          PICK UP ITEM LENGTH                  09258021
         BNE   CKEXIT              IF NOT SAME CARD NO,  BRANCH         09264021
         NI    ICLFL2,XXEF         TURN OFF COPY SW                     09270021
RETURN1  LA    R7,DX2(R0,R7)       MOVE UP PTR TWO BYTES                09276021
*                                                                       09282021
         L     R14,SVR14                                                09288021
         L     R15,ABEGIN              RESTORE REG15 BEFORE RETURN      09294021
         BR    R14                                                      09300021
*                                                                       09306021
COMPFF1  L     R1,COSADR                                                09312021
         BALR  R0,R1                   READ FILE-3 INPUT                09318021
         DC    X'03'                                                    09324021
         BE    ENDF3                                                    09330021
         LR    R7,R0                   PICK UP BUFFER PTR               09336021
         CLC   R0(LX1,R7),XX03     IC TEXT ???                          09342021
         BNE   CKEXIT                  NOT IC TEXT OF 03                09348021
         SR    R5,R5               CLEAR REG5                           09354021
         IC    R1,DX1(R7)          INSERT LENGTH OF IC TEST             09360021
         CLC   DX2(LX1,R7),XX01        01 LEVEL OF ICTEXT               09366021
         BNE   CKEXIT                  NO, CKEXIT TO RETURN             09372021
         B     CKCONT                  GO TO UPDATE BUFFTER PTR         09378021
*                                                                       09384021
CKEXIT   L     R14,ATYPRC           PICK UP ADD OF READ F3 RTN          09390021
         L     R15,ABEGIN              RESTORE R15 BEFORE RETURN        09396021
         BR    R14                     GO TO CHECK ICTEXT               09402021
*                                                                       09408021
ENDF3    L     R14,AENDDIV             PIC UP END DIV RTN ADD           09414021
         L     R15,ABEGIN              RESTORE R15 BEFORE RETURN        09420021
         BR    R14                     BRANCH TO END OF DIV HANDL       09426021
         DROP  R7                                                       09432021
*                                                                       09438021
MOVETXT  MVC   SRLIBSV,DX2(R7)         MOVE TEXT OF ERROR MESG          09444021
*                                                                       09450021
*                                                                       09456021
SRLIB    DC    X'002F'                 ERROR MESG NO FOR COPY LIB       09462021
SRLIBSV  DS    10C                     SAVED ETEXT                      09468021
AENDDIV  DC    A(ENDDIV)                                                09474021
ATYPRC   DC    A(BTYPRC)                                                09480021
SVR14    DS    F                                                        09486021
*                                                                       09492021
*                                                                       09498021
*                                                                       09504021
         EJECT                                                          09510021
*=2          USAGE CLAUSE ROUTINE - BUSAGE                              09516021
*BUSAGE    CHECKS FOR USAGE CLAUSE COMPATIBILITY.  ALL ELEMENTARY       09522021
*ITEMS MUST HAVE THE SAME USAGE AS THEIR GROUP ITEM IF A USAGE WAS      09528021
*SPECIFIED FOR THE GROUP ITEM.                                          09534021
BUSAGE   TM    FESB,XX02                HAS LEVEL 01 APPRD              09540021
         BC    ONES,BUSAGG              YES, BR                         09546021
         CLI   SRCELN,XX32              NO, IS ITEM LEVEL NUMBER 77     09552021
         BC    EQ,BUSAGG                YES, BR                         09558021
         MVI   SRCELN,XX01              NO, MAKE ITEM LEVEL 01          09564021
         L     R3,ALDERR                ADDR OF ERR RTN                 09570021
         L     R15,ABEGIN               ADDRESSABILITY                  09576021
         BALR  R4,R3                      BRANCH                        09582021
         DC    X'101D'                  MSG. NO. 29                     09588021
         L     R15,ACKETXT               ADDRESSABILITY                 09594021
         L     R4,ABCOPY                 ADDR OF BCOPY                  09600021
         L     R15,ABEGIN               ADDRESSABILITY                  09606021
         BR    R4                       BR TO COMPARE FILE SECTION      09612021
BUSAGG   SR    R4,R4                    CLEAR REGS 4                    09618021
         SR    R8,R8                            AND 8                   09624021
         CLI   GLN,XX00                 IS CURRENT GRP LEVEL NO. = 0    09630021
         BC    NOTEQ,BCURGP             NO, BRANCH                      09636021
BCIUSA   IC    R4,ITMCLS                YES, GET USAGE CODE             09642021
         N     R4,MK3032                          INTO REG. 4           09648021
         CR    R4,R8                    IS USAGE SPECD FOR CI           09654021
         BC    NOTEQ,BSETGS               YES                           09660021
         OI    ITMCLS,XX01              NO, SET USAGE TO DISPLAY        09666021
         BC    UNCOND,BITEM             BR FOR ITEM ANALYSIS            09672021
BSETGS   CLI   CILEV,XX32               IS ITEM LEVEL 77                09678021
         BE    BITEM                    NO NEED TO SAVE                 09684021
         STC   R4,GUI                   PIU USAGE IN GRP USAGE FIELD    09690021
         MVC   GLN(LX1),SRCELN          PUT CURRENT ITEM LN IN GROUP LN 09696021
         BC    UNCOND,BITEM             BR FOR ITEM ANALYSIS            09702021
BCURGP   CLC   SRCELN(LX1),GLN          COMPARE CI LEV NO TO GRP LEV NO 09708021
         BC    HI,BCIUSB                CI LEVEL NO HI, BR              09714021
         XC    GLN(LX2),GLN             NOT HIGH, SET GUI & GLN TO 0    09720021
         BC    UNCOND,BCIUSA            BRANCH TO GET USAGE CODE        09726021
BCIUSB   IC    R4,ITMCLS                GET USAGE CODE                  09732021
         N     R4,MK3032                   IN REG 4                     09738021
         CR    R4,R8                    IS USAGE SPEC'D FOR CI          09744021
         BC    NOTEQ,BCOMUS             YES, BRANCH                     09750021
         IC    R4,GUI                   NO, SET CURRENT                 09756021
         IC    R8,ITMCLS                       ITEM'S USAGE             09762021
         AR    R4,R8                          TO GROUP USAGE (GUI)      09768021
         STC   R4,ITMCLS                                                09774021
         BC    UNCOND,BITEM             BR FOR ITEM ANALYSIS            09780021
BCOMUS   IC    R8,GUI                    R8 = GROUP USAGE               09786021
         CR    R4,R8                    COMPARE CI USAGE TO GU          09792021
         BC    EQ,BITEM                  SAME, BR                       09798021
         L     R3,ALDERR                ADDR OF ERR RTN                 09804021
         L     R15,ABEGIN               ADDRESSABILITY                  09810021
         BALR  R4,R3                     BRANCH                         09816021
         DC    X'1021'                  MSG. NO. 33                     09822021
         L     R15,ACKETXT              ADDRESSABILITY                  09828021
         IC    R4,ITMCLS                SET CURRENT                     09834021
         N     R4,MK2529                   ITEM'S USAGE                 09840021
         AR    R4,R8                              TO                    09846021
         STC   R4,ITMCLS                     GUI (GROUP USAGE)          09852021
BITEM    L     R4,AITEM                 ADDR OF ITEMAN                  09858021
         L     R15,ABEGIN               RESTORE R15 BEFORE RETURN       09864021
         BR    R4                       BR FOR ITEM ANALYSIS            09870021
AITEM    DC    A(ITEMAN)                ADDR OF ITEMAN                  09876021
ABCOPY   DC    A(BCOPY)                 ADDR OF BCOPY                   09882021
ALDERR   DC    A(LDEROR)                ADDR OF ERROR RTN               09888021
*                                                                 34194 09894021
*   THIS RTN CHECKS REPORT WRITER ITEM LENGTH AND TRUNC           34194 09900021
*     IF TOO LONG                                                 34194 09906021
*                                                                 34194 09912021
*                                                                 34194 09918021
IKF201C  CSECT                                                    34194 09924021
REPRTCK  DS    0H                                                 34194 09930021
         USING *,R15                                              34194 09936021
         ST    R14,RS14            STORE REG 14 TO RETURN         34194 09942021
         TM    DX6(R7),XX08             IS INT REDEF ON FOR ITEM        09948021
         BNO   TEST01R        NO..GO TEST FOR RPT.LIN ITEM        34194 09954021
         SR    R4,R4          ZERO OUT R4                         34194 09960021
         IC    R4,DX1(R7)     GET LENGTH OF THIS ITEMS TEXT IN R4 34194 09966021
         IC    R4,DX1(R4,R7)  LAST BYTE OF TEXT INTO R4           34194 09972021
         STH   R4,RPTLNLOC    SAVE LOC OF ITEM IN REPORT LINE     34194 09978021
         B     REPRT2B  GO TO NORMAL PROCESSING                   34194 09984021
TEST01R  CLI   DX2(R7),XX01   IS THIS AN 01 OR GROUP ITEM         34194 09990021
         BNE   TEST02R        NO..DO NOT TURN OFF REPORT SWITCH   34194 09996021
         MVI   RPTSW,XX00     TURN SWITCH OFF                     34194 10002021
TEST02R  CLC   DX13(LX7,R7),RPTLIN      IS THIS GEN 01- RPT.LIN         10008021
         BNE   REPRT2B        NO..DONT SET RPT.LIN SWITCH ON      34194 10014021
         OI    RPTSW,XX01     INDICATE RPT.LIN WAS ENCOUNTERED    34194 10020021
REPRT2B  DS    0H                                                 34194 10026021
         L     R15,ABEGIN        ESTABLISH BASE REG TO RETURN     34194 10032021
         L     R14,RS14            RESTORE RETURN REG.            34194 10038021
         BR    R14                 RETURN BACK                    34194 10044021
*                                                                 34194 10050021
*                                                                 34194 10056021
REPRT2A  DS    0H                                                 34194 10062021
         ST    R14,RS14            SAVE RETURN REGISTER           34194 10068021
         CLI   RPTSW,XX01     IS ITEM GENERATED RPT-WTR 01        34194 10074021
         BNE   SETYET         NO..SEE IF ALREADY IN GENERATED 02'S34194 10080021
         OI    RPTSW,XX02     INDICATE RPT.LIN LENGTH SAVED       34194 10086021
         MVC   RPT01LTH(LX4),IPLT  SAVE RPT.LIN LENGTH            34194 10092021
         B     ENDRPTWT         GO TO RETURN RTN                  34194 10098021
SETYET   CLI   RPTSW,XX03     IS THIS RPTWTR & ITEM UNDER RPT.LIN 34194 10104021
         BNE   ENDRPTWT         GO TO RETURN RTN                  34194 10110021
*                             NO MORE REPORT WRITER TESTING       34194 10116021
* THE FOLLOWING STRING IS EXECUTED FOR 02 RPT-WTR GENERATED ITEMS 34194 10122021
         LH    R3,RPT01LTH    GET RPT.LIN LENGTH FOR CALCULATION  34194 10128021
         SH    R3,RPTLNLOC    SUB LOC IN RPT LINE FROM            34194 10134021
*                                      MAX ITEM LENGTH            34194 10140021
         SH    R3,IPLT        SUB LENGTH THIS ITEM                34194 10146021
*                                              FROM MAX ALLOWED   34194 10152021
         LTR   R3,R3          IS THERE ROOM IN RPT LINE           34194 10158021
*                                            FOR THIS ITEM        34194 10164021
         BNM   ENDRPTWT            GO TO RETURN RTN               34194 10170021
         LCR   R3,R3          NO..DETERMINE HOW MANY BYTES        34194 10176021
*                                 TO LARGE                        34194 10182021
         LH    R5,IPLT        GET LENGTH OF PRESENT ITEM          34194 10188021
         SR    R5,R3          TRUNCATE THE LENGTH OF PRESENT ITEM 34194 10194021
         STH   R5,IPLT        PUT NEW ALLOWED LENGTH BACK         34194 10200021
*                                            INTO IPLT            34194 10206021
*                                                                 34194 10212021
         L     R14,ALDEROR         LOAD ADD. OF  LDEROR RTN       34194 10218021
         L     R15,ABEGIN       ESTABLISH BASE REGISTER           34194 10224021
         BALR  R4,R14              BRANCH FOR ERROR MESSAGE       34194 10230021
MSG54    DC    X'10DF'        C LEVEL MSG INDICATION TRUNCATION   34194 10236021
*                                                                 34194 10242021
ENDRPTWT DS    0H                                                 34194 10248021
         SR    R4,R4          RESET R4 TO ZEROES                  34194 10254021
         L     R15,ABEGIN          RESTORE RETURN REG.            34194 10260021
         L     R14,RS14         RESTORE RETURN REG.               34194 10266021
         BR    R14              RETURN TO PROCESS LD TEXT         34194 10272021
*                                                                 34194 10278021
         DROP  R15                                                34194 10284021
RPTSW    DC    X'00'          RPT.LIN INDICATOR                   34194 10290021
RPTLIN   DC    CL7'RPT.LIN'   COMPARAND FOR RPT-WTR GENED NAME    34194 10296021
ALDEROR  DC    A(LDEROR)                 ADD. CONSTANT OF LDEROR  34194 10302021
RPT01LTH DS    H              RPT.LIN LENGTH SAVED HERE           34194 10308021
RPTLNLOC DS    H              HOLDS LOC IN RPT LINE FOR INT REDEF 34194 10314021
*                                                                 34194 10320021
         EJECT                                                    34194 10326021
*BMBSRN DETERMINES THE SUBSCRIPTING REQUIREMENTS FOR AN ITEM. THE       10332021
*    NUMBER OF SUBSCRIPTS REQUIRED IS STORED IN THE MBS FIELD OF TH     10338021
*    ATTRIBUTES. THE DICTIONARY POINTER OF THE PRECEDING ITEM (OF T     10344021
*    NEXT HIGHEST SUBSCRIPTING LEVEL) IS PLACED IN THE ATTRIBUTE FI     10350021
*    OF THE CURRENT ITEM. ONLY 3 LEVELS OF SUBSCRIPTING ARE ALLOWED     10356021
*    AND LEVELS 01 WITH OCCURS CLAUSES HAVE THEIR OCCURS CLAUSES        10362021
*    DELETED. THE FOLLOWING ITEMS WOULD BE ACTED UPON AS FOLLOWS        10368021
*                            *MBS *DICTIONARY PTR TO ITEM *REMARKS      10374021
*    01 A                    *  0 *      NO POINTER FIELD *             10380021
*     02 B OCCURS 7          *  1 *      NO POINTER FIELD *             10386021
*      03 C OCCURS 6         *  2 *      POINTER TO ITEM B*             10392021
*      03 D                  *  1 *      POINTER TO ITEM B*             10398021
*       04 E OCCURS 7        *  2 *      POINTER TO ITEM B*             10404021
*       04 F                 *  1 *      POINTER TO ITEM B*             10410021
*        05 G OCCURS 8       *  2 *      POINTER TO ITEM B*             10416021
*     02 H OCCURS 9          *  1 *      POINTER IS ZERO  *             10422021
*     02 I                   *  0 *      NO POINTER FIELD *             10428021
*     02 J OCCURS 10         *  1 *      NO POINTER FIELD *             10434021
*      03 K OCCURS 6         *  2 *      POINTER TO ITEM J*             10440021
*       04 L OCCURS 7        *  3 *      POINTER TO ITEM K*             10446021
*       04 M OCCURS 8        *  3 *      POINTER TO ITEM K*             10452021
*        05 N OCCURS 9       *  3 *      POINTER TO ITEM M*THE OCCU     10458021
*        05 O                *  3 *      POINTER TO ITEM M* CLAUSE      10464021
*                                                            IS DEL     10470021
*                                                           (OVER 3     10476021
*                                                            LEVELS     10482021
*                                                                       10488021
*BMBSRN IS CALLED BY GETNXT PRIOR TO PROCESSING OF OCCURS...DEPENDI     10494021
*ON NAMES. THE CALLING SEQUENCE IS                                      10500021
*                                                                       10506021
*        ST    R15,RSAVE+60                                             10512021
*        L     R15,AMBSRN     WHERE AMBSRN IS ADCON FOR BMBSRN          10518021
*        BALR  R14,R15                                                  10524021
*        L     R15,RSAVE+60                                             10530021
*                                                                       10536021
IKF202 CSECT                                                            10542021
       USING *,R15                                                      10548021
BMBSRN   STM   R0,R14,RSAVE                                             10554021
         SR    R4,R4                                                    10560021
         IC    R4,OCT          AFTER SR 4,4                             10566021
         LA    R3,OLN          REG 3 CONTAINS ADDRESS OF OCCURS LEV     10572021
         LA    R3,DX0(R3,R4)    AFTER LA 3,OLN                          10578021
BCOMLV   CLC   SRCELN(LX1),DX0(R3) COMPARE CURRENT LEVEL      NUM TABL  10584021
         BC    HI,BCIGRO        NUMBER(CILN) TO OLN               (     10590021
         BC    LO,BCILOW       CILN LESS THAN OLN                       10596021
         TM    MINCOD,XX02      CILN = OLN ,DOES CI HAVE OCCURS CLAU    10602021
         BC    ONES,BSTMBS     YES                                      10608021
         C     R4,ZEROS        NO, IS OLN COUNTER ZERO                  10614021
         BC    EQ,BSTMBS       YES                                      10620021
       BCTR  R4,R0            NO, R4=R4-1                               10626021
         SLA   R4,DX2           SET UP R4 FOR EXECUTION OF SETMBS WH    10632021
         EX    R4,SETMBS        STORES MBS IN CI FIELD                  10638021
         SRA   R4,DX2           RESTORE REG 4  BY RIGHT SHIFT           10644021
       BCTR  R3,R0            DECREMENT OLN POINTER BY ONE              10650021
         BC    UNCOND,BTESTI       BRH TO TEST IF OLN CTR=0             10656021
BCIGRO   TM    MINCOD,XX02      DOES CI HAVE OCCURS CLAUSE              10662021
         BC    ONES,BCIGOO     YES                                      10668021
BSTMBS   SLA   R4,DX2           NO                                      10674021
         EX    R4,SETMBS                                                10680021
         SRA   R4,DX2                                                   10686021
         BC    UNCOND,BTESTI       BRH TO TEST IF OLN CTR=0             10692021
* SET MBS BITS                                                          10698021
*                                                                       10704021
SETMBS   OI    MINCOD,XX00                                              10710021
BCIGOO   CLI   SRCELN,XX01                                              10716021
         BC    EQ,BEROR2       ERROR 01 LEVEL CANNOT HAVE OCCURS CL     10722021
         CLI   SRCELN,XX32          LEVEL 77                            10728021
         BE    BEROR2              BRH TO LNK TO BERORP                 10734021
         C     R4,THREE        NO  IS OLN INDEX EQUAL TO 3              10740021
         BC    NOTLO,BEROR1    ERROR--OVER 3 LEVELS OF SUBSCRIPTS       10746021
         LA    R4,DX1(R0,R4)   ADD ONE TO OLN INDEX                     10752021
         SLA   R4,DX2                                                   10758021
         EX    R4,SETMBS       SET MBS IN CI FIELD                      10764021
         SRA   R4,DX2                                                   10770021
BMOVLN   MVC   DX1(LX1,R3),SRCELN MOVE CILN TO OLN TABLE                10776021
         LA    R3,DX1(R3,R0)  ADD 1 TO OLN INDEX                        10782021
         BC    UNCOND,BTESTI       BRH TO TEST IF OLN CTR=0             10788021
BCILOW   C     R4,ZEROS        IS OLN COUNTER ZERO                      10794021
         BC    EQ,BIISZO       YES                                      10800021
       BCTR  R4,R0            NO, DECREMENT OLN COUNTER BY 1            10806021
       BCTR  R3,R0                 REDUCE VALUE IN REG 3 BY 1           10812021
         BC    UNCOND,BCOMLV       BRH TO COMP CURRT LEVEL # TABL       10818021
BIISZO   TM    MINCOD,XX02      IS OCCURS CLAUSE PRESENT                10824021
         BC    NOTONE,BSTMBS   NO                                       10830021
         CLI   SRCELN,XX01      YES , IS CILN 01                        10836021
         BC    EQ,BEROR2       YES , ERROR-01 LEVEL CANNOT HAVE OCC     10842021
         OI    MINCOD,XX04      SET  MBS FIELD TO 1               CL    10848021
         BC    UNCOND,BMOVLN       BRH TO MOVE CILN TO OLN TABLE        10854021
BTESTI   STC   R4,OCT                                                   10860021
         C     R4,ZEROS            IS OLN COUNTER ZERO                  10866021
         BC    EQ,BLVMBS       YES                                      10872021
         TM    MINCOD,XX02     IF ITEM HAS AN OCCURS                    10878021
         BC    NOTONE,BTESTJ        CLAUSE AND MBS=1, NO DICT. PTR.     10884021
         BCT   R4,BTESTJ            ATTRIBUTES                          10890021
         BC    UNCOND,BLVMBS       BRH TO LOAD REG0-14 WITH RSAVE       10896021
BTESTJ   LR    R5,R4               LOAD OLN COUNT FOR MULTIPLY          10902021
         M     R4,THREE       MULT INDEX TO TABLE BY 3 SINCE ENTRIE     10908021
         LA    R4,BDPTAB      LOAD ADDRESS OF OCCUR DICT PTR TABLE      10914021
         AR    R5,R4           ARE IN 3 BYTES AND ADD TO TABLE ADDR     10920021
         MVC   VILGN+NX2(LX3),DX0(R5) MOVE POINTER TO ATTRIBUTES FIELD  10926021
         MVI   COUNT,XX30           INIT ATTRIBUTE COUNT TO 3           10932021
BLVMBS   LM    R0,R14,RSAVE                                             10938021
       BCR   UNCOND,R14            BRH TO ADDR JUST LOADED IN R14       10944021
* ERROR CHECKS TO SEE IF ID NAMES OR KEYS NEED TO BE BYPASSED           10950021
*                                                                       10956021
BEROR1   BAL   R6,BERORP           LINK TO PUT ERROR # IN REG 0         10962021
         DC    X'202A'             42                                   10968021
         NI    MINCOD,XXFD      ZERO OUT OCCURS CLAUSE BIT              10974021
         XC    NOC(LX2),NOC     ZERO OUT NUMBER OF OCCURRENCES FIELD    10980021
         LA    R4,DX3               RESET FIELD                         10986021
         ST    R7,RS7              RESET BUFFER PTR                     10992021
         BC    UNCOND,BSTMBS       GO TO'CI WITH NO OCCURS' RTN         10998021
BEROR2   BAL   R6,BERORP           LNK TO PUT ERROR # IN REG 0          11004021
         DC    X'202B'             43                                   11010021
         NI    MINCOD,XXF1      DROP OCCURS CLAUSE AND ZERO OUT MBS     11016021
         XC    NOC(LX2),NOC    DROP NUMBER OF OCCURRENCES FIELD(ZERO    11022021
         ST    R7,RS7              RESET BUFFER PTR                     11028021
         BC    UNCOND,BLVMBS       BRH TO LOAD REG0-14 WITH RSAVE       11034021
BERORP   LH    R0,DX0(R6)           PUT ERROR NUMBER IN REG 0           11040021
         ST    R15,TSAVER                                               11046021
         L     R15,AERRTN          CALL ERROR RTN                       11052021
         BALR  R14,R15               TO PUT OUT E-TEXT ON FILE 4        11058021
         L     R15,TSAVER                                               11064021
         LA    R6,DX2(R6)                                               11070021
         CLI   NOIDNM,XX00                                              11076021
         BE    BCKKEY               NO                                  11082021
         LH    R0,MSG12             ERROR                               11088021
         L     R15,AERRTN                                               11094021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11100021
         L     R15,TSAVER                                               11106021
         TM    ITMCLS+NX1,XX80      OCCURS PTR PRESENT                  11112021
         BZ    BNOODO              NO                                   11118021
         LA    R7,DX1(R7)           YES                                 11124021
BNOODO   LA    R7,DX1(R7)           BUMP PTR                            11130021
         SR    R4,R4                                                    11136021
         IC    R4,NOIDNM            COUNT OF IDNAMES                    11142021
BIDS     L     R15,ABYPAS                                               11148021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11154021
         L     R15,TSAVER                                               11160021
         BCT   R4,BIDS             SUBT 1 FRM R4,NOT=0, GOTO BIDS       11166021
         MVI   NOIDNM,XX00          SET COUNT TO ZERO                   11172021
BCKEY    CLI   NOKEYS,XX00           ANY KEYS                           11178021
         BE    BEREND              =,BRH TO TEST FOR OCCURS CLSE        11184021
         IC    R4,NOKEYS            COUNT OF KEYS                       11190021
BKEY     L     R15,ABYPAS                                               11196021
         BALR  R14,R15             LINK TO BYPAS                        11202021
         L     R15,TSAVER                                               11208021
         BCT   R4,BKEY             SUBT 1 FROM R4,NOT 0,GOTO BKEY       11214021
         MVI   NOKEYS,XX00          SET COUNT TO ZERO                   11220021
         B     BEREND              GO CHECK END                         11226021
BCKKEY   CLI   NOKEYS,XX00          ANY KEYS SPECIFIED                  11232021
         BCR   EQ,R6               NO                                   11238021
         LH    R0,MSG12                                                 11244021
         L     R15,AERRTN                                               11250021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11256021
         L     R15,TSAVER                                               11262021
         TM    ITMCLS+NX1,XX80      OCCURS PTR PRESENT                  11268021
         BZ    BERROR              NO                                   11274021
         LA    R7,DX1(R7)           YES                                 11280021
BERROR   LA    R7,DX1(R7)           BUMP PTR                            11286021
         SR    R4,R4                                                    11292021
         IC    R4,NOKEYS                                                11298021
         B     BKEY                 BYPASS KEYS                         11304021
BEREND   BCTR  R7,R0               DECREMENT BY ONE                     11310021
         TM    ITMCLS+NX1,XX80      OCCURS PTR PRESENT                  11316021
         BCR   ZERO,R6             NO, RETURN                           11322021
         BCTR  R7,R6               DECREMENT 1 MORE AND RETURN          11328021
         USING *,R15                                                    11334021
BYPAS    EQU   *                                                        11340021
         CLI   DX0(R7),XXFF                                             11346021
         BNE   BYPAS1              NOT =, BRH TO BYPAS1                 11352021
         L     R1,COSADR                                                11358021
         BALR  R0,R1               BRH TO ADDR IN COSADR                11364021
         DC    X'03'                                                    11370021
         BE    ATTEND              BRH ON = TO SET ON COPYSW            11376021
         LR    R7,R0                                                    11382021
BYPAS1   SR    R2,R2                                                    11388021
         IC    R2,DX1(R7)           COUNT OF NAME                       11394021
         LA    R7,DX2(R7,R2)        INCREMENT BUFFER PTR                11400021
         BR    R14                 BRH BACK TO CALLING RTN              11406021
ATTEND   OI    COPYSW,XX10                                              11412021
         MVI   NXTLEV,XX00                                              11418021
         BR    R14                 BRH BACK TO CALLING RTN              11424021
         EJECT                                                          11430021
SRCHTB   EQU   *                                                        11436021
*                                                                       11442021
*                                                                       11448021
         USING *,R15                                                    11454021
         ST    R14,SRCHSV                                               11460021
         STM   R0,R5,SRHSAV                                             11466021
         ST    R8,SRHSVD                SAVE REG 8                44266 11472021
         ST    R15,IDSAV                                                11478021
         OI    TBLSW,SWON               TURN  ON SEARCH SWITCH          11484021
         TM    PTBLSW+NX2,XX40      TABLES PRIMED YET                   11490021
         BO    SRCH05              BRH TO SRCH05 ON OVERFLOW            11496021
         LA    R1,ATBLSH           NO                                   11502021
         L     R15,BPRIME                                               11508021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11514021
         LA    R1,AKEYTB                                                11520021
         L     R15,BPRIME                                               11526021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11532021
         L     R15,IDSAV                                                11538021
         OI    PTBLSW+NX2,XX40      TABLES PRIMED YET                   11544021
SRCH05   L     R9,GPARAM                                                11550021
         L     R10,DX0(R9)                                              11556021
         L     R9,DX0(R10)                                              11562021
         LA    R9,DX0(R9)           CLEAR TOP BYTE                      11568021
         AH    R9,DX4(R10)                                              11574021
SRCH06   S     R9,CON24           POINT TO LAST ENTRY                   11580021
         CLI   DX20(R9),XX00        ANY ENTRIES                         11586021
         BE    SRCH07              NO, DON'T NED CHECK                  11592021
         CLC   CILEV(LX1),DX20(R9)   UNDER GROUP                        11598021
         BNH   SRCH07              NO                                   11604021
         CLC   DX6(LX2,R9),ZEROS     OCCURS CLAUSE                      11610021
         BE    SRCH06              NO                                   11616021
         CLI   DX24(R9),XX00        INDEXED BY CLAUSE                   11622021
         BNE   SRCH06              YES, OK                              11628021
         XC    TBLSW,TBLSW         TURN OFF SW                          11634021
         LA    R7,DX2(R7)           BUMP BUFFER PTR                     11640021
         BAL   R6,IDERR            LNK TO WRITE ERROR MSG               11646021
         DC    X'20C6'             MSG 198                              11652021
         SR    R4,R4                                                    11658021
         IC    R4,NOIDNM           GET COUNT OF IDS                     11664021
         BAL   R6,BYPASS           BYPASS IDS                           11670021
         MVI   NOIDNM,XX00          RESET COUNT                         11676021
         IC    R4,NOKEYS           GET COUNT OF KEYS                    11682021
         LTR   R4,R4               ANY KEYS SPECIFIED                   11688021
         BC    NOTPOS,SRCH3A       NO, RETURN                           11694021
         BAL   R6,BYPASS           BYPASS KEYS                          11700021
         MVI   NOKEYS,XX00          SET COUNT TO ZERO                   11706021
         B     SRCH3A              RETURN                               11712021
SRCH07   L     R4,ATBLSH           A(TIB)                               11718021
         L     R4,DX0(R4)                A(TAMM)                        11724021
         LH    R6,DX4(R4)            DISPL IN TABLE                     11730021
         STH   R6,IDDISP                                                11736021
         LA    R8,DX9                   INITIALIZE COUNT          44266 11742021
         SR    R4,R4                                                    11748021
         IC    R4,NOIDNM                COUNT OF INDEX NAMES            11754021
         C     R4,TWELVE                MORE THAN 12 SPECIFIED          11760021
         BNH   SRCH10              BRH ON NOT HIGH TO SRCH10            11766021
         BAL   R6,IDERR            LINK TO WRITE ERROR MSG              11772021
         DC    X'202F'              MSG 47                              11778021
SRCH10   L     R0,NINE                  LENGTH OF ENTRY                 11784021
         L     R1,ATBLSH                                                11790021
         L     R15,BINSRT                                               11796021
         BALR  R14,R15             INSERT ENTRY                         11802021
         L     R15,IDSAV                                                11808021
         STC   R4,DX8(R2)                STORE ID NAME COUNT            11814021
         LA    R7,DX2(R7)                GET NEXT ELEMENT               11820021
         BAL   R3,GTNEXT           LNK TO CHK TO END OF LOG. RECS       11826021
         XC    IDFLAG(LX1),IDFLAG    ZERO FLAG BYTE                     11832021
         XC    DX4(LX1,R2),DX4(R2)    ZERO TABLE FLAG BYTE              11838021
GETID    SR    R6,R6                                                    11844021
         IC    R6,DX1(R7)                GET COUNT OF BCDNAME           11850021
         XC    OVERFL(LX32),OVERFL  CLEAR AREA                          11856021
         EX    R6,MVIDNM                MOVE BCD NAME                   11862021
         L     R1,AIDPRM                ENTER ID NAME IN DICT           11868021
         L     R15,AENTNM                                               11874021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11880021
         L     R15,IDSAV                                                11886021
         ST    R1,DICTPT                                                11892021
         ST    R1,REALPTR                                               11898021
         L     R3,COSADR                                                11904021
SRCH11   L     R1,ATBLSH                                                11910021
         L     R0,THREE                 COUNT OF ENTRY                  11916021
         L     R15,BINSRT                                               11922021
         BALR  R14,R15             LNK TO ADDR IN REG 15                11928021
         L     R15,IDSAV                                                11934021
         MVC   DX0(LX3,R2),DICTPT+NX1                                   11940021
         TM    PHZSW1,XREF               IS XREF SPEC'D                 11946021
         BZ    SRCH12                    NO, BR                   8953  11952021
         LA    R1,OVERFL                YES - GET ADDR OF INDEX NM8953  11958021
         STM   R2,R7,IDXREFSV            SAVE REGS                8953  11964021
         L     R15,AXREF                XREF RTN ADDR             8953  11970021
         BALR  R14,R15                  GO GENERATE XREF ELEMENT  8953  11976021
         L     R15,IDSAV                 RESTORE ADDRESSABILITY   8953  11982021
         LM    R2,R7,IDXREFSV            RESTORE REGS             8953  11988021
SRCH12   EQU   *                                                  8953  11994021
         LA    R8,DX3(R8)               INCR TABLE CNT            44266 12000021
         BAL   R3,CHKNXT                CHECK NEXT ELEMENT              12006021
         BCT   R4,GETID                 ANY MORE ID NAMES               12012021
         IC    R4,NOIDNM           GET COUNT OF ID NAMES                12018021
         C     R4,TWELVE                                                12024021
         BNH   GTKEYS              NOT HI,TEST IF KEYS SPECIFIED        12030021
         S     R4,TWELVE                                                12036021
         MVI   NOIDNM,XX0C          SET TO 12                           12042021
         BAL   R6,BYPASS           BYPASS REST                          12048021
*                                                                       12054021
* SEE IF KEYS WERE ALSO SPECIFIED                                       12060021
*                                                                       12066021
GTKEYS   IC    R4,NOKEYS                                                12072021
         LTR   R4,R4                    ANY KEYS SPECIFIED              12078021
         BC    NOTPOS,SRCH2             NO, FINISH PROCESSING           12084021
         C     R4,TWELVE            MORE THAN TWELVE SPECIFIED          12090021
         BNH   SRCH15               NO                                  12096021
         BAL   R6,IDERR             ERROR                               12102021
         DC    X'2034'              MSG 52                              12108021
SRCH15   L     R0,ONE                                                   12114021
         L     R1,ATBLSH                                                12120021
         L     R15,BINSRT                                               12126021
         BALR  R14,R15             LNK TO ADDR IN REG 15                12132021
         L     R15,IDSAV                                                12138021
         STC   R4,DX0(R2)                STORE COUNT                    12144021
         LA    R8,DX1(R8)               INCR TABLE CNT            44266 12150021
         SR    R6,R6                                                    12156021
         IC    R6,DX1(R7)                COUNT OF BCD NAME              12162021
         EX    R6,KEYSUB                SEE IF KEY IS SUBJECT           12168021
         BE    SRCH4                    YES                             12174021
         LA    R0,DX0(R4,R4)                                            12180021
         AR    R0,R4               3 TIMES REG4                         12186021
         L     R1,ATBLSH                                                12192021
         L     R15,BINSRT                                               12198021
         BALR  R14,R15             LNK TO ADDR IN REG 15                12204021
         L     R15,IDSAV                                                12210021
         L     R1,AKEYTB                                                12216021
         L     R1,DX0(R1)                                               12222021
         LH    R0,DX4(R1)           GET DISPL OF ENTRY                  12228021
         STH   R0,KEYDSP           SAVE FOR GROUP                       12234021
GETKEY   LA    R0,DX2(R6)                ONE MORE FOR KIND OF KEY       12240021
         L     R1,AKEYTB                ENTER IN TABLE                  12246021
         L     R15,BINSRT                                               12252021
         BALR  R14,R15             LNK TO ADDR IN REG 15                12258021
         L     R15,IDSAV                                                12264021
         LA    R6,DX1(R6)           INCREMENT                           12270021
         EX    R6,KEYMOV                MOVE KEY TO TABLE               12276021
         LA    R7,DX1(R7,R6)        POINT TO NEXT                       12282021
       BAL     R3,GTNEXT           LNK TO TST FOR END OF LOG.RECS       12288021
         LA    R8,DX3(R8)               INCR TABLE CNT            44266 12294021
         SR    R6,R6                                                    12300021
         IC    R6,DX1(R7)                                               12306021
         BCT   R4,GETKEY           SUB 1 FRM R4,NOT 0,GOTO GETKEY       12312021
         IC    R4,NOKEYS           GET COUNT OF KEYS                    12318021
         C     R4,TWELVE                                                12324021
         BNH   SRCH2               NOT HI, BRH TO SRCH2                 12330021
         S     R4,TWELVE                                                12336021
         MVI   NOKEYS,XX0C          SET TO 12                           12342021
         BAL   R6,BYPASS           BYPASS REST                          12348021
SRCH2    L     R1,ATBLSH            TIB                                 12354021
         L     R1,DX0(R1)                TAMM                           12360021
         L     R1,DX0(R1)                A(TABLE)                       12366021
         LA    R1,DX0(R1)                                               12372021
         AH    R1,IDDISP                                                12378021
SRCH3    STC   R8,DX0(R1)               STORE TOTAL CNT           44266 12384021
         MVC   NUMIDS(LX2),NOIDNM   MOVE TO SAVE                        12390021
* COMMON EXIT                                                           12396021
*                                                                       12402021
SRCH3A   LM    R0,R5,SRHSAV                                             12408021
         L     R8,SRHSVD                 RESTORE REG 8            44266 12414021
         CLI   DX0(R7),XXFF          EOF                                12420021
         BNE   SRCH30               NO                                  12426021
         L     R6,ACPYRN                                                12432021
         L     R15,RSAVE+NX60                                           12438021
         BR    R6                   RETURN                              12444021
SRCH30   L     R14,SRCHSV                                               12450021
         S     R7,TWO                                                   12456021
         BR    R14                 BRH BACK TO CALLING RTN              12462021
SRCH4    OI    SYNCHR,ICLKEY        SET KEY BIT ON                      12468021
         LA    R8,DX3(R8)                 INCR COUNT              44266 12474021
         TM    DX0(R7),ASCKEY       IS KEY ASCENDING                    12480021
         BZ    SRCH6               BR ON 0 TO TEST IF ONLY KEY          12486021
         OI    SYNCHR,ICLASC        SET ASCENDING BIT ON                12492021
SRCH6    C     R4,ONE              ONLY KEY                             12498021
         BE    SRCH7               YES                                  12504021
         BAL   R6,IDERR             NO, ERROR                           12510021
         DC    X'2069'              MSG 105                             12516021
         IC    R4,NOKEYS           GET COUNT OF KEYS                    12522021
         XC    NOKEYS,NOKEYS       RESET CTR                            12528021
         BAL   R6,BYPASS           LINK TO SAVE RETURN ADDRESS          12534021
         L     R1,ATBLSH                                                12540021
         L     R1,DX0(R1)                                               12546021
         L     R1,DX0(R1)                                               12552021
         AH    R1,IDDISP                                                12558021
         OI    DX4(R1),KEYERR       SET FLAG ON FOR PHASE3              12564021
         B     SRCH3               BR TO STORE TOTAL COUNT              12570021
SRCH7    BAL   R3,CHKNXT           POINT TO NEXT ELEMENT                12576021
         XC    NOKEYS(LX1),NOKEYS   ZERO NUMBER OF KEYS                 12582021
         B     SRCH2               BRH TO SRCH2                         12588021
CHKNXT   LA    R7,DX2(R7,R6)        INCREMENT BUFFER PTR                12594021
GTNEXT   CLI   DX0(R7),XXFF         END OF LOGICAL RECORDS              12600021
         BNE   GTNXT1              NO, SEE IF E-TEXT                    12606021
         L     R1,COSADR                YES                             12612021
         BALR  R0,R1               BRH TO ADDR IN COSADR                12618021
         DC    X'03'                                                    12624021
         BE    ATEND               =, BRH TO TURN ON EOF SWITCH         12630021
         LR    R7,R0                                                    12636021
         B     GTNXT1              CHECK FOR PARAMETER                  12642021
ATEND    OI    COPYSW,XX10           TURN ON EOF SWITCH                 12648021
         MVI   NXTLEV,XX00                                              12654021
         BR    R3                   RETURN                              12660021
GTNXT1   DS    0H                                                 35123 12666021
         CLI   DX0(R7),XX42        IS THIS CPB (NEW SECTION)      35123 12672021
         BNE   GTNX1A              NO,  GO TO CHECK FOR ERROR TXT 35123 12678021
         OI    COPYSW,XX02         YES, SET CPB SWITCH            35123 12684021
         MVI   NXTLEV,XX00         RESET NEXT LEVEL               35123 12690021
         SR    R5,R5               CLEAR REG 5                    35123 12696021
         IC    R5,DX1(R7)          PICK UP SECTION CODE           35123 12702021
         STC   R5,SECTSAV                SAVE SECTION CDE         44287 12708021
GTNX1A   DS    0H                  CHECK ERROR TEST               35123 12714021
         CLI   DX0(R7),XX00        IS THIS ERROR TEXT             35123 12720021
         BCR   NOTEQ,R3            LD TEXT   RETURNS              35123 12726021
*                                  ELSE  ERROR TEXT               35123 12732021
         CLI   DX2(R7),DX0         PARAMETER                      35123 12738021
         BNE   GTNXT3              BRANCH TO SKIP CHECK           35123 12744021
         SR    R1,R1               CLEAR REG1                     35123 12750021
         IC    R1,DX7(R7)               PICK UP SEVERITY                12756021
         SRL   R1,DX4              GET RID OF PHASE NO.           35123 12762021
         LA    R1,DX1(R1)          ADD 1 TO REG1                  35123 12768021
         SLL   R1,DX2              MULTIPLY BY 4                  35123 12774021
         CH    R1,TWELVE+DX2       12 OR HIGHER ..                35123 12780021
         BNH   GTNXT2              NO, DO NOT SAVE                35123 12786021
         LA    R1,DX16             LOAD 16, HIGHEST RETURN CODE   35123 12792021
GTNXT2   DS    0H                                                 35123 12798021
         STC   R1,FULLWD           STORE LAST BYTE OF REG1        35123 12804021
         CLC   FULLWD(LX1),ERRSEV  CHECK SEVERITY WITH LAST       35123 12810021
         BNH   GTNXT3              NO, DO NOT SAVE                35123 12816021
         STC   R1,ERRSEV           STORE NEW HIGH SEVERITY CODE   35123 12822021
GTNXT3   DS    0H                                                 35123 12828021
         L     R1,COSADR                                                12834021
         ST    R2,RNMSVE                                                12840021
         LR    R2,R7                                                    12846021
         BALR  R0,R1               CALL COS TO PUT OUT E-TEXT           12852021
         DC    X'24'                                                    12858021
         L     R2,RNMSVE                                                12864021
         SR    R1,R1                                                    12870021
         IC    R1,DX1(R7)           COUNT OF ENTRY                      12876021
         LA    R7,DX2(R1,R7)        POINT TO NEXT ENTRY                 12882021
         B     GTNEXT              CHECK NEXT                           12888021
IDERR    LH    R0,DX0(R6)            WRITE ERROR MSG                    12894021
         L     R15,AERRTN                                               12900021
         BALR  R14,R15             LNK TO ADDR IN REG 15                12906021
         L     R15,IDSAV                                                12912021
         LA    R4,DX12               SET ID COUNT TO 12                 12918021
         LA    R6,DX2(R6)            GO PROCESS                         12924021
         BR    R6                  BRH BACK TO CALLING RTN+2            12930021
BYPASS   LR    R2,R6               SAVE RETURN ADDRESSN                 12936021
         SR    R6,R6                                                    12942021
         IC    R6,DX1(R7)           COUNT OF BCD NAEM                   12948021
         BAL   R3,CHKNXT           INCRENENT BUFFER PTR                 12954021
         BCT   R4,BYPASS+NX4        AT END YET                          12960021
         BR    R2                  BRH BACK TO CALLING RTN              12966021
IDXREFSV DS    6F                       XREF FOR INDX NMS SAV     8953  12972021
MVIDNM   MVC   OVERFL(LX1),DX1(R7)                                      12978021
KEYSUB   CLC   DX1(LX1,R7),NUMBCD                                       12984021
KEYMOV   MVC   DX0(LX1,R2),DX0(R7)                                      12990021
         EJECT                                                          12996021
         EJECT                                                          13002021
         USING *,R15                                                    13008021
*                                                                       13014021
* THIS ROUTINE IS CALLED BY DICTBLD TO FILL IN ID NUMBER AND LENGTH     13020021
* OF INDEX NAMES                                                        13026021
SRH200   ST    R14,SRCHSV                                               13032021
         ST    R15,IDSAV                                                13038021
         STM   R0,R6,SRHSAV                                             13044021
         TM    SYNCHR,ICLKEY       WAS SUBJECT KEY                      13050021
         BZ    SRH201              BRH ON ZERO TO SRH201                13056021
         L     R0,THREE                                                 13062021
         L     R1,ATBLSH                                                13068021
         L     R15,BINSRT                                               13074021
         BALR  R14,R15             LNK TO ADDR IN REG 15                13080021
         L     R15,IDSAV                                                13086021
         MVC   DX0(LX3,R2),DICTPT+NX1 DICT PTR FOR KEY                  13092021
SRH201   L     R5,ATBLSH                                                13098021
         L     R5,DX0(R5)            TAMM                               13104021
         L     R5,DX0(R5)            TABLE                              13110021
         LA    R5,DX0(R5)                                               13116021
         AH    R5,IDDISP                                                13122021
         MVC   DX1(LX3,R5),DICTPT+NX1 ENTER SUBJECT POINTER             13128021
         XC    TBLSW(LX1),TBLSW     TURN OFF SW                         13134021
         TM    ITMCLS+NX1,XX80       ODO                                13140021
         BZ    SRH202              NO                                   13146021
         OI    DX4(R5),ODOPTR       TURN FLAG ON                        13152021
         MVC   DX5(LX2,R5),OBJDIS    SAVE DISPL IN OD2TBL               13158021
         SR    R3,R3                                                    13164021
         IC    R3,ODOCT            CT OF VARIABLES                      13170021
         LA    R3,DX1(R3)           INCREMENT                           13176021
         STC   R3,ODOCT                                                 13182021
         B     SRH203              BRH TO INCREMT TABLE PTR             13188021
SRH202   LH    R3,NOC              GET NUMBER OF OCCURENCES             13194021
         CVD   R3,MAXNUM               PACKED DECIMAL FOR PH3.          13200021
         MVC   DX5(LX3,R5),MAXNUM+NX5 STORE IN TABLE                    13206021
SRH203   LA    R5,DX9(R5)            INCREMENT TABLE PTR                13212021
         SR    R4,R4                                                    13218021
         IC    R4,NUMIDS           GET COUNT OF ID NAMES                13224021
         MVC   IDLNTH(LX2),CILGN    MOVE SUBJECT LENGTH                 13230021
SRH218   LH    R1,INDEX1           IN LINE                              13236021
         LA    R1,DX1(R1)           INCREMENT                           13242021
         STH   R1,IDNUM            PUT IN ATTRIBUTES                    13248021
         STH   R1,INDEX1                                                13254021
SRH250   MVC   PARAM+NX1(LX3),DX0(R5) MOVE DICT PTR                     13260021
         LA    R5,DX3(R5)            UPDATE TABLE PTR                   13266021
         MVI   PARAM,XX04            LATRPT CODE                        13272021
         LA    R1,PARAM                                                 13278021
         L     R15,ALATRP                                               13284021
         ST    R14,BCTSAV                                               13290021
         BALR  R14,R15             LINK TO ADDR IN REG 15               13296021
         L     R14,BCTSAV                                               13302021
         L     R15,IDSAV                                                13308021
         MVC   DX1(LX5,R2),IDATT+NX1 REPLACE ATTRIBUTES                 13314021
         BCT   R4,SRH218                BUMP INDEX CTR            38963 13320021
         MVC   PARAM+NX1(LX3),DICTPT+NX1 MOVE PTR                       13326021
         MVI   PARAM,XX04           LATRPT CODE                         13332021
         LA    R1,PARAM                                                 13338021
         L     R15,ALATRP                                               13344021
         BALR  R14,R15             LNK TO ADDR IN REG 15                13350021
         L     R15,IDSAV                                                13356021
         OI    DX5(R2),XX80         SUBJECT OF INDEX BY                 13362021
       LM      R0,R6,SRHSAV                                             13368021
         L   R14,SRCHSV                                                 13374021
         BR    R14                 BRH TO ADDR IN REG 14                13380021
         EJECT                                                          13386021
*=2      SOURCE PICTURE ANALYSIS-GSPICT                                 13392021
*GSPICT-SOURCE PICTURE ROUTINE                                          13398021
* GSPICT SCANS THE SOURCE PICTURE CHECKING FOR VALID PICTURE CHARAC     13404021
* AND DETERMINES THE PICTURE TYPE IF ALL THE CHARACTERS ARE VALID.      13410021
* VALIDATION IS DONE BY A TRANSLATE TABLE OF THE 256 BIT CONFIGURAT     13416021
* OF EBCDIC CONVENTION. EACH CHARACTER OF THE SOURCE PICTURE IS TRA     13422021
* LATED TO A CODE AND THIS CODE IS OR'ED INTO A CHECK BYTE(BVPCHK).     13428021
* ILLEGAL CHARACTERS HAVE X'FF' CODE IN THE TRANSLATE TABLE. THE VA     13434021
* OF THE CHECK BYTE DETERMINES THE PICTURE TYPE(PCTYPE). THE SOURCE     13440021
* PICTURE IS DISTRIBUTED TO IPT-INITIAL PICTURE TABLE AND IPLT-INIT     13446021
* PICTURE LENGTH TABLE. PARENTHESIS ARE DROPPED AND THEIR ENCLOSED      13452021
* LENGTHS ARE TRANSLATED TO BINARY BEFORE DISTRIBUTION TO IPT AND I     13458021
*                                                                       13464021
*                                                                       13470021
* THE CALLING SEQUENCE FOR GSPICT IS                                    13476021
*        ST    R15,RSAVE+60                                             13482021
*        L     R15,AGSDIC          AGSPIC IS ADCON FOR GSPICT           13488021
*        BALR  R14,R15                                                  13494021
*        L     R15,RSAVE+60                                             13500021
*GSPICT IS CALLED BY GETNXT WHEN A SOURCE PICTURE IS ENCOUNTERED IN     13506021
*INPUT(LD-TEXT) TO PHASE 2.                                             13512021
       USING *,R15                                                      13518021
GSPICT   STM   R0,R14,RSAVE                                             13524021
         XC    BVPCHK(LX1),BVPCHK CLEAR OR-BYTE                         13530021
         SR    R12,R12                                                  13536021
         SR    R8,R8                                                    13542021
         LA    R3,IPT                                                   13548021
         LA    R4,IPLT                                                  13554021
         SR    R5,R5          R5 IS COUNTER FOR PICTURE CHAR            13560021
         SR    R6,R6          R6 IS COUNTER FOR TOTAL NUMBER OF CHA     13566021
         IC    R8,DX0(R0,R7)  COUNT OF SOURCE DICT CHARS GOES IN REG    13572021
         MVC   DX1(LX1,R3),DX1(R7) MOVE FIRST PICTURE CHAR TO IPT       13578021
         BAL   R1,BTRANS      CALL TRANSLATE ROUTINE                    13584021
         LTR   R9,R9          R9 HAS CODE DETERMINING VALIDITY OF C     13590021
         BC    NOTZER,MOVEFF       IF R9 IS NOT ZERO CHAR IS INVALI     13596021
BADDRS   LA    R5,DX1(R0,R5)  ADD 1 TO CHAR COUNTER                     13602021
         LA    R6,DX1(R0,R6)    AND TOTAL CHAR COUNTER                  13608021
BDECPC   BCT   R8,BNEXTP           R8 NOT 0,LA OF NXT CHAR IN R7        13614021
BENDGS   STH   R5,DX2(R0,R4)  STORE CURRENT CHAR COUNT IN IPLT          13620021
         STH   R6,IPLT        STORE TOTAL CHAR COUNT IN IPLT            13626021
         STC   R12,NOOFPS     STORE NUMBER OF P'S                       13632021
         LA    R5,IPT-NX1      PUT NUMBER OF CHARACTERS IN              13638021
         SR    R3,R5          REGISTER 3 AND STORE  IN                  13644021
         STC   R3,IPT         IPT COUNT BYTE                            13650021
         BC    UNCOND,BPTYPE       GO COMP OR-BYTE BVPCHK TO PTYP       13656021
BNEXTP   LA    R7,DX1(R0,R7)  SET REG 7 TO ADDRESS OF NEXT SOURCE CH    13662021
BNEXTQ   CLI   DX1(R7),XX4D    IS CHARACTER A LEFT PARENTHESIS          13668021
         BC    EQ,BLEFTP      YES                                       13674021
         CLC   DX1(LX1,R7),DX1(R3) NO, IS THIS CHAR EQUAL TO LAST CHAR  13680021
         BC    EQ,BADDRS      YES                                       13686021
         CLI   DX1(R3),XCP     NO, IS IPT CHAR A P                      13692021
         BC    NOTEQ,BINIPT   NO,                                       13698021
         AR    R12,R5         YES, ADD CHAR COUNT TO NUMBER OF D'S      13704021
BINIPT   LA    R3,DX1(R0,R3)  NO ,INCREMENT IPT INDEX                   13710021
         STH   R5,DX2(R0,R4)  STORE CHAR COUNT INTO IPLT                13716021
         LA    R4,DX2(R0,R4)  INCREMENT  IPLT  INDEX                    13722021
         SR    R5,R5          CLEAR CHAR COUNT                          13728021
         MVC   DX1(LX1,R3),DX1(R7) MOVE CURRENT CHAR TO IPT             13734021
         BAL   R1,BTRANS      CALL TRANSLATE ROUTINE                    13740021
         LTR   R9,R9          R9 HAS CODE DETERMINING VALIDITY OF C     13746021
         BC    NOTZER,MOVEFF       IF R9 IS NOT ZERO CHAR IS INVALI     13752021
         BC    UNCOND,BADDRS       BRH,+1 TO CHR AND TOT CHR CTRS       13758021
BPACKI   PACK  BPACKD(LX8),DX2(LX0,R2)                                  13764021
BLEFTP   SR    R10,R10                                                  13770021
         LR    R2,R7          SAVE CHAR ADDRESS IN REG 2 (SOURCE PI     13776021
BLEFTR   LA    R7,DX1(R0,R7)    IGNORE LEADING ZEROES               370 13782021
         CLI   DX1(R7),XC0      IN DUPLICATING FACTOR               370 13788021
       BC      NOTEQ,BLEFTS    OF                                  3705 13794021
         CLI   DX2(R7),XX5D             IS CHAR AFTER 0 RIGHT PAREN     13800021
         BC    EQ,BZERO                 YES, ISSUE MSG                  13806021
         LA    R2,DX1(R0,R2)    PICTURE CLAUSE                      370 13812021
       S       R8,ONE                                              3705 13818021
       BC      UNCOND,BLEFTR       BRH TO BLEFTR                   3705 13824021
BLEFTQ   LA    R7,DX1(R0,R7)  INCREMENT R7 TO ADDRESS OF NEXT SOURCE    13830021
BLEFTS   LA    R10,DX1(R0,R10)  ADD 1 TO R10                        370 13836021
         C     R10,FIVE       IS COUNTER GREATER THAN 5                 13842021
         BC    HI,BETXT2      YES                                       13848021
         CLI   DX1(R7),XX5D    NO, IS CHAR A RIGHT PARENTHESIS          13854021
         BC    EQ,BDECRE      YES                                       13860021
         CLI   DX1(R7),XC0     NO, IS CHARACTER GREATER OR EQ TO ZER    13866021
         BC    LO,MOVEFF           NO                                   13872021
         CLI   DX1(R7),XC9     YES, IS CHARACTER LESS,EQ TO NINE        13878021
         BC    HI,MOVEFF           NO                                   13884021
         BC    UNCOND,BLEFTQ  YES, CHARACTER IS A NUMBER 0-9            13890021
BDECRE   S     R10,TWO        DECREMENT REG 10 BY TWO                   13896021
         BC    LO,MOVEFF           NO NUMERICS IN ( )                   13902021
         EX    R10,BPACKI     PACK SOURCE NUMBER                        13908021
         CVB   R2,BPACKD      CONVERT DECIMAL LGN TO BINARY LGN         13914021
         C     R2,ZEROS       IS DUPL FACTOR ZERO                       13920021
         BC    NOTEQ,BCHAR    NO                                        13926021
BZERO    EQU   *                                                        13932021
         LH    R0,ERRBA       186      YES                              13938021
         L     R15,AERRTN     CALL ERROR RTN                            13944021
         BALR  R14,R15             LNK TO ADDR IN REG 15                13950021
         L     R15,AGSPIC                                               13956021
         L     R2,ONE         SUBSTITUTE ONE OCCURRENCE                 13962021
BCHAR    BCTR  R2,R0               SUBT 1 FROM CONTENTS OF REG 2        13968021
         AR    R5,R2          ADD TO CHARACTER COUNT                    13974021
         AR    R6,R2          ADD TO TOTAL CHARACTER COUNT              13980021
         C     R5,CON32K           IS SIZE GT 32K-1                2998 13986021
         BNH   BCHAR1              NO                                   13992021
         L     R5,CON32K           MAKE SIZE = 32K                 2998 13998021
         BCTR  R5,R0                   MINUS 1                     2998 14004021
         LH    R0,MSG138                                           2998 14010021
         L     R15,AERRTN                                          2998 14016021
         BALR  R14,R15             GO GEN MSG 138                  2998 14022021
         L     R15,AGSPIC                                          2998 14028021
BCHAR1   EQU   *                                                   2998 14034021
         C     R6,CON32K           TOTAL GREATER THAN 32K          2998 14040021
         BNH   BCHAR2              NO                              2998 14046021
         L     R6,CON32K           MAKE 32K                        2998 14052021
BCHAR2   DS    0H                                                  2998 14058021
         LA    R10,DX2(R10,R0) R10 IS = OF CHARS TO BE DECREMENTED      14064021
         SR    R8,R10            FROM COUNT MINUS ONE                   14070021
         BC    NOTHI,BENDGS   BRANCH TO END IF R8 ZERO OR LESS THAN     14076021
         TM    BRETSW,XX01                                              14082021
         BC    NOTONE,BDECPC       BRETSW NOT ON,GO TO BDECPC           14088021
         BC    UNCOND,BRETRN       BRH TO ADD1 TO R7,SETOFF SW          14094021
*                                                                       14100021
*                                                                       14106021
ERRBA    DC    X'10BA'                                                  14112021
ERR021   DC    X'1015'                                             3705 14118021
BETXT2   CLI   DX1(R7),XX5D    IS CHAR RIGHT PAREN                      14124021
         BC    EQ,BDECRE      YES                                       14130021
         LH    R0,ERR021                                           3705 14136021
       L       R15,AERRTN                                          3705 14142021
       BALR    R14,R15             LNK TO ADDR IN REG 15           3705 14148021
       L       R15,AGSPIC                                          3705 14154021
         OI    BRETSW,XX01     SET RETURN SWITCH ON                     14160021
         BC    UNCOND,BDECRE       GO TO DEC REC 10 BY 2                14166021
BRETRN   LA    R7,DX1(R0,R7)                                            14172021
         NI    BRETSW,XXFE     TURN OFF RETURN SWITCH                   14178021
         BCT   R8,BCHNUM           GO CHK IF CHR IS RIGHT ')'           14184021
         BC    UNCOND,BENDGS       GO STORE CURR CH COUNT IN IPLT       14190021
BCHNUM   CLI   DX1(R7),XX5D    IS CHAR RIGHT PAREN                      14196021
         BC    EQ,BDECPC       YES                                      14202021
         CLI   DX1(R7),XC0     IF CHARACTER IS                          14208021
         BC    LO,BNEXTQ        NOT NUMERIC                             14214021
         CLI   DX1(R7),XC9        GO TO                                 14220021
         BC    HI,BNEXTQ            BNEXTQ                              14226021
         LA    R7,DX1(R0,R7)  IS NUMERIC                                14232021
         BCT   R8,BCHNUM           GO CHK IF CHR IS RIGHT ')'           14238021
         LA    R0,DX3(R0,R0)   E-TEXT                                   14244021
         BC    UNCOND,BENDGS       GO ST CURR CHR COUNT IN IPLT         14250021
BTRANS   TR    DX1(LX1,R7),BPICTR  TRANSLATE SOURCE CHAR TO TABLE COD   14256021
         OC    BVPCHK(LX1),DX1(R7) OR PICTURE CHAR TO VALID CHECK BYTE  14262021
         CLI   BVPCHK,XXFF      IS BYTE INVALID (FF) ALL ONES           14268021
         BC    EQ,BSETR9       YES                                      14274021
         SR    R9,R9           NO, VALID                                14280021
         BCR   UNCOND,R1           BRH TO ADDR IN REG1                  14286021
BSETR9   LA    R9,DX1(R0,R0)    MAKE R9  NON-ZERO                       14292021
         BCR   UNCOND,R1           BRH TO ADDR IN REG1                  14298021
BPTYPE   LA    R7,PTYPTB-NX2        THE OR-BYTE BVPCHK IS COMPARED      14304021
         LA    R9,PTYPTB+NX58          TO ENTRIES IN PTYPTB             14310021
         LA    R8,DX2                 IF IT IS A VALID VALUE THE        14316021
COMTYP   BXH   R7,R8,MOVEFF          CORRECT PICTURE CODE GOES INTO     14322021
         CLC   BVPCHK(LX1),DX0(R7)     PCTYPE, IF INVALID FF GOES INT   14328021
         BC    NOTEQ,COMTYP          PCTYPE.                            14334021
MOVEPC   MVC   PCTYPE(LX1),DX1(R7)                                      14340021
BLEAVH   LM    R0,R14,RSAVE        * PCTYPE *  PICTURE                  14346021
         BCR   UNCOND,R14          **********************               14352021
MOVEFF   MVI   PCTYPE,XXFF          *   01   ALPHABETIC                 14358021
         BC    UNCOND,BLEAVH            *  02  ALPHANUMERIC       46170 14364021
*                                  *   03   NUMERIC                     14370021
*                                  *   04   NUMERIC EDITED              14376021
*                                  *   05   EXTERNAL FLOATING POINT     14382021
*                                  *   06   STERLING NON-REPORT         14388021
*                                  *   07   STERLING REPORT             14394021
*                                  *   08    ALPHA-NUM EDITED           14400021
         EJECT                                                          14406021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       14412021
*                                                                       14418021
*                                                                       14424021
*                          R E N A M S                                  14430021
*                                                                       14436021
*                                                                       14442021
*                                                                       14448021
*FUNCTION/OPERATION  - PROCESSES THE RENAMES AND RENAMES                14454021
*   THRU CLAUSES. RESOLVES QUALIFICATION IF NECESSARY.                  14460021
*   ATTRIBUTES ARE TAKEN FROM DATA-NAME2 . IF DATA-NAME3                14466021
*   IS SPECIFIED ADDRESSING  PARAMETERS ARE CALCULATED.                 14472021
*   IF THE RECORD IS VARIABLE LENGTH A SPECIAL Q-RTN IS                 14478021
*   GENERATED FOR PH5. DICTIONARY ENTRY IS MADE FOR SUBJECT             14484021
*   OF CLAUSE                                                           14490021
*                                                                       14496021
*ENTRY POINT - RENAMS IS THE ONLY ENTRY POINT                           14502021
*                                                                       14508021
*INPUT       -  R7 POINTS TO OBJECT OF CLAUSE IN BUFFER                 14514021
*                                                                       14520021
*OUTPUT      -  Q-RTN VARIABLE LENGTH RECORD                            14526021
*               R7 POINTS TO NEXT ITEM IN BUFFER                        14532021
*                                                                       14538021
*EXTERNAL ROUTINES- LATGRP - RESOLVE QUALIFICATION                      14544021
*                   ENTDEL - ENTER DUMMY DELIMITORS                     14550021
*                   LDELNM - LOCATE DELIM GIVEN NAME                    14556021
*                   ENTNAM - ENTER NAME                                 14562021
*                                                                       14568021
*EXITS       -  RNM280  RETURNS TO CALLER                               14574021
*                                                                       14580021
*                                                                       14586021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       14592021
*                                                                       14598021
         USING  *,R15                                                   14604021
RENAMS   DS    0H                                                       14610021
         ST    R14,RNMSV1                                               14616021
         ST    R15,RNMSV2                                               14622021
         OI    RNAMSW,SWON         TURN SW ON                           14628021
         SR    R6,R6                                                    14634021
         IC    R6,DX1(R7)           GET COUNT OF NAME                   14640021
         XC    LITBUF(LX32),LITBUF  CLEAR AREA                          14646021
         EX    R6,RNAMMV           MOVE NAME TO SAVE                    14652021
         MVI   CILEV,XX02                                               14658021
         L     R1,CON24            LENGTH OF GROUP LNTH STACK           14664021
         SLL   R1,DX1               MULTIPLY BY 1                       14670021
         MVC   DICPNT(LX4),DICPTR   MAKE SURE PTR IS CORRECT            14676021
RNM020   L     R9,GPARAM                                                14682021
         L     R9,DX0(R9)                                               14688021
         LH    R4,DX4(R9)           DISPL INTO TABLE                    14694021
         CR    R4,R1               HAVE ALL BEEN DELEIITED              14700021
         BE    RNM050              NO NEDD DELEMITING                   14706021
*                                                                       14712021
*                                                                       14718021
         BL    RNM191              BR ON LOW TO RENAME ERROR RTN        14724021
*                                                                       14730021
         STM   R1,R9,RNMSV3                                             14736021
         L     R15,AXTEN                                                14742021
         BALR  R14,R15             GO DELIMIT                           14748021
         L     R15,RNMSV2                                               14754021
         LM    R1,R9,RNMSV3                                             14760021
         B     RNM020              GO SEE IF ANY MORE                   14766021
RNM050   L     R9,DX0(R9)           A(TABLE)                            14772021
         A     R9,CON24                                                 14778021
         MVC   PARAM+NX1(LX3),DX13(R9) ENTER DUMMY FOR 01               14784021
         LA    R1,PARAM                             01                  14790021
         MVI   PARAM,XX00                                               14796021
         MVC   PARAM1(LX4),DICPTR   LAST ITEM'S PTR                     14802021
         L     R15,AENTDE                                               14808021
         BALR  R14,R15             LNK TO ADDR IN REG 15                14814021
         L     R15,RNMSV2                                               14820021
*                                                                       14826021
*                                                                       14832021
         CLI   DX0(R7),XX23         IS IT NON-QUALIFIED                 14838021
         BE    RENAME              YES                                  14844021
         EJECT                                                          14850021
*=2  QUALIFIED OBJECT OF RENAMES CLAUSE                                 14856021
*                                                                       14862021
QRENMS   XC    WKAREA(LX32),WKAREA                                      14868021
         LA    R1,WKAREA                                                14874021
         ST    R1,PARAM                                                 14880021
         MVI   PARAM,XX10                                               14886021
         SR    R6,R6                                                    14892021
         IC    R6,DX1(R7)                                               14898021
         EX    R6,RNMMOV                                                14904021
         L     R1,APARAM                                                14910021
         L     R15,ALDELN                                               14916021
         BALR  R14,R15             LNK TO ADDR IN REG 15                14922021
         CL    R15,ZEROS                                                14928021
         L     R15,RNMSV2                                               14934021
         BE    RNM100              NAME OK                              14940021
         OI    ITMCL3,ICLRNT       DUMMY ERROR RTN BYPASS               14946021
         BAL   R5,RNMERR           LNK TO RENAME ERROR RTN              14952021
         DC    X'2012'                                                  14958021
RNM100   L     R15,ASRCHT                                               14964021
         L     R5,ACHNXT                                                14970021
         BALR  R3,R5               GET NEXT BUFFER                      14976021
         L     R15,RNMSV2                                               14982021
         XC    WKAREA(LX32),WKAREA                                      14988021
         IC    R6,DX1(R7)                                               14994021
         EX    R6,RNMMOV                                                15000021
         MVI   PARAM,XX08                                               15006021
         L     R1,APARAM                                                15012021
         L     R15,ALATAC                                               15018021
         BALR  R14,R15             LNK TO ADDR IN REG 15                15024021
         CL    R15,ZEROS                                                15030021
         L     R15,RNMSV2                                               15036021
         BE    RNM150              NAME OK                              15042021
         OI    ITMCL3,ICLRNT       DUMMY ERROR RTN BYPASS               15048021
         BAL   R5,RNMERR           MSG 18                               15054021
         DC    X'2012'                                                  15060021
RNM150   CLI   DX0(R7),XX23         IS IT QUALIFIED NAME                15066021
         BNE   RNM100              NO, GO PROCESS REST                  15072021
         ST    R3,RNMSAV           SAVE PTR FOR OBJECT                  15078021
         B     RNMSYN              GO CHECK SYNTAX                      15084021
         EJECT                                                          15090021
*=2  NON-QUALIFIED OBJECT OF RENAMES CLAUSE                             15096021
*                                                                       15102021
RENAME   SR    R6,R6                                                    15108021
         IC    R6,DX1(R7)           GET COUNT OF LAST ENTRY             15114021
         LA    R1,LITBUF                                                15120021
         ST    R1,WKAREA                                                15126021
         MVI   WKAREA,XX0C                                              15132021
         MVI   WKAREA+NX4,XX00                                          15138021
         MVC   WKAREA+NX5,DX13(R9)                                      15144021
         LA    R1,WKAREA                                                15150021
         L     R15,ALATGP                                               15156021
         BALR  R14,R15             LNK TO ADDR IN REG 15                15162021
         CL    R15,ZEROS                                                15168021
         ST    R3,RNMSAV           SAVE PTR FOR OBJECT                  15174021
         L     R15,RNMSV2                                               15180021
       BE      RNMSYN              GO CHECK SYNTAX                      15186021
         BAL   R5,RNMERR           GENERATE MSG 18                      15192021
         DC    X'2012'                                                  15198021
         EJECT                                                          15204021
*=2  RENAMES SYNTAX CHECKING                                            15210021
*                                                                       15216021
*=E  OBJECT IS 01,66, 77 OR 88                                          15222021
*=E  OBJECT IS NOT IN SAME LOGICAL RECORD                               15228021
*=E  ITEM HAS OCCURS OR REDEFINES CLAUSE                                15234021
*=E  ITEM IS SUBORDINATE TO GROUP WHICH HAS OCCURS OR REDEFINES         15240021
*    CLAUSE                                                             15246021
*                                                                       15252021
RNMSYN   CLC   RNMSAV+NX1(LX3),DX13(R9) IN SAME LOGICAL RECORD          15258021
         BL    RNM191              NO, ERROR                            15264021
         BE    RNM190              MUST BE 01                           15270021
RNM230   CLI   DX0(R2),XX0C         IS IT CONDITION NAME                15276021
         BE    RNM190              BRH ON = TO RENAME ERROR RTN         15282021
         SR    R4,R4                                                    15288021
         IC    R4,DX6(R2)                                               15294021
         SRA   R4,DX2                                                   15300021
         CL    R4,ONE                                                   15306021
         BE    RNM190              BRH ON = TO RENAME ERROR RTN         15312021
         CL    R4,FIFTY                                                 15318021
         BE    RNM190              BRH ON = TO RENAME ERROR RTN         15324021
         CL    R4,FIFTY1           IS IT 88                             15330021
         BE    RNM190              YES, ERROR                           15336021
         CL    R4,FIFTY7           IS IT 66                             15342021
         BE    RNM190              YES, ERROR                           15348021
         TM    DX1(R2),XX0E         OCCURS CLAUSE                       15354021
         BC    NOTZER,RNM192       YES, ERROR                           15360021
         TM    ITMCL3,ICLRNT       RENAMES THRU                         15366021
         BZ    RNM235              BRH ON 0 TO RENAME ERROR RTN         15372021
         TM    RNTHRU,SWON                                              15378021
         BZ    RNM300              1ST RENAMES ENTRY                    15384021
         XC    RNTHRU(LX1),RNTHRU   TURN OFF SW                         15390021
RNM235   IC    R4,DX0(R2)           GET ATTRIBUTE COUNT                 15396021
         SRL   R4,DX4               GET RID OF MAJOR CODE               15402021
         TM    DX0(R2),XXF0                                             15408021
         BC    NOTZER,RNM240       COUNT IS CORRECT                     15414021
         IC    R4,DX7(R2)           COUNT FOR REPORT DIFFERENT          15420021
         LA    R4,DX8(R4)           FIXED PORTION OF RECORD             15426021
RNM240   SR    R5,R5                                                    15432021
         IC    R5,DX1(R2)                                               15438021
         SRL   R5,DX4                                                   15444021
         MVI   CICODE,XX04                                              15450021
         CL    R5,ONE                                                   15456021
         BE    RNM250              NO                                   15462021
         CL    R5,FOUR                                                  15468021
         BE    RNM250              NO                                   15474021
         MVI   CICODE,XX00                                              15480021
         TM    ITMCL3,ICLRNT       RENAMES THRU                         15486021
         BZ    RNM250              NO, ELEMENTARY                       15492021
         LA    R4,DX9               YES, TREAT LIKE GROUP               15498021
*                                                                       15504021
*                                                                       15510021
*                                                                       15516021
*                                                                       15522021
RNM250   STC   R4,ATRCNT           ATTRIBUTE COUNT                      15528021
         EX    R4,RNMATT           MOVE ATTRIBUTES                      15534021
         TM    ITMCL3,ICLRNT       RENAMES THRU                         15540021
         BZ    RNM260              NO                                   15546021
         TM    RNTHRU,SWON         RENAMES THRU                         15552021
         BZ    RNM340              ASSIGN ADD. PARAMETERS               15558021
RNM260   NI    ATTRIB+NX6,XX01     BE SURE Q-BIT IS OFF           55191 15564021
         OI    ATTRIB+NX6,XXE4      SET LEVEL NUM = 66                  15570021
         LA    R1,CIPARM                                                15576021
         L     R15,AENTNM                                               15582021
         BALR  R14,R15             LNK TO ADDR IN REG 15                15588021
         L     R15,RNMSV2                                               15594021
         ST    R1,DICTPT                                                15600021
         ST    R1,REALPTR                                               15606021
         TM    PHZSW1,XREF         XREF SPECIFIED                       15612021
         BZ    RNM270              NO                                   15618021
         LA    R1,CI               YES                                  15624021
         L     R15,AXREF                                                15630021
         BALR  R14,R15             GO GENERATE XREF                     15636021
RNM270   L     R15,ASRCHT                                               15642021
         L     R5,ACHNXT                                                15648021
         BALR  R3,R5               GO GET NEXT ENTRY                    15654021
RNM280   L     R14,RNMSV1                                               15660021
         BR    R14                 RETURN                               15666021
         EJECT                                                          15672021
*=2  PROCESS SUBJECT OF RENAMES THRU CLAUSE                             15678021
*                                                                       15684021
RNM300   DS    0H                  RENAMES THRU CLAUSE                  15690021
         OI    RNTHRU,SWON         TURN SW ON                           15696021
         MVC   RNMPTR(LX4),RNMSAV   SAVE PTR                            15702021
         MVC   RNMADP(LX3),DX2(R2)   SAVE ADD. PARM.                    15708021
         SR    R3,R3                                                    15714021
         IC    R3,DX1(R2)           GET MINOR CODE                      15720021
         SRL   R3,DX4               SHIFT OUT MAJOR CODE                15726021
         CL    R3,ONE              FIXED LENGTH GROUP                   15732021
         BE    RNM310              YES                                  15738021
         CL    R3,FOUR             VARIABLE LENGTH GROUP                15744021
         BNE   RNM320              NO                                   15750021
         OI    RNMVAR,SWON         TURN VARIABLE SW ON                  15756021
RNM310   OI    RNMGRP,SWON         TURN GROUP SW ON                     15762021
         LR    R3,R2                                                    15768021
         SR    R3,R6               MINUS COUNT OF NAME                  15774021
         S     R3,FOUR             MINUS FIXED COUNT                    15780021
         MVC   RNMDL1(LX3),DX0(R3)                                      15786021
         NI    RNMDL1,XX3F          TURN OFF HIGH BITS                  15792021
RNM320   TM    DX2(R2),XX40         AFTER ODO                           15798021
         BZ    RNM330              BRH ON 0 TO RENAME ERROR RTN         15804021
         OI    RNMVAR,SWON         TURN VARIABLE SW ON                  15810021
RNM330   L     R15,ASRCHT          GO GET NEXT ELEMENT                  15816021
         L     R5,ACHNXT                                                15822021
         BALR  R3,R5               LINK TO ADDR IN REG 5                15828021
         L     R15,RNMSV2                                               15834021
         SR    R6,R6                                                    15840021
         IC    R6,DX1(R7)           GET COUNT OF NAME                   15846021
         XC    LITBUF(LX32),LITBUF  CLEAR AREA                          15852021
         EX    R6,RNAMMV           MOVE NAME TO SAVE                    15858021
         CLI   DX0(R7),XX23         REGULAR RENAMES                     15864021
         BE    RENAME              YES                                  15870021
         CLI   DX0(R7),XX22         QUAL RENAMES                        15876021
         BE    QRENMS              YES                                  15882021
         B     RNM280              NO, ERROR GO OUT                     15888021
         EJECT                                                          15894021
*=2  PROCESSES OBJECT OF RENAMES THRU CLAUSE AND DETERMINES             15900021
*    ADDRESSING PARAMETER FOR RENAMES CLAUSE                            15906021
*                                                                       15912021
RNM340   DS    0H                                                       15918021
         TM    RNMGRP,SWON         WAS SUBJECT GROUP                    15924021
         BZ    RNM345              NO                                   15930021
         XC    RNMGRP(LX1),RNMGRP   TURN OFF GROUP SW                   15936021
         C     R3,RNMDEL           YES, SEE IF SUBORDINATE              15942021
         BNL   RNM345              NOT SUBORDINATE                      15948021
         BAL  R5,RNMERR            YES, ERROR                           15954021
         DC    X'2089'                                                  15960021
RNM345   CLC   RNMSAV(LX4),RNMPTR   DOES OBJECT FOLLOW SUBJECT          15966021
         BNH   RNM193              NO, ERROR                            15972021
         MVC   ATTRIB+NX2(LX3),RNMADP YES, GET ADD PARM OF 1ST          15978021
         SR    R1,R1                                                    15984021
         IC    R1,RNMADP+NX2                                            15990021
         SR    R3,R3                                                    15996021
         TM    RNMVAR,SWON         DATANAME2 VARIABLE                   16002021
         BO    RNM347              YES                                  16008021
         TM    DX2(R2),XX40         DATANAME3 VARIABLE                  16014021
         BZ    RNM346              BRH ON 0 TO RENAME ERROR RTN         16020021
        OI     RNMVAR,SWON         YES, SET SW ON                       16026021
         B     RNM347              BRH TO RENAME ERROR RTN              16032021
RNM346   IC    R3,DX4(R2)           GET BL NUMBER OF CURRENT            16038021
         SR    R3,R1                                                    16044021
         SLL   R3,DX12              MULTIPLY BY 4096                    16050021
RNM347   MVC   RNMADD(LX2),DX2(R2)                                      16056021
         NI    RNMADD,XX0F                                              16062021
         LH    R4,RNMADD                                                16068021
         NI    RNMADP,XX0F          CLEAR DISPL OF 1ST                  16074021
         MVC   RNMAD2(LX2),RNMADP   MOVE ADD. PARAMETER                 16080021
         SH    R4,RNMAD2           R4 CONTAINS DIFF                     16086021
         AR    R4,R3               BL'S + DISPL                         16092021
         ST    R4,RNMAD1                                                16098021
RNAMLT   MVC   RNMTMP(LX4),ZEROS    CLEAR AREA                          16104021
         SR    R5,R5                                                    16110021
         IC    R5,DX1(R2)           GET MINOR CODE                      16116021
         SRA   R5,DX4                                                   16122021
         SLA   R5,DX2               MULTIPLY BY 4                       16128021
         B     RNMLNT(R5)          GO TO GET PROPER LENGTH              16134021
*                                                                       16140021
*  BRANCHING TABLE TO CALCULATE LENGTH OF OBJECT OF RENAMES             16146021
*  THRU CLAUSE                                                          16152021
*                                                                       16158021
*                                                                       16164021
RNMLNT   EQU   *                                                        16170021
         B     RNM350              UNASSIGNED                           16176021
         B     RNM355              GROUP FIXED                          16182021
         B     RNM360              ALPHABETIC                           16188021
         B     RNM360              AN                                   16194021
         B     RNM365              VAR. GROUP                           16200021
         B     RNM370              RPT                                  16206021
         B     RNM370              STR.RPT.                             16212021
         B     RNM390              INDEX DATA NEME                      16218021
         B     RNM380              EXT DEC.                             16224021
         B     RNM380              EXT FLT. PNT.                        16230021
         B     RNM385              INT FLT. PNT.                        16236021
         B     RNM390              BIN                                  16242021
         B     RNM392              INTERNAL DECIMAL                     16248021
         B     RNM394              STERLING NON-RPT                     16254021
         B     RNM375           ALPHANUMERIC EDITED               52745 16260021
         B     RNM350              E                                    16266021
RNM355   MVC   RNMTM1(LX3),DX6(R2)   MOVE LENGTH                        16272021
         NI    RNMTM1,XX01          ZERO OUT                            16278021
         B     RNM400              FINISH PROCESSING                    16284021
RNM360   MVC   RNMTM2(LX2),DX7(R2)   LENGTH IN BITS 48-63               16290021
         B     RNM400              FINISH PROCESSING                    16296021
RNM365   MVC   RNMVLC(LX2),DX7(R2)   VLC IN BITS 60-63                  16302021
         OI    RNMVAR,SWON         SET VARIABLE SW ON                   16308021
         NI    RNMVLC,XX0F          ZERO OUT HIGH ORDER                 16314021
         B     RNM400              FINISH PROCESSING                    16320021
RNM370   MVC   RNMTM3(LX1),DX11(R2)     LGN IN BITS 88 - 95       52745 16326021
         B     RNM400              FINISH PROCESSING                    16332021
RNM375   MVC   RNMTM2(LX2),DX9(R2)      LGN IN BITS 72 - 87       52745 16338021
         B     RNM400              FINISH PROCESSING                    16344021
RNM380   MVC   RNMTM3(LX1),DX8(R2)   LENGTH IN BITS 64-71               16350021
         B     RNM400              FINISH PROCESSING                    16356021
RNM385   SR    R3,R3                                                    16362021
         TM    DX8(R2),XX01         DOUBLE WORD                         16368021
         BZ    RNM387              NO                                   16374021
         LA    R3,DX4                                                   16380021
RNM387   LA    R3,DX4(R3)                                               16386021
         ST    R3,RNMTMP                                                16392021
         B     RNM400              BRH TO RENAME ERROR RTN              16398021
RNM390   LA    R3,DX2                                                   16404021
         CLI   DX8(R2),XX05         HALFWORD                            16410021
         BL    RNM391              BR ON LOW TO RENAME ERROR RTN        16416021
         LA    R3,DX2(R3)           AT LEAST FULL WORD                  16422021
         CLI   DX8(R2),XX0A         FULL WORD                           16428021
         BL    RNM391              BR ON LOW TO RENAME ERROR RTN        16434021
         LA    R3,DX4(R3)           DOUBLE WORD                         16440021
RNM391   ST    R3,RNMTMP                                                16446021
         B     RNM400              BRH TO RENAME ERROR RTN              16452021
RNM392   SR    R4,R4                                                    16458021
         IC    R4,DX8(R2)                                               16464021
         LA    R4,DX2(R4)                                               16470021
         SRA   R4,DX1                                                   16476021
         ST    R4,RNMTMP                                                16482021
         B     RNM400              BRH TO RENAME ERROR RTN              16488021
RNM394   TM    DX1(R2),XX06         IS THERE PTR                        16494021
         BM    RNM396              YES                                  16500021
         TM    DX1(R2),XX08                                             16506021
         BO    RNM396              YES                                  16512021
         MVC   RNMTM3(LX1),DX9(R2)   LENGTH IN BITS 75-76               16518021
         NI    RNMTM3,XX1F          ZERO 3 HIGH ORDER BITS              16524021
         B     RNM400              BRH TO RENAME ERROR RTN              16530021
RNM396   MVC   RNMTM3(LX1),DX12(R2)  LENGTH IN BITS 99-103              16536021
         NI    RNMTM3,XX1F                                              16542021
*                                                                       16548021
* ALL ROUTINES BRANCH HERE TO DO COMMON PROCESSING                      16554021
*                                                                       16560021
RNM400   L     R4,RNMAD1                                                16566021
         A     R4,RNMTMP           LNGTH = RNMAD1+LENGTH OF OBJECT      16572021
         ST    R4,RNMTMP                                                16578021
         NI    ATTRIB,XX0F                                              16584021
         OI    ATTRIB,XX90          SET COUNT TO NINE                   16590021
         TM    RNMVAR,SWON         Q-RTN NEEDED                         16596021
         BO    RNM450              YES                                  16602021
         NI    ATTRIB+NX1,XX0F                                          16608021
         OI    ATTRIB+NX1,XX10      FIXED LENGTH GROUP                  16614021
         MVC   ATTRIB+NX7(LX2),RNMTM2 APPEND PROPER LENGTH              16620021
         NI    ATTRIB+NX6,XXE6      SET LEVEL NUM = 66                  16626021
         B     RNM260              GO RETURN TO CALLER                  16632021
RNM450   MVC   QTEXT(LX17),RNMQRN   MOVE Q-RTN TEXT                     16638021
         XC    RNMVAR,RNMVAR       TURN OFF VARIABLE SW                 16644021
         LH    R4,VLCCTR                                                16650021
         LA    R4,DX1(R4)           BUMP VLC BY 1                       16656021
         STH   R4,QTEXT+NX4         SAVE VLC NUMBER                     16662021
         STH   R4,VLCCTR                                                16668021
         MVC   ATTRIB+NX7(LX2),VLCCTR    SET UP ATTRIBUTES              16674021
         NI    ATTRIB+NX1,XX0F      SAVE FLAG BYTE                      16680021
         OI    ATTRIB+NX1,XX40      SET FOR VARIABLE LENGTH GROUP       16686021
         TM    ATTRIB+NX2,XX40      SBL FOR DATANAME 2                  16692021
         BZ    RNM455              NO                                   16698021
         OI    QTEXT+NX12,XX04      SET INDICATOR ON                    16704021
RNM455   TM    DX2(R2),XX40         DATANAME3 SBL                       16710021
         BZ    RNM460              NO                                   16716021
         OI    QTEXT+NX8,XX04       YES, SET INDICATOR ON               16722021
RNM460   MVC   QTEXT+NX13(LX1),ATTRIB+NX4 MOVE LOCATOR COUNTER          16728021
         MVC   QTEXT+NX9(LX1),DX4(R2)                                   16734021
         LA    R3,DX20              MIMIMUM COUNT                       16740021
         LA    R4,QTEXT+NX17        NEXT FIELD                          16746021
         CL    R5,CON16            VLC FOR DATANAME3                    16752021
         BNE   RNM470              NO                                   16758021
         MVC   QTEXT+NX14(LX2),RNMQRN+NX2 YES, MOVE VLC HEADER          16764021
         MVC   QTEXT+NX16(LX2),RNMVLC  MOVE VLCCTR                      16770021
         LA    R3,DX1(R3)           BUMP COUNT                          16776021
         LA    R4,DX1(R4)           UPDATE PTR                          16782021
RNM470   MVI   DX0(R4),XXBB         BUNARY LITERAL                      16788021
         MVC   DX1(LX2,R4),RNMTM2    LENGTH                             16794021
         L     R15,APTQRN                                               16800021
         BALR  R14,R15             PUT OUT Q-RTN                        16806021
         L     R15,RNMSV2                                               16812021
         B     RNM260              GO FINISH PROCESSING                 16818021
         EJECT                                                          16824021
*=E  RENAMES ERROR ROUTINES                                             16830021
*                                                                       16836021
RNM190   BAL   R5,RNMERR           LNK TO RENAME ERROR ROUTINE          16842021
         DC    X'2016'             MSG 22                               16848021
RNM191   BAL   R5,RNMERR           LNK TO RENAME ERROR ROUTINE          16854021
         DC    X'20BB'             MSG 187                              16860021
RNM192   BAL   R5,RNMERR           LNK TO RENAME ERROR ROUTINE          16866021
         DC    X'20A0'             MSG 160                              16872021
RNM193   BAL   R5,RNMERR           LNK TO RENAME ERROR ROUTINE          16878021
         DC    X'20B9'             MSG 185                              16884021
RNMERR   LH    R0,DX0(R5)                                               16890021
         L     R15,AERRTN                                               16896021
         BALR  R14,R15             WRITE ERROR MESSAGE                  16902021
         L     R15,RNMSV2                                               16908021
         XC    RNAMSW,RNAMSW       TURN OFF SW                          16914021
ENDRNM   TM    ITMCL3,ICLRNT       WAS IT RENAMES THRU                  16920021
         BZ    RNM270              NO                                   16926021
         XC    RNTHRU(LX1),RNTHRU   TURN OFF SW                         16932021
ENDRN1   IC    R6,DX1(R7)           COUNT OF NAME                       16938021
         L     R15,ASRCHT                                               16944021
         L     R5,ACHNXT                                                16950021
         BALR  R3,R5               GET NEXT ELEMENT                     16956021
         L     R15,RNMSV2                                               16962021
         TM    DX0(R7),XX22         STILL RENAMES                       16968021
         BO    ENDRN1              YESC                                 16974021
         B     RNM280              NO, GO OUT                           16980021
*     COMPILER ERROR - MINOR CODE IS ILLEGAL                            16986021
*                                                                       16992021
RNM350   BAL   R5,RNMERR           MSG 74                               16998021
         DC    X'804A'             MSG 74                               17004021
RNAMMV   MVC   LITBUF(LX1),DX1(R7)                                      17010021
RNMMOV   MVC   WKAREA(LX1),DX1(R7)                                      17016021
RNMATT   MVC   ATTRIB(LX1),DX0(R2)                                      17022021
         EJECT                                                          17028021
*=1    FD NAME PROCESSOR - FSTEXT                                       17034021
*=1    FD NAME PROCESSOR - FSTEXT                                       17040021
*TITLE 'FSTEXT'- FD NAME PROCESSOR                                      17046021
*FUNCTION/OPERATION- RESERVES SPACE, DEFINES, AND SETS UP CONSTANT      17052021
*   FOR DCB'S AND DECB'S FOR QSAM, QISAM, BISAM, BSAM, AND BDAM ACC     17058021
*   METHODS. SETS UP THE DICTIONARY ENTRY FOR AN FD. CALLS A SUB-       17064021
*   ROUTINE-ACCMET- TO CHECK I/O CLAUSES AND TO FILL IN INFORMATION     17070021
*   (GOTTEN FROM THE CLAUSES) IN DCB,DECB, AND FD DICTIONARY ENTRY.     17076021
*ENTRY POINT- FSTEXT-IS ONLY ENTRY POINT AND IS ENTERED BY              17082021
*                             BC   EQ,FSTEXT                            17088021
*                   FROM THE FILEST  RTN.                               17094021
*                   REG 7 IS PASSED TO FSTEXT WITH ADDRESS OF THE       17100021
*                   IC-TEXT BUFFER.                                     17106021
*INPUT-  REG 7  POINTS TO FD IC-TEXT IN FILE 3 BUFFER.                  17112021
*OUTPUT-  DCBADEF     -DCB ADDRESS DEFINITION                           17118021
*         DECBADEF    -DECB ADDRESS DEFINITION (IF BASIC ACCESS MET     17124021
*         DCB CONDEF  -DCB CONSTANT DEFINITION                          17130021
*         DECB CONDEF -DECB CONSTANT DEFINITION (1 PER CYCLE IF ASY     17136021
*                                                RONOUS PROCESSING)     17142021
*         ALL OUTPUT GOES ON FILE 4 AS A-TEXT FOR PHASE 6.              17148021
*EXTERNAL ROUTINE. ACCMET- CHECKS COBOL CLAUSES RELATED TO FD AND       17154021
*   PUTS CLAUSE INFORMATION IN DCB, DECB, AND FD ENTRY.                 17160021
*EXITS- ONLY 1 EXIT -FS011A- RETURNING TO FILEST. NO CODE PASSED        17166021
*TABLES/WORK AREAS.                                                     17172021
*   DCBCON   -DCB CONDEF                                                17178021
*   DECBCN   -DECB CONDEF                                               17184021
*   DCBDEF   -DCB,DECB ADDRESS DEF.                                     17190021
*   CI       -FD DICTIONARY ENTRY                                       17196021
*   PIOTBL   -TAMER TABLE- OPEN AND USE COBOL CLAUSES                   17202021
*   APPTBL   -TAMER TABLE- APPLY RANDOM PROCESSING INFORMATION.         17208021
IKF203   CSECT                                                          17214021
         USING *,R15                                                    17220021
         USING PIBDST,R10                                               17226021
         USING ICTDST,R7                                                17232021
FSTXT    XC    DCBCON(LX222),DCBCON CLEAR DCB, DECB AND OTHER FD        17238021
*                                       CALCULATION AREA.               17244021
         ST    R14,BRET            SAVE RETURN REGISTER                 17250021
         MVI   SRANO,XX00          RESET SD SAME REC AREA NO            17256021
         XC    CI(LX160),CI             CLEAR AREA                      17262021
         XC    BUFCAL+NX11(LX17),BUFCAL+NX11                            17268021
         MVC   PLBLSW(LX1),LBLSW                                        17274021
         OI    FSTSW,XX44           SET FS SW FOR BCOPY AND PHTERM      17280021
         MVC   LOCCTR(LX4),SAV01L                                       17286021
         MVC   CARDNO(LX2),ICTCDN   CARD NUMBER FOR ERRORS              17292021
         TM    ICTFL1,ICTRDA       IS ACCESS RANDOM                     17298021
         BZ    FS001               NO                             LCLIO 17304021
         TM    ICTFL1,ICTORG       YES, IS ORG. STANDARD SEQUENTIAL     17310021
         BNZ   FS001               NO                             LCLIO 17316021
       LA    R0,AM(R0,R0)          YES, ERROR BECOMES SEQUENTIAL AC     17322021
         SR    R1,R1                                                    17328021
         ST    R15,RSAVE+NX60                                           17334021
         L     R15,AERRTN                                               17340021
         BALR  R14,R15             CALL ERROR ROUTINE                   17346021
         L     R15,RSAVE+NX60                                           17352021
* DETERMINE ACCESS METHOD AND SET R8= A(ACC. METHOD TABLE ENTRY) FO     17358021
*  THIS METHOD.                                                         17364021
FS001    SR    R8,R8                                                    17370021
         IC    R8,ICTFL1           PUT ACCESS AND ORGANIZATION IN L     17376021
         SRL   R8,DX4                4 BITS OF REG 8                    17382021
         LA    R8,PRMTBL(R8)                                            17388021
         SR    R6,R6                                                    17394021
         IC    R6,DX0(R8)           LEGAL                               17400021
         LA    R8,ACCTAB(R6)                                            17406021
         IC    R9,VCOUNT(R8)      GET FDVCNT FROM ACCTABL.              17412021
         STC   R9,FDVCNT          SET FDVCNT FIELD.                     17418021
* GET THE NEXT DCB= AND ITS REL LOC AND PUT OUT DCB ADDRESS DEFINIT     17424021
         LH    R9,DCBCTR                                                17430021
         LA    R9,DX1(R9)           INCREMENT DCB CTR                   17436021
         STC   R9,DCBDEF+NX4        STORE DCB = IN DCBADEF              17442021
         STC   R9,PRDCBNO                PRESENT DCB NO           45078 17448021
         BAL   R4,BOUND            GET LOCATION COUNTER IN REG 10       17454021
*                                   ROUNDED UP TO MULTIPLE OF 4         17460021
* SET UP EXIT LIST(DCB PREFIX) BEFORE DEFINING DCB.                     17466021
         ST    R10,DCBPRX         PUT OUT DCB PREFIX CONDEF             17472021
         MVI   DCBPRX,XX28                                              17478021
         XC    DCBPLST(LX24),DCBPLST ZERO OUT PART OF EXIT LIST         17484021
         TM    AMCODE(R8),XX10     QISAM?                               17490021
         BZ    *+8                 NO                                   17496021
         OI    DCBPAD1+NX4,XX05    YES - DCB EXIT CODE                  17502021
         TM    AMCODE(R8),XX20     BISAM?                               17508021
         BZ    FS001A             NO.                                   17514021
         TM    ICTUN1,XX08         YES. CORE-INDEX?                     17520021
         BZ    FS001A             NO.                                   17526021
         MVI   DCBPAD1+NX4,XX05    DCB-EXIT CODE.                       17532021
FS001A   MVI   DCBPAD1+NX8,XX00                                         17538021
         TM    DX8(R8),XXB0        QSAM OR BSAM?                        17544021
         BNZ   FSEOPRX            NO                                    17550021
         MVI   DCBPAD1+NX8,XX08    YES. SET ERR-BIT CODE                17556021
FSEOPRX  MVC   FULLWD(LX2),DCBPSZ                                       17562021
         AH    R10,FULLWD                                               17568021
         L     R1,COSADR                                                17574021
         LA    R2,DCBPRX                                                17580021
         LA    R3,DX47                                                  17586021
         BALR  R0,R1              PUT OUT DCB PREFIX                    17592021
         DC    X'14'              TOT-AREA CODE MUST BE SET LATER       17598021
         ST    R10,BUFCAL+NX12                                          17604021
         ST    R10,DCBDEF          STORE LOCCTR VALUE IN DCBADEF        17610021
         MVI   DCBDEF,XX04          MOVE CODE INTO DCBADEF              17616021
         LA    R3,DX5                                                   17622021
         BAL   R14,MASPUF          CALL PUTN ROUTINE                    17628021
       STC   R9,FDCBNO            STORE DCB NO. IN CI                   17634021
         ST    R10,DCBADD          SAVE LOCCTR OF DCB                   17640021
         TM    BUFCAL+NX10,XX01     S-MODE                              17646021
FSEOPR1  AH    R10,DX4(R8)          UPDATE AND RESTORE                  17652021
         ST    R10,LOCCTR                                               17658021
         STH   R9,DCBCTR                                                17664021
         MVC   FDACMT(LX1),DX8(R8)  PUT ACCESS METHOD IN CI             17670021
         CLI   DX8(R8),XX84                                             17676021
         BNE   *+8                 NO                                   17682021
         LA    R8,DX32(R8)                                              17688021
         PACK  BUFCAL+NX24(LX1),DX8(LX1,R8) AND BUFFER CALC. AREA(LOW 4 17694021
         NI    BUFC24,ACCMON       TURN HIGH BITS OFF                   17700021
         MVI   FDCUNT,XX98         SET COUNT=8,MAJOR CODE=8 IN CI       17706021
         ST    R8,BUFCAL+NX20                                           17712021
IOERR00  MVI   DCB+NX59,XX01                                            17718021
         L     R10,ADPIOT                                               17724021
         L     R10,DX0(R10)                                             17730021
         L     R10,DX0(R10)                                             17736021
         MVC   FULLWD+NX2(LX2),ICTPIR                                   17742021
         AH    R10,FULLWD+NX2                                           17748021
         TM    AMCODE(R8),XXFF      QSAM                                17754021
         BNZ   IOERR0A             NO                                   17760021
         TM    PIBFL3,PIBNSL       YES, SEE IF USE                      17766021
         BZ    IOERR0A             NO                                   17772021
         OI    FDVCNT,XX01          YES, SET BIT ON                     17778021
IOERR0A  OI    FDNOBL,XX10                                              17784021
         TM    PIBFL2,PIBUSE      USE ERROR?                            17790021
         BO    IOERR01            YES.                                  17796021
         NI    FDNOBL,XXEF                                              17802021
         TM    PIBFL3,PIBINV      NO. INV-KEY?                          17808021
         BNZ   IOERR01             YES                                  17814021
         OI    ERRSW,XX01          N                                    17820021
IOERR01  L     R10,DCBADD                                               17826021
         LA    R10,DX56(R10)       R10=REL LOC OF DCBSYNAD              17832021
         ST    R10,FULLWD                                               17838021
         MVC   ERRTARG(LX3),FULLWD+NX1 TARGET ADDRESS.                  17844021
         MVC   ERRNAME+NX7(LX1),DX3(R8)                                 17850021
         TM    AMCODE(R8),XXB0                                          17856021
         BNZ   IOERR98             NOT QSAM OR BSAM-BR TO ERR RTN       17862021
IOERRSQ  LA    R10,DX22            REL LOC OF ERR-BIT-RTN IN INIT-1     17868021
         ST    R10,LITBUF+NX4      SOURCE ADDRESS.                      17874021
         L     R10,DCBADD         LOAD R10 WITH DCB ADDR.               17880021
         SH    R10,CON19+NX2       DCB-19                               17886021
         ST    R10,LITBUF         TARGET ADDRESS.                       17892021
         MVI   LITBUF,XX2C         ADCON CODE                           17898021
         MVI   LITBUF+NX4,XX03     ADCON LGN=3                          17904021
         L     R1,COSADR                                                17910021
         LA    R2,LITBUF                                                17916021
         LA    R3,DX8              OUTPUT IS 8 BYTE LONG.               17922021
         BALR  R0,R1              PUT OUT ADCONDEF ON F-4.              17928021
         DC    X'14'                                                    17934021
IOERR98  TM    ERRSW,XX01                                               17940021
         BO    FS001B             NO SYNAD                              17946021
         LR    R1,RCOM                                                  17952021
         LA    R2,ERRVCON                                               17958021
         LA    R3,DX17             OUTPUT IS 17 BYTE LONG               17964021
         BALR  R0,R1              PUT OUT VCONDEF ON F-2.               17970021
         DC    X'12'                                                    17976021
ERRSW    DC    X'00'                                                    17982021
IOERR99  B     FS002        ***** BY-PASS ASYNCH. PROC. CODE.           17988021
* IF BASIC ACCESS METHOD, GET NEXT DECB= AND ITS REL LOC AND PUT OU     17994021
*  DECB ADDRESS DEFINITION. IF RANDOM PROCESSING ALLOCATE SPACE FOR     18000021
*  DECB'S.WHERE N= = OF CYCLES.                                         18006021
FS001B   L     R10,DCBADD         NEGATE 08 EXIT LIST ENTRY.            18012021
         S     R10,TWENTY                                               18018021
         XC    LITBUF+NX4(LX4),LITBUF+NX4 BINARY                        18024021
         MVC   LITBUF+NX5(LX2),ONE+NX2   ONE BYTE                       18030021
         ST    R10,LITBUF                                               18036021
         MVI   LITBUF,XX28         CONSTANT                             18042021
         L     R1,COSADR                                                18048021
         LA    R2,LITBUF                                                18054021
         LA    R3,DX8                                                   18060021
         BALR  R0,R1               BR TO COMMON                         18066021
         DC    X'14'                                                    18072021
FS002    DS    0H                                                       18078021
         NI    ERRSW,XXFE                                               18084021
         MVI   MCI,XX00             SET MAJOR CODE FOR 01-49 ITEMS      18090021
         NI    FAPAF,XX7F           TURN OFF O/LINE BL IN ADDR. PARA    18096021
         XI    DX19(R8),XX01                               A2           18102021
         CLI   DX6(R8),XX00         DOES THIS ACCESS METH NEED A DEC    18108021
         BC    EQ,FS005            CHECK FOR OPEN CLAUSE                18114021
         MVC   DECB+NX4(LX1),DX7(R8) SET TYPE CODE IN DECB              18120021
         LH    R10,DECBCT                                               18126021
         LA    R10,DX1(R10)         INCREMENT DECB CTR                  18132021
         STC   R10,DECBDF+NX4            PUT DECB= IN DECBADEF          18138021
       STC   R10,FDECNO           DECB NO. IN CI                        18144021
         STH   R10,DECBCT                                               18150021
         L     R10,LOCCTR                                               18156021
         TM    FDACMT,XXA0         BDAM OR BISAM?                       18162021
         BZ    FS003              NO. NO DECBPREFIX.                    18168021
         XC    LITBUF(LX11),LITBUF YES. PUT OUT X'0...01'               18174021
         ST    R10,LITBUF         FOR GN-INV-KEY FIELD                  18180021
         MVI   LITBUF,XX28         CONSTANT DEF. CODE                   18186021
         MVI   LITBUF+NX6,XX04     SIZE=4 BYTES                         18192021
         MVI   LITBUF+NX10,XX01    X'0...01' FOR GN-INV-KEY             18198021
         LA    R3,DX11             OUT PUT SIZE = 11                    18204021
         LA    R2,LITBUF                                                18210021
         L     R1,COSADR                                                18216021
         BALR  R0,R1               BR TO COMMON                         18222021
         DC    X'14'                                                    18228021
         AH    R10,FOUR+NX2        ADD 4 TO LOCCTR                      18234021
         ST    R10,LOCCTR         UPDATE LOCCTR                         18240021
FS003    L     R10,LOCCTR                                               18246021
         ST    R10,DECBAD          SAVE IT                              18252021
         ST    R10,BUFCAL+NX16                                          18258021
         ST    R10,DECBDF          PUT IT IN REL LOC OF DELBADEF        18264021
         MVI   DECBDF,XX08          SET CODE                            18270021
         SR    R9,R9                                                    18276021
         IC    R9,DX6(R8)           GET DECB LGN (BYTES)                18282021
         STC   R9,BUFCAL+NX25       PUT DECB LGN IN BUFCAL              18288021
         SRL   R9,DX2                CONVERT LGN TO WORDS               18294021
         STC   R9,DECBDF+NX8        PUT IT IN DECBADEF                  18300021
         LA    R3,DX9                                                   18306021
         BAL   R14,MASPUF          CALL PUTN ROUTINE                    18312021
FS004    SLL   R9,DX2               GET DECB LGN IN REG9 IN BYTES       18318021
         AR    R10,R9              ADD LGN TO LOCCTR AND                18324021
         ST    R10,LOCCTR                                               18330021
* MOVE FILE INFORMATION FROM BUFFER TO WORK AREAS AND CHECK IF AN O     18336021
*  CLAUSE WAS SPEC'D IN PROCEDURE DIVISION.                             18342021
FS005  EQU   *                                                          18348021
         MVC   BUFCAL+NX28(LX2),ICTCDN AND BUFCAL                       18354021
         MVC   DCB+NX40(LX8),ICTEXF  MOVE EXTERNAL NAME TO DCB          18360021
         MVI   DCB+NX48,XX02        SET OFLG OF DCB TO ENABLE OPEN      18366021
         TM    AMCODE(R8),XX40     BSAM?                                18372021
         BZ    *+8               NO.                                    18378021
         MVI   DCB+NX79,XX01      SET DCBEOBW TO 1.                     18384021
         L     R10,ADPIOT          YES, GET ADDRESS OF PIOTBL'S TIB     18390021
         OI    PTBLSW+NX1,XX01      SET TABLE SW ON                     18396021
         L     R10,DX0(R0,R10)     GET ADDRESS OF PIOTBL'S TAMM         18402021
         L     R10,DX0(R0,R10)     GET ADDRESS OF PIOTB                 18408021
         MVC   FULLWD+NX2(LX2),ICTPIR MOVE PIOTBL PTR TO FULL WORD BOU  18414021
         AH    R10,FULLWD+NX2       ADD PTR TO TABLE ADDRESS FOR ADD    18420021
*                                   OF SPECIFIC ENTRY IN TABLE.         18426021
         MVI   BPERRO,XX00          SET OPEN SW OFF                     18432021
         NI    BUFCAS+NX24,XX7F                             A1          18438021
         TM    FSTSW,XX80          FIRST FD?                            18444021
         BZ    FS005A             YES.                                  18450021
         CLC   BUFCAL+NX20(LX4),LOCDEC+NX4 NO. SAME ACCESS?             18456021
         BNE   FS005A                      NO.                          18462021
         L     R1,LOCDEC+NX4                YES.                        18468021
         XI    DX19(R1),XX01                                            18474021
         OI    ACCMTH,XX80                                              18480021
FS005A   MVC   BUFCAL(LX8),ICTRAR   MOVE BUFFER INFO TO WORK AREA       18486021
         MVC   FL4SAVE(LX1),ICTFL4  SAVE FOR LATER USE            59737 18492021
       SR    R3,R3                GET RECORDING MODE                    18498021
       IC    R3,ICTFL6                                                  18504021
         SRL   R3,DX2                                                   18510021
         STC   R3,BUFCAL+NX10      STORE IT IN BUFCAL                   18516021
         NI    BUFCAL+NX10,XX0F   TURN OFF TOTALING & TOTALED BITS      18522021
         MVC   BUFCAL+NX8(LX2),ICTBMX STORE MAX. BLOCK COUNT            18528021
* CALL -ACCMET- TO CHECK  I/O CLAUSES AND SET UP DCB, DECB, AND FD      18534021
*  DICTIONARY  ENTRY.                                                   18540021
FS007    ST    R15,RSAVE+NX60                                           18546021
         L     R15,AACMET                                               18552021
         BALR  R14,R15             CALL ACCESS METHOD ROUTINE           18558021
         L     R15,RSAVE+NX60                                           18564021
         L     R11,COSADR         RESTORE RCOM                          18570021
*ON RETURN FROM THE ACCESS METHOD ROUTINE, REG 7 (POINTER TO BUFFER     18576021
* POINTS TO THE LAST BYTE IN THE FS-TEXT WHICH IS A ZERO BYTE.          18582021
* THE FOLLOWING THREE INSTRUCTIONS WILL CAUSE REG 7 TO BE INCREMENT     18588021
* TO THE NEXT IC-TEXT OF FILE 3.                                        18594021
         LA    R4,DX1(R0,R0)        R4 INCREMENTS R7 IN BSUBRN          18600021
         LR    R5,R4                                                    18606021
         L     R1,ABSUBR                                                18612021
         L     R15,AMAIN                                                18618021
         BALR  R6,R1               GET NEXT BUFFER CONTENTS             18624021
         L     R15,AFSTXT                                               18630021
*FS008       PUTS OUT THE DCB AND DECB(S) FOR THE ACCESS METHODS. T     18636021
*DCB AND DECB WERE CONSTRUCTED BY THE ACCESS METHOD PREVIOUSLY CALL     18642021
FS008    LA    R4,DX100             R4= NO. OF DCB BYTES TO BE PUT      18648021
         LA    R2,DCBCON           R2= ADDRESS OF FIELD TO BE PUT       18654021
         LH    R6,DX4(R8)           R6= DCB LENGTH                      18660021
         L     R9,DCBADD           R9= DCB RELATIVE LOCATION(RELLOC     18666021
FS008A   ST    R9,DCBCON           SET CONDEF TARGET ADD. TO DCB RE     18672021
         MVI   DCBCON,XX28          SET CONDEF CODE                     18678021
         ST    R4,FULLWD                                                18684021
         MVC   DCBCON+NX5(LX2),FULLWD+NX2 SET CONDEF LENGTH FIELD       18690021
         LA    R3,DX7(R4)           R3= NO. OF BYTES(CONDEF+DCB) FOR    18696021
         L     R1,COSADR                                                18702021
         BALR  R0,R1               PUT CONDEF ON FILE 4                 18708021
         DC    X'14'                                                    18714021
         SR    R6,R4               R6= DCBLGN-NO. OF DCB BYTES PUT      18720021
         BC    ZERO,FS008C         ALL DCB BYTES HAVE BEEN PUT OUT      18726021
         AR    R9,R4               R9= NEXT TARGET ADDRESS              18732021
         XC    DCB(LX100),DCB       REST OF DCB IS ZEROS                18738021
         C     R6,CON60                                                 18744021
         BC    HI,FS008A                      GR THAN 56                18750021
         BC    LO,FS008B                      LS THAN 56                18756021
         MVC   DCB+NX52(LX2),DCB+NX100           =  TO  56 (BUFNO-QIS   18762021
FS008B   LR    R4,R6                                                    18768021
         BC    UNCOND,FS008A       PUT OUT NEXT DCB CONDEF              18774021
FS008C   L     R9,DCBADD                                                18780021
         LA    R3,DX37(R9)         DCB+37=A(EXLIST)                     18786021
         ST    R3,EXLADCN                                               18792021
         MVC   EXLADSZ(LX4),DCBPRX   RELATIVE ADDRESS                   18798021
         MVI   EXLADCN,XX2C        ADCON DEF.                           18804021
         MVI   EXLADSZ,XX03        AL3                                  18810021
         LA    R3,DX8                                                   18816021
         LA    R2,EXLADCN                                               18822021
         L     R1,COSADR          PUT OUT DCBEXLST ADCON.               18828021
         BALR  R0,R1               BR TO COMMON                         18834021
         DC    X'14'                                                    18840021
         CLI   DX6(R8),XX00        IS THERE A DECB TO BE PUT OUT.       18846021
         BC    EQ,FS011A           NO, BRANCH                           18852021
         TM    DX8(R8),XX80         YES, IS IT A BDAM DECB              18858021
         BC    NOTONE,FS009        NO                                   18864021
         MVC   FULLWD(LX4),DECB+NX24 YES, SAVE BLKREF ADDRESS           18870021
         L     R9,FULLWD                 IN REG 9                       18876021
FS009    L     R10,DECBAD          R10= DECB RELATIVE LOCATION          18882021
         SR    R4,R4                                                    18888021
         IC    R4,DX6(R8)           R4= DECB LENGTH                     18894021
         STC   R4,DECBCN+NX6        PUT DECB LGN INTO DECBCN(CONDEF)    18900021
FS010    ST    R10,DECBCN          PUT DECB REL LOC INTO DECBCN         18906021
         MVI   DECBCN,XX28          PUT CONDEF CODE IN DECBCN           18912021
         LA    R3,DX7(R4)                                               18918021
         MVC   SVDECB(LX4),DECBCN+DX24  SAVE BYTES 25 THRU 28           18924021
         XC    DECBCN+DX24(LX4),DECBCN+DX24  ZERO BYTES 25 THRU 28      18930021
         LA    R2,DECBCN                                                18936021
         L     R1,COSADR                                                18942021
         BALR  R0,R1               BR TO COMMON                         18948021
         DC    X'14'               PUT OUT DECB CONSTANT                18954021
         MVC   DECBCN+DX24(LX4),SVDECB RESTORE BYTES 25 THRU 28         18960021
         MVC   ACONDF+NX5(LX3),DCBADD+NX1 PUT OUT ADCON                 18966021
         LA    R0,DX8(R10)               DEFINITION                     18972021
         ST    R0,ACONDF                  FOR A(DCB) FIELD              18978021
         BAL   R14,PREMAF                      IN DECB                  18984021
         TM    DX8(R8),XX80         IS ACCESS METHOD BDAM               18990021
         BZ    FS011A              NO                                   18996021
         LA    R0,DX24(R10)         YES, PUT OUT ADCON                  19002021
         ST    R0,ACONDF               DEFINITONP                       19008021
         ST    R9,ACONDF+NX4              FOR A(BLKREF) FIELD           19014021
         BAL   R14,PREMAF                   IN DECB                     19020021
FS011A   CLI   DX8(R8),XX44         BSAM-D                              19026021
         BNE   FS011B              NO                                   19032021
         L     R3,DECBAD           A(DECB)                              19038021
         LA    R3,DX20(R3)          DECB + 20                           19044021
         ST    R3,LITBUF                                                19050021
         MVI   LITBUF,XX2C          CODE                                19056021
         LA    R3,DX4(R3)           DECB + 24                           19062021
         ST    R3,LITBUF+NX4                                            19068021
         MVI   LITBUF+NX4,XX04      ADCON LENGTH                        19074021
         LA    R3,DX8               COUNT                               19080021
         LA    R2,LITBUF                                                19086021
         L     R1,COSADR                                                19092021
         BALR  R0,R1               BR TO COMMON                         19098021
         DC    X'14'                                                    19104021
FS011B   L     R14,BRET            LOAD RETURN REG                      19110021
         XI    DX27(R8),XX80                                            19116021
         BCR   UNCOND,R14          RETURN                               19122021
PREMAF   MVI   ACONDF,XX2C          ADCON CODE                          19128021
         MVI   ACONDF+NX4,XX04      ADCON LGN                           19134021
         LA    R3,DX8               ADCON DEF. LGN                      19140021
MASPUF   LA    R2,DECBDF                                                19146021
         L     R1,COSADR                                                19152021
         BALR  R0,R1               BR TO COMMON                         19158021
         DC    X'14'                                                    19164021
         BCR   UNCOND,R14          RETURN                               19170021
*                                                                       19176021
BOUND    LA    R1,DX4               R1= MULTIPLE NEEDED                 19182021
         L     R3,LOCCTR                                                19188021
         LR    R2,R3               R2= CURRENT LOCATION COUNTER VAL     19194021
         LR    R10,R3              R10 CURRENT LOCATION COUNTER VAL     19200021
         N     R3,MK0930                                                19206021
         SR    R2,R3               ROUND R10 UP TO                      19212021
         BC    ZERO,*+NX8               MULTIPLE OF 4                   19218021
         SR    R1,R2                                                    19224021
         AR    R10,R1                                                   19230021
         BCR   UNCOND,R4           BR TO SET UP EXIT LIST               19236021
ER140  DC    X'108C'                                                    19242021
         EJECT                                                          19248021
*=2    ACCESS METHOD ROUTINE- ACCMET                                    19254021
*TITLE 'ACCMET' - ACCESS METHOD ROUTINE                                 19260021
*FUNCTION/OPERATION- CHECKS COBOL CLAUSES(RELATED TO FD) FOR ALL TH     19266021
*   COBOL ACCESS METHODS. PUTS CLAUSE INFORMATION IN DCB, DECB AND      19272021
*   DICTIONARY CLAUSE. THE CLAUSES CHECKED ARE                          19278021
*                        OPEN AND CLOSE                                 19284021
*                        ASSIGN                                         19290021
*                        RECORDING MODE                                 19296021
*                        RESERVE...ALTERNATE AREAS                      19302021
*                        SAME AREA                                      19308021
*                        LABEL RECORDS                                  19314021
*                        RERUN                                          19320021
*                        FILE LIMITS                                    19326021
*                        RESTRICTED SEARCH (APPLY 1)                    19332021
*                        RECORD PROTECTION (APPLY 3)                    19338021
*                        WRITE ONLY        (APPLY 5)                    19344021
*                        RANDOM PROCESSING (APPLY 4)                    19350021
*                        FORM-OVERFLOW     (APPLY 2)                    19356021
*                        BLOCK CONTAINS                                 19362021
*                        USE AFTER STANDARD ERROR PROCEDURE (USE 5)     19368021
*                        USE FOR CREATING...LABELS OM OUTPUT(USE 1)     19374021
*                        USE FOR CHECKING...LABELS ON INPUT (USE 2)     19380021
*                        TRACK AREA                                     19386021
*                        RECORD KEY                                     19392021
*                        SYMBOLIC KEY                                   19398021
*                        ACTUAL KEY                                     19404021
*                        WRITE AFTER ADVANCING                          19410021
*INPUT- REG 7 POINTS VARIABLE LGN PART OF FS-TEXT(IC-TEXT FOR AN FD     19416021
*OUTPUT- INDADEF- INDIRECT ADDRESS DEFINITION FOR A(ERROR DECLARATI     19422021
*   OR SYNAD IN DCB FOR USE-OPTION 5. PUT OUT AS A-TEXT FOR PHASE 6     19428021
*ENTRY POINT- ACCMET-    L    R15,A(ACCMET)                             19434021
*                        BALR R14,R15                                   19440021
*EXTERNAL ROUTINES-EXLST0-CREATE EXIT LIST FOR USE OPTION1              19446021
*                                              USE OPTION2              19452021
*                                              RERUN                    19458021
*                 -SAMRTN-SET UP SAME AREA CLAUSE ENTRY FOR SAMTBL      19464021
*                 -KEYRTN-ENTER RECORD, ACTUAL, AND SYMBOLIC KEY IN     19470021
*                         KEY TABLES                                    19476021
*                 -LABLBD-ENTER LABEL RECORD  DATA-NAMES IN LABTBL      19482021
*EXITS- ONLY ONE EXIT(NORMAL) AT -ACCMT3- NO CODES PASSED               19488021
*TABLES/WORKAREAS-                                                      19494021
*   TRKTBL- TABLE FOR TRACK AREA CLAUSE DATA-NAME                       19500021
*   CI-     FD DICTIONARY ENTRY WORK AREA                               19506021
*   DCBCON- DCB WORK AREA                                               19512021
*   DECBCN- DECB WORK AREA                                              19518021
*   BUFCAL- BUFFER CALCULATION INFORMATION STORAGE AREA                 19524021
*   SAMEAR- SAME AREA CLAUSE INFORMATION STORAGE AREA                   19530021
*ATTRIBUTES                                                             19536021
*NOTES                                                                  19542021
         USING *,R15                                                    19548021
         DROP  R7                                                       19554021
         DROP  RCOM                                                     19560021
         USING ICTDST,R11                                               19566021
         USING COS,R8             L R8,COSADR BEFORE USING IT           19572021
ACCMET   ST    R14,RSAVE+NX56       SAVE RETURN REGISTER                19578021
         LR    R11,R7             R11 POINTS TO FSTEXT                  19584021
         XC    BSAMPT(LX4),BSAMPT                                       19590021
         MVC   FSTXTSAV(LX46),DX0(R7)      MOVE IC-TEXT                 19596021
*   FROM BUFFER INTO WORK AREA                                          19602021
         LA    R7,ICTEND                PT R7 TO VARIABLE PART          19608021
         LA    R11,FSTXTSAV             R11 PTS TO FSTEXT               19614021
         BAL   R4,CHKFF            CHECK FOR END OF BUFFER      FS-     19620021
         SR    R4,R4                                                    19626021
         IC    R4,DX0(R7)           GET FILE NAME COUNT                 19632021
         EX    R4,MOVEFN           MOVE FILE NAME TO CI                 19638021
         LA    R7,DX1(R7,R4)        INCREMENT REG7 TO NEXT BUFFER FI    19644021
         BAL   R4,CHKFF            CHECK FOR END OF BUFFER              19650021
         SR    R9,R9               R9= WORK REGISTER                    19656021
         LA    R12,BAMTBL          R12= ADDRESS OF ACTION CALL TABL     19662021
ACCMT1   EX    R0,DX0(R12)                                              19668021
ACCMT2   LA    R12,DX4(R12)         INCREMENT R12 TO NEXT BAM ROUTIN    19674021
         C     R12,ENDACT          ARE ALL ROUTINES DONE                19680021
         BC    NOTLO,ACCMT3        YES                                  19686021
         BC    UNCOND,ACCMT1       NO                                   19692021
ACCMT3   MVC   BUFCAL+NX12(LX4),DCBADD PUT REL LOC OF DCB ADDRESS       19698021
         MVC   DCB+NX26(LX10),DX9(R8) FILL IN DCB FIELDS---             19704021
*                                       DSORG, BUFALN, BUFTK            19710021
         L     R14,RSAVE+NX56       RESTORE RETURN REGISTER             19716021
         BCR   UNCOND,R14          RETURN TO CALLER                     19722021
FSTXTSAV DC    XL46'00'                 FSTEXT SAVE AREA                19728021
MOVEFN   MVC   CI(LX0),DX0(R7)                                          19734021
BAMTBL   DS    0F                                                       19740021
BAM1     BAL   R5,OPENCL           OPEN CLAUSE                          19746021
BAM6     BAL   R5,RECMCL           RECORDING MODE CLAUSE                19752021
BAM8     BAL   R5,RESVCL           RESERVE CLAUSE                       19758021
BAM9     BAL   R5,SAMACL           SAME AREA CLAUSE                     19764021
BAM10    BAL   R5,LABEL0          CHECK LABEL CLAUSE                    19770021
BAM12    BAL   R5,RRUNCL           RERUN CLAUSE                         19776021
BAM13    BAL   R5,TRKLIM          TRACK LIMIT                           19782021
BAM14    BAL   R5,COREIDX         APPLY CORE INDEX.                     19788021
BAM16    BAL   R5,WRTOCL           APPLY WRITE ONLY CLAUSE              19794021
BAM17    BAL   R5,BLKCCL           BLOCK CONTAINS CLAUSE                19800021
BAM20    BAL   R5,TRKACL           TRACK AREA CLAUSE                    19806021
BAM20A   BAL   R5,BDAMCL           BDAM  CLAUSE                         19812021
BAM21A   BAL   R5,BSAMKY           BSAM KEY CLAUSE                      19818021
BAM22    BAL   R5,KEYSCL           SYMBOLIC,ACTUAL,RECORD KEYS CL       19824021
BAM22A   BAL   R5,REORG00         CHECK REORG CRITERIA                  19830021
BAM22B   BAL   R5,TOTAR00         CHECK TOTALING AREA                   19836021
BAM23    BAL   R5,LABRDN           LABEL RECORD CLAUSE                  19842021
BAM28    BAL   R5,WRTADV           WRITE A/B ADVANCING CLAUSE           19848021
BAM29    BAL   R5,RCDOVF           RECORD OVERFLOW CLAUSE               19854021
BAM30    BAL   R5,DEVTYP           CHECK DEVICE TYPE                    19860021
ENDACT   DC    A(*)                                                     19866021
* OPEN CLAUSE -ALL ACCESS METHODS                                       19872021
OPENCL   TM    PIBFL1,XXE0         ANY OPEN?                            19878021
         BNZ   OPEN00             YES.                                  19884021
         TM    PIBFL1,XX09          SEE IF USED IN I/O                  19890021
         BM    OPENERR             IF YES, ERROR                        19896021
         TM    PIBFL2,XX31                                              19902021
         BM    OPENERR             ERROR                                19908021
         TM    PIBFL3,XX29              WRITE, USE & READ BITS    44686 19914021
         BCR   ZERO,R5             OK                                   19920021
OPENERR  BAL   R4,AMEROR           ERROR                                19926021
         DC    X'1031'             MSG 49                               19932021
         BR    R5                  RETURN                               19938021
OPEN00   SR    R3,R3                                                    19944021
         IC    R3,PIBFL1           GET OPEN CLAUSE BITS IN REG.3 FO     19950021
         SRL   R3,DX4                 INDEX TO OPEN TABLE               19956021
         N     R3,CON14            AND OUT ALL OTHER BITS               19962021
         IC    R9,DX20(R8)                                              19968021
         LA    R3,DX0(R9,R3)                                            19974021
         LA    R9,OPENTB(R3)                                            19980021
         CLI   DX1(R9),XX01                                             19986021
         BNE   OPEN01              TEST OPEN CLAUSE                     19992021
         BAL   R4,AMEROR           ERROR                                19998021
         DC    X'0001'                                                  20004021
         B     OPEN01              TEST OPEN CLAUSE                     20010021
OPEN01   TM    FDACMT,XXF0         QSAM ?                               20016021
         BZ    OPENQS             YES                                   20022021
         TM    ICTFL1,ICTDA+ICTUT DA OR UT?                             20028021
         BNZ   *+10               YES, OK.                              20034021
         BAL   R4,AMEROR          NO, ERROR.                            20040021
         DC    X'0003'            MSG NO 3: DEVICE MUST BE DA           20046021
         TM    FDACMT,XX20         BISAM?                               20052021
         BO    OPENBI             YES                                   20058021
         TM    FDACMT,XX10         QISAM?                               20064021
         BO    OPENQI              YES                                  20070021
         BR    R5                  NO. RETURN                           20076021
* OPEN CLAUSE -QSAM ONLY                                                20082021
OPENQS   TM    PIBFL1,PIBOIO       IS OPEN I-O SPEC'D                   20088021
         BCR   NOTONE,R5           NO, RETURN                           20094021
         TM    ICTFL1,ICTDA+ICTUT YES, DA                               20100021
         BCR   NOTZER,R5           YES                                  20106021
         BAL   R4,AMEROR           NO. ERROR                            20112021
         DC    X'0002'             2                                    20118021
         BCR   UNCOND,R5           RETURN                               20124021
* OPEN CLAUSE -BISAM ONLY                                               20130021
OPENBI   TM    PIBFL1,PIBOIO                                            20136021
         BCR   NOTONE,R5           NO                                   20142021
         MVI   DCB+NX53,XX0E       YES. SET DCBMACRFB FIELD FOR I-O     20148021
         TM    PIBFL2,PIBFRE      FREE?                                 20154021
         BZ    *+8                NO.                                   20160021
         OI    FDACMT,XX01         YES.                                 20166021
       BR    R5                   RETURN.                               20172021
* OPEN CLAUSE -QISAM ONLY                                               20178021
OPENQI   L     R3,DCBADD                                                20184021
         S     R3,CON23           DCB-23                                20190021
         ST    R3,LITBUF          TARGET ADDRESS                        20196021
         MVI   LITBUF,XX2C                                              20202021
         LA    R3,DX16             INIT1+16                             20208021
         ST    R3,LITBUF+NX4       RELATIVE ADDRESS                     20214021
         MVI   LITBUF+NX4,XX03     AL3                                  20220021
         L     R1,COSADR                                                20226021
         LA    R2,LITBUF                                                20232021
         LA    R3,DX8                                                   20238021
         BALR  R0,R1               BR TO COMMON                         20244021
         DC    X'14'                                                    20250021
         TM    PIBFL3,PIBSRT      START?                                20256021
         BZ    *+8                NO.                                   20262021
         OI    FDACMT,XX08         YES.                                 20268021
         TM    ICTFL4,ICTNOM            NOMINAL KEY SPECD         41077 20274021
         BZ    OPENQ1                     NO, RETURN              41077 20280021
         OI    FDACMT,XX04              NOMKEY IN DICT, QISAM     41077 20286021
OPENQ1   EQU   *                                                  41077 20292021
         BR    R5                 RETURN                                20298021
* RECORDING MODE CLAUSE -ALL ACCESS METHODS                             20304021
RECMCL   SR    R9,R9                                                    20310021
         SR    R3,R3                                                    20316021
         IC    R3,BUFCAL+NX10      GET RECORDING MODE BITS IN R3.       20322021
       N     R3,CON15             MASK WITH X'0F'                       20328021
         IC    R9,DX21(R8)          GET DISP IN RECORD MODE TABLE FO    20334021
         LA    R9,DX0(R3,R9)        GET DISP OF ENTRY IN TABLE          20340021
         LA    R9,MODETB(R9)       ADD TO ADDRESS OF TABLE              20346021
         CLI   DX0(R9),XXFF        RECORDING MODE LEGAL FOR ACCESS      20352021
         BCR   NOTEQ,R5            YES                                  20358021
       BAL   R4,AMEROR            ERROR                                 20364021
         DC    X'1004'             RECORDING MODE CLAUSE IGNORED        20370021
         NI    BUFCAL+NX10,XXF0    SET OFF THE MODE BIT                 20376021
         BR    R5                  RETURN                               20382021
* RESERVE CLAUSE - ALL ACCESS METHODS                                   20388021
RESVCL   SR    R3,R3                                                    20394021
         TM    ICTFL1,ICTALA      RES. ALT AREA SPECIFIED?              20400021
         BCR   NOTONE,R5          NO.                                   20406021
         TM    DX26(R8),XX80        YES, IS THIS LEGAL FOR THIS METH    20412021
         BC    NOTONE,RESVC2       NO, ERROR, BRANCH                    20418021
         IC    R3,BUFCAL           YES, GET NUMBER OF AREAS             20424021
         LA    R3,DX1(R3,R0)       ADD 1                                20430021
         STC   R3,DCB+NX20          STORE NUMER OF AREAS IN BUFNO OF    20436021
         STC   R3,BUFCAL           AN DIN BUFFER CALC. AREA (BUFCAL     20442021
         BCR   UNCOND,R5           RETURN                               20448021
RESVC2   MVI   BUFCAL,XX00          SET RESERVE= 0                      20454021
         BAL   R4,AMEROR           CALL ERROR                           20460021
         DC    X'000F'            MSG 15 RESERVE ALT AREA               20466021
         BCR   UNCOND,R5           RETURN                               20472021
* SAME AREA CLAUSE -ALL ACCESS METHODS                                  20478021
SAMACL   XC    SAMEAR(LX12),SAMEAR  CLEAR AREA                          20484021
         XC    SMRCDAR(LX10),SMRCDAR CLEAR AREA                         20490021
         MVI   DCB+NX23,XX01       A(BUFCB)=1 AT THIS POINT             20496021
         TM    ICTFL2,ICTSMA      SAME AREA?                            20502021
         BZ    SAMACL1            NO.                                   20508021
         OI    BUFCAL+NX11,XX20    YES.                                 20514021
         OI    FDVCNT,XX04                                              20520021
SAMACL1  TM    ICTFL2,ICTSRS                                            20526021
         BZ    SAMACL2            NO.                                   20532021
         OI    BUFCAL+NX11,XX10    YES.                                 20538021
         OI    FDVCNT,XX08                                              20544021
SAMACL2  ST    R15,TSAVER                                               20550021
         L     R15,ASAMRN          CALL SAMRTN TO SET UP SAMEAR WKA     20556021
         BALR  R14,R15             BR TO SAMRTN                         20562021
         L     R15,TSAVER                                               20568021
         BCR   UNCOND,R5           RETURN                               20574021
* APPLY WRITE ONLY CLAUSE- ALL ACCESS METHODS                           20580021
WRTOCL   TM    ICTFL4,ICTWRT      WRITE-ONLY?                           20586021
         BCR   NOTONE,R5           NO, RETURN                           20592021
         TM    AMCODE(R8),XXF0     QSAM?                                20598021
         BNZ   WRTOCA              NO                                   20604021
         TM    PIBFL1,PIBOOT+PIBOIO  YES, IS FILE OPEN AS I-O OR OU     20610021
         BC    ZERO,WRTOCB         NO, ERROR                            20616021
         OI    BUFCAL+NX11,XX80    W-O BIT ON                           20622021
         BCR   UNCOND,R5           RETURN                               20628021
WRTOCA   BAL   R4,AMEROR           ERROR                                20634021
         DC    X'2008'             8                                    20640021
         BCR   UNCOND,R5           RETURN                               20646021
WRTOCB   BAL   R4,AMEROR           ERROR                                20652021
         DC    X'106E'             110                                  20658021
         BCR   UNCOND,R5           RETURN                               20664021
* APPLY CORE-INDEX                                                      20670021
COREIDX  TM    ICTUN1,XX08         CORE-INDEX?                          20676021
         BCR   ZERO,R5            NO.                                   20682021
         TM    FDACMT,XX20         YES. BISAM?                          20688021
         BZ    COREERR            YES. ERROR.                           20694021
         L     R3,DCBADD                                                20700021
         S     R3,CON23           R3=DCB-23                             20706021
         ST    R3,LITBUF          TARGET ADDRESS.                       20712021
         MVI   LITBUF,XX2C         ADDRESS CONSTANT CODE.               20718021
         LA    R3,DX116            A(CORE-IDX EXIT RTN IN INIT1)        20724021
         ST    R3,LITBUF+NX4       RELATIVE ADDRESS                     20730021
         MVI   LITBUF+NX4,XX03     AL3                                  20736021
         L     R1,COSADR                                                20742021
         LA    R2,LITBUF                                                20748021
         LA    R3,DX8              PUT OUT DCB EXIT ADR. FOR            20754021
         BALR  R0,R1              CORE-INDEX.                           20760021
         DC    X'14'                                                    20766021
         OI    FDACMT,XX02         CORE-INDEX BIT IN FD ATTRIB.         20772021
         BR    R5                 RETURN.                               20778021
COREERR  BAL   R4,AMEROR          APPLY CORE-IDX ILLEGAL FOR THIS       20784021
         DC    X'101B'             ACCESS METHOD                        20790021
         BR    R5                 RETURN.                               20796021
* LABEL TYPE-DEVICE TYPE COMPATIBILITY.                                 20802021
LABEL0   NI    LBLSW,XX00          THIS SW SET ON IN LABLBD.            20808021
         TM    BUFCAL+NX1,XX06                                          20814021
         BO    LABEL2             DATA-NAME OPTION                      20820021
         BZ    LABEL4             CLAUSE NOT SPECIFIED. ERROR.          20826021
         TM    BUFCAL+NX1,XX04                                          20832021
         BO    LABEL1             OMITTED OPTION                        20838021
         TM    ICTFL1,ICTUR       STANDARD. DEVICE UR?                  20844021
         BO    LABEL3             YES. ERROR                            20850021
         BR    R5                 NO - OK. NO PROCESSING NEEDED.        20856021
LABEL1   TM    ICTFL1,ICTDA       DEVICE DA                             20862021
         BNZ   LABEL3             YES, ERROR                            20868021
         BR    R5                 NO - OK. NO PROCESSING NEEDED.        20874021
LABEL2   TM    ICTFL1,ICTUR       UR?     OR                            20880021
         BO    LABEL3             YES. ERROR.                           20886021
*        TM    FDACMT,REL-ISAM  * DATA-NAME OPTION ILLEGAL              20892021
*        BX    ----             * FOR THIS ACCESS.  WHY?                20898021
         OI    DX27(R8),XX08       TURN ON DN OK BIT IN CLSMSK          20904021
         BR    R5                 RETURN. MORE PROC DONE IN LABRDN      20910021
LABEL3   BAL   R4,AMEROR           BR TO ERROR RTN                      20916021
         DC    X'0009'             9                                    20922021
         BCR   UNCOND,R5           RETURN                               20928021
LABEL4   BAL   R4,AMEROR           BR TO ERROR RTN                      20934021
         DC    X'0085'             133                                  20940021
         BCR   UNCOND,R5           RETURN                               20946021
* RERUN CLAUSE                                                          20952021
RRUNCL   TM    ICTFL2,ICTCKP      RERUN CLAUSE SPECIFIED?               20958021
         BCR   NOTONE,R5          NO.                                   20964021
         L     R8,COSADR                                                20970021
         ST    R15,RSAVEA+NX60     YES.                                 20976021
         LH    R1,CKPCTR                                                20982021
         LA    R1,DX1(R1)                                               20988021
         STH   R1,CKPCTR                                                20994021
         TM    PRMSW,XX10          RUNTBL PRIMED?                       21000021
         BO    RRUNCL1            YES.                                  21006021
         LA    R1,RUNPAR          NO, PRIME IT.                         21012021
         L     R15,BPRIME                                               21018021
         BALR  R14,R15             BR TO PRIME RUNTBL                   21024021
         OI    PRMSW,XX10                                               21030021
RRUNCL1  L     R1,RUNPAR                                                21036021
         L     R15,BINSRT                                               21042021
         BALR  R14,R15             INSERT ENTRY INTO RUNTBL             21048021
         L     R15,RSAVEA+NX60                                          21054021
         MVC   DX1(LX1,R2),CI+NX35  RERUN DCB NO IN RUNTBL              21060021
         MVI   DX0(R2),XX00                                             21066021
         MVC   FULLWD(2),ICTCPT                                         21072021
         LH    R1,FULLWD                                                21078021
         L     R3,ACHKPT                                                21084021
         L     R3,DX0(R3)                                               21090021
         L     R3,DX0(R3)                                               21096021
         N     R3,MK0932          A(CHK PT TBL)                         21102021
         AR    R1,R3              A(ENTRY)                              21108021
         MVC   DX4(4,R2),DX12(R1)                                       21114021
         MVC   DX2(2,R2),DX10(R1)                                       21120021
         L     R8,BUFCAL+NX20                                           21126021
         BR    R5                  RETURN                               21132021
* TRACK LIMIT CLAUSE-ALL ACCESS METHOD                                  21138021
TRKLIM   CLC   ICTTLM(LX2),ZEROS   TRACK LIMIT SPECIFIED?               21144021
         BCR   EQ,R5              NO - RETURN.                          21150021
         TM    CLSMSK(R8),XX20     IS CLAUSE LEGAL FOR THIS ACCESS      21156021
         BZ    TRKLIM1            NO - ERROR.                           21162021
         TM    PIBFL1,PIBOOT      YES. OPENED OUTPUT?                   21168021
         BZ    TRKLIM2            NO - ERROR.(WARNING)                  21174021
         OI    FDACMT,XX02         YES - SET TRACK LIMIT BIT.           21180021
         MVC   DCB+NX98(LX2),ICTTLM MOVE TRACK LIMIT NO INTO DCB.       21186021
         BR    R5                 RETURN.                               21192021
TRKLIM1  BAL   R4,AMEROR           TRK LIMIT NOT LEGAL FOR ACCESS       21198021
         DC    X'200D'            13                                    21204021
         BR    R5                  RETURN                               21210021
TRKLIM2  BAL   R4,AMEROR          NOT OPENED OUTPUT                     21216021
         DC    X'000E'            14                                    21222021
         BR    R5                  RETURN                               21228021
* BLOCK CONTAINS CLAUSE- ALL ACCESS METHODS                             21234021
BLKCCL   TM    BUFCAL+NX1,XX18      IS BLOCK CONTAINS CLAUSE GIVEN      21240021
         BCR   ZERO,R5             NO, RETURN                           21246021
         TM    DX27(R8),XX40        YES, IS IT LEGAL FOR THIS ACC. M    21252021
         BCR   ONES,R5            YES                                   21258021
BLKCC1   NI    BUFCAL+NX1,XXE7      DELETE CLAUSE AND                   21264021
         XC    BUFCAL+NX2(LX2),BUFCAL+NX2 INTEGER                       21270021
*        BAL   R4,AMEROR          BLOCK CONTAINS CLAUSE TREATED         21276021
*        DC    X'0013'             AS COMMENTS FOR THIS ACCESS          21282021
         BCR   UNCOND,R5           RETURN                               21288021
* WRITE AFTER ADVANCING STATEMENT- ALL ACCESS METHODS                   21294021
WRTADV   TM    PIBFL2,PIBPOS      POSITIONING?                          21300021
         BZ    WRADV0             NO                                    21306021
         TM    FDACMT,XXF0               IS ACCESS QSAM           41077 21312021
         BNZ   WRTAD1                    NO, ERROR                41077 21318021
         OI    FDACMT,XX04         YES.                                 21324021
         OI    BUFCAL+NX10,XX10                                         21330021
         B     WRADV25             GO TEST WHETHER OPENED OUTPUT  54416 21336021
WRADV0   TM    PIBFL1,PIBWAA      A-A                                   21342021
         BZ    WRADV1             NO                                    21348021
         TM    FDACMT,XXF0               IS ACCESS QSAM           41077 21354021
         BNZ   WRTAD1                    NO, ERROR                41077 21360021
         OI    BUFCAL+NX10,XX80    YES.                                 21366021
         OI    FDACMT,XX01                                              21372021
WRADV1   TM    PIBFL2,PIBWBA       B-A?                                 21378021
         BZ    WRADV2             NO                                    21384021
         TM    FDACMT,XXF0               IS ACCESS QSAM           41077 21390021
         BNZ   WRTAD1                    NO, ERROR                41077 21396021
         NI    BUFCAL+NX10,XX7F    YES.                                 21402021
         OI    BUFCAL+NX10,XX40                                         21408021
         OI    FDACMT,XX08                                              21414021
WRADV2   TM    BUFCAL+NX10,XXC0    ANY ADVANCING OPTION?                21420021
         BZ    WRADV3             NO                                    21426021
WRADV25  TM    PIBFL1,PIBOOT       IS FILE OPENED OUTPUT?         54416 21432021
         BZ    WRTAD1             NO - ERROR                            21438021
WRADV3   BR    R5                  RETURN                               21444021
WRTAD1   BAL   R4,AMEROR           CALL ERROR RTN                       21450021
         DC    X'2019'             25                                   21456021
         NI    BUFCAL+NX10,XX2F                                         21462021
         NI    FDACMT,XXF2                                              21468021
         BCR   UNCOND,R5           RETURN                               21474021
RCDOVF   TM    ICTFL5,ICTROS      RECORD OVERFLOW?                      21480021
         BCR   ZERO,R5            NO - RETURN.                          21486021
         TM    FDACMT,XX30         ISAM?                                21492021
         BNZ   RCDOV1             YES - ERROR.                          21498021
         OI    BUFCAL+NX10,XX20                                         21504021
         BR    R5                 RETURN                                21510021
RCDOV1   BAL   R4,AMEROR           BR TO ERROR RTN                      21516021
         DC    X'0005'            RCD OVFL ILLEGAL FOR ISAM             21522021
         BR    R5                  RETURN                               21528021
* TRACK AREA CLAUSE- ALL ACCESS METHODS                                 21534021
TRKACL   SR    R9,R9                                                    21540021
         TM    ICTFL4,ICTTKA      TRACK AREA                            21546021
         BC    ZERO,TRKAC5         NO                                   21552021
         IC    R9,DX0(R7)           YES                                 21558021
         TM    AMCODE(R8),XX20     BISAM                                21564021
         BC    NOTONE,TRKAC2       NO, ERROR                            21570021
         TM    ICTFL4,XX80         INTEGER?                             21576021
         BC    NOTONE,TRKAC1       NO, IT IS DATA-NAME                  21582021
         LA    R9,DX1               YES, SET FIELD COUNT TO 1           21588021
         CLC   DX0(LX2,R7),CON32K+NX2 IS INTEGER GREATER THAN 32767     21594021
         BC    HI,TRKAC4           YES, ERROR                           21600021
TRKAC0   TM    DX1(R7),XX07         NO, CHECK FOR MULTIPLE OF 8         21606021
         BC    ZERO,TRKA01         IT IS A MULT. OF 8                   21612021
         BAL   R4,AMEROR           IT IS NOT A MULT. OF 8, ROUND DO     21618021
         DC    X'106D'             109-TO MULT. OF 8                    21624021
TRKA00   NI    DX1(R7),XXF8                                             21630021
TRKA01   MVC   DCB+NX70(LX2),DX0(R7) MOVE INTEGER TO SMSW OF DCB        21636021
         OI    FDACMT,XX04         SET TRACK AREA BIT ON IN CI.         21642021
         BC    UNCOND,TRKAC3       GET NEXT BUFFER                      21648021
TRKAC1   MVI   TRACK+NX10,XX00      CLEAR TRACK AREA SW                 21654021
         TM    PTBLSW,XX20          IS TRACK AREA DN TABLE PRIMED       21660021
         BC    ONES,TRKA1A         YES, BRANCH TO INSERT                21666021
         LA    R1,TPARAM           NO, PRIME TABLE                      21672021
         L     R15,BPRIME                                               21678021
         BALR  R14,R15             BR TO PRIME TABLE                    21684021
         OI    PTBLSW,XX20          TURN ON PRIMED SW                   21690021
TRKA1A   LA    R0,DX1(R9)           R0= LGN OF INSERT ENTRY             21696021
         L     R1,TPARAM           R1= A(TABLE'S TIB)                   21702021
         L     R15,BINSRT                                               21708021
         BALR  R14,R15             CALL TAMER FOR INSERT AREA           21714021
         L     R15,AACMET                                               21720021
         TM    TRACK+NX10,XX80                                          21726021
         BC    ONES,TRKA1B         BUILD TABLE                          21732021
         EX    R9,MOVTRK           MOVE DATA-NAME TO TABLE              21738021
         OI    TRACK+NX10,XX80                                          21744021
         L     R3,DCBADD                                                21750021
         LA    R3,DX64(R3)                                              21756021
         LR    R2,R3               R2= REL LOC OF MSWA IN DCB           21762021
         LA    R3,DX6(R3)           R3= REL LOC OF SMSW IN DCB          21768021
         STM   R2,R3,TRACK                                              21774021
         MVC   TRACK+NX8(LX2),CARDNO                                    21780021
         LA    R0,DX10                                                  21786021
         BC    UNCOND,TRKA1A+NX4   GET A(TIB)                           21792021
TRKA1B   MVC   DX0(LX10,R2),TRACK    MOVE TRACK-AREA INFO TO TABLE      21798021
         BC    UNCOND,TRKAC3       GET NEXT BUFFER                      21804021
TRKAC2   BAL   R4,AMEROR           ILLEGAL FOR THIS ACCESS METHOD       21810021
         DC    X'1014'             20                                   21816021
         TM    ICTFL4,XX80         INTEGER?                             21822021
         BC    NOTONE,TRKAC3       NO, IT IS 'DATA-NAME'                21828021
         LA    R9,DX1                                                   21834021
TRKAC3   LA    R7,DX1(R7,R9)        INCREMENT BUFFER TO NEXT FIELD      21840021
         BAL   R4,CHKFF            CHECK FOR END OF BUFFER              21846021
         BCR   UNCOND,R5           RETURN                               21852021
MOVTRK   MVC   DX0(LX0,R2),DX0(R7)                                      21858021
TRKAC4   BAL   R4,AMEROR           INTEGER > 32K OR                     21864021
       DC    X'00AF'                                                    21870021
         MVC   DX0(LX2,R7),CON32K+NX2 TRUNCATE INTEGER TO 32760         21876021
         BC    UNCOND,TRKA00       CONTINUE                             21882021
TRKAC5   TM    FDACMT,XX20         IS ACCESS METHOD BISAM?              21888021
         BC    NOTONE,TRKAC3       NO,                                  21894021
         MVI   DCB+NX67,XX01        YES, SET A(MSWA) FIELD OF DCB TO    21900021
       BC    UNCOND,TRKAC3         INCREMENT BUFFER                     21906021
* INTERNAL ROUTINE -BSAM ONLY                                           21912021
BSAMKY TM    AMCODE(R8),BSAMBDAM        BSAM OR BDAM                    21918021
         BCR   ZERO,R5             NO, RETURN                           21924021
         TM    BUFCAL+NX1,XX18      BLOCK CONTAINS CLAUSE ACCEPTED      21930021
         BZ    BSAMKY0             NO                                   21936021
         TM    BUFCAL+NX1,XX08      BLOCK CONTAINS RECORD               21942021
         BO    BSAMKYA             YES, ERROR                           21948021
         TM    BUFCAL+NX10,XX0E     YES, RECORDING MODE SPECIFIED       21954021
         BZ    BSAMKY0             ERROR IF OTHER THAN S                21960021
BSAMKYA  DS    0H                                                       21966021
         NI    BUFCAL+NX1,XXE7      DELETE CLAUSE AND                   21972021
         XC    BUFCAL+NX2(LX2),BUFCAL+NX2 INTEGER                       21978021
         BAL   R4,AMEROR           BLOCK CONTAINS CLAUSE TREATED        21984021
         DC    X'0013'             AS COMMENTS FOR THIS ACCESS          21990021
BSAMKY0  CLI   AMCODE(R8),XX84      D-BDAM-D                            21996021
         BNE   BSAMK00             NO                                   22002021
         OI    BUFCAL+NX24,XX20    YES, SET 'W' CODE IN BUFCAL          22008021
         B     BSAMK0B             PRIME BSAM TABLE                     22014021
BSAMK00  TM    AMCODE(R8),XX8C                                          22020021
         BO    BSAMK0A            YES                                   22026021
         TM    FDACMT,XX40         NO. BSAM?                            22032021
         BCR   ZERO,R5            NO - RETURN.                          22038021
         TM    ICTFL4,ICTACT+ICTNOM   KEY(ACT,NOM) SPECIFIED?           22044021
         BCR   ZERO,R5            NO - RETURN.                          22050021
         OI    FDACMT,XX08         SET KEY SPECIFIED BIT IN CI.         22056021
         TM    FDACMT,XX04         DIRECT BSAM?                         22062021
         BCR   ZERO,R5            NO-RETURN.                            22068021
BSAMK0A  OI    BUFCAL+NX24,XX10    D-BDAM-D, OR D-BSAM WITH KEY.        22074021
BSAMK0B  TM    PTBLSW,XX08         BSAM TABLE PRIMED?                   22080021
         BO    BSAMK1             YES, BRANCH.                          22086021
         LA    R1,BSMPAR          NO, PRIME TABLE                       22092021
         ST    R15,TSAVER                                               22098021
         L     R15,BPRIME                                               22104021
         BALR  R14,R15             BR TO PRIME TABLE RTN                22110021
         L     R15,TSAVER                                               22116021
         OI    PTBLSW,XX08         SET PRIME SW ON FOR BSAMTBL          22122021
BSAMK1   L     R1,BSMPAR                                                22128021
         ST    R15,TSAVER                                               22134021
         L     R15,BINSRT         CALL INSERT OF TAMER                  22140021
         BALR  R14,R15             INSERT ENTRY INTO TABLE              22146021
         L     R15,TSAVER                                               22152021
         MVC   DX3(LX3,R2),DECBAD+NX1 MOVE REL LOC OF DECB TO TABLE.    22158021
         ST    R3,BSAMPT          SAVE DISPLACEMENT IN BSAMTBL.         22164021
         MVI   DX9(R2),XX01        INDICATE NO SAMETBL OR               22170021
         MVI   DX13(R2),XX01       SAME RECORD TABLE AT THIS POINT      22176021
         MVI   DX17(R2),XX00                                            22182021
         MVC   SAMEAR+NX11(NX1),ICTTRK TRACK CAPACITY                   22188021
         CLI   AMCODE(R8),XX8C     BDAM-D?                              22194021
         BE    BSAMK2              YES                                  22200021
         OI    DX17(R2),XX80        NO                                  22206021
         BR    R5                  RETURN                               22212021
BSAMK2   TM    BUFCAL+NX10,XX01     S-MODE                              22218021
         BCR   NOTONE,R5           NO, RETURN                           22224021
         OI    DX17(R2),XX40        YES, SET BIT ON                     22230021
         MVC   SAMEAR+NX11(NX1),ICTTRK TRACK CAPACITY                   22236021
         BR    R5                  RETURN                               22242021
* SYMBOLIC, ACTUAL, AND RECORD KEYS CLAUSE- ALL ACCESS METHODS          22248021
KEYSCL   CLI   AMCODE(R8),XX44     BSAM-D?                              22254021
         BNE   KEYSQI             NO.                                   22260021
KEYSBS   NI    CLSMSK+NX1(R8),XXFD YES, SET ACT-KEY REQUIRED BIT OFF    22266021
         TM    PIBFL1,PIBOOT      OPENED OUTPUT                         22272021
         BZ    *+8                NO.                                   22278021
         OI    CLSMSK+NX1(R8),XX02 YES, SET ACT-KEY REQUIRED BIT ON.    22284021
KEYSQI   CLI   AMCODE(R8),XX20     OISAM?                               22290021
         BNE   KEYSC0             NO.                                   22296021
         NI    CLSMSK+NX1(R8),XXFB YES, SET NOM-KEY REQUIRED BIT OFF    22302021
         TM    PIBFL3,PIBSRT      START?                                22308021
         BZ    *+8                NO.                                   22314021
         OI    CLSMSK+NX1(R8),XX04 YES.                                 22320021
KEYSC0   LA    R3,DX3              SET R3 TO PROCESS NOM-KEY.           22326021
KEYSC1   SR    R9,R9                                                    22332021
         IC    R9,KEYMSK(R3)       GET APPROPRIATE KEY MASK             22338021
*                                  * REGISTER 3  * KEY          *MA     22344021
*                                  ********************************     22350021
*                                  *             *              *       22356021
*                                 *      3      * NOMINAL * X'10'       22362021
*                                  *      2      * ACTUAL       * X     22368021
*                                  *      1      * RECORD       * X     22374021
*                                  *             *              *       22380021
*                                  ********************************     22386021
         EX    R9,TEST01           IS KEY CLAUSE GIVEN                  22392021
         BC    NOTONE,KEYSC3       NO, BRANCH                           22398021
         EX    R9,TEST02           YES, IS IT LEGAL FOR THIS ACCESS     22404021
         BC    NOTONE,KEYSCE       NO, ERROR                     ME     22410021
         L     R9,DX28(R8)          YES, GET A(KEYRTN) FOR THIS TYPE    22416021
         C     R3,ONE                                                   22422021
         BNE   *+8                 BYPASS INCREMENTING                  22428021
         LA    R9,DX4(R9)                                               22434021
         ST    R15,RSAVEA+NX60                                          22440021
         L     R15,AKEYRN                                               22446021
         BALR  R14,R9              CALL KEY ROUTINE                     22452021
         L     R15,RSAVEA+NX60                                          22458021
KEYSC2   BCT   R3,KEYSC1           DECREMENT REG3 FOR NEXT KEY, IF      22464021
*                                    ALL KEYS HAVE BEEN PROCESSED       22470021
         BCR   UNCOND,R5           RETURN                               22476021
KEYSC3   SRL   R9,DX2              1=RCD,2=ACT,4=NOM                    22482021
         EX    R9,TEST03          IS THIS KEY REQUIRED?                 22488021
         BC    NOTONE,KEYSC4       NO, BRANCH                           22494021
         BAL   R4,AMEROR           YES, ERROR - REQUIRED CLAUSE         22500021
         DC    X'2017'             23                                   22506021
         BAL   R4,KEYSCF           PUT OUT MSGPAR ( KEY TYPE )          22512021
KEYSC4   LA    R7,DX1(R7)           INCREMENT BUFFER PTR. TO NEXT FI    22518021
         BAL   R4,CHKFF             AND CHECK FOR END OF BUFFER         22524021
         BC    UNCOND,KEYSC2       PROCESS NEXT KEY                     22530021
KEYSCE   BAL   R4,AMEROR           ILLEGAL KEY CLAUSE                   22536021
         DC    X'2018'             24                                   22542021
         BAL   R4,KEYSCF           PUT OUT MSGPAR ( KEY TYPE )          22548021
         LA    R7,DX2(R7)           SET R7 TO INDIVIDUAL NAME COUNT     22554021
         BAL   R4,LOOKAH           CALL LOOKAH TO PUT BUFFER PTR AT     22560021
         BC    UNCOND,KEYSC2        NEXT FIELD.                         22566021
KEYSCF   LA    R1,KYCODE-NX1(R3)    MOVE KEY CODE                       22572021
         MVC   MSGPRM+NX3(LX1),DX0(R1) TO MESSAGE PARAMETER             22578021
         L     R1,COSADR           PUT OUT MESSAGE PARAMETER            22584021
         LA    R2,MSGPRM                                                22590021
         BALR  R0,R1               BR TO COMMON                         22596021
         DC    X'24'               PUT ON FILE 4                        22602021
         BCR   UNCOND,R4           RETURN TO IN-LINE CODE               22608021
* APPLY REORG CRITERIA CLAUSE CHECKING                                  22614021
REORG00  TM    ICTUN1,XX04         REORG BIT ON?                        22620021
         BZ    REORG99            NO.                                   22626021
         CLI   AMCODE(R8),XX20     YES. BISAM?                          22632021
         BE    REORG01            YES, OK.                              22638021
         BAL   R4,AMEROR           NO. ERROR                            22644021
         DC    X'0007'            REORG OPT ILLEGAL FOR THIS ACCESS     22650021
         MVC   FULLWD(LX2),DX0(R7)  BISAM FILE.                         22656021
         LH    R9,FULLWD                                                22662021
         LA    R7,DX2(R7,R9)                                            22668021
         BAL   R4,CHKFF          CHECK FOR EOB                          22674021
         BR    R5                  RETURN                               22680021
REORG01  L     R15,AREORGBD                                             22686021
         BALR  R14,R15            CALL REORG TBL BUILD ROUTINE.         22692021
         L     R15,AACMET                                               22698021
         OI    BUFCAL+NX11,XX08                                         22704021
REORG99  LA    R7,DX1(R7)          R7 POINTS TO THE NEXT FIELD.         22710021
         BAL   R4,CHKFF          CHECK FOR EOB                          22716021
         BR    R5                  RETURN                               22722021
* TOTALING AREA IS DATANAME OPTION CHECKING                             22728021
TOTAR00  TM    ICTFL6,XX80         TOTALING AREA BIT ON?                22734021
         BZ    TOTAR98            NO.                                   22740021
         TM    FDACMT,XXF0     *** QSAM?                                22746021
         BNZ   TOTARER        *** NO - ERROR                            22752021
         OI    BUFOPT2,TTLMSK     TOTALING AREA?                        22758021
         ST    R15,RSAVEA+NX60                                          22764021
         L     R15,ATTLBD         CALL TOT-AR TBL BUILD RTN.            22770021
         BALR  R14,R15             BR TO ROUTINE                        22776021
         L     R15,RSAVEA+NX60                                          22782021
         B     TOTAR99             BR TO RETURN                         22788021
*                                                                       22794021
TOTARER  BAL   R4,AMEROR      ***                                       22800021
         DC    X'0026'            TOTALING AREA CLAUSE ILLEGAL          22806021
         MVC   FULLWD(LX2),DX0(R7) ***     FOR THIS ACCESS METHOD.      22812021
         LH    R9,FULLWD      ***                                       22818021
         LA    R7,DX2(R7,R9)   *** R7 POINTS TO NEXT FIELD.             22824021
         BAL   R4,CHKFF          CHECK FOR EOB                          22830021
         BR    R5             ***                                       22836021
TOTAR98  LA    R7,DX1(R7)          NO TOTALING AREA. R7=A(NXT FLD)      22842021
         BAL   R4,CHKFF          CHECK FOR EOB                          22848021
TOTAR99  BR    R5                 RETURN                                22854021
LABRDN   TM    BUFCAL+NX1,XX06      'DATA-NAME' OPTION OF LABEL RECO    22860021
         BC    ONES,LABRD1         YES                                  22866021
         BCR   UNCOND,R5           NO, RETURN                           22872021
LABRD1   TM    DX27(R8),XX08        IS IT LEGAL                         22878021
         BC    NOTONE,LABRD2       NO                                   22884021
         ST    R15,RSAVEA+NX60      YES                                 22890021
         OI    FDVCNT,XX02         SET LBL BIT FOR PH5 OPEN CODE        22896021
         L     R15,ALABRN                                               22902021
         BALR  R14,R15             CALL LABEL BUILD ROUTINE             22908021
         L     R15,RSAVEA+NX60                                          22914021
         NI    DX27(R8),XXF7        TURN OFF LABEL RECORDS BIT IN QS    22920021
*                                                      CLAUSE MASK      22926021
         BCR   UNCOND,R5           RETURN                               22932021
LABRD2   BAL   R4,LOOKAH           SCAN TO END OF LABEL NAMES           22938021
         BCTR  R7,R5               RETURN                               22944021
BDAMCL   TM    AMCODE(R8),XX80     BDAM                                 22950021
         BCR   ZERO,R5            -O.                                   22956021
         OC    DCB+NX52(LX1),OPTCODE(R8)                                22962021
         SR    R9,R9                                                    22968021
         IC    R9,DX19(R8)          PUT BLOCK REFERENCE PTR             22974021
         A     R9,DECBAD            IN DECB                             22980021
         ST    R9,FULLWD           RELATIVE ADDRESSING= DECB+29         22986021
         MVC   DECB+NX24(LX4),FULLWD DIRECT MMADDRESSING= DECB+30       22992021
         BCR   UNCOND,R5            SCHEME FOR BDAM                     22998021
TEST01   TM    ICTFL4,XX00                                              23004021
TEST02   TM    CLSMSK(R8),XX00     KEY CAN BE SPECIFIED.                23010021
TEST03   TM    CLSMSK+NX1(R8),XX00 KEY REQUIRED.                        23016021
AMEROR   LH    R0,DX0(R4)           PUT ERROR PARAMETER IN REG 0        23022021
         ST    R15,TSAVER                                               23028021
         L     R15,AERRTN                                               23034021
         BALR  R14,R15             CALL ERROR ROUTINE                   23040021
         L     R15,TSAVER                                               23046021
         LA    R4,DX2(R4)                                               23052021
         BCR   UNCOND,R4           RETURN                               23058021
*      CHECK FOR UNIT RECORD DEVICE TYPE                                23064021
*      SET BIT ON IN BUFCAL IF SO                                       23070021
*      MODE00 WILL TEST BIT IF RECORDING MODE IS S                      23076021
DEVTYP   TM    ICTFL1,ICTUR        UNIT RECORD                          23082021
         BCR   ZERO,R5             NO, RETURN                           23088021
         OI    BUFC24,BUFUR        YES, SET BIT ON                      23094021
         BR    R5                  RETURN                               23100021
LOOKAH   SR    R9,R9                                                    23106021
         IC    R9,DX0(R7)           GET FIELD COUNT                     23112021
         LA    R7,DX1(R9,R7)        INCREMENT REG 7 TO NEXT FIELD       23118021
         ST    R4,TSAVER                                                23124021
         BAL   R4,CHKFF            CALL END OF BUFFER CHECK             23130021
         L     R4,TSAVER                                                23136021
         CLI   DX0(R7),XX00         IS THIS THE END OF THE FIELD        23142021
         BC    NOTEQ,LOOKAH+NX2     NO                                  23148021
         LA    R7,DX1(R7)           YES, INCREMENT PTR TO NEXT FIELD    23154021
         BCR   UNCOND,R4           RETURN                               23160021
CHKFF    CLI   DX0(R7),XXFF         IS IT END OF BUFFER                 23166021
         BCR   NOTEQ,R4            NO, RETURN                           23172021
         L     R1,COSADR           YES, GET ANOTHER RECORD              23178021
         BALR  R0,R1               BR TO COMMON                         23184021
         DC    X'03'                                                    23190021
         LR    R7,R0               PUT BUFFER ADDRESS IN REG 7          23196021
         BCR   UNCOND,R4           RETURN                               23202021
SUBPUT   L     R1,COSADR                                                23208021
         LA    R2,DECBDF                                                23214021
*                                                                       23220021
OPENTB   DS    0CL80                                                    23226021
         DC    X'00010000000000000000000000000000'                      23232021
         DC    X'00010000000000000000000000000000'                      23238021
         DC    X'00010000000100000000000000010001'                      23244021
         DC    X'00010001000000010000000100000001'                      23250021
         DC    X'00010000000100010000000000010001'                      23256021
         DC    X'00010000000000000000000000000000'                      23262021
*                                                                       23268021
MODETB   DS    0CL32                                                    23274021
         DC    X'041410FF0CFFFFFF08'    QSAM                            23280021
         DC    X'04FFFFFFFFFFFFFF08'                                    23286021
         DC    X'04FFFFFFFFFFFFFF08'    RELATIVE                        23292021
         DC    X'041410FF0CFFFFFF08'    DIRECT                          23298021
         DC    X'200000000100040001'                                    23304021
         DC    X'14'                                                    23310021
ABSUBR   DC    A(BSUBRN)                  ADDR OF BSUBRN                23316021
         EJECT                                                          23322021
*=2    SAME AREA CLAUSE ROUTINE- SAMRTN                                 23328021
*TITLE 'SAMRTN' -SAME AREA CLAUSE ROUTINE                               23334021
*STATUS                                                                 23340021
*FUNCTION/OPERATION- THIS ROUTINE IS CALLED FOR AN FD UNDER A SAME      23346021
*   CLAUSE. AN ENTRY TO THE SAME AREA TABLE-SAMTBL- IS PARTIALLY BU     23352021
*   FOR  BASIC  ACCESS METHODS THE RELATIVE LOCATION OF THE A(BUFFE     23358021
*   FIELD IN THE DECB, THE NUMBER OF CYCLES, AND THE UNIQUE 'SAME A     23364021
*   NUMBER IS PUT IN THE ENTRY. FOR QUEUED ACCESS METHODS, THE RELA     23370021
*   LOCATION OF THE A(BUFCB) FIELD IN THE DCB, THE NUMBER OF BUFFER     23376021
*   AND THE UNIQUE 'SAME AREA' NUMBER IS PUT IN THE ENTRY. AT A LAT     23382021
*   TIME BLOCK SIZE WILL BE ADDED TO THE ENTRY AND THE ENTRY WILL B     23388021
*   PUT IN THE SAMTBL. WHEN ALL FD'S ARE PROCESSED, THIS TABLE WILL     23394021
*   SCANNED FOR ALL ENTRIES WITH THE SAME UNIQUE 'SAME AREA' NUMBER     23400021
*   AND THE LARGEST BUFFER POOL WILL CONSTITUTE THE SPACE REQUIRED      23406021
*   FOR ALL THESE ENTRIES. ADCONS WILL BE PUT OUT FOR A(BUFFER) OR      23412021
*   A(BUFCB).                                                           23418021
*ENTRY POINT   -SAMRTN-                                                 23424021
*              L    R15,A(SAMRTN)                                       23430021
*              BALR R14,R15                                             23436021
*INPUT-                                                                 23442021
*OUTPUT-                                                                23448021
*EXTERNAL ROUTINES - NONE                                               23454021
*EXITS-  ONE NORMAL EXIT AT -UNIQUE-    NO CODES PASSED                 23460021
*TABLES/WORKAREAS                                                       23466021
*   SAMEAR-  WORK AREA FOR SAMTBL ENTRY                                 23472021
*   DCBADD-  REL. LOC. OF DCB                                           23478021
*   DECBAD-  REL. LOC. OF DECB                                          23484021
*   NUMCYC-  NUMBER OF CYCLES                                           23490021
*ATTRIBUTES                                                             23496021
*NOTES                                                                  23502021
IKF204   CSECT                                                          23508021
       USING *,R15                                                      23514021
SAMRTN   TM    DX8(R8),XXE0                 IS IT BISAM           42040 23520021
         BZ    QUEUED             NO.                                   23526021
BASIC    TM    ICTFL2,ICTSMA       S - A                                23532021
         BZ    SAMRCD0             NO                                   23538021
         MVC   SAMEAR+NX4(LX2),ONE+NX2 NO, NO OF BUFF FIELD GETS ONE.   23544021
         TM    BUFCAL+NX10,XX01     S MODE                              23550021
         BZ    BASIC2              NO                                   23556021
         MVC   SAMEAR+NX1(LX3),DCBADD+NX1 YES, SAVE DCB ADD             23562021
         B     UNIQUE              BR TO NORMAL EXIT                    23568021
BASIC2   MVC   SAMEAR+NX1(LX3),DECBAD+NX1 SAVE DECB ADD                 23574021
         B     UNIQUE              BR TO NORMAL EXIT                    23580021
QUEUED   TM    ICTFL2,ICTSRS                                            23586021
         BZ    *+8                NO.                                   23592021
         OI    SAMEAR+NX10,XX10    YES, INDICATE IT IN TABLE ENTRY.     23598021
         CLI   BUFCAL,XX00         ALT. AREA?                           23604021
         BE    QUEUED1            NO.                                   23610021
         IC    R3,BUFCAL          YES.                                  23616021
         STC   R3,SAMEAR+NX5                                            23622021
         B     QUEUED2             CONTINUE PROCESSING                  23628021
QUEUED1  MVC   SAMEAR+NX4(LX2),TWO+NX2                                  23634021
QUEUED2  MVC   SAMEAR+NX1(LX3),DCBADD+NX1                               23640021
         MVC   SMRCDAR+NX1(LX3),DCBADD+NX1                              23646021
UNIQUE   MVC   SAMEAR(LX1),ICTSAM  S-A NO.                              23652021
         B     SAMRCD0             CONTINUE                             23658021
SAMRCD0  TM    ICTFL2,ICTSRS                                            23664021
         BCR   ZERO,R14           NO.                                   23670021
         MVC   SMRCDAR(LX1),ICTSRA YES. PUT SAME RECORD AREA NO.        23676021
         TM    DX8(R8),XXE0        BASIC FILE?                          23682021
         BCR   ZERO,R14            NO, RETURN                           23688021
         TM    DX8(R8),XX40         BSAM                                23694021
         BZ    SAMRCD2             NO                                   23700021
         TM    BUFCAL+NX10,XX01     S MODE                              23706021
         BZ    SAMRCD2             NO                                   23712021
         MVC   SMRCDAR+NX1(LX3),DCBADD+NX1 YES, SAVE DCB ADD            23718021
         BR    R14                 RETURN                               23724021
SAMRCD2  MVC   SMRCDAR+NX1(LX3),DECBAD+NX1 REL LOC DECB                 23730021
         BR    R14                RETURN TO ACCMET.                     23736021
         EJECT                                                          23742021
         USING *,R15                                                    23748021
* REORGBD BUILDS REORG-CRITERIA TABLE WHEN CALLED BY ACCMET.            23754021
REORGBD  STM   R0,R14,RSAVEA                                            23760021
         ST    R15,TSAVER                                               23766021
         TM    PRMSW,XX40          TABLE PRIMED.                        23772021
         BO    REORGBD1           YES.                                  23778021
         LA    R1,REORGPAR                                              23784021
         L     R15,BPRIME                                               23790021
         BALR  R14,R15             PRIME REORG-CRITERIA TABLE           23796021
         L     R15,TSAVER                                               23802021
         OI    PRMSW,XX40          SET PRIME SW ON.                     23808021
REORGBD1 MVC   FULLWD(LX2),DX0(R7)                                      23814021
         LH    R9,FULLWD          R9: NAME-QUAL COUNT IN FSTEXT.        23820021
         LA    R9,DX1(R9)                                               23826021
         LA    R0,DX1(R9)          ENTRY SIZE(PART1)                    23832021
         L     R1,REORGPAR                                              23838021
         L     R15,BINSRT                                               23844021
         BALR  R14,R15             INSERT ENTRY INTO REORG TABLE        23850021
         L     R15,TSAVER                                               23856021
         EX    R9,MOVREORG        MOVE NAME-QUAL-COUNT INTO TBL.        23862021
         ST    R3,REORGPT         R3=DISP IN REORG TBL.                 23868021
         LA    R7,DX1(R7,R9)       R7=A(NEXT FIELD)                     23874021
         CLI   DX0(R7),XXFF        END OF BUFFER                        23880021
         BNE   REORGBD2           NO, ENTER CARD NO INTO TBL            23886021
         L     R1,COSADR          YES, READ IN NEXT FIELD.              23892021
         BALR  R0,R1               BR TO COMMON                         23898021
         DC    X'03'              FILE 3.                               23904021
         LR    R7,R0                                                    23910021
REORGBD2 LA    R0,DX5              DICT-PTR+CARD-NO-3+2                 23916021
         L     R1,REORGPAR                                              23922021
         L     R15,BINSRT                                               23928021
         BALR  R14,R15             INSERT ENTRY INTO TABLE              23934021
         L     R15,TSAVER                                               23940021
         MVC   DX3(LX2,R2),CARDNO   MOVE CARD NO INTO TBL.              23946021
         BCTR  R7,R0               SUBTRACT 1 FROM R7                   23952021
         ST    R7,RSAVEA+NX28      PASS NEW R7.                         23958021
         LM    R0,R14,RSAVEA      RESTORE REGISTERS.                    23964021
         BR    R14                 RETURN                               23970021
*                                                                       23976021
MOVREORG MVC   DX0(LX0,R2),DX0(R7)                                      23982021
*                                                                       23988021
         EJECT                                                          23994021
*=2    KEY TABLES BUILDER- KEYRTN                                       24000021
*TITLE 'KEYRTN'   -KEY TABLES BUILD ROUTINE                             24006021
*STATUS                                                                 24012021
*FUNCTION/OPERATION- ROUTINE STORES KEY NAMES(RECORD, SYMBOLIC, ACT     24018021
*   IN SPECIAL TABLES SO THAT WHEN THE KEY NAMES ARE ENTERED IN THE     24024021
*   DICTIONARY, THEY MAY BE LOOKED UP AND THEIR LGN AND LOCATION        24030021
*   MAY BE PLACE IN THE DCB AND DECB RESPECTIVELY VIA CONDEF'S. THE     24036021
*   TABLES ARE TAMER TABLES.                                            24042021
*ENTRY POINTS       -KEYRTN-     FOR SYM/ACT KEYS IN SEQUENTIAL PRO     24048021
*                   -KEYRTN+8-   FOR RECORD KEYS                        24054021
*                                                                       24060021
*                   L    R9,A(KEYRTN USED FOR THIS TYPE KEY)            24066021
*                                              SYMBOLIC  A(KEYRTN)      24072021
*                                              ACTUAL    A(KEYRTN)      24078021
*                                            RECORD   A(KEYRTN+4)       24084021
*                   L    R15,A(KEYRTN)                                  24090021
*                   BALR R14,R9                                         24096021
*INPUT-  REG 7  POINTS TO KEY NAME                                      24102021
*OUTPUT-                                                                24108021
*EXTERNAL ROUTINES- NONE                                                24114021
*EXITS- ONE NORMAL EXIT- AT -KEYSRT-    NO CODES PASSED                 24120021
*TABLES/WORKAREAS                                                       24126021
*   KEYTBL -TABLE FOR SYM/ACT SEQ. PROC.                                24132021
*   RCKTBL -TABLE FOR RECORD KEYS                                       24138021
*   RPARAM -PARAMETER NEEDED TO ACCESS THE RCKTBL                       24144021
*   SYMPAR -PARAMETER NEEDED TO ACCESS THE KEYTBL                       24150021
*   KEYINS -WORK AREA USED FOR KEYS TABLE ENTRY                         24156021
*   DCBADD -REL. LOC. OF DCB                                            24162021
*   DECBAD -REL. LOC. OF DECB                                           24168021
*   NUMCYC -NUMBER OF CYCLES                                            24174021
*ATTRIBUTES                                                             24180021
*NOTES                                                                  24186021
         USING *,R15                                                    24192021
KEYRTN   BC    UNCOND,SEQKEY       CONTINUE PROCESSING                  24198021
         BC    UNCOND,*+NX4         ENABLE TWO ENTRY POINTS TO RECKE    24204021
         STM   R8,R6,RSAVEA                                             24210021
RECKEY   LA    R5,DX4               RB IS EXECUTE REG FOR TM PTBLSW,    24216021
*                                                    AND OI PTBLSW,     24222021
         LA    R10,RPARAM          PUT A(TABLE PARAMETER) IN R10        24228021
         LR    R1,R10                AND R1   FOR RECORD KEY TABLE      24234021
         BAL   R6,KEYCOM           LINK TO COMMON KEY ROUTINE           24240021
       STH   R3,FDKYTB             STORE NEW DISPL                      24246021
         XI    FDKYTB+NX1,XX01                                          24252021
         L     R6,DCBADD                                                24258021
         LA    R6,DX16(R6,R0)      R6=REL LOC OF KEYLGN IN DCB          24264021
         ST    R6,KEYLGN                                                24270021
         LA    R6,DX44(R6,R0)      R6=REL LOC RECORD KEY DISP(RKD)IN    24276021
         ST    R6,KEYLOC                                                24282021
         MVC   KYDECB(LX2),CARDNO                                       24288021
*DEL                                                                    24294021
*DEL                                                                    24300021
*DEL                                                                    24306021
*DEL                                                                    24312021
*DEL                                                                    24318021
RECKY1   LA    R0,DX11                  PUT INSERT LGN IN R0      51326 24324021
         MVC   ACCTAB+NX108(LX4),AKEYRN RESTORE ENTRY PT ADR.           24330021
         BC    UNCOND,KEYSRT       INSERT ENTRY INTO TABLE              24336021
KEYCOM   MVI   KEYEND,XX00          CLEAR END SWITCH                    24342021
         LR    R4,R3               R4= KEY INDEX                        24348021
         EX    R5,TSPTBL           HAS THE TABLE BEEN PRIMED            24354021
         BC    ONES,KEYCO1         YES,BRANCH                           24360021
         L     R15,BPRIME          NO, PRIME THE TABLE                  24366021
         BALR  R14,R15             CALL PRIME OF TAMER                  24372021
         L     R15,RSAVEA+NX28                                          24378021
         EX    R5,SETPTB           SET PRIME SW ON                      24384021
KEYCO1   XC    KEYINS(LX16),KEYINS  CLEAR INSERT AREA                   24390021
         MVI   KEYLGN+NX3,XX01                                          24396021
         MVI   KEYLOC+NX3,XX01                                          24402021
         MVC   FULLWD(LX2),DX0(R7)   MOVE KEY NAME COUNT FIELD TO FUL   24408021
         LH    R9,FULLWD            WORD BOUNDARY, ADD 1 TO COUNT A     24414021
         LA    R9,DX1(R9)            LOAD INTO REG 9.                   24420021
         LA    R0,DX1(R9)           R0= LGN OF INSERT ENTRY             24426021
         L     R1,DX0(R10)          R1= A(TABLE'S TIB)                  24432021
         L     R15,BINSRT          CALL INSERT OF TAMER, REG2 IS RE     24438021
         BALR  R14,R15                    WITH TABLE ADDRESS            24444021
         L     R15,RSAVEA+NX28                                          24450021
         EX    R9,MOVKEY                                                24456021
KEYCO3   LA    R7,DX1(R7,R9)        REG 7= A(NEXT BUFFER FIELD)         24462021
         CLI   DX0(R7),XXFF         END OF BUFFER                       24468021
         BCR   NOTEQ,R6           NO, RETURN TO CALLER                  24474021
         L     R1,COSADR                                                24480021
         BALR  R0,R1               CALL FOR READ FILE 3                 24486021
         DC    X'03'                                                    24492021
         LR    R7,R0                                                    24498021
         BCR   UNCOND,R6           RETURN                               24504021
*                                                                       24510021
MOVKEY   MVC   DX0(LX0,R2),DX0(R7)                                      24516021
SETPTB   OI    PTBLSW,XX00                                              24522021
TSPTBL   TM    PTBLSW,XX00                                              24528021
SEQKEY   STM   R8,R6,RSAVEA                                             24534021
         LA    R5,DX1               RB IS EXECUTE REGISTER FOR TM PT    24540021
         LA    R10,SYMPAR          PUT A(TABLE PARAMETER) IN R10        24546021
         LR    R1,R10                AND R1 FOR SEQ. KEY TABLE          24552021
SEQKEY1  BAL   R6,KEYCOM           CONTINUE PROCESSING                  24558021
         OI    BSAMDP+NX3,XX01                                          24564021
         C     R4,TWO             ACT-KEY                               24570021
         BE    SEQKEY2            YES, DIRECT FILE WITH KEY.            24576021
         LA    R6,DX1              NO, NOMINAL KEY                      24582021
         B     SEQKEY3             PROCESS NOMINAL KEY                  24588021
SEQKEY2  MVC   BSAMDP(LX4),BSAMPT  MOVE BSAMTBL DISP INTO SET UP ARE    24594021
         L     R6,DCBADD                                                24600021
         LA    R6,DX16(R6)         REL LOC DCBKEYLNG                    24606021
         ST    R6,KEYLGN                                                24612021
SEQKEY3  LR    R6,R4                                                    24618021
         SLL   R6,DX1                 SAVE AREAS FOR THIS AND LAST F    24624021
         LA    R6,FDKYTB-NX2(R6)    GET ADDRESS IN SAVE AREA            24630021
         STH   R3,DX0(R6)                                               24636021
         XI    DX1(R6),XX01                                             24642021
SEQKEY4  C     R4,THREE           NOMINAL KEY?                          24648021
         BNE   SEQKEY5            NO.                                   24654021
         TM    AMCODE(R8),XX30     ISAM?                                24660021
         BZ    *+8                NO.                                   24666021
         OI    KEYLGN+NX3,XX02     YES.                                 24672021
         L     R6,DECBAD          YES                                   24678021
         LA    R6,DX20(R6)         DECB KEYAD FIELD                     24684021
         ST    R6,KEYLOC                                                24690021
         TM    FDACMT,XX10         QISAM?                               24696021
         BZ    SEQKEY5            NO.                                   24702021
         L     R6,DCBADD          YES, PUT KEY ADR FOR START IN         24708021
         LA    R6,DX256(R6)        DCB EXTENSION.                       24714021
         ST    R6,KEYLOC                                                24720021
SEQKEY5  MVC   NCYC(LX2),CARDNO                                         24726021
         LA    R0,DX14                                                  24732021
KEYSRT   L     R1,DX0(R10)          R1= A(TABLE'S TIB)                  24738021
         LR    R6,R0               SAVE INSERT LGN FOR MOVE             24744021
         L     R15,BINSRT                                               24750021
         BALR  R14,R15             INSERT ENTRY INTO TABLE              24756021
         L     R15,RSAVEA+NX28                                          24762021
       BCTR  R6,R0                 SUBTRACT 1 FROM LGN                  24768021
         EX    R6,KYMOVE           MOVE KEY INFORMATION TO TABLE.       24774021
         LM    R8,R6,RSAVEA                                             24780021
         BCR   UNCOND,R14          RETURN TO CALLER                     24786021
KYMOVE   MVC   DX0(LX0,R2),KEYINS                                       24792021
         EJECT                                                          24798021
*=2    LABLBD- LABLE TABLE BUILD ROUTINE                                24804021
*TITLE 'LABLBD'   -LABLE TABLE BUILD ROUTINE                            24810021
*STATUS                                                                 24816021
*FUNCTION/OPERATION-THIS ROUTINE TAKES LABEL RECORD DATA-NAMES, ASS     24822021
*   ONE LINKAGE BASE LOCATOR TO ALL DATA-NAMES FOR A FILE(FD) AND P     24828021
*   THESE DATA-NAMES AND BASE LOCATORS INTO A LABEL TABLE(LABTBL).      24834021
*   LABEL RECORDS MUST BE DEFINED IN THE LINKAGE SECTION  SO AT THE     24840021
*   TIME THE LINKAGE SECTION IS BEING PROCESSED EACH 01 OR 77 ITEM      24846021
*   LOOKED UP IN THE LABTBL AND IF FOUND, THE BASE LOCATOR(LINKAGE)     24852021
*   NUMBER SPECIFIED IN THE LABTBL IS USED FOR THE ADDRESSING PARAM     24858021
*   OF THAT ITEM.                                                       24864021
*ENTRY POINT -LABLBD-                                                   24870021
*                   L    R15,A(LABLBD)                                  24876021
*                   BALR R14,R15                                        24882021
*INPUT-  REG 7  POINTS TO LABEL RECORD DATA-NAMES                       24888021
*OUTPUT-                                                                24894021
*EXTERNAL ROUTINES-  TAMER ROUTINES-PRIME-   ALLOCATE TABLE SPACE       24900021
*                                  -INSERT-  GIVES ADDRESS FOR ENTR     24906021
*EXITS- ONE NORMAL EXIT            NO CODES PASSED                      24912021
*TABLES/WORKAREAS                                                       24918021
*   BLLINK-  WORK AREA FOR LINKAGE BASE LOCATOR                         24924021
*   LABTBL-  TABLE FOR LABEL RECORD DATA-NAMES                          24930021
*ATTRIBUTES                                                             24936021
*NOTES                                                                  24942021
         USING *,R15                                                    24948021
LABLBD   STM   R0,R14,RSAVEA                                            24954021
         SR    R0,R0                                                    24960021
         SR    R9,R9                                                    24966021
         OI    LBLSW,XX80          LABEL RECORD ENTRY EXISTANCE SW      24972021
         TM    PTBLSW,XX10         TABLE PRIMED                         24978021
         BO    LABLB0             YES  BRANCH                           24984021
         ST    R15,TSAVER          SAVE REG 15                          24990021
         LA    R1,LPARAM           R1=A(LABEL TABLE PARAMETER)          24996021
         L     R15,BPRIME          R15=A(PRIME)                         25002021
         BALR  R14,R15             CALL PRIME OF TAMER                  25008021
         L     R15,TSAVER                                               25014021
         OI    PTBLSW,XX10          TURN ON PRIME LABEL TABLE SWITCH    25020021
LABLB0   L     R4,LPARAM                                                25026021
         L     R4,DX0(R4)          R4=A(TAMM)                           25032021
         XC    DX4(LX2,R4),DX4(R4)  INITIALIZE USED TBL SIZE TO 0.      25038021
LABLB1   CLI   DX0(R7),XX00         IS THIS END OF LABEL DATA-NAMES     25044021
         BC    NOTEQ,LABLB2        NO, BRANCH                           25050021
         ST    R7,RSAVEA+NX28       YES, STORE INCREMENTED BUFFER PT    25056021
         LM    R0,R14,RSAVEA       RESTORE REGISTERS                    25062021
         BCR   UNCOND,R14          RETURN TO CALLER                     25068021
LABLB2   IC    R9,DX0(R7)           SET R9=NAME LGN                     25074021
         LA    R0,DX3(R9,R0)       R0=INSERT LGN (BL=+DATA-NAME+COUN    25080021
*                                               ( 2 +   N     +  1      25086021
         L     R1,LPARAM           R1=A(TABLE NAME OR TIB)              25092021
         ST    R15,TSAVER                                               25098021
         L     R15,BINSRT                                               25104021
         BALR  R14,R15             CALL INSERT OF TAMER                 25110021
         L     R15,TSAVER                                               25116021
         MVC   DX0(LX2,R2),BLLINK    MOVE BL= TO TABLE                  25122021
         EX    R9,MOVLAB           MOVE COUNT AND DATA-NAME TO TABL     25128021
         LA    R7,DX1(R7,R9)        INCREMENT BUFFER PTR. TO NEXT FI    25134021
         CLI   DX0(R7),XXFF         IS IT END OF BUFFER                 25140021
         BC    NOTEQ,LABLB1        NO, BRANCH                           25146021
         L     R1,COSADR           YES,                                 25152021
         BALR  R0,R1                 READ A RECORD                      25158021
         DC    X'03'                    FROM FILE 3                     25164021
         LR    R7,R0               R7= BUFFER PTR                       25170021
         BC    UNCOND,LABLB1       CHECK NEXT LABEL DATA-NAME           25176021
MOVLAB   MVC   DX2(LX0,R2),DX0(R7)                                      25182021
         EJECT                                                          25188021
* TOTLBD BUILDS TOTALING AREA TABLE WHEN CALLED BY ACCMTH.              25194021
         USING *,R15                                                    25200021
TOTLBD   STM   R0,R14,RSAVEA                                            25206021
         ST    R15,TSAVER         SAVE R15                              25212021
         TM    PRMSW,XX80          TABLE PRIMED.                        25218021
         BO    TOTLBD1            YES.                                  25224021
         LA    R1,TOTLPAR                                               25230021
         L     R15,BPRIME                                               25236021
         BALR  R14,R15             PRIME TOTALING AREA TABLE            25242021
         L     R15,TSAVER                                               25248021
         OI    PRMSW,XX80          SET PRMSW ON.                        25254021
TOTLBD1  MVC   FULLWD(LX2),DX0(R7)                                      25260021
         LH    R9,FULLWD          R9:NAME-QUAL COUNT IN FSTEXT.         25266021
         LA    R9,DX1(R9)                                               25272021
         LA    R0,DX1(R9)          ENTRY SIZE(PART 1)                   25278021
         L     R1,TOTLPAR                                               25284021
         L     R15,BINSRT                                               25290021
         BALR  R14,R15             INSERT ENTRY INTO TABLE              25296021
         L     R15,TSAVER                                               25302021
         EX    R9,MOVTOTL         MOVE COUNT-QUAL-DN INTO TBL.          25308021
         LA    R7,DX1(R7,R9)       R7=A(NEXT FIELD)                     25314021
         CLI   DX0(R7),XXFF        END OF BUFFER?                       25320021
         BNE   TOTLBD2            NO, ENTER LOCDCB AND CARD NO.         25326021
         L     R1,COSADR          YES, READ IN NEXT FIELD.              25332021
         BALR  R0,R1               BR TO COMMON                         25338021
         DC    X'03'              FILE 3                                25344021
         LR    R7,R0              R7=A(NXT BUFF)=A(NXT FIELD)           25350021
TOTLBD2  MVC   TOTLDC(LX4),DCBADD                                       25356021
         MVC   TOTLDC+NX4(LX2),CARDNO                                   25362021
         LA    R0,DX6              DCBADD+CARDNO=4+2                    25368021
         L     R1,TOTLPAR                                               25374021
         L     R15,BINSRT                                               25380021
         BALR  R14,R15             INSERT ENTRY INTO TABLE              25386021
         L     R15,TSAVER                                               25392021
         MVC   DX0(LX4,R2),TOTLDC   MOVE DCBADD+CARD NO INTO TBL.       25398021
         ST    R7,RSAVEA+NX28      PASS NEW R7                          25404021
         LM    R0,R14,RSAVEA      RESTORE REGISTERS                     25410021
         BR    R14                RETURN TO ACCMET.                     25416021
*                                                                       25422021
MOVTOTL  MVC   DX0(LX0,R2),DX0(R7)                                      25428021
*                                                                       25434021
         DROP  R8                                                       25440021
         DROP  R11                                                      25446021
         USING COS,RCOM                                                 25452021
         EJECT                                                          25458021
*=2      ALPHABETIC AND ALPHANUMERIC PICTURE ROUTINE                    25464021
*                                                                       25470021
*BALPHA-ALPHABETIC-ALPHANUMERIC PICTURE ANALYSIS ROUTINE                25476021
*BALPHA CHECKS THE COMPATIBILITY OF USAGE AND LENGTH FOR ALDHABETIC     25482021
* AND ALPHANUMERIC PICTURE ITEMS. USAGE MUST BE DISPLAY, IF IT IS N     25488021
* THE PICTURE IS DROPPED AND REPLACED BY A PICTURE 9 BY ITEMAN(ITEM     25494021
* ANALYSIS ROUTINE). THE LENGTH MUST NOT BE GREATER THAN 32K BYTES,     25500021
* IT IS THE LENGTH IS TRUNCATED TO 32K. THE LENGTH IS STORED IN THE     25506021
* ATTRIBUTES FIELD.                                                     25512021
* BALPHA IS CALLED BY PICTAN WHEN PCTYPE BYTE HAS ALPHABETIC OR         25518021
* ALPHANUMERIC CODE. THE CODE IS                                        25524021
*                                                                       25530021
*        IC    R4,PCTYPE      INSERT PICTURE TYPE CODE IN REG 4         25536021
*        SLA   R4,2           MULTIPLY BY 4 FOR FULL WORD BNDRY         25542021
*        LA    R8,BPICTB      LOAD PICTURE TABLE ADDRESS IN REG 8       25548021
*        AR    R8,R4          ADD INDEX(R4) TO ADDRESS OF BPICTB TA     25554021
*        ST    R15,RSAVE+60   SAVE REG 15                               25560021
*        L     R15,0(0,R8)    PUT TABLE ADDRESS IN REG 15               25566021
*        BALR  R14,R15        CALL PROPER PICTURE ANALYSIS RTN          25572021
*        LTR   R14,R15        IF CALLED ROUTINE DELETES CURRENT ITE     25578021
*        L     R15,RSAVE+60    PICTURE, R15 WILL BE SET TO ZERO AND     25584021
*        BC    ZERO,BFIXPC     BRANCH WILL BE TAKEN TO BFIXDC, OTHE     25590021
*        BC    UNCOND, ELCOM  GO TO ELEM ITEM COMPATIBILITY RTN         25596021
*                                                                       25602021
*BPICTB IS A TABLE OF PICTURE ANALYSIS RTNS                             25608021
*BFIXPC INSERTS A PICTURE 9.                                            25614021
*THE MAIN ROUTINE PLACES THE PROPER MINOR CODE IN REG 3                 25620021
*                    0010 FOR ALPHABETIC ITEMS                          25626021
*                    0011 FOR ALPHANUMERIC ITENS                        25632021
*SO THAT THE EXECUTE INSTRUCTION BEXMIN CAN PLACE THE MINOR CODE        25638021
*IN THE ATTRIBUTE FIELD                                                 25644021
       USING *,R15                                                      25650021
BALPHA   STM   R3,R7,RSAVE+NX12     SAVE REGISTERS                      25656021
         SR    R7,R7                                                    25662021
         LA    R4,ELITEM                                                25668021
         L     R6,CON32K                                                25674021
         EX    R3,BMINCD                                                25680021
         IC    R7,ITMCLS      LOAD CLAUSE FIELD INTO R7 AND MASK        25686021
         N     R7,MK3032       OUT ALL BUT USAGE BITS. IF USAGE IS      25692021
         BCT   R7,BDRPAP        DISPLAY(001) A BRANCH WILL NOT OCCU     25698021
         LH    R5,IPLT        UASGE IS DISPLAY, GET ITEM LENGTH         25704021
         N     R5,MK1732           STOP SIGN BIT PROPAGATION IF ANY     25710021
         CR    R5,R6          IS LENGTH GREATER THAN 32K                25716021
         BC    HI,BALLER      YES                                       25722021
BLDALN   EQU   *                                                        25728021
         SR    R3,R3               CLEAR REG                      59728 25734021
         IC    R3,IPT              GET COUNT OF CHARS             59728 25740021
         LA    R4,IPT+NX1          POINTER TO TABLE               59728 25746021
BALPHA1  EQU   *                                                  59728 25752021
         CLI   DX0(R4),XCV         IS IT A 'V'                    59728 25758021
         BE    BALPHA4             YES, ERROR                     59728 25764021
         LA    R4,DX1(R4)          INCREMENT POINTER              59728 25770021
         BCT   R3,BALPHA1          GO CHECK NEXT                  59728 25776021
         STH   R5,CILGN       STORE LGN IN CI                           25782021
         MVC   VILGN(LX2),CILGN    STORE LENGTH IN ATTRIBS              25788021
         LM    R3,R7,RSAVE+NX12     RESTORE REGISTERS                   25794021
         BCR   UNCOND,R14     BRANCH TO CALLER ROUTINE                  25800021
BDRPAP   NI    ITMCLS+NX1,XXDF TURN OFF PICTURE BIT                     25806021
         MVI   PCTYPE,XX00     ZERO OUT PICTURE TYPE                    25812021
         NI    MINCOD,XX0F          ZERO OUT MINOR CODE                 25818021
         LH    R0,MSG142                 MSG 142                  40660 25824021
         SR    R15,R15                                                  25830021
         LM    R3,R7,RSAVE+NX12     RESTORE REGISTERS                   25836021
         BCR   UNCOND,R14          BRH TO ADDR IN R14-CALLING PGM       25842021
BALLER   LR    R5,R6          LGN TRUNCATED TO 32K                      25848021
         LH    R0,MSG145                                                25854021
         STM   R14,R15,RSAVE+NX32                                       25860021
         L     R15,AERRTN                                               25866021
         BALR  R14,R15             LNK TO ERRRTN                        25872021
         LM    R14,R15,RSAVE+NX32                                       25878021
         BC    UNCOND,BLDALN       BRH TO STORE LGN IN CI               25884021
BALPHA4  LM    R3,R7,RSAVE+NX12    RESTORE WORK REGS              59728 25890021
         L     R15,RSAVE+NX60      RESTORE BASE REG               59728 25896021
         USING BEGADC,R15                                         59728 25902021
         B     BYTERR              GO GEN ERROR                   59728 25908021
BMINCD   OI    MINCOD,XX00                                              25914021
MSG142   DC    X'208E'                   MSG 142                  40660 25920021
         EJECT                                                          25926021
*=2      NUMERIC PICTURE PICTURE ANALYSIS-BNUMER                        25932021
*BNUMER--NUMERIC PICTURE ANALYSIS                                       25938021
*BNUMER CHECKS THE VALIDITY OF THE NUMERIC PICTURE WITH RESPECT TO      25944021
* CHARACTER CONFIGURATION, LENGTH, SCALE AND USAGE. THE NUMERIC LEN     25950021
*AND SCALE  ARE STORED IN THE ATTRIBUTES FOR THE ITEM. THERE ARE 3      25956021
* VALID USAGES FOR A NUMERIC ITEM.                                      25962021
*              DISPLAY          -EXTERNAL DECIMAL                       25968021
*              COMPUTATIONAL    -BINARY                                 25974021
*              COMPUTATIONAL-3  -INTERNAL DECIMAL                       25980021
* IF DISPLAY THE MACHINE LENGTH EQUALS THE NUMERIC LENGTH.              25986021
* IF COMPUTATIONAL THE MACHINE LENGTH IS SPECIFIED BY FOLLOWING TAB     25992021
*                                                                       25998021
*                 NUMERIC LGN * MACHINE LGN                             26004021
*                 *************************                             26010021
*                     1-4     *     2                                   26016021
*                     5-9     *     4                                   26022021
*                    10-18    *     8                                   26028021
*                                                                       26034021
*IF COMPUTATIONAL-3 THE MACHINE LENGTH =(NUMERIC LGN/2)+1.              26040021
*IF USAGE IS NOT ONE OF THESE THE PICTURE IS DROPPED.                   26046021
*MAXIMUM NUMERIC LGN IS 18.                                             26052021
*                                                                       26058021
*                                                                       26064021
*BNUMER IS CALLED BY PICTAN WHEN PCTYPE IS NUMERIC.                     26070021
*THE CALLING ROUTINE IS                                                 26076021
*                                                                       26082021
*                                                                       26088021
*        IC    R4,PCTYPE      INSERT PICTURE TYPE CODE IN REG 4         26094021
*        SLA   R4,2           MULTIPLY BY 4 FOR FULL WORD BNDRY         26100021
*        LA    R8,BPICTB      LOAD PICTURE TABLE ADDRESS IN REG 8       26106021
*        AR    R8,R4          ADD INDEX(R4) TO ADDRESS OF BPICTB TA     26112021
*        ST    R15,RSAVE+60   SAVE REG 15                               26118021
*        L     R15,0(0,R8)    PUT TABLE ADDRESS INTO REG 15             26124021
*        BALR  R14,R15        CALL PROPER PICTURE ANALYSIS RTN          26130021
*        LTR   R14,R15        IF CALLED ROUTINE DELETES CURRENT ITE     26136021
*        L     R15,RSAVE+60    PICTURE, R15 WILL BE SET TO ZERO AND     26142021
*        BC    ZERO,BFIXPC     BRANCH WILL BE TAKEN TO BFIXPC, OTHE     26148021
*        BC    UNCOND,BELCOM  GO TO ELEM ITEM COMPATIBILITY RTN         26154021
*                                                                       26160021
*BPICTB IS A TABLE OF PICTURE ANALYSIS RTNS                             26166021
*BFIXPC INSERTS A PICTURE 9.                                            26172021
*                                                                       26178021
*                                                                       26184021
*                                                                       26190021
         USING *,R15                                                    26196021
BNUMER   STM   R1,R14,RSAVE+NX4                                         26202021
         TM    ITMCLS,XX80          BLANK WHEN ZERO SPECIFIED           26208021
         BZ    BNUMR1              NO                                   26214021
         BAL   R11,BERR13          LNK TO BERR13                        26220021
         DC    X'2025'             MSG37                                26226021
         NI    ITMCLS,XX7F          ZERO OUT                            26232021
BNUMR1   SR    R7,R7                                                    26238021
         SR    R8,R8                                                    26244021
         IC    R7,ITMCLS                                                26250021
         N     R7,MK3032      LOAD USAGE ONLY IN REG 7                  26256021
         LA    R8,DX1(R8,R0)                                            26262021
         CR    R7,R8          IS USAGE DISPLAY                          26268021
         BC    EQ,BEXTDC      YES                                       26274021
         LA    R8,DX1(R8,R0)  NO                                        26280021
         CR    R7,R8          IS USAGE COMPUTATIONAL                    26286021
         BC    EQ,BBNARY      YES                                       26292021
         LA    R8,DX3(R8,R0)  NO                                        26298021
         CR    R7,R8          IS USAGE COMPUTATIONAL-3                  26304021
         BC    EQ,BINTDC      YES                                       26310021
         LA    R8,DX2(R8)                                               26316021
         CR    R7,R8               IS USAGE INDEX                       26322021
         BE    BNPICT              YES                                  26328021
BDRPNP   NI    ITMCLS+NX1,XXDF TURN OFF PICTURE CLAUSE BIT(NO PICTUR    26334021
         LM    R1,R15,RSAVE+NX4     USAGE IS COMP-1 OR 2, SO RETURN     26340021
         L     R14,ABELEM            INTERNAL FLOATING                  26346021
         BCR   UNCOND,R14                POINT ROUTINES                 26352021
BEXTDC   OI    MINCOD,XX80     SET MINOR CODE TO EXT. DEC. (8)          26358021
         BC    UNCOND,BNPICT       BRH TO LOAD IPT ADDR IN REG4         26364021
BBNARY   OI    MINCOD,XXB0     SET MINOR CODE TO BINARY (11)            26370021
         BC    UNCOND,BNPICT       BRH TO LOAD IPT ADDR IN REG4         26376021
BINTDC   OI    MINCOD,XXC0     SET MINOR CODE TO INT. DEC. (12)         26382021
BNPICT   LA    R4,ELITEM      R4= IPT ADDRESS                           26388021
         LA    R3,IPLT        R3= IPLT ADDRESS                          26394021
         XC    BYTESW(LX3),BYTESW  INITIALIZE SWITCHES TO 0             26400021
         SR    R2,R2                                                    26406021
         SR    R5,R5                                                    26412021
         SR    R6,R6                                                    26418021
         SR    R7,R7                                                    26424021
         SR    R8,R8                                                    26430021
         SR    R12,R12                                                  26436021
         LA    R9,BPTABL      R9= P TABLE ADDRESS                       26442021
         LA    R10,BVTABL     R10= V TABLE ADDRESS                      26448021
         IC    R8,ELITEM      R8= IPT CHAR. COUNT                       26454021
         CLI   DX1(R4),XCS     IS FIRST CHAR A SIGN                     26460021
         BC    EQ,BSETSN      YES                                       26466021
         NI    LEVNUM,XXFE     NO,SET NUM SIGN BIT OFF                  26472021
BCOMPP   CLI   DX1(R4),XCP     IS CHAR. A P                             26478021
         BC    EQ,BPPPPS      YES                                       26484021
         CLI   DX1(R4),XCV     NO,IS CHAR. A V                          26490021
         BC    EQ,BVVVVS      YES                                       26496021
         CLI   DX1(R4),XC9     NO, IS CHAR. A 9                         26502021
         BC    NOTEQ,BILLCH   NO, ILLEGAL NUM CHAR.                     26508021
* CHARACTER IS  9        NINE                                           26514021
         TM    BYTESW,XX01     YES, IS 9 SW ON                          26520021
         BC    ONES,BTESTV    YES                                       26526021
BSET9    OI    BYTESW,XX01     NO, TURN ON 9 SW                         26532021
         AH    R6,DX2(R0,R3)       ADD 9'S COUNT TO NUMERIC LGN         26538021
         CLI   DECSW,XX01      IS DECIMAL SWITCH ON                     26544021
         BC    NOTEQ,BLASTN   NO                                        26550021
         AH    R7,DX2(R0,R3)       ADD 9'S COUNT TO SCALE               26556021
         TM    BYTESW,XX04     IS P SW ON                               26562021
         BC    ONES,BLASTN    YES                                       26568021
         MVI   SCSIGN,XX01     NO, TURN ON SCALE SW                     26574021
BLASTN   BCT   R8,BGETNN      IF COUNT NOT ZERO GET NEXT CHAR.          26580021
         BC    UNCOND,B9CHEK       BRH TO CHK IF 9 SW ON                26586021
BTESTV   TM    BYTESW,XX04          IS THIS 9P9 ERROR                   26592021
         BC    ONES,ER8            YES                                  26598021
         BC    UNCOND,BSET9        NO                                   26604021
BSETSN   OI    LEVNUM,XX01     SET NUM SIGN BIT ON IN ATTRIBUTES        26610021
         BAL   R12,BERR12          CHECK COUNT=1                        26616021
         BC    UNCOND,BLASTN       BRH TO GET NXT CHR IF CNT NOT0       26622021
BGETNN   LA    R4,DX1(R4,R0)  INCREMENT  IPT                            26628021
         LA    R3,DX2(R0,R3)            AND IPLT REGS                   26634021
         SR    R5,R5                                                    26640021
         CLI   DX1(R4),XCS     IS CHAR AN S                             26646021
         BC    NOTEQ,BCOMPP   NO                                        26652021
         BC    UNCOND,ER1     ERROR IN SIGN                             26658021
* CHARACTER IS  P        SCALE                                          26664021
BPPPPS   IC    R5,BYTESW      ADD BYTESW TO P TABLE ADDRESS AND COM     26670021
         AR    R5,R9          VALUE AT INDEXED TABLE                    26676021
         CLI   DX0(R5),XX01    TO 1                                     26682021
         BC    LO,ER2         ILLEGAL CHAR CONFIGURATION                26688021
         BC    HI,BPGRT            BRH ON HI TO TURN SCALE SW OFF       26694021
         MVI   SCSIGN,XX01     EQUAL TO 1, SET SCSIGN ON                26700021
BINSER   SR    R5,R5                                                    26706021
         AH    R7,DX2(R0,R3)       ADD P'S COUNT TO SCALE               26712021
         AH    R2,DX2(R0,R3)       ADD P'S COUNT TO = OF P'S            26718021
         MVI   DECSW,XX01                                               26724021
         OI    BYTESW,XX04     SET P SW ON                              26730021
         BC    UNCOND,BLASTN       BRH TO GET NXT CHR IF CT NOT 0       26736021
BPGRT    MVI   SCSIGN,XX00     TURN SCALE SW OFF                        26742021
         BC    UNCOND,BINSER       BRH TO ADD P'S COUNT TO SCALE        26748021
* CHARACTER IS  V        IMPLIED DECIMAL POINT                          26754021
BVVVVS   IC    R5,BYTESW      ADD BYTESW TO V TABLE ADDRESS AND COM     26760021
         AR    R5,R10         VALUE AT INDEXED TABLE ADDRESS            26766021
         CLI   DX0(R5),XX01    TO 1                                     26772021
         BC    LO,ER3         ERROR IN CONFIGURATION OF CHARS           26778021
         BC    EQ,BSETVD      EQUAL TO 1                                26784021
       BCTR  R4,R0           GREATER THAN 1, WAS                        26790021
         CLI   DX1(R4),XC9            LAST CHAR. A 9                    26796021
         BC    EQ,ER3              P9V                                  26802021
         LA    R4,DX1(R4,R0)  RESTORE REG 4                             26808021
BSETVD   OI    BYTESW,XX02     SET V SW ON                              26814021
         MVI   DECSW,XX01                                               26820021
         BAL   R12,BERR12          CHECK COUNT=1                        26826021
         BC    UNCOND,BLASTN       BR TO GET NXT CHR IF CNT NOT 0       26832021
B9CHEK   TM    BYTESW,XX01     IS 9 SW ON                               26838021
         BC    NOTONE,ER5     ERROR NO NINES IN PICTURE                 26844021
         C     R6,CON18            YES, IS NUM. LGN GREATER THAN 18     26850021
         BC    HI,BERR10           YES                                  26856021
         LA    R5,DX0(R6,R2)                                            26862021
         C     R5,CON18            NO, ARE P'S+ 9'S OVER 18             26868021
         BC    HI,BERR11           YES                                  26874021
         CLI   SCSIGN,XX01          NO, IS SCALE SW ON                  26880021
         BC    EQ,BSTORE      YES                                       26886021
         TM    BYTESW,XX04     NO, IS P SW ON                           26892021
         BC    NOTONE,BSTORE  NO                                        26898021
         LA    R7,DX128(R0,R7) YES, SET SCALE SIGN MINUS                26904021
BSTORE   STC   R7,VILGN       STORE    SCALE    IN ATTRIBUTES           26910021
         STC   R6,VILGN+NX1    STORE NUMERIC LENGTH IN ATTRIBUTES       26916021
         STC   R2,NOOFPS           STORE NUMBER OF P'S                  26922021
         SR    R4,R4                                                    26928021
       IC    R4,MINCOD            GET MINOR CODE(TYPE OF ITEM)          26934021
         SRA   R4,DX4              IN REG 4                             26940021
         LA    R5,DX11(R0,R0)                                           26946021
         LA    R9,DX9(R0,R0)                                            26952021
         C     R4,SEVEN            IS USAGE INDEX                       26958021
         BE    BINLGN              YES,TREAT AS BINARY                  26964021
         CR    R4,R5          IS ITEM BINARY                            26970021
         BC    HI,BPACKE      NO,ITEM IS INTERNAL DEC.                  26976021
         BC    LO,BUNPCK      NO,ITEM IS EXTERNAL DEC.                  26982021
BINLGN   CR    R6,R9          IS NUMERIC LGN =9 OR LESS                 26988021
         BC    HI,BMCLN9      NO,GREATER THAN 9                         26994021
         SRA   R9,DX1          YES, SET R9=4                            27000021
         CR    R6,R9          IS NL =4 OR LESS                          27006021
         BC    HI,BMCLN4      NO, THEN MACH LGN IS 4                    27012021
         SRA   R9,DX1          YES, SET R9=2                            27018021
         STH   R9,CILGN       STORE MACH LGN =2  IN ATTRIBUTES          27024021
         BC    UNCOND,BLEAVN       BRH TO RESTORE REGISTERS             27030021
BMCLN9 BCTR  R9,R0                 REDUCE REG 9 BY 1                    27036021
         STH   R9,CILGN       STORE MACH LGN=8 IN ATTRIBUTES            27042021
         BC    UNCOND,BLEAVN       BR TO RESTORE REGS AND RETURN        27048021
BMCLN4   STH   R9,CILGN       STORE MACH LGN=4  IN ATTRIBUTES           27054021
         BC    UNCOND,BLEAVN       BR TO RESTORE REGS AND RETURN        27060021
BPACKE   SRA   R6,DX1          DIVIDE NUM. LGN. BY 2                    27066021
         LA    R6,DX1(R0,R6)  ADD ONE                                   27072021
         STH   R6,CILGN       STORE MACH LGN IN ATTRIBUTES              27078021
         BC    UNCOND,BLEAVN       BR TO RESTORE REGS AND RETURN        27084021
BUNPCK   STH   R6,CILGN       STORE NUMER LGN IN MACH LGN FIELD OF      27090021
BLEAVN   LM    R1,R14,RSAVE+NX4                                         27096021
         BCR   UNCOND,R14          RETURN TO CALLING PGM                27102021
*                                                                       27108021
BDROPN   LH    R0,DX0(R4)           PUT ERROR NUMBER IN REG 0           27114021
         NI    MINCOD,XX0F          CLEAR MINOR CODE                    27120021
         SR    R15,R15             R15=0 (ERROR CODE)                   27126021
         LM    R1,R14,RSAVE+NX4                                         27132021
         BCR   UNCOND,R14          RETURN TO CALLER                     27138021
ER1      BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27144021
         DC    X'1045'             69   SIGN IN ILLEGAL POSITION        27150021
ER2      BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27156021
         DC    X'1046'             70   D    IN ILLEGAL POSITION        27162021
ER3      BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27168021
         DC    X'1047'             71   V    IN ILLEGAL POSITION        27174021
ER5      BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27180021
         DC    X'1048'             72   NO 9'S                          27186021
ER8      BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27192021
         DC    X'1049'             73   9P9                             27198021
BILLCH   BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27204021
         DC    X'0000'             LNK TO PUT ERROR # IN REG 0          27210021
BERR10   BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27216021
         DC    X'104B'             75   N.L. G.T. 18                    27222021
BERR11   BAL   R4,BDROPN           LNK TO PUT ERROR # IN REG 0          27228021
         DC    X'104C'             76   P'S + 9'S G.T. 18               27234021
BERR12   CLC   DX2(LX2,R3),ONE+NX2   IS COUNT 1                         27240021
         BCR   EQ,R12              YES                                  27246021
         BAL   R11,BERR13          NO                                   27252021
         DC    X'1090'             144  V OR S NOT 1                    27258021
         BCR   UNCOND,R12          BRH TO ADDR IN REG 12                27264021
BERR13   LH    R0,DX0(R11)                                              27270021
         ST    R15,TSAVER                                               27276021
         L     R15,AERRTN                                               27282021
         BALR  R14,R15             LNK TO ERRRTN                        27288021
         L     R15,TSAVER                                               27294021
         LA    R11,DX2(R11)                                             27300021
         BCR   UNCOND,R11          BRH TO ADDR IN REG 11                27306021
         EJECT                                                          27312021
*=2      FLOATING POINT PICTURE ANALYSIS-BFLTPT                         27318021
*BFLTPT--FLOATING POINT PICTURE ANALYSIS                                27324021
*BFLTPT ANALYZES AN EXTERNAL FLOATING POINT PICTURE CHECKING CHARAC     27330021
* CONFIGURATION, LENGTH OF MANTISSA AND EXPONENT, AND USAGE. THE US     27336021
* MUST BE DISPLAY, IF IT IS NOT, THE PICTURE IS DROPPED AND AN ERRO     27342021
* CODE(REGISTER 15= 0) IS RETURNED TO PICTAN.                           27348021
*BFLTPT IS CALLED BY PICTAN WHEN PCTYPE  IS EXT. FLOAT. PT, BY THE      27354021
* FOLLOWING CODE.                                                       27360021
*                                                                       27366021
*                                                                       27372021
*        IC    R4,PCTYPE      INSERT PICTURE TYPE CODE IN REG 4         27378021
*        SLA   R4,2           MULTIPLY BY 4 FOR FULL WORD BNDRY         27384021
*        LA    R8,BPICTB      LOAD PICTURE TABLE ADDRESS IN REG 8       27390021
*        AR    R8,R4          ADD INDEX(R4) TO ADDRESS OF BPICTB TA     27396021
*        ST    R15,RSAVE+60   SAVE REG 15                               27402021
*        L     R15,0(0,R8)    PUT TABLE ADD.INTO R15                    27408021
*        BALR  R14,R15        CALL PROPER PICTURE ANALYSIS RTN          27414021
*        LTR   R14,R15        IF CALLED ROUTINE DELETES CURRENT ITE     27420021
*        L     R15,RSAVE+60    PICTURE, R15 WILL BE SET TO ZERO AND     27426021
*        BC    ZERO,BFIXPC     BRANCH WILL BE TAKEN TO BFIXPC, OTHE     27432021
*        BC    UNCOND,BELCOM  GO TO ELEM ITEM COMPATIBILITY RTN         27438021
*                                                                       27444021
*BPICTB IS A TABLE OF PICTURE ANALYSIS RTNS                             27450021
*BFIXPC INSERTS A PICTURE 9.                                            27456021
*                                                                       27462021
         USING *,R15                                                    27468021
BFLTPT   STM   R1,R14,RSAVE+NX4                                         27474021
         XC    BEXPSW(LX1),BEXPSW CLEAR SWITCH                          27480021
         SR    R5,R5                                                    27486021
         IC    R5,ITMCLS      INSERT CLAUSE BYTE REG 5                  27492021
         N     R5,MK3032      MASK OUT ALL BUT USAGE CLAUSE             27498021
         BCT   R5,BDRPFA           IF BRANCH, USAGE IS NOT DISPLAY      27504021
         OI    MINCOD,XX90     SET MINOR CODE                           27510021
         LA    R4,ELITEM                                                27516021
         LA    R3,IPLT                                                  27522021
         LA    R9,DX16(R0,R0)                                           27528021
         SR    R10,R10                                                  27534021
         SR    R5,R5                                                    27540021
         SR    R6,R6                                                    27546021
         SR    R7,R7                                                    27552021
         SR    R8,R8                                                    27558021
         IC    R8,ELITEM      R8= IPT COUNT                             27564021
BCOMEX   CLI   DX1(R4),XX4E    IS CHAR A + SIGN                         27570021
         BC    EQ,BSNPLS      YES                                       27576021
         CLI   DX1(R4),XX60    NO, IS CAHR A - SIGN                     27582021
         BC    EQ,BSNMIN      YES                                       27588021
         CLC   DX1(LX1,R4),CONPER    NO, IS CHAR A DECIMAL PT.          27594021
         BC    EQ,BDCPNT      YES                                       27600021
         CLI   DX1(R4),XCV     NO, IS CHAR AN IMPLIED DEC. PT.          27606021
         BC    EQ,BDCPNT      YES                                       27612021
         CLI   DX1(R4),XC9     NO, IS CHAR. A NINE                      27618021
         BC    EQ,BNINER      YES                                       27624021
         CLI   DX1(R4),XCE     NO, IS CHAR AN E                         27630021
         BC    EQ,BEXPON      YES                                       27636021
         BC    UNCOND,BERR1   NO, ILLEGAL FP PICT. CHAR.                27642021
*  CHARACTER IS +        PLUS SIGN                                      27648021
BSNPLS   TM    BEXPSW,XX0F     HAS SIGN,DEC. PT.,9,OR E APPEARED        27654021
         BC    NOTZER,BEXPLS  YES                                       27660021
         OI    LEVNUM,XX01     NO, SET MANTISSA SIGN TO PLUS IN CI      27666021
         BC    UNCOND,BONSSW       BRH TO SET ON SIGN SWITCH            27672021
*  CHARACTER IS -        MINUS SIGN                                     27678021
BSNMIN   TM    BEXPSW,XX0F     HAS SIGN,DEC. PT.,9, OR E APPEARED       27684021
         BC    NOTZER,BEXPLS  YES                                       27690021
         NI    LEVNUM,XXFE     NO, SET MANTISSA SIGN TO MINUS IN CI     27696021
BONSSW   OI    BEXPSW,XX08     SET SIGN SWITCH                          27702021
BADDSN   LH    R5,DX2(R0,R3)  GET SIGN COUNT (IPLT)                     27708021
         BCT   R5,BERR2       IF COUNT NOT 1, BRANCH                    27714021
         LA    R6,DX1(R6,R0)  COUNT=1, ADD 1 TO TOTAL LENGTH            27720021
         BC    UNCOND,BLASTE       GRH TO DECR IPT COUNT                27726021
BEXPLS   TM    BEXPSW,XX0F     ARE ALL 4 SW'S ON                        27732021
         BC    NOTONE,BERR3   NO                                        27738021
         OI    VILGN,XX80      YES, SET EXPONENT SIGN TO + IN CI        27744021
         OI    BEXPSW,XX10     SET EXPONENT SIGN SWITCH ON              27750021
         BC    UNCOND,BADDSN       BRH TO GET SIGN COUNT                27756021
BEXMIN   TM    BEXPSW,XX0F     ARE ALL SWITCHES ON                      27762021
         BC    NOTONE,BERR3   NO                                        27768021
         NI    VILGN,XX7F      YES, SET EXPONENT SIGN TO MINUS          27774021
         OI    BEXPSW,XX10     SET EXPONENT SIGN SWITCH ON              27780021
         BC    UNCOND,BADDSN       BRH TO GET SIGN COUNT                27786021
*  CHARACTER IS  . V     ACTUAL OR IMPLIED DECIMAL POINT                27792021
BDCPNT   TM    BEXPSW,XX08     IS SIGN SWITCH ON                        27798021
         BC    ONES,BONDSW    YES                                       27804021
         BAL   R5,BERR4            NO                                   27810021
BONDSW   OI    BEXPSW,XX02     TURN ON DECIMAL SW                       27816021
         CLI   DX1(R4),XCV     IS CHAR. A V(IMPLIED DECIMAL)            27822021
         BC    EQ,BVPNT       YES                                       27828021
         OI    VILGN,XX40      NO, IT IS A REAL DECIMAL POINT           27834021
         BC    UNCOND,BADDSN       BRH TO GET SIGN COUNT                27840021
BVPNT    NI    VILGN,XXBF      SET IMPLIED DEC. BIT ON IN CI            27846021
         BC    UNCOND,BLASTE       BRH TO DECR IPT COUNT                27852021
*  CHARACTER IS E        EXPONENT SYMBOL                                27858021
BEXPON   TM    BEXPSW,XX0E     ARE SIGN,9,AND DEC. SW'S ALL ON          27864021
         BC    ONES,BEXPN          YES, BRANCH                          27870021
         TM    BEXPSW,XX0C          NO, ALL BUT DEC. SW. ON             27876021
         BC    NOTONE,BERR5        NO,                                  27882021
         OI    BEXPSW,XX02          YES, ASSUME IMPLIED DEC. PT.        27888021
         BAL   R12,BFPERR          LNK TO BFPERR                        27894021
         DC    X'0052'                                                  27900021
BEXPN    OI    BEXPSW,XX01          SET E SW ON9                        27906021
         BC    UNCOND,BADDSN       BRH TO GET SIGN COUNT                27912021
*  CHARACTER IS 9        NINE                                           27918021
BNINER   TM    BEXPSW,XX0F     ARE ALL SW'S ON                          27924021
         BC    ONES,BALLON    YES                                       27930021
         TM    BEXPSW,XX0E     NO, ALL ON BUT E                         27936021
         BC    ONES,BSD9ON    YES                                       27942021
         TM    BEXPSW,XX0A     NO, ALL ON BUT E AND DEC.                27948021
         BC    ONES,BSD9ON    YES                                       27954021
         TM    BEXPSW,XX08     NO, IS ONLY 9 SW ON                      27960021
         BC    ONES,BSD9ON         YES, BRANCH                          27966021
         BAL   R5,BERR4            NO                                   27972021
         BC    UNCOND,BSD9ON       BRH TO GET 9 COUNT                   27978021
BALLON   LH    R5,DX2(R0,R3)  GET 9 COUNT                               27984021
         C     R5,TWO         IS COUNT 2                                27990021
         BC    NOTEQ,BNINE2   NO                                        27996021
BNINBK   AR    R6,R5          YES, ADD COUNT TO TOTAL LGN               28002021
         BC    UNCOND,BLASTE       BRH TO DECR IPT COUNT                28008021
BSD9ON   LH    R5,DX2(R0,R3)  GET 9 COUNT                               28014021
         AR    R7,R5          ADD COUNT TO MANTISSA LGN                 28020021
         CR    R7,R9          IS MANTISSA LGN GR THAN 16                28026021
         BC    HI,BTRUNC      YES, TRUNCATE                             28032021
BTRNBK   AR    R6,R5          NO, ADD COUNT TO TOTAL LGN                28038021
         TM    BEXPSW,XX02     IS DECIMAL SW ON                         28044021
         BC    ZERO,BST9SW    NO                                        28050021
         AR    R10,R5         YES, ADD COUNT TO SCALE                   28056021
BST9SW   OI    BEXPSW,XX04     SET 9 SW ON                              28062021
         BC    UNCOND,BLASTE       BRH TO DECR IPT COUNT                28068021
BLASTE   BCT   R8,BNEXTE      DECREMENT IPT COUNT, IF COUNT NOT ZER     28074021
         TM    BEXPSW,XX10     WAS THERE AN EXPONENT SIGN IN PICTURE    28080021
         BC    ONES,*+NX8      YES                                      28086021
         BAL   R5,BERR4            NO, EXPONENT SIGN IN ATTRIBUTES      28092021
*                                    ASSUMED MINUS, PUT OUT ERROR W     28098021
         LA    R4,DX22              GET NEXT CHAR., IF COUNT IS ZERO    28104021
         CR    R6,R4               COMPARE TOTAL LENGTH TO 22           28110021
         BC    HI,BERR8       HIGH                                      28116021
         STC   R6,VILGN+NX1    STORE TOTAL LGN IN ATTRIBUTES            28122021
         STH   R6,CILGN       STORE TOTAL LGN IN CI                     28128021
         EX    R10,BSCALE     STORE SCALE IN ATTRIBUTES                 28134021
         BC    UNCOND,BLVEXP       BRH TO RESTORE REGS AND RETURN       28140021
BNEXTE   LA    R4,DX1(R4,R0)  INCREMENT IPT AND IPLT TO NEXT            28146021
         LA    R3,DX2(R3,R0)     PICTURE CHAR AND COUNT                 28152021
         SR    R5,R5                                                    28158021
         BC    UNCOND,BCOMEX       BRH TO CHK IF CHAR A + SIGN          28164021
BDRPFA   LH    R0,MSG77                                                 28170021
         NI    MINCOD,XX0F     CLEAR MINOR CODE FIELD                   28176021
         SR    R15,R15        IF USAGE OR CONFIGURATION INCORRECT R     28182021
BLVEXP   LM    R1,R14,RSAVE+NX4      IS MADE 0 FOR ERROR CODE           28188021
         BCR   UNCOND,R14     RETURN TO CALLER(PICTAN) WITH ERROR C     28194021
MSG77    DC    X'104D'             MSG 77                               28200021
BFPERR   LH    R0,DX0(R12)                                              28206021
         ST    R15,TSAVER                                               28212021
         L     R15,AERRTN                                               28218021
         BALR  R14,R15             LNK TO ERRRTN                        28224021
         L     R15,TSAVER                                               28230021
         LA    R12,DX2(R12)                                             28236021
         BCR   UNCOND,R12          BRH TO ADDR IN REG 12                28242021
BDRPFP   LH    R0,DX0(R4)                                               28248021
         BAL   R12,BFPERR+NX4      PROCESS ERROR                        28254021
BDPREP   DC    X'C007'                                                  28260021
         OI    VILGN-NX1,XX01       REPLACE PICTURE BY                  28266021
         MVI   VILGN,XXC0                        +9.E+99                28272021
         MVC   VILGN(LX2),BDPREP                                        28278021
         BC    UNCOND,BLVEXP       BRH TO RESTORE REGS AND RETURN       28284021
BSCALE   OI    VILGN,XX00                                               28290021
*=E                                                                     28296021
BERR1    BAL   R4,BDRPFP           LNK TO BDRPFP                        28302021
         DC    X'1051'                                                  28308021
BERR2    BAL   R12,BFPERR          LNK TO BFPERR                        28314021
         DC    X'004E'             78                                   28320021
         BC    UNCOND,BADDSN+NX8   LNK TO BADDSN                        28326021
BERR3    BAL   R4,BDRPFP           LNK TO BDRFPF                        28332021
         DC    X'104F'             79   SIGN MISSING OR IN ILL. POS     28338021
BERR4    OI    BEXPSW,XX08          SET SIGN SWITCH TO ON               28344021
         LA    R6,DX1(R6)           ADD 1 TO TOTAL LGN                  28350021
         BAL   R12,BFPERR          LNK TO BFPERR                        28356021
         DC    X'1050'             80                                   28362021
         BCR   UNCOND,R5           BRH TO ADDR IN REG 5                 28368021
BERR5    BAL   R4,BDRPFP           LNK TO BDRPFP                        28374021
         DC    X'1051'             81   E IN ILL. POS.                  28380021
BTRUNC   BAL   R4,BDRPFP           LNK TO BDRPFP                        28386021
         DC    X'1053'             83   MANTISSA  LGN  G.T. 16          28392021
BERR8    BAL   R4,BDRPFP           LNK TO BDRPFP                        28398021
         DC    X'1054'             84   TOTAL LGN OVER 21               28404021
BNINE2   LA    R5,DX2(R0,R0)   TRUNCATE COUNT TO 2 9'S FOR EXPONENT     28410021
         BAL   R12,BFPERR          LINK TO BFPERR                       28416021
         DC    X'1055'             85                                   28422021
         BC    UNCOND,BNINBK       BRH TO ADD COUNT TO TOTAL LGN        28428021
         EJECT                                                          28434021
*                                                                       28440021
*                                                                       28446021
*        PHASE TERMINATION ROUTINE                                      28452021
*                                                                       28458021
*                                                                       28464021
         USING *,R15                                                    28470021
PHTERM   CLI   SRCELN,XX00          IF LAST LEVEL NUMBER WAS 0 THERE IS 28476021
         BC    EQ,BHALT            NO ITEM THAT MUST BE DELIMITED AND   28482021
*                                  NOTHING WAS ENTERED IN DICTIONARY    28488021
         TM    WSRSW,XX02               WAS THERE A REPT SECT     42660 28494021
         BC    ONES,PHTRM0              YES, BR --  IF THERE WAS  42660 28500021
*  A REPORT SECTION THERE IS NO NEED TO SUBTRACT XTRA BYTES FROM  42660 28506021
*  LOCCTR BECAUSE IT WAS ALREADY DONE IN THE REPORT SECTION RTN.  42660 28512021
*                                                                 42660 28518021
*                             IN CASE THERE WAS NO REPORT SECTION 42660 28524021
*  THE NEXT 3 INSTRUCTIONS WILL RESTORE THE LOCATION COUNTER      42660 28530021
*  AS IT SHOULD BE IF THERE WAS A LINKAGE SECTION AND IF          42660 28536021
*  UNNECESSARY BYTES WERE ADDED TO THE PROGRAM. IF THERE WAS      42660 28542021
*  NO LINKAGE SECTION AND NO UNNECESSARY STORAGE WAS ADDED,       42660 28548021
*  THEN ZEROES WILL BE SUBTRACTED FROM LOCCTR, THEREFORE          42660 28554021
*  NOT ALTERING THE CORRECT VALUE OF THE LOCATION COUNTER.        42660 28560021
         L     R1,LOCCTR                 CURRENT LOCATION COUNTER 42660 28566021
         S     R1,XTRA                    SUBTRACT XTRA BYTES     42660 28572021
         ST    R1,LOCCTR                LOCCTR AS IT SHLD BE      42660 28578021
PHTRM0   EQU   *                                                  42660 28584021
         MVI   NXTLEV,XXFF          MOVE DUMMY LEVEL NUMBER TO NXTLEV   28590021
         MVC   CI(LX2),BDUMMY       MOVE DUMMY NAME $ TO CI-BCDNAM      28596021
         MVI   SRCELN,XX01          SET LEVEL NUMBER TO 01.             28602021
         MVI   MINCOD,XX10                                              28608021
         MVC   DICND2(LX4),REALPTR                                      28614021
         MVC   BCIPRM+NX1(LX3),ACI   ADD OF BCD NAME                    28620021
         MVI   BCIPRM,XX08          ELEM ITEN                           28626021
         MVC   BCIPRM+NX4(LX1),SRCELN ATT. COUNT FOR DUMMY              28632021
         L     R1,ACIPRM                                                28638021
         ST    R15,DSAVE                                                28644021
         L     R15,BGETPT                                               28650021
         BALR  R14,R15             LNK TO GETPTR                        28656021
         L     R15,DSAVE                                                28662021
         ST    R1,DICTPT                                                28668021
         TM    FSTSW,XX04           IS THERE AN FD, SD, SA, OR RD       28674021
*                                  THAT NEEDS A DELIMITOR               28680021
         BC    NOTONE,PHTRM1       NO                                   28686021
         MVC   PARAM(LX4),LASTDP    YES                                 28692021
         MVC   PARAM1(LX4),DICTPT                                       28698021
         LA    R1,PARAM                                                 28704021
         ST    R15,DSAVE                                                28710021
         L     R15,AENTDE          DELIMIT LAST FD, SD, SA, OR RD       28716021
         BALR  R14,R15             LINK TO EWTDEL                       28722021
PHTRM1   TM    SW88,XX01            IS COND. VAR. SW ON                 28728021
         L     R15,DSAVE                                                28734021
         BC    NOTONE,PHTM12       BR ON NOT 1 TO PHTM12                28740021
         XI    SW88,XX03            YES, TURN OFF AND TURN ON DELIM. SW 28746021
         L     R15,ABEGIN                                               28752021
         L     R5,ACONDE                                                28758021
         BALR  R4,R5               DELIMIT LAST COND VARIABLE           28764021
PHTM12   L     R15,ADICTB                                               28770021
         BALR  R14,R15             LINK TO DICTBD                       28776021
         L     R15,AQVARB          CALL QVAR BUILD TO SEE IF ODO TABLES 28782021
         BALR  R14,R15             WERE CONSTRUCTED                     28788021
         L     R15,DSAVE                                                28794021
PHTRM2   TM    WSRSW,XX03           TEST FOR WORKING-STORAGE AND REPORT 28800021
         BC    ZERO,BHALT          NEITHER APPEARED SECTIONS            28806021
PHTRM3   L     R1,LOCCTR                                                28812021
         S     R1,WS                                                    28818021
         A     R1,THREE            ADD L(REPORT SECTION)                28824021
         N     R1,MK0930           TO L(WORKING-STORAGE SECTION)        28830021
         SRL   R1,DX2                                                   28836021
         MVC   WKAR(LX1),WS+NX4      SAVE 1ST BL=                       28842021
         ST    R1,WS+NX4                                                28848021
         MVC   WS+NX4(LX1),WKAR                                         28854021
         BC    UNCOND,PHTRM5       BRH TO PUT OUT NSADEF                28860021
PHTRM4   TM    WSRSW,XX01           HAS WS SECTION APPEARED             28866021
         BC    ONES,PHTRM5         YES, BRANCH TO WSADEF OUT            28872021
         BC    UNCOND,PHTRM3       NO, REPORT SECTION                   28878021
PHTRM5   MVI   WS,XX24              PUT OUT WSADEF                      28884021
         LA    R3,DX8                                                   28890021
         LA    R2,WS                                                    28896021
         LR    R1,RCOM                                                  28902021
         BALR  R0,R1               BRH TO ADDDR IN REG 1                28908021
         DC    X'14'                                                    28914021
         MVC   WSDEF(LX7),WS+NX1                                        28920021
BHALT    ST    R15,DSAVE                                                28926021
         L     R15,ATDDMP                                               28932021
         BALR  R14,R15             LINK TO TDDMPO                       28938021
         L     R15,AWSEND                                               28944021
         BALR  R14,R15             CALL WSEND TO PROCESS KEYS           28950021
         L     R15,DSAVE                                                28956021
         MVC   BLLCTR(LX2),BLLSAVE      RESTORE BLLCTR.                 28962021
         TM    FES,XX20             WERE REDEFINES TABLES PRIMED ****   28968021
         BC    NOTONE,BHALTB       NO                                   28974021
         L     R1,RDFPAR                                                28980021
         L     R15,BTABRL                                               28986021
         BALR  R14,R15             LINK TO ADDR IN REG 15               28992021
         L     R1,RNMPAR                                                28998021
         BALR  R14,R15             LINK TO ADDR IN REG 15               29004021
BHALTB   L     R1,GPARAM                                                29010021
         L     R15,BTABRL                                               29016021
         BALR  R14,R15             LINK TO ADDR IN REG 15               29022021
         L     R15,DSAVE                                                29028021
BHALTC   TM    PTBLSW+NX1,XX01                                          29034021
         BC    NOTONE,BHALTD       BRH ON NOT 1 TO BHALTD               29040021
         L     R1,ADPIOT                                                29046021
         L     R15,BTABRL                                               29052021
         BALR  R14,R15             LINK TO ADDR IN REG 15               29058021
         L     R15,DSAVE                                                29064021
BHALTD   TM    PTBLSW+NX1,XX02                                          29070021
         BZ    BHALTE0             BR ON 0 TO BHALTE0                   29076021
         L     R1,ACHKPT                                                29082021
         L     R15,BTABRL                                               29088021
         BALR  R14,R15             LINK TO ADDR IN REG 15               29094021
         L     R15,DSAVE                                                29100021
BHALTE0  TM    PRMSW,XX10                                               29106021
         BZ    BHALTF              ON 0 GO CHK IF TABLES PRIMED         29112021
         L     R1,RUNPAR                                                29118021
         L     R15,BSTATC         MAKE RUNTBL STATIC                    29124021
         BALR  R14,R15             LINK TO ADDR IN REG 15               29130021
         L     R15,DSAVE                                                29136021
*                                                                       29142021
BHALTF   TM    PTBLSW+NX2,XX40      TABLES PRIMED                       29148021
         BZ    BHALTG              ON 0 TEST IF BSAMTBL PRIMED          29154021
         L     R1,AKEYTB                                                29160021
         L     R15,BTABRL                                               29166021
         BALR  R14,R15             LINK TO ADDR IN R15                  29172021
*                                                                       29178021
*                                                                       29184021
*                                                                       29190021
         L     R15,DSAVE                                                29196021
BHALTG   TM    PTBLSW,XX08         BSAMTBL PRIMED?                      29202021
         BZ    BHALTH              0,TEST IF QSBL TABLE PRIMED          29208021
         L     R1,BSMPAR          YES.                                  29214021
         L     R15,BTABRL                                               29220021
         BALR  R14,R15             LINK TO ADDR IN REG 15               29226021
         L   R15,DSAVE                                                  29232021
BHALTH   TM    PTBLSW,XX80          WAS QSBL TABLE PRIMED           475 29238021
         BC    ZERO,BHALTI         NO                              4758 29244021
         ST    R15,DSAVE           YES                             4758 29250021
         L     R1,QSBLPM                                           4758 29256021
         L     R15,BINSRT          CALL INSERT FOR SPACE ADDRESS   4758 29262021
         BALR  R14,R15             LINK TO ADDR IN REG 15          4758 29268021
         L     R15,DSAVE                                           4758 29274021
         LH    R1,SBLCTR                                           4758 29280021
         LA    R1,DX1(R1)                                           475 29286021
         STC   R1,DX0(R2)           INSERT SBLCTR+1                 475 29292021
         L     R1,QSBLPM                                           4758 29298021
         L     R15,BINSRT          CALL INSERT FOR SPACE ADDRESS   4758 29304021
         BALR  R14,R15             LINK TO ADDR IN REG 15          4758 29310021
         L     R15,DSAVE                                           4758 29316021
         MVI   DX0(R2),XX00         INSERT EOT                      475 29322021
BHALTI   DS    0H                                                       29328021
         TM    PTBLSW+NX1,XX08           IS OD2TBL PRIMED         41570 29334021
         BZ    BHALTIA             NO, BRANCH                     41570 29340021
         L     R1,AOD2TB           LOAD OD2TBL ADDRESS TAMME      41570 29346021
         L     R15,BTABRL          LOAD TABLE RELEASE RTN ADDR    41570 29352021
         BALR  R14,R15             RELEASE TIB 9  OD2TBL          41570 29358021
         L     R15,DSAVE           RESTORE BASE REGISTER          41570 29364021
BHALTIA  DS    0H                                                 41570 29370021
         TM    PTBLSW,XX10         TABLE PRIMED  ???                    29376021
         BNO   BHALTJ                                                   29382021
         L     R1,LPARAM                                                29388021
         L     R15,BTABRL                                               29394021
         BALR  R14,R15            RELEASE LABTABLE                      29400021
BHALTJ   DS    0H                                                       29406021
         L     R1,COSADR                                                29412021
         BALR  R0,R1               BRH TO ADDR IN REG 1                 29418021
         DC    X'A0'                                                    29424021
         EJECT                                                          29430021
         EJECT                                                          29436021
*=2      REPORT PICTURE ANALYSIS-BREPOR                                 29442021
*BREPOR--REPORT PICTURE ANALYSIS                                        29448021
*BREPOR ANALYZES A REPORT PICTURE CHECKING FOR LEGAL CHARACTER          29454021
* CONFIGURATION, TOTAL LENGTH, NUMERIC LENGTH, SCALE, USAGE, AND        29460021
* ASSOCIATED CLAUSES. THE TOTAL LENGTH CANNOT EXCEED 127 CHARACTERS     29466021
* IT DOES THE PICTURE IS CHANGED TO 9. IF THE NUMERIC LENGTH IS GRE     29472021
*THAN 18 THE PICTURE IS CHANGED TO 9. THE                               29478021
* USAGE MUST BE DISPLAY, IF IT SI NOT THE PICTURE IS DROPPED. IF TH     29484021
* NUMERIC CHARACTERS ARE ALL +, -, $, OR Z THE BLANK WHEN ZERO CLAU     29490021
* IS ASSUMED PRESENT AND THE BWZ BIT IN THE ATTRIBUTES IS SET TO 1.     29496021
* THE NUMERIC CHARACTERS ARE ALL *, THE *WZ BIT IS SET TO ONE. IF T     29502021
* BWZ CLAUSE IS GIVEN FOR THE LATTER CASE IT IS DELETED.                29508021
*  BREPOR IS CALLED BY PICTAN WHEN PCTYPE IS REPORT BY THE FOLLOWIN     29514021
*  CALLING ROUTINE                                                      29520021
*                                                                       29526021
*                                                                       29532021
*        IC    R4,PCTYPE      INSERT PICTURE TYPE CODE IN REG 4         29538021
*        SLA   R4,2           MULTIPLY BY 4 FOR FULL WORD BNDRY         29544021
*        AR    R8,R4          ADD INDEX(R4) TO ADDRESS OF BPICTB TA     29550021
*        ST    R15,RSAVE+60   SAVE REG 15                               29556021
*        L     R15,0(0,R8)    PUT TABLE ADDRESS INTO REG 15             29562021
*        BALR  R14,R15        CALL PROPER PICTURE ANALYSIS RTN          29568021
*        LTR   R14,R15        IF CALLED ROUTINE DELETES CURRENT ITE     29574021
*        L     R15,RSAVE+60    PICTURE, R15 WILL BE SET TO ZERO AND     29580021
*        BC    ZERO,BFIXPC     BRANCH WILL BE TAKEN TO BFIXPC, OTHE     29586021
*        BC    UNCOND,BELCOM  GO TO ELEM ITEM COMPATIBILITY RTN         29592021
*                                                                       29598021
*BPICTB IS A TABLE OF PICTURE ANALYSIS RTNS                             29604021
*BFIXPC INSERTS A PICTURE 9.                                            29610021
*                                                                       29616021
*                                                                       29622021
*                                                                       29628021
IKF205 CSECT                                                            29634021
       USING *,R15                                                      29640021
BREPOR   STM   R1,R14,RSAVE+NX4     SAVE CALLER'S REGISTERS             29646021
         SR    R9,R9                                                    29652021
         IC    R9,ITMCLS      INSERT CLAUSE CODES AND                   29658021
         N     R9,MK3032       ZERO OUT ALL BUT USAGE CODES             29664021
         C     R9,ONE              IS USAGE DISPLAY                     29670021
         BC    EQ,*+NX10            YES                                 29676021
         BAL   R4,BDRPPR           NO                                   29682021
         DC    X'006B'             107  USAGE NOT DISPLAY               29688021
         OI    MINCOD,XX50     SET MINOR CODE (0101) FOR REPORT ITEM    29694021
         SR    R9,R9                                                    29700021
         IC    R9,IPT         GET PICTURE CHARACTER COUNT               29706021
         XC    BREPSW(LX5),BREPSW CLEAR REPORT SWITCHES                 29712021
         LA    R6,IPT         REG 6 IS IPT INDEX                        29718021
         LA    R2,IPLT        REG 2 IS IPLT INDEX                       29724021
         SR    R8,R8          TOTAL LGN                                 29730021
         SR    R12,R12        NUMERIC LENGTH                            29736021
         LA    R4,VILGN+NX5    TEMPORARY ADDRESS FOR REPORT CHARACTE    29742021
         TM    COUNT,XX30           IS THERE AN OCCURS DICT PTR IN A    29748021
       BM    BSTCNT               NO                                    29754021
         MVI   VILGN,XX07      THERE IS SUBSCRIPTING IN THIS ITEM SO    29760021
         LA    R4,DX3(R4,R0)   3 TO R4 TO LEAVE ROOM FOR DICTIONARY     29766021
         BC    UNCOND,*+NX8      POINTER                                29772021
BSTCNT   MVI   VILGN,XX04      SET COUNT OF ATTRIBUTES TO 10            29778021
         ST    R4,BSAVE4      SAVE ADDRESS OF REPORT CHARACTERS         29784021
         SR    R10,R10        SCALE                                     29790021
BREPOT   CLI   BDECCH,XX00     I SBYTE FOR CHARACTER AFTER DECIMAL P    29796021
         BC    NOTEQ,BNOTEM   NO                                  E     29802021
         TM    BREPSW,XX04     YES,IS DECIMAL POINT SWITCH ON           29808021
         BC    ONES,BDECON    YES                                       29814021
BFCBYT   CLI   BFIRST,XX00     NO, IS FIRST CHAR BYTE EMPTY             29820021
         BC    EQ,BFEMPT      YES                                       29826021
BFINDR   SR    R3,R3          NO                                        29832021
         LA    R5,DX14(R0,R0)  R5 IS COUNTER FOR LOOP                   29838021
         SR    R7,R7                                                    29844021
         IC    R7,DX1(R6)      GET PICTURE CHAR                         29850021
         SLL   R7,DX24         SHIFT CHAR TO 8 HIGH BITS OF REG 7       29856021
BLOADR   L     R1,BRATAB(R3)  PUT BRANCH TABLE WORD IN REG 1            29862021
         XR    R1,R7          XOR REG 7 AND REG 1, IF PICTURE           29868021
         CL    R1,MK0932       CHAR MATCHES TABLE CHAR THE FIRST 8      29874021
         BCR   NOTHI,R1        OF R1 WILL BE ZERO AND THE OTHER 24      29880021
         LA    R3,DX4(R0,R3)  HAVE ADDRESS OF CHAR ROUTINE              29886021
         BCT   R5,BLOADR      NO MATCH INCREMENT AND TRY NEXT           29892021
         BC    UNCOND,BMIST1  ILLEGAL REPORT PICTURE CHARACTER          29898021
BNOTEM   CLC   DX1(LX1,R6),BDECCH CURRENT PICT CHAR EQUAL TO CHAR AFTER 29904021
         BC    EQ,BFCBYT      YES            ACTUAL DECIMAL POINT       29910021
         LA    R1,BDECTB+NX5   NO  LOAD ADDRESS OF NUMERIC TABLE INT    29916021
         LA    R3,DX3(R0,R0)   LOAD 3 COUNT FOR COMPARE LOOP            29922021
BCMPAR   CLC   DX1(LX1,R6),DX0(R1) IF CURRENT CHARACTER IS Z,ASTERISK   29928021
         BC    EQ,BMISTK        OR NINE THERE IS AN ERROR - ALL NUM     29934021
         BCTR  R1,R0               SUBT 1 FROM CONTENTS OF REG 1        29940021
         BCT   R3,BCMPAR         CHARACTERS TO REGHT OF ACT. DEC. P     29946021
         BC    UNCOND,BFCBYT      ARE NOT THE SAME                      29952021
BDECON   LA    R1,BDECTB+NX5                                            29958021
         LA    R3,DX6(R0,R0)                                            29964021
BCPARE   CLC   DX1(LX1,R6),DX0(R1) IF CURRENT CHARACTER IS A NUMERIC    29970021
         BC    EQ,BMVDEC       LOAD IT INTO FIRST CHARACTER AFTER       29976021
       BCTR  R1,R0                 SUBT 1 FROM REG 1                    29982021
         BCT   R3,BCPARE        DECIMAL POINT BYTE                      29988021
         BC    UNCOND,BFCBYT       BRH,CHK IF 1ST CHR BYTE EMPTY        29994021
BMVDEC   MVC   BDECCH(LX1),DX1(R6)                                      30000021
         BC    UNCOND,BFCBYT       BRH,CHK IF 1ST CHR BYTE EMPTY        30006021
BFEMPT   MVC   BFIRST(LX1),DX1(R6)                                      30012021
         BC    UNCOND,BFINDR       GO SET UP REG 5 AS LOOP CTR          30018021
* CHARACTER IS  $        DOLLAR SIGN                                    30024021
BDOLLR   LH    R3,DX2(R0,R2)  GET $ COUNT                               30030021
         C     R3,ONE         MORE THAN 1 $                             30036021
         BC    HI,BFLDOL      YES GO TO $ FLOATING STRING ROUTINE       30042021
         CLC   BFLTST(LX1),DX1(R6)                                      30048021
       BC    EQ,BFLDOL             BR ON =,CHK FOR FIXED $              30054021
         TM    BREPSW,XX80     NO, HAS $ APPEARED BEFORE                30060021
         BZ    BDOLLA              NO                                   30066021
         TM    BREPSW,XX7F          HAS ANYTHING ELSE APPEARED          30072021
         BZ    BDOLLA              NO                                   30078021
         B     BMIST2              YES, ERROR                           30084021
BDOLLA   EQU   *                                                        30090021
         LA    R8,DX1(R0,R8)  ADD ONT TO TOTAL LGN                      30096021
         BAL   R1,BTLCHK      CALL TOTAL LENGTH CHECK ROUTINE           30102021
         OI    BREPSW,XX80     TURN ON $ BIT SWITCH                     30108021
         BC    UNCOND,BGOGET       BRH TO BGOGET                        30114021
BFLDOL   TM    BREPSW,XX80     HAS FIXED $ APPEARED                     30120021
         BZ    BDOLL1              NO                                   30126021
         TM    BREPSW,XX7F          HAS ANYTHING ELSE APPEARED          30132021
         BZ    BDOLL1              NO, IT IS FLOATING                   30138021
         B     BMIST2              YES, ERROR                           30144021
BDOLL1   SR    R5,R5                                                    30150021
         IC    R5,DX1(R0,R6)  INSERT CURRENT PICTURE CHAR INTO REG 5    30156021
         TM    BREPSW,XX0B     NO, IS 9, Z, OR * TO8LEFT OF FLOAT ST    30162021
         BC    NOTZER,BMIST5  YES                                       30168021
         TM    BREPSW+NX1,XX08 NO, IF PNV AND NUMERIC SWITCHES ARE B    30174021
         BC    ZERO,BFTEST          ON THEN THE ERROR OF P'S ENCLOS     30180021
         TM    BREPSW+NX1,XX02        BY NUMERICS IS PRESENT            30186021
         BC    ONES,BMIST6         1S,BR TO P'S ILLEGAL POS RTN         30192021
BFTEST   CLI   BFLTST,XX00     HAS A FLOATING STRING APPEARED           30198021
         BC    EQ,BSETST      NO                                        30204021
         EX    R5,BCFLOT      YES,EXECUTE A COMPARE OF FLOAT STRING     30210021
         BC    NOTEQ,BMIST7    CHAR AND CURRENT CHARACTER               30216021
         BC    UNCOND,*+NX8    EQUAL                                    30222021
BSETST   EX    R5,BMFLOT      EXECUTE-LAOD CURRENT CHAR INTO FLOAT      30228021
         TM    BREPSW+NX1,XX20 IS N-1 SWTICH ON                         30234021
         BC    ONES,BADDOL    YES                                       30240021
         OI    BREPSW+NX1,XX20 TURN ON N-1 SWITCH                       30246021
       BCTR  R3,R0           NO,DECREMENT = COUNT BY 1                  30252021
         AR    R12,R3         ADD COUNT TO NUMERIC LENGTH               30258021
         BAL   R1,BNUMCK      CALL NUMERIC LGN CHECK RTN                30264021
         LA    R3,DX1(R0,R3)  RESTORE COUNR                             30270021
         BC    UNCOND,BADDOL+NX6   BRH TO ADD CT TO TOTAL LGN           30276021
BADDOL   AR    R12,R3         ADD COUNT TO NUMERIC LENGTH               30282021
         BAL   R1,BNUMCK      CALL  NUMERIC LENGTH CHECK ROUTINE        30288021
         AR    R8,R3          ADD COUNT TO TOTAL LGN                    30294021
         TM    BREPSW+NX1,XX01      IS DECIMAL SW ON                    30300021
         BC    NOTONE,BADDO1       NO                                   30306021
         MVI   DX1(R6),XC9          YES, CHANGE CHAR TO 9               30312021
         BAL   R1,BTLCHK           CALL TOTAL LGN CHECK                 30318021
         AR    R10,R3              ADD COUNT TO SCALE                   30324021
         BC    UNCOND,BTURNR       BR TO TURN ON NUMERIC SW             30330021
BADDO1   BAL   R1,BTLCHK           LNK TO CHK IF TOT LGN > 127          30336021
BTURNR   OI    BREPSW+NX1,XX02 TURN ON NUMERIC SWITCH                   30342021
         NI    BREPSW+NX1,XXF7 TURN OFF PNV SWITCH                      30348021
         BC    UNCOND,BGOGET       BRH TO BGOGET                        30354021
BCFLOT   CLI   BFLTST,XX00                                              30360021
BMFLOT   MVI   BFLTST,XX00                                              30366021
* CHARACTER IS  *        ASTERISK                                       30372021
BASTSK   TM    BREPSW,XX02     HAS ZERO SUPPRESSION CHAR APPEARED       30378021
         BC    ONES,BMIST8    YES  ASTERISK AFTER ZERO SUPPRESSION(     30384021
         BC    UNCOND,BZSUPB  NO                                        30390021
* CHARACTER IS  Z        ZERO SUPPRESSION                               30396021
BZUPP    TM    BREPSW,XX01     HAS ASTERISK APPEARED                    30402021
         BC    ONES,BMIST8         YES, ERROR  Z AFTER *                30408021
BZSUPB   TM    BREPSW,XX08     NO, HAS 9 APPEARED                       30414021
         BC    ONES,BMISTA    YES   ERROR 9 TO LEFT OF AST OR Z         30420021
         CLI   BFLTST,XX00     NO, HAS FLOATING STRING APPEARED         30426021
         BC    NOTEQ,BMISTB   YES  ERROR STRING TO LEFT OF AST OR Z     30432021
         TM    BREPSW+NX1,XX08 NO, IS PNV SWITCH ON                     30438021
         BC    ZERO,BGETCT    NO                                        30444021
         TM    BREPSW+NX1,XX02 YES IS NUMERIC SWITCH ON                 30450021
         BC    UNCOND,BMIST6  YES                                       30456021
BGETCT   LH    R3,DX2(R0,R2)  YES, GET * OR Z COUNT                     30462021
         AR    R12,R3                                                   30468021
         BAL   R1,BNUMCK           BR TO LOAD 18 INTO REG 5             30474021
         AR    R8,R3          ADD COUNT TO TOTAL LGN                    30480021
         TM    BREPSW+NX1,XX01      IS DECIMAL SW ON                    30486021
         BC    NOTONE,BGETC1       NO                                   30492021
         MVC   FULLWD(LX1),DX1(R6)   YES SAVE * OR Z                    30498021
         MVI   DX1(R6),XC9           AND REPLACE IT WITH 9 SO 9'S WI    30504021
         BAL   R1,BTLCHK            BE PUT IN ATTRIBUTES AFTER DEC.     30510021
         MVC   DX1(LX1,R6),FULLWD    CALL TOTAL LGN CHECK               30516021
         AR    R10,R3              ADD COUNT TO SCALE                   30522021
         BC    UNCOND,BGETC2       BR AND CK FOR PICT CHR 0 SUPPR       30528021
BGETC1   BAL   R1,BTLCHK           CALL TOTAL LGN CHECK                 30534021
BGETC2   CLI   DX1(R6),XCZ          IS PICT CHAR ZERO SUPPRESSION       30540021
         BC    EQ,BORZSW      YES                                       30546021
         OI    BREPSW,XX01     NO,TURN ON ASTERISK SWITCH               30552021
         BC    UNCOND,BTURNR       BRH TO TURN ON NUMERIC SWITCH        30558021
BORZSW   OI    BREPSW,XX02                                              30564021
         BC    UNCOND,BTURNR       BRH TO TURN ON NUMERIC SWITCH        30570021
* CHARACTER IS  9        NINE                                           30576021
BNINEB   TM    BREPSW+NX1,XX08 IS PNV SWITCH ON                         30582021
         BC    ZERO,BNINEC    NO                                        30588021
         TM    BREPSW+NX1,XX02 YES, IS NUMERIC SW ON                    30594021
         BC    ONES,BMIST6         IF NUMERIC SW ON, GO TO BMIST6       30600021
BNINEC   LH    R3,DX2(R0,R2)  NO , GET  9 COUNT                         30606021
         AR    R12,R3         ADD COUNT TO NUMERIC LENGTH               30612021
         BAL   R1,BNUMCK           LNK TO LOAD 18 INTO REG 5            30618021
         AR    R8,R3                                                    30624021
         BAL   R1,BTLCHK      CALL TOTAL LENGTH CHECK ROUTINE           30630021
         TM    BREPSW+NX1,XX01 IS DECIMAL SW ON                         30636021
         BC    ZERO,BSET9B    NO                                        30642021
         AR    R10,R3         ADD 9 COUNT TO SCALE                      30648021
BSET9B   OI    BREPSW,XX08     TURN ON 9 SWITCH                         30654021
         BC    UNCOND,BTURNR       BR TO TURN ON NUMERIC SWITCH         30660021
BSCALB   SR    R5,R5                                                    30666021
* CHARACTER IS  P        SCALE CAHRACTER                                30672021
         IC    R5,BREPSW+NX1                                            30678021
         N     R5,MK3032      ZERO OUT ALL SWITCHES EXCEPT PND          30684021
         C     R5,ZEROS                                                 30690021
         BC    EQ,BSETAV      IF PND IS ZERO SET ASSUMED V SWITCH O     30696021
BXTABD   LA    R7,BRPTAB                                                30702021
BXTABR   AR    R5,R7                                                    30708021
         CLI   DX0(R5),XX01    COMPARE TABLE VALUE TO ONE               30714021
         BC    LO,BMIST6           L.T. 1  IF P PLACEMENT ERROR         30720021
         BC    EQ,BADPPS      EQUAL TO ONE                              30726021
         CLI   DX0(R5),XX03    GREATER THAN ONE                         30732021
         BC    EQ,BEQTHR           TABLE VAL=3,PNW SW ON ?              30738021
BNEGSC   OI    BREPSW+NX1,XX10 GET P COUNT AND                          30744021
BADPPS   LH    R5,DX2(R0,R2)   ADD TO SCALE                             30750021
         AR    R10,R5         SET SCALE SW ON SIGNIFYING MINUS          30756021
         OI    BREPSW+NX1,XX0C TURN ON P AND PNV SWITCH                 30762021
         S     R4,TWO                                                   30768021
         BC    UNCOND,BGOGET       BRH TO BGOGET                        30774021
BSETAV   OI    BREPSW,XX20     TURN ON ASSUMED DEC PT SW                30780021
         OI    BREPSW+NX1,XX01 TURN ON DECIMAL SWITCH                   30786021
         BC    UNCOND,BXTABD       BR, LOAD ADDR OF BRPTAB IN R7        30792021
BEQTHR   TM    BREPSW+NX1,XX08 PNV ON                                   30798021
         BC    NOTONE,BMIST6       NO                                   30804021
         TM    BREPSW+NX1,XX02 YES, IS NUM SW ON                        30810021
         BC    NOTONE,BADPPS  NO                                        30816021
         BC    UNCOND,BNEGSC  YES                                       30822021
* CHARACTER IS  , 0 B    COMMA  ZERO  BLANK                             30828021
BZEROB   LH    R3,DX2(R0,R2)  GET COUNT OF COMMA(,),ZERO(0) OR BLANK    30834021
         AR    R8,R3                                                    30840021
         CLI   DX1(R6),XCB          IF CHAR IS B REPLACE WITH BLANK     30846021
         BC    NOTEQ,*+NX8          NO                                  30852021
         MVI   DX1(R6),XX40         YES                                 30858021
         BAL   R1,BTLCHK      CALL TOTAL LENGTH CHECK ROUTINE           30864021
         BC    UNCOND,BGOGET       BR TO BGOGET                         30870021
* CHARACTER IS  . V      ACTUAL OR IMPLIED DECIMAL POINT                30876021
BVVVVB   TM    BREPSW,XX14     TEST FOR PRESENCE OF . OR V              30882021
         BC    NOTZER,BMISTD  . OR V IS PRESENT                         30888021
         TM    BREPSW,XX20     . OR V NOT PRESENT, IS ASSUMED V PRES    30894021
         BC    ONES,BMISTE    YES, ERROR                                30900021
         LH    R3,DX2(R0,R2)                                            30906021
         OI    BREPSW+NX1,XX01                                          30912021
         BCT   R3,BTRNC1           R3 - 1, IF 0 GO TO BTRNC1            30918021
         LA    R3,DX1(R0,R0)                                            30924021
BMDONE   CLI   DX1(R6),XCV                                              30930021
         BC    NOTEQ,BPERB    ACTUAL DECIMAL POINT                      30936021
         S     R4,TWO                                                   30942021
         OI    BREPSW,XX10     TURN ON V SW                             30948021
         BC    UNCOND,BGOGET       BRANCH TO BGOGET                     30954021
BTRNC1   LA    R0,DX23(R0,R0)                                           30960021
         BC    UNCOND,BMDONE       BRH TO CHK FOR DECIMAL POINT         30966021
BPERB    OI    BREPSW,XX04     TURN ON . SW                             30972021
         LA    R8,DX1(R0,R8)  ADD ONE TO TOTAL LGN                      30978021
         BAL   R1,BTLCHK      CALL TOTAL LENGTH CHECK ROUTINE           30984021
         BC    UNCOND,BGOGET       BRANCH TO BGOGET                     30990021
* CHARACTER IS  C(R)     CREDIT                                         30996021
BCREDB   TM    BREPSW+NX1,XX40 IS DB SWITCH ON (DEBIT)                  31002021
         BC    ONES,BMISTF    YES, ERROR CR AND DB                      31008021
         BC    UNCOND,BTSTSN       BRH TO TEST FOR SIGN                 31014021
* CHARACTER IS  D(B)     DEBIT                                          31020021
BDEBIT   TM    BREPSW+NX1,XX80 IS CREDIT SWITCH ON (CR)                 31026021
         BC    ONES,BMISTF    YES, ERROR                                31032021
BTSTSN   TM    BREPSW,XX40     IS A SIGN PRESENT                        31038021
         BC    NOTZER,BMISTG  YES, ERROR  CR OR DB WITH SIGN            31044021
         C     R9,TWO         NO, IS CR LAST TWO CHARS                  31050021
         BC    NOTEQ,BMISTH   NO                                        31056021
         LA    R8,DX2(R0,R8)  ADD TWO TO TOTAL LGN                      31062021
         BAL   R1,BTLCHK      CALL TOTAL LENGTH CHECK ROUTINE           31068021
         CLI   DX1(R6),XCC                                              31074021
         BC    EQ,MVCRED           CHAR=C,MOVE CR TO ATTRIBUTES         31080021
         MVC   DX0(LX2,R4),DEBIT MOVE DB TO ATTRIBUTES                  31086021
         BC    UNCOND,B2CHAR       BR TO DECR REG 9 BY 1                31092021
MVCRED   MVC   DX0(LX2,R4),CREDIT MOVE CR TO ATTRIBUTES                 31098021
B2CHAR BCTR  R9,R0           DECREMENT BY 1 SINCE CR AND DB ARE 2 B     31104021
         BC    UNCOND,BGOGET       BRANCH TO BGOGET                     31110021
* CHARACTER IS  + -      PLUS OR MINUS SIGN                             31116021
BPLUSB   LH    R3,DX2(R0,R2)  GET COUNT OF SIGN CHARACTER               31122021
         C     R3,ONE         IS COUNT =1 ,FLOATING STRING              31128021
         BC    HI,BFLDOL      YES                                       31134021
         CLC   BFLTST(LX1),DX1(R6)   IS IT SAME AS FLT       *****      31140021
       BC    EQ,BFLDOL             YES                     *****        31146021
         TM    BREPSW,XX40     NO, IS + OR - SIGN SW ON                 31152021
         BC    NOTZER,BMIST2       YES, ERROR- 2 SIGNS                  31158021
         CLC   DX1(LX1,R6),BFIRST NO, IS SIGN CHAR EQUAL TO FIRST CHAR  31164021
         BC    EQ,BLOADS      YES                                       31170021
         BCT   R9,BMISTI      NO, IS SIGN CHAR LAST CHAR,BRANCH IF      31176021
         LA    R9,DX1(R9,R0)  RESTORE PICTURE CHARACTER COUNT           31182021
BLOADS   LA    R8,DX1(R0,R8)  ADD ONE TO TOTAL LGN                      31188021
         BAL   R1,BTLCHK      CALL TOTAL LENGTH CHECK ROUTINE           31194021
         OI    BREPSW,XX40     SET SIGN SWITCH ON                       31200021
         BC    UNCOND,BGOGET       BRANCH TO BGOGET                     31206021
BTLCHK   C     R8,MK2632      IS TOTAL LGN GREATER THAN 127             31212021
         BC    NOTHI,BMVRCH   NO                                        31218021
         BC    UNCOND,BMISTT  YES, ERROR                                31224021
BMVRCH   S     R4,TWO         DECREMENT REPCHR INDEX BY 2               31230021
         CLC   DX0(LX1,R4),DX1(R6) IS LAST REPCHR CHAR SAME AS CURRENT  31236021
         BC    EQ,BRSAME      YES                                       31242021
         LA    R4,DX2(R4,R0)  NO, RESTORE REPCHR INDEX                  31248021
         STC   R3,DX1(R4)      STORE PICTURE CHAR COUNT IN ATTRIBUTE    31254021
         MVC   DX0(LX1,R4),DX1(R6) MOVE PICTURE CHAR TO ATTRIBUTES      31260021
BTLEND   BCR   UNCOND,R1      RETURN TO CALLER                          31266021
BRSAME   SR    R5,R5                                                    31272021
         IC    R5,DX1(R0,R4)  GET LAST CHAR COUNT                       31278021
         AR    R5,R3          ADD IT TO CURRENT CHAR COUNT              31284021
         STC   R5,DX1(R4)      STORE TOTAL COUNT IN ATTRIBUTES          31290021
         BC    UNCOND,BTLEND       RETURN TO CALLER                     31296021
BNUMCK   LA    R5,DX18(R0,R0)  LOAD 18 IN REG 5                         31302021
         CR    R12,R5         IS NUM LGN GREATER THAN 18                31308021
         BCR   NOTHI,R1       NO                                        31314021
         BC    UNCOND,BMISTN  YES,  ERROR                               31320021
BGOGET   BCT   R9,BNEXTR           R9-1=0,GO PT REGS TO NEXT CHR        31326021
         L     R5,BSAVE4      R5 IS ADRESS OF REPORT CHARACTERS         31332021
         LA    R4,DX2(R4,R0)                                            31338021
         SR    R4,R5          R4-R5 HAS  NUMBER OF REPORT CHARS         31344021
         SR    R7,R7                                                    31350021
         IC    R7,VILGN       R7 HAS TEMPORARY ATTRIBUTE COUNT          31356021
         AR    R7,R4                                                    31362021
         STC   R7,VILGN       STORE TOTAL ATTRIBUTE LENGTH              31368021
         S     R5,THREE       SERT R5 TO ADDRESS OF NUMERIC LGN         31374021
         STC   R8,DX2(R0,R5)  STORE TOTAL LGN IN ATTRIBUTES             31380021
         STH   R8,CILGN       STORE TOTAL LGN IN  CI FIELD              31386021
         STC   R12,DX0(R0,R5) STORE NUMERIC LENGTH IN ATTRIBUTES        31392021
         TM    BREPSW+NX1,XX10 IS SCALE NEGATIVE                        31398021
         BC    ZERO,BSETSC    NO                                        31404021
         A     R10,CON128     YES, SET SIGN IN SCALE MAGNITUDE          31410021
BSETSC   STC   R10,DX1(R0,R5) STORE SCALE IN ATTRIBUTES                 31416021
         TM    ITMCLS,XX80          IS BLANK WHEN ZERO SPEC'D           31422021
         BC    NOTONE,BNOBWZ       NO                                   31428021
         OI    DX0(R5),XX80         YES                                 31434021
         TM    BREPSW,XX01          ANY Z'S                             31440021
         BZ    BNOBWZ              NO Z'S, GO TO BNOBWZ,CHK FOR *       31446021
         BAL   R4,BMISTZ           LNK TO SET UP FOR ERROR RTN          31452021
         DC    X'00C7'                                                  31458021
BNOBWZ   TM    BREPSW,XX02          ANY Z'S                             31464021
         BC    ONES,BWZCHK    YES                                       31470021
         TM    BREPSW,XX01     NO, IS ASTERISK PRESENT                  31476021
         BC    ONES,BASTWZ    YES                                       31482021
         CLI   BFLTST,XX00     NO, IS FLOATING STRING PRESENT           31488021
         BC    NOTEQ,BWZCHK+NX4    BRH TO TEST IF 9 PRESENT             31494021
         TM    BREPSW+NX1,XX02 NO, IS THERE A NUMERIC CHAR IN PICTUR    31500021
         BC    NOTONE,BNONUM  NO, ERROR,NO NUMERICS                     31506021
         BC    UNCOND,BLEAVR  TEMPORARY END                             31512021
BWZCHK   OI    LEVNUM,XX01     SET STARZ TO ONE                         31518021
         TM    BREPSW,XX08     IS 9 PRESENT                             31524021
         BC    ONES,BLEAVR    YES  TEMP                                 31530021
         OI    DX0(R5),XX80    SET BWZ BIT ON IN ATTRIBUTES             31536021
         BC    UNCOND,BLEAVR  TEMP                            ATTRI     31542021
*                                                                       31548021
BASTWZ   OI    LEVNUM,XX01     SET STARZ TO ONE                         31554021
         TM    BREPSW,XX08     IS 9 PRESENT                             31560021
         BC    ONES,BLEAVR    YES   TEMP                                31566021
         OI    DX0(R5),XX40    NO, SET ASTERISK WHEN ZERO BIT ON        31572021
         TM    ITMCLS,XX80     IS  BWZ GIVEN                            31578021
         BZ    BLEAVR              TEMP                                 31584021
         BAL   R4,BMISTZ           LNK TO SET UP FOR ERROR RTN          31590021
         DC    X'00C7'                                                  31596021
         B     BLEAVR              TEMP                                 31602021
BNEXTR   LA    R2,DX2(R0,R2)  INCREMENT REGISTERS FOR NEXT CHARACTER    31608021
         LA    R6,DX1(R0,R6)  ANALYSIS                                  31614021
         LA    R4,DX2(R0,R4)                                            31620021
         BC    UNCOND,BREPOT       BRH TO CHK BYTE AFTER DEC PT         31626021
BDRPPR   LH    R0,DX0(R4)           REG 0= ERROR =                      31632021
         NI    MINCOD,XX0F     CLEAR MINOR CODE FIELD                   31638021
         SR    R15,R15             REG 15=0 IS RETURN ERROR CODE        31644021
         LM    R1,R14,RSAVE+NX4                                         31650021
         BR    R14                 RETURN TO CALLING RTN                31656021
BLEAVR   NI    COUNT,XX0F           CLEAR COUNT FIELD                   31662021
BLEAVS   LM    R1,R14,RSAVE+NX4     RETURN TO CALLER                    31668021
         BCR   UNCOND,R14     RETURN TO CALLER WITH ERROR CODE          31674021
BDRPRP   LH    R0,DX0(R4)                                               31680021
         ST    R15,TSAVER                                               31686021
         L     R15,AERRTN                                               31692021
         BALR  R14,R15             LINK TO ERRRTN                       31698021
         L     R15,TSAVER                                               31704021
         CLI   DX1(R4),XX25         IF BWZ CLAUSE ERROR                 31710021
         BC    NOTEQ,BDRPR1         TURN OFF AND RETURN TO -BNOBWZ-     31716021
         NI    ITMCLS,XX7F                                              31722021
         BC    UNCOND,BNOBWZ       BRH TO CHK FOR Z'S                   31728021
BDRPR1   MVC   IPT(LX2),BFIXCN      REPLACE PICTURE BY 9(1)             31734021
         MVC   IPLT(LX4),BFIXCN+NX2                                     31740021
         BC    UNCOND,BREPOR+NX4   GO TO 2ND INST IN REP ANAL RT        31746021
BMIST1   BAL   R4,BDRPRP                ILLEGAL REPORT CHARACTER        31752021
         DC    X'2075'             MSG 117                              31758021
BMIST2   BAL   R4,BDRPRP           86   2 FIXED $+-OR $ USED AS FIX     31764021
         DC    X'1056'             CHAR. AND FLOATING STRING            31770021
BMIST5   BAL   R4,BDRPRP           89   9,Z, OR * TO LEFT OF FLOATI     31776021
         DC    X'1059'             STRING                               31782021
BMIST6   BAL   R4,BDRPRP           90   P'S ARE IN ILLEGAL POSITION     31788021
         DC    X'105A'                                                  31794021
BMIST7   BAL   R4,BDRPRP           91   2 DIFFERENT FLOATING STRING     31800021
       DC    X'105B'             CHARACTERS                             31806021
BMIST8   BAL   R4,BDRPRP           92   Z AND * IN SAME PICTURE         31812021
         DC    X'105C'                                                  31818021
BMISTA   BAL   R4,BDRPRP           93   9 PRECEDES * OR Z               31824021
         DC    X'105D'                                                  31830021
BMISTB   BAL   R4,BDRPRP           94   STRING PRECEDES * OR Z          31836021
         DC    X'105E'                                                  31842021
BMISTD   BAL   R4,BDRPRP           96   2 DECIMAL POINTS OR V'S         31848021
         DC    X'1060'                                                  31854021
BMISTE   BAL   R4,BDRPRP           97   DECIMAL POINT OR V DOES NOT     31860021
         DC    X'1061'             LINE UP WITH P'S                     31866021
BMISTF   BAL   R4,BDRPRP           98   CR AND DB BOTH USED             31872021
         DC    X'1062'                                                  31878021
BMISTG   BAL   R4,BDRPRP           99   CR OR DB  AND SIGN USED         31884021
         DC    X'1063'                                                  31890021
BMISTH   BAL   R4,BDRPRP           100  CR OR DB NOT LAST 2 CHARACT     31896021
         DC    X'1064'             IN THE PICTURE                       31902021
BMISTI   BAL   R4,BDRPRP           101  SIGN IS NOT FIRST OR LAST       31908021
         DC    X'1065'             CHARACTER IN PICTURE                 31914021
BMISTK   BAL   R4,BDRPRP           102  NUMERIC CHARS AFTER DECIMAL     31920021
         DC    X'1066'             ARE NOT SAME                         31926021
BMISTT   BAL   R4,BDRPRP           103  TOTAL LGN G.T. 127              31932021
         DC    X'1067'                                                  31938021
BMISTN   BAL   R4,BDRPRP           104  NUMERIC LGN G.T. 18             31944021
         DC    X'1068'                                                  31950021
BNONUM   BAL   R4,BDRPRP           NO NUMERICS IN PICTURE               31956021
         DC    X'10CB'             MSG 203                              31962021
BMISTP   BAL   R4,BDRPRP           ERROR                                31968021
         DC    X'10BC'             MSG 188                              31974021
BMISTZ   LH    R0,DX0(R4)                                               31980021
         ST    R15,TSAVER                                               31986021
         L     R15,AERRTN                                               31992021
         BALR  R14,R15             LINK TO ERRRTN                       31998021
         L     R15,TSAVER                                               32004021
         NI    ITMCLS,XX7F          TURN OFF BLANK WHEN ZERO            32010021
         NI    DX0(R5),XX7F         IN ATTRIB TOO                       32016021
         LA    R4,DX2(R4)                                               32022021
         BR    R4                  BRANCH TO ADDR IN REG 4              32028021
         EJECT                                                          32034021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       32040021
*                                                                       32046021
*                                                                       32052021
*                                                                       32058021
*                          B A N R P T                                  32064021
*                                                                       32070021
*                                                                       32076021
*FUNCTION/OPERATION.  ALPHA-NUMERIC EDITED PICTURE ANALYSIS             32082021
*    MAKES SURE USAGE IS DISPLAY                                        32088021
*    CHANGES 9'S TO X'S                                                 32094021
*            B   TO BLANKS                                              32100021
*            A'S TO X'S                                                 32106021
*                                                                       32112021
*                                                                       32118021
*                                                                       32124021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       32130021
         USING *,R15                                                    32136021
BANRPT   STM   R1,R14,RSAVE+NX4                                         32142021
         SR    R10,R10                                                  32148021
         SR    R9,R9                                                    32154021
         IC    R9,ITMCLS           INSERT CLAUSE CODES                  32160021
         N     R9,MK3032           ZERO OUT ALL BUT USAGE CODES         32166021
         C     R9,ONE              IS USAGE DISPLAY                     32172021
         BE    BAN010              YES                                  32178021
         BAL   R8,BANERR           NO, ERROR                            32184021
         DC    X'006B'             MSG 107  USAGE NOT DISPLAY           32190021
BAN010   OI    MINCOD,XXE0          SET MINOR CODE                      32196021
         SR    R9,R9                                                    32202021
         IC    R9,IPT              GET PICTURE CHARACTER COUNT          32208021
         LA    R6,IPT+NX1           REG 6 IS IPT INDEX                  32214021
         LA    R2,IPLT+NX2          REG 2 IS IPLT INDEX                 32220021
         LA    R4,VILGN+NX1                                             32226021
         TM    COUNT,XX30           OCCURS PTR PRESENT                  32232021
         BM    BAN020              NO                                   32238021
         MVI   VILGN,XX06           YES, LEAVE ROOM FOR                 32244021
         LA    R4,DX3(R4)           BUMP PTR                            32250021
         B     BAN025              BRH TO SAVE LENGTH                   32256021
BAN020   MVI   VILGN,XX03           FIXED LENGTH                        32262021
BAN025   MVC   DX1(LX2,R4),IPLT      SAVE LENGTH                        32268021
         MVC   CILGN(LX2),IPLT      SAVE LENGTH                         32274021
         NI    COUNT,XX0F           TRUN OFF COUNT FIELD                32280021
BAN030   CLI   DX0(R6),XXF9         IS IT 9                             32286021
         BNE   BAN040              NO                                   32292021
         MVI   DX0(R6),XCX          MAKE IT X                           32298021
         B     BAN060              BRH TO CHK IF CHR= LAST CHR          32304021
BAN040   CLI   DX0(R6),XCB          IS IT B                             32310021
         BNE   BAN050              NO                                   32316021
         MVI   DX0(R6),XX40         MAKE IT BLANK                       32322021
         B     BAN060              BRH TO CHK IF CHR= LAST CHR          32328021
BAN050   CLI   DX0(R6),XCA          IS IT A                             32334021
         BNE   BAN055              NO                                   32340021
         MVI   DX0(R6),XCX          MAKE IT X                           32346021
         B     BAN060              BRH TO CHK IF CHR= LAST CHR          32352021
BAN055   CLI   DX0(R6),XXF0         IS IT ZERO                          32358021
         BE    BAN060              YES                                  32364021
         CLI   DX0(R6),XCX          IS IT X                             32370021
         BE    BAN060              YES                                  32376021
         BAL   R8,BANERR           GO GENERATE                          32382021
         DC    X'10C8'             MSG 200                              32388021
BAN060   CLC   DX0(LX1,R4),DX0(R6)   SAME AS LAST CHAR                  32394021
         BNE   BAN080              NO                                   32400021
         MVC   BANSAV(LX2),DX0(R2)   COUNT OF CURRENT                   32406021
         LH    R3,BANSAV                                                32412021
         MVC   BANSAV(LX2),DX1(R4)   COUNT OF LAST                      32418021
         AH    R3,BANSAV           TOTAL COUNT                          32424021
         STH   R3,BANSAV                                                32430021
         MVC   DX1(LX2,R4),BANSAV    UPDATE TOTAL                       32436021
         B     BAN090              BRH TO CHK IF ANY MORE CHRS          32442021
BAN080   LA    R4,DX3(R4)           BUMP PTR                            32448021
         MVC   DX0(LX1,R4),DX0(R6)   MOVE KIND OF CHAR                  32454021
         MVC   DX1(LX2,R4),DX0(R2)   MOVE NUM OF CHARS                  32460021
         LA    R10,DX3(R10)         BUMP CTR                            32466021
BAN090   LA    R6,DX1(R6)                                               32472021
         LA    R2,DX2(R2)                         COUNT                 32478021
         BCT   R9,BAN030           ANY MORE CHARS                       32484021
         SR    R6,R6                                                    32490021
         IC    R6,VILGN            COUNT OF CHARS                       32496021
         AR    R10,R6              TOTAL COUNT                          32502021
         STC   R10,VILGN           STORE TOTAL                          32508021
         LM    R1,R14,RSAVE+NX4                                         32514021
         BR    R14                 RETURN                               32520021
BANERR   EQU    *                                                       32526021
         LH    R0,DX0(R8)           MSG NUMBER                          32532021
         ST    R15,TSAVER                                               32538021
         L     R15,AERRTN                                               32544021
         BALR  R14,R15             GO GENERATE MSG                      32550021
         L     R15,TSAVER                                               32556021
         LA    R8,DX2(R8)           BUMP PAST CODE                      32562021
         BR    R8                  RETURN TO CALLER                     32568021
         EJECT                                                          32574021
*=2      STERLING NON-REPORT PICTURE ANALYSIS-BSTERL                    32580021
       USING *,R15                                                      32586021
BSTERL   STM   R1,R14,RSAVE+NX4     SAVE REGS                           32592021
         SR    R6,R6               R6 IS TOTAL LENGTH                   32598021
         SR    R3,R3                                                    32604021
         SR    R7,R7               R7                                   32610021
         IC    R3,ITMCLS           IS USAGE                             32616021
         SR    R8,R8                                                    32622021
         N     R3,MK3032              DISPLAY                           32628021
         C     R3,SIX              IS USAGE DISPLAY-ST                  32634021
         BC    EQ,BSTRL1           YES                                  32640021
         LA    R0,DX61              NO      E-MSG 61                    32646021
         SR    R15,R15                                                  32652021
         LM    R1,R14,RSAVE+NX4     RESTORE REGS                        32658021
         BCR   UNCOND,R14          LEAVE                                32664021
BSTRL1   OI    MINCOD,XXD0          INSERT MINOR CODE                   32670021
         XC    BSTRSW(LX2),BSTRSW   CLEAR SWITCHES AND BYTE67           32676021
         LA    R4,IPT              INITIAL PICTURE TABLE                32682021
         LA    R5,IPLT             INITIAL PICTURE LGN TABLE            32688021
         IC    R3,IPT              GET PICTURE CHARACTER COUNT          32694021
BGETST   CLI   DX1(R4),XC9          IS PICTURE CHAR. A    9             32700021
         BC    EQ,BSTNR9           YES                                  32706021
         CLI   DX1(R4),XCV          NO                    V             32712021
         BC    EQ,BSTNRV           YES                                  32718021
         CLI   DX1(R4),XCS          NO                    S             32724021
         BC    EQ,BSTNRS           YES                                  32730021
         CLI   DX1(R4),XC8          NO                    8             32736021
         BC    EQ,BSTNR8           YES                                  32742021
         CLI   DX1(R4),XC7          NO                    7             32748021
         BC    EQ,BSTNR7           YES                                  32754021
         CLI   DX1(R4),XC6          NOS                   6             32760021
         BC    EQ,BSTNR6           YES                                  32766021
         CLI   DX1(R4),XCD          NO                    D             32772021
         BC    EQ,BSTNRD           YES,                                 32778021
         BC    UNCOND,E2           NO, ILLEGAL STERLING NON-REPORT      32784021
BDRPST   LH    R0,DX0(R4)           PUT                                 32790021
         ST    R15,TSAVER           OUT                                 32796021
         L     R15,AERRTN            ERROR                              32802021
         BALR  R14,R15                MESSAGE                           32808021
         L     R15,TSAVER                                               32814021
         XC    VILGN(LX2),VILGN     CLEAR ATTR. SET BEFORE ERROR        32820021
         OI    VILGN+NX1,XX08       SET POUND DIGITS TO 1               32826021
         L     R6,THREE            SET  T.L. = 3                        32832021
         BC    UNCOND,BTOTAL             9D8D7 IS REP. PICTURE          32838021
* CHARACTER IS  V        IMPLIED DECIMAL POINT                          32844021
BSTNRV   TM    BSTRSW,XX37                                              32850021
         BC    NOTONE,E12          ERROR IN POSITION OF V               32856021
         TM    BSTRSW,XX40          2ND 9 APPEARED                      32862021
         BO    E12                 YES, ERROR                           32868021
         TM    BSTRSW,XX80          V APPEARED                          32874021
         BO    E12                 YES, ERROR                           32880021
         BAL   R12,E20             CHECK THAT COUNT=1                   32886021
         OI    BSTRSW,XX80                                              32892021
         BC    UNCOND,BADADD       LEGAL, GO TO ADDRESS INCREMENT       32898021
* CHARACTER IS  D        DELIMITOR                                      32904021
BSTNRD   TM    BSTRSW,XX04          HAS 9 APPEARED                      32910021
         BC    ONES,*+NX8           YES                                 32916021
         BC    UNCOND,E5           NO, ERROR                            32922021
         TM    BSTRSW,XX02          HAS 8 APPEARED                      32928021
         BC    ONES,*+NX12          YES, BRANCH                         32934021
         OI    BSTRSW,XX10          NO, SET POUND SEPARATOR ON          32940021
         BC    UNCOND,BADADD       BRH TO INC INPLT AND IPT PTRS        32946021
         OI    BSTRSW,XX20          SET SHILLING SEPARATOR ON           32952021
         BC    UNCOND,BADADD       BRH TO INC INPLT AND IPT PTRS        32958021
* CHARACTER IS  S        SIGN                                           32964021
BSTNRS   TM    BSTRSW,XX08                                              32970021
         BC    NOTONE,BSTRSN       LEGAL                                32976021
         TM    BSTRSW,XX07                                              32982021
         BC    ZERO,BSTRSN         LEGAL                                32988021
         BC    ONES,BSTRSN         LEGAL                                32994021
         TM    BSTRSW,XX03                                              33000021
         BC    ZERO,BSTRSN         LEGAL                                33006021
         BC    UNCOND,E13          ERROR IN POSITION OF S               33012021
BSTRSN   OI    BSTRSW,XX08          SIGN SIGN BIT TO ONE                33018021
         BAL   R12,E20             CHECK THAT COUNT=1                   33024021
         BC    UNCOND,BADADD       BRH TO INC INPLT AND IPT PTRS        33030021
* CHARACTER IS  9        NINE                                           33036021
BSTNR9   TM    BSTRSW,XX0F          HAVE S,9,8,7/6 ALL APPEARED         33042021
         BC    ONES,BBALL          YES                                  33048021
         BC    ZERO,BALOFF         NO, HAVE NONE APPEARED-YES           33054021
         TM    BSTRSW,XX07                                              33060021
         BC    ONES,BBALL1         9,8,7/6, HAVE APPEARED               33066021
         BC    ZERO,BONLYS         ONLY S HAS APPEARED                  33072021
         CLI   BSTRSW,XX0C                                              33078021
         BC    EQ,BTWOON           S AND 9 HAVE APPEARED                33084021
         BC    UNCOND,E5           ERROR IN POSITION OF 9               33090021
BBALL    OI    BSTRSW,XX40          2ND SET OF NINE                     33096021
         TM    VILGN+NX1,XX07       HAS SIGN POSITION BEEN SET          33102021
         BC    ZERO,BNOSGN         NO                         ATTRI     33108021
BBALL1   OI    BSTRSW,XX40          2ND SET OF NINE                     33114021
         LH    R7,DX2(R5)           GET 9'S COUNT                       33120021
         AR    R6,R7                AND ADD IT TO TOTAL LGN             33126021
         AR    R8,R7                AND ADD IT TO DECIMAL LGN           33132021
         AR    R9,R7               ADD PENCE DEC. TO POUND DIGITS       33138021
         C     R9,CON15            IS IT G.T. 15                        33144021
         BC    HI,E14              YES, ERROR                           33150021
         BC    UNCOND,BADADD       BRH TO INC INPLT AND IPT PTRS        33156021
BNOSGN   LH    R7,DX2(R0,R5)       GET 9'S COUNT                        33162021
         BCT   R7,E8               IF COUNT NOT 1 ERROR                 33168021
         OI    VILGN+NX1,XX05       SET LOW PENCE DECIMAL SIGN IN AT    33174021
         LA    R7,DX1(R0,R0)                                            33180021
         BC    UNCOND,BBALL1+NX4   BRH TO GET 9'S COUNT                 33186021
BONLYS   OI    VILGN+NX1,XX01       SET HIGH POIND DIGIT SIGN IN ATT    33192021
BALOFF   LH    R7,DX2(R0,R5)       GET 9'S COUNT                        33198021
         AR    R6,R7                 ADD IT TO TOTAL LGN                33204021
         AR    R8,R7                 ADD IT TO POUND DIGIT LGN          33210021
         OI    BSTRSW,XX04          SET 9 SW ON                         33216021
         BC    UNCOND,BADADD       BR TO INCR INPLT AND IPT PTRS        33222021
BTWOON   CLC   DX2(LX2,R5),ONE+NX2   IS THERE ONLY ONE 9                33228021
         BC    NOTEQ,E4            NO, ERROR IN SIGN                    33234021
         OI    VILGN+NX1,XX02       YES, SET LO POUND DIGIT SIGN        33240021
         BC    UNCOND,BALOFF       BRH TO GET 9'S COUNT                 33246021
* CHARACTER IS  8        SHILLING FIELD SYMBOL                          33252021
BSTNR8   C     R8,CON15                                                 33258021
         LR    R9,R8                                                    33264021
         BC    HI,E14              DIGIT LGN TOO HIGH                   33270021
         MVC   BYTESW(LX1),VILGN+NX1 STORE                              33276021
         SLL   R8,DX3                 LGN                               33282021
         STC   R8,VILGN+NX1             IN                              33288021
         OC    VILGN+NX1(LX1),BYTESW       ATTRIBUTES                   33294021
         SR    R8,R8                                                    33300021
         CLI   BSTRSW,XX1C          HAVE S, 9, AND D APPEARED           33306021
         BC    EQ,BHASSN           YES                                  33312021
         CLI   BSTRSW,XX14          NO, HAVE 9 AND D APPEARED           33318021
         BC    NOTEQ,E7            NO, 8 IS IN AN ILLEGAL POSITION      33324021
         BC    EQ,BHOWMN           BR ON = TO CHK HOW MANY 8'S          33330021
BHASSN   TM    VILGN+NX1,XX07       HAS A SIGN BEEN DETERMINED          33336021
         BC    ZERO,BHASNT         NO                                   33342021
BHOWMN   LH    R7,DX2(R0,R5)       YES, HOW MANY 8'S                    33348021
         C     R7,TWO                                                   33354021
         BC    EQ,BTWO8            R7=2, GO SET IBM SHILL REP           33360021
         C     R7,ONE                                                   33366021
         BC    EQ,BONE8            R7=1,GO ADD 8 CT TO TOT LGN          33372021
         BC    UNCOND,E15          THERE CAN ONLY BE 1 OR 2 8'S         33378021
BTWO8    OI    VILGN,XX80           SET IBM SHILLING REP                33384021
BONE8    AR    R6,R7               ADD 8 COUNT TO TOTAL LGN             33390021
         OI    BSTRSW,XX02          SET 8 SW ON                         33396021
         BC    UNCOND,BADADD       BRH TO INCR INPLT AND IPT PTRS       33402021
BHASNT   LH    R7,DX2(R0,R5)       GET 8 COUNT                          33408021
         C     R7,TWO              IS IT 2                              33414021
         BC    NOTEQ,E6            ERROR SIGN ONLY ON HI SHILLING F     33420021
         OI    VILGN+NX1,XX03       YES,SET HI SHILLING SIGN IN   (I    33426021
         BC    UNCOND,BTWO8                               ATTRIBUTE     33432021
* CHARACTER IS  7        PENCE    FIELD SYMBOL                          33438021
BSTNR7   NI    VILGN,XXDF           SET BSI PENCE                       33444021
         BC    UNCOND,*+NX8        GO TEST FOR SHILLING SEP             33450021
* CHARACTER IS  6        PENCE    FIELD SYMBOL                          33456021
BSTNR6   OI    VILGN,XX20           SET IBM PENCE                       33462021
         TM    BSTRSW,XX20          WAS SHILLING SEPARATOR FOUND        33468021
         BC    NOTONE,E19          NO SHILL SEP, PUT OUT ERR MSG        33474021
         TM    BSTRSW,XX01                                              33480021
         BC    ONES,*+NX10         BRH AROUND NXT 2 INSTRS              33486021
         MVC   BYTE67(LX1),DX1(R4)   MOVE 6 OR 7 TO BYTE67              33492021
         TM    BSTRSW,XX06          HAVE   9,8,         APPEARED        33498021
         BC    NOTONE,E9           NO,ERROR                             33504021
         TM    BSTRSW,XX0F          YES, S,9,8,6/7 ALL APPEARED         33510021
         BC    ONES,BEVERY         YES                                  33516021
         TM    BSTRSW,XX0E          NO,  S,9,8                          33522021
         BC    ONES,BISSGN         YES                                  33528021
         TM    BSTRSW,XX01          NO                                  33534021
         BC    ONES,E9             ERROR IN PENCE POSITION              33540021
         BC    UNCOND,BPNCNT       9,8 HAVE ONLY APPEARED               33546021
BISSGN   TM    VILGN+NX1,XX07       HAS A SIGN BEEN SET                 33552021
         BC    ZERO,E8             SIGN NOT SET, PUT OUT ERR MSG        33558021
BPNCNT   LH    R7,DX2(R0,R5)       GET COUNT FOR PENCE                  33564021
         C     R7,ONE              1                                    33570021
         BC    EQ,BSET67           YES                                  33576021
         C     R7,TWO              NO, IS COUNT 2                       33582021
         BC    NOTEQ,E17           NO,ERROR                             33588021
         OI    VILGN,XX40           YES, SET 2 CHAR. PENCE              33594021
BSET67   OI    BSTRSW,XX01          SET 6/7 SW ON                       33600021
         AR    R6,R7               ADD PENCE CHAR CNT TO TOTAL LGN      33606021
         BC    UNCOND,BADADD       BRH TO INCR INPLT AND IPT PTRS       33612021
BEVERY   CLC   BYTE67(LX1),DX1(R4)   IS SECOND PENCE CHAR SAME AS FIR   33618021
         BC    EQ,*+NX8             YES                                 33624021
         BC    UNCOND,*+NX4         NO, TEMP E-TEXT LAST CHAR COUNTS    33630021
         OI    VILGN+NX1,XX04       SET LOW PENCE SIGN IN ATTRIBUTES    33636021
         LH    R7,DX2(R0,R5)                                            33642021
         C     R7,ONE                                                   33648021
         BC    NOTEQ,E11           COUNT NOT ONE                        33654021
         OI    VILGN,XX40           IS ONE--- SET 2 CHAR PENCE          33660021
         AR    R6,R7               ADD PENCE CHAR COUNT TO TOTAL LG     33666021
BADADD   LA    R5,DX2(R0,R5)       INCREMENT INPLT PTR                  33672021
         LA    R4,DX1(R0,R4)       INCREMENT IPT  PTR                   33678021
         BCT   R3,BGETST           LAST CHAR----NO,BRANCH               33684021
         LTR   R8,R8               YES, IS THERE A PENCE DECIMAL        33690021
         BC    NOTPOS,BTOTAL       NOT +,CHK ITM FOR OCCURS D PTR       33696021
         MVC   BYTESW(LX1),VILGN                                        33702021
         STC   R8,VILGN            STORE DECIMAL LGN IN ATTRIBUTES      33708021
         OC    VILGN(LX1),BYTESW                                        33714021
BTOTAL   TM    COUNT,XX30           DOES ITEM HAVE OCCURS DICT. PTR.    33720021
       BM    BNOTSB               NO                                    33726021
         XI    COUNT,XX10          SET COUNT TO 13(STRLNG NON-RPT)      33732021
         STC   R6,VILGN+NX5         STORE TOTAL NUMBER OF CHARS IN A    33738021
         BC    UNCOND,*+NX12       BRH ARND NEXT 3 INSTRUCTIONS         33744021
BNOTSB   XI    COUNT,XX30          SET COUNT TO 10(STRLNG NON-RPT)      33750021
         STC   R6,VILGN+NX2         STORE TOTAL NUMBER OF CHARS IN A    33756021
         STH   R6,CILGN                AND IN CI LENGTH FIELD           33762021
BLVSTN   LM    R1,R14,RSAVE+NX4                                         33768021
         BCR   UNCOND,R14          RETURN TO CALLING PGM                33774021
E2       BAL   R4,BDRPST           ILLEGAL STERLING NON-REPORT CHAR     33780021
         DC    X'109B'             155                                  33786021
E4       BAL   R4,BDRPST           SIGN MUST BE ON HI-LO ORDER DIGI     33792021
         DC    X'1037'             POUND FIELD                          33798021
E5       BAL   R4,BDRPST           9 IN ILLEGAL POSITION                33804021
         DC    X'1038'                                                  33810021
E6       BAL   R4,BDRPST           ILLEGAL SIGN POSITION IN SHILLIN     33816021
         DC    X'1039'                                                  33822021
E7       BAL   R4,BDRPST           8 IN ILLEGAL POSITION                33828021
         DC    X'103A'                                                  33834021
E8       BAL   R4,BDRPST           ILLEGAL SIGN POSITION IN PENCE       33840021
         DC    X'103B'                                                  33846021
E9       BAL   R4,BDRPST           6 OR 7 IN ILLEGAL POSITION           33852021
         DC    X'103C'                                                  33858021
E11      BAL   R4,BDRPST           SIGN NOT ON LO PENCE DIGIT           33864021
         DC    X'103D'                                                  33870021
E12      BAL   R4,BDRPST           V IN ILLEGAL POSITION                33876021
         DC    X'103E'                                                  33882021
E13      BAL   R4,BDRPST           S IN ILLEGAL POSITION                33888021
         DC    X'103F'                                                  33894021
E14      BAL   R4,BDRPST           DIGIT LGN TOO HI                     33900021
         DC    X'1040'                                                  33906021
E15      BAL   R4,BDRPST           SHILLING COUNT G.T. 2                33912021
         DC    X'1041'                                                  33918021
E17      BAL   R4,BDRPST           PENCE COUNT G.T. 2                   33924021
         DC    X'1042'                                                  33930021
E18      BAL   R4,BDRPST           NO POUND SEPARATOR                   33936021
         DC    X'1043'                                                  33942021
E19      BAL   R4,BDRPST           NO SHILLING SEPARATOR                33948021
         DC    X'10CA'             MSG 2202                             33954021
E20      CLC   DX2(LX2,R5),ONE+NX2   IS S OR V COUNT=1                  33960021
         BCR   EQ,R12              YES, RETURN                          33966021
         LA    R0,DX143             NO,PUT OUT WARNING AND ASSUME CO    33972021
         ST    R15,TSAVER           EQUAL TO 1                          33978021
         L     R15,AERRTN                                               33984021
         BALR  R14,R15             LINK TO ERRTN                        33990021
         L     R15,TSAVER                                               33996021
         BCR   UNCOND,R12          RETURN TO CALLING RTN                34002021
         EJECT                                                          34008021
*=1      STERLING REPORT PICTURE ANALYSIS,BSTREP                        34014021
**************                                                          34020021
* BSTREP IS SECTIONDED AS FOLLOWS                                       34026021
**                                                                      34032021
* BSTREP   B STERLING REPORT EDIT OF PICTURE  ROUTINE NAME              34038021
* STREP  EDIT PICTURE FOR DELIMITERS  PARTITION TO L.S.D.SECTIONS       34044021
* STLED  STERLING POUND(L)EDIT                                          34050021
*        EDIT UP TO 1ST DELIM                                           34056021
* STSED  SHILLING EDIT                                                  34062021
* STPED  PENCE EDIT                                                     34068021
* STDED  DECIMAL PENCE EDIT                                             34074021
* STFIN  FINISH FORMING THE ATTRIBUTE TABLE                             34080021
* STEND  MOVE ATTRIBUTE TABLE TO OUTPUT                                 34086021
* STEMSS ERROR MESSAGES ROUTINE                                         34092021
******************                                                      34098021
         SPACE 1                                                        34104021
IKF206   CSECT                                                          34110021
         USING *,R15                                                    34116021
         USING STERAT,R1  BASE FOR OUTPUT REPORT WORK AREA              34122021
         SPACE 1                                                        34128021
****************                                                        34134021
*   REGISTER AND ADDRESS USAGE                                          34140021
*        R5    ADDRESS OF CHARACTER TABLE IPT                           34146021
*        R6    ADDRESS OF CHARACTER LENGTH TABLE IPLT                   34152021
*        R8    POINTER TO CHARACTER ENTRY                               34158021
*        R9    POINTER TO CHARACTER LENGTH ENTRY (LEFT BYTE OF PAIR     34164021
*        R10   ADDRESS OF LAST CHARACTER IN IPT OF INTEREST TO CURR     34170021
*               ROUTINE I.E. END STOP FOR TABLE SEARCH                  34176021
*        R11   ADDRESS OF NEXT BYTE AVAILABLE IN WORK AREA PICTURE      34182021
*        STATWK  STERLING ATTRIBUTE WORK AREA                           34188021
*                                                                       34194021
*                                                                       34200021
BSTREP   STM   R0,R14,RSAVE                                             34206021
         NI    COUNT,XX0F          SET COUNT TO ZERO                    34212021
         OI    MINCOD,XX60     SET MINOR CODE TO                        34218021
         NI    MINCOD,XX6F     0110XXXX                                 34224021
       LA      R1,REPPIC       SET POINTER TO PICTURE OUTPUT POSITI     34230021
*   ANY DICTIONARY POINTER TO BE SPACED OVER                            34236021
         TM    MINCOD,XX02     OCCURS CLAUSE                            34242021
         BC    M8,STREP0                NO                              34248021
         TM    MINCOD,XX08     IS MBS GREATER THAN 1                    34254021
         BC    M8,STREP       NO,NO DICT PTR                            34260021
         BC    M7,STREP1      YES,SPACE OVER                            34266021
STREP0   TM    MINCOD,XX0C     ANY MBS BITS                             34272021
         BC    M8,STREP            BRH TO SET CODE BYTE TO 0            34278021
STREP1   LA    R1,DX3(R1)      SPACE OVER DICT POINTER                  34284021
STREP    MVI   STWCDE,XX00     SET CODE BYTE TO ZERO                    34290021
         TM    ITMCLS,XX80     BLANK WHEN ZERO CLAUSE                   34296021
         BC    M8,STREPA      NO                                        34302021
         OI    STWCDE,XX80         SET BWZ IN CODE BYTE                 34308021
         EJECT                                                          34314021
***********                                                             34320021
*  VALID STERLING DELIMITERS  STREP  (LABELS STREP,A TO STREP,Z)        34326021
*    THIS ROUTINE CHECKS THE PICTURE TO ENSURE THAT THERE ARE 2 AND     34332021
*    ONLY 2 STERLING DELIMITERS,AND THAT THESE ARE NOT ADJACENT         34338021
*    IF FOUND,THESE DEVIDE THE FIELD INTO L,S,AND D PORTIONS            34344021
***************                                                         34350021
STREPA   EQU   *           INITIALISATION                               34356021
         TM    BPERRO,XX01     ANY INVALID CHARACTERS                   34362021
         BC    M1,STERRA YES,FULL ASSUMED VALUES,BUT NO MESSAG          34368021
         XC    STATWK+NX1(LX66),STATWK+NX1 ZERO THE WORK AREA           34374021
         NI    BSTRSW,XX00     ZERO THE SWITCH BYTE                     34380021
         SR    R7,R7                                                    34386021
         LA    R5,IPT         ADDRESS OF CHARACTER TABLE                34392021
         LA    R6,IPLT        ADDRESS OF LENGTH TABLE                   34398021
         IC    R7,IPT         COUNT OF PICTURE CHARACTERS               34404021
         LR    R8,R5          POINTER TO CHARACTER                      34410021
         LR    R9,R6          POINTER TO LENGTH                         34416021
         LR    R10,R5                                                   34422021
         AR    R10,R7         END OF IPT FIELD                          34428021
*  CHECK THAT TOTAL COUNT IS NOT GREATER THAN 129 (127 + 2 DELIMS       34434021
*   ALSO THAT ALL COUNT'SARE ONLY 1 BYTE                                34440021
       SR      R3,R3              USED FOR TOTAL COUNT                  34446021
STREP2   LA    R8,DX1(R8)          UPDATE POINTERS                      34452021
         LA    R9,DX2(R9)                                               34458021
         LH    R7,DX0(R9)          CHARACTER COUNT                      34464021
         AR    R3,R7          ADD COUNT TO LENGTH                       34470021
         CR    R8,R10             AT END YET                            34476021
         BC    M4,STREP2      NO REPEAT                                 34482021
       CH      R3,HW129                                                 34488021
         BC    M2,STREPZ      ERROR                                     34494021
       LR      R8,R5                                                    34500021
         SPACE 1                                                        34506021
       LR      R9,R6                                                    34512021
STREPB   LA    R8,DX1(R8)      INCREASE POINTERS TO                     34518021
         LA    R9,DX2(R9)      NEXT CHARACTER                           34524021
         CR    R8,R10         END OF CHARACTERS                         34530021
         BC    M2,STREPG      YES,CHECK 2 DELIMITERS                    34536021
         CLI   DX0(R8),XCC     IS IT C                                  34542021
         BC    M8,STREPD      YES,CHECK IF VALID                        34548021
         CLI   DX0(R8),XCD     IS IT D                                  34554021
         BC    M7,STREPB     NO,LOOK AT NEXT CHARACTER                  34560021
* PICTURE CHARACTER IS A D                                              34566021
STREPC   CLI   DX1(R9),XX01        IS COUNT 1                           34572021
         BC    M7,STREPU      NO THEN ERROR                             34578021
         CLI   DX1(R8),XCB     IS NEXT CHAR B (DB)                      34584021
         BC    M8,STREPB      YES,THEN IGNORE THE D                     34590021
* VALID D DELIMITER                                                     34596021
         BC    M15,STREPE          GO CHK FOR VALID C OR D DELIM        34602021
* PICTURE CHARACTER IS A C                                              34608021
STREPD   CLI   DX1(R9),XX01        IS COUNT 1                           34614021
         BC    R7,STREPV       NO,THEN ERROR                            34620021
         CLI   DX1(R8),XCR     IS NEXT CHAR R (CR)                      34626021
         BC    R8,STREPB       YES,THEN IGNORE THE C                    34632021
STREPE   EQU   *    VALID C OR D DELIMITER                              34638021
*  IS IT L DELIMITER                                                    34644021
         CLI   STPOUP,XX00     IS POS.OF POUND DEL ZERO                 34650021
         BC    R7,STREPF       NO THEN TRY SHILLS                       34656021
* YES,THEN THIS IS 1ST DELIM                                            34662021
         LR    R11,R8         POSITION OF CHARACER                      34668021
         SR    R11,R5         SUBTRACT STARTING POSITION TO GIVE RE     34674021
         STC   R11,STPOUP     POSITION OF STERLING DELIMITER            34680021
*              RELATIVE TO IPT.                                         34686021
         BC    R15,STREPB      CONTINUE SEARCH FOR DELIMITERS           34692021
STREPF   CLI   STSHIP,XX00     IS POSITION OF SHILLING DEL.ZERO         34698021
         BC    R7,STREPW       NO THEN ERROR -L AND S DELIM ALREADY     34704021
         LR    R11,R8         POSITION OF CHARACTER                     34710021
         SR    R11,R5         LESS STARTING POSITION TO GIVE REL,PO     34716021
         STC   R11,STSHIP     STORE POSITION OF SHILL.DELIM. REL TO     34722021
         BC    R15,STREPB      CONTINUE SEARCH FOR DELIMITERS           34728021
         EJECT                                                          34734021
STREPG   EQU   *    SCAN OF PICTURE IS COMPLETE,SO CHECK THAT 2 DEL     34740021
*                    HAVE BEEN FOUND                                    34746021
         CLI   STPOUP,XX00     POUNDS POSITION ZERO.                    34752021
         BC    R8,STREPX       YES THEN ERROR,L AND S LIMITS MISSING    34758021
         CLI   STSHIP,XX00     SHILLS POSITION ZERO                     34764021
         BC    R8,STREPY       YES THEN ERROR'S LIMIT MISSING           34770021
         BC    R15,STLED       ANALYSE L.S.D. PICTURE                   34776021
* STERLING DELIMITER ERROR ROUTINES FOLLOW.                             34782021
STREPU   LA    R12,STERRA     EXIT ADDRESS                              34788021
         BAL   R4,STEMSS      MESSAGE                                   34794021
         DC    X'10A2'             ADJACENT C DELIMITORS                34800021
STREPV   LA    R12,STERRA                                               34806021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      34812021
         DC    X'10A1'             ADJACENT D DELIMITORS                34818021
STREPW   LA    R12,STERRA                                               34824021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      34830021
         DC    X'10A3'             MORE THAN 2 STERLING DELIMITORS      34836021
STREPX   LA    R12,STERRA                                               34842021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      34848021
         DC    X'10A4'             NO STERLING DELIMITORS               34854021
STREPY   LA    R12,STERRA                                               34860021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      34866021
         DC    X'10A5'             ONLY 1 STERLING DELIMITOR            34872021
STREPZ LA      R12,STERRA    PICTURE LENGTH GREATER THAN 127 BYTES      34878021
       BAL     R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      34884021
         DC    X'10AC'                                                  34890021
         EJECT                                                          34896021
*  ANALYSE POUND FIELD   STLED                                          34902021
STLED    EQU   *     INITIALISE L.S.D. EDITING                          34908021
         LA    R8,DX1(R5)      CHARACTER STRING IN INPUT AREA           34914021
         LA    R9,DX2(R6)      CHARACTER LENGTH STRING IN INPUT AREA    34920021
         SR    R10,R10                                                  34926021
         LA    R11,STATWK     ADDRESS OF                                34932021
         LA    R11,DX5(R11)    CHARACTER STRING IN WKAREA               34938021
STLEDA   EQU   *    INITIALISE POUND EDIT                               34944021
         IC    R10,STPOUP     REL.ADD.OF POUND DELIM                    34950021
         AR    R10,R5         ACT.ADD.OF POUND DELIM                    34956021
STLEDB   EQU   *    START EDIT FOR POUNDS                               34962021
         CR    R8,R10    IS POUND DELIM 1ST CHAR                        34968021
         BC    R7,STLEDF  NO THEN ANALYSE POUNDS                        34974021
         OI    STWCDE,SLNOTP  SET NO POUNDS BIT                         34980021
STLEDC   EQU   *    DELIMITER CHARACTER                                 34986021
         CLI   DX0(R8),XCC     IS IT C                                  34992021
         BC    R7,STLEDD       NO                                       34998021
         OI    STWCDE,SLDELC  SET POUND DEL. IS C BIT                   35004021
STLEDD   MVC   DX0(LX1,R11),DX0(R8)  MOVE DEL.                          35010021
         MVI   DX1(R11),XX01        AND COUNT OF BINARY ONE             35016021
         LA    R8,DX1(R8)           UPDATE POINTERS                     35022021
         LA    R9,DX2(R9)                                               35028021
         LA    R11,DX2(R11)                                             35034021
         BC    R15,STSED            BRANCH TO EDIT SHILLS FIELD         35040021
         EJECT                                                          35046021
STLEDF   EQU   *    EDIT POUNDS FIELD                                   35052021
         SR    R3,R3     USED FOR COUNT OF POUND DIGITS                 35058021
         SPACE 1                                                        35064021
*  ACCEPTABLE POUND PICTURES ARE AS FOLLOWS                             35070021
*              ++ 9 9         FLOATING SIGN                             35076021
*              + 9 9          STATIC SIGN                               35082021
*              + * * 9 9                                                35088021
*              + Z Z 9 9                                                35094021
*              + $$ 9 9       FLOATING POUND                            35100021
*              + $ Z Z 9 9    STATIC SIGN AND POUND                     35106021
*              + $ * * 9 9                                              35112021
*              + $ 9 9                                                  35118021
*           ALSO - MAY REPLACE +                                        35124021
*                                                                       35130021
*              $$ 9 9         FLOATING POUND                            35136021
*              $ 9 9                                                    35142021
*        $ * * 9 9                                                      35148021
*              $ Z Z 9 9                                                35154021
*                                                                       35160021
*              Z Z 9 9                                                  35166021
*              * * 9 9                                                  35172021
*              9 9                                                      35178021
*        SEPARATOR OR INSERTION CHARACTERS MAY BE PLACED IN ANY BLA     35184021
         SPACE 1                                                        35190021
*  WHAT IS 1ST CHARACTER                                                35196021
         CLI   DX0(R8),XC9                                              35202021
         BE    STLEDP              YES FORMAT NINES ONLY                35208021
         CLI   DX0(R8),XX5B                                             35214021
         BE    STMEDF              YES FORMAT POUND                     35220021
         CLI   DX0(R8),XX5C                                             35226021
         BE    STMEDD              YES FORMAT MUST BE STAR,NZNE         35232021
         CLI   DX0(R8),XCZ                                              35238021
         BE    STMEDE              YES FORMAT ZED,NINE                  35244021
         CLI   DX0(R8),XX4E                                             35250021
         BE    STLEDH              BRANCH                               35256021
         CLI   DX0(R8),XX60                                             35262021
         BE    STLEDH              BRANCH                               35268021
* THEN IT MUST BE A SEPARATOR                                           35274021
         CLI   DX0(R8),XCB     IF BLANK'B'                              35280021
         BC    R7,STLEDG        SET TO                                  35286021
         MVI   DX0(R8),XX40     BLANK                                   35292021
STLEDG   MVC   DX0(LX1,R11),DX0(R8)  MOVE                               35298021
         MVC   DX1(LX1,R11),DX1(R9)  THE                                35304021
         LA    R8,DX1(R8)           SEPARATOR CHARACTER                 35310021
         LA    R9,DX2(R9)           AND                                 35316021
         LA    R11,DX2(R11)                                             35322021
         BC    R15,STLEDB           START AGAIN                         35328021
         EJECT                                                          35334021
STLEDH   EQU   *    FIRST SIGNIFICANT CHAR IS + OR -                    35340021
         OI    BSTRSW,XX01     SET SIGN SWITCH ON                       35346021
         CLI   DX1(R9),XX01    IS IT FLOAT  COUNT NOT ONE               35352021
         BC    R7,STLEDK       FLOAT                                    35358021
STLEDI   MVC   DX0(LX1,R11),DX0(R8)                                     35364021
         MVC   DX1(LX1,R11),DX1(R9)                                     35370021
         LA    R8,DX1(R8)                                               35376021
         LA    R9,DX2(R9)                                               35382021
         LA    R11,DX2(R11)                                             35388021
         CR    R8,R10         DELIMITER REACHED YET                     35394021
         BC    R8,STLEDC       YES PROCESS DELIMITER                    35400021
*  ELSE ANALYSE NEXT CHARACTER                                          35406021
STLEDJ   CLI   DX0(R8),XX5C                                             35412021
         BE    STMEDD              YES FORMAT MUST BE STAR,NZNE         35418021
         CLI   DX0(R8),XC9                                              35424021
         BE    STLEDP              YES FORMAT NINES ONLY                35430021
         CLI   DX0(R8),XX5B                                             35436021
         BE    STMEDF              YES FORMAT POUND                     35442021
         CLI   DX0(R8),XCZ                                              35448021
         BE    STMEDE              YES FORMAT ZED,NINE                  35454021
         CLI   DX0(R8),XX4E                                             35460021
         BC    R8,STLEDV            ERROR                               35466021
         CLI   DX0(R8),XX60                                             35472021
         BC    R8,STLEDV            ERROR                               35478021
         CLI   DX0(R8),XCB                                              35484021
         BNE   STLEDI              BRANCH                               35490021
         MVI   DX0(R8),XX40                                             35496021
         B     STLEDI              BRANCH                               35502021
STLEDK   EQU   *    FLOATING SIGN                                       35508021
         MVC   STWFLT(LX1),DX0(R8)   SET FLOAT CHARACTER                35514021
       BCTR  R3,R0      1 FROM COUNT FOR FLOAT                          35520021
         MVC   STMEDC+NX1(LX1),DX0(R8) STORE ACTUAL SIGN                35526021
         EJECT                                                          35532021
*  THIS ROUTINE WILL LOOP THROUGH THE INPUT PICTURE,PROCESSING          35538021
*   THE PICTURE CHARACTERS INTO THE OUTPUT PICTURE.                     35544021
*   THE REQUIRED VALID DIGIT CHARACTER IS SET AT THE COMPARE            35550021
*    INSTRUCTION AT STMEDC BY                                           35556021
*        MVC   STMEDC+1(1),0(R8)   BEFORE ENTERING THE ROUTINE.         35562021
*    OCCURENCES OF THIS CHARACTER WILL INCREMENT THE DIGIT COUNT        35568021
*    BEFORE TRANSFER                                                    35574021
*    IF THIS CHARACTER IS A 9,THE EXIT TO STCEDP WILL BE FORESTALLE     35580021
*    THE LOOP WILL CONTINUE UNTIL                                       35586021
*          A,  A 9 IS FOUND   BRANCH TO STLEDP,EXCEPT AS ABOVE,         35592021
*          B,  ANY OTHER DIGIT CHARACTER IS FOUND Z*+-$ ,               35598021
*               WHEN BRANCH IS TO ERROR ROUTINE,                        35604021
*          C,  THE DELIMITER IS REACHED                                 35610021
STMEDA   EQU   *    ONLY VALID FORMAT IS CHARACTER'S,NINES              35616021
*              ENTERED WITH POINTER AT 1ST CHARACTER                    35622021
         IC    R2,DX1(R9)      INCREMENT                                35628021
         AR    R3,R2          DIGIT COUNT                               35634021
STMEDB   MVC   DX0(LX1,R11),DX0(R8)                                     35640021
         MVC   DX1(LX1,R11),DX1(R9)                                     35646021
         LA    R8,DX1(R8)                                               35652021
         LA    R9,DX2(R9)                                               35658021
         LA    R11,DX2(R11)                                             35664021
         CR    R8,R10         DELIMITER REACHED                         35670021
         BE    STLEDR              YES EDIT POUND FIELD                 35676021
STMEDC   CLI   DX0(R8),XX5C    INITIALISED TO CHARACTER                 35682021
         BE    STMEDA              BRANCH                               35688021
         CLI   DX0(R8),XC9                                              35694021
         BE    STLEDP              YES FORMAT NINES ONLY                35700021
         CLI   DX0(R8),XX5B                                             35706021
         BC    R8,STLEDV       ERROR                                    35712021
         CLI   DX0(R8),XX5C                                             35718021
         BC    R8,STLEDV       ERROR                                    35724021
         CLI   DX0(R8),XCZ                                              35730021
         BC    R8,STLEDV       ERROR                                    35736021
         CLI   DX0(R8),XX4E                                             35742021
         BC    R8,STLEDV       ERROR                                    35748021
         CLI   DX0(R8),XX60                                             35754021
         BC    R8,STLEDV       ERROR                                    35760021
* THEN MUST BE SEPARATOR                                                35766021
         CLI   DX0(R8),XCB                                              35772021
         BNE   STMEDB              BRANCH                               35778021
         MVI   DX0(R8),XX40                                             35784021
         BC    R15,STMEDB          BRH TO STMEDB                        35790021
         EJECT                                                          35796021
STLEDP   EQU   *    FORMAT NINES ONLY                                   35802021
         MVC   STMEDC+NX1(LX1),DX0(R8) R8 POINTS AT NINE                35808021
         B     STMEDA              BRANCH                               35814021
         SPACE 1                                                        35820021
STMEDD   EQU   *    FORMAT MUST BE STAR,NZNE                            35826021
         MVC   STMEDC+NX1(LX1),DX0(R8) R8 POINTS AT STAR                35832021
         B     STMEDA              BRANCH                               35838021
         SPACE 1                                                        35844021
STMEDE   EQU   *    FORMAT ZED,NINE                                     35850021
         MVC   STMEDC+NX1(LX1),DX0(R8) R8 POINTS AT ZED                 35856021
         B     STMEDA              BRANCH                               35862021
         SPACE 1                                                        35868021
STMEDF   EQU   *    FORMAT POUND                                        35874021
         CLI   DX1(R9),XX01    FLOATING POUND                           35880021
         BC    R8,STMEDG       NO                                       35886021
         MVC   STWFLT(LX1),DX0(R8)   YES  SET FLOAT CHARACTER           35892021
       BCTR  R3,R0                ONE FROM COUNT FOR FLOAT              35898021
         MVC   STMEDC+NX1(LX1),DX0(R8) R8 POINTS AT POUND               35904021
         B     STMEDA              BRANCH                               35910021
         SPACE 1                                                        35916021
STMEDG   EQU   *    ZZ9,**9,9 ARE VALID                                 35922021
         MVC   DX0(LX1,R11),DX0(R8)  MOVE THE STATIC POUND              35928021
         MVC   DX1(LX1,R11),DX1(R9)                                     35934021
         LA    R8,DX1(R8)                                               35940021
         LA    R9,DX2(R9)                                               35946021
         LA    R11,DX2(R11)                                             35952021
         CR    R8,R10         DELIM REACHED                             35958021
         BC    R7,STMEDH       NO WHAT IS NEXT                          35964021
*   THEN NO POUND DIGITS,BUT MAY BE STATIC SIGN                         35970021
         TM    BSTRSW,XX01     SIGN SWITCH ON                           35976021
         BC    R8,STLEDB       NO,SET NO PUUND DIGITS,PROC DELIM        35982021
         BC    R15,STLEDC      YES PROCESS DELIMITOR                    35988021
STMEDH   EQU   *                                                        35994021
         CLI   DX0(R8),XC9                                              36000021
         BC    R8,STLEDP       THEN 90                                  36006021
         CLI   DX0(R8),XX5C                                             36012021
         BC    R8,STMEDD       THEN **9                                 36018021
         CLI   DX0(R8),XCZ                                              36024021
         BC    R8,STMEDE       THEN ZZ9                                 36030021
         CLI   DX0(R8),XX5B                                             36036021
         BC    R8,STLEDV       ERROR                                    36042021
         CLI   DX0(R8),XX4E                                             36048021
         BC    R8,STLEDV       ERROR                                    36054021
         CLI   DX0(R8),XX60                                             36060021
         BC    R8,STLEDV       ERROR                                    36066021
*  THEN MUST BE SEPARATOR                                               36072021
         CLI   DX0(R8),XCB                                              36078021
         BNE   STMEDG              BRANCH                               36084021
         MVI   DX0(R8),XX40                                             36090021
         B     STMEDG              BRANCH                               36096021
         EJECT                                                          36102021
STLEDR   EQU   *    END OF POUND FIELD                                  36108021
         STC   R3,STWNOL      SET NO.OF POUND DIGITS                    36114021
         CLI   STWNOL,XX0F     IS IT GREATER THAN 15                    36120021
         BC    R3,STLEDU       YES THEN ERROR                           36126021
         BC    R15,STLEDC      PROCESS DELIMITERS                       36132021
         SPACE 1                                                        36138021
STLEDU   EQU   *    NO.OF POUND DIGITS GREATER THAN 15                  36144021
         LA    R12,STLEDX                                               36150021
         BAL   R4,STEMSS           LINK TO MESS OUTPUT RTN              36156021
         DC    X'10A7'                                                  36162021
         SPACE 1                                                        36168021
STLEDV   EQU   *                                                        36174021
         SPACE 1                                                        36180021
STLEDW   EQU   *   ERROR FOUND DURING POUND EDIT                        36186021
         LA    R12,STLEDX     RETURN ADDRESS                            36192021
         BAL   R4,STEMSS           LINK TO MESS OUTPUT RTN              36198021
         DC    X'10AA'             ERROR IN POUND FIELD                 36204021
         SPACE 1                                                        36210021
STLEDX   EQU   *      RECOVERY FROM POUND ERROR                         36216021
         LA    R11,STATWK     RESET OUTPUT                              36222021
         LA    R11,DX5(R11)    POINTER                                  36228021
         MVC   DX0(LX6,R11),STLASM   SET ASSUM.VALUE TO    $$$$$$9B     36234021
         LA    R11,DX6(R11)         UPDATE OUTPUT POINTER               36240021
         MVI   STWNOL,XX06          SET LENGTH OF OUTPUT POUNDS         36246021
         MVI   STWFLT,XX5B        SET FLOAT CHARACTER                   36252021
         NI    BSTRSW,XXFE     SET SIGN SWITCH OFF                      36258021
STLEDY   CR    R8,R10         DELIMITER REACHED YET                     36264021
         BC    R8,STLEDC       YES  PROCESS IT                          36270021
         LA    R8,DX1(R8)      ELSE INCREMENT PICTURE POINTERS          36276021
         LA    R9,DX2(R9)      AND LOOP UNTIL                           36282021
         BC    R15,STLEDY      DELIMITER REACHED                        36288021
         EJECT                                                          36294021
*   ANALYSE SHILLINGS FIELD                                             36300021
STSED    EQU   *    INITZALISE SHILLS.EDIT                              36306021
         SR    R10,R10                                                  36312021
         IC    R10,STSHIP     REL.ADD.OF SHILL.DELIM                    36318021
         AR    R10,R5         ACT.ADD.OF SHILL.DELIM                    36324021
* NOTE R8,R9 ARE POINTING TO     CHAR AND LENGTH OF 1ST SHILL ENTRY     36330021
STSEDA   CLI   DX0(R8),XX5C    FIRST CHAR *                             36336021
         BC    R7,STSEDE       NO TRY Z                                 36342021
STSEDB   CLI   DX1(R9),XX02        IS COUNT 2                           36348021
         BC    R8,STSEDG       YES THEN VALID ** OR ZZ                  36354021
         CLI   DX1(R9),XX01        IS COUNT 1                           36360021
         BC    R7,STSEDL       NO,THEN ERROR                            36366021
STSEDC   CLI   DX1(R8),XC9     IS NEXT CHAR 9                           36372021
         BC    R7,STSEDD       NO,THEN TRY 8                            36378021
STSEDK   CLI   DX3(R9),XX01        IS COUNT 1                           36384021
         BC    R8,STSEDG       YES THEN VALID *9 OR Z9                  36390021
         BC    R15,STSEDL      ELSE ERROR                               36396021
STSEDD   CLI   DX1(R8),XC8     IS NEXT CHAR 8                           36402021
         BC    R8,STSEDK       YES CHECK COUNT =1                       36408021
         BC    R15,STSEDL      ELSE ERROR                               36414021
STSEDE   CLI   DX0(R8),XCZ     IS FIRST CHAR Z                          36420021
         BC    R8,STSEDB       YES,CONTINUE AS *                        36426021
* THEN ONLY REMAINING CHOICE IS 99                                      36432021
STSEDF   CLI   DX0(R8),XC9     IS FIRST CHARACTER 9                     36438021
         BC    R7,STSEDL       NO,THEN ERROR                            36444021
         CLI   DX1(R9),XX02        IS COUNT 2                           36450021
         BC    R8,STSEDG       YES THEN VALID 99                        36456021
         BC    R15,STSEDL      ELSE ERROR                               36462021
*                                                                       36468021
STSEDG   EQU   *    SHILLS PICTURE IS VALID                             36474021
* ASSUMING SEPARATOR CHARACTERS ARE ALSO VALID                          36480021
* MOVE PICTURE TO WORK AREA                                             36486021
         CLI   DX0(R8),XCB       CHANGE B TO BLANK                      36492021
         BC    R7,STSEDH        NOT B                                   36498021
         MVI   DX0(R8),XX40                                             36504021
STSEDH   MVC   DX0(LX1,R11),DX0(R8)  MOVE CHARACTER                     36510021
         MVC   DX1(LX1,R11),DX1(R9)  AND LENGTH                         36516021
         LA    R8,DX1(R8)           UPDATE POINTERS                     36522021
         LA    R9,DX2(R9)                                               36528021
         LA    R11,DX2(R11)                                             36534021
         CR    R8,R10              SHILL DELIM REACHED                  36540021
         BL    STSEDG              YES SHILLS PIC IS VALID              36546021
* IS DELIM. A C                                                         36552021
STSEDI   CLI   DX0(R8),XCC          IS DELIM A C                        36558021
         BNE   STSEDJ              YES MOVE DELIM                       36564021
         OI    STWCDE,SSDELC       SET SHILL DELIM IS C BIT             36570021
STSEDJ   MVC   DX0(LX1,R11),DX0(R8)  MOVE DELIM                         36576021
         MVI   DX1(R11),XX01        SET COUNT TO BINARY ONE             36582021
         LA    R8,DX1(R8)           UPDATE POINTERS                     36588021
         LA    R9,DX2(R9)                                               36594021
         LA    R11,DX2(R11)                                             36600021
         BC    R15,STPED       EDIT PENCE FIELD                         36606021
         EJECT                                                          36612021
* ERROR ROUTINE                                                         36618021
STSEDL   EQU   *    AN ERROR HAS BEEN FOUND                             36624021
         LA    R12,STSEDM                                               36630021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      36636021
         DC    X'10A6'             ERROR IN SHILLS FIELD, ASSUME VA     36642021
         SPACE 1                                                        36648021
STSEDM   EQU   *    RECOVERY FROM SHILLINGS ERROR                       36654021
         MVC   DX0(LX6,R11),STSASM   SET ASSUM VALUES Z9B               36660021
         LA    R11,DX6(R11)         UPDATE WORKAREA POINTER             36666021
STSEDN   LA    R8,DX1(R8)           INCREMENT UP TO SHILL DELIM         36672021
         LA    R9,DX2(R9)                                               36678021
         CR    R8,R10              DELIM.REACHED                        36684021
         BC    R4,STSEDN            NO,REPEAT                           36690021
         BC    R15,STSEDI           PROCESS DELIM AS NORMAL             36696021
         EJECT                                                          36702021
*   ANALYSE PENCE FIELD                                                 36708021
STPED    EQU   *    INITIALISE PENCE EDIT                               36714021
         SR    R10,R10                                                  36720021
         IC    R10,IPT        NO OF ENTRIES IN FIELD                    36726021
         AR    R10,R5         ACTUAL ADDRESS OF END OF FIELD            36732021
* NOTE R8,R9 ARE POINTING TO CHAR AND LENGTH OF 1ST PENCE ENTRY         36738021
STPEDA   EQU   *              EDIT PENCE                                36744021
         CLI   DX0(R8),XX5C         FIRST CHAR *                        36750021
         BC    R7,STPEDF            NO TRY Z                            36756021
STPEDB   CLI   DX1(R9),XX02        IS COUNT 2                           36762021
         BC    R8,STPEDH            YES,VALID ** OR ZZ                  36768021
         CLI   DX1(R9),XX01        IS COUNT 1                           36774021
         BC    R7,STPEDV            NO,ERROR                            36780021
STPEDC   CLI   DX1(R8),XC9          SECOND CHAR 9                       36786021
         BC    R7,STPEDE            NO,TRY 8                            36792021
STPEDD   CLI   DX3(R9),XX01        IS COUNT 1                           36798021
         BC    R8,STPEDI            YES,VALID  *9 OR *8 OR Z9 OR Z8     36804021
         BC    R15,STPEDV           ELSE ERROR                          36810021
STPEDE   CLI   DX1(R8),XC8          SECOND CHAR 8                       36816021
         BC    R8,STPEDD            IS COUNT 1                          36822021
         BC    R15,STPEDV           ELSE ERROR                          36828021
STPEDF   CLI   DX0(R8),XCZ          FIRST CHAR Z                        36834021
         BC    R8,STPEDB            YES,CONTINUE AS *                   36840021
* ONLY REMAINING CHOICE IS 99                                           36846021
STPEDG   CLI   DX0(R8),XC9     IS FIRST CHAR 9                          36852021
         BC    R7,STPEDV       NO THEN ERROR                            36858021
         CLI   DX1(R9),XX02        IS COUNT 2                           36864021
         BC    R8,STPEDH       YES,VALID 99                             36870021
         BC    R15,STPEDV      ELSE ERROR                               36876021
* MOVE WHOLEPENCE PORTION                                               36882021
STPEDI   EQU   *    PICTURE *9,*8,Z9,OR Z8                              36888021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     36894021
STPEDH   EQU   *    PICTURE ** OR ZZ OR 99                              36900021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     36906021
STPEDJ   EQU   *    END OF PICTURE FOR WHOLE PENCE                      36912021
         BC    R15,STDED            ELSE CHECK SEP.AND PENCE DECIMAL    36918021
         SPACE 1                                                        36924021
STPEDV   EQU   *    ERROR IN WHOLE PENCE PICTURE                        36930021
         LA    R12,STPEDY                                               36936021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      36942021
         DC    X'10A8'                                                  36948021
         SPACE 1                                                        36954021
STPEDY   EQU   *    RECOVERY FROM WHOLE PENCE ERROR                     36960021
         MVC   DX0(LX4,R11),STPASM   SET ASSUM VAL TO Z9                36966021
         LA    R11,DX4(R11)         UPDATE POINTER                      36972021
         BC    R15,STFIN       AND END EDITING                          36978021
         EJECT                                                          36984021
STMOV1   EQU   *    MOVE 1 PICTURE ENTRY TO WORK AREA                   36990021
*                   AND UPDATE THE POINTERS                             36996021
*                   IF END OF PICTURE GO TO STFIN                       37002021
         MVC   DX0(LX1,R11),DX0(R8)  MOVE CHARACTER                     37008021
         MVC   DX1(LX1,R11),DX1(R9)                                     37014021
         LA    R8,DX1(R8)      UPDATE                                   37020021
         LA    R9,DX2(R9)       POINTERS                                37026021
         LA    R11,DX2(R11)                                             37032021
         CR    R8,R10         END OF PICTURE YET                        37038021
         BC    R2,STFIN         YES   THEN GO TO FINISH                 37044021
         BCR   R15,R12    ELSE RETURN TO CALLING ROUTINE                37050021
         EJECT                                                          37056021
*  CHECK PENCE SEPARATORS AND DECIMAL PENCE                             37062021
STDED    EQU   *    INITIALISE                                          37068021
STDEDA   EQU   *                                                        37074021
         CLI   DX0(R8),XX4B    IS 1ST CHAR DECIMAL                      37080021
         BC    R7,STDEDB       NO TRY SMALL D                           37086021
         CLI   DX1(R9),XX01        IS COUNT 1                           37092021
         BC    R7,STDEDV       NO,ERROR                                 37098021
         CLI   DX1(R8),XC9     FOLLOWED BY 9                            37104021
         BC    R7,STDEDD       NO,TEST FOR DECIMAL AFTER SMALL D        37110021
         LA    R3,DX15         MAX.NO.OF DIGITS IN PICTURE              37116021
         SR    R2,R2                                                    37122021
         IC    R2,DX3(R9)      LESS NO.OF DECIMAL PENCE                 37128021
         SR    R3,R2                                                    37134021
         IC    R2,STWNOL      LESS NO OF POUND DIGITS                   37140021
         SR    R3,R2                                                    37146021
         BC    R4,STDEDU       IF MINUS,TOO MANY DIGITS                 37152021
         MVC   STWNOD(LX1),DX3(R9) AND SET NO OF PENCE DECIMAL          37158021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37164021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37170021
STDEDB   EQU   *    CHECK SEPARATOR CHARS                               37176021
         CLI   DX0(R8),XX84    SMALL D                                  37182021
         BC    R7,STDEDD       NO TRY DECIMAL                           37188021
         CLI   DX1(R9),XX01        IS COUNT 1                           37194021
         BC    R7,STDEDV  NO ERROR                                      37200021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37206021
STDEDD   CLI   DX0(R8),XX4B    DECIMAL POINT                            37212021
         BC    R7,STDEDF       NO                                       37218021
         CLI   DX1(R9),XX01        IS COUNT 1                           37224021
         BC    R7,STDEDV       NO ERROR                                 37230021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37236021
STDEDF   CLI   DX0(R8),XCB     BLANK                                    37242021
         BC    R7,STDEDG       NO TRY CR                                37248021
         MVI   DX0(R8),XX40                                             37254021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37260021
STDEDG   CLI   DX0(R8),XCC     CR                                       37266021
         BC    R7,STDEDH       NO THEN MUST BE MINUS                    37272021
         CLI   DX1(R9),XX01        IS COUNT 1                           37278021
         BC    R7,STDEDV       NO,ERROR                                 37284021
         CLI   DX1(R8),XCR                                              37290021
         BC    R7,STDEDV       NO,ERROR                                 37296021
STDEDK   EQU   *                                                        37302021
         CLI   DX3(R9),XX01        IS COUNT 1                           37308021
         BC    R7,STDEDV       NO,ERROR                                 37314021
* HAS SIGN BEEN USED ALREADY                                            37320021
         TM    BSTRSW,XX01     SIGN SWITCH ON                           37326021
         BC    R1,STDEDW       YES ERROR                                37332021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37338021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37344021
         BC    R15,STDEDV      NO THEN IT OUGHT TO BE                   37350021
STDEDH   CLI   DX0(R8),XX60    IS IT MINUS                              37356021
         BC    R7,STDEDJ       TRY PLUS                                 37362021
STDEDI   EQU   *                                                        37368021
         CLI   DX1(R9),XX01        IS COUNT 1                           37374021
         BC    R7,STDEDV       NO,ERROR                                 37380021
* HAS SIGN BEEN USED ALREADY                                            37386021
         TM    BSTRSW,XX01     SIGN SWITCH ON                           37392021
         BC    R1,STDEDX       YES ERROR                                37398021
         BAL   R12,STMOV1  MOVE 1 PICT.ENT.TO WKAREA,UPDATE POINTER     37404021
         BC    R15,STDEDV      NO THEN IT OUGHT TO BE                   37410021
STDEDJ   CLI   DX0(R8),XX4E    IS IT PLUS                               37416021
         BC    R8,STDEDI       PROCEED AS MINUS                         37422021
         CLI   DX0(R8),XCD      TRY DB                                  37428021
         BC    R7,STDEDV       NO ERROR                                 37434021
         CLI   DX1(R9),XX01    CHECK COUNT IS ONE                       37440021
         BC    R7,STDEDV       NO ERROR                                 37446021
         CLI   DX1(R8),XCB                                              37452021
         BC    R7,STDEDV       NO ERROR                                 37458021
         BC    R15,STDEDK      PROCEED AS CR                            37464021
         SPACE 1                                                        37470021
STDEDU   EQU   *   NO.OF PENCE DEC.+ NO.OF POUND DIGITS GT. 15          37476021
         LA    R12,STDEDY                                               37482021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      37488021
         DC    X'10AB'                                                  37494021
         SPACE 1                                                        37500021
STDEDV   EQU   *    ERROR IN DECIMAL PENCE PICTURE                      37506021
         LA    R12,STDEDY                                               37512021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      37518021
         DC    X'10A9'                                                  37524021
         SPACE 1                                                        37530021
STDEDW   EQU   *    CR OR DB NOT VALID WITH LEADING SIGN                37536021
         LA    R12,STDEDY                                               37542021
         BAL   R4,STEMSS           LINK TO MESS OUTPUT RTN              37548021
         DC    X'10AD'                                                  37554021
         SPACE 1                                                        37560021
STDEDX   EQU   *    LEADING AND TRAILING SIGN NOT VALID                 37566021
         LA    R12,STDEDY                                               37572021
         BAL   R4,STEMSS           TO MSG OUTPUT RTN STERL RPT PIC      37578021
         DC    X'10AE'                                                  37584021
         SPACE 1                                                        37590021
STDEDY   EQU   *    DECIMAL PENCE ASSUM VALUES  NONE                    37596021
         BC    R15,STFIN                 END EDITING                    37602021
         EJECT                                                          37608021
********                                                                37614021
* THE EDIT OF THE PICTURE IS NOW COMPLETE                               37620021
*  THE VALID PARAMETERS,AND ANY ASSUMED VALUES,ARE IN THE               37626021
*  WORK-AREA ATTRIBUTE TABLE.                                           37632021
* THIS ROUTINE CALCULATES A,THE NO.OF BYTES REQD FOR OUTPUT             37638021
*                        B,THE TOTAL NO OF PICTURE CHARACTERS           37644021
*  AND THEN LOADS REG 12 WITH B                                         37650021
*              AND REG 11 WITH ADDRESS OF WORK AREA TABLE               37656021
********                                                                37662021
STFIN    EQU   *    INITIALISE                                          37668021
         LA    R7,STWVAR      ADDRESS OF 1ST PICTURE CHARACTER          37674021
*              R11 CONTAINS   ADDRESS OF END OF TABLE PLUS 1            37680021
         LR    R8,R7          POINTER TO PICTURE CHARACTER              37686021
         LA    R9,DX2                                                   37692021
         LCR   R9,R9          SET TO MINUS 2,TO COUNT BYTES OF OUTP     37698021
         SR    R10,R10                                                  37704021
STFINA   EQU   *    GENERATE COUNT                                      37710021
         IC    R10,DX1(R8)                                              37716021
         AR    R9,R10                                                   37722021
         LA    R8,DX2(R8)      UPDATE POINTER                           37728021
         CR    R8,R11         END OF TABLE                              37734021
         BC    R4,STFINA       NO,LOOP                                  37740021
         CH    R9,HW127       IS COUNT GREATER THAN 127                 37746021
         BC    R2,STREPZ       YES THEN ERROR                           37752021
         STC   R9,STWTOL      YES STORE COUNT.NOTE D,C NOT COUNTED      37758021
STFINB   EQU   *    SET REGISTERS FOR OUTPUT ROUTINE                    37764021
         SR    R11,R7    LENGTH OF PICTURE                              37770021
         LA    R12,DX6(R11)    NO.OF PICTURE CHARACTERS PLUS CONSTAN    37776021
         LA    R11,STATWK  ADDRESS OF WORK AREA                         37782021
         B     STENDA              BRANCH                               37788021
         EJECT                                                          37794021
         DC    X'10A0'                                                  37800021
         SPACE 1                                                        37806021
STEMSS   EQU   *   MESSAGE OUTPUT ROUTINE STERLING REPORT PICTURE       37812021
         LH    R0,DX0(R4)      LOAD ERROR NUMBER                        37818021
         ST    R15,TSAVER     SAVE BASE REGISTER                        37824021
         L     R15,AERRTN                                               37830021
         BALR  R14,R15             GO TO ERROR ROUTINE                  37836021
         L     R15,TSAVER     RESTORE BASE REGISTER                     37842021
         BR    R12                 BRANCH                               37848021
* NOTE RETURN IS TO REG 12 ADDRESS                                      37854021
         SPACE 1                                                        37860021
*  AN ERROR HAS OCCURRED,SO USE ASSUMED VALUES                          37866021
*  ASSUMED VALUES ARE IN SASUMV-STERLING REPORT ASSUMED VALUES          37872021
*  THE FIRST BYTE CONTAINS THE NO.OF PICTURE CHARS IN STRING            37878021
STERRA   IC    R12,SASUMV          LOAD REG 12 WITH NO OF PICT.CHAR     37884021
         LA    R11,SASUMV+NX1       LOAD REG 11 WITH ADDRESS OF ASUM    37890021
         LA    R12,DX4(R12)    ADD FIXED PORTION ,LESS 1 FOR EXECUTE    37896021
* R12 NOW CONTAINS THE COUNT OF VARIABLE PART OF ATTRIB,EXCLUDING       37902021
* THE DICTIONARY ENTRY                                                  37908021
         EX    R12,STVALM          MOVE VALUES TO OUTPUT AREA           37914021
         LA    R12,DX2(R12)    RESET R12 AND ADD 1                      37920021
STENDA   EQU   *                                                        37926021
*   ANY DICTIONARY POINTER TO BE INCLUDED                               37932021
         TM    MINCOD,XX02     OCCURS CLAUSE                            37938021
         BC    R8,STEND0       NO                                       37944021
         TM    MINCOD,XX08     IS MBS GREATER THAN 1                    37950021
         BC    R8,STENDC       NO,NO DICT POINTER                       37956021
         BC    R7,STENDB       YES INCLUDE IT                           37962021
STEND0   TM    MINCOD,XX0C     ANY MBS BITS                             37968021
         BC    R8,STENDC       NO                                       37974021
STENDB   LA    R12,DX3(R12)         INCUDE DICTIONARY POINTER IN LEN    37980021
STENDC   EQU   *                                                        37986021
         STC   R12,VILGN          SET LENGTH OF ATTRIBUTE FIELD         37992021
         MVC   CILGN+NX1(LX1),DX2(R11) SET TOTAL REPORT LENGTH          37998021
*  THE PICTURE ANALYSIS IS COMPLETE,SO RETURN                           38004021
         LM    R1,R14,RSAVE+NX4     RESTORE REGISTERS                   38010021
STENDD   BCR   R15,R14              RETURN                              38016021
         SPACE 1                                                        38022021
STVALM   MVC   STATWK(LX0),SASUMV+NX1 MOVE ASSUMED VALUES TO OUTPUT     38028021
*                                                                       38034021
* MASKS FOR BYTE 8 OF ATTRIBUTE TABLE                                   38040021
* SFBWZ  EQU   X'80'     BLANK WHEN ZERO                                38046021
* SSDELC EQU   X'40'     SHILL DELIM. IS C                              38052021
* SLDELC EQU   X'20'     POUND DELIM. IS C                              38058021
* SLNOTP EQU   X'10'     NO POUND DIGITS OR STATIC SHARACTERS           38064021
         SPACE 1                                                        38070021
         DROP  R1                                                       38076021
         DROP  R15                                                      38082021
         EJECT                                                          38088021
IKF207   CSECT                                                          38094021
         USING *,R15                                                    38100021
ERRRTN   STH   R0,MSGDEF+NX3        STORE MESSAGE NUMBER IN MSGDEF      38106021
         MVZ   MSGDEF+NX7(LX1),MSGDEF+NX3 SET SEVERITY                  38112021
         NI    MSGDEF+NX3,XX0F                                          38118021
         STM   R11,R2,ERSAVE                                            38124021
         L     RCOM,COSADR                                              38130021
         SRL   R0,DX12                                                  38136021
         A     R0,ONE                                                   38142021
         SLL   R0,DX2                                                   38148021
         CH    R0,TWELVE+NX2                                            38154021
         BNH   SKIPIC              YES SKIP NEXT INSTRUCTION            38160021
         IC    R0,CON16+NX3                                             38166021
SKIPIC   STC   R0,FULLWD                                                38172021
         CLC   FULLWD(LX1),ERRSEV                                       38178021
         BNH   SKIPSTC             YES SKIP NEXT INSTRUCTION            38184021
         STC   R0,ERRSEV                                                38190021
SKIPSTC  MVC   MSGDEF+NX5(LX2),CARDNO  MOVE CARD NUMBER TO MSGDEF       38196021
         L     R1,COSADR           SET UP REGISTERS                     38202021
         LA    R2,MSGDEF             FOR A PUT IN COS                   38208021
         BALR  R0,R1               BRANCH                               38214021
         DC    X'24'               FILE 4 PUT                           38220021
         LM    R11,R2,ERSAVE                                            38226021
         LTR   R1,R1               IS IT ZERO                           38232021
         BCR   ZERO,R14            YES  RETURN TO CALLER                38238021
         BCR   UNCOND,R14          NO PUT OUT MSGPAR                    38244021
TDDMP0 DS    0H                                                         38250021
         BCR   UNCOND,R14          BRANCH                               38256021
* ERROR MESSAGE PARAMETERS                                              38262021
*                                                                       38268021
*                                                                       38274021
TDDMP1   DC    X'C0'                                                    38280021
         DC    X'01500C'                                                38286021
         DC    X'08'                                                    38292021
         DC    X'0151C6'                                                38298021
         DC    C' COMMON '                                              38304021
         DC    X'C0'                                                    38310021
         DC    X'016D9C'                                                38316021
         DC    X'08'                                                    38322021
         DC    X'016F84'                                                38328021
         DC    C'  TAMMS '                                              38334021
         DC    X'C0'                                                    38340021
         DC    X'020000'           MAIN FREE AREA                       38346021
         DC    X'04'                                                    38352021
         DC    X'03FFFF'                                                38358021
         DC    C'TAB DICT'                                              38364021
* NORMALIZATION OF LEVEL NUMBERS--BNORML                                38370021
* THIS ROUTINE TAKES THE UNNORMALIZED SOURCE LEVEL NUMBER IN REGIST     38376021
* AND CONVERTS IT TO A NORMALIZED LEVEL NUMBER PUTTING IT BACK IN       38382021
* REGISTER 3. THE SOURCE LEVEL NUMBERS ARE NORMALIZED TO FACILITATE     38388021
* MOVE CORRESPONDING VERB IN THE 360 COBOL COMPILER.                    38394021
* THE SOURCE LEVEL NUMBERS  01   WOULD BE NORMALIZED TO 01              38400021
*                            06                          02             38406021
*                             07                          03            38412021
*                             07                          03            38418021
*                            05                          02             38424021
*                                                                       38430021
* THE CALLING SEQUENCE TO THIS ROUTINE IS                               38436021
*      L     R15,ANORML       ANORML IS ADDRESS CONSTANT OF BNORML      38442021
*      BALR  14,15                                                      38448021
*      L     15,GR15          GR15 IS SAVE AREA FOR REGISTER 15         38454021
*                                                                       38460021
*                                                                       38466021
*                                                                       38472021
       USING *,R15                                                      38478021
BNORML   STM   R4,R6,RSAVE+NX12    SAVE REGISTERS                       38484021
       SR    R4,R4            R4 USED AS TABLE INDEX REG                38490021
       SR    R5,R5            CLEAR REGS 4 AND 5                        38496021
         LA    R6,BLNTAB                                                38502021
BCOMLN   IC    R5,DX0(R4,R6)   INSERT TABLE VALUE INTO R5 AND           38508021
       C     R5,ZEROS           CHECK IF IT IS ZERO                     38514021
       BC    EQ,BEMPTY          BRANCH IF ZERO                          38520021
         CR    R5,R3               IF NOT 0 COMPARE TABLE VALUE TO      38526021
         BC    LO,BINCRM           LEVEL NO. IN R3. IF TABLE VALUE      38532021
         STC   R3,DX0(R4,R6)        LEVEL NO. BRANCH ELSE REPLACE TA    38538021
         LA    R3,DX1(R4)           VALUE BY LN AND LOAD R3 W/NORM.     38544021
       C     R3,NSAVE           WHICH IS R4+1. BSAVE CONTAINS MAX T     38550021
         BC    LO,BCLEAR           INDEX USED, IF BSAVE CURRENT TAB     38556021
       BC    UNCOND,BLEAVE      BRANCH, ELSE LEAVE R+N.                 38562021
BEMPTY   STC   R3,DX0(R6,R4)   REPLACE TABLE VALUE BY SOURCE LEVEL N    38568021
         LA    R3,DX1(R4,R0)    LOAD NORM. LN INTO R3                   38574021
BTABX  ST    R3,NSAVE         SAVE INDEX TABLE VALUE                    38580021
BLEAVE   LM    R4,R6,RSAVE+NX12     RESTORE REGISTERS                   38586021
       BCR   UNCOND,R14       RETURN TO MAIN PROGRAM                    38592021
BINCRM   LA    R4,DX1(R4,R0)    INCREMENT TABLE INDEX REG.              38598021
       BC    UNCOND,BCOMLN         BRANCH TO INSERT NEXT TABLE VAL      38604021
BCLEAR L     R5,NSAVE         FIND NUMBER OF BYTES TO BE CLEARED OU     38610021
       SR    R5,R3            IN TABLE                                  38616021
       BCTR  R5,R0             DECREMENT NO. OF BYTES BY 1 FOR VALI     38622021
       AR    R6,R4            IN MVC INST                               38628021
         MVI   DX1(R6),XX00    MOVE ZERO INTO FIRST BYTE TO BE CLEAR    38634021
       EX    R5,BCLRTB        EXECUTE CLEAR (BCLRTB)                    38640021
       BC    UNCOND,BTABX          BRANCH TO SAVE NDEX TABL VALUE       38646021
BCLRTB   MVC   DX2(LX0,R6),DX1(R6)                                      38652021
         EJECT                                                          38658021
*=1   DICTIONARY BUILD ROUTINE (DICTBD)                                 38664021
*                                                                       38670021
*  THE DICTIONARY BUILD ROUTINES (DICTBD) ACCEPT THE INCOMPLETE DIC     38676021
*    IONARY ENTRY FROM THE SYNTAX SCAN ROUTINE. THE DICTIONARY BUIL     38682021
*    ROUTINE  PERFORMS THE FOLLOWING FUNCTIONS --                       38688021
*    1.  ASSIGNS ADDRESSING PARAMETERS (ADPAR)                          38694021
*    2.  CALCULATES THE LENGTHS OF FIXED LENGTH GROUP ITEMS (XTEN)      38700021
*    3.  MAKES ALL DICTIONARY ENTRIES USING ACCESS ROUTINES.            38706021
*    4.  PERFORMS SYNTAX CHECKS FOR REDEFINES. SETS THE ADDRESSING      38712021
*        PARAMETERS OF THE REDEFINING TO THAT OF THE REDEFINED. (RE     38718021
*    5.  GENERATES OBJECT-TIME Q-ROUTINES FOR CALCULATING LENGTHS O     38724021
*        VARIABLE LENGTH GROUPS .                                       38730021
*    6.  DETERMINES THAT THE LITERALS ASSOCIATED WITH THE VALUE CLA     38736021
*        CONFORMS TO THE ATTRIBUTES AND PADDING OR TRUNCATION IS DO     38742021
*        WHEN NECESSARY. (VALGEN)                                       38748021
*                                                                       38754021
*                                                                       38760021
*                                                                       38766021
*                                                                       38772021
IKF208 CSECT                                                            38778021
       USING *,R15                                                      38784021
DICTBD   ST    R15,RS15                                                 38790021
         STM   R0,R13,BSAVE                                             38796021
         L     RCOM,COSADR         ADDRESS OF COMMON IN REGISTER RC     38802021
         ST    R14,RETURN                                               38808021
DIC010   TM    FSTSW,XX20           IS IT END OF FILE SECTION.          38814021
         BC    ZERO,DIC008         GO TO NO CHECK FOR REDEF             38820021
         TM    FSTSW,XX80           YES, WAS THERE AN FD, SD, OR SA     38826021
         BC    ZERO,*+NX8           NO, BRANCH AROUND DELIMIT           38832021
         BAL   R4,DIC19A           YES, CALL ENTER DELIMITOR            38838021
SKIPBAL  L     R15,ADICTB                                               38844021
         BAL   R14,ADP049          RESOLVE BASE LOCTR'S FOR LAST FD     38850021
         MVC   WKAR(LX1),MCI        SAVE MAJOR CODE                     38856021
         MVN   MCI(LX1),PCOUNT      REPLACE WITH LAST MAJOR CODE        38862021
         BAL   R14,DIC060          RESOLVE = OF BASE LOC'D              38868021
         MVC   MCI(LX1),WKAR        RESTORE CURRENT MAJOR CODE          38874021
         CLI   MCI,XX05             IF WORKING-STORAGE OR REPORT        38880021
         BC    EQ,DIC006            SECTION , AND LAST WAS FD           38886021
         CLI   MCI,XX04              TAKE 1 OFF NO. OF BL'S SINCE       38892021
         BC    LO,DIC006            BL CTR WAS IP'D BY SECTION          38898021
       BCTR  R2,R0                 DECREASE R2 BY 1                     38904021
         STC   R2,FDBLN                                                 38910021
DIC006   L     R15,AFSEND                                               38916021
         BALR  R14,R15             GO TO PRIME ROUTINE                  38922021
         L     R15,ADICTB                                               38928021
         NI    XTNSBL,XXFE          TURN OFF SW IF SET ON BY FSEND      38934021
DIC008   CLI   CILEV,XX34           DO NOT CHECK FOR REDEF IF FD,SD,    38940021
         BC    NOTLO,DIC018        BRANCH TO LOOK AT CI LEVEL           38946021
DIC011   TM    MINCOD,XX01          IS CI REDEFINING A PREVIOUS ITEM    38952021
         BC    ZERO,DIC018            NO.                               38958021
         TM    FES,XX20             PRIME THE REDEFINE TABLES IF NEE    38964021
         BC    ONES,DIC012         BRANCH IF TABLES ARE PRIMED .        38970021
         LA    R1,RNMPAR              REDEFINE NAME TABLE.              38976021
         L     R15,BPRIME                                               38982021
         BALR  R14,R15             GO TO PRIME ROUTINE                  38988021
         L     R15,BINSRT          MAKE A DUMMY RNMTBL ENTRY.           38994021
         L     R1,RNMPAR                                                39000021
         BALR  R14,R15             GO TO INSERT ROUTINE                 39006021
         XC    DX0(LX5,R2),DX0(R2)                                      39012021
         LA    R1,RDFPAR              REDEFINE STACK.                   39018021
         L     R15,BPRIME                                               39024021
         BALR  R14,R15             GO TO PRINE ROUTINE                  39030021
         L     R15,BINSRT          MAKE A DUMMY RDFSTK ENTRY.           39036021
         L     R1,RDFPAR                                                39042021
         BALR  R14,R15             GO TO ENTRY LENGTH IN BYTES          39048021
         XC    DX0(LX12,R2),DX0(R2)                                     39054021
         OI    FES,XX20                                                 39060021
DIC012   L     R15,AREDEF          CALL REDEF FOR REDEFINES PROCESS     39066021
         BALR  R14,R15             GO TO REDEF                          39072021
         L     R15,RS15                                                 39078021
DIC018   CLI   CILEV,XX31           IS CI LEVEL BETWEEN 01 AND 49.      39084021
         BC    NOTHI,DIC020        GO TO SEE IF CI IS GROUP ITEM        39090021
         CLI   CILEV,XX34                                               39096021
         BC    LO,DIC050           GO TO SPECIAL ITEM PROCESSING        39102021
         TM    FSTSW,XX80           IS THIS 1ST FD,SD,SA                39108021
         BC    ZERO,DIC019         YES, BRANCH                          39114021
         BAL   R4,DIC19A           NO , CALL ENTER DELIMITOR            39120021
DIC019   L     R15,AFST00          CALL ROUTINE FST000 TO PROCESS       39126021
         BALR  R14,R15              FD, SD, SA, RD                      39132021
         L     R15,ADICTB                                               39138021
         MVC   LASTDP(LX4),DICTPT   MOVE CURRENT DICT. PTR. TO LAST     39144021
*                                   DICT. PTR                           39150021
         CLI   SRCELN,XX36          IS THIS SD                          39156021
         BNE   DIC19Y              NO                                   39162021
         MVI   PCOUNT,XX01          YES, IN CASE NO 01                  39168021
DIC19Y   LM    R0,R13,BSAVE        RESTORE REGS                         39174021
         L     R14,RETURN                                               39180021
         BCR   UNCOND,R14          RETURN TO CALLER                     39186021
DIC19A   MVC   PARAM(LX4),LASTDP    NO, ENTER DELIMITOR ON LAST FD,S    39192021
         MVC   PARAM1(LX4),DICTPT    WITH CURRENT DICT. PTR.            39198021
         LA    R1,PARAM                                                 39204021
         L     R15,AENTDE                                               39210021
         BALR  R14,R15             GO TO ENTDEL:STORES DELIM            39216021
         BCR   UNCOND,R4           BRANCH                               39222021
*                                                                       39228021
*  IS CI A GROUP ITEM.                                                  39234021
DIC020   SR    R1,R1                                                    39240021
         IC    R1,MINCOD                                                39246021
         SRL   R1,DX4(R0)                                               39252021
         C     R1,ONE                                                   39258021
         BC    EQ,DIC030           GROUP ITEM,(FIXED LENGTH)            39264021
         C     R1,FOUR                                                  39270021
         BC    EQ,DIC030           GROUP ITEM. (VAR. LENGTH)            39276021
*                                                                       39282021
*  ELEMENTARY ITEM, CALL ELIPR ROUTINE FOR PROCESSING.                  39288021
*                                                                       39294021
         L     R15,AELIPR                                               39300021
         BALR  R14,R15             PROCESS CI WHICH ARE ELEMENTRY       39306021
         L     R15,ADICTB                                               39312021
         CLI   NXTLEV,XX34          IF NEXT ITEM IS A FD, GO TO PROC    39318021
         BC    EQ,DIC022           RD                                   39324021
         BC    LO,DIC023           SET UP FOR DICT BUILD RTN            39330021
         CLI   MCI,XX06             IF REPORT SECTION NAND RD           39336021
         BC    EQ,DIC025            RETURN (RSDUP-TEXT)                 39342021
DIC022   BAL   R14,ADP049          RESOLVE BASE LOCATOR COUNTERS        39348021
         BAL   R14,DIC060          GO TO GET NO. BL'S FOR FD            39354021
DIC023   L     R15,ADICTB                                               39360021
         TM    TBLSW,XX10           SUBJECT OF TABLE                    39366021
         BZ    DIC025              N/                                   39372021
         CLI   NUMKEY,XX00                                              39378021
         BE    DIC024              NO                                   39384021
         LH    R0,MSG17                                                 39390021
         L     R15,AERRTN                                               39396021
         BALR  R14,R15             CALL ERROR ROUTINE                   39402021
         L     R1,ATBLSH                                                39408021
         L     R1,DX0(R1)                                               39414021
         L     R1,DX0(R1)                                               39420021
         AH    R1,IDDISP                                                39426021
         OI    DX4(R1),KEYERR       SET FLAG ON FOR PHASE3              39432021
DIC024   L     R15,ASR200          YES                                  39438021
         BALR  R14,R15             GET ID NO.,LENGTH OF INDEX NAME      39444021
DIC025   LM    R0,R13,BSAVE                                             39450021
         L     R14,RETURN                                               39456021
         BR    R14                 BRANCH                               39462021
*                                                                       39468021
*  GROUP ITEM, CALL GRIPR ROUTINE FOR PROCESSING.                       39474021
*                                                                       39480021
DIC030   L     R15,AGRIPR                                               39486021
         BALR  R14,R15             LNK TO ADDR IN REG 15                39492021
         L     R15,ADICTB                                               39498021
         TM    TBLSW,XX10           SUBJECT OF TABLE                    39504021
         BZ    DIC035              N/                                   39510021
         L     R15,ASR200          YES                                  39516021
         BALR  R14,R15             GET ID NO.,LENGTH OF INDEX NAME      39522021
DIC035   LM    R0,R13,BSAVE                                             39528021
         L     R14,RETURN                                               39534021
         BCR   UNCOND,R14          EXIT.                                39540021
*                                                                       39546021
*  LEVEL NO. IS 77 OR 88-- GO TO SPECIAL ITEM PROCESSING (SPIR)         39552021
*                                                                       39558021
DIC050   L     R15,ASPIR                                                39564021
         BALR  R14,R15             GO TO SPECIAL ITEM PROCESSING        39570021
         L     R15,ADICTB                                               39576021
         CLI   NXTLEV,XX34          IF NEXT ITEM IS A FD, GO TO PROC    39582021
         BC    LO,DIC051           BRANCH                               39588021
         BAL   R14,ADP049          BRANCH                               39594021
         BAL   R14,DIC060          BRANCH                               39600021
DIC051   LM    R0,R13,BSAVE                                             39606021
         L     R14,RETURN                                               39612021
         BCR   UNCOND,R14          EXIT.                                39618021
DIC060   SR    R1,R1               GET NO. OF BASE LOCATORS FOR FD      39624021
         TM    MCI,XX05          FD?                                    39630021
         BNM   DIC062             YES.                                  39636021
*                                  FOR SD SAME  REC AREA INCRE BLN      39642021
         CLI   SRANO,XX00          SD SRA INDICATED ?                   39648021
         BNE   DIC062              YES, FIND OUT BLN                    39654021
         IC    R1,SDBLL            NO,  SD                              39660021
         LH    R2,BLLCTR                                                39666021
         SR    R2,R1               = BLL = LAST BLL- FIRST BLL +1       39672021
         A     R2,ONE                                                   39678021
         STC   R2,SDBLN                                                 39684021
         BC    UNCOND,DIC064       BRANCH                               39690021
DIC062   L     R15,ADICTB                                               39696021
         IC    R1,FD+NX2                                                39702021
         LH    R2,BLCTR                                                 39708021
         SR    R2,R1               =BL = LAST BL - FIRST BL +1          39714021
         A     R2,ONE                                                   39720021
         STC   R2,FDBLN                                                 39726021
DIC064   BCR   UNCOND,R14          BRANCH                               39732021
         EJECT                                                          39738021
*=2   EXTENT RESOLVE ROUTINE (XTEN)                                     39744021
*=E            WORKING-STORAGE SECT REQUIRES MORE THAN 131K.            39750021
*=E            DATA DIVISION SECT EXCEEDS 32K.                          39756021
*=E            OBJECT OF REDEFINES IS OF VARIABLE LENGTH.               39762021
*=E            LENGTH OF REDEFINES IS GREATER THAN ITS OBJECT'S.        39768021
*                                                                       39774021
*  XTEN ROUTINE IS CALLED TO PROCESS THE GROUP LENGTH STACK (GLS)       39780021
*     WHENEVER THE EXTENT OF A GROUP OR GROUPS IS TERMINATED.           39786021
*     LGS CONTAINS THE ADDRESS OF THE LAST ENTRY IN GLS.                39792021
*     INPUT  --  GROUP LENGTH STACK, A TAMMER TABLE.                    39798021
*     OUTPUT  --  GROUP LENGTH ARE PROPAGATED BACK TO HIGHER GROUPS     39804021
*                 AND LGS IS UPDATED TO POINT TO THE NEXT ITEM IN G     39810021
*                                                                       39816021
XTEN     EQU   *                                                        39822021
         ST    R14,RS14B                                                39828021
         L     R15,ADICTB          INITIALIZE R15 TO VALUE OF 1ST U     39834021
       BAL   R14,XTN500            BRANCH                               39840021
       L     R14,RS14B                  RESTORE R14                     39846021
         CLC   CILEV(LX1),DX20(R9)                                      39852021
         BCR   HI,R14              BRANCH                               39858021
         MVC   APAFSV(LX7),APAF         SAVE APAF AS IT IS IN     42027 39864021
*  CASE IN REPT SECT & GRP BEING RESOLVED IN LNK SECT             42027 39870021
XTN001   TM    DX0(R9),XX80         IS BOUNDARY ALIGNMENT NECESSARY.    39876021
         BC    ZERO,XTN000         NO CALL ACCESS                       39882021
       L     R15,ATASSR           IF IT IS, CALL TASSR FOR              39888021
         STM   R9,R10,LGS                                               39894021
       BALR  R14,R15                  BOUNDARY ALIGNMENT.               39900021
         L     R15,ADICTB          RESTORE REGISTER.                    39906021
       LM    R9,R10,LGS                                                 39912021
XTN000   MVC   PARAM+NX1(LX3),DX13(R9) CALL ACCESS                      39918021
         MVI   PARAM,XX04                                               39924021
         LA    R1,PARAM                                                 39930021
         L     R15,ALATRP                                               39936021
         BALR  R14,R15             GO LOCATE ATTRIBUTES                 39942021
         L     R15,ADICTB                                               39948021
         SR    R1,R1               CLEAR                                39954021
         IC    R1,DX0(R2)           GET MAJOR CODE                      39960021
         N     R1,MK3032           GET RID OF OTHER BITS                39966021
         STC   R1,PMCI                                                  39972021
         CLC   DX10(LX3,R9),ZEROS    SUBJECT OF REDEFINES               39978021
         BC    HI,XTN100              YES, BRANCH                       39984021
         B     XTN10A              ALREADY LOCATED                      39990021
*                                                                       39996021
*  LGS NOT SUBJECT OF REDEFINED, AND IT IS FIXED LENGTH.                40002021
*                                                                       40008021
XTN010   MVC   PARAM+NX1(LX3),DX13(R9) CALL ACCESS FOR ATTRIB ADDRESS   40014021
         MVI   PARAM,XX04           SET LATRPT CODE                     40020021
         LA    R1,PARAM                                                 40026021
         L     R15,ALATRP                                               40032021
         BALR  R14,R15             GO TO ACCESS RTN 'LATRPT'            40038021
         L     R15,ADICTB                                               40044021
XTN10A   EQU    *                                                       40050021
         CLI   DX20(R9),XX01        SAVE 01 GROUP LENGTH IN EITHER      40056021
         BC    NOTEQ,XTN014           MAXIM OR MINIM CELL.              40062021
         TM    DX1(R9),XX40         WAS 01 A VAR. LGN. GROUP            40068021
         BC    NOTONE,XTN011       NO                                   40074021
         MVI   QCALL+NX1,XX4E       YES, PUT OUT                        40080021
         LR    R5,R2               SAVE ATTRIBUTES ADDRESS DURING P     40086021
         LA    R2,QCALL              QRET3                              40092021
         LA    R3,DX2                   ON                              40098021
         LR    R1,R11                    FILE 2                         40104021
         BALR  R0,R1               BRANCH                               40110021
         DC    X'12'                                                    40116021
         LR    R2,R5               RESTORE ADDRESS OF ATTRIBUTES        40122021
XTN011   L     R1,DX0(R9)                                               40128021
         N     R1,MK1632                                                40134021
         TM    DX1(R9),XX40         IF VARIABLE LGN GROUP               40140021
         BC    NOTONE,XTN11A       GET LENGTH FROM MAX. LGN CELL        40146021
         L     R1,DX16(R9)                                              40152021
         OI    BUFOPT,XX02                                              40158021
XTN11A   LR    R4,R1               SAVE 01 LGN                          40164021
         TM    PLBLSW,XX40         LBL RCD?                             40170021
         BO    XTNLBL1             BRANCH                               40176021
         CL    R1,MAXIM                                                 40182021
         BC    LO,XTN012           BRANCH                               40188021
         ST    R1,MAXIM            LONGEST RECORD LENGTH SO FAR.        40194021
XTN012   CL    R1,MINIM                                                 40200021
         BC    HI,XTN014           GO TO MOVE LGS ADD. PAR. TO DIC      40206021
         ST    R1,MINIM                                                 40212021
         B     XTN014              GO TO MOVE LGS ADD. PAR. TO DIC      40218021
XTNLBL1  CL    R1,LBLMAX                                                40224021
         BL    XTN014              GO TO MOVE LGS ADD. PAR. TO DIC      40230021
         ST    R1,LBLMAX                                                40236021
         B     XTN014              GO TO MOVE LGS ADD. PAR. TO DIC      40242021
XTN014   MVC   DX2(LX3,R2),DX21(R9)  MOVE LGS ADD. PAR. TO DICT. IN C   40248021
*                                   IT WAS CHANGED BECAUSE OF SLACK     40254021
         MVC   DX7(LX2,R2),DX2(R9)  MOVE LGN OR VLC# INTO ATTRIB.       40260021
         TM    DX1(R9),XX40             IS GRP VAR LGN            49549 40266021
         BC    ZERO,XTN14D                 NO, BR                 49549 40272021
         L     R4,DX16(R9)              GET LGN OF VAR GRP        49549 40278021
         C     R4,CO4096                IS ONLY 1 BLL NEEDED      49549 40284021
         BC    NOTHI,XTN14D              YES - 0 INDICATES THAT   49549 40290021
*  ONLY 1 BLL IS NEEDED; 1 INDICATES 2 BLLS, 2 INDICATES 3, ETC.  49549 40296021
XTN14C   SRDA  R4,DX32                  CALCULATE NO.             49549 40302021
         D     R4,CO4096                OF BLL'S NEEDED           49549 40308021
         LTR   R4,R4                    FOR PHASE 51              49549 40314021
         BC    ZERO,XTN14E               ENTRY CODING             49549 40320021
         LA    R5,DX1(R5)               NO BLLS NEEDED IN R5      49549 40326021
XTN14E   BCTR  R5,R0                    SUBT 1 AND PUT            49549 40332021
         SLL   R5,DX4                   IN DICT ( NEXT TO         49549 40338021
         EX    R5,SETBLL                      VLC NO. )           49549 40344021
XTN14D   EQU   *                                                  49549 40350021
         TM    DX0(R9),XX08         VALUE ON GROUP                      40356021
         BZ    XTN13D              NO                                   40362021
         CLI   DX20(R9),XX01        IS THIS 01                          40368021
         BE    XTN14A              YES, DIN'T NEED NEXT CHECK           40374021
         LR    R1,R9                                                    40380021
         S     R1,CON24            POINT TO PRIOR ENTRY                 40386021
         TM    DX0(R1),XX08         VALUE ON PREVIOUS GROUP             40392021
         BO    XTN13D              BRANCH                               40398021
XTN14A   EQU   *                                                  07762 40404021
         TM    DX1(R9),XX40  VAR LGN GRP?                         07762 40410021
         BC    ZERO,XTN14A1  NO                                   07762 40416021
         BAL   R6,XTNERR     YES - IGNORE VALUE ON VAR LGN GRP    07762 40422021
         DC    X'10D3'       MSG 211                              07762 40428021
         BC    UNCOND,XTN13D SKIP VALUE ON GRP PROCESSING         07762 40434021
XTN14A1  TM    DX35(R9),XXFF USAGE OTHER THAN DISPLAY?            07762 40440021
         BZ    XTN14B              NO                                   40446021
         BAL   R6,XTNERR           YES, ERROR                           40452021
         DC    X'20C0'             MSG 192                              40458021
         B     XTN13D              GO TO TEST FOR 88 UNDER GROUP        40464021
SETBLL   OI    DX7(R2),XX00             NO OF BLLS FOR VAR GRP    49549 40470021
XTN14B   L     R1,AVALGR                                                40476021
         L     R1,DX0(R1)                                               40482021
         L     R1,DX0(R1)                                               40488021
         AH    R1,DX30(R9)          POINT TO PROPER ENTRY               40494021
         MVC   DX5(LX2,R1),DX2(R9)   INSERT LENGTH                      40500021
*                                  CHECK IF FIG CONSTANT          38302 40506021
         TM    DX4(R1),XXFF        ALL CONSTANT (FIG. CONT.)      38302 40512021
         BO    XTN13B              GO TO PROCESS FOR FIG. CONST   38302 40518021
         MVC   ADDRES(LX2),DX2(R9) MOVE GROUP LENGTH              38302 40524021
         CLC   ADDRES(LX2),ZEROS        IS GRP LGN 0              03746 40530021
         BNE   XTN14BB                   NO, BR                   03746 40536021
         MVC   DX3(LX1,R9),DX7(R1)      YES-MAKE GRP LGN          03746 40542021
         MVC   DX8(LX1,R2),DX7(R1)      EQUAL TO LITERAL          03746 40548021
         B     XTN13AA                  LGN IN GPLSTK AND         03746 40554021
*         VALGRP TABLES AND ISSUE MESSAGE                         03746 40560021
XTN14BB  SR    R6,R6                     INSERT LITERAL LGN       03746 40566021
         IC    R6,DX7(R1)          TO COMPARE LENGTH OF LIT AND   38302 40572021
         CH    R6,ADDRES           GOUP LENGTH                    38302 40578021
         BE    XTN13B              YES                                  40584021
         BL    XTN13A              LESS                                 40590021
* LITERAL IS LONGER THAN GROUP                                          40596021
* TRUNCATE LITERAL                                                      40602021
         BAL   R6,XTNERR           GO GENERATE                          40608021
         DC    X'107E'             MSG 126                              40614021
         MVC   ADDRES(LX2),DX2(R9)                                      40620021
         LH    R6,ADDRES                                                40626021
         MVC   DX7(LX1,R1),DX3(R9)   CHANGE LENGTH OF LITERAL           40632021
         B     XTN13C              BRANCH                               40638021
XTN13A   CLI   DX4(R1),XXFF         ALL FIG CONSTANT                    40644021
         BE    XTN13B              YES                                  40650021
* LITERAL IS LESS THAN GROUP LENGTH                                     40656021
* LENGTH OF LITERAL ASSUMED                                             40662021
XTN13AA  BAL   R6,XTNERR                   GO GENERATE            03746 40668021
         DC    X'108D'             MSG 141                              40674021
         MVI   DX5(R1),XX00                                             40680021
         MVC   DX6(LX1,R1),DX7(R1)   CHANGE LENGTH TO LITERAL LENGTH    40686021
XTN13B   SR    R6,R6                                                    40692021
         IC    R6,DX7(R1)                                               40698021
XTN13C   TM    DX4(R1),XXFF         ALL                                 40704021
         BO    XTN13G              BRANCH                               40710021
         BCTR  R6,R0               NO, DELETE 2ND COUNT                 40716021
         EX    R6,XTNLIT                                                40722021
XTN13G   A     R6,EIGHT                                                 40728021
*                            BEFORE GENERATE A-TXT FOR CONTSTANT  38302 40734021
*                            CHECK LENGTH FIELD  ZERO             38302 40740021
CHKLGTH  DS    0H                                                 38302 40746021
         TM    DX4(R1),XXFF        IS THIS ALL CON                38302 40752021
         BNO   CHKLGTH1            NOT,  BRANCH TO CHECK          38302 40758021
         CLC   DX7(LX1,R1),ZEROS   IS THIS ZERO LENGTH            38302 40764021
         BH    CHKLGTH2            GENERATE A-TEST                38302 40770021
         MVC   DX7(LX1,R1),ONE+DX3    INSERT LENGH ONE            38302 40776021
         B     CHKLGTH2            GENERATE A-TEST                38302 40782021
CHKLGTH1 DS    0H                                                 38302 40788021
         CLC   DX5(LX2,R1),ZEROS   CHECK ZERO IN NON-FIG. CON.    38302 40794021
         BNH   XTN13D          DO NOT GENERATE A-TXT              38302 40800021
CHKLGTH2 DS    0H                                                 38302 40806021
         ST    R6,NMPUT                                                 40812021
         ST    R1,ADDRES                                                40818021
         L     R15,APUTOT                                               40824021
         BALR  R14,R15             PUT OUT DATA-A TEXT                  40830021
         L     R15,ADICTB                                               40836021
XTN13D   TM    DX0(R9),XX04         88'S UNDER GROUP                    40842021
         BZ    XTN013              NO                                   40848021
         TM    DX34(R9),XXFF        USAGE OTHER THAN DISPLAY            40854021
         BZ    XTN13K              NO                                   40860021
         BZ    XTN13K              NOT DISPLAY                          40866021
         BAL   R6,XTNERR           YES, ERROR                           40872021
         DC    X'20C0'             MSG 192                              40878021
         B     XTN013              BRANCH                               40884021
XTN13K   L     R1,PVALTR           CHECK LENGTHS                        40890021
         L     R1,DX0(R1)                                               40896021
         LH    R6,DX4(R1)           GET DISPL                           40902021
         CH    R6,VALDSP     -                                          40908021
         BE    XTN013              NO                                   40914021
         L     R1,DX0(R1)                                               40920021
         LA    R1,DX0(R1)                                               40926021
         LR    R6,R1                                                    40932021
         A     R6,END88            POINT TO END                         40938021
         ST    R6,END88            SAVE TO CHECK                        40944021
         AH    R1,DX32(R9)          POINT TO PROPER ENTRY               40950021
XTN13E   CLI   DX1(R1),XX75         FIGCON                              40956021
         BE    XTN13F              GO CHECK NEXT                        40962021
         CLC   DX2(LX1,R1),DX3(R9)   NO, CHECK LENGTH                   40968021
         BE    XTN13F              BRANCH                               40974021
* LENGTH OF LITERAL DOES NOT EQUAL LENGTH OF GROUP                      40980021
*                                                                       40986021
         CLC   DX3(LX1,R9),ZEROS        IS GRP LGN 0              40625 40992021
         BNE   XTN13F1             BRANCH TO XTN13F1              40625 40998021
         MVC   DX3(LX1,R9),DX2(R1) INSERT VALUE LENGTH            40625 41004021
         MVC   DX8(LX1,R2),DX2(R1)    INSERT VAL LENGTH TO DIC    40625 41010021
XTN13F1  DS    0H                                                 40625 41016021
         BAL   R6,XTNERR           GO GENERATE                          41022021
         DC    X'108D'             MSG 141                              41028021
         B     XTN13I              SET UP END                           41034021
XTN13F   SR    R6,R6                                                    41040021
         IC    R6,DX0(R1)           GET COUNT OF ENTRY                  41046021
         N     R6,MK2632           IN CASE VALUE THRU             09498 41052021
         LA    R1,DX1(R6,R1) PT TO BYTE AFTER LAST VALTRU ENTRY   05913 41058021
         CLI   DX0(R1),XXFF  END OF ENTRY INDICATOR 'FF'?         05913 41064021
         BNE   XTN13F0       NO - CHK NXT VALUE IN SERIES OR THRU 05913 41070021
         LA    R1,DX1(R1)    PT PAST 'FF' TO NEXT ENTRY           05913 41076021
XTN13F0  EQU   *                                                  05913 41082021
         C     R1,END88            AT END OF GROUP                      41088021
         BL    XTN13E              GO CHECK NEXT                        41094021
XTN13I   XC    END88(LX2),END88     CLEAR HIGH ORDER BYTES              41100021
         MVC   END88+NX2(LX2),DX32(R9) RESET PTR FOR ENTRY              41106021
XTN13J   TM    DX0(R9),XX30                                             41112021
         BZ    XTN013              NO                                   41118021
         BAL   R6,XTNERR           GO GENERATE                          41124021
         DC    X'10BF'               MSG 191                            41130021
XTN013   TM    DX1(R9),XX01                                             41136021
         BC    ZERO,XTN015         GO TO TEST FOR VAR. LGN GROUP        41142021
         OI    DX6(R2),XX01                                             41148021
XTN015   TM    DX1(R9),XX40         IS LGS A VAR. LGN GROUP             41154021
         BC    NOTONE,XTN016       NO                                   41160021
         XI    DX1(R2),XX50         YES, SET MINOR CODE TO VAR. LGN     41166021
         OI    XTNSBL,XX01          TURN ON SW FOR ADPAR                41172021
XTN016   TM    DX0(R9),XX40         IS Q-BIT ON IN LGS                  41178021
         BC    NOTONE,XTN16A       NO, BRANCH                           41184021
         OI    DX6(R2),XX02        YES, SET Q-BIT ON IN ATTRIB.         41190021
XTN16A   MVC   PARAM1(LX4),DICPNT                                       41196021
         MVI   PARAM,XX00                                               41202021
         MVC   PARAM+NX1(LX3),DX13(R9)  DICT. POINTER OF GLS.           41208021
         LA    R1,PARAM            SETUP THE PARAMETER LIST, AND        41214021
         L     R15,AENTDE          CALL ACCESS TO ENTER DICT.           41220021
       BALR  R14,R15                  POINTER WHICH DELIMITS THE GR     41226021
         L     R15,ADICTB                                               41232021
         CLI   DX24(R9),XX00        ANY IDS                             41238021
         BE    XTN16C              NO                                   41244021
*                                                                       41250021
* FINISH PROCESSING FOR TABLE HANDLING                                  41256021
*                                                                       41262021
         MVC   IDLNTH(LX2),DX2(R9)   SUBJECT LENGTH TO ATTRIB.          41268021
         L     R5,ATBLSH                                                41274021
         L     R5,DX0(R5)                                               41280021
         L     R5,DX0(R5)                                               41286021
         LA    R5,DX0(R5)                                               41292021
         AH    R5,DX26(R9)          ADD DISPL FOR ENTRY                 41298021
         SR    R7,R7                                                    41304021
         IC    R7,DX24(R9)          COUNT OF ID NAMES                   41310021
XTN162   MVC   PARAM+NX1(LX3),DX9(R5) PTR TO INDEX NAME                 41316021
         LA    R5,DX3(R5)           INCREMENT                           41322021
         MVI   PARAM,XX04                                               41328021
         LA    R1,PARAM                                                 41334021
         L     R15,ALATRP          LOCATE ATTRIBUTES                    41340021
         BALR  R14,R15             BRANCH TO LOCATE ATTRIBUTES          41346021
         L     R15,ADICTB                                               41352021
         TM    DX1(R9),XX40         VLC SUBJECT                         41358021
         BZ    XTN163              NO                                   41364021
         OI    DX1(R2),XX80         SET FLAG ON                         41370021
XTN163   EQU   *                                                        41376021
         MVC   DX4(LX2,R2),IDATT+NX4 APPEND PROPER LENGTH               41382021
         BCT   R7,XTN162           GO TO GET PTR TO INDEX NAME          41388021
         CLI   DX25(R9),XX00        ANY KEYS                            41394021
         BE    XTN16C              NO                                   41400021
         L     R1,ATBLSH                                                41406021
         L     R1,DX0(R1)                                               41412021
         L     R1,DX0(R1)                                               41418021
         LA    R1,DX0(R1)                                               41424021
         AH    R1,DX26(R9)          POINT TO PROPER ENTRY               41430021
         SR    R8,R8                                                    41436021
         IC    R8,DX8(R1)           GET COUNT OF KEYS                   41442021
         LA    R6,DX2(R8,R8)                                            41448021
         LA    R6,DX0(R6,R8)                                            41454021
         LA    R8,DX8(R6,R1)        POINTS TO 1ST KEY ENTRY             41460021
         IC    R7,DX25(R9)          GET COUNT                           41466021
         L     R5,AKEYTB                                                41472021
         L     R5,DX0(R5)                                               41478021
         L     R5,DX0(R5)                                               41484021
         LA    R5,DX0(R5)                                               41490021
         AH    R5,DX28(R9)          POINT TO PROPER ENTRY               41496021
         ST    R2,RS3                                                   41502021
XTNA16   XC    LITBUF(LX34),LITBUF  CLEAR AREA                          41508021
         SR    R6,R6                                                    41514021
         IC    R6,DX1(R5)           COUNT OF NAME                       41520021
         EX    R6,KEYFND           MOVE KEY                             41526021
         LA    R1,LITBUF                                                41532021
         ST    R1,WKAREA                                                41538021
         MVI   WKAREA,XX0C          SET                                 41544021
         MVI   WKAREA+NX4,XX00        UP                                41550021
         MVC   WKAREA+NX5(LX3),DX13(R9)  PARAMETER                      41556021
         LA    R1,WKAREA                                                41562021
         L     R15,ALATGP                                               41568021
         BALR  R14,R15             BRANCH TO ACCESS RTN 'LATGRP'        41574021
         CL    R15,ZEROS           ERROR FOUNR                          41580021
         L     R15,ADICTB                                               41586021
         BNE   XTNC16              YES                                  41592021
         TM    DX0(R5),ASCKEY       IS KEY ASCENDING                    41598021
         BZ    XTNB16              NO                                   41604021
         OI    DX5(R2),ICLASC       SET ASC KEY BIT ON                  41610021
XTNB16   OI    DX5(R2),ICLKEY       SET KEY BIT ON                      41616021
         ST    R3,RS4                                                   41622021
         MVC   DX0(LX3,R8),RS4+NX1                                      41628021
         LA    R8,DX3(R8)           INCREMENT                           41634021
         LA    R5,DX2(R5,R6)        POINT TO NEXT ENTRY                 41640021
         BCT   R7,XTNA16           BRANCH                               41646021
*DEL                                                                    41652021
*DEL                                                                    41658021
*DEL                                                                    41664021
         L     R2,RS3                                                   41670021
         B     XTN16C              BRANCH                               41676021
*                                                                       41682021
KEYFND   MVC   LITBUF(LX1),DX1(R5)                                      41688021
XTNLIT   MVC   DX7(LX0,R1),DX8(R1)                                      41694021
*                                                                       41700021
XTNC16   L     R2,ATBLSH                                                41706021
         L     R2,DX0(R2)                                               41712021
         L     R2,DX0(R2)                                               41718021
         LA    R2,DX0(R2)                                               41724021
         AH    R2,DX26(R9)          POINT TO PROPER ENTRY               41730021
         OI    DX4(R2),KEYERR       SET FLAG ON FOR PHASE3              41736021
         L     R2,RS3                                                   41742021
XTN16C   TM    DX1(R10),XX40                                            41748021
         BC    ONES,XTN300            BRANCH IF YES, OTHERWISE          41754021
         CLI   DX20(R9),XX01        IS LGS LEVEL 01                     41760021
         BC    NOTEQ,XTN16B        NO                                   41766021
         SR    R5,R5               YES, R4= LGN OF LGS                  41772021
         BC    UNCOND,XTN17A            R5= 0 ( NO GIG )                41778021
*                                                                       41784021
*  VLC NOT ASSIGNED TO GIG, AND LGS NOT SUBJECT OF AN OCCURS CLAUSE     41790021
*                                                                       41796021
XTN16B   L     R5,DX0(R10)          GET L(GIG) IN R5 AND R8             41802021
         N     R5,MK1632                                                41808021
         LR    R8,R5                                                    41814021
XTN017   L     R4,DX0(R9)           L(LGS) IN R4                        41820021
         N     R4,MK1632                                                41826021
XTN17A   CLC   DX10(LX3,R9),ZEROS    IF LGS IS SUBJECT OF REDEFINES     41832021
         BC    HI,XTN125             BRANCH                             41838021
XTN018   CLC   DX6(LX2,R9),ZEROS     IS THIS LGS SUBJECT OF AN OCCURS   41844021
         BC    NOTEQ,XTN025          BRANCH                             41850021
         AR    R5,R4               L(GIG) = L(GIG) + L(LGS)             41856021
         BC    UNCOND,XTN030       BRANCH                               41862021
*                                                                       41868021
*  VLC NOT ASSIGNED TO GIG, AND LGS IS SUBJECT OF OCCURS CLAUSE.        41874021
*                                                                       41880021
XTN025   OI    FES,XX08             ADPAR SW DENOTES APAF HAS           41886021
*                                      BEEN UPDATED                     41892021
         LH    R7,DX6(R9)           GET NOC FROM LGS                    41898021
         LR    R1,R7                                                    41904021
         SH    R7,ONE+NX2           CALCULATE L(LGS) * (NOC-1)          41910021
         MR    R6,R4               R7 HAS L(LGS) * (NOC-1) =X           41916021
         LR    R6,R7                                                    41922021
         LR    R5,R6                                                    41928021
         A     R7,DISP             DISP = DISP + L(LGS) * (NOC-1)       41934021
         ST    R7,DISP             STORE UPDATED LENGTH IN DISP.        41940021
         TM    DX21(R9),XX10        FOR ITEMS IN LINKAGE SECTION OR     41946021
         BC    ONES,XTN026           SORT-DISCRIPTION, NO STORAGE S     41952021
         CLI   PMCI,XX05            IS ITEM IN LINKAGE SECTION          41958021
         BE    XTN026              YES, DON'T ADD TO LOCCTR             41964021
         CLI   PMCI,XX00                IS IT THE FILE SECT       45078 41970021
         BNE   XTN025C                     NO, BR                 45078 41976021
         CLC   FDDCBNO(LX1),PRDCBNO     YES, FIND OUT IF GRP      45078 41982021
*  BEING RESOLVED IS IN PRESENT FD OR PREV. FD                    45078 41988021
         BL    XTN026                   PREV FD, DONT INCR LOCCTR 45078 41994021
         CLI   CILEV,XX01               PRES-IS CURR ITM A LEV 01 48456 42000021
         BE    XTN026                   YES, DONT INCR LOCCTR     48456 42006021
XTN025C  EQU   *                                                  45078 42012021
         A     R5,LOCCTR                                                42018021
         ST    R5,LOCCTR                                                42024021
XTN026   CL    R7,CO4096           IS DISP GREATER THAN 4096            42030021
         BNL   XTN027              EQUAL OR GREATER               57835 42036021
         MVC   APAF+NX1(LX1),DISP+NX3 UPDATE D FIELD OF APAF.           42042021
         MVN   APAF(LX1),DISP+NX2                                       42048021
         BC    UNCOND,XTN028       BRANCH                               42054021
XTN027   MVC   WKAR(LX4),RS14B      SAVE R14                            42060021
         STM   R3,R6,RS3           SAVE REGS FOR ADP049 RESTORE         42066021
         BAL   R14,ADP049          BRANCH                               42072021
         MVC   RS14B(LX4),WKAR                                          42078021
XTN028   MVC   WKAR(LX1),COUNT      IF ITEM IS LINKAGE-WORKING STORA    42084021
         XC    WKAR(LX1),PCOUNT      BOUNDARY SAVE UPDATED APAF         42090021
         NI    WKAR,XX0F                                                42096021
         CLI   WKAR,XX01                                                42102021
         BC    NOTEQ,XTN029        NO                                   42108021
         MVC   RAPAF(LX7),APAF      YES                                 42114021
XTN029   MR    R0,R4               NOC * L(LGS) + L(GIG)                42120021
         ST    R1,MTEMP            SAVE NOC*L(LGS) IN CASE OF GIG V     42126021
         AR    R1,R8                                                    42132021
         LR    R5,R1                                                    42138021
XTN030   CLI   PMCI,XX04            MAJOR CODE FOR WS SECTION           42144021
         BC    EQ,XTN035           YES, BRANCH ( IT IS WK-ST )          42150021
         CLI   PMCI,XX05            IN LINK AGE SECTION                 42156021
         BE    XTN035              YES                                  42162021
XTN032   C     R5,CON32K                                                42168021
         BC    NOTHI,XTN040        VAR GROUP IN W-S SECT OR GROUP       42174021
*                                  NOT IN WORK-ST G.T. 32767            42180021
         BAL   R6,XTNERR           GO GENERATE                          42186021
         DC    X'2073'             MSG 115                              42192021
         L     R5,CON32K           RESET TO MAX VALUE                   42198021
         B     XTN040              BRANCH                               42204021
XTN035   TM    DX1(R9),XX40         VARIABLE GROUP                      42210021
         BC    ONES,XTN032         YES, BRANCH                          42216021
         A     R6,DS                                                    42222021
         ST    R6,DS               DS=DS+L(LGS) * (NOC-1)               42228021
         C     R5,CO131K                                                42234021
         BC    NOTHI,XTN040        FIXED GROUP IN W-S SECT G.T. 1310    42240021
         BAL   R6,XTNERR           GO GENERATE                          42246021
         DC    X'2074'             MSG 116                              42252021
         L     R5,CO131K           CHANGE TO MAX VALUE                  42258021
*                                                                       42264021
*  STORE LGS, AND UPDATE ALL POINTERS.                                  42270021
*                                                                       42276021
XTN040   TM    DX1(R10),XX40                                            42282021
         BC    ONES,XTN310         BRANCH IF GIG IS VAR. LGN GROUP      42288021
         ST    R5,MTEMP                                                 42294021
         MVC   DX2(LX2,R10),MTEMP+NX2                                   42300021
         TM    MTEMP+NX1,XX01                                           42306021
         BC    ZERO,XTN070         BRANCH                               42312021
         OI    DX1(R10),XX01                                            42318021
XTN070   MVC   LID(LX24),DX0(R9)     MOVE LGS INTO LID(LAST ITEM DELE   42324021
         XC    DX0(LX36,R9),DX0(R9)  CLEAR AREA                         42330021
         LR    R9,R10              GIG BECOMES NEW LGS.                 42336021
         ST    R9,LGS                                                   42342021
         S     R10,CON24           UPDATE GIG POINTER.                  42348021
         ST    R10,GIG                                                  42354021
         L     R1,GPARAM                                                42360021
         L     R2,DX0(R1)           ADJUST DISPLACEMENT IN TAMM.        42366021
         LH    R1,DX4(R2)                                               42372021
         SH    R1,CON24+NX2                                             42378021
         STH   R1,DX4(R2)                                               42384021
         CLC   CILEV(LX1),DX20(R9)   COMPARE LEVEL NUMBERS              42390021
         BC    NOTHI,XTN001        BRANCH                               42396021
         CLI   MCI,XX06                 IS CURR ITM IN RPT SCT    42027 42402021
         BNE   XTN070A                    NO, BR                  42027 42408021
         CLI   PMCI,XX05                IS GRP BEING RESOLVED IN LS     42414021
         BNE   XTN070A                  NO, BR                    42027 42420021
         MVC   APAF(LX7),APAFSV         YES, RESTORE APAF AS SHLD BE    42426021
XTN070A  EQU   *                                                  42027 42432021
         L     R14,RS14B                                                42438021
         BCR   UNCOND,R14          BRANCH                               42444021
*                                                                       42450021
*                                                                       42456021
*                                                                       42462021
*  LGL IS SUBJECT OF REDEFINED CLAUSE, AND IT IS OF FIXED LENGTH.       42468021
*                                                                       42474021
XTN100   TM    DX1(R9),XX10         ERROR IF IT IS OF VARIABLE LENGT    42480021
         BC    ONES,XTN101         NO, FIXED LGN                        42486021
         BAL   R6,XTNERR           GO GENERATE                          42492021
         DC    X'0079'             MSG 121                              42498021
         L     R4,DX16(R9)          GET MAX, LENGTH OF LGS              42504021
         BC    UNCOND,XTN105       BRANCH                               42510021
XTN101   L     R4,DX0(R9)           LOAD  L(LGS)                        42516021
         N     R4,MK1632                                                42522021
XTN105   CLC   DX6(LX2,R9),ZEROS                                        42528021
         BC    HI,XTN110           BRANCH                               42534021
         LR    R7,R4               NO OCCURS IN THIS LGS.               42540021
         BC    UNCOND,XTN120       BRANCH                               42546021
XTN110   LH    R7,DX6(R9)                                               42552021
         MR    R6,R4               R7 HAS L(LGS) * NOC.                 42558021
         LR    R6,R7                   PUT LENGTH IN R6            3548 42564021
         SR    R6,R4                   SUBTRACT ORIG LENGTH = DIFF 3548 42570021
         LR    R4,R6                   STORE  DIFF ALSO IN R4      3548 42576021
         A     R4,DISP                  ADD DISP TO  DIFF          3548 42582021
         ST    R4,DISP                 STORE UPDATED LENGTH IN DISP3548 42588021
         BAL   R4,XTN200               ADJUST  APAF                3548 42594021
         CLI   PMCI,XX05            IF NOT LINKAGE SECTION              42600021
         BC    NOTEQ,XTN115        ADD L(LGS) * (NOC-1)                 42606021
         NI    PCOUNT,XX0F                                              42612021
         CLI   PCOUNT,XX05                                              42618021
         BC    EQ,XTN120           BRANCH                               42624021
XTN115   EQU   *                                                  45078 42630021
         CLI   PMCI,XX00                IS IT FILE SCT            45078 42636021
         BNE   XTN115A                    NO, BR                  45078 42642021
         CLC   FDDCBNO(LX1),PRDCBNO     YES, FIND OUT IF GRP      45078 42648021
*  BEING RESOLVED IS IN PRESENT FD OR PREV FD                     45078 42654021
         BL    XTN120                   PREV FD, DONT INCR LOCCTR 45078 42660021
         CLI   CILEV,XX01               PRES-IS CURR ITM A LEV 01 48456 42666021
         BE    XTN120                   YES, DONT INCR LOCCTR     48456 42672021
XTN115A  A     R6,LOCCTR                UPDATE LOCATION CTR       45078 42678021
         ST    R6,LOCCTR                                                42684021
XTN120   L     R1,RDFPAR                                                42690021
         L     R2,DX0(R1)                                               42696021
         L     R1,DX0(R2)                                               42702021
         N     R1,MK0932                                                42708021
         AH    R1,DX4(R2)                                               42714021
XT120A   S     R1,TWELVE           R1 POINTS TO LAST ENTRY ON RDFST     42720021
         CLC   DX0(LX1,R1),DX20(R9)  IS RDFSTK LEVEL = LGS LEVEL        42726021
         BC    HI,XT120A           NO TRY NEXT ONE                      42732021
         C     R7,DX8(R1)           COMPARE LGN WITH LAST ENTRY         42738021
         BC    EQ,XTN121            L(SUBJ. RED) EQ L(OBJ. RED)         42744021
         BC    HI,ERR06            L(SUBJ. RED.) GT L(OBJ. RED.)        42750021
         L     R8,DX8(R1)           L(SUBJ. RED.) LT  L(OBJ. RED.)      42756021
         SR    R8,R7                                                    42762021
*DEL                                                                    42768021
*DEL                                                                    42774021
*DEL                                                                    42780021
         MVC   APAF(LX7),DX1(R1)   RESTORE APAF FROM RDFSTK       61479 42786021
         CLI   PMCI,XX05            IF NOT LINKAGE SECTION              42792021
         BC    NOTEQ,XT120B          SECTION ADD TO LOCCTR              42798021
         NI    PCOUNT,XX0F                                              42804021
         CLI   PCOUNT,XX05                                              42810021
         BC    EQ,XTN121           BRANCH                               42816021
XT120B   CLI   PMCI,XX00                 IS IT FILE SECT          43155 42822021
         BNE   XT120C                    NO, BR                   43155 42828021
         CLC   FDDCBNO(LX1),PRDCBNO     YES, FIND OUT IF GRP      43155 42834021
*  BEING RESOLVED IS IN PRESENT FD OR PREV FD                     43155 42840021
         BL    XTN121                   PREV FD, DONT INCR LOCCTR 43155 42846021
         CLI   CILEV,XX01               PRES-IS CURR ITM A LEV 01 48456 42852021
         BE    XTN121                   YES, DONT INCR LOCCTR     48456 42858021
XT120C   L     R2,LOCCTR                LOCATION COUNTER          43155 42864021
         AR    R2,R8                                                    42870021
         ST    R2,LOCCTR                                                42876021
XTN121   XC    REDDIF(LX2),REDDIF   REDDIF =0                           42882021
         BC    UNCOND,XTN010       BR TO CALL ACC FOR ATTRB ADDR        42888021
XTN125   AH    R5,REDDIF           ADD DIFFERENCE OF L(RED. SUBJ.)      42894021
         BC    UNCOND,XTN040           L(RED. OBJ.) TO L(GIG)           42900021
XTN200   CLC   DISP,CO4096             COMPARE DISP TO MAXIMUM     3548 42906021
         BL    XTN201              OK IF LOWER                    57835 42912021
         MVC   WKAR(LX4),RS14B          SAVE  RETURN REG SAVE       354 42918021
         STM   R3,R6,RS3                SAVE   REGS 3-6            3548 42924021
         BAL   R14,ADP049              GO TO ADPAR FOR ADJUST      3548 42930021
         MVC   RS14B(LX4),WKAR          RESTORE  RETURN SAVE        354 42936021
         BCR   UNCOND,R4           BRANCH                          3548 42942021
XTN201   MVC   APAF+NX1(LX1),DISP+NX3      UPDATE DISPLACEMENT IN    35 42948021
         MVN   APAF(LX1),DISP+NX2        APAF  FIELD                 35 42954021
         BCR   UNCOND,R4           BRANCH                          3548 42960021
*                                                                       42966021
ERR06    BAL   R6,XTNERR           GO GENERATE                          42972021
         DC    X'1076'             MSG 118                              42978021
         LR    R8,R7               SAVE  LGS LGN                        42984021
         S     R7,DX8(R1)                                               42990021
         ST    R8,DX8(R1)               PT LARGER LGN IN RDFSTK         42996021
         STH   R7,REDDIF           SAVE DIFFERENCE IN REDDIF            43002021
         A     R7,DX4(R1)                                               43008021
         ST    R7,DX4(R1)                                               43014021
         STC   R7,DX2(R1)                                               43020021
         MVN   DX1(LX1,R1),DX6(R1)                                      43026021
         BC    UNCOND,XTN010       BRANCH                               43032021
XTN300   L     R5,DX16(R10)         R5= MAX LGN OF GIG (SO FAR)         43038021
         LR    R8,R5                                                    43044021
         TM    DX1(R9),XX40         IS LGS A VAR. LGN. GROUP            43050021
         BC    NOTONE,XTN017       NO, BRANCH                           43056021
         L     R4,DX16(R9)          R4= MAX LGN OF LGS                  43062021
         BC    UNCOND,XTN018       BRANCH                               43068021
XTN310   ST    R5,DX16(R10)         STORE L(GIG)+L(LGS)IN MAX LGN(GI    43074021
         CLC   DX6(LX2,R9),ZEROS     IS LGS SUBJECT OF AN OCCURS        43080021
         BC    NOTEQ,XTN312        YES, BRANCH                          43086021
         TM    DX1(R9),XX40         IS LGS A VAR. LGN. GROUP            43092021
         BC    NOTONE,XTN320       NO, BRANCH                           43098021
         MVC   QTEXT(LX8),STEPVL    YES, PUT OUT STEP VERB Q-TEXT       43104021
*                                  MOVE STEP VERB MASK TO QTEXT         43110021
         MVC   QTEXT+NX4(LX2),DX2(R10) MOVE GIG VLC= TO QTEXT           43116021
         MVC   QTEXT+NX8(LX2),DX2(R9) MOVE LGS VLC= TO QTEXT            43122021
         LA    R3,DX10                                                  43128021
         L     R15,APTQRN                                               43134021
         BALR  R14,R15             GO TO SPECIAL ITEM PROCESSING        43140021
         L     R15,ADICTB                                               43146021
         BC    UNCOND,XTN070       BRANCH                               43152021
XTN312   TM    DX0(R9),XX20         IS LGS SUBJECT OF ODO               43158021
         BC    NOTONE,XTN313       NO                                   43164021
         MVC   FULLWD(LX2),DX4(R9)   YES, GET OD2TBL DISP.              43170021
         BC    UNCOND,XTN314       BRANCH                               43176021
XTN313   TM    DX1(R9),XX40         IS LGS A VAR. LGN. GROUP            43182021
         BC    NOTONE,XTN319       NO, BRANCH                           43188021
         MVC   QTEXT(LX14),UPDTOC   YES, PUT OUT UPDATE VERB QTEXT      43194021
         MVC   QTEXT+NX7(LX2),DX2(R9) VLC OF LGS                        43200021
         MVC   QTEXT+NX10(LX2),DX6(R9) NOC                              43206021
         MVC   QTEXT+NX14(LX2),DX2(R10) VLC OF GIG                      43212021
         LA    R3,DX16                                                  43218021
         L     R15,APTQRN                                               43224021
         BALR  R14,R15             GO TO SPECIAL ITEM PROCESSING        43230021
         L     R15,ADICTB                                               43236021
         BC    UNCOND,XTN070       BRANCH                               43242021
XTN314   MVC   ODOMAX(LX2),DX6(R9)   MOVE NOC OF LGS TO ODOMAX          43248021
         TM    DX1(R9),XX40         DOES LGS HAVE A VLC                 43254021
         BC    NOTONE,XTN316       NO, BRANCH                           43260021
         L     R15,AUPDN           YES, PUT OUT UPDATE VERB AND DN      43266021
         BALR  R14,R15             LNK TO ADDR IN REG 15                43272021
         L     R15,ADICTB                                               43278021
         MVC   QTEXT(LX6),STEPVL+NX2 MOVE VLC MASK TO QTECT             43284021
         MVC   QTEXT+NX2(LX2),DX2(R9) LGS VLC=                          43290021
         MVC   QTEXT+NX6(LX2),DX2(R10) GIG VLC =                        43296021
         LA    R3,DX8                                                   43302021
         BC    UNCOND,XTN318       BRANCH                               43308021
XTN316   L     R15,AUPDN                                                43314021
         BALR  R14,R15             BRANCH                               43320021
         L     R15,ADICTB                                               43326021
         MVC   QTEXT(LX5),UPDTOC+NX9 MOVE LIT., VLC MASK TO QTEXT       43332021
         ST    R4,FULLWD                                                43338021
         MVC   QTEXT+NX1(LX2),FULLWD+NX2 L(LGS)  LITERAL                43344021
         MVC   QTEXT+NX5(LX2),DX2(R10) GIG VLC =                        43350021
         LA    R3,DX7                                                   43356021
XTN318   L     R15,APTQRN                                               43362021
         BALR  R14,R15             BRANCH                               43368021
         L     R15,ADICTB                                               43374021
         BC    UNCOND,XTN070       BRH TO MOVE LGS INTO LID             43380021
XTN319   MVC   QTEXT+NX7(LX2),MTEMP+NX2 MOVE NOC*L(LGS) TO LIT. OF STEP 43386021
         BC    UNCOND,XTN321       BRANCH                               43392021
XTN320   CLC   DX10(LX3,R9),ZEROS  IS THIS SUBJ. OF REDEFINES?    02493 43398021
         BC    HI,XTN070           YES, DO NOT GENERATE STEP VERB 02493 43404021
*                                   TO INCREMENT VLC              02493 43410021
         MVC   QTEXT+NX7(LX2),DX2(R9)  MOVE L(LGS) TO LIT. OF STEP02493 43416021
XTN321   MVC   QTEXT(LX7),INITVB    SET UP                              43422021
         MVI   QTEXT+NX1,STEPVB       STEP VERB                         43428021
         MVC   QTEXT+NX4(LX2),DX2(R10) GIG VLC                          43434021
         LA    R3,DX9                                                   43440021
         BC    UNCOND,XTN318       PUT OUT STEP VERB                    43446021
*                                                                       43452021
XTN500 DS    0H                                                         43458021
       L     R9,GPARAM                                                  43464021
         L     R10,DX0(R9)               GET TBL ARD OF GLS             43470021
         L     R9,DX0(R10)               ADR OF LAST ENTRY IN GLS       43476021
       N     R9,MK0932                                                  43482021
         AH    R9,DX4(R10)                                              43488021
       S     R9,CON24                                                   43494021
       LR    R10,R9                                                     43500021
       S     R10,CON24                                                  43506021
       BCR   UNCOND,R14            BRANCH                               43512021
XTNERR   MVC   CARDXX(LX2),CARDNO   SAVE CURRENT CARD NUMBER            43518021
         MVC   CARDNO(LX2),DX8(R9)   REPLACE WITH LGS                   43524021
         LH    R0,DX0(R6)           R0 = MSG NUMBER                     43530021
         L     R15,AERRTN          GO GENERATE MSG                      43536021
         BALR  R14,R15             GO GENERATE MSG                      43542021
         L     R15,ADICTB                                               43548021
         LA    R6,DX2(R6)                                               43554021
         MVC   CARDNO(LX2),CARDXX   RETURN CARDNO                       43560021
         BR    R6                  BRANCH                               43566021
         EJECT                                                          43572021
*=2   ADDRESSING PARAMETER ASSIGNMENT ROUTINE (ADPAR)                   43578021
*                                                                       43584021
*  ADPAR ASSIGNS ADDRESSING PARAMETERS TO ALL GROUP,ELEMENTARY,AND      43590021
*    LEVEL-77 ITEMS. ABAS POINTS TO THE LAST ENTRY IN BASE ASSIGNME     43596021
*    STACK(BAS).                                                        43602021
*        INPUT - R0 AND CILEV HAS LEVEL NO OF CI.                       43608021
*                                                                       43614021
ADPAR    STM   R3,R6,RS3                                                43620021
         L     R15,ADICTB                                               43626021
         ST    R14,RS14B                                                43632021
         TM    XTNSBL,XX02          IF SW ON DO NOT DO BAS PROC.        43638021
         BC    NOTONE,ADP010       DO NOT DO BAS PROC                   43644021
         NI    XTNSBL,XXFD                                              43650021
         BC    UNCOND,ADP018       GO TO SEE IF ANY RDFSTK ENTRIES      43656021
ADP010   SR    R1,R1                                                    43662021
         IC    R1,BASI                                                  43668021
         LA    R2,BAS                                                   43674021
         AR    R2,R1                                                    43680021
         CLC   CILEV(LX1),DX0(R2)    IS CI LEVEL = L.T. OR = LAST ODO   43686021
         BC    NOTHI,ADP014        YES                                  43692021
         TM    ITMCLS+NX1,XX80      NO, IS ITEM AN ODO                  43698021
         BC    NOTONE,ADP012       NO                                   43704021
         MVC   DX1(LX1,R2),CILEV     YES, ADD CILEV TO BAS              43710021
         LA    R1,DX1(R1)                                               43716021
         STC   R1,BASI                                                  43722021
ADP012   TM    XTNSBL,XX01          WAS LID A VAR. LGN. GROUP           43728021
         BC    NOTONE,ADP018       NO                                   43734021
         BC    UNCOND,ADP015       YES                                  43740021
ADP014   S     R1,ONE                                                   43746021
         S     R2,ONE              NEXT HIGHEST BAS ENTRY               43752021
         CLC   CILEV(LX1),DX0(R2)    IS CILEVEL  L.T. OR = LAST ODO L   43758021
         BC    NOTHI,ADP014        YES                                  43764021
         TM    ITMCLS+NX1,XX80      NO, IF CI IS ODO ADD LEV. NUM TO    43770021
         BC    NOTONE,ADP14A       NO                                   43776021
         MVC   DX1(LX1,R2),CILEV     YES                                43782021
         LA    R1,DX1(R1)            ADD TO BAS                         43788021
ADP14A   STC   R1,BASI             RESET BASI                           43794021
ADP015   NI    XTNSBL,XXFE          TURN OFF SWITCH                     43800021
         CLI   CILEV,XX01           IS CI LEVEL 01                      43806021
         BC    EQ,ADP018           YES, NO SBL, 01 GETS LAST BL  OF     43812021
*                                   LAST 01 W/ DISP UP'D BY LAST 01     43818021
         CLI   CILEV,XX32               IS ITEM A 77              37093 43824021
         BE    ADP018                   YES, BR                   37093 43830021
         XC    APAF(LX7),APAF                                           43836021
         OI    APAF,XX40            SET I-FIELD TO SBL                  43842021
         LH    R4,SBLCTR                                                43848021
         LA    R4,DX1(R4)           GET NEXT SBL=                       43854021
         STH   R4,SBLCTR                                                43860021
         STC   R4,APAF+NX2          PUT SBL= IN K FIELD                 43866021
*                                                                       43872021
*INITIALIZE SBL BY INCRA Q-TEXT                                         43878021
*                                                                       43884021
         MVC   QTEXT(LX2),INCRAV                                        43890021
         LA    R3,DX2                                                   43896021
         L     R15,APTQRN          PUT OUT INCRA VERB                   43902021
         BALR  R14,R15             GO TO PUT OUT Q-RNT TEXT             43908021
         L     R15,ADICTB                                               43914021
*                                                                       43920021
*PUT IN  1ST OP OF INCRA                                                43926021
*                                                                       43932021
         L     R9,GPARAM                                                43938021
         L     R10,DX0(R9)                                              43944021
         L     R9,DX0(R10)                                              43950021
         N     R9,MK0932                                                43956021
         AH    R9,DX4(R10)          R9= ADDRESS OF LAST ENTRY IN GPL    43962021
         S     R9,CON24             (GOVERNING GROUP ITEM)              43968021
         MVC   PARAM+NX1(LX3),DX13(R9) SET UP PARAMETER FOR LATRPT      43974021
         MVI   PARAM,XX04                                               43980021
         LA    R1,PARAM                                                 43986021
         L     R15,ALATRP                                               43992021
         BALR  R14,R15             CALL LATRPT TO LOCATE GROUP IN D     43998021
         L     R15,ADICTB          RESET BASE REGISTER                  44004021
         MVC   QTEXT(LX2),DNREF                                         44010021
         MVC   QTEXT+NX2(LX8),DX0(R2) MOVE ATTRIBUTES TO QTEXT AREA     44016021
         MVC   QTEXT+NX4(LX3),DX21(R9) MOVE GRP ADDR PARAM TO     57814 44022021
*                            QTEXT AREA IN CASE GRP RE-ALIGNED    57814 44028021
         MVC   QTEXT+NX10(LX3),DX13(R9) ADD ON DICTIONARY POINTER       44034021
         LA    R3,DX13                                                  44040021
         L     R15,APTQRN                                               44046021
         BALR  R14,R15             GO TO PUT OUT Q-RNT TEXT             44052021
         L     R15,ADICTB                                               44058021
         MVC   QTEXT(LX6),INCROP    MOVE INCRA OPERAND MASK TO QTEXT    44064021
         MVC   QTEXT+NX2(LX2),DX2(R9) AND FILL IN VLC= AND              44070021
         MVC   QTEXT+NX6(LX2),SBLCTR                                    44076021
         OI    QTEXT+NX6,XX04       SET SBL BIT                         44082021
         LA    R3,DX8                                                   44088021
         L     R15,APTQRN                                               44094021
         BALR  R14,R15             GO TO PUT OUT Q-RNT TEXT             44100021
         L     R15,ADICTB                                               44106021
         TM    PTBLSW,XX80          WAS QSBL TABLE PRIMED           475 44112021
         BC    ONES,ADP016         YES                             4758 44118021
         LA    R1,QSBLPM           NO                              4758 44124021
         L     R15,BPRIME           PRIME QSBL TABLE                475 44130021
         BALR  R14,R15             GO TO PRINT ROUTINE             4758 44136021
         L     R15,ADICTB                                          4758 44142021
         OI    PTBLSW,XX80          SET PRIME SW                    475 44148021
ADP016   L     R1,QSBLPM                                           4758 44154021
         L     R15,BINSRT                                          4758 44160021
         BALR  R14,R15             GO TO INSERT ROUTINE            4758 44166021
         L     R15,ADICTB                                          4758 44172021
         MVC   DX0(LX1,R2),SBLCTR+NX1    INSERT ENTRY IN TABLE       47 44178021
ADP018   TM    FES,XX20             ARE THERE ANY RDFSTK ENTRIES        44184021
         BC    ZERO,ADP045            NO.                               44190021
         L     R9,RDFPAR                                                44196021
         L     R10,DX0(R9)                                              44202021
         L     R4,DX0(R10)          GET ADDRESS OF LAST ENTRY ON RDF    44208021
         N     R4,MK0932                                                44214021
         AH    R4,DX4(R10)                                              44220021
ADP020   S     R4,TWELVE                                                44226021
         CLC   CILEV(LX1),DX0(R4)    COMPARE LEVNO OF CI AND RDFSTK.    44232021
         BC    HI,ADP045           BR:CI SUBJ OF REDEF & DISP<4096      44238021
         BC    LO,ADP035           BR:CI LEVEL < LAST ENTRY LEVEL       44244021
*                                                                       44250021
*  LEVEL OF CI IS EQUAL TO LEVEL OF LAST ENTRY ON RDFSTK.               44256021
*                                                                       44262021
ADP030   TM    MINCOD,XX01          IS CI SUBJECT OF REDEFINES.         44268021
         BC    ONES,ADP045            YES                               44274021
*  LEVEL OF CI IS LOWER THAN LEVEL OF LAST ENTRY ON RDFSTK.             44280021
*                                                                       44286021
ADP035   MVC   WKAR(LX1),COUNT      IF CURRENT SECT. IS DIFF FROM       44292021
         XC    WKAR(LX1),PCOUNT        PREVIOUS SECTION,                44298021
         NI    WKAR,XX0F                                                44304021
         BC    ZERO,ADP037         IF SAME SECTION BRANCH OR            44310021
         CLI   WKAR,XX02            IF WORKING-STOR. -REPORT SECTION    44316021
         BC    EQ,ADP037            BRANCH                              44322021
         CLI   WKAR,XX01            IF WORKING-STOR.-LINKAGE SECTION    44328021
         BC    NOTEQ,ADP036        GO DELTE ALL BUT DUMMY RDFSTK        44334021
*DEL                                                                    44340021
*DEL                                                                    44346021
         MVC   RAPAF(LX7),DX1(R4)    SAVE APAF FOR REPORT SECTION       44352021
ADP036   MVC   DX4(LX2,R10),TWELVE+NX2 DELETE ALL BUT DUMMY RDFSTK ENTR 44358021
         L     R7,RNMPAR                                                44364021
         L     R8,DX0(R7)                                               44370021
         MVC   DX4(LX2,R8),FIVE+NX2     DELETE ALL BUT DUMMY RNMTBL E   44376021
         BC    UNCOND,ADP045       BR:CI SUBJ OF REDEF & DISP<4096      44382021
ADP037   TM    FES,XX08             WAS APAF DISP UPDATED IN XTEN       44388021
         BO    ADP038              YES, BYPASS                          44394021
         MVC   APAF(LX7),DX1(R4)    NO, RESET APAF                      44400021
         TM    PCOUNT,XX06          IF LAST ITEM WAS IN REPORT SECT,    44406021
         BC    NOTONE,ADP038       BR:DELETE LAST ENTRY ON RDFSKT       44412021
         XC    DISP(LX4),DISP                                           44418021
         MVC   DISP+NX3(LX1),APAF+NX1                                   44424021
         MVN   DISP+NX2(LX1),APAF                                       44430021
         MVC   LOCCTR(LX4),RPTLOC                                       44436021
         XC    RPTLOC(LX4),RPTLOC                                       44442021
         XC    RPTRDF(LX3),RPTRDF                                       44448021
ADP038   LH    R1,DX4(R10)          DELETE THIS LAST ENTRY ON RDFSTK    44454021
         SH    R1,TWELVE+NX2                                            44460021
         STH   R1,DX4(R10)                                              44466021
         L     R7,RNMPAR              ALSO THE CORRESPONDING ENTRIE     44472021
         L     R8,DX0(R7)              RNMTBL WITH EQ LEVNO AS RDFST    44478021
         L     R7,DX0(R8)                                               44484021
         N     R7,MK0932                                                44490021
         AH    R7,DX4(R8)                                               44496021
ADP040   S     R7,FIVE                                                  44502021
         CLC   DX0(LX1,R7),DX0(R4)                                      44508021
         BC    NOTEQ,ADP020        GO TO COMPARE LEVNO CI & RDFSKT      44514021
         LH    R6,DX4(R8)                                               44520021
         SH    R6,FIVE+NX2                                              44526021
         STH   R6,DX4(R8)                                               44532021
         BC    UNCOND,ADP040       BRANCH                               44538021
*                                                                       44544021
*  CI IS SUBJECT OF REDEFINES, AND DISP IS LESS THAN 4096.              44550021
*                                                                       44556021
ADP045   NI    FES,XXF7             TURN OFF ADPAR SW                   44562021
         CLI   MCI,XX05             LINKAGE SECT. ADDRESSING PARAMET    44568021
         BC    EQ,ADP300              SPECIAL HANDLING.                 44574021
         CLI   MCI,XX01                                                 44580021
         BC    LO,ADP45A           FILE SECTION.                        44586021
         BC    EQ,ADP400           THIS IS SORT-DISCRIPTION ITEM.       44592021
         CLI   MCI,XX02                                                 44598021
         BC    NOTEQ,ADP45B        NOT FD (RANDOM PROCESSING)           44604021
ADP45A   CLI   CILEV,XX01                                               44610021
         BC    NOTEQ,ADP050        BRANCH                               44616021
         MVC   APAF(LX7),FAPAF                                          44622021
         BC    UNCOND,ADP050       BRANCH                               44628021
ADP45B   CLI   CILEV,XX01                                               44634021
         BC    NOTEQ,ADP050        BRANCH                               44640021
ADP046   TM    APAF,XX40            IS APAF BL AN SBL                   44646021
         BC    NOTONE,ADP048       GO TO CHECK IF 01 LEVEL ITEM         44652021
         L     R1,LID+NX20          GET ADDR. PARAM OF LAST 01          44658021
         SRL   R1,DX8               SHIFT OUT K FIELD                   44664021
         N     R1,MK2132           D-FIELD IS IN R1                     44670021
         A     R1,LID+NX16          ADD MAX LGN OF LAST 01 TO R1        44676021
         ST    R1,DISP             NEW DISP FIELD                       44682021
         NI    LID+NX21,XXF0                                            44688021
         MVC   APAF(LX1),LID+NX21    RESET I-FIELD                      44694021
         MVC   APAF+NX2(LX1),LID+NX23 RESET K-FIELD                     44700021
ADP047   MVN   APAF(LX1),DISP+NX2    GET NEW D-FIELD < 4096             44706021
         MVC   APAF+NX1(LX1),DISP+NX3                                   44712021
ADP048   TM    APAF+NX1,XX07        CHECK TO SEE IF 01 LEVEL ITEM       44718021
         BC    ZERO,ADP050            STARTS ON A DOUBLE WORD BOUND     44724021
         IC    R5,APAF+NX1                                              44730021
         N     R5,SEVEN                                                 44736021
         L     R6,EIGHT            NO. OF SLACK BYTES ADDED             44742021
         SR    R6,R5                  = 8 - REM (CURRENT ADDRESS/8)     44748021
         L     R5,APAF-NX1                                              44754021
         SRL   R5,DX8                                                   44760021
         N     R5,MK2132                                                44766021
         AR    R5,R6                                                    44772021
         STC   R5,APAF+NX1                                              44778021
         ST    R5,MTEMP                                                 44784021
         MVN   APAF(LX1),MTEMP+NX2                                      44790021
         L     R5,DISP                                                  44796021
         AR    R5,R6               ADD THE SLACK BYTES TO DISP.         44802021
         ST    R5,DISP                                                  44808021
         A     R6,LOCCTR                                                44814021
         ST    R6,LOCCTR         )                                      44820021
ADP050   CLI   CILEV,XX01                                               44826021
         BC    NOTEQ,ADP058        BRANCH                               44832021
         MVI   VLCSET,XX04          NO, IN/LINE                         44838021
         BC    UNCOND,ADP053       BRANCH                               44844021
ADP051   MVI   VLCSET,XX34          SET  ALL QRTN VLC                   44850021
ADP053   LA    R3,INITVB-NX1          CONSTANTS TO   FA04  INLINE       44856021
         LA    R4,DX41                               FA34  OUTLINE      44862021
ADP054   LA    R3,DX1(R3)                                               44868021
         CLC   DX0(LX1,R3),VLCCUR      AT EACH NEW 01 LEVEL             44874021
         BC    NOTEQ,ADP055        BRANCH                               44880021
         MVC   DX0(LX1,R3),VLCSET                                       44886021
ADP055   BCT   R4,ADP054           BRANCH                               44892021
         MVC   VLCCUR(LX1),VLCSET                                       44898021
       BC    UNCOND,ADP058         BRANCH                               44904021
*                                                                       44910021
ADP049 ST    R14,RS14B                                                  44916021
       L     R15,ADICTB                                                 44922021
ADP058   CLC   DISP(LX4),CO4096                                         44928021
         BC    NOTLO,ADP100        BR: INCREMENT K FIELD OF APAF        44934021
ADP060   CLI   NXCISW,XX01          HAVE FOUND NEXT FD, PROCESSING L    44940021
         BC    EQ,ADP062           YES, DON'T MOVE APAF INTO CI         44946021
         MVC   ADDPAR(LX3),APAF     NO, ADDPAR IN CI = APAF             44952021
ADP062   EQU   *                                                        44958021
         LM    R3,R6,RS3                                                44964021
         L     R14,RS14B                                                44970021
         BCR   UNCOND,R14          BRANCH                               44976021
ADP100   L     R5,DISP             ADD 1 TO K FIELD OF APAF (BL=)       44982021
         S     R5,CO4096                                                44988021
         ST    R5,DISP             AND SUBTRACT 4096 FROM DISP.         44994021
         STC   R5,APAF+NX1                                              45000021
         MVN   APAF(LX1),DISP+NX2    SAVE ORIGINAL I FIELD.             45006021
         SR    R5,R5               GET CURRENT BASE LOCATOR =           45012021
         IC    R5,APAF+NX2                                              45018021
         TM    APAF,XX10            UP THE K FIELD.                     45024021
         BZ    ADP120              NO                                   45030021
         CH    R5,BLLCTR                                                45036021
         BC    LO,ADP140           YES, BRANCH                          45042021
         LH    R0,BLLSAVE                                               45048021
         A     R0,ONE              INCREMENT CTR                        45054021
         STH   R0,BLLSAVE          SAVE CTR                             45060021
         STH   R0,BLLCTR                                                45066021
         STC   R0,APAF+NX2                                              45072021
         BC    UNCOND,ADP058       BRANCH                               45078021
ADP120   TM    APAF,XX40                                                45084021
         BC    ZERO,ADP130         BRANCH                               45090021
         CH    R5,SBLCTR                                                45096021
         BC    LO,ADP140           YES, BRANCH                          45102021
         LH    R0,SBLCTR                                                45108021
         A     R0,ONE                                                   45114021
         STH   R0,SBLCTR                                                45120021
         STC   R0,APAF+NX2                                              45126021
         BC    UNCOND,ADP058       BRANCH                               45132021
ADP130   CH    R5,BLCTR                                                 45138021
         BC    LO,ADP140           YES, BRANCH                          45144021
         LH    R0,BLCTR                                                 45150021
         A     R0,ONE                                                   45156021
         STH   R0,BLCTR                                                 45162021
         STC   R0,APAF+NX2                                              45168021
         XC    PMCI(LX1),PMCI               CLEAR PMCI            37352 45174021
         MVN   PMCI(LX1),PCOUNT         MAJOR CDE OF PREV ITEM    37352 45180021
         CLI   MCI,XX04                 IS CURRENT ITEM IN W.S.   37352 45186021
         BNE   ADP130A                  NO, BR                    37352 45192021
         CLI   PMCI,XX00                IS PREV ITEM IN F.S.      37352 45198021
         BNE   ADP130A                   NO, BR                   37352 45204021
         STC   R0,FAPAF+NX2              RESET BLCTR IN FAPAF     37352 45210021
ADP130A  EQU   *                                                  37352 45216021
         BC    UNCOND,ADP058       BRANCH                               45222021
ADP140   A     R5,ONE              ITEM IS IN A REDEFINES SO COUNTE     45228021
         STC   R5,APAF+NX2           IS NOT INCREMENTED. ONLY K FIEL    45234021
         BC    UNCOND,ADP058        IS INCREMENTED                      45240021
*                                                                       45246021
*  IN LINKAGE SECTION, EVERY 01 OR 77 ITEM GET A NEW BLLCTR ASSIGNE     45252021
*                                                                       45258021
ADP300   TM    MINCOD,XX01          IS CI SUBJECT OF REDEFINES.         45264021
         BC    ONES,ADP060            YES,DO NOT ASSIGN ANOTHER BLL     45270021
         CLI   CILEV,XX01                                               45276021
         BC    EQ,ADP310           BRANCH                               45282021
         CLI   CILEV,XX32                                               45288021
         BC    NOTEQ,ADP050        BRANCH                               45294021
ADP310   CLI   NOADD,XX01           DON'T ASSIGN ANOTHER BLL NO IF      45300021
         BC    EQ,ADP060             DOING ALIGNMENT IN ELI5A           45306021
         LH    R1,BLLCTR                                                45312021
         TM    LBLSW,XX40          IS THIS LABEL RECORD?                45318021
         BO    ADPLBL             YES.                                  45324021
         L     R3,ATTLDTB         R3=A(TIB32)                           45330021
         CLC   DX1(LX3,R3),ZEROS                                        45336021
         BE    TLDTST3            YES, NO TABLE.                        45342021
         L     R3,DX0(R3)          NO, CHECK TAMM DISP FOR 0            45348021
         CLC   ZEROS(LX2),DX4(R3)                                       45354021
         BE    TLDTST3            DISP=0                                45360021
         OI    PTBLSW+NX1,XX80     SET PRIMED TABLE SW ON.              45366021
         L     R4,DX0(R3)          R4=A(TABLE)---A(CURRENT ENTRY)       45372021
         LH    R6,DX4(R3)                                               45378021
         AR    R6,R4              R6=EOT                                45384021
TLDTST1  CLC   NUMBCD(LX1),DX3(R4) NAME COUNT AGREE?                    45390021
         BNE   TLDTST2            NO.                                   45396021
         IC    R5,NUMBCD          YES.                                  45402021
         BCTR  R5,R0               BRANCH                               45408021
         EX    R5,TLDCLC          COMPARE NAMES.                        45414021
         BE    TLDTST4            YES. TOTALED AREA.                    45420021
TLDTST2  A     R4,CON34                                                 45426021
         CR    R4,R6              ALL ENTRIES IN TABLE COMPARED.        45432021
         BNH   TLDTST1             BRANCH                               45438021
TLDTST3  LH    R1,BLLSAVE         THIS IS NOT TTLD AREA                 45444021
         LA    R1,DX1(R1)                                               45450021
         STH   R1,BLLCTR          UPDATE BLLCTR AND                     45456021
         STH   R1,BLLSAVE         BLLSAVE.                              45462021
         B     ADP315              BRANCH                               45468021
TLDCLC   CLC   BCDNAM(LX0),DX4(R4)                                      45474021
TLDTST4  DS    0H                                                       45480021
         LA    R1,DX2              TOTALED AREA GETS BLL-2.             45486021
         STH   R1,BLLCTR                                                45492021
         B     ADP315              BRANCH                               45498021
ADPLBL   DS    0H                                                       45504021
         LA    R1,DX1                                                   45510021
         STH   R1,BLLCTR                                                45516021
ADP315   XC    APAF(LX7),APAF                                           45522021
         OI    APAF,XX10            SET I-FIELD OF APAF TO INDICATE     45528021
         STC   R1,APAF+NX2             THAT ITEM IS IN LINKAGE SECTI    45534021
         BC    UNCOND,ADP060       GO TO FIND NEXT FD                   45540021
ADP400   CLI   CILEV,XX01           LEVEL = 01.                         45546021
         BC    NOTEQ,ADP050        BRANCH                               45552021
ADP410   MVC   APAF(LX7),SDAPAF                                         45558021
         BC    UNCOND,ADP050       BRANCH                               45564021
         EJECT                                                          45570021
*=1   GROUP ITEM PROCESSING ROUTINE (GRIPR)                             45576021
*                                                                       45582021
*  GRIPR ROUTINE PROCESSES ALL CURRENT ITEMS THAT ARE GROUP ITEMS.      45588021
*        INPUT-- R0 ,CILEV HAS CI LEVEL NO.                             45594021
*                                                                       45600021
IKF209   CSECT                                                          45606021
       USING *,R15                                                      45612021
GRIPR    ST    R14,RS14A                                                45618021
         TM    ITMCLS,XX38          GROUP ITEM CANNOT HAVE VALUE CLA    45624021
         BC    ZERO,GRI010            CLAUSE IGNORED.                   45630021
         CLI   NXTLEV,XXFF                                              45636021
         BC    EQ,GRI010           BRANCH                               45642021
         SR    R9,R9                      ROR                           45648021
         IC    R9,ITMCLS                                                45654021
         SRL   R9,DX3               GET RID OF USAGE                    45660021
         N     R9,MK3032           LOAD VALUE ONLY                      45666021
         C     R9,ONE              IS VALUE ALPHANUMERIC                45672021
         BE    GRI002              YES                                  45678021
         C     R9,FOUR             FIGCON                               45684021
         BE    GRI002              YES                                  45690021
         C     R9,FIVE             FIGCON ZERO                          45696021
         BE    GRI002              YES                                  45702021
         BAL   R4,ERROR            CALL ERROR ROUTINE                   45708021
         DC    X'107F'                                                  45714021
         C     R9,SEVEN            VALUE IS SERIES                      45720021
         BNE   GRI010              NO                                   45726021
         SR    R6,R6               YES, BYPASS                          45732021
         L     R7,BSAVE+NX28        MAKE SURE REG7 IS CORRECT           45738021
GRI001   IC    R6,DX1(R7)           GET COUNT OF ENTRY                  45744021
         L     R15,ASRCHT                                               45750021
         L     R5,ACHNXT                                                45756021
         BALR  R3,R5               GO BYPASS REST                       45762021
         L     R15,AGRIPR                                               45768021
         TM    DX0(R7),XX10         STILL VALUE THRU                    45774021
         BO    GRI001              YES, GO GET NEXT                     45780021
         ST    R7,BSAVE+NX28        CHANGE R7                           45786021
         B     GRI010              BRANCH                               45792021
GRI002   CLI   MCI,XX04             WORKING STORAGE                     45798021
         BE    GRI003              YES                                  45804021
         CLI   MCI,XX06             REPORT SECTION                      45810021
         BE    GRI003              YES                                  45816021
         BAL   R4,ERROR            CALL ERROR ROUTINE                   45822021
         DC    X'007D'             MSG 125                              45828021
         B     GRI010              BRANCH                               45834021
GRI003   TM    MINCOD,XX01          REDEFINES                           45840021
         BO    GRI004              YES, ERROR                           45846021
         TM    MINCOD,XX02          OCCURS                              45852021
         BO    GRI008              YES, ERROR                           45858021
         TM    ITMCLS+NX1,XX80      SUBJECT OF ODO                      45864021
         BZ    GRI005              NO                                   45870021
         B     GRI008              YES, ERROR                           45876021
GRI004   BAL   R4,ERROR            CALL ERROR ROUTINE                   45882021
         DC    X'2077'                                                  45888021
         B     GRI010              BRANCH                               45894021
GRI005   TM    FES,XX20             ANY REDEFINES                       45900021
         BZ    GRI006              NO                                   45906021
         L     R10,RDFPAR          YES, SEE IF SUBORDINATE              45912021
         L     R12,DX0(R10)                                             45918021
         L     R10,DX0(R12)                                             45924021
         N     R10,MK0932                                               45930021
         AH    R10,DX4(R12)                                             45936021
         S     R10,TWELVE          POINT TO LAST ENTRY                  45942021
         CLI   DX0(R10),XX00        ANY ENTRIES                         45948021
         BE    GRI006              NO                                   45954021
         CLC   CILEV(LX1),DX0(R10)                                      45960021
         BC    NOTHI,GRI006        NO                                   45966021
         B     GRI004              ERROR                                45972021
GRI006   TM    MINCOD,XX0E                                              45978021
         BC    NOTZER,GRI008       BRH TO GI008, MSG 149                45984021
GRI007   OI    GRPVAL,SWON         TURN SW ON                           45990021
         B     GRI010              BRH, GET ADD OF LAST ENTRY           45996021
*                                                                       46002021
GRI008   BAL   R4,ERROR            CALL ERROR ROUTINE                   46008021
         DC    X'2095'             MSG 149                              46014021
GRI010   L     R9,GPARAM                                                46020021
         L     R10,DX0(R9)                                              46026021
         L     R9,DX0(R10)          GET THE ADDRESS OF THE LAST ENTR    46032021
         N     R9,MK0932              ON GROUP LENGTH STACK.            46038021
         AH    R9,DX4(R10)                                              46044021
         S     R9,CON24               R9 POINTS TO LGS.                 46050021
         ST    R9,LGS                                                   46056021
GRI011   LR    R10,R9              R10 POINTS TO GIG                    46062021
         S     R10,CON24                                                46068021
         CLC   DX20(LX1,R9),CILEV                                       46074021
         BC    LO,GRI020           CI LEVEL IS GREATER,TRANSFER.        46080021
         L     R15,AXTEN           CALL XTEN ROUTINE                    46086021
         BALR  R14,R15             GO TO XTEN ROUTINE                   46092021
         L     R15,AGRIPR                                               46098021
GRI020   CLI   NXTLEV,XXFF          IS THIS THE LAST DUMMY ITEM.        46104021
         BC    NOTEQ,GRI022        GO TO MAKE A GLS ENTRY               46110021
         L     R15,AADPAR                                               46116021
         BALR  R14,R15             GO TO ASSIGN ADDRESSING PARAM        46122021
         L     R15,AGRIPR                                               46128021
         LM    R0,R13,BSAVE        THIS IS END OF PHASE                 46134021
         L     R14,RETURN          RETURN                               46140021
         BCR   UNCOND,R14            FROM HERE                          46146021
*                                                                       46152021
*  MAKE A GLS ENTRY.                                                    46158021
*                                                                       46164021
GRI022   BAL   R14,INTVLC          SEE IF ITEM HAS OCCURS...DEP. ON     46170021
         L     R15,AADPAR          CALL ADPAR TO ASSIGN ADDR. PARAM     46176021
         BALR  R14,R15             GO TO ASSIGN ADDRESSING PARAM        46182021
         L     R1,GPARAM                                                46188021
         L     R15,BINSRT                                               46194021
         BALR  R14,R15             GO TO INSERT ROUTINE                 46200021
         L     R15,AGRIPR                                               46206021
         MVI   DX0(R2),XX00                                             46212021
         LR    R9,R2                                                    46218021
         LR    R10,R9                                                   46224021
         S     R10,CON24           POINT TO PRIOR ENTRY                 46230021
         LH    R2,NOC                                                   46236021
         CH    R2,ONE+NX2                                               46242021
       BC    NOTHI,GRI025                OCCURS NOT MORE THAN ONCE      46248021
         SR    R2,R2                                                    46254021
         IC    R2,ALIGN                                                 46260021
         A     R2,ONE                                                   46266021
         STC   R2,ALIGN                                                 46272021
         OI    DX0(R9),XX80         BOUNDARY ALIGNMENT NEEDED,          46278021
*                                                                       46284021
GRI025 IC R2,MINCOD                                                     46290021
         STC   R2,DX1(R9)              MINCOD.                          46296021
         MVC   DX2(LX2,R9),CILGN        LENGTH.                         46302021
         TM    LEVNUM,XX01                                              46308021
         BC    ZERO,GRI026         BRANCH                               46314021
         OI    DX1(R9),XX01                                             46320021
         BC    UNCOND,GRI027       BRANCH                               46326021
*                                                                       46332021
GRI026   NI    DX1(R9),XXFE                                             46338021
GRI027   MVC   DX4(LX4,R9),OBJDIS    DISP IN OD2TBL, NOC                46344021
         MVC   DX8(LX2,R9),CARDNO    CARD NUMBER                        46350021
         MVC   DX10(LX3,R9),OBJRED+NX1  DICT POINTER OF OBJ OF REDEF.   46356021
         MVC   DX13(LX3,R9),DICPNT+NX1  DICT POINTER OF THE ITEM.       46362021
         MVC   DX16(LX4,R9),ZEROS    INITIAL MAX LENGTH = 0.            46368021
         MVC   DX20(LX1,R9),CILEV       CI LEVEL NUMBER.                46374021
         MVC   DX21(LX3,R9),ADDPAR   MOVE AADR. PARM. TO GPLSTK         46380021
         MVC   DX24(LX2,R9),NOIDNM   NO OF IDS AND KEYS                 46386021
         MVC   DX26(LX2,R9),IDDISP   START OF ENTRY IN TABLE            46392021
         MVC   DX28(LX2,R9),KEYDSP                                      46398021
         MVC   DX34(LX1,R9),GUI      SAVE GROUP'S USAGE                 46404021
         TM    GRPVAL,SWON         VALUE ON GROUP                       46410021
         BZ    GRI029              NO                                   46416021
         OI    DX0(R9),XX08         YES, SET BIT ON                     46422021
         TM    DX0(R10),XX08        VALUE ON LAST GROUP                 46428021
         BZ    GRI27A              NO                                   46434021
         BAL   R4,ERROR            YES, ERROR                           46440021
         DC    X'108C'             MSG 140                              46446021
         XC    GRPVAL(LX1),GRPVAL   TURN OFF SW                         46452021
         B     GRI029              GO OUT                               46458021
GRI27A   TM    PTBLSW+NX2,XX20      TANLE PRIMED                        46464021
         BO    GRI028              YES                                  46470021
         LA    R1,AVALGR                                                46476021
         L     R15,BPRIME                                               46482021
         BALR  R14,R15             GO PRIME TABEL                       46488021
         L     R15,AGRIPR                                               46494021
         OI    PTBLSW+NX2,XX20      SET PRIMED SW ON                    46500021
GRI028   L     R1,AVALGR                                                46506021
         L     R1,DX0(R1)                                               46512021
         MVC   DX30(LX2,R9),DX4(R1)  SAVE DISPL IN TABLE                46518021
         SR    R6,R6                                                    46524021
         IC    R6,LITVAL           COUNT OF LITERAL                     46530021
         LA    R0,DX8(R6)           PLUS FIXED PORTION                  46536021
         L     R1,AVALGR                                                46542021
         L     R15,BINSRT                                               46548021
         BALR  R14,R15             FIND WHERE TO INSERT                 46554021
         L     R15,AGRIPR                                               46560021
         MVI   DX0(R2),XX28         HEADER                              46566021
         MVC   DX1(LX3,R2),LOCCTR+NX1 LOCATION COUNTER                  46572021
         TM    ITMCLS,XX20          FIGCON                              46578021
         BO    GRI28A              YES                                  46584021
         MVI   DX4(R2),ANCODE                                           46590021
         B     GRI28B              BRANCH TO INSERT LITERAL             46596021
GRI28A   MVI   DX4(R2),XXFF        FIGCON                               46602021
GRI28B   EX    R6,VALMOV           INSERT LITERAL                       46608021
         XC    GRPVAL(LX1),GRPVAL   TURN OFF SW                         46614021
GRI029   TM    ITMCLS+NX1,XX80      IS ITEM SUBJECT OF ODO              46620021
         BC    ZERO,GRI030         NO, BRANCH                           46626021
         OI    DX0(R9),XX20         YES, SET ODO BIT IN GPLSTK          46632021
*                                                                       46638021
GRI030   TM    GRP88,SWON          88 UNDER GROUP                       46644021
         BZ    GRI031              NO                                   46650021
         OI    DX0(R9),XX04         YES, TREAT LIKE VALTHRU             46656021
         TM    PTBLSW+NX2,XX80      TABLE PRIMED YET                    46662021
         BO    GRI30A              YES                                  46668021
         LA    R1,PVALTR                                                46674021
         L     R15,BPRIME                                               46680021
         BALR  R14,R15             GO TO PRIME ROUTINE                  46686021
         L     R15,AGRIPR                                               46692021
         L     R14,AVALSR                                               46698021
         ST    R14,VALSAV          SET UP ADDRESSABILITY                46704021
         OI    PTBLSW+NX2,XX80      TURM SW ON                          46710021
GRI30A   L     R1,PVALTR                                                46716021
         L     R1,DX0(R1)                                               46722021
         MVC   VALDSP(LX2),DX4(R1)   SAVE DISPL IN TABLE                46728021
         MVC   DX32(LX2,R9),DX4(R1)  SAVE DISPL IN TABLE                46734021
GRI031   TM    ITMCLS+NX1,ICLSYN    IS IT SYNCHRONIZED                  46740021
         BZ    GRI032              NO                                   46746021
         OI    DX0(R9),XX10         SET BIT ON IN TABLE                 46752021
         OI    SYNCHR,XX40          SET BIT ON IN ATTRIBUTES            46758021
GRI032   LR    R10,R9                                                   46764021
         S     R10,CON24           R10 POINTS TO PRIOR ENTRY            46770021
         TM    DX0(R10),XX10        PREVIOUS GROUP SYNCHRONIZED         46776021
         BZ    GRI035              NO                                   46782021
         OI    DX0(R9),XX10         YES, SET BITS ON                    46788021
         OI    SYNCHR,XX40                                              46794021
GRI035   TM    DX0(R10),XX08        VALUE ON PREVIOUS GROUP             46800021
         BZ    GRI037              BR TO CHECK CI FOR ODO CLAUSE        46806021
         OI    DX0(R9),XX08         YES, SET BIT ON                     46812021
GRI037   TM    ITMCLS+NX1,XX80     DOES CI CONTAIN AN ODO CLAUSE ?      46818021
         BZ    GRI040             NO- BRANCH.                           46824021
         OI    DX0(R9),XX01        YES- SET BIT.                        46830021
GRI040   DS    0H                                                       46836021
         MVC   ATRCNT(LX1),BCIPRM+NX4    DICTIONARY                     46842021
         MVC   PNTER(LX4),DICPNT                                        46848021
         MVI   CICODE,XX10                                              46854021
         CLI   SRANO,XX00          SD SAME REC AREA NO. INDICATED ?     46860021
         BE    GRI040A             NO, BRANCH                           46866021
         OI    COUNT,XX01          YES, SET LD OF SD BIT                46872021
GRI040A  DS    0H                                                       46878021
         L     R15,AENTPT          LOAD ADD. OF ENTRY ACC               46884021
         LA    R1,CIPARM                                                46890021
         BALR  R14,R15             LNK TO ADDR IN REG 15                46896021
         L     R15,AGRIPR                                               46902021
         MVC   PCI(LX160),CI              PCI = CI                      46908021
GRI050   L     R14,RS14A                                                46914021
         BCR   UNCOND,R14          EXIT                                 46920021
*                                                                       46926021
VALMOV   MVC   DX7(LX0,R2),LITVAL                                       46932021
         EJECT                                                          46938021
*=1   ELEMENTARY ITEM PROCESSING ROUTINE (ELIPR)                        46944021
*                                                                       46950021
*  ELIPR ROUTINE PROCESSES ALL CURRENT ITEMS (CI) WHICH ARE ELEMENT     46956021
*                                                                       46962021
ELIPR    STM   R8,R15,RS8                                               46968021
         L     R15,AGRIPR                                               46974021
         ST    R14,RS14A                                                46980021
ELI000   L     R9,GPARAM                                                46986021
         L     R10,DX0(R9)          GET THE ADDRESS OF GLS.             46992021
         L     R9,DX0(R10)                                              46998021
         N     R9,MK0932                                                47004021
         ST    R9,MTEMP1           SAVE BEGINNING ADDRESS OF GLSTK      47010021
         AH    R9,DX4(R10)                                              47016021
         S     R9,CON24            R9 POINTS TO LAST ENTRY OF GLS.      47022021
         ST    R9,LGS                                                   47028021
         TM    DX0(R9),XX10         IS GROUP SYNCHRONIZED               47034021
         BZ    ELI004              NO, BRANCH                           47040021
         OI    ITMCLS+NX1,ICLSYN    YES, SET BIT ON                     47046021
         B     ELI005              GO COMPARE LEVEL NUMBERS             47052021
ELI004   TM    ITMCLS+NX1,ICLSYN                                        47058021
         BZ    ELI005              NO                                   47064021
         OI    DX0(R9),XX20         YES, SET GPLSTK BIT ON              47070021
         OI    SYNCHR,XX40         SET SYNC BIT                         47076021
ELI005   CLC   CILEV(LX1),DX20(R9)   COMPARE LEVEL NUMBERS              47082021
         BC    HI,ELI010           GO SEE IF BOUNDARY ALIGN NEEDED      47088021
         L     R15,AXTEN                                                47094021
         BALR  R14,R15             GO PROCESS GLS                       47100021
         L     R15,AGRIPR                                               47106021
*                                                                       47112021
*  IS BOUNDARY ALIGNMENT NECESSARY.                                     47118021
*                                                                       47124021
ELI010   OC    DX34(LX1,R9),GUI                                         47130021
         TM    ITMCLS,XX40          JUSTIFIED CLAUSE                    47136021
         BZ    ELI10B              NO                                   47142021
         OI    DX34(R9),XX08        SET JUSTIFIED BIT ON                47148021
ELI10B   TM    DX0(R9),XX08         VALUE ON GROUP                      47154021
         BZ    ELI10A              NO                                   47160021
         TM    ITMCLS,XX38          VALUE SPECIFIED                     47166021
         BZ    ELI10A              NO                                   47172021
         BAL   R4,ERROR            YES, ERROR                           47178021
         DC    X'208C'             MSG 140                              47184021
         NI    ITMCLS,XXC7          TURN OFF VALUE CLAUSE               47190021
ELI10A   CLI   CILEV,XX01           IS THIS 01                          47196021
         BC    NOTEQ,ELI015        SEE IF CI REDF OR IN REDFS GRP       47202021
         TM    ITMCLS+NX1,ICLSYN    SYNC                                47208021
         BZ    ELI10C              NO                                   47214021
         OI    SYNCHR,XX40          YES, SET BIT ON                     47220021
ELI10C   TM    LBLSW,XX40           LABEL RECORD                        47226021
         BO    ELILBL1             BOUNDARY ALIGN NOT NEEDED            47232021
         LH    R1,CILGN            CHECK MAX.-MIN.. REC. LGN.           47238021
         N     R1,MK1732           R1= 01 RECORD LENGTH (HALF WORD)     47244021
         CL    R1,MAXIM            IS R1 G.T. CURRENT MAX. REC. LGN     47250021
         BC    NOTHI,ELI011        NO, BRANCH                           47256021
         ST    R1,MAXIM            YES, R1= NEW MAX. REC. LGN.          47262021
ELI011   CL    R1,MINIM            IS R1 L.T. CURRENT MIN. REC. LGN     47268021
         BC    NOTLO,ELI020        NO, BRANCH                           47274021
         ST    R1,MINIM            YES, R1= NEW MIN. REC. LGN.          47280021
         BC    UNCOND,ELI020       BRANCH                               47286021
*                                                                  0026 47292021
*  DETERMINE IF CI  REDEFINES OR IN A REDEFINING GROUP.            0026 47298021
*                                                                  0026 47304021
ELI015   TM    MINCOD,XX01    IS ITEM SUBJ OF REDEFINES             002 47310021
         BC    ZERO,ELI151   NO,CHECK IF  SUBORDINATE TO REDEF.    0026 47316021
         OI    ITMCL3,XX20      ES,TURN ON SUBJ REDEF BIT           002 47322021
ELI151   TM    FES,XX20        IS RDFSTK PRIMES                     002 47328021
         BC    ZERO,ELI153    NO, THEREFORE  NO  ENTRIES.          0026 47334021
         L     R4,RDFPAR      YES,                                 0026 47340021
         L     R5,DX0(R4)         GET POINTER                       002 47346021
         L     R4,DX0(R5)           TO                              002 47352021
         N      R4,MK0932            LAST                          0026 47358021
         AH    R4,DX4(R5)               ENTRY IN                    002 47364021
         S      R4,TWELVE                RDFSTK.                   0026 47370021
         CLI   DX0(R4),XX00    IS LAST ENTRY DELETED                002 47376021
         BC    EQ,ELI153      YES,DELETED                          0026 47382021
         CLC   CILEV(LX1),DX0(R4) IS CI LEVEL GREATER                 0 47388021
         BH    ELI152        CI HI  SO SUBORDINATE                 0026 47394021
         BL    ELI15B        CI  LO  SO RDFSTK NEEDS CLEARING      0026 47400021
         TM    ITMCL3,XX20          IS CI SUBJ OF RDF               002 47406021
         BO    ELI153        YES,GO TO CHECK ALIGNMENT             0026 47412021
ELI15B   OI    XTNSBL,XX02    SET SWITCHES  AND                     002 47418021
         MVI   NOADD,XX01         CALL  ADDPAR                      002 47424021
         L     R15,AADPAR        TO  CLEAN OUT RDFSTK              0026 47430021
         BALR  R14,R15           DOWN TO CURRENT LEVEL.            0026 47436021
         L     R15,AGRIPR    RESET  BASE   REG.                    0026 47442021
         MVI   NOADD,XX00     RESET SWITCH FOR AADPAR.              002 47448021
         BC    UNCOND,ELI151     CHECK RDFSTK AGAIN.               0026 47454021
ELI152   OI    ITMCL3,XX10    SET  SUB TO GRP RDF SWITCH.           002 47460021
ELI153   SR    R2,R2           CLEAR OUT R2                        0026 47466021
         TM    ITMCLS+NX1,ICLSYN    SYNCHRONIZED                    002 47472021
         BZ    ELI020              NO, ALIGNMENT NOT NEEDED             47478021
         SR    R2,R2                                                    47484021
         IC    R2,MINCOD                                                47490021
         SRL   R2,DX4(R0)          LEAVE MINCOD IN LOW ORDER 4 BITS.    47496021
         CL    R2,SEVEN            USAGE IS INDEX                 45694 47502021
         BE    ELI153A            YES, BRANCH                     45694 47508021
         CL    R2,NINE                                                  47514021
         BC    NOTHI,ELI020           ALIGNMENT NOT NEEDED.             47520021
         CL    R2,ELEVEN                                                47526021
         BC    HI,ELI020           ALIGNMENT NOT NEEDED.                47532021
ELI153A  DS    0H                                                 45694 47538021
         OI    SYNCHR,XX40          SET BIT ON                          47544021
ELI016   L     R15,AIRSBT                                               47550021
         BALR  R14,R15             SEE IF SLACK BYTES NEEDED            47556021
         L     R15,AGRIPR                                               47562021
         L     R15,ARDF10                                               47568021
         BALR  R14,R15             GET ADDRESS OF LGS                   47574021
         L     R15,AGRIPR                                               47580021
*                                                                       47586021
*  BOUNDARY ALIGNMENT NOT NEEDED.                                       47592021
*                                                                       47598021
ELILBL1  LH    R1,CILGN                                                 47604021
         CL    R1,LBLMAX                                                47610021
         BL    ELI020              RESTORE @ OF LGS AFTER ACCS RTN      47616021
         ST    R1,LBLMAX                                                47622021
         B     ELI020              BRANCH                               47628021
ELI020   XC    RDFSW(LX1),RDFSW     TURN OFF SW IF ON                   47634021
         BAL   R14,INTVLC          SEE IF ITEM HAS ODO                  47640021
         L     R15,AADPAR          CALL ADPAR TO ASSIGN ADDR. PARAM     47646021
         BALR  R14,R15             GO ASSIGN ADDR PARAM                 47652021
         L     R15,AGRIPR                                               47658021
         CLI   NUMBCD,XX00         FILLER IS NOT ENTERED INTO DICTIO    47664021
         BC    EQ,ELI24A           SEE IF CI IS AN OCCURS               47670021
ELI02A   MVC   ATRCNT(LX1),BCIPRM+NX4 MOVE ATTRIBUTE LENGTH TO PARAM    47676021
         MVC   PNTER(LX4),DICPNT    MOVE DICT POINTER TO PARAMETER.     47682021
         MVI   CICODE,XX10                                              47688021
         CLI   SRANO,XX00          SD SAME REC AREA NO. INDICATED ?     47694021
         BE    ELI02A1             NO, BRANCH                           47700021
         OI    COUNT,XX01          YES, SET LD OF SD BIT                47706021
ELI02A1  DS    0H                                                       47712021
         LA    R1,CIPARM                                                47718021
         L     R15,AENTPT          ENTER CI IN DICTIONARY.              47724021
         BALR  R14,R15             BRANCH                               47730021
         L     R15,AGRIPR                                               47736021
ELI02B   MVC   PCI(LX160),CI              PCI = CI                      47742021
         L     R15,AELIOD          CALL ELIODO TO SEE IF ELEMENTARY     47748021
         BALR  R14,R15              ITEM IS AN ODO VARIABLE             47754021
         L     R15,AGRIPR                                               47760021
         TM    MINCOD,XX01          IS CI A REDEFINES.                  47766021
         BC    ONES,ELI080         YES, BRANCH                          47772021
ELI021   EQU   *                                                        47778021
ELI24A   TM    MINCOD,XX02          IS CI AN OCCURS.                    47784021
         BC    ONES,ELI050            YES                               47790021
ELI24B   TM    ITMCLS+NX1,XX80      IS CI AN OCCURS-DEPEND-ON.          47796021
         BC    ONES,EDEF4             YES.                              47802021
         TM    ITMCLS,XX38          IS VALUE CLAUSE GIVEN.              47808021
         BC    ZERO,ELI025         BRANCH                               47814021
         CLI   CILEV,XX32    IS ITEM A 77                         06660 47820021
         BC    EQ,ELI24E     YES- DON'T CHECK REDEF               06660 47826021
         TM    ITMCL3,XX30                                          002 47832021
         BC    ZERO,ELI24C            OR IS SUBJECT OF REDEF, VALUE     47838021
         BAL   R4,ERROR            DROP VALUE CLAUSE                    47844021
         DC    X'2077'             119                                  47850021
         BC    UNCOND,ELI025       BRANCH                               47856021
ELI24C   EQU   *                                                  06660 47862021
*DEL                                                                    47868021
         L     R15,ARDF10                                               47874021
         BALR  R14,R15             GET ADDRESS OF LGS                   47880021
         L     R15,AGRIPR                                               47886021
         TM    DX1(R9),XX0C              ANY  OCCURRING GROUP       941 47892021
         BC    ZERO,ELI24D        NO OK BRANCH AROUND ERROR        9418 47898021
         BAL   R4,ERROR            YES, ERROR                           47904021
         DC    X'2095'             149                                  47910021
         BC    UNCOND,ELI025       BRANCH                               47916021
ELI24D   TM    GNSW,XX01            IS VALUE CLAUSE IN VARIABLE PART    47922021
         BC    NOTONE,ELI24E        OF RECORD                           47928021
         BAL   R4,ERROR            YES                                  47934021
         DC    X'2096'             150                                  47940021
         BC    UNCOND,ELI025       BRANCH                               47946021
ELI24E   L     R15,AVALGN                                               47952021
         BALR  R14,R15             PROCESS VALUE CLAUSE                 47958021
         L     R15,AGRIPR                                               47964021
ELI025   LH    R12,CILGN                                                47970021
         N     R12,MK1732          STOP SIGN BIT PROPAGATION IF ANY     47976021
ELI026   LR    R1,R12              R1,R12 BOTH HAVE CILGN               47982021
         A     R12,DISP            DISP = DISP + CI LENGTH.             47988021
         LR    R10,R1                                                   47994021
         ST    R12,DISP            STORE UPDATED LENGTH IN DISP.        48000021
         TM    APAF,XX10                                                48006021
         BC    ONES,ELI030       SORT DISCRIPTION, NO STORAGE SAVED     48012021
         CLI   MCI,XX05             IS ITEM IN LINKAGE SECTION          48018021
         BE    ELI030              YES, DON'T ADD TO LOCCTR             48024021
         A     R10,LOCCTR                                               48030021
         ST    R10,LOCCTR                                               48036021
ELI030   CLC   DISP(LX4),CO4096                                         48042021
         BL    ELI035              LOWER THAN 4096                57835 48048021
         L     R15,AADP49          BRANCH TO ADPAR FOR DISP GT 4096     48054021
         BALR  R14,R15             BRANCH                               48060021
         L     R15,AGRIPR                                               48066021
         BC    UNCOND,ELI038       BRANCH                               48072021
*                                                                       48078021
ELI035   MVC   APAF+NX1(LX1),DISP+NX3                                   48084021
         MVN   APAF(LX1),DISP+NX2                                       48090021
ELI038   LR    R10,R1                                                   48096021
         CLI   MCI,XX04             IF IN WK-STORAGE SECT, ADD TO DS    48102021
         BC    NOTEQ,ELI040        BRANCH                               48108021
         A     R1,DS               DS = DS + CI LENGTH.                 48114021
         ST    R1,DS                                                    48120021
ELI040   L     R14,RS14A                                                48126021
         CLI   CILEV,XX32                                               48132021
         BCR   EQ,R14              BRANCH                               48138021
         TM    MINCOD,XX01          IF REDEFINES, BRANCH                48144021
         BC    ONES,ELI046         BRANCH                               48150021
ELI045   LR    R6,R10                                                   48156021
         L     R15,ARDF10                                               48162021
         BALR  R14,R15             GET ADDRESS OF LGS                   48168021
         L     R15,AGRIPR                                               48174021
         L     R14,RS14A                                                48180021
         LR    R10,R6                                                   48186021
         TM    DX1(R9),VLC          IS VLC ASSIGNED FOR LGS.            48192021
         BC    ONES,EDEF6             YES                               48198021
         L     R6,DX0(R9)           ADD LENGTH TO LGS.                  48204021
         N     R6,MK1632                                                48210021
         AR    R6,R10                                                   48216021
         ST    R6,MTEMP                                                 48222021
         MVC   DX2(LX2,R9),MTEMP+NX2                                    48228021
         TM    MTEMP+NX1,XX01                                           48234021
         BCR   ZERO,R14            BRANCH                               48240021
         OI    DX1(R9),XX01                                             48246021
         BCR   UNCOND,R14          EXIT.                                48252021
ELI046   TM    ITMCLS+NX1,XX08      REDEFINES IN REPORT SECTION         48258021
         BCR   ONES,R14            YES, EXIT                            48264021
         L     R10,REDDIF          ADD DIFF. OF RED. SUBJ. AND RED.     48270021
         BC    UNCOND,ELI045        OBJ. IF FORMER IS LARGER            48276021
ELI050   LH    R12,CILGN           GET CILGN * NOC                      48282021
         MH    R12,NOC                                                  48288021
*                                                                       48294021
         TM    ITMCLS+NX1,XX80      IS CI AN OCCURS-DEPEND-ON.          48300021
         BC    ONES,EDEF4          BRANCH                               48306021
ELI060   TM    ITMCLS,XX38          IS VALUE CLAUSE PRESENT             48312021
         BC    ZERO,ELI026         BRANCH                               48318021
         BAL   R4,ERROR            YES, ERROR                           48324021
         DC    X'2095'             149                                  48330021
         BC    UNCOND,ELI026       BRH TO ELI026                        48336021
ELI080   TM    ITMCLS,XX38          IS VALUE CLAUSE GIVEN               48342021
         BC    ZERO,ELI80A         NO                                   48348021
         TM    ITMCLS+NX1,XX08      SUPPRESS ERROR MESSAGE IF REDEFI    48354021
         BC    ONES,ELI80A            IS IN REPORT SECTION.             48360021
         BAL   R4,ERROR            DROP VALUE CLAUSE                    48366021
         DC    X'2077'             119                                  48372021
ELI80A   LH    R12,CILGN                                                48378021
         TM    MINCOD,XX02                                              48384021
         BC    ZERO,ELI081         BRANCH                               48390021
         MH    R12,NOC                                                  48396021
ELI081   BC    UNCOND,ELI026       BRANCH                               48402021
EDEF4    MVC   FULLWD(LX2),OBJDIS   MOVE OD2TBL PTR TO FULLWD           48408021
         MVC   ODOMAX(LX2),NOC      MOVE NOC OF CI TO ODOMAX            48414021
         BAL   R14,UPDN            BRANCH                               48420021
         L     R15,ARDF10                                               48426021
         BALR  R14,R15             GET ADDRESS OF LGS                   48432021
         L     R15,AGRIPR                                               48438021
         MVC   QTEXT(LX5),UPDTOP         MOVE UPDATE MASK TO QTEXT      48444021
         MVC   QTEXT+NX1(LX2),CILGN  FILL IN LITERAL AND                48450021
         MVC   QTEXT+NX5(LX2),DX2(R9)  VLC= OF LGS                      48456021
         LA    R3,DX7                                                   48462021
         BAL   R14,PUTQRN          PUT OUT Q-RTN TEXT                   48468021
         BC    UNCOND,ELI060       SEE IF VALUE CLAUSE PRESENT          48474021
EDEF5    L     R15,ELEVEN                                               48480021
         B     ERROR               BRANCH TO ERROR ROUTINE              48486021
EDEF6    L     R6,DX16(R9)          ADD ITEM LGN                        48492021
         AR    R6,R10                TO MAX LGN                         48498021
         ST    R6,DX16(R9)              OF LGS                          48504021
         TM    ITMCLS+NX1,XX80      IS ITEM AN ODO                      48510021
         BC    NOTONE,EDEF6B       NO                                   48516021
EDEF6A   L     R14,RS14A           RETURN                               48522021
         BCR   UNCOND,R14          BRANCH                               48528021
EDEF6B   MVC   QTEXT(LX7),INITVB    MOVE INIT VERB MASK TO QTEXT        48534021
         MVI   QTEXT+NX1,STEPVB      AND CHANGE VERB TO STEP            48540021
         MVC   QTEXT+NX4(LX2),DX2(R9) MOVE VLC= INTO MASK               48546021
         ST    R10,FULLWD                                               48552021
         MVC   QTEXT+NX7(LX2),FULLWD+NX2 AND CI LGN.                    48558021
         LA    R3,DX9                                                   48564021
         BAL   R14,PUTQRN          LNK TO SPECIAL ITEM PROCESS          48570021
         BC    UNCOND,EDEF6A       RETURN                               48576021
UPDN     ST    R14,TSAVER                                               48582021
         L     R15,AGRIPR                                               48588021
         ST    R10,GIG             SAVE R10 FOR CALL FROM XTEN          48594021
         MVC   UPDTVB+NX3(LX2),ODOMAX SET MAX OP OF UPDATE              48600021
         MVC   QTEXT(LX8),UPDTCD   MOVE CARD,VERB, + MAX TO QTEXT       48606021
         LA    R3,DX8                                                   48612021
         BAL   R14,PUTQRN          PUT OUT VERB                         48618021
         L     R10,AOD2TB          R10= A(OD2TBL'S TIB)                 48624021
         L     R10,DX0(R10)         R10= A(OD2TBL'S TAMM)               48630021
         L     R10,DX0(R10)         R10= A(OD2TBL)                      48636021
         AH    R10,FULLWD          R10= BCD NAME OF OBJECT OF ODO       48642021
         LA    R10,DX2(R10)                                             48648021
         SR    R8,R8                                                    48654021
UPDN1    IC    R8,DX0(R10)          R8= COUNT OF NAME                   48660021
         EX    R8,OD2MOV           MOVE NAME TO QTEXT                   48666021
         LA    R10,DX1(R10,R8)      R10= COUNT OF NEXT NAME             48672021
         MVI   QTEXT,XX22           QUAL CODE                           48678021
         CLI   DX0(R10),XX00        IS NAME A QUALIFIER                 48684021
         BC    NOTEQ,UPDN2         YES                                  48690021
         MVI   QTEXT,XX23           NO                                  48696021
UPDN2    LA    R3,DX2(R8)                                               48702021
         BAL   R14,PUTQRN          PUT OUT NAME                         48708021
         CLI   DX0(R10),XX00        LAST NAME                           48714021
         BC    NOTEQ,UPDN1         NO                                   48720021
         L     R14,TSAVER                                               48726021
         L     R10,GIG             RESTORE R10 FOR XTEN                 48732021
         BCR   UNCOND,R14          BRANCH                               48738021
OD2MOV   MVC   QTEXT+NX1(LX0),DX0(R10)                                  48744021
*=2  INITIALIZE VLC'S (VARIABLE LGN CELLS) IF ITEM HAS ODO CLAUSE       48750021
INTVLC   TM    ITMCLS+NX1,XX80      DOES ITEM HAVE ODO.                 48756021
         BCR   NOTONE,R14          NO, RETURN                           48762021
         MVC   UPDTCD+NX1(LX2),CARDNO SAVE CARD NUM FOR UPDATE VERB     48768021
         ST    R14,QSAVE+NX60       SAVE INTVLC RETURN                  48774021
         IC    R1,ODOCCT           ADD ONE TO ODOCCT FOR RECORD CON     48780021
         LA    R1,DX1(R1)           CHECKING IN FST000.                 48786021
         STC   R1,ODOCCT                                                48792021
         L     R15,AQBUIL                                               48798021
         BALR  R14,R15             GO BUILD QRTN & QFILE TAB ENTRY      48804021
         L     R15,ARDF10                                               48810021
         BALR  R14,R15             GET ADDRESS OF LGS                   48816021
         L     R15,AGRIPR                                               48822021
         L     R14,QSAVE+NX60                                           48828021
         L     R9,LGS              YES, GET A(LGS) IN GPLSTK            48834021
         NI    REDFSW,XX7F         INITLZ REDEFINES SW OFF        61479 48840021
INTVL1   CLI   DX20(R9),XX00        IS LEVEL =0                         48846021
         BCR   EQ,R14              YES, RETURN                          48852021
         TM    DX1(R9),VLC          NO, DOES GRP ITEM HAVE A VLC        48858021
         BCR   ONES,R14            YES, RETURN                          48864021
         TM    REDFSW,XX80         WAS INNER GROUP SUBJ. OF REDEFINES   48870021
         BO    INTQ           IF SO, SKIP VLC CALC FOR OUTER GROUP61479 48876021
         CLC   DX10(LX3,R9),ZEROS  IS GROUP SUBJECT OF REDEFINES  61479 48882021
         BE    NONRDF              NO,  DON'T SET SW ON           61479 48888021
         OI    REDFSW,XX80        YES, SET REDEFINES SW ON        61479 48894021
NONRDF   DS    0H                                                 61479 48900021
         L     R1,DX0(R9)           NO, GET CURRENT                     48906021
         N     R1,MK1632              GROUP LGN AND MOVE IT TO          48912021
         ST    R1,DX16(R9)             MAX. LENGTH FIELD OF GPLSTK E    48918021
         NI    DX1(R9),XX00                                             48924021
         OI    DX1(R9),XX40         SET MINOR TO VAR. LGN. GROUP        48930021
         LH    R2,VLCCTR         )                                      48936021
         LA    R2,DX1(R2)           GET VLC=  AND                       48942021
         STH   R2,DX2(R9)            PUT IN GPLSTK ENTRY                48948021
         STH   R2,VLCCTR      COM)                                      48954021
INTQ     DS    0H                                                 61479 48960021
         MVC   QTEXT(LX7),INITVB    MOVE INIT CODES  TO WORKAREA        48966021
         STH   R2,QTEXT+NX4         MOVE VLC= AND INIT VALUE TO         48972021
         MVC   QTEXT+NX7(LX2),DX18(R9) QTEXT STRING                     48978021
         LA    R3,DX9                                                   48984021
         LA    R2,QTEXT                                                 48990021
         L     R1,COSADR                                                48996021
         BALR  R0,R1               PUTN Q-TEXT                          49002021
         DC    X'12'                                                    49008021
         S     R9,CON24                                                 49014021
         BC    UNCOND,INTVL1       BRANCH                               49020021
         EJECT                                                          49026021
*                                                                       49032021
**=1  SPECIAL ITEM PROCESSING (SPIR)                                    49038021
*  THIS ROUTINE PROCESSES BOTH THE LEVEL 77 AND THE LEVEL 88 ITEMS.     49044021
*    FOR LEVEL 88'S, VALGEN IS CALLED TO CHECK THE VARIOUS TYPES OF     49050021
*    LITERALS, AND THEN THE CORRECT OR CORRECTED LITERAL IS PUT         49056021
*    INTO THE DICTIONARY IN IC-TEXT FORMAT.                             49062021
*    LEVEL 77'S ARE TREATED AS ELEMENTARY ITEMS, BUT THEIR LENGTHS      49068021
*    ARE NOT TAKEN INTO ACCOUNT IN GROUP LENGTH CALCULATION.            49074021
*       INPUT -- CILEV HAS CI LEVEL NUMBER.                             49080021
*                                                                       49086021
PUTQRN   LA    R2,QTEXT                                                 49092021
         L     R1,COSADR                                                49098021
         BALR  R0,R1               BRANCH TO COMMON ROUTINE             49104021
         DC    X'12'                                                    49110021
         BCR   UNCOND,R14          BRANCH                               49116021
ERROR    LH    R0,DX0(R4)           R0= ERROR =                         49122021
         L     R15,AERRTN          CALL ERROR RTN                       49128021
         BALR  R14,R15             BRANCH TO ERROR ROUTINE              49134021
         L     R15,AGRIPR                                               49140021
         LA    R4,DX2(R4)                                               49146021
         BCR   UNCOND,R4           RETURN                               49152021
IKF210   CSECT                                                          49158021
         USING *,R15                                                    49164021
SPIR     ST    R14,RS14A                                                49170021
         CLI   CILEV,XX33           IS THIS A CONDITION-NAME.           49176021
         BC    NOTEQ,SPI505        GO TO LEVEL 77 PROCESSING            49182021
         TM    ITMCLS,XX38          VALUE CLAUSE PRESENT FOR COND-NA    49188021
         BC    ZERO,SPI400         BRANCH                               49194021
         L     R15,AVALGN          CALL VALGEN TO PROCESS LITERAL.      49200021
         BALR  R14,R15             BRANCH                               49206021
         L     R15,ASPIR                                                49212021
*                                  N.B. CONTROL IS NOT RETURN TO HE     49218021
*                                     IF LITERAL IS NUMERIC.            49224021
*                                                                       49230021
* ENTER CONDITION-NAME INTO THE DICTIONARY.                             49236021
*                                                                       49242021
SPI100   MVI   COUNT,XX0C           PUT COUNT=0 AND MAJOR=C IN ATTRI    49248021
         SR    R1,R1                                                    49254021
         IC    R1,LITVAL           LIT LENGTH +9 = ATTRIB COUNT.        49260021
         LR    R3,R1                                                    49266021
         A     R1,NINE                                                  49272021
         STC   R1,ATRCNT              ATTRIBUTES COUNT                  49278021
         MVI   ATTRIB+NX5,XX00                                          49284021
         IC    R1,LITVAL                                                49290021
         TM    VALTSW,SWON         VALUE IS SERIES                      49296021
         BZ    SPI110              BRANCH                               49302021
         TM    CHKLTH,SWON         NEED TO CHECK LENGTH                 49308021
         BZ    SPI110              NO                                   49314021
         XC    CHKLTH,CHKLTH       TURN OFF SW                          49320021
         CLI   ATTRIB+NX7,XX75      W                                   49326021
         BNE   SPI001              NO                                   49332021
         CLC   ATTRIB+NX8(LX1),LITVAL+NX1                               49338021
         BL    SPI005              OK                                   49344021
         BAL   R2,SPI300           ERROR                                49350021
         B     SPI005              BRANCH                               49356021
SPI001   SR    R4,R4                                                    49362021
         IC    R4,ATTRIB+NX8        COUNT OF FIRST                      49368021
         CR    R1,R4                                                    49374021
         BNH   SPI002              TURN OFF THRU BIT                    49380021
         LR    R1,R4                                                    49386021
SPI002   BCTR  R1,R0               BRANCH                               49392021
         EX    R1,COMPLT                                                49398021
         BL    SPI005              OK                                   49404021
         BE    SPI004              EQUAL CHECK LENGTHS                  49410021
         BAL   R2,SPI300           ERROR                                49416021
         B     SPI005              BRANCH                               49422021
SPI004   CLC   ATTRIB+NX8(LX1),LITVAL                                   49428021
         BNH   SPI005              OK                                   49434021
         BAL   R2,SPI300           ERROR                                49440021
SPI005   IC    R1,LITVAL           COUNT OF LITERAL                     49446021
SPI110   A     R1,TWO                                                   49452021
         STC   R1,ATTRIB+NX6                                            49458021
         MVC   ATTRIB+NX1(LX4),PDICPT                                   49464021
         MVC   ATTRIB+NX7(LX1),MCODE                                    49470021
         EX    R3,SPI990           MOVE THE LITERAL INTO CI.            49476021
         TM    GRP88,SWON          88 UNDER GROUP                       49482021
         BO    SPI115              YES                                  49488021
         TM    VALTSW,SWON         IS THIS VALUE IS SERIES              49494021
         BZ    SPI150              NO                                   49500021
SPI115   L     R1,PVALTR                                                49506021
         SR    R0,R0                                                    49512021
         IC    R0,ATTRIB+NX6        COUNT OF ATTRIBUTES                 49518021
         LR    R4,R0                                                    49524021
         A     R0,ONE              COUNT DOESN'T INCLUDE ITSELF         49530021
         L     R15,BINSRT                                               49536021
         BALR  R14,R15             GO TO INSERT ROUTINE                 49542021
         L     R15,ASPIR                                                49548021
         LR    R1,R0                                                    49554021
         TM    VALTSW,VALTHR       IS IT VALUE THRU                     49560021
         BZ    SPI120              NO                                   49566021
         OI    CHKLTH,SWON         TURN SW ON                           49572021
         OI    ATTRIB+NX6,XX80      SET BIT ON                          49578021
SPI120   EX    R4,SPI999                                                49584021
         TM    GRP88,SWON          88 UNDER GROUP                       49590021
         BZ    SPI130              NO                                   49596021
         TM    VALTSW,SWON         IS IT VALUE THRU ALSO          09498 49602021
         BO    SPI130              YES, DON'T UPDATE VALDSP       09498 49608021
         STH   R3,VALDSP           CHANGE DISPL IN TABLE                49614021
SPI130   L     R14,AVLT20                                               49620021
         BR    R14                 RETURN                               49626021
SPI150   L     R15,AENTNM          ENTER CONDITION NAME INTO DICTIO     49632021
         MVI   CICODE,XX00          ELEMENTARY ITEM CODE.               49638021
         LA    R1,CIPARM                                                49644021
         BALR  R14,R15             BR TO ENTER COND. NAME               49650021
         L     R15,ASPIR                                                49656021
         ST    R1,DICTPT           SAVE DICTIONARY POINTER              49662021
         ST    R1,REALPTR                                               49668021
SPI155 L     R14,RS14A                                                  49674021
         BCR   UNCOND,R14          RETURN TO CALLER.                    49680021
SPI300   L     R15,AERROR                                               49686021
         BALR  R4,R15              60 GENERATE                          49692021
         DC    X'10C1'             MSG 193                              49698021
         L     R15,ASPIR                                                49704021
         BR    R2                  RETURN TO CALLER                     49710021
COMPLT   CLC   ATTRIB+NX9(LX0),LITVAL+NX1                               49716021
*                                                                       49722021
*  ENTER CONDITION-NAME LITERAL AS FIGCON OF BLANKS INTO THE DICTIO     49728021
*                                                                       49734021
SPI200   MVI   FIGCOD,XX40          BLANK.                              49740021
SPI210   MVI   COUNT,XX0C                                               49746021
         MVI   ATRCNT,XX09             ATTRIB COUNT.                    49752021
         MVC   ATTRIB+NX1(LX4),PDICPT                                   49758021
         MVI   ATTRIB+NX5,XX00                                          49764021
         TM    VALTSW,SWON         VALUE IS SERIES                      49770021
         BZ    SPI214              NO                                   49776021
         TM    CHKLTH,SWON         NEED TO CHECK LENGTH                 49782021
         BZ    SPI214              NO                                   49788021
         XC    CHKLTH,CHKLTH       TURN OFF SW                          49794021
         CLI   ATTRIB+NX7,XX75      WAS LAST FIGCON                     49800021
         BNE   SPI212              NO                                   49806021
         CLC   ATTRIB+NX8(LX1),FIGCOD                                   49812021
         BL    SPI214              OK                                   49818021
         BAL   R2,SPI300           ER                                   49824021
         B     SPI214              BRANCH                               49830021
SPI212   CLC   ATTRIB+NX9(LX1),FIGCOD                                   49836021
         BL    SPI214              BRANCH                               49842021
         BAL   R2,SPI300           ERROR                                49848021
SPI214   MVI   ATTRIB+NX6,XX02                                          49854021
         MVI   ATTRIB+NX7,XX75      PUT IN FIGCON CODE.                 49860021
         MVC   ATTRIB+NX8(LX1),FIGCOD                                   49866021
         TM    GRP88,SWON          88 UNDER GROUP                       49872021
         BO    SPI215              YES                                  49878021
         TM    VALTSW,SWON         NO, VALUE IS SERIES                  49884021
         BZ    SPI150              NO                                   49890021
*                                  YES, ENTER IN TABLE NOT IN           49896021
SPI215   L     R1,PVALTR               DICTIONARY                       49902021
         LA    R0,DX3               COUNT OF ENTRY                      49908021
         TM    VALTSW,VALTHR       IS IT VALUE THRU                     49914021
         BZ    SPI220              NO                                   49920021
         OI    ATTRIB+NX6,XX80      YES, SET BIT ON                     49926021
         OI    CHKLTH,SWON         TURN SW ON                           49932021
SPI220   L     R15,BINSRT                                               49938021
         BALR  R14,R15             GET ADD. TO INSERT ENTRY             49944021
         L     R15,ASPIR                                                49950021
         MVC   DX0(LX3,R2),ATTRIB+NX6   MOVE ATTIBUTES TO TABLE         49956021
         TM    GRP88,SWON          88 UNDER GROUP                       49962021
         BZ    SPI230              NO                                   49968021
         TM    VALTSW,SWON         IS IT VALUE THRU ALSO          09498 49974021
         BO    SPI230              YES, DON'T UPDATE VALDSP       09498 49980021
         STH   R3,VALDSP           CHANGE DISPL IN TABLE                49986021
SPI230   L     R14,AVLT20                                               49992021
         BR    R14                 RETURN TO CHECK NEXT                 49998021
*                                                                       50004021
*                                                                       50010021
*                                                                       50016021
*  NO VALUE GIVEN FOR CONDITION-NAME, VALUE ASSUMED TO BE ZERO OR B     50022021
*                                                                       50028021
SPI400   SR    R5,R5                                                    50034021
         IC    R5,PMINCD                                                50040021
         SRL   R5,DX4                                                   50046021
         CL    R5,THREE                                                 50052021
         BC    NOTHI,SPI200        GO TO ENTER COND-NAME LIT            50058021
         MVI   FIGCOD,XX00                                              50064021
         BC    UNCOND,SPI210       BRANCH                               50070021
*                                                                       50076021
SPI990   MVC   ATTRIB+NX8(LX0),LITVAL                                   50082021
SPI505   MVI   CILEV,XX01           DUMMY LEVEL                         50088021
         L     R15,AXTEN                                                50094021
         BALR  R14,R15             BRANCH TO XTEN ROUTINE               50100021
         MVI   CILEV,XX32                                               50106021
         L     R15,ASPIR                   ADDRESSIBILITY               50112021
         L     R14,AELI10                  LOAD REG 14                  50118021
         L     R15,AGRIPR                ADDRESSIBILITY                 50124021
         BCR   UNCOND,R14          BRANCH                               50130021
SPI999   MVC   DX0(LX0,R2),ATTRIB+NX6                                   50136021
AELI10   DC    A(ELI10A)                   ADDR OF ELI10A               50142021
         EJECT                                                          50148021
*=2   REDEFINES CLAUSE PROCESSING ROUTINE (REDEF)                       50154021
*  THIS ROUTINE CHECK FOR SYNTAX ERRORS IN REDEFINES CLAUSES BY CAL     50160021
*    RDSYN ROUTINE, AND ALSO PUTS THE ADDRESS PARAMETER OF THE OBJE     50166021
*    OF THE REDEFINES IN THE ADDRESSING PARAMETER ASSIGNMENT FIELD      50172021
*                                                                       50178021
*                                                                       50184021
         USING *,R15                                                    50190021
*                                                                       50196021
REDEF    ST    R14,RS14A                                                50202021
         XC    RDFERR(LX1),RDFERR      TURN OFF SW                      50208021
         ST    R15,MTEMP1                                               50214021
         BAL   R14,RDF105          GET ADDRESS OF LGS                   50220021
         MVC   RS1(LX3),LID+NX13     SAVE REAL LID.                     50226021
         CLC   CILEV(LX1),DX20(R9)   COMPARE LEVNO OF CI AND GLS.       50232021
         BC    NOTHI,RDF010        BRH TO RDF010                        50238021
*                                                                       50244021
*  PCI IS THE OBJECT OF REDEFINES.                                      50250021
*                                                                       50256021
         TM    ITMCLS+NX1,XX08      IS CI A REPORT ITEM.                50262021
         BC    ZERO,RDF002         BRANCH                               50268021
         CLC   RPTRDF(LX3),ZEROS       YES, DO SPECIAL PROCESSING IF    50274021
         BC    HI,RDF100           NOT THE 1ST ONE IN SERIES.           50280021
RDF000   MVC   RPTRDF(LX3),PADDPR                                       50286021
         MVC   LITBUF(LX3),RPTRDF                                       50292021
         MVC   RPTLOC(LX4),LOCCTR      OM)                              50298021
         L     R0,RPTRDF-NX1                                            50304021
         SRL   R0,DX8                                                   50310021
         N     R0,MK2132                                                50316021
         AH    R0,REDPLS           ADD DISPLACEMENT TO A(OBJ. OF RE     50322021
         ST    R0,WKAR                                                  50328021
         STC   R0,LITBUF+NX1                                            50334021
         MVN   LITBUF(LX1),WKAR+NX2                                     50340021
         C     R0,CO4096        IS THIS GREATER THAN 4096         32388 50346021
         BL    RDF002           DO NOT INCREMENT BL COUNT         32388 50352021
         SR    R14,R14          CLEAR REG 14                      32388 50358021
         IC    R14,LITBUF+NX2   INSERT CURRENT BL NO.             32388 50364021
         LA    R14,DX1(R0,R14)  INCREMENT BL NO. BY ONE           32388 50370021
         STC   R14,LITBUF+NX2   BL NO. IS UPDATED                 32388 50376021
RDF002   CLC   CILEV(LX1),PSRLEN                                        50382021
         BC    EQ,RDF003           BR TO SEE IF OBJ RDF HAS ODO         50388021
         BAL   R4,RERROR           LNK TO ERROR MSG RTN                 50394021
         DC    X'207A'             122                                  50400021
         NI    MINCOD,XXFE          DELETE REDEFINES                    50406021
         L     R14,RS14A                                                50412021
         BCR   UNCOND,R14          BRANCH                               50418021
*                                                                       50424021
RDF003   TM    PITMCL+NX1,XX80     DOES OBJ OF REDEF CONTAIN AN ODO ?   50430021
         BZ    RDF004             NO- BRANCH.                           50436021
         B     RD024A             YES- DELETE REDEF CLAUSE FROM CI.     50442021
*                                                                       50448021
RDF004   L     R1,RNMPAR          GET RNMTBL ENTRY..                    50454021
         L     R15,BINSRT                                               50460021
         BALR  R14,R15             BRANCH                               50466021
         L     R15,MTEMP1                                               50472021
         BAL   R14,RDF105          RESTORE ADDRESS OF LGS               50478021
RDF005   MVC   DX0(LX1,R2),PSRLEN    MAKE ENTRIES IN RNMTBL--LEVEL NO   50484021
         MVC   DX1(LX3,R2),PDICPT+NX1                                   50490021
         MVC   DX4(LX1,R2),PMINCD       MINOR CODE OF PCI.              50496021
         LH    R10,PCILGN          PCI LENGTH.                          50502021
         ST    R10,LREDEF          SAVE LGN OF OBJ. OF REDEFINES.       50508021
         TM    ITMCLS+NX1,XX08                                          50514021
         BC    ONES,RDF008         BRANCH                               50520021
         MVC   LITBUF(LX3),PADDPR                                       50526021
RDF008   CLI   DX20(R9),XX00        IF LEVEL ON LGS = 0,NO LID EXIST    50532021
         BC    NOTEQ,RDF020        GO MAKE ENTRY IN RDFSTK TABLE        50538021
         LA    R1,REDEFA                                                50544021
         ST    R1,PARAM            CALL ACCESS FOR DICTPT OF OBJ. R     50550021
         L     R1,APARAM                                                50556021
         L     R15,ALATRN                                               50562021
         BALR  R14,R15             BR TO ACCESS ROUTINE 'LATRTN'        50568021
         CL    R15,ZEROS                                                50574021
         L     R15,MTEMP1                                               50580021
         BC    EQ,RDF024           BRANCH                               50586021
         BC    UNCOND,RDF060       BRANCH                               50592021
*                                                                       50598021
*  LAST-ITEM-DELETED FROM GROUP LENGTH STACK IS THE OBJ. OF REDEFIN     50604021
*                                                                       50610021
RDF010   L     R15,AXTEN                                                50616021
         BALR  R14,R15             BRANCH TO XTEN ROUTINE               50622021
         L     R15,MTEMP1                                               50628021
         ST    R9,LGS                                                   50634021
         OI    MSW,XX01             SET SW TO MAKE RNMTBL ENTRY LATE    50640021
         TM    LID+NX1,XX40         IS LID VAR LNG?                     50646021
         BZ    RDF012                   BR TO CHK FOR ODO         39849 50652021
         BAL   R4,RERROR           YES - BAD NEWS USER                  50658021
         DC    X'207C'              MSG 124                             50664021
         NI    MSW,XXFE                        TURN OFF SW        41532 50670021
*                INDICATING LID AS REDEF OBJECT                   41532 50676021
         NI    MINCOD,XXFE          INDICATOR OFF                       50682021
         L     R14,RS14A           * RETURN                             50688021
         BR    R14                 * TO CALLER                          50694021
RDF012   EQU   *                                                  39849 50700021
         TM    LID,XX01                 DOES OBJ OF REDEF HAVE ODO39849 50706021
         BO    RD024A                   YES, ISSUE MSG 10         39849 50712021
RDF015   L     R6,LID              LID IS FIXED LENGTH GROUP            50718021
         N     R6,MK1632           SAVE LGN OF OBJ. OF REDEFINES.       50724021
         ST    R6,LREDEF                                                50730021
*                                                                       50736021
*  MAKE AN ENTRY IN RDFSTK TABLE.                                       50742021
*                                                                       50748021
RDF020   MVC   PARAM1(LX4),DICPNT                                       50754021
         MVI   PARAM,XX00                                               50760021
         L     R9,LGS                                                   50766021
         CLC   DX13(LX3,R9),ZEROS                                       50772021
         BC    NOTEQ,RDF20A        BRANCH                               50778021
         LA    R9,LID                                                   50784021
         OI    LIDLGS,XX01                                              50790021
RDF20A   MVC   PARAM+NX1(LX3),DX13(R9) DICTPTR OF PREVIOUS GROUP.       50796021
         LA    R1,PARAM            CALL ACCESS TO ENTRE DUMMY DELIM     50802021
         L     R15,AENTDE                                               50808021
         BALR  R14,R15             BRANCH TO ACCESS RTN 'ENTDEL'        50814021
       L     R15,MTEMP1           RESTORE BASE                          50820021
RDF021   LA    R1,REDEFA           CALL ACCESS TO GET THE DICTIONAR     50826021
         ST    R1,WKAREA              POINTER FOR THE OBJECT OF RED     50832021
         MVI   WKAREA,XX0C                                              50838021
         MVI   WKAREA+NX4,XX00                                          50844021
         TM    LIDLGS,XX01                                              50850021
         BC    ONES,RDF022         BRANCH                               50856021
         BAL   R14,RDF105          RESTORE ADDRESS OF LGS               50862021
         BC    UNCOND,RDF023       BRANCH                               50868021
RDF022   NI    LIDLGS,XXFE          TURN OFF SW                         50874021
RDF023   MVC   WKAREA+NX5(LX3),DX13(R9)                                 50880021
         LA    R1,WKAREA                                                50886021
         L     R15,ALATGP                                               50892021
         BALR  R14,R15             BR TO ACCESS RTN 'LATGRP'            50898021
         LR    R5,R15                          SAVE ERROR CODE          50904021
         CL    R15,ZEROS                                                50910021
         L     R15,MTEMP1                                               50916021
         BC    NOTEQ,RDF60A        UNIQUE NAME NOT FOUND                50922021
         B     RDF024                    BR                       39849 50928021
*                                 YES- DELETE REDEF CLAUSE FROM CI.     50934021
RD024A   BAL   R4,RERROR            *   MSG                             50940021
         DC    X'200A'              *  # 10.                            50946021
         NI    MSW,XXFE                        TURN OFF SW        41532 50952021
*                INDICATING LID AS REDEF OBJECT                   41532 50958021
         NI    MINCOD,XXFE         REDEF BIT OFF.                       50964021
         L     R14,RS14A            *  RETURN                           50970021
         BR    R14                  *  TO CALLER.                       50976021
*                                                                       50982021
RDF024   ST    R3,WKAR             ACCESS RETURN DICTPTR IN R3.         50988021
         MVC   OBJRED(LX4),WKAR     PUT THE POINTER IN OBJRED OF CI.    50994021
         L     R1,RDFPAR                                                51000021
         L     R15,BINSRT                                               51006021
         BALR  R14,R15             BR TO INSERT RTN                     51012021
         L     R15,MTEMP1                                               51018021
         LR    R4,R2                                                    51024021
RDF025   S     R4,TWELVE                                                51030021
         CLC   DX0(LX1,R4),CILEV                                        51036021
         BC    EQ,RDF091           BRANCH                               51042021
         BC    HI,RDF030           BR TO DELETE ENTRY W/> LEVEL NO      51048021
RDF028   MVC   DX0(LX1,R2),CILEV        LEVEL OF CI.                    51054021
         MVC   DX1(LX7,R2),APAF         CURRENT ADDRESSING PARAM.       51060021
         MVC   DX8(LX4,R2),LREDEF       LGN OF OBJECT OF REDEFINES.     51066021
RDF029   TM    MSW,XX01             IS LID THE OBJ OF REDEFINES.        51072021
         BC    ZERO,RDF045            NO.                               51078021
         L     R1,RNMPAR           MAKE A RNMTBL ENTRY,LID IS OBJRE     51084021
         L     R15,BINSRT                                               51090021
         BALR  R14,R15             BR TO INSERT ROUTINE                 51096021
         L     R15,MTEMP1                                               51102021
         MVC   DX0(LX1,R2),LID+NX20          LEVEL NO. OF LID.          51108021
         MVC   DX1(LX3,R2),LID+NX13      DICTPTR OF LID.                51114021
         MVC   DX4(LX1,R2),LID+NX1       MINCOD OF LID.                 51120021
         MVC   LITBUF(LX3),LID+NX21                                     51126021
         NI    MSW,XXFE             RESET SWITCH.                       51132021
         BC    UNCOND,RDF045       BRANCH                               51138021
RDF030   L     R7,RDFPAR           DELETE ENTRY WITH HIGHER LEVEL N     51144021
         L     R8,DX0(R7)                                               51150021
         L     R7,DX0(R8)                                               51156021
         N     R7,MK0932                                                51162021
         AH    R7,DX4(R8)                                               51168021
         S     R7,TWELVE           R7 POINTS TO LAST ENTRY IN RDFST     51174021
         LH    R5,DX4(R8)                                               51180021
         S     R5,TWELVE                                                51186021
         STH   R5,DX4(R8)                                               51192021
         S     R2,TWELVE           R2 POINTS TO START OF NEXT NEW E     51198021
         L     R5,RNMPAR           DELETE ENTRIES IN RNMTBL WITH LO     51204021
         L     R6,DX0(R5)              LEVEL NOS.                       51210021
         L     R5,DX0(R6)                                               51216021
         N     R5,MK0932                                                51222021
         AH    R5,DX4(R6)                                               51228021
RDF035   S     R5,FIVE             R5 POINTS TO LAST/NEXT ENTRY IN      51234021
         CLC   DX0(LX1,R5),CILEV     IS LEVNO LOWER THAN CI.            51240021
         BC    NOTHI,RDF025        BRANCH                               51246021
         LH    R1,DX4(R6)              ADJUST THE TAMM.                 51252021
         S     R1,FIVE                                                  51258021
         STH   R1,DX4(R6)                                               51264021
         BC    UNCOND,RDF035       BRANCH                               51270021
*                                                                       51276021
RDF040   L     R5,RDFPAR                                                51282021
         L     R6,DX0(R5)                                               51288021
         LH    R5,DX4(R6)           ADJUST TAMM DISP FOR ENTRY NOT P    51294021
         SH    R5,TWELVE+NX2                                            51300021
         STH   R5,DX4(R6)                                               51306021
         BC    UNCOND,RDF029       BR TO SEE IF LID IS OBJ OF REDF      51312021
RDF045   BAL   R14,RDSYN           GO TO REDEFS SYNTAX CHECK.RTN        51318021
         L     R2,RS2                                                   51324021
RDF050   L     R14,RS14A                                                51330021
         MVC   APAF(LX3),LITBUF                                         51336021
         L     R10,LREDEF                                               51342021
RDF080   L     R8,DISP                                                  51348021
         SR    R8,R10                                                   51354021
         BC    NOTNEG,RDF090       BRH TO RDF090                        51360021
RDF089   A     R8,CO4096           ADD 4096                             51366021
         BC    NEG,RDF089           UNTIL G.T. OR = THAN ZERO           51372021
RDF090   ST    R8,DISP                                                  51378021
         CLI   MCI,XX05                  IF IN LINKAGE SECT             51384021
       BCR   EQ,R14                      LEAVE                          51390021
         L     R8,LOCCTR                                                51396021
       SR      R8,R10                                                   51402021
         ST    R8,LOCCTR        M)                                      51408021
         BCR   UNCOND,R14          BRANCH                               51414021
RDF091   CLC   LREDEF(LX4),DX8(R4)                                      51420021
         BC    NOTLO,RDF040        BRANCH                               51426021
         L     R8,DX8(R4)                                               51432021
         S     R8,LREDEF            RED. SUBJ. L.T. RED. OBJ.           51438021
         CLI   MCI,XX05             IF LINKAGE SECTION                  51444021
         BC    EQ,RDF092             DON'T CHANGE LOCCTR                51450021
         L     R9,LOCCTR                                                51456021
         SR    R9,R8                                                    51462021
         ST    R9,LOCCTR                                                51468021
RDF092   L     R9,DISP                                                  51474021
         SR    R9,R8                                                    51480021
         ST    R9,DISP                                                  51486021
         BC    UNCOND,RDF040       BRANCH                               51492021
RDF060   BAL  R4,RERROR            BRANCH                               51498021
         DC    X'2078'             120                                  51504021
         NI    MSW,XXFE                        TURN OFF SW        41532 51510021
*                INDICATING LID AS REDEF OBJECT                   41532 51516021
         NI    MINCOD,XXFE          TURN OFF REDEFINES BIT              51522021
         L     R14,RS14A                                                51528021
         BCR   UNCOND,R14          BRANCH                               51534021
RDF60A   CL    R5,EIGHT            DUPLICATE                            51540021
         BE    RDF060              YES, ERROR                           51546021
         CLI   CILEV,XX01           IS IT AN 01 LEVEL ITEM              51552021
         BC    NOTEQ,RDF060          NO - ERROR                         51558021
*        THE OBJECT PRECEDED THE LID IN A CHAIN OF REDEFINES,           51564021
*        WHICH IT DID IF ADDRESSING PARAMETERS ARE EQUAL IN LID         51570021
*        AND RNMTBL.  THIS ASSUMES LID IS ALWAYS LEVEL 01 WHEN CI       51576021
*        IS 01.                                                         51582021
         L     R3,RNMPAR          A(TIB12) FOR RNMTBL                   51588021
         L     R1,DX0(R3)          A(TAMM)                              51594021
         L     R3,DX0(R1)          A(ACTUAL RNMTBL)                     51600021
         LH    R1,DX4(R1)          RNMTBL LENGTH                        51606021
RDF23A   S     R1,FIVE            BYPASS DUMMY FIRST ENTRY              51612021
         BZ    RDF23B             RNMTBL IS EXHAUSTED                   51618021
         A     R3,FIVE            NEXT RNMTBL ENTRY                     51624021
         CLC   DX10(LX3,R9),DX1(R3) ADDRESSING PARAMS LID, RNMTBL       51630021
         BNE   RDF23A                   LOOP THRU RNMTBL          46149 51636021
         LA    R1,REDEFA                CURRENT OBJ NAME          46149 51642021
         ST    R1,PARAM                 PUT NAME ADDR IN PARAM    46149 51648021
         L     R1,APARAM                PARAM ADDR IN R1          46149 51654021
         L     R15,ALATRN               BR TO ACCESS ROUTINE      46149 51660021
         BALR  R14,R15                  TO LOCATE ATTRIBUTES      46149 51666021
         CL    R15,ZEROS                IS OBJ NAME OK            46149 51672021
         L     R15,MTEMP1               RESTORE ADDRESSIBILITY    46149 51678021
         BNE   RDF060                   NOT OK, ERROR             46149 51684021
         CLC   DX21(LX3,R9),DX2(R2)     COMPARE ADDRESSING        46149 51690021
*  PARAMETERS OF LID AND CURRENT REDEF OBJECT                     46149 51696021
         BE    RDF23C                   IF EQUAL, THEN REDEF VALID46149 51702021
RDF23B   BAL   R4,RERROR          NOT A VALID REDEFINES                 51708021
         DC    X'109A'            ERROR MESSAGE 154                     51714021
RDF23C   EQU   *                                                  46149 51720021
         MVC   PARAM+NX1(LX3),DX13(R9)    USE LID AS REDEF        46149 51726021
         L     R3,PARAM                     OBJECT                46149 51732021
         BC    UNCOND,RDF024         ASSUME CORRECT                     51738021
*                                                                       51744021
*  SPECIAL REDEFINES PROCESSING WHEN ITEM IS A REPORT ITEM. NO ERRO     51750021
*   CHECKING IS DONE.                                                   51756021
RDF100   L     R8,RPTRDF-NX1                                            51762021
         SRL   R8,DX8                                                   51768021
         N     R8,MK2132                                                51774021
         AH    R8,REDPLS                                                51780021
         ST    R8,DISP                                                  51786021
         STC   R8,APAF+NX1                                              51792021
         MVN   APAF(LX1),DISP+NX2                                       51798021
         MVC   APAF+NX2(LX1),RPTRDF+NX2  RESTORE BL NUMBER              51804021
         L     R14,RS14A                                                51810021
         BCR   UNCOND,R14          BRANCH                               51816021
*                                                                       51822021
*  RESTORE ADDRESS OF LGS AFTER CALL TO ACCESS ROUTINE                  51828021
*                                                                       51834021
RDF105   L     R9,GPARAM           R9 = A(TIB)                          51840021
         L     R10,DX0(R9)          R10 = A(TAMM)                       51846021
         L     R9,DX0(R10)          R9 = 1-BYTE CODE + A(TABLE)         51852021
         N     R9,MK0932           R9 = A(TABLE)                        51858021
         AH    R9,DX4(R10)          R9 = A(END OF TABLE)                51864021
         S     R9,CON24            R9 = A(LGS)                          51870021
         ST    R9,LGS                                                   51876021
         BCR   UNCOND,R14          BRANCH                               51882021
         EJECT                                                          51888021
*=2   REDEFINES SYNTAX CHECKING ROUTINE (RDSYN)                         51894021
*=E            SUBJECT OF REDEFINES HAS AN OCCURS-DEP-ON CLAUSE.        51900021
*=E            OBJECT OF REDEFINES NOT FOUND.                           51906021
*=E            SUBJECT AND OBJECT OF REDEFINES HAVE DIFF LEVEL NO.      51912021
*=E            OBJECT OF REDEFINES IS SUBSCRIPTED.                      51918021
*=E            OBJECT OF REDEFINES IS A VARIABLE LENGTH GROUP.          51924021
*=E            SUBJECT OF REDEFINES HAS GREATER LENGTH THAN ITS OBJ     51930021
*                                                                       51936021
*  THIS ROUTINE CHECKS THE SYNTAX OF OBJECT AND SUBJECT OF REDEFINE     51942021
*                                                                       51948021
RDSYN    ST    R14,RS14                                                 51954021
         NI    MSW,XXFE             ERROR SW SET OFF                    51960021
         XC    REDDIF(LX4),REDDIF                                       51966021
         TM    ITMCLS+NX1,XX08      EXIT IF ITEM IS IN REPORT.          51972021
         BCR   ONES,R14            BRANCH                               51978021
         TM    ITMCLS+NX1,XX80      IS CI SUBJECT OF AN OCCURS-DEP-O    51984021
         BC    ZERO,RDS010         BRANCH                               51990021
         BAL   R4,RERROR           BRANCH                               51996021
         DC    X'0079'             121                                  52002021
RDS010   L     R5,RNMPAR                                                52008021
         L     R6,DX0(R5)                                               52014021
         L     R5,DX0(R6)           GET TABLE ADDRESS FROM TAMM.        52020021
         N     R5,MK0932                                                52026021
         LR    R4,R5                                                    52032021
         AH    R5,DX4(R6)                                               52038021
         S     R5,FIVE                                                  52044021
         TM    MSW,XX01             IS ERROR SW ON                      52050021
         BC    ONES,RDS030         YES, BRANCH                          52056021
RDS015   CLC   CILEV(LX1),DX0(R5)      FIND THE ENTRY WITH THE SAME L   52062021
         BC    NOTEQ,RDS025        NO                                   52068021
         CLC   OBJRED+NX1(LX3),DX1(R5) IS DICTIONARY POINTER THE SAME   52074021
         BC    EQ,RDS030           BRANCH                               52080021
RDS020   S     R5,FIVE                                                  52086021
         CR    R4,R5                                                    52092021
         BC    NOTEQ,RDS015        BR TO FIND ENTRY WITH SAME LEVL      52098021
RDS025   CLI   DX0(R5),XX01         IS IT 01                            52104021
RDS026   BAL   R4,RERROR           LNK TO ERROR MSG RTN                 52110021
         DC    X'109A'             154                                  52116021
         OI    MSW,XX01                                                 52122021
         BC    UNCOND,RDS010       BRANCH                               52128021
*                                                                       52134021
*  OBJECT OF REDEFINES FOUND IN RNMTBL. DO SYNTAX CHECKING.             52140021
*                                                                       52146021
RDS030   TM    DX4(R5),XX0C         MBS BITS OF OBJRED MUST BE 0.       52152021
         BZ    RDS050              BRH ON 0 TO RDS050                   52158021
         BAL   R4,RERROR           BRANCH                               52164021
         DC    X'007B'             123                                  52170021
RDS050   L     R6,RDFPAR                                                52176021
         L     R7,DX0(R6)                                               52182021
         L     R6,DX0(R7)                                               52188021
         N     R6,MK0932                                                52194021
         AH    R6,DX4(R7)                                               52200021
         S     R6,TWELVE           R6 POINTS TO LAST ENTRY IN RDFST     52206021
         LH    R2,CILGN            CILGN                                52212021
         TM    MINCOD,XX02          OCCURS CLAUSE                       52218021
         BC    ZERO,RDS051         NO                                   52224021
         MH    R2,NOC              CILGN*NOC                            52230021
RDS051   C     R2,DX8(R6)           IS L(SUBJ. RED.) =  L(OBJ. RED.)    52236021
         BC    EQ,RDS060           BRANCH                               52242021
         BC    HI,RDS053           BRANCH                               52248021
         LTR   R2,R2               IF CI HAS 0 LGN, IT IS GROUP ITE     52254021
         BC    ZERO,RDS060         BRANCH                               52260021
         L     R1,DX8(R6)           CALCULATE THE DIFFERENCE IN SIZE    52266021
         SR    R1,R2                                                    52272021
         L     R2,LOCCTR                                                52278021
         AR    R2,R1                  AND UPDATE THE LOCCTR AND DIS     52284021
         ST    R2,LOCCTR                                                52290021
         CLI   MCI,XX05                 IS THIS LINK SECT         42660 52296021
         BNE   RDS052                     NO, BR                  42660 52302021
         LR    R2,R1                    PUT DIFF IN R2            42660 52308021
         A     R2,XTRA                  SAVE XTRA BYTES TO        42660 52314021
         ST    R2,XTRA                   SUBTRACT FROM LOCCTR     42660 52320021
RDS052   EQU   *                                                  42660 52326021
         A     R1,DISP                                                  52332021
         ST    R1,DISP                                                  52338021
         BC    UNCOND,RDS060       BRANCH                               52344021
RDS053   L     R1,DX8(R6)           L(OBJ. REDEFINES)                   52350021
         ST    R2,DX8(R6)                                               52356021
         SR    R1,R2               ADD DIFFERENCE TO LOCCTR             52362021
         LPR   R1,R1                                                    52368021
         ST    R1,REDDIF           SAVE DIFFERENCE FOR ELIPR WHICH      52374021
*                                   ADD THIS TO LAST GROUP ITEM         52380021
         BAL   R4,RERROR           BRANCH TO PUT ERR MSG & ERR RTN      52386021
         DC    X'0076'                                                  52392021
         CLI   MCI,XX05             IF NOT IN LINKAGE SECTION           52398021
         BC    EQ,RDS060           BRANCH                               52404021
         L     R2,DX4(R6)                                               52410021
         AR    R2,R1                                                    52416021
         ST    R2,DX4(R6)                                               52422021
         STC   R2,DX2(R6)           ADJUST APAF IN RDFSTK.              52428021
         MVN   DX1(LX1,R6),DX6(R6)                                      52434021
RDS060   L     R14,RS14                                                 52440021
         NI    MSW,XXFE             TURN OFF ERROR SW IF ON             52446021
         BCR   UNCOND,R14          RETURN                               52452021
RERROR   LH    R0,DX0(R4)           R0= ERROR MSG =                     52458021
         L     R15,AERRTN                                               52464021
         BALR  R14,R15             CALL ERROR RTOUINE                   52470021
         L     R15,MTEMP1                                               52476021
         LA    R4,DX2(R4)                                               52482021
         BCR   UNCOND,R4           BRANCH                               52488021
         EJECT                                                          52494021
         USING *,R15                                                    52500021
VALSER   DS    0H                                                       52506021
         ST    R15,VALSAV                                               52512021
         TM    VALTSW,SWON         1ST TIME FOR ENTRY                   52518021
         BO    VALT08              NO                                   52524021
         TM    PTBLSW+NX2,XX80      TABLE PRIMED YET                    52530021
         BO    VALT05              YES                                  52536021
         LA    R1,PVALTR                                                52542021
         L     R15,BPRIME                                               52548021
         BALR  R14,R15             GO PRIME TABLE                       52554021
         L     R15,VALSAV                                               52560021
         OI    PTBLSW+NX2,XX80      VALTHR PRIMED SW                    52566021
VALT05   OI    VALTSW,SWON         TURN ON VALUE THRU SW                52572021
         L     R1,PVALTR                                                52578021
         L     R1,DX0(R1)                                               52584021
         MVC   VALDSP(LX2),DX4(R1)   SAVE DISPL IN TABLE                52590021
VALT08   IC    R1,DX1(R7)           CONT OF ENTRY                       52596021
         EX    R1,VALT90           MOVE VALUE CLAUSE                    52602021
VALT10   SR    R1,R1                                                    52608021
         NI    VALTSW,SWON                                              52614021
         TM    DX0(R7),VALTHR       IS IT VALUE THRU                    52620021
         BZ    VALT12              NO                                   52626021
         OI    VALTSW,VALTHR       SET BIT ON                           52632021
VALT12   MVC   VALSV1(LX1),DX0(R7)   MOVE LITERAL TYPE                  52638021
         NI    VALSV1,XX07          CLEAR OTHER BITS                    52644021
         IC    R1,VALSV1                                                52650021
         SLL   R1,DX2               MULTIPLY BY 2                       52656021
         ST    R7,VALSV2                                                52662021
         MVC   MINCOD(LX1),PMINCD    SET MINOR CODE FIELD               52668021
         MVI   CILEV,XX33           RESET FIELDS                        52674021
         MVC   CILGN(LX2),PCILGN                                        52680021
         L     R15,AVALGN                                               52686021
         L     R5,AVAL30                                                52692021
         BR    R5                  GO PROCESS LIKE NORMAL 88            52698021
VALT20   L     R15,VALSAV                                               52704021
         TM    VALTSW,XX39         VAL SERIES OR VAL THRU?        05913 52710021
         BZ    VALT40               NO, BRANCH                    05913 52716021
         SR    R6,R6                                                    52722021
         L     R7,VALSV2                                                52728021
         IC    R6,DX1(R7)           GET COUNT OF ENTRY                  52734021
         L     R15,ASRCHT                                               52740021
         L     R5,ACHNXT                                                52746021
         BALR  R3,R5               GO GET NEXT ELEMENT                  52752021
         L     R15,VALSAV                                               52758021
         TM    COPYSW,XX10          EOF                                 52764021
         BC    NOTONE,VALT30       NO                                   52770021
         B     VALT40              YES, GO ENTER COND NAME              52776021
*                                      IN DICTIONARY                    52782021
VALT30   TM    DX0(R7),XX10         STILL VALUE THRU                    52788021
         BO    VALT08              YES, GO PROCESS                      52794021
VALT40   OI    ATTRIB+NX5,XX80      NO, END OF SERIES                   52800021
         MVI   ATTRIB+NX6,XX02      COUNT OF FOLLOWING BYTES            52806021
         MVC   ATTRIB+NX7(LX2),VALDSP MOVE LITERAL DSIPL IN TABLE       52812021
         LA    R0,DX1                                                   52818021
         L     R1,PVALTR                                                52824021
         L     R15,BINSRT                                               52830021
         BALR  R14,R15             END OF TABLE ENTRY                   52836021
         L     R15,VALSAV                                               52842021
         MVI   DX0(R2),XXFF         END OF THIS ENTRY                   52848021
         LA    R1,DX9                                                   52854021
         MVC   ATTRIB+NX1(LX4),PDICPT RESET FIELD                       52860021
         STC   R1,ATRCNT                                                52866021
         L     R15,AENTNM                                               52872021
         MVI   CICODE,XX00                                              52878021
         LA    R1,CIPARM                                                52884021
         BALR  R14,R15             ENTER COND. NAME IN DICTIONARY       52890021
         ST    R1,DICTPT           SAVE DICT PTR                        52896021
         ST    R1,REALPTR                                               52902021
         L     R15,VALSAV                                               52908021
         XC    VALTSW(LX1),VALTSW   TURN OOF SW                         52914021
         XC    CHKLTH,CHKLTH            TURN SW OFF               37381 52920021
         TM    COPYSW,XX02              IS IT END OF SECT         43486 52926021
         BC    ONES,VALT50                 YES,BR                 43486 52932021
         MVC   NXTLEV(LX1),DX2(R7)        SAVE NXT LEVEL NO       43486 52938021
VALT50   EQU   *                                                  43486 52944021
         ST    R7,BSAVE+NX28        CHANGE R7 FOR RETURN                52950021
VALT80 EQU     *                                                        52956021
*VALT80  TM    COPYSW,XX10         WAS END OF FILE FOUND                52962021
*      BC      NOTONE,VALT85      NO,RETURN TO CALLER                   52968021
*      L       R15,APHTRM         YES                                   52974021
*      BR      R15                GO TO TERMINATE                       52980021
VALT85   L     R14,RS14A                                                52986021
         BR    R14                 RETURN TO CALLER                     52992021
VALT90   MVC   LITVAL(LX0),DX1(R7)       MOVE                     42093 52998021
         EJECT                                                    42093 53004021
         USING *,R15                                              42093 53010021
FIGZERO  EQU   *                                                  42093 53016021
         CLC   CILGN(LX2),ONE+NX2        IS CI LGN = 1            42093 53022021
         BC    EQ,FIGZERO1                    YES, BR             42093 53028021
         SR    R5,R5                         CLEAR REG 5          42093 53034021
         LH    R5,CILGN                     LENGTH                42093 53040021
         BCTR  R5,R0                     DECR LGN BY 1            42093 53046021
         STH   R5,SAVE5                                           42093 53052021
         MVC   DX4(LX2,R12),SAVE5          LGN FOR F0'S           42093 53058021
         L     R4,LOCCTR                CURRENT LOCATION CTR      42093 53064021
         AR    R5,R4                    LOCATION FOR C0 IN R5     42093 53070021
         ST    R5,SAVE5                    SAVE IT                42093 53076021
         BAL   R14,PUTOUT1               WRITE OUT TEXT           42093 53082021
         LA    R12,LITBUF                 SET UP STARTING         42093 53088021
         ST    R12,ADDRES                ADDR OF DATA             42093 53094021
         LA    R12,LITBUF+NX1                 LITBUF+NX1          42093 53100021
         MVI   LITBUF,XX28              SET UP FOR C0 CONSTANT    42093 53106021
         MVC   DX0(LX3,R12),SAVE5+NX1   LOCATION FOR C0           42093 53112021
         MVI   DX3(R12),FIGCON             FIGCON CODE            42093 53118021
         MVI   DX6(R12),XX01                COUNT                 42093 53124021
FIGZERO1 MVC   DX4(LX2,R12),ONE+NX2     LENGTH = 1                53547 53130021
         MVI   DX7(R12),XXC0            SIGNED ZERO               53547 53136021
         MVC   NMPUT(R4),NINE            OUTPUT BYTE CNT          42093 53142021
         BAL   R14,PUTOUT1                PUT OUT TEXT            42093 53148021
         L     R14,RS14B                     RETURN ADDR          42093 53154021
         BCR   UNCOND,R14                    RETURN               42093 53160021
SAVE5    DC    F'0'                         SAVE AREA             42093 53166021
         EJECT                                                    42093 53172021
PUTOUT1  EQU   *                                                  42093 53178021
         L     R1,COSADR                                          42093 53184021
         L     R2,ADDRES                    STARTING ADDRESS      42093 53190021
         L     R3,NMPUT                 NO. OF BYTES OF OUTPUT    42093 53196021
         BALR  R0,R1                         BR                   42093 53202021
         DC    X'14'                       FILE 4                 42093 53208021
         BCR   UNCOND,R14                       BR                42093 53214021
         EJECT                                                          53220021
         EJECT                                                          53226021
*=1   VALUE CLAUSE PROCESSING CONTROL (VALGEN)                          53232021
*                                                                       53238021
*  VALGEN CALLS ON ANLIT, NUMLIT, FLPTLT, FIGNNM, AND FIGZER ROUTIN     53244021
*    TO DETERMINE THAT THE DIFFERENT TYPES OF LITERALS ASSOCIATED W     53250021
*    THE VALUE CLAUSE CONFORMS TO THE ATTRIBUTES FOR THE CURRENT IT     53256021
*    AND TO PAD OUT THE LITERAL WITH LEADING OR TRAILING ZEROES OR      53262021
*    TRAILING BLANKS IF REQUIRED.                                       53268021
*                                                                       53274021
IKF211   CSECT                                                          53280021
         USING *,R15                                                    53286021
VALGEN   ST    R14,RS14B           STORE RETURN ADDRESS                 53292021
         CLI   CILEV,XX33           IS THIS A CONDITION-NAME.           53298021
         BC    NOTEQ,VAL010        BRANCH TO CHECK ITEM                 53304021
         MVC   MINCOD(LX1),PMINCD   INITIALIZE.                         53310021
         MVC   CILGN(LX2),PCILGN                                        53316021
         MVC   LEVNUM(LX1),PLEVNM   SAVE SIGN                           53322021
         MVC   VILGN(LX2),PVILGN                                        53328021
         BC    UNCOND,VAL020       BR TO PUT LIT TYPE CODE IN REG       53334021
VAL010   EQU   *                                                        53340021
         CLI   MCI,XX04             IS ITEM IN WORKING-STORAGE SECTI    53346021
         BC    EQ,VAL015           YES                                  53352021
         CLI   MCI,XX06             IS ITEM IN REPORT SECTION           53358021
         BC    EQ,VAL015           YES                                  53364021
VAL012   EQU   *                   VALUE CLAUSE IN LEGAL ONLY IN LE     53370021
         BAL   R4,VERROR               88 IN FILE SECT. AND LINKAGE     53376021
         DC    X'007D'             MSG 125                              53382021
VAL013   L     R14,RS14B                                                53388021
         BCR   UNCOND,R14          BRANCH                               53394021
VAL015   LA    R12,LITBUF+NX1                                           53400021
         MVI   LITBUF,XX28                                              53406021
         LA    R1,LITBUF                                                53412021
         ST    R1,ADDRES                                                53418021
VAL020   SR    R1,R1                                                    53424021
         IC    R1,ITMCLS           PUT LITERAL TYPE CODE IN REGISTE     53430021
         SRL   R1,DX1(R0)                                               53436021
         N     R1,MK2830                                                53442021
VAL030   SR    R5,R5               CLEAR REGISTER FOR LATER ROUTINE     53448021
         BC    UNCOND,*(R1)        BRANCH                               53454021
*  BRANCH ON TYPE OF LITERAL IN VALUE CLAUSE.                           53460021
*                                                                       53466021
         BC    UNCOND,ANLIT        ALPHANUMERIC LITERAL.                53472021
         BC    UNCOND,NUMLIT       NUMERIC LITERAL.                     53478021
         BC    UNCOND,FLPTLT       FLOATING POINT LITERAL.              53484021
         BC    UNCOND,FIGNNM       FIGURATIVE NON-NUMERIC.              53490021
         BC    UNCOND,FIGZER       FIGURATIVE ZERO.                     53496021
         L     R15,AVALSR          VALUE IS SERIES                      53502021
*                                      BRANCHING TABLE                  53508021
         L     R15,AVALSR          NEED NOOP                            53514021
         BR    R15                 BRANCH                               53520021
         EJECT                                                          53526021
         EJECT                                                          53532021
*                                                                       53538021
*  THIS ROUTINE WRITES OUT A-TEXT ON FILE-4 BY CALLING COS ROUTINES     53544021
*        INPUT -- NMPUT HAS THE NO. OF BYTES TO BE PUT OUT              53550021
*                 THE STARTING ADDRESS OF DATA IS AT LITBUF             53556021
*                                                                       53562021
PUTOUT   L     R1,COSADR                                                53568021
         L     R2,ADDRES           STARTING ADDRESS.                    53574021
         L     R3,NMPUT            NO. OF BYTE OF OUTPUT                53580021
         BALR  R0,R1               BRANCH                               53586021
         DC    X'14'               FILE 4                               53592021
         BCR   UNCOND,R14          BRANCH                               53598021
*                                                                       53604021
VERROR   LH    R0,DX0(R4)           R0= ERROR =                         53610021
         L     R15,AERRTN                                               53616021
         BALR  R14,R15             CALL ERROR RTN                       53622021
         L     R15,AVALGN                                               53628021
         LA    R4,DX2(R4)                                               53634021
         BCR   UNCOND,R4           BRANCH                               53640021
         EJECT                                                          53646021
*=2   ALPHANUMERIC LITERAL PROCESSING ROUTINE (ANLIT)                   53652021
*=E            LITERAL DOES NOT CONFORM TO SPECIFICATION,TRUNCATED      53658021
*=               THE LITERAL IS CHANGED TO ZERO.                        53664021
*                                                                       53670021
*  THIS ROUTINE IS CALLED BY VALGEN TO PROCESS ALPHANUMERIC LITERAL     53676021
*    ASSOCIATED WITH THE VALUE CLAUSE.                                  53682021
*                                                                       53688021
ANLIT    IC    R5,MINCOD           IS MINOR CODE ALPHANUMERIC.          53694021
         SRL   R5,DX4(R0)                                               53700021
         CL    R5,FIVE             IS IT REPORT                         53706021
         BE    ANL030              YES                                  53712021
         CL    R5,SIX              IS IT STERLING REPORT                53718021
         BE    ANL030              YESA                                 53724021
         MVI   MCODE,XX34           ALPHANUMERIC CODE FOR COND-NAMES    53730021
         CL    R5,THREE                                                 53736021
         BC    EQ,ANL030              YES.                              53742021
         CL    R5,CON14                ALPHA-NUM EDITED                 53748021
         BE    ANL030                  GO TO CHECK LENGTH               53754021
         TM    GRP88,SWON          88 UNDER GROUP                       53760021
         BO    ANL160              GO OUTPUT AS IS                      53766021
         CL    R5,TWO              IS MINOR CODE ALPHABETIC.            53772021
         BC    NOTEQ,ANL100           ERROR IF NEITHER AL NOR AN.       53778021
*                                                                       53784021
*  MINOR CODE INDICATES AN ALPHABETIC LITERAL. CHECK IT.                53790021
*                                                                       53796021
         IC    R5,LITVAL                                                53802021
         LA    R2,LITVAL           STARTING BYTE OF LITERAL.            53808021
         AR    R5,R2                                                    53814021
         A     R2,ONE                                                   53820021
         L     R4,ONE                                                   53826021
ANL005   CLI   DX0(R2),XX40         IS THIS BYTE A BLANK.               53832021
         BC    EQ,ANL010              YES.                              53838021
         BC    LO,ANL150              ILLEGAL CHAR, ERROR.              53844021
         CLI   DX0(R2),XXC1         IS THIS BYTE AN A                   53850021
         BC    LO,ANL150              NOT AL CHARACTER, ERROR.          53856021
         BC    EQ,ANL010              IT IS A                           53862021
         CLI   DX0(R2),XXC9                    OR                       53868021
         BC    NOTHI,ANL010                      B THROUGH I            53874021
         CLI   DX0(R2),XXD1         IS THIS BYTE J TO R                 53880021
         BC    LO,ANL150              NOT AL, ERROR.                    53886021
         BC    EQ,ANL010              IT IS J                           53892021
         CLI   DX0(R2),XXD9                    OR                       53898021
         BC    NOTHI,ANL010                      K THROUGH R.           53904021
         CLI   DX0(R2),XXE2         IS THIS BYTE S TO Z                 53910021
         BC    LO,ANL150              NOT AL, ERROR.                    53916021
         BC    EQ,ANL010              IT IS S                           53922021
         CLI   DX0(R2),XXE9                    OR T THROUGH Z.          53928021
         BC    HI,ANL150              NOT AL, ERROR.                    53934021
ANL010   BXH   R2,R4,ANL030        GO COMPARE LNGTH OF LIT              53940021
         BC    UNCOND,ANL005       GO CHECK NEXT BYTE.                  53946021
*                                                                       53952021
*  COMPARE LENGTH OF LITERAL WITH THE LENGTH SPECIED IN ATTRIBUTES.     53958021
*                                                                       53964021
ANL030   SR    R5,R5                                                    53970021
         IC    R5,LITVAL                                                53976021
         LH    R6,CILGN            LENGTH IN ATTRIBUTES.                53982021
         CR    R5,R6               COMPARE LENGTH.                      53988021
         BC    EQ,ANL050              EQUAL                             53994021
         BC    LO,ANL060              TOO SHORT,PAD WITH BLANKS.        54000021
*                                                                       54006021
*  LITERAL IS LONGER THAN SPECIFIED LENGTH, TRUNCATE IT.                54012021
*                                                                       54018021
ANL040   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    54024021
         BC    EQ,ANL170           BRANCH                               54030021
         BAL   R4,VERROR           BR AND CALL ERR RTN                  54036021
         DC    X'107E'             126                                  54042021
*                                                                       54048021
*  PUT THE LITERAL OUT.                                                 54054021
ANL050   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    54060021
         MVI   MCODE,XX34                                               54066021
         BC    EQ,ANL160           BRANCH                               54072021
         MVC   DX0(LX3,R12),LOCCTR+NX1                                  54078021
         MVI   DX3(R12),ANCODE      TYPE CODE                           54084021
         CLC   CILGN(LX2),ZEROS         IS CURR ITM LGN 0         40625 54090021
         BNE   ANL050A             NO, DO NOT INSERT LIT LENGTH   40625 54096021
         MVC   CILGN+NX1(LX1),LITVAL INSERT LITERAL LENGTH        40625 54102021
ANL050A  DS    0H                                                 40625 54108021
         MVC   DX4(LX2,R12),CILGN       LENGTH OF LITERAL.              54114021
         A     R12,SIX                                                  54120021
         S     R6,ONE                                                   54126021
         EX    R6,ANL999                                                54132021
ANL055   A     R6,EIGHT            ADD 1 BYTE FOR CONDEF PREFIX COD     54138021
ANL058   ST    R6,NMPUT            CALL PUTOUT FOR A-TEXT OUT-PUT       54144021
         BAL   R14,PUTOUT          PUT OUT Q-RTN TEXT                   54150021
         L     R14,RS14B                                                54156021
         BCR   UNCOND,R14          RETURN                               54162021
*                                                                       54168021
*  LITERAL IS TOO SHORT, PAD WITH LOW ORDER BLANKS.                     54174021
*                                                                       54180021
ANL060   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    54186021
         BC    EQ,ANL140           BR TO PAD COND-NAME WITH BLANKS      54192021
ANL062   L     R4,LOCCTR                                                54198021
         ST    R4,FULLWD             IN WORKAREA                        54204021
         SR    R6,R5               R6= NO. OF BYTES TO PAD              54210021
         MVI   LITVAL-NX1,XX00      USE LITVAL COUNT FOR CONDEF COUN    54216021
         MVI   LITVAL-NX2,ANCODE    1ST CONDEF IS USER'S LITERAL        54222021
         TM    LEVNUM,XX01          IF JUST. RIGHT. CLAUSE, PAD LEAD    54228021
         BC    NOTONE,ANL065       NO                                   54234021
         AR    R4,R6               YES, OFFSET TARGET ADDR. BY PADD     54240021
ANL065   ST    R4,FULLWD           TARGET                               54246021
         BAL   R14,ANL075          PUT OUT USER LITERAL CONDEF          54252021
         MVI   LITVAL-NX2,FIGCON    SET UP PADDING                      54258021
         MVI   LITVAL+NX1,XX01      CONDEF COUNT                        54264021
         MVI   LITVAL+NX2,XX40      BLANKS TO PAD                       54270021
         TM    LEVNUM,XX01          IS IT JUST. RIGHT                   54276021
         BC    NOTONE,ANL070       NO                                   54282021
         MVC   FULLWD(LX4),LOCCTR        )                              54288021
         BC    UNCOND,ANL072       BRANCH                               54294021
ANL070   L     R4,LOCCTR        M)                                      54300021
         AR    R4,R5                                                    54306021
         ST    R4,FULLWD                                                54312021
ANL072   STH   R6,MTEMP                                                 54318021
         MVC   LITVAL-NX1(LX2),MTEMP SET NO. OF PADDED BYTES            54324021
         L     R5,TWO                                                   54330021
         BAL   R14,ANL075          PUT OUT PAD CONDEF                   54336021
         L     R14,RS14B                                                54342021
         BCR   UNCOND,R14          BRH TO RS14B                         54348021
ANL075   MVI   LITVAL-NX6,XX28      CONDEF CODE                         54354021
         MVC   LITVAL-NX5(LX3),FULLWD+NX1 TARGET ADDR.                  54360021
         LA    R3,DX7(R5)           CONDEF LGN.                         54366021
         LA    R2,LITVAL-NX6        CONDEF ADDR.                        54372021
         L     R1,COSADR                                                54378021
         BALR  R0,R1               BRANCH TO COMMON                     54384021
         DC    X'14'                                                    54390021
         BCR   UNCOND,R14          BRANCH                               54396021
*                                                                       54402021
*                                                                       54408021
ANL997   XC    DX0(LX0,R12),DX0(R12) ZERO OUT AN AREA.                  54414021
ANL998   MVC   DX1(LX0,R12),DX0(R12) MOVE IN BLANKS.                    54420021
ANL999   MVC   DX0(LX0,R12),LITVAL+NX1 MOVE IN THE LITERAL.             54426021
*                                                                       54432021
*                                                                       54438021
*  ALPHABETIC LITERAL CONTAINS NON-ALPHABETIC CHARACTER. LITERAL        54444021
*    IS CHANGED TO ALL BLANKS.                                          54450021
*                                                                       54456021
ANL150   BC    UNCOND,FIG050       BR TO CHK IF COND NAME               54462021
*                                                                       54468021
*                                                                       54474021
*  MINCOD INDICATES THAT THIS IS NEITHER AN ALPHANUMERIC NOR ALPHAB     54480021
*    LITERAL.  LITERAL IS CHANGED TO ZEROS.                             54486021
*                                                                       54492021
ANL100   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    54498021
         BC    EQ,ANL110           BRANCH                               54504021
         BAL   R4,VERROR           GET ERROR MSG & CALL ERR RTN         54510021
         DC    X'1081'             129                                  54516021
         BC    UNCOND,FIZ030       BRANCH                               54522021
ANL110   CL    R5,FIVE             REPORT ITEM IS ALLOWED IN COND-N     54528021
         BC    EQ,ANL030           GO COMPARE LENGTH OF LIT             54534021
         BAL   R4,VERROR           GET MSG & CALL ERR RTN               54540021
         DC    X'1081'             129                                  54546021
         BC    UNCOND,FIZ030       BRANCH                               54552021
*                                                                       54558021
*  PAD CONDITION-NAME WITH BLANKS                                       54564021
*                                                                       54570021
ANL140   CH    R6,CON121+NX2        LITERAL LENGTH GT 121 CHAR          54576021
         BL    ANL145         NO                                   6998 54582021
         LA    R6,DX120(R0)    YES - LOAD PRMSBLE LENGTH            699 54588021
ANL145   STC   R6,LITVAL      STORE LITERAL LENGTH=PIC LENGTH      6998 54594021
         SR    R6,R5               R6 = NO. BYTES TO PAD                54600021
         S     R6,TWO                                                   54606021
         LA    R4,LITVAL                                                54612021
         AR    R4,R5                                                    54618021
         LA    R4,DX1(R4)           R4 = ADDRESS TO PAD FROM            54624021
         MVI   DX0(R4),XX40         PAD LITVAL WITH BLANKS              54630021
         LTR   R6,R6                                                    54636021
         BC    NEG,ANL160          ONLY WANT TO PAD ONE                 54642021
         EX    R6,ANLPAD                                                54648021
         BC    UNCOND,ANL160       BRANCH                               54654021
ANLPAD   MVC   DX1(LX0,R4),DX0(R4)                                      54660021
*                                                                       54666021
*  CONDITION-NAMES ARE HANDLED SEPARATELY IN SPIR ROUTINE.              54672021
*                                                                       54678021
ANL160   L     R15,ASPIR                                                54684021
         L     R14,ASP100          OUTPUT COND-NAME LITERAL AS IT I     54690021
         BCR   UNCOND,R14          BRANCH                               54696021
*                                                                       54702021
ANL170   BAL   R4,VERROR                 BR TO ERR RTN            49536 54708021
         DC    X'1080'                  MSG. NO. 128              49536 54714021
         L     R15,ASPIR                RESTORE ADDRESSIBILITY    49536 54720021
         L     R14,ASP200          CHANGE COND-NAME LITERAL TO BLAN     54726021
         BCR   UNCOND,R14          BRANCH                               54732021
*                                                                       54738021
*                                                                       54744021
         EJECT                                                          54750021
*=2   FLOATING POINT LITERAL (FLPTLT)                                   54756021
*=E            LITERAL DOES NOT CONFORM TO SPECIFICATION,TRUNCATED      54762021
*=               THE LITERAL IS CHANGED TO ZERO.                        54768021
*                                                                       54774021
*  THIS ROUTINE IS CALLED BY VALGEN TO PROCESS FLOATING POINT LITER     54780021
*    ASSOCIATED WITH THE VALUE CLAUSE.                                  54786021
*                                                                       54792021
FLPTLT   IC    R5,MINCOD           IS MINCOD INT. FLOATING POINT.       54798021
         TM    GRP88,SWON          88 UNDER GROUP                       54804021
         BO    FIZ080              YES                                  54810021
         SRL   R5,DX4(R0)                                               54816021
         MVI   MCODE,XX33            FLOATING-PT CODE FOR COND-NAMES    54822021
         CL    R5,TEN                                                   54828021
         BC    NOTEQ,FLP060        BR TO CHECK IF GROUP ITEM            54834021
*                                                                       54840021
*  INTERNAL FLOATING POINT LITERAL. CHECK FOR FORMAT OF OUTPUT REQU     54846021
*                                                                       54852021
         IC    R5,ITMCLS                                                54858021
         N     R5,MK3032                                                54864021
         CL    R5,THREE                                                 54870021
         BC    EQ,FLP040           COMPUTATIONAL-1, FULL WORD WANTE     54876021
*                                                                       54882021
*  COMPUTATIONAL-2, OUTPUT DOUBLE-WORD.                                 54888021
*                                                                       54894021
FLP010   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    54900021
         BC    EQ,ANL160           BRANCH                               54906021
         MVC   DX0(LX3,R12),LOCCTR+NX1                                  54912021
         MVI   DX3(R12),HEXCOD         TYPE CODE                        54918021
         MVC   DX4(LX2,R12),EIGHT+NX2   LENGTH OF LIT = 8.              54924021
         MVC   DX6(LX8,R12),LITVAL+NX1  MOVE IN LITERAL                 54930021
         MVC   NMPUT(LX4),CON15                                         54936021
FLP020   BAL   R14,PUTOUT          PUT OUT Q-RTN TEXT                   54942021
         L     R14,RS14B                                                54948021
         BCR   UNCOND,R14          EXIT                                 54954021
*                                                                       54960021
*  COMPUTATIONAL-1.  TRUNCATE LITERAL TO OUTPUT A FULL-WORD.            54966021
*                                                                       54972021
FLP040   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    54978021
         BC    EQ,FLP045           BRANCH                               54984021
         MVC   DX0(LX3,R12),LOCCTR+NX1                                  54990021
         MVI   DX3(R12),HEXCOD        TYPE CODE                         54996021
         MVC   DX4(LX2,R12),FOUR+NX2    LENGTH OF LIT = 4.              55002021
         MVC   DX6(LX4,R12),LITVAL+NX1  MOVE IN LITERAL (TRUNCATED)     55008021
         MVC   NMPUT(LX4),ELEVEN                                        55014021
         BC    UNCOND,FLP020       PUT OUT Q-RTN TEXT & RETURN          55020021
FLP045   MVI   LITVAL,XX04                                              55026021
         BC    UNCOND,ANL160       BRANCH                               55032021
*                                                                       55038021
*                                                                       55044021
*  LITERAL DOES NOT CONFORM TO ATTRIBUTES. LITERAL MAY BE CHANGED T     55050021
*    BLANKS OR ZEROS OR DROPPED DEPENDING ON TYPE IN MINCOD.            55056021
*                                                                       55062021
FLP060   CL    R5,ONE                                                   55068021
         BC    EQ,FLP080           GROUP ITEM.                          55074021
         CL    R5,FOUR                                                  55080021
         BC    EQ,FLP080           GROUP ITEM.                          55086021
         CL    R5,EIGHT                                                 55092021
         BC    LO,FLP100           NOT A GROUP ITEM, AND                55098021
         CL    R5,CON13                                                 55104021
         BC    HI,FLP100              NOT A NUMERIC ITEM.               55110021
*                                                                       55116021
*  MINCOD INDICATES NUMERIC LITERAL. CHANGE LITERAL TO ZEROS.           55122021
*                                                                       55128021
         BC    UNCOND,FIZ030       BRANCH                               55134021
*                                                                       55140021
*  MINCOD INDICATES A GROUP ITEM. THE VALUE CLAUSE IS DROPPED.          55146021
*                                                                       55152021
FLP080   BAL   R4,VERROR           PICK UP ERROR, CALL ERR RTN          55158021
         DC    X'107F'             MSG 127                              55164021
FLP085   L     R14,RS14B                                                55170021
         BCR   UNCOND,R14          RETURN                               55176021
*                                                                       55182021
*  MINCOD INDICATES AL OR AN LITERAL. CHANGE LITERAL TO BLANKS.         55188021
*                                                                       55194021
FLP100   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    55200021
         BC    NOTEQ,ANL150        BRANCH                               55206021
         CL    R5,FIVE             REPORT ITEM IS ALLOWED FOR COND-     55212021
         BC    EQ,ANL160           BRANCH                               55218021
         BC    UNCOND,ANL170       BRANCH                               55224021
         EJECT                                                          55230021
*=2   FIGURATIVE NON-NUMERIC LITERAL (FIGNNM)                           55236021
*=E            LITERAL DOES NOT CONFORM TO SPECIFICATION,TRUNCATED      55242021
*=               THE LITERAL IS CHANGED TO ZERO.                        55248021
*                                                                       55254021
*  THIS ROUTINE IS CALLED BY VALEN TO PROCESS NON-NUMERIC FIGURATIV     55260021
*    CONSTANTS ASSOCIATED WITH VALUE CLAUSE.                            55266021
*                                                                       55272021
FIGNNM   IC    R5,MINCOD                                                55278021
         TM    GRP88,SWON                88 UNDER GROUP           43960 55284021
         BO    FIG070                    YES, OUTPUT AS IS        43960 55290021
         SRL   R5,DX4(R0)                                               55296021
         CL    R5,TWO              IF MINCOD IS APHABETIC.              55302021
         BC    EQ,FIG030              CHECK FOR LEGAL CHARACTERS.       55308021
         BC    LO,FIG020              GROUP ITEM.ERROR.                 55314021
         CL    R5,THREE               OTHERWISE,                        55320021
         BC    EQ,FIG070           IF MINCOD ALPHANUMERIC,OUTPUT LI     55326021
*                                                                       55332021
*  ERROR CONDITION IF MINCOD IS NEITHER AL NOR AN.                      55338021
*                                                                       55344021
         CL    R5,FOUR             IF MINCOD IS A GROUP ITEM,           55350021
         BC    NOTEQ,ANL100           THE VALUE CLAUSE IS DROPPED.      55356021
*                                                                       55362021
FIG020   BAL   R4,VERROR           GET ERR AND CALL  ERR RTN            55368021
         DC    X'107F'             MSG 127                              55374021
FIG025   L     R14,RS14B              ITEM AND EXIT.                    55380021
         BCR   UNCOND,R14          BRANCH                               55386021
*                                                                       55392021
*  MINCOD IS ALPHABETIC. CHECK THE LITERAL FOR LETERS OR BLANKS.        55398021
*                                                                       55404021
FIG030   IC    R5,LITVAL                                                55410021
         LA    R2,LITVAL           STARTING ADDRESS OF LITERAL          55416021
         AR    R5,R2                                                    55422021
         A     R2,ONE                                                   55428021
         L     R4,ONE                                                   55434021
FIG035   CLI   DX0(R2),XX40         IS THIS BYTE A BLANK                55440021
         BE    FIG040              YES                                  55446021
         CLI   DX0(R2),XXC1         IS THIS A TO I                      55452021
         BC    LO,FIG050              NOT AL CHARACTER, ERROR.          55458021
         BE    FIG040              IT IS A                              55464021
         CLI   DX0(R2),XXC9                 OR                          55470021
         BC    NOTHI,FIG040                    B THROUGH I              55476021
         CLI   DX0(R2),XXD1         IS THIS I TO R                      55482021
         BC    LO,FIG050              NOT AL, ERROR.                    55488021
         BE    FIG040              IT IS J                              55494021
         CLI   DX0(R2),XXD9                 OR                          55500021
         BC    NOTHI,FIG040                    K THROUGH R              55506021
         CLI   DX0(R2),XXE2         IS THIS S TO Z                      55512021
         BC    LO,FIG050              NOT AL, ERROR.                    55518021
         BE    FIG040              IT IS S                              55524021
         CLI   DX0(R2),XXE9                 OR                          55530021
         BH    FIG050              NOT AL, ERROR                        55536021
FIG040   BXH   R2,R4,FIG070        CHECK                                55542021
         B     FIG035              GO CHECK NEXT BYTE                   55548021
*                                                                       55554021
*  ILLEGAL CHARACTER AS FIGCON. CHANGE FIGCON TO BLANKS.                55560021
*                                                                       55566021
FIG050   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    55572021
         BC    EQ,ANL170           BRANCH                               55578021
         BAL   R4,VERROR           GET ERR AND CALL ERR RTN             55584021
         DC    X'1080'             128                                  55590021
FIG055   MVC   DX0(LX3,R12),LOCCTR+NX1                                  55596021
         MVI   DX3(R12),FIGCON         TYPE CODE                        55602021
         MVC   DX4(LX2,R12),CILGN       LENGTH                          55608021
         SR    R6,R6                                                    55614021
         IC    R6,LITVAL                                                55620021
         EX    R6,FIG090           MOVE LITERAL                         55626021
FIG060   A     R6,EIGHT            FIXED COUNT                          55632021
         ST    R6,NMPUT                                                 55638021
         BAL   R14,PUTOUT          PUT OUT Q-RTN TEXT                   55644021
         L     R14,RS14B                                                55650021
         BCR   UNCOND,R14          RETURN                               55656021
*                                                                       55662021
*  PUT OUT THE LEGAL LITERAL.                                           55668021
*                                                                       55674021
FIG070   CLI   CILEV,XX33           HANDLE CONDITION-NAME SEPARATELY    55680021
         BC    NOTEQ,FIG080        BRANCH                               55686021
         CLI   LITVAL,XX01          COUNT = 1                           55692021
         BE    FIG075              YES                                  55698021
         MVI   MCODE,XX39           SET UP CODE FOR ALL LITERAL         55704021
         L     R15,ASPIR                                                55710021
         L     R14,ASP100                                               55716021
         BR    R14                 GO PROCESS ALL LITERAL               55722021
FIG075   EQU   *                                                        55728021
         MVC   FIGCOD(LX1),LITVAL+NX1                                   55734021
         L     R15,ASPIR                                                55740021
         L     R14,ASP210                                               55746021
         BCR   UNCOND,R14          BRANCH                               55752021
FIG080   MVC   DX0(LX3,R12),LOCCTR+NX1                                  55758021
         MVI   DX3(R12),FIGCON                                          55764021
         MVC   DX4(LX2,R12),CILGN                                       55770021
         SR    R6,R6                                                    55776021
         IC    R6,LITVAL                                                55782021
         EX    R6,FIG090           MOVE LITERAL                         55788021
         BC    UNCOND,FIG060       BR FOR FIXED COUNT                   55794021
FIG090   MVC   DX6(LX0,R12),LITVAL   COUNT AND LITERAL                  55800021
         EJECT                                                          55806021
*=2   FIGURATIVE NUMERIC LITERAL (FIGNUM)                               55812021
*=E            LITERAL DOES NOT CONFORM TO SPECIFICATION,TRUNCATED      55818021
*=               THE LITERAL IS CHANGED TO ZERO.                        55824021
*                                                                       55830021
*  THIS ROUTINE IS CALLED BY VALGEN TO PROCESS NUMERIC FIGURATIVE       55836021
*    CONSTANTS ASSOCIATED WITH THE VALUE CLAUSE.                        55842021
*                                                                       55848021
FIGZER   IC    R5,MINCOD                                                55854021
         TM    GRP88,SWON          88 UNDER GROUP                       55860021
         BO    FIZ070              YES, OUTPUT AS IS                    55866021
         SRL   R5,DX4(R0)                                               55872021
         CL    R5,TWO              IS MINCOD ALPHABETIC.                55878021
         BC    NOTLO,FIZ020        NO, BRANCH                           55884021
FIZ010   BAL  R4,VERROR            ILLEGAL MINOR CODE                   55890021
         DC    X'2082'             130                                  55896021
         L     R14,RS14B              AND EXIT.                         55902021
         BCR   UNCOND,R14          RETURN                               55908021
*                                                                       55914021
FIZ020   BC    HI,FIZ030           NOT AL, CHECK FURTHER.               55920021
         BAL   R4,VERROR           IT IS AL, GIVE MESSAGE AND           55926021
         DC    X'1080'             128                                  55932021
         CLI   CILEV,XX33           HANDLE 88 SEPARATELY                55938021
         BC    EQ,ANL170           BRANCH                               55944021
         BC    UNCOND,FIG055       CHANGE LITERAL TO BLANKS             55950021
FIZ030   LA    R12,LITBUF+NX1       RESTORE INCASE DESTROYED            55956021
         CL    R5,THREE                                                 55962021
         BC    EQ,FIG070           BRANCH                               55968021
         CL    R5,EIGHT            IS MINCOD EXT. DECIMAL               55974021
         BC    EQ,FIZ060              YES, PUT IT OUT.                  55980021
         BC    HI,FIZ031                   BR                     47924 55986021
         CL    R5,FIVE                   IS IT REPORT ITEM        47924 55992021
         BC    EQ,FIZ060                YES, PUT IT OUT           47924 55998021
         BC    UNCOND,FIZ010             NO, ERR MSG              47924 56004021
FIZ031   EQU   *                                                  47924 56010021
         CL    R5,NINE             ERROR IF MINCOD IS EXT. FLPT.        56016021
         BC    NOTEQ,FIZ035        CHECK IF MINCOD INT.FLOAT PT         56022021
FIZ032   BAL   R4,VERROR           GET ERR AND CALL ERR RTN             56028021
         DC    X'2082'             130                                  56034021
         L     R14,RS14B                                                56040021
         BCR   UNCOND,R14          EXIT                                 56046021
*                                                                       56052021
*  INTERAL FLOATING POINT WANTED.                                       56058021
*                                                                       56064021
FIZ035   CL    R5,TEN              IS MINCOD INT. FLOATING POINT        56070021
         BC    NOTEQ,FIZ040        CHECK IF MINCOD BINARY               56076021
         CLI   CILEV,XX33                                               56082021
         BC    EQ,FIZ070           BRH TO MOVE X'F0' TO FIGCOD          56088021
         MVC   DX0(LX3,R12),LOCCTR+NX1                                  56094021
         MVI   DX3(R12),HEXCOD         TYPE CODE                        56100021
         LH    R6,CILGN               LENGTH                            56106021
         MVC   DX4(LX2,R12),CILGN                                       56112021
         XC    DX6(LX4,R12),DX6(R12)      TRUE ZERO               44258 56118021
         C     R6,FOUR                                                  56124021
         BC    NOTHI,FIZ037        BRANCH                               56130021
         XC    DX10(LX4,R12),DX10(R12)  DOUBLE PRECISION 0              56136021
FIZ037   A     R6,SEVEN                                                 56142021
         ST    R6,NMPUT                                                 56148021
FIZ039   BAL   R14,PUTOUT          PUT OUT Q-RTN TEXT                   56154021
         L     R14,RS14B                                                56160021
         BCR   UNCOND,R14          RETURN                               56166021
*                                                                       56172021
*  BINARY LITERAL WANTED.                                               56178021
*                                                                       56184021
FIZ040   CL    R5,ELEVEN           IS MINCOD BINARY.                    56190021
         BC    NOTEQ,FIZ050        SEE IF MINCOD INT.DECIMAL            56196021
         CLI   CILEV,XX33                                               56202021
         BC    EQ,FIZ070           COND-NAME HAS VALUE 'ZERO'           56208021
         MVC   DX0(LX3,R12),LOCCTR+NX1          MINCOD=BINARY,OUTPUT    56214021
         MVI   DX3(R12),FIGCON        0 WITH LENGTH GIVEN IN ATTRIBU    56220021
         MVC   DX4(LX2,R12),CILGN       LENGTH.                         56226021
         MVI   DX6(R12),XX01        COUNT                               56232021
         MVI   DX7(R12),XX00        FIGCON = 0                          56238021
         MVC   NMPUT(LX4),NINE                                          56244021
         BC    UNCOND,FIZ039       PUT OUT Q-RTN TEXT                   56250021
*                                                                       56256021
*  INTERNAL DECIMAL WANTED.                                             56262021
*                                                                       56268021
FIZ050   CL    R5,TWELVE           IS MINCOD INT. DECIMAL               56274021
         BC    NOTEQ,FIZ032        GET ERR, CALL ERR RTN                56280021
         CLI   CILEV,XX33                                               56286021
         BC    EQ,FIZ070           COND-NAME HAS VALUE 'ZERO'           56292021
         LH    R6,CILGN                                                 56298021
         MVC   DX0(LX3,R12),LOCCTR+NX1                                  56304021
         MVI   DX3(R12),HEXCOD      PUT OUT AN INTERNAL DECIMAL 0       56310021
         MVC   DX4(LX2,R12),CILGN                                       56316021
         A     R12,SIX                                                  56322021
         EX    R6,ANL997                                                56328021
         AR    R12,R6                                                   56334021
         S     R12,ONE                                                  56340021
         OI    DX0(R12),XX0C           WITH A PLUS SIGN.                56346021
         TM    LEVNUM,XX01        SIGNED ????                           56352021
         BO    FIZ055               YES, LEAVE 0C (SIGNED)              56358021
         OI    DX0(R12),XX0F         NO, CHANGED                        56364021
FIZ055   A     R6,SEVEN                                                 56370021
         ST    R6,NMPUT                                                 56376021
         BC    UNCOND,FIZ039       PUT OUT Q-RTN TEXT                   56382021
*                                                                       56388021
*  EXTERNAL DECIMAL OUTPUT WANTED.                                      56394021
*                                                                       56400021
FIZ060   CLI   CILEV,XX33                                               56406021
         BE    FIZ070             CONDITION-NAME  ? YES BRANCH          56412021
         MVC   DX0(3,R12),LOCCTR+NX1                                    56418021
         MVI   DX3(R12),FIGCON                                          56424021
         MVI   DX6(R12),XX01      COUNT                                 56430021
         MVI   DX7(R12),XXF0      FIGCON                                56436021
         MVC   NMPUT(R4),NINE                                           56442021
         TM    VILGN-NX1,XX01           IS FIG ZERO SIGNED        42093 56448021
         BC    ZERO,FIZ065                   NO, BR               42093 56454021
         L     R15,AFIGZERO              ADDRESSIBILITY           42093 56460021
         BR    R15                          BR                    42093 56466021
FIZ065   EQU   *                                                  42093 56472021
         MVC   DX4(LX2,R12),CILGN         CURRENT ITEM LGN        42093 56478021
         B     FIZ039             SET BIT AND RETURN                    56484021
*                                                                       56490021
*  WHEN A CONDITION-NAME HAS VALUE 'ZERO',PHASE2 OUTPUT IS ALWAYS (     56496021
*                                                                       56502021
FIZ070   EQU   *                                                        56508021
         MVI   FIGCOD,XXF0                                              56514021
FIZ075   L     R15,ASPIR                                                56520021
         L     R14,ASP210                                               56526021
         BCR   UNCOND,R14          GO ENTER COND-NAME LIT               56532021
*                                                                       56538021
*  WHEN CONDITION NAME UNDER GROUP HAS VALUE CLAUSE THAT IS             56544021
*   NUMERIC IT IS AN ERROR.                                             56550021
*                                                                       56556021
FIZ080   BAL   R4,VERROR           CALL ERR RTN                         56562021
         DC    X'2029'             MSG 41                               56568021
         L     R7,GETSAV           CORRECT R7                           56574021
         TM    ITMCLS,XX38          VALUE IS SERIES                     56580021
         BC    NOTONE,FIZ090       NO                                   56586021
         SR    R6,R6               YES, BYPASS REST                     56592021
FIZ085   IC    R6,DX1(R7)           COUNT OF ENTRY                      56598021
         L     R15,ASRCHT                                               56604021
         L     R5,ACHNXT                                                56610021
         BALR  R3,R5               GET NEXT ENTRY                       56616021
         L     R15,AVALGN                                               56622021
         TM    DX0(R7),XX10         STILL VALUE THRU                    56628021
         BO    FIZ085              YES                                  56634021
FIZ090   LM    R0,R3,BSAVE                                              56640021
         L     R15,ABEGIN                                               56646021
         L     R4,GETSAV+NX4                                            56652021
         BR    R4                  RETURN TO ORIGINAL CALLER            56658021
         EJECT                                                          56664021
*=2   NUMERIC LITERAL (NUMLIT)                                          56670021
*=E            LITERAL DOES NOT CONFORM TO SPECIFICATION,TRUNCATED      56676021
*=               THE LITERAL IS CHANGED TO ZERO.                        56682021
*                                                                       56688021
*  THIS ROUTINE PROCESSES NUMERIC LITERALS ASSOCIATED WITH THE VALU     56694021
*    CLAUSE.  CONVERSION TO BINARY OR EXTERNAL DECIMAL FORM IS ALSO     56700021
*    DONE WHEN NECESSARY.                                               56706021
*    FOR CONDITION-NAMES, NO ERROR CHECKING IS DONE IN THIS ROUTINE     56712021
*    THE LITERAL IS CONVERTED INTO INTERNAL DECIMAL FORMAT AND PUT      56718021
*    INTO THE DICTIONARY IN IC-TEXT FORMAT.                             56724021
*                                                                       56730021
*                                                                       56736021
NUMLIT   TM    GRP88,SWON          88 UNDER GROUP                       56742021
         BO    FIZ080              YES                                  56748021
         LA    R2,LITVAL           SAVE THE SIGN FROM SOURCE.           56754021
         SR    R3,R3                                                    56760021
         IC    R3,LITVAL                                                56766021
         AR    R2,R3                                                    56772021
         TM    VALTSW,SWON         VALUE IS SERIES                      56778021
         BZ    NUMLT0              BRANCH TEST SIGN IN SOURCE           56784021
         TM    PVILGN-NX1,XX01      SIGN IN SOURCE                      56790021
         BZ    NUM001              GO FORCE SIGN TO F IF UNSIGNED       56796021
         B     NUMLT1              GO TEST SIGN IN VALUE CLAUSE         56802021
NUMLT0   TM    VILGN-NX1,XX01       SIGN IN SOURCE                      56808021
         BC    ZERO,NUM001         GO FORCE SIGN TO F IF UNSIGNED       56814021
NUMLT1   TM    DX0(R2),XXF0         SIGN IN VALUE CLAUSE                56820021
         BC    NOTONE,NUMLT2       GO INSERT NEGATIVE 0                 56826021
         BAL   R4,VERROR           GENERATE                             56832021
         DC    X'00BE'             MSG 190                              56838021
         NI    DX0(R2),XX0F                                             56844021
         OI    DX0(R2),XXC0         ASSUME POSITIVE                     56850021
NUMLT2   CLI   DX0(R2),XXD0         NEGATIVE ZERO                       56856021
         BNE   NUMLT5              NO                                   56862021
         LA    R4,LITVAL+NX3        MAYBE                               56868021
NUMLT3   CLI   DX0(R4),XXF0         ZERO                                56874021
         BNE   NUMLT4              NO                                   56880021
         LA    R4,DX1(R4)           POINT TO NEXT                       56886021
         B     NUMLT3              GO CHECK NEXT                        56892021
NUMLT4   CLI   DX0(R4),XXD0         END OF STRING                       56898021
         BNE   NUMLT5              NO, NOT ZERO                         56904021
         MVI   DX0(R4),XXC0         YES, MAKE POSITIVE                  56910021
NUMLT5   MVC   NMSIGN(LX1),DX0(R2)   SAVE SIGN FROM SOURCE              56916021
         BC    UNCOND,NUM003       SEE IF IT IS 88                      56922021
NUM001   MVI   NMSIGN,XXF0          FORCE SIGN TO F IF SIGN NOT GIVE    56928021
         TM    DX0(R2),XXF0         WAS SIGN GIVEN IN VALUE CLAUSE L    56934021
         BC    ONES,NUM003         NO, BRANCH                           56940021
         OI    DX0(R2),XXF0         YES, SET TO F                       56946021
         BAL   R4,VERROR           CALL ERR RTN                         56952021
         DC    X'009C'             MSG 156                              56958021
NUM003   CLI   CILEV,XX33           IS IT 88                            56964021
         BE    NUM400              YES, HANDLE SEPARATELY               56970021
         IC    R5,MINCOD                                                56976021
         SRL   R5,DX4                                                   56982021
         CL    R5,EIGHT                                                 56988021
         BC    EQ,NUM025           GO EXAMINE THE SCALE                 56994021
         BC    HI,NUM020           BRANCH                               57000021
         CL    R5,TWO                                                   57006021
         BC    EQ,NUM010              ALPHABETIC                        57012021
         CL    R5,THREE                                                 57018021
         BC    EQ,NUM010              ALPHANUMERIC                      57024021
         CL    R5,CON14            APLHANUMERIC EDITED                  57030021
         BE    NUM010              YES, ERROR                           57036021
NUM000   BAL   R4,VERROR           CALL ERR RTN                         57042021
         DC    X'20B8'             184                                  57048021
         L     R14,RS14B             ERROR IF USAGE IS FL. PT.          57054021
         BCR   UNCOND,R14          RETURN                               57060021
NUM005   LA    R4,LITVAL+NX3       GET STARTING ADDRESS                 57066021
NUM007   TM    DX0(R4),TZERO       SEE IF ZERO                          57072021
         BNZ   NUM000              CALL ERR RTN                         57078021
         CLR   R4,R2               AT END                               57084021
         BE    FIZ035              YES, OK GO PROCESS LIKE ZERO         57090021
         LA    R4,DX1(R4)          POINT TO NEXT BYTE                   57096021
         B     NUM007              CHECK NEXT BYTE                      57102021
NUM010   BAL   R4,VERROR           CHANGE LITERAL TO BLANKS             57108021
         DC    X'1080'             128                                  57114021
         BC    UNCOND,FIG055       BAD CHAR AS FIGCON, MAKE F. BLK      57120021
NUM020   CL    R5,ELEVEN                                                57126021
         BL    NUM005              INT FLT PT                           57132021
TZERO    EQU   X'0F'                                                    57138021
         CL    R5,CON13                                                 57144021
         BC    NOTLO,NUM000        VALUE CLAUSE ILLEGAL                 57150021
NUM025   TM    VILGN,XX80           EXAMINE THE SCALE.                  57156021
         BC    ONES,NUM300            LESS THAN ZERO.                   57162021
         CLI   VILGN,XX00                                               57168021
         BC    HI,NUM200              GREATER THAN 0.                   57174021
*                                                                       57180021
*  SCALE = 0, THE ITEM IS AN INTEGER DESCRIBED BY 9'S ONLY.             57186021
*                                                                       57192021
NUM030   CLI   LITVAL+NX2,XX00      DOES LITERAL HAVE DECIMALS.         57198021
         BC    EQ,NUM040              ERROR AND                         57204021
         LA    R6,NUM040                                                57210021
         BAL   R4,SETA             SEE IF DECIMAL DIGITS=0              57216021
         BAL   R4,VERROR           CALL ERR RTN                         57222021
         DC    X'1081'             129                                  57228021
         BC    UNCOND,FIZ030          LITERAL IS CHANGED TO 0.          57234021
*                                                                       57240021
NUM040   SR    R2,R2                                                    57246021
         IC    R2,VILGN+NX1                                             57252021
         ST    R2,MTEMP1                                                57258021
NUM045   SR    R1,R1                                                    57264021
         IC    R1,LITVAL+NX1                                            57270021
         CR    R2,R1                                                    57276021
         BC    EQ,NUM060           BRANCH                               57282021
         BC    HI,NUM048           BRANCH                               57288021
         LA    R6,NUM060                                                57294021
         BAL   R4,SETD             SEE IF LEADING DIGITS=0              57300021
         BAL   R4,VERROR           ERROR IF ATTRIB LGN IS SHORTER       57306021
         DC    X'1081'             129                                  57312021
         BC    UNCOND,FIZ030          CHANGED LITERAL TO 0.             57318021
NUM048   EQU   *                                                        57324021
         LA    R12,LITBUF+NX8          LITERAL LENGTH.                  57330021
         SR    R4,R4                                                    57336021
         IC    R4,LITVAL+NX2       CALCULATE THE TOTAL LGN OF LITERA    57342021
         AR    R4,R2                                                    57348021
         SR    R2,R1                                                    57354021
         MVI   DX0(R12),XXF0                                            57360021
         S     R2,TWO                                                   57366021
         BC    NEG,NUM050          BRANCH                               57372021
         EX    R2,NUM075                                                57378021
         AR    R12,R2                                                   57384021
         A     R12,ONE                                                  57390021
NUM050   A     R12,ONE                                                  57396021
         IC    R1,LITVAL+NX1                                            57402021
         LTR   R1,R1                                                    57408021
         BC    ZERO,SKIPEX         YES SKIP NEXT INSTRUCTION            57414021
         EX    R1,NUM076                                                57420021
SKIPEX   AR    R12,R1                                                   57426021
         CLI   LITVAL+NX2,XX00                                          57432021
         BC    EQ,NUM055           BRANCH                               57438021
         SR    R2,R2                                                    57444021
         IC    R2,LITVAL+NX2                                            57450021
         S     R2,ONE                                                   57456021
         LA    R3,LITVAL+NX3                                            57462021
         AR    R3,R1                                                    57468021
         EX    R2,NUM077                                                57474021
NUM055   LA    R2,LITBUF+NX8                                            57480021
         LR    R3,R2                                                    57486021
         LR    R1,R4                                                    57492021
         IC    R4,NOOFPS           SUBTRACT SCALE FROM LIT. LGN. IF     57498021
         SR    R1,R4                THIS RTN ENTERED FOR  LEADING Z     57504021
         ST    R1,MTEMP1                                                57510021
         BC    UNCOND,NUM070       SEE WHAT FORM OUTPUT IS WANTED       57516021
NUM060   LA    R12,LITBUF+NX8                                           57522021
       BCTR  R2,R0                 BRANCH                               57528021
         EX    R2,NUM076                                                57534021
         LA    R2,LITBUF+NX8                                            57540021
NUM070   CL    R5,EIGHT                                                 57546021
         BC    EQ,NUM090           EXTERNAL DECIMAL OUTPUT WANTED.      57552021
         CL    R5,ELEVEN                                                57558021
         BC    EQ,NUM170           BINARY OUTPUT WANTED.                57564021
         CL    R5,TWELVE                                                57570021
         BC    EQ,NUM100           INTERNAL DECIMAL OUTPUT WANTED.      57576021
NUM080   BAL   R4,VERROR           CALL ERR RTN                         57582021
         DC    X'2082'             130                                  57588021
         L     R14,RS14B           OTHERWISE,VALUE IS DROPPED.          57594021
         BCR   UNCOND,R14          RETURN                               57600021
NUM090   LR    R12,R2              WRITE OUT IN A-TEXT FORMAT.          57606021
         S     R12,SEVEN                                                57612021
         MVI   DX0(R12),XX28                                            57618021
         MVC   DX1(LX3,R12),LOCCTR+NX1                                  57624021
         MVI   DX4(R12),HEXCOD                                          57630021
         MVC   DX5(LX2,R12),CILGN                                       57636021
         ST    R12,ADDRES                                               57642021
         LH    R1,CILGN                                                 57648021
         A     R1,SEVEN                                                 57654021
         ST    R1,NMPUT                                                 57660021
NUM095   BAL   R14,PUTOUT          PUT OUT Q-RTN TEXT                   57666021
         LA    R2,LITBUF                                                57672021
         ST    R2,ADDRES                                                57678021
         L     R14,RS14B                                                57684021
         BCR   UNCOND,R14          RETURN                               57690021
*                                                                       57696021
NUM100   LA    R3,LITBUF+NX8                                            57702021
NUM110   L     R1,MTEMP1                                                57708021
         BAL   R14,EDID            CONVERT EXT DECIAML TO INT DEC       57714021
         LA    R12,WKAREA-NX7                                           57720021
         MVI   DX0(R12),XX28                                            57726021
         MVC   DX1(LX3,R12),LOCCTR+NX1                                  57732021
         MVI   DX4(R12),HEXCOD                                          57738021
         MVC   DX5(LX2,R12),CILGN                                       57744021
         LH    R6,CILGN                                                 57750021
         A     R6,SEVEN                                                 57756021
         ST    R6,NMPUT                                                 57762021
         ST    R12,ADDRES                                               57768021
         BAL   R14,PUTOUT          PUT OUT Q-RTN TEXT                   57774021
         LA    R2,LITBUF                                                57780021
         ST    R2,ADDRES                                                57786021
         L     R14,RS14B                                                57792021
         BCR   UNCOND,R14          RETURN                               57798021
*                                                                       57804021
NUM170   LA    R3,LITBUF+NX8        OUTPUT LITERAL IN BINARY FORM.      57810021
NUM175   L     R1,MTEMP1                                                57816021
         BAL   R14,EDID            CONVERT EXT DECIMAL TO INT DEC       57822021
         L     R1,OUTPUT                                                57828021
         LA    R3,WKAREA                                                57834021
         L     R15,AIDBI                 ADDRESSIBILITY                 57840021
         BALR  R14,R15                    BR TO RTN                     57846021
         L     R15,AVALGN               RESTORE ADDRESSIBILITY          57852021
         CLC   OUTPUT(LX1),CILGN+NX1                                    57858021
         BC    NOTHI,NUM180        BRANCH                               57864021
         BAL   R4,VERROR           CALL ERR RTN                         57870021
         DC    X'1080'             128                                  57876021
         L     R14,RS14B                                                57882021
         BR    R14                 BRANCH                               57888021
NUM180   STM   R2,R3,LITBUF+NX8                                         57894021
         LH    R1,CILGN                                                 57900021
         CLI   CILGN+NX1,XX02                                           57906021
         BC    EQ,NUM182           GO GET 2 BYTES BINARY OUTPUT         57912021
         CLI   CILGN+NX1,XX04                                           57918021
         BC    EQ,NUM184           GO GET 4 BYTES BINARY OUTPUT         57924021
         LA    R2,LITBUF+NX8        8 BYTES OF OUTPUT.                  57930021
         BC    UNCOND,NUM090       GO WRITE OUT IN A-TEXT FORMAT        57936021
NUM182   LA    R2,LITBUF+NX10       2 BYTES OF BINARY OUTPUT.           57942021
         BC    UNCOND,NUM090       GO WRITE OUT IN A-TEXT FORMAT        57948021
NUM184   LA    R2,LITBUF+NX8        4 BYTES OF BINARY OUTPUT.           57954021
         BC    UNCOND,NUM090       GO WRITE OUT IN A-TEXT FORMAT        57960021
*                                                                       57966021
*  SCALE IS GREATER THAN ZERO. VALUE OF SCALE = NO. OF P'S + NO. OF     57972021
*   TO THE RIGHT OF THE DEC. POINT. LIT OF FORM 99V9,V9, OR VP9  .      57978021
*                                                                       57984021
NUM200   EQU   *                                                        57990021
NUM210   CLC   VILGN(LX1),LITVAL+NX2 COMPARE SCALE WITH NO. OF DECIMA   57996021
         BC    HI,NUM220           SCALE GREATER, TRAILING 0 ADDED.     58002021
         BC    EQ,NUM230           SEE P'S PRESENT,CHECK CORR DIGT      58008021
         LA    R6,NUM230                                                58014021
         BAL   R4,SETB             SEE IF EXTRA DECIMAL DIGITS=0        58020021
         BAL   R4,VERROR           CALL ERR RTN                         58026021
         DC    X'1081'             129                                  58032021
         BC    UNCOND,FIZ030       BRANCH                               58038021
*                                                                       58044021
NUM220   SR    R2,R2                                                    58050021
         SR    R7,R7                                                    58056021
         IC    R2,VILGN            ADD TRAILING ZEROS TO LITERAL.       58062021
         SR    R1,R1                                                    58068021
         IC    R1,LITVAL                                                58074021
         LA    R12,LITVAL                                               58080021
         AR    R12,R1                                                   58086021
         OI    DX0(R12),XXF0        CHANGE THIS ZONE TO F.              58092021
         A     R12,ONE                                                  58098021
         IC    R1,LITVAL+NX2                                            58104021
         SR    R2,R1                                                    58110021
         MVI   DX0(R12),XXF0                                            58116021
         S     R2,TWO                                                   58122021
         BC    NOTNEG,NUM223       BRANCH                               58128021
         S     R12,ONE                                                  58134021
         BC    UNCOND,NUM226       BRANCH                               58140021
NUM223   EX    R2,NUM075                                                58146021
         AR    R7,R2                                                    58152021
         A     R7,ONE                                                   58158021
NUM225   AR    R12,R2                                                   58164021
NUM226   A     R12,ONE                                                  58170021
         A     R7,ONE                                                   58176021
         MVZ   DX0(LX1,R12),NMSIGN                                      58182021
         SR    R1,R1               UP THE DECIMAL COUNT AFTER PADDI     58188021
         IC    R1,LITVAL+NX2                                            58194021
         AR    R1,R7                                                    58200021
         STC   R1,LITVAL+NX2                                            58206021
NUM230   CLI   NOOFPS,XX00          IF THERE ARE P'S PRESENT,  CHECK    58212021
         BC    EQ,NUM260              THE CORRESPONDING DIGITS.         58218021
         SR    R2,R2                                                    58224021
         IC    R2,NOOFPS              FOR ZERO                          58230021
         SR    R12,R12            CLEAR REGISTER 12                     58236021
         IC    R12,LITVAL+NX1     LOAD LEFT SCALE FACTOR                58242021
         LA    R12,LITVAL+NX3(R12)   POINT CHAR AFTER DEC POINT         58248021
         LR    R3,R12             REG3 ALSO POINT TO CHAR RIGHT         58254021
NUM240   TM    DX0(R12),XX0F                                            58260021
       BC      ZERO,NUM250         BRANCH                               58266021
         MVI   DX0(R12),XXF0                                            58272021
         BAL   R4,VERROR           CALL ERR RTN                         58278021
         DC    X'1086'             134                                  58284021
NUM250   A     R12,ONE                                                  58290021
         BCT   R2,NUM240           BRANCH                               58296021
         SR    R1,R1              CLEAR REG1                            58302021
         IC    R1,LITVAL+NX2      NO OF RIGHT DIGITS FROM DEC POINT     58308021
         BCTR  R1,R0              DECREMENT ONE                         58314021
         LA    R2,DX0(R1,R3)      REGS POINT LAST CHAR OF INIT.         58320021
         MVC   SAVZONE(LX1),DX0(R2)    SAVE LAST CHAR OF INIT.          58326021
         OI    DX0(R2),XXF0       MAKE LAST CHAR TO -FN-                58332021
         IC    R1,LITVAL+NX2                                            58338021
         SR    R2,R2              CLEAR REG2                            58344021
         IC    R2,NOOFPS          LOAD NO OF P'S TO REG2                58350021
         SR    R1,R2              NO OF DIGIT TO BE MOVED               58356021
         LTR   R1,R1              TEST FOR POSITIVE                     58362021
         BH    MOVESIG            IF POSITIVE,  BRANCH TO MOVESIG       58368021
         SR    R1,R1              RESET REG1                            58374021
         LA    R12,LITVAL+NX3                                           58380021
         B     INSZEROS           BRANCG TO INSZEROS                    58386021
*                                                                       58392021
MOVESIG  DS    0H                                                       58398021
         BCTR  R1,R0              DECREMENT BY ONE                      58404021
         LA    R2,LITVAL+NX3(R2)  NEXT CHAR OF LAST P                   58410021
         EX    R1,ADJMOVE         MOVE NO P'S TO LEFT                   58416021
         LA    R12,NX1(R1,R2)                                           58422021
INSZEROS DS    0H                                                       58428021
         SR    R2,R2                                                    58434021
         IC    R2,LITVAL+NX2      INSERT NO OF LEFT CONSTANT            58440021
         BCTR  R2,R0              DECREMENT ONE                         58446021
         LA    R3,DX0(R2,R3)      POINT LAST POSITION OF 9              58452021
         LA    R2,NX1             INSERT VALUE 1 TO REG2                58458021
         MVI   DX0(R12),XXF0      INSERT ZERO                           58464021
         BXLE  R12,R2,*-NX4       REPEAT UNTIL                          58470021
         IC    R2,VILGN+NX1                                             58476021
         SR    R1,R1                                                    58482021
         IC    R1,NOOFPS                                                58488021
         LA    R2,DX0(R1,R2)                                            58494021
         LA    R1,LITVAL+NX3                                            58500021
         LA    R2,DX0(R1,R2)                                            58506021
         BCTR  R2,R0              DECREMENT ONE                         58512021
         MVZ   DX0(LX1,R2),SAVZONE                                      58518021
         MVZ   DX0(LX1,R3),SAVZONE     INSERT SIGN                      58524021
NUM255   LA    R2,LITVAL+NX3                                            58530021
         SR    R1,R1                                                    58536021
         IC    R1,NOOFPS                                                58542021
         SR    R3,R3                                                    58548021
         IC    R3,VILGN+NX1                                             58554021
         AR    R1,R3               BRANCH                               58560021
         ST    R1,MTEMP1                                                58566021
         LA    R3,LITVAL+NX3                                            58572021
         TM    VILGN,XX80                                               58578021
         BC    ONES,NUM259         BRANCH                               58584021
         CLI   VILGN,XX00                                               58590021
         BC    EQ,NUM258           CHECK WHAT FORMAT OUTPUT WANTED      58596021
         CLI   NOOFPS,XX00           SCALE IS GREATER THAN 0.           58602021
         BC    EQ,NUM258           CHECK WHAT FORMAT OUTPUT WANTED      58608021
NUM256   SR    R2,R2                                                    58614021
         IC    R2,NOOFPS                                                58620021
         AR    R3,R2                                                    58626021
         LR    R2,R3                                                    58632021
         SR    R1,R1                                                    58638021
         IC    R1,VILGN+NX1                                             58644021
         ST    R1,MTEMP1                                                58650021
         BC    UNCOND,NUM258       CHECK WHAT FORMAT OUTPUT WANTED      58656021
NUM259   CLI   NOOFPS,XX00                                              58662021
         BC    EQ,NUM258           SET UP THE CORRECT SIGN FOR OUTP     58668021
         SR    R2,R2                                                    58674021
         IC    R2,VILGN+NX1                                             58680021
         ST    R2,MTEMP1                                                58686021
         AR    R2,R3                                                    58692021
         S     R2,ONE                                                   58698021
         MVZ   DX0(LX1,R2),NMSIGN                                       58704021
         LR    R2,R3                                                    58710021
NUM258   CL    R5,EIGHT                                                 58716021
         BC    EQ,NUM090           EXTERNAL DECIMAL OUTPUT.             58722021
         CL    R5,ELEVEN                                                58728021
         BC    EQ,NUM175           BINARY OUTPUT.                       58734021
         CL    R5,TWELVE                                                58740021
         BC    EQ,NUM110           INTERNAL DECIMAL OUTPUT.             58746021
         BC    UNCOND,NUM080       CALL ERR RTN                         58752021
*                                                                       58758021
NUM260   EQU   *                                                        58764021
         SR    R1,R1                                                    58770021
         SR    R2,R2                                                    58776021
         IC    R2,VILGN+NX1         WHEN DEC DIGIT LGN IS GREATER TH    58782021
         IC    R1,VILGN               SCALE, THEN INTEGER DIGITS AR     58788021
         SR    R2,R1                  PRESENT IN VALUE                  58794021
         ST    R2,MTEMP                                                 58800021
         CLC   MTEMP+NX3(LX1),LITVAL+NX1                                58806021
         BC    EQ,NUM255           BRANCH                               58812021
         BC    HI,NUM045              LEADING 0 TO BE ADDED.            58818021
         LTR   R2,R2                    IS REG 2 ZERO             45674 58824021
         BC    ZERO,NUM265                YES, THEN ERROR         45674 58830021
         LA    R6,NUM255                                                58836021
         BAL   R4,SETE             SEE IF EXTRA DIGITS=0                58842021
NUM265   EQU   *                                                  45674 58848021
         BAL   R4,VERROR           CALL ERR RTN                         58854021
         DC    X'1081'             129                                  58860021
         LA    R12,LITBUF+NX1                                           58866021
         BC    UNCOND,FIZ030          VALUE TOO BIG, CHANGED TO 0.      58872021
ADJMOVE  MVC   DX0(0,R2),DX0(R12)                                       58878021
*                                                                       58884021
*  SCALE IS LESS THAN ZERO. ABSOLUTE VALUE OF SCALE IS THE NUMBER O     58890021
*    P'S TO THE LEFT OF THE DECIMAL POINT.  PICTURE OF FORM 99PV.       58896021
*                                                                       58902021
NUM300   CLI   LITVAL+NX2,XX00      ERROR IF THERE ARE DECIMAL DIGIT    58908021
         BC    EQ,NUM310              IN VALUE, CHANGE VALUE TO 0.      58914021
         LA    R6,NUM310                                                58920021
         BAL   R4,SETA             SEE IF DECIMAL DIGITS=0              58926021
         BAL   R4,VERROR           CALL ERR RTN                         58932021
         DC    X'1081'             129                                  58938021
         BC    UNCOND,FIZ030       BRANCH                               58944021
NUM310   CLI   NOOFPS,XX00                                              58950021
         BC    EQ,NUM340           BRANCH                               58956021
         LA    R12,LITVAL          P'S ARE PRESENT IN PICTURE,CHECK     58962021
         SR    R2,R2                  THE CORRESPONDING DIGITS FOR      58968021
         IC    R2,LITVAL+NX1            CNT OF CHARS IN PIC       40336 58974021
NM310    CLI   DX3(R12),XXF0            IS VALUE 0 SPEC'D         40336 58980021
         BNE   NUM315                     NO, BR                  40336 58986021
         LA    R12,DX1(R12)             YES, PT TO NXT CHAR       40336 58992021
         BCT   R2,NM310                 CHK NXT UNTIL FINISHED    40336 58998021
         LA    R12,LITVAL                 RESTORE ADDR            40336 59004021
         IC    R2,NOOFPS                 NO. OF P'S IN PIC        40336 59010021
         A     R2,THREE                   ALTER VALUE             40336 59016021
         STC   R2,DX0(R12)                  CLAUSE TEXT           40336 59022021
         S     R2,TWO                           TO INCLUDE        40336 59028021
         STC   R2,DX1(R12)                    F0'S FOR            40336 59034021
         SR    R2,R2                            EACH              40336 59040021
         IC    R2,NOOFPS                     P IN PICTURE         40336 59046021
NUM310A  MVI   DX4(R12),XXF0             WHEN VALUE IS 0          40336 59052021
         LA    R12,DX1(R12)                      IS               40336 59058021
         BCT   R2,NUM310A                   SPECIFIED             40336 59064021
         B     NUM340                   BR AROUND CHK FOR F0'S    40336 59070021
NUM315   EQU   *                                                  40336 59076021
         IC    R2,LITVAL                                                59082021
         AR    R12,R2                                                   59088021
         IC    R2,NOOFPS                                                59094021
         LA    R12,DX1(R12)                                             59100021
         SR    R12,R2                                                   59106021
NUM320   TM    DX0(R12),XX0F                                            59112021
       BC      ZERO,NUM330         BRANCH                               59118021
         MVI   DX0(R12),XXF0                                            59124021
         BAL   R4,VERROR           CALL ERR RTN                         59130021
         DC    X'1086'             134                                  59136021
NUM330   A     R12,ONE                                                  59142021
         BCT   R2,NUM320           BRANCH                               59148021
NUM340   SR    R2,R2                                                    59154021
         IC    R2,NOOFPS           P'S + DEC DIGIT LGN = TOTAL NO O     59160021
         SR    R1,R1                  INTEGERS IN PICTURE.              59166021
         IC    R1,VILGN+NX1                                             59172021
         AR    R2,R1                                                    59178021
         STC   R2,MTEMP                                                 59184021
         CLC   MTEMP(LX1),LITVAL+NX1                                    59190021
         BC    EQ,NUM255           BRANCH                               59196021
         BC    UNCOND,NUM045       ADD LEADING 0 ON TO LITERAL.         59202021
*                                                                       59208021
*                                                                       59214021
*  NO CHECKING IS DONE FOR CONDITION-NAME LITERALS. LITERAL IS CONV     59220021
*    ED FROM EXT. DECIMAL FORM TO INTERNAL DECIMAL FORM PUT INTO        59226021
*    THE DICTIONARY IN IC-TEXT FORMAT.                                  59232021
*                                                                       59238021
NUM400   LA    R3,LITVAL+NX3                                            59244021
         SR    R1,R1                                                    59250021
         IC    R1,LITVAL                                                59256021
         S     R1,TWO              LENGTH OF LITERAL TO BE CONVERTE     59262021
         BAL   R14,EDID            CONVERT EXT DECIMAL TO INT DEC       59268021
         MVI   COUNT,XX0C                                               59274021
         L     R1,OUTPUT                                                59280021
         A     R1,ELEVEN                                                59286021
         STC   R1,ATRCNT                                                59292021
         MVC   ATTRIB+NX1(LX4),PDICPT                                   59298021
         MVI   ATTRIB+NX5,XX00                                          59304021
         L     R1,OUTPUT                                                59310021
         TM    VALTSW,SWON         VALUE IS SERIES                      59316021
         BZ    NUM440              NO                                   59322021
         TM    CHKLTH,SWON         NEED TO CHECK LENGTH                 59328021
         BZ    NUM440              NO                                   59334021
         XC    CHKLTH,CHKLTH       TURN OFF SW                          59340021
         CLI   VILGN,XX75           FIGCON                              59346021
         BNE   NUM420              NO                                   59352021
         CLI   NMSIGN,XXD0          YES, NEGATIVE                       59358021
         BE    NUM460              YES, ERROR                           59364021
         B     NUM440              NO NEED TO CHECK                     59370021
NUM420   CLI   ATTRIB+NX7,XX32     IS FIRST VALUE A NUMBER        05824 59376021
         BNE   NUM000              NO, GO ISSUE DIAGNOSTIC        05824 59382021
         S     R1,ONE                                             05824 59388021
         STC   R1,CONDLT                                                59394021
         IC    R1,ATTRIB+NX8        LENGTH OF FIRST                     59400021
         S     R1,THREE            MINUS FIXED PORTION                  59406021
         STC   R1,CONDL1                                                59412021
         MVO   CONDLN(LX2),CONDL1(LX1) LENGTH OF BOTH IN ONE BYTE       59418021
         IC    R1,CONDLT                                                59424021
         EX    R1,COMVAL           COMPARE FIELDS                       59430021
         BNL   NUM460              ERROR, LND HIGH                      59436021
         L     R1,OUTPUT                                                59442021
NUM440   A     R1,FOUR             FIXED PORTION                        59448021
         STC   R1,ATTRIB+NX6                                            59454021
         MVI   ATTRIB+NX7,XX32                                          59460021
         S     R1,TWO                                                   59466021
         STC   R1,ATTRIB+NX8                                            59472021
         MVC   ATTRIB+NX9(LX2),LITVAL+NX1 DEC AND INTEGER COUNT.        59478021
         L     R1,OUTPUT                                                59484021
         S     R1,ONE                                                   59490021
         EX    R1,NUM450                                                59496021
         ST    R15,MTEMP1                                               59502021
         TM    VALTSW,SWON         IS THIS VALUE THRU                   59508021
         BO    NUM600              BRANCH                               59514021
         TM    GRP88,SWON          88 UNDER GROUP                       59520021
         BO    NUM600              YES                                  59526021
         L     R15,AENTNM          ENTER COND-NAME INTO DICTIONARY      59532021
         MVI   CICODE,XX00                                              59538021
         LA    R1,CIPARM                                                59544021
         BALR  R14,R15             GO ENTER COND-NAME IN DICT           59550021
         ST    R1,DICTPT           SAVE DICTIONARY PTR OF 88            59556021
         ST    R1,REALPTR                                               59562021
         L     R15,MTEMP1                                               59568021
NUM500 L     R14,RS14A                                                  59574021
         BCR   UNCOND,R14          RETURN                               59580021
NUM460   BAL   R4,VERROR           CALL ERR RTN                         59586021
         DC    X'10C1'             MSG 193                              59592021
         L     R1,OUTPUT                                                59598021
         B     NUM440              CONTINUE PROCESSING                  59604021
COMVAL   CP    ATTRIB+NX11(LX0),WKAREA(LX0)                             59610021
NUM075   MVC   DX1(LX0,R12),DX0(R12)                                    59616021
NUM076   MVC   DX0(LX0,R12),LITVAL+NX3 MOVE IN THE LITERAL.             59622021
NUM077   MVC   DX0(LX0,R12),DX0(R3)                                     59628021
NUM078   MVC   LITVAL+NX3(LX0),LITBUF+NX1                               59634021
NUM450   MVC   ATTRIB+NX11(LX0),WKAREA                                  59640021
*                                                                       59646021
NUM600   SR    R0,R0                                                    59652021
         L     R1,PVALTR                                                59658021
         IC    R0,ATTRIB+NX6        COUNT OF ENTRY                      59664021
         LR    R4,R0                                                    59670021
         A     R0,ONE              CONUT DOESN'T INCLUDE ITSELF         59676021
         TM    VALTSW,VALTHR       IS IT VALUE THRU                     59682021
         BZ    NUM650              NO                                   59688021
         OI    CHKLTH,SWON         TURN SW ON                           59694021
         OI    ATTRIB+NX6,XX80      YES, SET BIT ON                     59700021
NUM650   L     R15,BINSRT                                               59706021
         BALR  R14,R15             GET ADD TO INSERT                    59712021
         L     R15,MTEMP1                                               59718021
         EX    R4,NUM900                                                59724021
         TM    GRP88,SWON          88 UNDER GROUP                       59730021
         BZ    NUM660              NO                                   59736021
         STH   R3,VALDSP           CHANGE DISPL IN TABLE                59742021
NUM660   L     R14,AVLT20                                               59748021
         BR    R14                 RETURN TO CHECK NEXT                 59754021
NUM900   MVC   DX0(LX0,R2),ATTRIB+NX6                                   59760021
SETA     SR    R1,R1               PUT NUMBER OF DIGITS TO BE           59766021
         IC    R1,LITVAL+NX2             CHECKED IN R1                  59772021
         SR    R8,R8                                                    59778021
SETC     IC    R8,LITVAL           GET ADDRESS OF                       59784021
         LA    R7,LITVAL+NX1             FIRST BYTE                     59790021
         AR    R7,R8                         TO BE CHECKED              59796021
         SR    R7,R1                              IN R7                 59802021
CHECKA   STC   R1,NUMSAV+NX1        NUMBER OF DIGITS CHECKED            59808021
CHECK1   CLI   DX0(R7),XXF0         DIGIT = 0                           59814021
         BE    CHECK2              YES                                  59820021
         NI    NUMSAV,XX00          NO-MAKE SURE SWITCH IS OFF          59826021
         BR    R4                  RETURN-ERROR CONDITION               59832021
CHECK2   LA    R7,DX1(R7)           UPDATE POINTER TO NEXT DIGIT        59838021
         BCT   R1,CHECK1           MORE TO CHECK? YES, BRANCH           59844021
         SR    R8,R8                                                    59850021
         IC    R8,NUMSAV+NX1        NO-NUMBER OF DIGITS CHECKED IN R8   59856021
         IC    R1,LITVAL           PUT CORRECT NUMBER                   59862021
         SR    R1,R8                    OF DIGITS IN                    59868021
         STC   R1,LITVAL                     LITVAL FIELD               59874021
         TM    NUMSAV,XX80          SWITCH ON, I.E., MUST WE MOVE?      59880021
         BO    MOVE                YES                                  59886021
         IC    R1,LITVAL+NX2        UPDATE # OF DECIMALS FIELD          59892021
         SR    R1,R8                    IN LITVAL                       59898021
         STC   R1,LITVAL+NX2                                            59904021
         BR    R6                  RETURN                               59910021
MOVE     NI    NUMSAV,XX00          TURN SWITCH OFF                     59916021
         IC    R1,LITVAL+NX1        UPDATE # OF INTEGERS FIELD          59922021
         SR    R1,R8                    IN LITVAL                       59928021
         STC   R1,LITVAL+NX1                                            59934021
         IC    R8,LITVAL                                                59940021
         BCTR  R8,R0               FIX R8 TO DO MOVE                    59946021
         EX    R8,DOMOVE           MOVE EXTRA ZERORS OUT                59952021
         BR    R6                  RETURN                               59958021
SETB     SR    R1,R1                                                    59964021
         SR    R8,R8                                                    59970021
         IC    R8,VILGN                                                 59976021
         IC    R1,LITVAL+NX2        NUMBER OF BYTES TO BE               59982021
         SR    R1,R8                    CHECKED IN R1                   59988021
         B     SETC                GO SET UP R7                         59994021
SETE     SR    R1,R1                                                    60000021
         IC    R1,LITVAL+NX1                                            60006021
SETD     SR    R1,R2               NUMBER OF BYTES TO CHECK IN R1       60012021
         LA    R7,LITVAL+NX3        ADDRESS OF FIRST BYTE IN R7         60018021
         OI    NUMSAV,XX80          SET SWITCH                          60024021
         B     CHECKA              GO CHECK NUMBER OF DIGITS            60030021
DOMOVE   MVC   LITVAL+NX3(LX0),DX0(R7) MOVE DIGITS TO LEFT              60036021
         EJECT                                                          60042021
*=2      CONVERT EXTERNAL DECIMAL TO INT. DECIMAL (EDID)                60048021
*                                                                       60054021
*  THIS ROUTINE CONVERTS ANY EXTERNAL DECIMAL NUMBER (UP TO 30 DIGI     60060021
*    AND A SIGN) TO INTERNAL DECIMAL FORMAT.                            60066021
*    INPUT : R1 HAS ED LENGTH, R3 HAS STARTING ADDRESS OF ED.           60072021
*    OUTPUT: WKAREA HAS CONVERTED DATA.                                 60078021
*             'OUTPUT' HAS OUTPUT LENGTH IN BYTES.                      60084021
*                                                                       60090021
EDID     CL    R1,CON16            ED LENGTH LQ 16 BYTES.               60096021
         BC    HI,EDI010           ED LENGTH > 16 BYTES                 60102021
         ST    R1,INPUT                                                 60108021
         SRL   R1,DX1                                                   60114021
         A     R1,ONE                                                   60120021
         ST    R1,OUTPUT                                                60126021
         S     R1,ONE                                                   60132021
         SLL   R1,DX4                                                   60138021
         L     R2,INPUT                                                 60144021
         S     R2,ONE                                                   60150021
         OR    R2,R1                                                    60156021
         EX    R2,EDI200                                                60162021
         BCR   UNCOND,R14          BRANCH                               60168021
*                                                                       60174021
EDI010   ST    R1,INPUT            ED LENGTH GREATER THAN 16 BYTES.     60180021
         ST    R4,RS4                                                   60186021
         S     R1,TWELVE                                                60192021
         SRL   R1,DX1                                                   60198021
       BCTR  R1,R0                 BRANCH                               60204021
         SLL   R1,DX4                                                   60210021
         L     R2,INPUT                                                 60216021
         S     R2,CON15                                                 60222021
         OR    R2,R1                                                    60228021
         EX    R2,EDI200                                                60234021
         LA    R4,WKAREA                                                60240021
         L     R2,INPUT                                                 60246021
         S     R2,CON14                                                 60252021
         SRL   R2,DX1                                                   60258021
         STC   R2,EDI300+NX3                                            60264021
         L     R2,INPUT                                                 60270021
         S     R2,CON15                                                 60276021
         STC   R2,EDI300+NX5                                            60282021
         EX    R0,EDI300                                                60288021
         L     R2,INPUT                                                 60294021
         SRL   R2,DX1                                                   60300021
         A     R2,ONE                                                   60306021
         ST    R2,OUTPUT                                                60312021
         L     R4,RS4                                                   60318021
         BCR   UNCOND,R14          BRANCH                               60324021
*                                                                       60330021
EDI200   PACK  WKAREA(LX0),DX0(LX0,R3)                                  60336021
EDI300   PACK  DX0(LX8,R4),DX0(LX15,R3)                                 60342021
AIDBI    DC    A(IDBI)                  ADDR OF BIN CONV RTN            60348021
         EJECT                                                          60354021
         EJECT                                                          60360021
****************************************************************        60366021
*                                                                       60372021
*                                                                       60378021
       USING   *,R15                                                    60384021
XREFF  ST    R14,XREFSV                SAVE RETURN ADDRESS              60390021
       MVI   LITBUF,XRFHDR             ENTER HEADER                     60396021
         MVC   LITBUF+NX1(LX2),CARDNO          CARDNO                   60402021
         MVC   LITBUF+NX3(LX3),DICTPT+NX1      DICT PTR                 60408021
       SR    R3,R3                                                      60414021
         IC    R3,DX0(R1)               BCD NAME COUNT                  60420021
       EX    R3,XRFMOV                 ADD NAME                         60426021
         LA    R3,DX7(R3)               UPDATE COUNT                    60432021
       ST    R3,NMPUT                                                   60438021
       LA    R3,LITBUF                                                  60444021
       ST    R3,ADDRES                                                  60450021
       L     R15,APUTOT                                                 60456021
       BALR  R14,R15               PUT OUT A-TEXT                       60462021
       L     R14,XREFSV                                                 60468021
       BR    R14                       RETURN                           60474021
XRFMOV   MVC   LITBUF+NX6(LX1),DX0(R1)                                  60480021
       EJECT                                                            60486021
AFIGZERO DC    A(FIGZERO)               ADDR OF FIGZERO           42093 60492021
         EJECT                                                    42093 60498021
IKF212   CSECT                                                    42093 60504021
*=2   INTRA RECORD SLACK BYTES IRSLBT)-- NO OCCURS CLAUSE.              60510021
*                                                                       60516021
*  THIS ROUTINE EXAMINES THE CONTENT OF THE LOCATION COUNTER BEFORE     60522021
*    ASSIGNING ADDRESSING PARAMETERS TO ANY COMP,COMP-1 OR COMP-2       60528021
*    FIELD, AND DECIDE IF SLACK BYTES ARE REQUIRED. SLACK BYTES MAY     60534021
*    BE ADDED TO THE RECORD IN ORDER TO INSURE PROPER ALIGNMENT OF      60540021
*    THE COMPUTATIONAL DATA ITEMS.                                      60546021
*    IF PCI IS AN ELEMENTARY ITEM, SLACK BYTES ARE ADDED TO THE PCI     60552021
*    ( PCI'S LENGTH IS UPDATED TO INCLUDE THE SLACK BYTES )             60558021
*        IF PCI IS A GROUP ITEM, SLACK BYTES ARE ADDED TO ALL THE N     60564021
*    ZERO-LENGTH GLS ENTRIES PRECEDING CI IN THE GROUP.                 60570021
*                                                                       60576021
       USING *,R15                                                      60582021
*                                                                       60588021
IRSLBT   ST    R14,RS14B                                                60594021
         CLI   MCI,XX05             ARE WE IN LINKAGE SECTION           60600021
         BE    IRSWAP              USE APAF IF YES                      60606021
         MVC   TOTLGN(LX4),LOCCTR                                       60612021
         TM    APAF,XX10            IF ITEM HAS LINKAGE BL ( LINK. S    60618021
         BC    NOTONE,IRS00A         OR SD ) ALIGN FROM D-FIELD OF      60624021
IRSWAP   EQU   *                                                        60630021
         MVC   TOTLGN+NX2(LX2),APAF                                     60636021
         NC    TOTLGN(LX4),MK2132                                       60642021
IRS00A   CLI   ALIGN,XX00           WAS THERE ANY ALIGNMENT ASSIGNED    60648021
       BC    EQ,IRS000                  NO    / AN OCCURS GROUP         60654021
IRS00B   SR    R2,R2               CLEAR OUT R2                    9914 60660021
         IC    R2,ALIGN            GET MBS NO FOR OCCURRING GROUPS 9914 60666021
*                                                                  9914 60672021
*                                                                  9914 60678021
IRS000   SR    R3,R3                                                    60684021
         IC    R3,MINCOD                                                60690021
         SRL   R3,DX4                      COMP  COMP-1  OR COMP-2      60696021
         CL    R3,SEVEN            USAGE INDEX                    45694 60702021
         BE    IRS004              USAGE INDEX AND SYNC OPTION    45694 60708021
       CL    R3,TEN                                                     60714021
       BC    NOTEQ,IRS001                 COMPUTATIONAL                 60720021
         TM    VILGN+NX1,XX01                                           60726021
       BC    ONES,IRS008                 COMP-2  DW BOUNDARY            60732021
       BC    UNCOND,IRS004              COMP-1  FW BOUNDARY             60738021
IRS001   CLI   CILGN+NX1,XX04            CHECK LENGTH                   60744021
         BC    NOTLO,IRS004        IF LGN IS 4 OR MORE FULL WORD NE     60750021
*                                                                       60756021
*  ROUTINE SETS UP BOUNDARY REQUIREMENTS FOR OCCURRING GROUPS      9914 60762021
*   AND CALCULATES CORRECT SLACK BYTES TO BE ADDED FOR CI          9914 60768021
*                                                                       60774021
IRS002   LA    R3,DX2         SET BOUND AS HALFWORD IN R3.          991 60780021
         BC    UNCOND,IRS010  GO TO COMMON RTN.                    9914 60786021
IRS004   LA    R3,DX4         SET BOUND AS FULLWORD IN R3.          991 60792021
         BC    UNCOND,IRS010       GO TO COMMON RTN                9914 60798021
IRS008   LA    R3,DX8         SET  TO  DOUBLEWORD  REQUIREMENT.     991 60804021
         BC    UNCOND,IRS010       GO TO COMMON RTN                9914 60810021
*                                                                  9914 60816021
*    THE FOLLOW THREE INSTRUCTIONS ARE EXECUTED BY THE IRS010 RTN  9914 60822021
*    USING  R3  AS THE OR REGISTER  FOR  THE SECOND BYTE.          9914 60828021
*                                                                  9914 60834021
EXCLI    CLI   DX0(R4),XX00   COMPARE CELL TO BOUND IN R3           991 60840021
EXMVI    MVI   DX0(R4),XX00   MOVE NEW BOUND TO CELL IN ALIGN       991 60846021
EXTM     TM    TOTLGN+NX3,XX00 TEST MASK BOUND-1  ON FIELD LENGTH   991 60852021
*                                                                  9914 60858021
*        COMMON BOUNDARY REQUIREMENT RTN.ADJUSTS CELLS IN ALIGN    9914 60864021
*                                                                  9914 60870021
IRS010   TM    ALIGN,XXFF     ARE THERE ANY OCCURS GROUPS.          991 60876021
         BC    ZERO,IRS012   NO,  ALIGN ELEMENTARY FIEM            9914 60882021
         LA    R5,ALIGN      YES, LOAD ADDR OF ALIGN TABLE TO R5.  9914 60888021
IRS011   LA    R4,DX0(R5,R2)  LOAD TO POINTER ALIGNS ADDR + INCR    991 60894021
         EX    R3,EXCLI      TO CELL TO BOUND COMPARISON           9914 60900021
         BC    NOTLO,IRS012  SCAN FINISHED INCLUSIVE GROUP HAS BOUND.   60906021
         EX    R3,EXMVI      MOVE IN NEW BOUNDARY                  9914 60912021
         BCT   R2,IRS011     SUBTRACT ONE FROM POINTER INCREMENT   9914 60918021
*                            AND DO AGAIN. FALL THRU TO IRS012     9914 60924021
*                            WHEN R2 = 0.                          9914 60930021
*                                                                  9914 60936021
*        RTN TO CALCULATE SLACK BYTES NEEDED, TO BE PUT IN R6.     9914 60942021
*                                                                  9914 60948021
IRS012   LR    R6,R3         LOAD BOUND TO R6.                     9914 60954021
         BCTR  R3,R0          SUBTRACT 1 FROM R3                    991 60960021
         EX    R3,EXTM       TEST IF ALREADY ALIGNED.              9914 60966021
         BCR   ZERO,R14      YES,EXIT FROM RTN.                    9914 60972021
         IC    R7,TOTLGN+NX3  GET LOW ORDER BYTE OF DISP.           991 60978021
         NR    R7,R3         AND OUT UNNEEDED BITS.                9914 60984021
         SR    R6,R7         SUBTRACT FROM R6 TO GIVE SLACK BYTES  9914 60990021
*                                                                  9914 60996021
*                                                                       61002021
*  R6 HAS THE NO. OF SLACK BYTES TO BE ADDED.                           61008021
*  CHECK IF ITEM TO BE ALIGNED INVOLVED IN REDEFINES.              0026 61014021
*       ERROR IF  IT IS.                                           0026 61020021
         TM    RDFSW,SWON          FIRST UNDER REDEFINES                61026021
         BC    ZERO,IRS020         NO, PROCEED TO ALIGN            0026 61032021
          L    R15,AERROR                                          0026 61038021
         BALR   R4,R15         GO TO ERROR RTN                     0026 61044021
         DC    X'10C9'             MSG 201                         0026 61050021
         NI    SYNCHR,XXBF          TURN OFF BIT                    002 61056021
         L     R14,RS14B                                           0026 61062021
         BR    R14                 RETURN                          0026 61068021
IRS020   L     R9,GPARAM                                                61074021
         L     R10,DX0(R9)                                              61080021
         L     R9,DX0(R10)                                              61086021
         N     R9,MK0932                                                61092021
         AH    R9,DX4(R10)                                              61098021
         S     R9,CON24            R9 POINTS TO LAST ENTRY ON GLS.      61104021
         SR    R7,R7                                                    61110021
         IC    R7,PMINCD                                                61116021
         SRL   R7,DX4                                                   61122021
         CL    R7,ONE              IS PCI A GROUP ITEM.                 61128021
         BC    EQ,IRS040           GO TO COMMON RTN                     61134021
         CL    R7,FOUR                NO.                               61140021
         BC    EQ,IRS040           GO TO COMMON RTN                     61146021
*                                                                       61152021
*  PCI IS AN ELEMENTARY ITEM, ADD SLACK BYTES TO LENGTH OF LGS, ALS     61158021
*    UPDATE THE APAF AND LOCATION COUNTER.                              61164021
*                                                                       61170021
IRS030   TM    DX1(R9),XX40         IS LGS A VARIABLE LGN GROUP         61176021
         BC    ONES,IRS060         YES, BRANCH                          61182021
         L     R5,DX0(R9)           NO                                  61188021
         N     R5,MK1632                                                61194021
         AR    R5,R6                                                    61200021
         ST    R5,MTEMP            ADD NO. OF SLACK BYTES TO LGS,       61206021
         MVC   DX2(LX2,R9),MTEMP+NX2                                    61212021
         TM    MTEMP+NX1,XX01                                           61218021
         BC    ZERO,IRS050         GO ADD C(R6) TO D OF APAF            61224021
         OI    DX1(R9),XX01                                             61230021
         BC    UNCOND,IRS050       GO ADD C(R6) TO D OF APAF            61236021
*                                                                       61242021
*  PCI IS AGROUP ITEM, ADD SLACK BYTES TO THE LAST NON-ZERO LENGTH      61248021
*    ENTRY IN GLS, UPDATE THE ADDRESSING PARAMETER OF SUCCEDING GLS     61254021
*    ENTRIES, AND ALSO UPDATE THE APAF AND LOCATION COUNTER.            61260021
*                                                                       61266021
IRS040   L     R4,DX0(R9)           DOES THIS LGS HAVE 0 LENGTH.        61272021
         N     R4,MK1632                                                61278021
         CL    R4,ZEROS                                                 61284021
         BC    HI,IRS030              NO.                               61290021
         CLI   DX20(R9),XX01        HAS END OF GROUP BEEN REACHED,      61296021
         BC    NOTEQ,IRS045           YES,ADD TO THIS 01 LEVEL ENTR     61302021
         L     R5,DX0(R9)                                               61308021
         N     R5,MK1632                                                61314021
         AR    R5,R6                                                    61320021
         ST    R5,MTEMP                                                 61326021
         MVC   DX2(LX2,R9),MTEMP+NX2                                    61332021
         TM    MTEMP+NX1,XX01                                           61338021
         BC    ZERO,IRS045         SKIP NEXT INSTRUCTION                61344021
         OI    DX1(R9),XX01                                             61350021
IRS045   L     R3,DX20(R9)             NO, ADD THE NO. OF SLACK BYTE    61356021
         SRL   R3,DX8                    TO ADDRESSING PARAMETER OF     61362021
         N     R3,MK2132                THIS LGS.                       61368021
         AR    R3,R6                                                    61374021
         STC   R3,DX22(R9)                                              61380021
         NI    DX21(R9),XXF0                                            61386021
         ST    R3,MTEMP                                                 61392021
         NC    MTEMP(LX4),MK2132        OFF OVFLOW BIT IF 4096    48449 61398021
         OC    DX21(LX1,R9),MTEMP+NX2                                   61404021
*                                                                       61410021
         ST    R3,MTEMP                 SET UP DISPLACEMENT       48449 61416021
         C     R3,CO4096                IS DISP GR OR EQ TO 4096  48449 61422021
         BL    IRS047                       NO, BR                48449 61428021
         SR    R3,R3                    YES, MUST UPDATE BL       48449 61434021
         IC    R3,DX23(R9)              3RD BYTE OF APAF(BL NO)   48449 61440021
         LA    R3,DX1(R3)               UPDATE BL NO              48449 61446021
         STC   R3,DX23(R9)              ST UPDATED BL IN GLSTK    48449 61452021
IRS047   EQU   *                                                  48449 61458021
         S     R9,CON24                                                 61464021
         BC    UNCOND,IRS040          UPDATE LGS POINTER.               61470021
*                                                                       61476021
IRS050   L     R5,APAF-NX1          ADD C(R6) TO D OF APAF              61482021
         SRL   R5,DX8(R0)                                               61488021
         N     R5,MK2132                                                61494021
         AR    R5,R6                                                    61500021
         STC   R5,APAF+NX1                                              61506021
         ST    R5,MTEMP                                                 61512021
         MVN   APAF(LX1),MTEMP+NX2                                      61518021
*                                                                       61524021
         L     R5,DISP             ADD C(R6) TO DISP OF APAF.           61530021
         AR    R5,R6                                                    61536021
         ST    R5,DISP             IF DISP IS GREATER THAN 4096,        61542021
         L     R14,RS14B                                                61548021
         CLI   MCI,XX05                  EXIT IF IN LINKAGE SECT        61554021
         BCR   EQ,R14              RETURN                               61560021
         L     R5,LOCCTR                                                61566021
         AR    R5,R6                                                    61572021
         ST    R5,LOCCTR         )                                      61578021
         L     R14,RS14B                                                61584021
         BCR   UNCOND,R14             EXIT.                             61590021
IRS060   L     R5,DX16(R9)          ADD SLACK BYTES TO                  61596021
         AR    R5,R6                 MAX LGN FIELD                      61602021
         ST    R5,DX16(R9)              OF LGS                          61608021
         MVC   QTEXT(LX8),INITVB                                        61614021
         MVI   QTEXT+NX1,STEPVB     SET UP STEP VERB                    61620021
         MVC   QTEXT+NX4(LX2),DX2(R9)   WITH VLC OF LGS                 61626021
         STC   R6,QTEXT+NX8             AND LITERAL= = OF SLACK BYTE    61632021
         LA    R2,QTEXT                                                 61638021
         LA    R3,DX9                                                   61644021
         L     R1,COSADR                                                61650021
         BALR  R0,R1               PUT OUT STEP VERB Q-TEXT ON FILE     61656021
         DC    X'12'                                                    61662021
         BC    UNCOND,IRS050       GO ADD C(R6) TO D OF APAF            61668021
         EJECT                                                          61674021
*                                                                       61680021
*=2  TASSR ROUTINE.                                                     61686021
*  THIS ROUTINE --TASSR-- DOES BOUNDARY ALIGNMENT FOR GROUP ITEMS W     61692021
*    OCCURS CLAUSE.  SLACK-BYTES ARE ADDED AT THE END OF THE GROUP      61698021
*    ITEM CONTAINING THE OCCURS CLAUSE.                                 61704021
*                                                                       61710021
         USING *,R15                                                    61716021
*                                                                       61722021
TASSR    EQU   *                                                        61728021
         SR    R1,R1                                                    61734021
         SR    R3,R3                                                    61740021
         LA    R2,ALIGN            LOOK UP IN THE TABLE TO SEE IF       61746021
         IC    R3,ALIGN               ANY ALIGNMENT IS NEEDED.          61752021
         AR    R2,R3                                                    61758021
         CLI   DX0(R2),XX00                                             61764021
         BC    HI,TAS010              ALIGN.                            61770021
         BC    UNCOND,TAS110          NO ALIGNMENT NEEDED.              61776021
*                                                                       61782021
TAS010   L     R9,GPARAM           GET THE ADDRESS OF THE GLS STACK     61788021
         L     R10,DX0(R9)                                              61794021
         L     R9,DX0(R10)                                              61800021
         N     R9,MK0932                                                61806021
         AH    R9,DX4(R10)          R9 POINTS TO LAST ENTRY IN GLS.     61812021
         S     R9,CON24                                                 61818021
TAS012   TM    DX1(R9),XX40         IS LGS A VARIABLE LGN GROUP         61824021
         BC    NOTONE,TAS013       NO, BRANCH                           61830021
         L     R4,DX16(R9)          YES, GET LGN FROM MAX LGN OF LGS    61836021
         BC    UNCOND,TAS016       BRANCH                               61842021
TAS013   L     R4,DX0(R9)           R4= LGN OF LGS                      61848021
         N     R4,MK1632                                                61854021
TAS016   ST    R4,TOTLGN                                                61860021
         CLI   DX0(R2),XX04                                             61866021
         BC    EQ,TAS040           FWB ALIGNMENT REQUIRED               61872021
         BC    HI,TAS080           DWB ALIGNMENT REQUIRED               61878021
*                                                                       61884021
*  HALF-WORD BOUNDARY ALIGNMENT REQUIRED.                               61890021
*                                                                       61896021
TAS020   TM    TOTLGN+NX3,XX01      IF LENGTH IS EVEN,                  61902021
         BC    ZERO,TAS110         BR TO DELETE REQUIREMENT             61908021
         L     R6,ONE                 NO. OF SLACK BYTES ADDED          61914021
         BC    UNCOND,TAS100          = 1                               61920021
*                                                                       61926021
*  FULL-WORD BOUNDARY ALIGNMENT REQUIRED.                               61932021
*                                                                       61938021
TAS040   TM    TOTLGN+NX3,XX03      IF TOTLGN IS DIVISIBLE BY 4, THE    61944021
         BC    ZERO,TAS110         BR TO DELETE REQUIREMENT             61950021
         L     R7,TOTLGN                                                61956021
         N     R7,THREE               NO. OF SLACK BYTES ADDED          61962021
         L     R6,FOUR                = 4 - (TOTAL GROUP LGN / 4 )      61968021
         SR    R6,R7                                                    61974021
         BC    UNCOND,TAS100       GO ADD SLACK BYTES TO LTH OF GP      61980021
*                                                                       61986021
*  DOUBLE-WORD BOUNDARY ALIGNMENT REQUIRED.                             61992021
*                                                                       61998021
TAS080   TM    TOTLGN+NX3,XX07      IF TOTLGN IS DIVISIBLE BY 7, THE    62004021
         BC    ZERO,TAS110         BR TO DELETE REQUIREMENT             62010021
         L     R7,TOTLGN                                                62016021
         N     R7,SEVEN               NO. OF SLACK BYTES ADDED          62022021
         L     R6,EIGHT               = 8 - (TOTAL GROUP LGN / 8 )      62028021
         SR    R6,R7                                                    62034021
*                                                                       62040021
TAS100   AR    R4,R6               ADD SLACK BYTES TO LENGTH OF GRO     62046021
         ST    R4,TOTLGN                                                62052021
         LR    R7,R6                                                    62058021
         A     R6,DISP             UPDATE THE DISP FIELD.               62064021
         ST    R6,DISP                                                  62070021
         L     R5,APAF-NX1          ADD THE SLACK BYTES TO APAF.        62076021
         SRL   R5,DX8                                                   62082021
         N     R5,MK2132                                                62088021
         AR    R5,R7                                                    62094021
         STC   R5,APAF+NX1                                              62100021
         ST    R5,MTEMP                                                 62106021
         MVN   APAF(LX1),MTEMP+NX2                                      62112021
         LR    R6,R7               SAVE SLACK BYTE COUNT                62118021
         TM    DX21(R9),XX10        IF IN LINKAGE SECTION               62124021
         BC    ONES,TAS105           DON'T ADD TO LOCCTR                62130021
         A     R7,LOCCTR                                                62136021
         ST    R7,LOCCTR         )                                      62142021
TAS105   TM    DX1(R9),XX40         IS LGS A VARIABLE LGN GROUP         62148021
         BC    ONES,TAS120         YES, BRANCH                          62154021
         MVC   DX2(LX2,R9),TOTLGN+NX2                                   62160021
         TM    TOTLGN+NX1,XX01                                          62166021
         BC    ZERO,TAS110         BR TO DELETE REQUIREMENT             62172021
         OI    DX1(R9),XX01                                             62178021
TAS110   S     R3,ONE              DELETE THIS REQUIREMENT FROM WOR     62184021
         STC   R3,ALIGN               CELL AND ADJUST POINTER.          62190021
         NI    DX0(R2),XX00                                             62196021
         BCR   UNCOND,R14          BRANCH                               62202021
TAS120   MVC   DX16(LX4,R9),TOTLGN   STORE UP'D MAX LGN BACK IN LGS     62208021
         MVC   QTEXT(LX8),INITVB    MOVE STEP VERB MASK                 62214021
         MVI   QTEXT+NX1,STEPVB       TO QTEXT                          62220021
         MVC   QTEXT+NX4(LX2),DX2(R9) MOVE VLC OF LGS TO STEP MASK      62226021
         STC   R6,QTEXT+NX8         SLACK BYTES ARE LITERAL IN STEP     62232021
         LA    R2,QTEXT                                                 62238021
         LA    R3,DX9                                                   62244021
         L     R1,COSADR           PUT OUT STEP VERB ON FILE 2          62250021
         BALR  R0,R1               BRANCH TO COMMON                     62256021
         DC    X'12'                                                    62262021
       IC    R3,ALIGN                  INSERT                     34696 62268021
       LA    R2,ALIGN(R3)              GET ADDRESS                34696 62274021
         BC    UNCOND,TAS110       BR TO DELETE REQUIREMENT             62280021
         EJECT                                                          62286021
*=2      CONVERSION FROM INT. DECIMAL TO BINARY (IDBI)                  62292021
*                                                                       62298021
*                                                                       62304021
*  THIS ROUTINE CONVERTS ANY INTERNAL DECIMAL NUMBER(UP TO 18           62310021
*    DECIMAL DIGITS + SIGN) TO BINARY FORM.                             62316021
*    INPUT  : R1 HAS ID LENGTH, R3 HAS STARTING ADDRESS OF IDOP.        62322021
*    OUTPUT : 'OUTPUT' HAS EITHER 2,4,OR 8 INDICATING WHETHER THE       62328021
*             BINARY RESULT IS CONTAINABLE IN HALF,FULL OR DOUBLE       62334021
*             WORD.  R2 OR R2,R3 HAS CONVERTED DATA.                    62340021
*                                                                       62346021
         USING *,R15                                                    62352021
IDBI     EQU   *                                                        62358021
         LR    R7,R3                                                    62364021
         CL    R1,FIVE                                                  62370021
         BC    HI,IDB100                IDOP > 5 BYTES &<= 10 BYTES     62376021
         S     R1,ONE                                                   62382021
         EX    R1,IDB200                    ZAP                         62388021
         CVB   R2,MTEMP                                                 62394021
         EX    R1,HAFMAX                COMPARE MAXIMUM                 62400021
         BC    EQ,IDB020                      BR                        62406021
         BC    LO,IDB040                      BR                        62412021
         EX    R1,HAFMIN                  COMPARE MINIMUM               62418021
         BC    HI,IDB040                    BR                          62424021
IDB020   MVI   OUTPUT,XX02                                              62430021
         BCR   UNCOND,R14                    RETURN                     62436021
IDB040   MVI   OUTPUT,XX04                                              62442021
         BCR   UNCOND,R14                   RETURN                      62448021
IDB080   MVI   OUTPUT,XX08                                              62454021
         BCR   UNCOND,R14                   RETURN                      62460021
*                                                                       62466021
IDB100   ST    R1,INPUT                 IDOP > 5 BYTES AND LT 10        62472021
         S     R1,FIVE                  (18 DECIMAL DIGITS + SIGN)      62478021
         STC   R1,IDB210+NX5                                            62484021
         EX    R0,IDB210                     ZAP                        62490021
         CVB   R2,MTEMP                                                 62496021
         SRDA  R2,DX32                                                  62502021
         S     R1,ONE                                                   62508021
         EX    R1,MVO                    MOVE TO MTEMP                  62514021
         CVB   R5,MTEMP                                                 62520021
         M     R4,TENPW9                                                62526021
         ALR   R3,R5                                                    62532021
         BC    R12,IDB110                   BR                          62538021
         LA    R2,DX1(R0,R2)                                            62544021
IDB110   AR    R2,R4                                                    62550021
         L     R1,INPUT                                                 62556021
         S     R1,ONE                   -1 FOR CORRECT MACH LGN         62562021
         EX    R1,FULMAX                 COMPARE MAXIMUM                62568021
         BC    EQ,IDB040                    BR                          62574021
         BC    LO,IDB080                    BR                          62580021
         EX    R1,FULMIN                    COMPARE MINIMUM             62586021
         BC    NOTHI,IDB040                   BR                        62592021
         BC    UNCOND,IDB080                  BR                        62598021
*                                                                       62604021
*                                                                       62610021
IDB200   ZAP   MTEMP(LX8),DX0(LX0,R7)                                   62616021
IDB210   ZAP   MTEMP(LX8),DX0(LX5,R7)                                   62622021
HAFMAX   CP    MAXHAF(LX8),DX0(LX0,R7)                                  62628021
HAFMIN   CP    MINHAF(LX8),DX0(LX0,R7)                                  62634021
FULMAX   CP    MAXFUL(LX16),DX0(LX0,R7)                                 62640021
FULMIN   CP    MINFUL(LX16),DX0(LX0,R7)                                 62646021
MVO      MVO   MTEMP+NX3(LX5),DX0(LX0,R7)                               62652021
         EJECT                                                          62658021
         EJECT                                                          62664021
*=2      WSEND- END OF WORKING STORAGE- RESOLVE KEYS, WSADEF            62670021
* THIS ROUTINE IS CALLED YB DICTBD TO PERFORM THE FOLLOWING IN FILE     62676021
*    1. ENTER OVERFOW-NAME, IF ANY, INTO THE DICTIONARY.                62682021
*    2. ENTER FD INTO THE DICT,AND ENTER DELIMETER.IF NEEDED.           62688021
*    3. CALL BKSIZE ROUTINE FOR BUFFER CALCULATIONS.                    62694021
*    4. CALL RECKEY ROUTINE TO RESOLVE FOR RECORD KEY LENGTH.           62700021
IKF216   CSECT                                                          62706021
         USING *,R15                                                    62712021
WSEND    STM   R0,R13,BSAVE                                             62718021
         MVC   CARDXX(LX2),CARDNO   SAVE CURRENT CARD NO.               62724021
         ST    R14,RETURN                                               62730021
         ST    R15,RS0                                                  62736021
         MVI   WS,XX00              ZERO OUT WSADEF CODE                62742021
         TM    PTBLSW,XX01          IS THERE ANY KEYTBL TABLE ENTRY.    62748021
         BC    ZERO,WSE100            NO.                               62754021
*                                                                       62760021
* PROCESS KEYTABL AND BSAMTABL                                          62766021
*                                                                       62772021
         MVI   ITMCLS+NX1,XX02                                          62778021
         L     R1,SYMPAR                                                62784021
         L     R2,DX0(R1)                                               62790021
         L     R1,DX0(R2)                                               62796021
         N     R1,MK0932                                                62802021
         ST    R1,MTEMP1                                                62808021
         AH    R1,DX4(R2)                                               62814021
         LR    R12,R1                                                   62820021
         L     R1,MTEMP1                                                62826021
WSE010   L     R15,AQUAL                                                62832021
         BALR  R14,R15             RESOLVE FOR KEYS.                    62838021
         CL    R15,ZEROS                                                62844021
         L     R15,AWSEND                                               62850021
         BC    EQ,WSE030           CONTINUE PROCESSING                  62856021
         L     R4,MTEMP1           UP R4 TO                             62862021
         MVC   PARAM(LX2),DX0(R4)       DATA PART OF                    62868021
         AH    R4,PARAM                KEY ENTRY                        62874021
         MVC   CARDNO(LX2),DX14(R4)  GET  KEY CARD NO.                  62880021
         LA    R4,DX16(R4)                                              62886021
         BAL   R6,WSERR            BR TO ERROR ROUTINE                  62892021
         DC    X'2035'             53                                   62898021
         BC    UNCOND,WSE056       GET NEXT KEYTBL ENTRY                62904021
WSE030   ST    R1,MTEMP                                                 62910021
         L     R4,MTEMP1                                                62916021
         MVC   PARAM(LX2),DX0(R4)    N.B. TABLE ENTRY DOES NOT ALWAYS   62922021
         AH    R4,PARAM               START ON WORD BOUNDARY.           62928021
         LA    R4,DX2(R4)                                               62934021
         MVC   CARDNO(LX2),DX12(R4)                                     62940021
         TM    DX3(R4),XX01        NOMINAL KEY=NO KEYLGN FIELD?         62946021
         BO    WSNOMKY            YES - PROCESS NOMINAL KEY.            62952021
WSACTKY  SH    R1,FOUR+NX2         NO - PROCESS ACTUAL KEY              62958021
         C     R1,CON256          IS SIZE OF ACTKEY-4 G.T. 255?         62964021
         BL    WSACTK1             NO - OK                              62970021
         BAL   R6,WSERR           YES - ERROR.                          62976021
         DC    X'2088'            ERROR MESSAGE NO 136.                 62982021
         LA    R4,DX14(R4)         R4 POINTS TO THE NEXT ENTRY          62988021
         B     WSE056              GET NEXT KEYTBL ENTRY                62994021
WSACTK1 ST     R1,ACTKEY                                                63000021
         MVI   LITBUF,XX28                                              63006021
         MVC   LITBUF+NX1(LX3),DX1(R4)                                  63012021
         MVC   DCBSAV(LX4),DX0(R4)                                      63018021
         ST    R1,MTEMP                                                 63024021
         MVI   LITBUF+NX4,HEXCOD                                        63030021
         MVC   LITBUF+NX5(LX2),ONE+NX2                                  63036021
         MVC   LITBUF+NX7(LX1),ACTKEY+NX3                               63042021
         L     R1,COSADR                                                63048021
         LA    R2,LITBUF                                                63054021
         L     R3,EIGHT                                                 63060021
         BALR  R0,R1               BR TO COMMON                         63066021
         DC    X'14'                                                    63072021
         B     WSE045              CHECK FOR BSAM TBL                   63078021
*                                                                       63084021
*DEL                                                                    63090021
*           MAKE SURE NOMINAL KEY IS IN WORKING-STORAGE  *        51873 63096021
WSNOMKY  SR    R3,R3                                              51873 63102021
         IC    R3,DX0(R2)         PICK UP MAJOR CODE              51873 63108021
         SLL   R3,DX28                                            51873 63114021
         SRL   R3,DX28                                            51873 63120021
         CH    R3,WSREC           IS KEY IN WORKING-STORAGE       51873 63126021
         BE    WSNOMK2            YES                             51873 63132021
         BAL   R6,WSERR           NO.  ERROR                      51873 63138021
         DC    X'20E6'             MSG. 230                       51873 63144021
WSNOMK2  TM    DX3(R4),XX02       ISAM?                           51873 63150021
         BO    WSE039B             YES                                  63156021
         NI    WKAREA+NX35,XXF0                                         63162021
         CLI   WKAREA+NX35,XXB0    COMP?                                63168021
         BE    WSE039             YES.                                  63174021
WSNOMER  BAL   R6,WSERR           NO - ERROR.                           63180021
         DC    X'009D'            MSG NO=157                            63186021
         B     WSE040              CONTINUE PROCESSING                  63192021
WSE039B  C     R1,CON256                                                63198021
         BL    WSE040              CONTINUE PROCESSING                  63204021
         BAL   R6,WSERR            ERROR RTN                            63210021
         DC    X'2088'                                                  63216021
         B     WSE040              CONTINUE PROCESSING                  63222021
WSE039   CLI   WKAREA+NX33,XX08    S9(8) ?                              63228021
         BNE   WSNOMER            NO - ERROR.                           63234021
WSE040   A     R4,FOUR            R4 POINTS TO REL LOC DECB KEYADR      63240021
         MVI   LITBUF,XX2C                                              63246021
         L     R2,WKAREA+NX36                                           63252021
         MVC   LITBUF+NX1(LX3),DX1(R4)                                  63258021
         N     R2,MK2532                                                63264021
         SR    R3,R3                                                    63270021
         IC    R3,FAPAF+NX2                                             63276021
         SR    R2,R3                                                    63282021
         MH    R2,CO4096+NX2       RELATIVE LOCATION OF KEY =           63288021
         L     R3,WKAREA+NX36      (NO OF BL'S)*4096+DISP.              63294021
         SRL   R3,DX8                                                   63300021
         N     R3,MK2132                                                63306021
         AR    R2,R3                                                    63312021
         A     R2,WS                                                    63318021
         ST    R2,LITBUF+NX4                                            63324021
         MVI   LITBUF+NX4,XX04                                          63330021
         L     R1,COSADR                                                63336021
         LA    R2,LITBUF                                                63342021
         L     R3,EIGHT                                                 63348021
         BALR  R0,R1               BR TO COMMON                         63354021
         DC    X'14'                                                    63360021
         B     WSE046              CONTINUE                             63366021
WSE045   A     R4,FOUR            SKIP A(KEY) FIELD FOR ACT-KEY         63372021
WSE046   A     R4,FOUR            R4 POINTS TO DISP IN BSAM TABLE       63378021
         TM    DX3(R4),XX01        BSAM TABLE PRESENT?                  63384021
         BE    WSBSAM0            YES - PROCESS IT.                     63390021
WSE055   A     R4,SIX             R4 POINTS TO THE NEXT ENTRY IF AN     63396021
WSE056   CR    R4,R12             END OF KEYTBL REACHED?                63402021
         BNL   WSE090             YES.                                  63408021
         LR    R1,R4              NO, PROCESS NEXT ENTRY.               63414021
         ST    R1,MTEMP1          MTEMPI=A(NEXT ENTRY)                  63420021
         B     WSE010              BEGIN PROCESSING NEXT ENTRY          63426021
*                                                                       63432021
WSBSAM0  L     R7,BSMPAR          GET BLKSIZ FROM BSAMTB                63438021
         L     R8,DX0(R7)                                               63444021
         L     R7,DX0(R8)                                               63450021
         N     R7,MK0932                                                63456021
         MVC   PARAM(LX2),DX2(R4)    ADD DISPLACEMENT PTR IN KEYTBL     63462021
         AH    R7,PARAM               TO START OF BSAMTB.               63468021
         L     R5,LOCCTR                                                63474021
         TM    DX17(R7),XX80        BDAM-D                              63480021
         BO    WSBSAM1             NO                                   63486021
         MVC   FULLWD+NX1(LX3),DX3(R7)                                  63492021
         XC    FULLWD(LX1),FULLWD                                       63498021
         L     R3,FULLWD                                                63504021
         LA    R3,DX36(R3)         DECB+36                              63510021
         ST    R3,LITBUF          TARGET ADR                            63516021
         MVI   LITBUF,XX2C                                              63522021
         MVI   LITBUF+NX4,XX04     ADCON LGN = 4 BYTES                  63528021
         MVC   LITBUF+NX5(LX3),LOCCTR+NX1                               63534021
         L     R1,COSADR                                                63540021
         LA    R2,LITBUF                                                63546021
         L     R3,EIGHT                                                 63552021
         BALR  R0,R1               BR TO COMMON                         63558021
         DC    X'14'                                                    63564021
         L     R5,LOCCTR                                                63570021
         A     R5,MTEMP           A-K LGN - 4                           63576021
         LA    R5,DX4(R5)          LOCCTR+A-K LGN                       63582021
         ST    R5,LOCCTR                                                63588021
WSBSAM1  TM    DX9(R7),XX01        S-A?                                 63594021
         BO    WSBSAM2            NO.                                   63600021
         MVC   FULLWD(LX4),DX6(R7)  YES.                                63606021
         L     R1,PSAME                                                 63612021
         BAL   R6,SAMEKEY          PROCESS SAME AREA                    63618021
WSBSAM2  TM    DX13(R7),XX01       S-R-A?                               63624021
         BO    WSBSAM3            NO.                                   63630021
         MVC   FULLWD(LX4),DX10(R7) YES.                                63636021
         L     R1,PSMRCD                                                63642021
         BAL   R6,SAMEKEY          PROCESS SAME RECORD AREA             63648021
WSBSAM3  MVI   LITBUF,XX04                                              63654021
         MVC   LITBUF+NX1(LX3),DX14(R7) FD DICTIONARY POINTER           63660021
         LA    R1,LITBUF                                                63666021
         L     R15,ALATRP         GET DICTIONARY ATTRIBUTE ADDRESS      63672021
         BALR  R14,R15            IN R2.                                63678021
         L     R15,AWSEND                                               63684021
         MVC   DX9(LX3,R2),WKAREA+NX37 MOVE KEY ADPAR INTO FD DICTIONAR 63690021
         MVC   DX12(LX1,R2),MTEMP+NX3 MOVE KEY LGN INTO FD DICTIONARY.  63696021
         A     R5,MTEMP                                                 63702021
         LA    R5,DX7(R5)                                               63708021
         N     R5,MK0129                                                63714021
         LR    R6,R5                                                    63720021
WSBSAM4  TM    DX14(R7),XX40       V?                                   63726021
         BZ    WSBSAM5             NO                                   63732021
         A     R5,EIGHT           YES.                                  63738021
WSBSAM5  TM    DX17(R7),XX60        BDAM OR BSAM S-MODE                 63744021
         BZ    *+8                 SKIP NEXT INSTRUCTION                63750021
         A     R5,EIGHT                                                 63756021
         TM    DX13(R7),XX01                                            63762021
         BZ    WSBSAM6             BRANCH                               63768021
         TM    DX9(R7),XX01                                             63774021
         BZ    BDAMSM              TEST FOR S-MODE                      63780021
         B     WSE065              BRANCH                               63786021
WSBSAM6  TM    DX9(R7),XX01         S-A                                 63792021
         BZ    BDAMS1              YES, GEN BUFNO BUFLN                 63798021
         B     WSE085              NO, GO GEN SEG WK AREAP              63804021
WSE065   ST    R5,WKAREA+NX4       SAVE A(BUFFER) FOR BLKADEF           63810021
         TM    DX17(R7),XX80        BDAM-D                              63816021
         BZ    *+8                 NO                                   63822021
         S     R6,MTEMP            R6= A(BUFFER) FOR DECB               63828021
         MVC   FULLWD+NX1(LX3),DX3(R7)                                  63834021
         L     R1,FULLWD                                                63840021
         LA    R1,DX12(R1)                                              63846021
         ST    R1,LITBUF                                                63852021
         MVI   LITBUF,XX2C                                              63858021
         ST    R6,LITBUF+NX4                                            63864021
         MVI   LITBUF+NX4,XX04                                          63870021
         LR    R1,RCOM                                                  63876021
         LA    R2,LITBUF                                                63882021
         LA    R3,DX8                                                   63888021
         BALR  R0,R1               BR TO COMMON                         63894021
         DC    X'14'                                                    63900021
*                                                                       63906021
*        PUT OUT BLKADEF FOR BUFFER ASSIGNED                            63912021
*                                                                       63918021
         XC    LITBUF+NX5(LX4),LITBUF+NX5 ZERO OUT RPD AND DISP OF BLKA 63924021
         MVC   LITBUF(DX2),DX0(R7) GET BUFFER LENGTH IN BYTES     53116 63930021
         LH    R1,LITBUF                                          53116 63936021
         A     R1,THREE            CONVERT LENGTH FROM BYTES      53116 63942021
         SRL   R1,DX2              TO NO. OF WORDS                53116 63948021
         STH   R1,LITBUF                                          53116 63954021
         MVC   LITBUF+7(DX2),LITBUF   PUT LENGTH INTO BL CONST.   53116 63960021
         MVC   LITBUF+NX1(LX3),WKAREA+NX5 REL. LOC. OF BUFFER           63966021
         MVI   LITBUF,XX0C          BLKADEF ATEXT CODE                  63972021
         MVC   LITBUF+NX4(LX1),DX2(R7) BL FOR BUFFER                    63978021
WSE080   L     R1,COSADR                                                63984021
         LA    R2,LITBUF                                                63990021
         LA    R3,DX9                                                   63996021
         BALR  R0,R1               BR TO COMMON                         64002021
         DC    X'14'                                                    64008021
         L     R5,WKAREA+NX4                                            64014021
         MVC   FULLWD(LX2),DX0(R7)                                      64020021
         AH    R5,FULLWD                                                64026021
         ST    R5,LOCCTR         )                                      64032021
         TM    DX17(R7),XX20        BSAM SPANNED                        64038021
         BZ    WSE055              NO                                   64044021
*                                                                       64050021
*                                                                       64056021
         ST    R6,LITBUF+NX4        YES, PUT IN DCB + 100               64062021
         MVI   LITBUF+NX4,XX04      A( LOG RCD AREA)                    64068021
         L     R3,DCBSAV           DCB + 16                             64074021
         LA    R3,DX84(R3)          DCB + 100                           64080021
         ST    R3,LITBUF           TARGET ADDRESS                       64086021
         MVI   LITBUF,XX2C          CODE                                64092021
         LA    R2,LITBUF                                                64098021
         LA    R3,DX8                                                   64104021
         L     R1,COSADR                                                64110021
         BALR  R0,R1               BR TO COMMON                         64116021
         DC    X'14'                                                    64122021
         TM    DX9(R7),XX01         S-A                                 64128021
         BZ    WSE055              YES, GO OUT                          64134021
WSE085   TM    DX17(R7),XX20        BSAM SPANNED                        64140021
         BZ    WSE055              NO. GO OUT                           64146021
         L     R9,LOCCTR                                                64152021
         LA    R9,DX7(R9)                                               64158021
         N     R9,MK0129                                                64164021
         L     R3,DCBSAV                                                64170021
         LA    R3,DX76(R3)          DCB + 92                            64176021
         ST    R3,LITBUF           TARGET ADDRESS                       64182021
         MVI   LITBUF,XX2C          CODE                                64188021
         ST    R9,LITBUF+NX4                                            64194021
         MVI   LITBUF+NX4,XX04      ADCON LENGTH                        64200021
         LA    R2,LITBUF                                                64206021
         LA    R3,DX8                                                   64212021
         L     R1,COSADR                                                64218021
         BALR  R0,R1               BR TO COMMON                         64224021
         DC    X'14'                                                    64230021
         ST    R9,LITBUF           A (SEG WK AREA)                      64236021
         MVI   LITBUF,XX2C                                              64242021
         LA    R2,DX12(R9)          A (SEG WK AREA + 12)                64248021
         ST    R2,LITBUF+NX4                                            64254021
         MVI   LITBUF+NX4,XX04      ADCON COUNT                         64260021
         LA    R3,DX8                                                   64266021
         LA    R2,LITBUF                                                64272021
         L     R1,COSADR                                                64278021
         BALR  R0,R1               BR TO COMMON                         64284021
         DC    X'14'                                                    64290021
         LA    R9,DX4(R9)           SEG WK AREA + 4                     64296021
         ST    R9,LITBUF                                                64302021
         BAL   R3,BDAMS2           LNK TO BDAMS2                        64308021
         AH    R9,SEGSAV           ADD SPACE SAVED                      64314021
         LA    R9,DX12(R9)          MAXIM + 22                          64320021
         ST    R9,LOCCTR                                                64326021
         B     WSE055              PROCESS NEXT ENTRY                   64332021
*                                                                       64338021
SAMEKEY  L     R1,DX0(R1)          R1=A(TAMM)                           64344021
         L     R1,DX0(R1)          R1=A(TABLE)                          64350021
         N     R1,MK0932                                                64356021
         A     R1,FULLWD                                                64362021
         MVC   DX9(LX1,R1),MTEMP+NX3                                    64368021
         BR    R6                 RETURN                                64374021
BDAMSM   TM    DX17(R7),XX60        S-MODE                              64380021
         BZ    WSE055              NO                                   64386021
BDAMS1   STM   R5,R6,RNMSAV        SAVE REGS                            64392021
         L     R9,DCBSAV           A(DCB + 16)                          64398021
         LA    R9,DX88(R9)          DCB + 104                           64404021
         ST    R9,LITBUF           TARGET ADDRESS                       64410021
         BAL   R3,BDAMS2           LNK TO BDAMS2                        64416021
         MVC   FULLWD(LX4),DX6(R7)   DISPL IN SAMETBL                   64422021
         L     R6,PSAME                                                 64428021
         L     R6,DX0(R6)                                               64434021
         L     R6,DX0(R6)                                               64440021
         N     R6,MK0932           CLEAR TOP BYTE                       64446021
         A     R6,FULLWD           DISPL FO ENTRY                       64452021
         OI    DX11(R6),BASICS     SET S BIT ON                         64458021
         LM    R5,R6,RNMSAV                                             64464021
         TM    DX13(R7),XX01        S-R-A                               64470021
         BZ    WSE055              YES GO OUT                           64476021
         B     WSE065              NO, RETURN                           64482021
BDAMS2   ST    R3,INPUT            SAVE RETURN REG                      64488021
         MVC   FULLWD(LX2),DX0(R7)   BLKSIZ                             64494021
         LH    R9,FULLWD                                                64500021
*                                                                       64506021
         TM    DX17(R7),XX0F        TRACK CAPACITY                      64512021
         BZ    BDAMS4              NO                                   64518021
         LA    R1,TRKCAP           A (TABLE)                            64524021
         AR    R1,R2               POINT TO PROPER ENTRY                64530021
         N     R2,MK0015           GET RID OF OTHER BITS                64536021
         AR    R1,R2               POINT TO PROPER ENTRY                64542021
         LH    R9,DX0(R1)           ADD TRACK CAPACITY                  64548021
         CH    R9,DX0(R1)           WANT MIN                            64554021
         BL    BDAMS4              LRECL MIN                            64560021
         LR    R9,R1               ADD TRACK CAPACITY                   64566021
BDAMS4   LA    R9,DM10(R9)         ADD 10 FOR DATA MANG                 64572021
         STH   R9,SEGSAV                                                64578021
         MVI   LITBUF,XX28          CODE                                64584021
         MVC   LITBUF+NX4(LX3),FOUR+NX1 COUNT                           64590021
         L     R3,ACTKEY           SIZE OF KEY                          64596021
         AH    R3,SEGSAV           BUFLN                                64602021
         MVC   LITBUF+NX7(LX2),ONE+NX2 BUFNO = 1                        64608021
         STH   R3,FULLWD                                                64614021
         MVC   LITBUF+NX9(LX2),FULLWD                                   64620021
         L     R1,COSADR                                                64626021
         LA    R2,LITBUF                                                64632021
         LA    R3,DX11              COUNT                               64638021
         BALR  R0,R1               GEN FIELDS FOR DCB                   64644021
         DC    X'14'                                                    64650021
         L     R3,INPUT            RESTORE RETURN REG                   64656021
         L     R9,LITBUF           RESTORE ADD OF SEG WK AREA           64662021
         BR    R3                  RETURN                               64668021
WSE090   L     R1,SYMPAR           RELEASE KEYTBL TABLE,                64674021
         L     R15,BTABRL                                               64680021
         BALR  R14,R15             BR TO TABLE RELEASE RTN              64686021
         L     R15,RS0                                                  64692021
         NI    PTBLSW,XXFE             AND SET SW TO INDICATE SO.       64698021
WSE100   TM    PTBLSW,XX40                                              64704021
         BZ    WSSM01              NO                                   64710021
         L     R15,ASAME                                                64716021
         BALR  R14,R15             YES. PROCESS SAME AREA               64722021
         L     R15,AWSEND                                               64728021
WSSM01   TM    PRMSW,XX20                                               64734021
         BZ    WSSM02              NO                                   64740021
         L     R15,ASAMER                                               64746021
         BALR  R14,R15             YES. PROCESS SAME RECORD AREA.       64752021
         L     R15,AWSEND                                               64758021
WSSM02   TM    PRMSW,XX40                                               64764021
         BZ    WSE104             NO.                                   64770021
         L     R1,REORGPAR                                              64776021
         L     R2,DX0(R1)                                               64782021
         L     R1,DX0(R2)          R1 POINTS TO START OF REORG TBL.     64788021
         N     R1,MK0932                                                64794021
         ST    R1,MTEMP1                                                64800021
         AH    R1,DX4(R2)          R1=EOT                               64806021
         LR    R12,R1             R12=EOT                               64812021
         L     R1,MTEMP1          MTEMP1=A(TABLE)---A(CURRENT ENTRY     64818021
WSE100B  L     R15,AQUAL                                                64824021
         BALR  R14,R15            LOCATE THE QUAL-NAME                  64830021
         CL    R15,ZEROS                                                64836021
         L     R15,AWSEND                                               64842021
         BE    WSE101             FOUND                                 64848021
         L     R4,MTEMP1          NOT FOUND - ERROR                     64854021
         MVC   PARAM(LX2),DX0(R4)                                       64860021
         AH    R4,PARAM                                                 64866021
         MVC   CARDNO(LX2),DX5(R4)  GET CARD NO.                        64872021
         LA    R4,DX7(R4)                                               64878021
         BAL   R6,WSERR           REORG DATA NAME NOT FOUND OR          64884021
         DC    X'101C'             NOT UNIQUE                           64890021
         B     WSE102             CHECK NEXT FIELD.                     64896021
WSE101   ST    R1,MTEMP                                                 64902021
         L     R4,MTEMP1                                                64908021
         MVC   PARAM(LX2),DX0(R4)   TABLE ENTRY MAY NOT BE ON WD-B.     64914021
         AH    R4,PARAM                                                 64920021
         LA    R4,DX2(R4)                                               64926021
         MVI   LITBUF,XX04                                              64932021
         MVC   LITBUF+NX1(LX3),DX0(R4) DICTIONARY PTR                   64938021
         LA    R1,LITBUF                                                64944021
         L     R15,ALATRP         GET DICT-ATTRIB ADDRESS.              64950021
         BALR  R14,R15             BR TO RTN                            64956021
         L     R15,AWSEND                                               64962021
         MVC   DX9(LX3,R2),WKAREA+NX37 MOVE REORG ADPAR INTO DICT-ATTRI 64968021
         OI    DX4(R2),XX08                                             64974021
         LA    R4,DX5(R4)                                               64980021
WSE102   CR    R4,R12             END OF REORG TBL                      64986021
         BNL   WSE103             YES, RELEASE TBL                      64992021
         LR    R1,R4              NO, PROCESS NEXT ENTRY.               64998021
         ST    R1,MTEMP1          MTEMP1=A(NEXT ENTRY)                  65004021
         B     WSE100B             PROCESS NEXT ENTRY                   65010021
WSE103   L     R1,REORGPAR                                              65016021
         L     R15,BTABRL         RELEASE REORG TBL                     65022021
         BALR  R14,R15             BRANCH                               65028021
         L     R15,RS0                                                  65034021
         NI    PRMSW,XXBF          SET PRMSW OFF                        65040021
*                                                                       65046021
*  PROCESS TRKTBL FOR TRACK AREA DATANAME ADDRESS AND LENGTH.           65052021
*                                                                       65058021
WSE104   TM    PTBLSW,XX20                                              65064021
         BC    ZERO,WSE130         CHECK FOR TOTALING AREA ENTRY        65070021
         L     R9,TPARAM                                                65076021
         L     R10,DX0(R9)                                              65082021
         L     R9,DX0(R10)          R9 POINTS TO START OF TRKTBL.       65088021
         N     R9,MK0932                                                65094021
         LR    R8,R9                                                    65100021
         AH    R8,DX4(R10)          R8 POINTS TO END OF TABLE.          65106021
WSE105   SR    R4,R4                                                    65112021
         IC    R4,DX0(R9)           R4= TRACK-AREA DATA-NAME COUNT      65118021
         XC    LITBUF(LX32),LITBUF                                      65124021
         EX    R4,TRKMOV           MOVE DATA-NAME TO WORK-AREA          65130021
         LA    R1,LITBUF-NX2        R1= A(WORKAREA)                     65136021
         L     R15,AQUAL                                                65142021
         BALR  R14,R15             CALL QUAL FOR DATA-NAME LGN          65148021
         C     R15,ZEROS            AND ATTRIBUTES                      65154021
         L     R15,AWSEND                                               65160021
       BC    EQ,WSE106            QUAL FOUND NO ERRORS                  65166021
         NI    WKAREA+NX35,XXF0                                         65172021
         CLI   WKAREA+NX35,XX40                                         65178021
       BC    EQ,WS111A            VARIABLE LENGTH - ERROR               65184021
       BC    UNCOND,WS111B         ERROR                                65190021
WSE106 C     R1,CON32K            IS AREA OVER 32767                    65196021
       BC    HI,WS111C              YES - ERROR                         65202021
         NI    WKAREA+NX34,XX0F                                         65208021
         CLI   WKAREA+NX34,XX04     IS AREA IN WORKING-STORAGE SECTI    65214021
       BC    NOTEQ,WS111D           NO - ERROR                          65220021
       SR    R3,R3                GET LEVEL                             65226021
         IC    R3,DX6(R2)                                               65232021
         SRA   R3,DX2                                                   65238021
       C     R3,ONE                                                     65244021
       BC    EQ,WS106A            LEVEL 01 OK                           65250021
       C     R3,FIFTY                                                   65256021
       BC    NOTEQ,WS111D         LEVEL NEITHER 01 NOT 77 - ERROR       65262021
WS106A EQU   *                                                          65268021
         LA    R9,DX1(R4,R9)        YES, SET UP CONDEF FOR AREA SIZE    65274021
*CONDEF                                                SMSW IN DCB      65280021
         MVI   LITBUF,XX28          CONDEF CODE                         65286021
         MVC   LITBUF+NX1(LX3),DX5(R9) RELLOC OF SMSW                   65292021
         MVC   LITBUF+NX4(LX3),TWO+NX1 TYPE CODE=0   LGN=2              65298021
         ST    R1,FULLWD                                                65304021
         MVC   LITBUF+NX7(LX2),FULLWD+NX2 AREA SIZE                     65310021
         L     R3,NINE                                                  65316021
         BAL   R6,WSE119           PUT OUT A-TEXT                       65322021
*ADCONDEF                                                               65328021
         MVI   LITBUF,XX2C          ADCONDEF CODE                       65334021
         MVC   LITBUF+NX1(LX3),DX1(R9) RELLOC OF MSWA                   65340021
*DETERMINE ADDRESS                                                      65346021
         L     R1,WKAREA+NX36       AREA'S ADDRESSING PARAMETERS        65352021
         SR    R2,R2                                                    65358021
         IC    R2,WKAREA+NX39       BL = FOR AREA                       65364021
         SR    R3,R3                                                    65370021
         IC    R3,WS+NX4            1ST BL FOR WORK-STOR.               65376021
         SR    R2,R3               NUMBER OF BL'S                       65382021
         MH    R2,CO4096+NX2        MULTIPLY BY 4096                    65388021
WSE107   SRL   R1,DX8               FIND DISP. FROM BL                  65394021
         N     R1,MK2132                                                65400021
         AR    R2,R1               REL LOC OF AREA =                    65406021
         A     R2,WS                A(WORK. STOR.) + NO. OF BL'S *4     65412021
         ST    R2,LITBUF+NX4                        + DISP. FROM BL     65418021
         MVI   LITBUF+NX4,XX04      ADCON LGN                           65424021
         LA    R3,DX8                                                   65430021
         BAL   R6,WSE119           PUT OUT A-TEXT                       65436021
WSE108   LA    R9,DX10(R9)          R9= A(NEXT ENTRY IN TABLE)          65442021
WSE109   CR    R9,R8               END OF TABLE                         65448021
         BC    LO,WSE105           NO                                   65454021
         BC    UNCOND,WSE120       YES                                  65460021
WS111A LA    R0,X'B1'                                                   65466021
       BC    UNCOND,WSE111         CONTINUE                             65472021
WS111B LA   R0,X'33'                                                    65478021
       BC    UNCOND,WSE111         CONTINUE                             65484021
WS111C LA    R0,X'B0'                                                   65490021
       BC    UNCOND,WSE111         CONTINUE                             65496021
WS111D LA   R0,X'99'                                                    65502021
WSE111   LA    R9,DX1(R4,R9)        ERROR                               65508021
         MVC   CARDNO(LX2),DX8(R9)                                      65514021
       O     R0,M8192             SEVERITY IS 2                         65520021
         BAL   R6,WSERR+NX4        ERROR                                65526021
         BCR   M0,R0               2 BYTES NEEDED FOR CALLING SEQ       65532021
         BC    UNCOND,WSE108       GET NEXT ENTRY                       65538021
WSE119   L     R1,COSADR           PUT OUT A-TEXT                       65544021
         LA    R2,LITBUF             ON FILE 4                          65550021
         BALR  R0,R1               BR TO COMMON                         65556021
         DC    X'14'                                                    65562021
         BCR   UNCOND,R6           CONTINUE                             65568021
TRKMOV   MVC   LITBUF(LX0),DX0(R9)                                      65574021
*                                                                       65580021
WSE120   L     R1,TPARAM           RELEASE TABLE.                       65586021
         L     R15,BTABRL                                               65592021
         BALR  R14,R15             RELEASE TABLE                        65598021
         NI    PTBLSW,XXDF                                              65604021
         L     R15,AWSEND                                               65610021
         BC    UNCOND,WSE130       CONTINUE                             65616021
*                                                                       65622021
*                                                                       65628021
WSE130   TM    PRMSW,XX80          ANY TOTALING AREA ENTRY.             65634021
         BZ    WSE150             NO. GET OUT.                          65640021
         L     R9,TOTLPAR         YES. PROCESS.                         65646021
         L     R10,DX0(R9)                                              65652021
         L     R9,DX0(R10)         R9=A(TOTL TBL)                       65658021
         N     R9,MK0932                                                65664021
         LR    R8,R9                                                    65670021
         AH    R8,DX4(R10)         R8 POINTS TO END OF TABLE            65676021
WSE130A  LR    R1,R9                                                    65682021
         L     R15,AQUAL          SEARCH TOTL-AREA DN IN DICT.          65688021
         BALR  R14,R15             BRANCH                               65694021
         LTR   R14,R15                                                  65700021
         L     R15,AWSEND                                               65706021
         BZ    WSE131             DN FOUND                              65712021
         MVC   FULLWD(LX2),DX0(R9)  DN NOT FOUND. DN-QUAL COUNT.        65718021
         AH    R9,FULLWD                                                65724021
         MVC   CARDNO(LX2),DX6(R9)  MOVE CARD NO.                       65730021
         BAL   R6,WSERR           TOTL-AREA D-N NOT FOUND.              65736021
         DC    X'20E2'                      MSG. NO. 226     2,7-RJ     65742021
         LA    R9,DX8(R9)          R9 POINTS TO NEXT ENTRY              65748021
         B     WSE135             CHECK IF THERE ARE MORE ENTRIES.      65754021
WSE131   NI    WKAREA+NX34,XX0F                                         65760021
         CLI   WKAREA+NX34,XX04    WORKING-S-S? (MAJOR CODE 4)          65766021
         BE    WSE132             YES - OK.                             65772021
         MVC   FULLWD(LX2),DX0(R9)                                      65778021
         AH    R9,FULLWD                                                65784021
         MVC   CARDNO(LX2),DX6(R9)  MOVE CARD NO.                       65790021
         BAL   R6,WSERR           TOTALING AREA DN NOT DEFINED IN       65796021
         DC    X'20E3'                  WK-S-S    MSG. NO. 227          65802021
         LA    R9,DX8(R9)          R9 POINTS TO NEXT ENTRY              65808021
         B     WSE135              CHECK FOR END OF TABLE               65814021
WSE132   NI    WKAREA+NX35,XXF0    TOTALING AREA                        65820021
         CLI   WKAREA+NX35,XX40    VARIABLE LENGTH?                     65826021
         BE    WSE132E1           YES, ERROR.                           65832021
         C     R1,CO4096          NO. OK.  LESS THAN 4096?              65838021
         BH    WSE132E2                    YES, ERROR.                  65844021
         ST    R1,MTEMP           MTEMP = SIZE OF TOTALING AREA.        65850021
         L     R1,WKAREA+NX36      AREA'S ADPAR                         65856021
         SR    R2,R2                                                    65862021
         IC    R2,WKAREA+NX39      BL#                                  65868021
         SR    R3,R3                                                    65874021
         IC    R3,WS+NX4           1ST BL FOR WS                        65880021
         SR    R2,R3                                                    65886021
         MH    R2,CO4096+NX2                                            65892021
         SRL   R1,DX8                                                   65898021
         N     R1,MK2132                                                65904021
         AR    R2,R1              REL LOC OF AREA                       65910021
         A     R2,WS              = A(WS)+NO OF BL'S*4096+DISP          65916021
         ST    R2,LITBUF          TARGET ADR.                           65922021
         MVI   LITBUF,XX28                                              65928021
         MVC   LITBUF+NX4(LX3),TWO+NX1 SIZE = 2                         65934021
         MVC   LITBUF+NX7(LX2),MTEMP+NX2                                65940021
         LR    R1,RCOM                                                  65946021
         LA    R2,LITBUF                                                65952021
         LA    R3,DX9                                                   65958021
         BALR  R0,R1               BR TO COMMON                         65964021
         DC    X'14'                                                    65970021
         MVI   LITBUF,XX2C                                              65976021
         MVC   FULLWD(LX2),DX0(R9)                                      65982021
         LH    R2,FULLWD                                                65988021
         AR    R9,R2                                                    65994021
         MVC   FULLWD(LX4),DX2(R9) REL LOC OF DCB IN FULLWD             66000021
         L     R2,FULLWD                                                66006021
         LA    R3,DX27                                                  66012021
         SR    R2,R3              R2=REL LOC DCB - 20                   66018021
         ST    R2,LITBUF          REL LOC OF A(TTL AREA)=DCB-20         66024021
         BCTR  R2,R0               DECREMENT REG 2                      66030021
         XC    TTLDC0A(LX8),TTLDC0A                                     66036021
         ST    R2,TTLDC0A         TARGET = DCB-20                       66042021
         MVI   LITBUF,XX2C         ADCONDEF CODE                        66048021
         L     R1,WKAREA+NX36      AREA'S ADDRESSING PARAMETERS         66054021
         SR    R2,R2                                                    66060021
         IC    R2,WKAREA+NX39      BL NO FOR AREA                       66066021
         SR    R3,R3                                                    66072021
         IC    R3,WS+NX4           1ST BL FOR WORK-STOR.                66078021
         SR    R2,R3              NUMBER OF BL'S                        66084021
         MH    R2,CO4096+NX2       MULTIPLY BY 4096                     66090021
         SRL   R1,DX8              FIND DISP. FROM BL.                  66096021
         N     R1,MK2132                                                66102021
         AR    R2,R1              REL LOC OF AREA                       66108021
         A     R2,WS              =A(W-S)+NO OF BLS*4096                66114021
         ST    R2,LITBUF+NX4       +DISP. FROM BL                       66120021
         MVI   LITBUF+NX4,XX03     AL3                                  66126021
         LA    R3,DX8              PUT OUT 8 BYTE ADCONDEF.             66132021
*                     PREPARE TO SET EXLIST CODE TO 0A.                 66138021
         MVI   TTLDC0A,XX28        CONDEF CODE                          66144021
         MVI   TTLDCSZ+NX1,XX01    SIZE = 1                             66150021
         MVI   TTLVALU,XX0A                                             66156021
*                                                                       66162021
         BAL   R6,WSE119          PUT OUT ADCONDEF                      66168021
         L     R1,COSADR                                                66174021
         LA    R2,TTLDC0A                                               66180021
         LA    R3,DX8                                                   66186021
         BALR  R0,R1              PUT OUT CONDEF FOR X'0A'              66192021
         DC    X'14'              FOR EXIT LIST CODE.                   66198021
         LA    R9,DX8(R9)          R9 POINTS TO NEXT ENTRY              66204021
         B     WSE135              CHECK FOR END OF TABLE               66210021
WSE132E1 BAL   R6,WSERR            CALL ERR RTN                         66216021
         DC    X'206F'            TOTALING AREA SIZE                    66222021
*                                  VARIABLE.                            66228021
         B     WSE135              SEE IF END OF TABLE                  66234021
WSE132E2 BAL   R6,WSERR            CALL ERR RTN                         66240021
         DC    X'1057'            TOTALING AREA SIZE                    66246021
*                                 GREATER THAN 4095.                    66252021
         B     WSE135              SEE IF END OF TABLE                  66258021
WSE135   CR    R8,R9              END OF TABLE                          66264021
         BNH   WSE139             YES                                   66270021
         B     WSE130A            NO                                    66276021
WSE139   L     R1,TOTLPAR         RELEASE TABL.                         66282021
         L     R15,BTABRL                                               66288021
         BALR  R14,R15             BRANCH TO RELEASE TBL                66294021
         NI    PRMSW,XXEF          SET TOTL TBL SW OFF                  66300021
         L     R15,AWSEND                                               66306021
         B     WSE150              CONTINUE                             66312021
WSE150   LM    R0,R12,BSAVE                                             66318021
         MVC   CARDNO(LX2),CARDXX   RESTORE CURRENT CARD NO.            66324021
         L     R14,RETURN                                               66330021
         BCR   UNCOND,R14          RETURN                               66336021
*                                                                       66342021
WSERR    LH    R0,DX0(R6)           CALL ERROR ROUTINE                  66348021
         L     R15,AERRTN                                               66354021
         BALR  R14,R15             BR TO ERR RTN                        66360021
         L     R15,AWSEND                                               66366021
         LA    R6,DX2(R6)                                               66372021
         BCR   UNCOND,R6           RETURN                               66378021
WSE999   MVC   WKAREA(LX0),DX0(R9)                                      66384021
*=2      FST000- FD SD SA DICTIONARY ACTION RTN                         66390021
         EJECT                                                          66396021
IKF213A  CSECT                                                          66402021
         USING *,R15                                                    66408021
FST000   ST    R14,RS14A                                                66414021
         MVC   SWKAR(LX1),CILEV          SAVE CUR LEVEL                 66420021
         L     R10,BUFCAS+NX20                                          66426021
         TM    FSTSW,XX80           IS THIS 1ST FD, SD, SA              66432021
         BC    ZERO,FST080         YES, BRANCH                          66438021
FST001 DS    0H                                                         66444021
         MVC   SWKAR(LX1),CILEV          SAVE CUR LEVEL                 66450021
         MVI   NXCISW,XX01          INDICATE NEXT FD IN CI FOR ADP04    66456021
         MVI   CILEV,XX01           SET LEVEL=1 SO THAT                 66462021
         L     R15,AXTEN            XTEN CAN RESOLVE THE LGN            66468021
         BALR  R14,R15              OF THE LAST 01 IN THE FD            66474021
         L     R15,AFST00          MAXIM WILL HAVE THE 01 LGN(LARGE     66480021
         MVC   FDDCBNO(LX1),PRDCBNO     MVE PRESENT DCB NO TO     45078 66486021
*   DCB NO ASSOCIATED WITH THE RECORD                             45078 66492021
         MVI   NXCISW,XX00                                              66498021
         MVC   CARDXX(LX2),CARDNO   SAVE CURRENT CARD NO. AND SUBSTI    66504021
         MVC   CARDNO(LX2),BUFCRD   FD, SD, SA CARD NO.                 66510021
         CLI   ODOCCT,XX02          DID LAST 01 HAVE MORE THAN 1 OCC    66516021
*                                  DEPENDING ON CLAUSE SUBORDINATE      66522021
         BC    LO,FST002           NO, BRANCH                           66528021
         OI    OD2SW,XX01           YES, SET SW FOR RECORD CONT. PRO    66534021
FST002   MVI   ODOCCT,XX00          SET CTR TO 0                        66540021
         IC    R1,PCOUNT           NO, WHAT TYPE IS IT (FROM MAJOR      66546021
         N     R1,MK3032                 OF PREVIOUS ITEM)              66552021
         C     R1,ONE              IS IT SD                             66558021
         BE    FST030              YES                                  66564021
         C     R1,SIX         8    NO. IS IT RD                         66570021
         BE    FST070              YES                                  66576021
*FD                                IT IS FD                             66582021
FST004   CLI   SWKAR,XX38           IS CI AN FD                         66588021
         BC    NOTEQ,FST005          NO - PROCESS LAST FD               66594021
         L     R15,ADIC62          YES - RECALCULATE NO. OF BL'S        66600021
         BALR  R14,R15             BRANCH                               66606021
         L     R15,AFST00                                               66612021
FST005   XI    FD+NX1,XX01                                              66618021
         OC    FD+NX1(LX1),FDBLN                                        66624021
         BAL   R4,FST990           GET FD'S  ATTRIBUTES ADDRESS (DI     66630021
         TM    BUFOPT,XX08                                              66636021
         BZ    FST05A              PROCESS FD                           66642021
         L     R3,REORGPAR                                              66648021
         L     R4,DX0(R3)                                               66654021
         L     R3,DX0(R4)                                               66660021
         L     R4,REORGPS                                               66666021
         N     R4,MK0932                                                66672021
         AR    R3,R4                                                    66678021
         MVC   FULLWD(LX2),DX0(R3)                                      66684021
         AH    R3,FULLWD                                                66690021
         MVC   DX2(LX3,R3),LASTDP+NX1 MOVE FD DICT PTR INTO TBL.        66696021
FST05A   CLI   COD01,XX01          01 IN FD                             66702021
       BC    EQ,FST5A                    YES                            66708021
         MVI   FD+NX1,XX01                                              66714021
*           ERROR--NO 01 IN FD                                          66720021
       LH    R0,ERR183                                                  66726021
       L     R15,AERRTN                                                 66732021
       BALR  R14,R15               ERROR RTN                            66738021
       L     R15,AFST00                                                 66744021
FST5A  DS    0H                                                         66750021
         MVI   COD01,XX00                 RESET 01 IN FD                66756021
         XI    DX1(R2),XX01                                             66762021
         OC    DX1(LX2,R2),FD+NX1                                       66768021
       L     R15,ACHKEY           CHECK KEYS                            66774021
       BALR  R14,R15               BRANCH                               66780021
       L     R15,AFST00                                                 66786021
         L     R10,BUFCAS+NX20                                          66792021
         BAL   R4,RECCON           CHECK RECORD CONTAINS CLAUSE         66798021
         TM    BUFOPT,XX02                                              66804021
         BZ    *+10                SKIP NEXT INSTRUCTION                66810021
         XC    MINIM(LX4),MINIM                                         66816021
         BAL   R4,FST990           GET FD,SD,SA ATTRIB                  66822021
         MVC   DX6(LX2,R2),MAXIM+NX2                                    66828021
         LH    R4,BKCON2                                                66834021
         LTR   R4,R4                                                    66840021
         BNZ   CALLMODE            CONTINUE                             66846021
         MVC   BKCON2(LX2),BKCON1                                       66852021
CALLMODE BAL   R4,MODE00          DECIDE RECORDING MODE                 66858021
FST012   BAL   R14,BKSIZE          CALL BKSIZE TO DETERMINE BUFFER      66864021
*                                   NEEDS AND TO FILL IN DCB AND DE     66870021
*                                   FIELDS REQUIRED FOR BUFFERS         66876021
         L     R3,LOCDCB                                                66882021
         LA    R3,DX36(R3)         RECFM=DCB+36                         66888021
         ST    R3,FMCNST                                                66894021
         MVI   FMCNST,XX28                                              66900021
         L    R1,COSADR                                                 66906021
         LA    R2,FMCNST                                                66912021
         LA    R3,DX8                                                   66918021
         BALR  R0,R1              PUT OUT CONSTANT DEF                  66924021
         DC    X'14'                                                    66930021
          L     R3,LOCDCB                                               66936021
         SH    R3,TWO+NX2                                               66942021
         ST    R3,LITBUF                                                66948021
         MVI   LITBUF,XX28                                              66954021
         MVC   LITBUF+NX4,TWO+NX1  TYPE=00, SIZE=2                      66960021
         MVC   LITBUF+NX7(LX2),LBLMAX+NX2                               66966021
         L     R3,NINE                                                  66972021
         LA    R2,LITBUF                                                66978021
         L     R1,COSADR                                                66984021
         BALR  R0,R1               BR TO COMMON                         66990021
         DC    X'14'                                                    66996021
         XC    LBLMAX(LX4),LBLMAX                                       67002021
         TM    ACCMTH,XX80                                 A3           67008021
         BO    FST080             INITIALIZE ACCESS WORK AREAS.         67014021
         XI    DX19(R10),XX01                                           67020021
FST020   BC    UNCOND,FST080       PROCESS RD                           67026021
*                                                                       67032021
ERR183 DC    X'00B7'                                                    67038021
*                                                                       67044021
*SD                                                                     67050021
FST030   BAL   R4,RECCON          CHECK RECORD CONTAINS CLAUSE          67056021
         BAL   R4,FST990          GET FD'S ATTRIB ADDRESS               67062021
         CLI   COD01,XX01           01 IN SD                            67068021
         BE    FST30A              YES                                  67074021
         LH    R0,ERR183                                                67080021
         L     R15,AERRTN                                               67086021
         BALR  R14,R15                                                  67092021
         L     R15,AFST00                                               67098021
FST30A   EQU   *                                                        67104021
         CLI   PSRANO,XX00         PREVIOUS SD SRA NO. INDICATED ?      67110021
         BE    FST30B              NO,  BRANCH                          67116021
         ST    R2,SREG2            SAVE DICTIONARY POINTER              67122021
         L     R15,ADIC62          LOAD ADDR. OF CALCULATING BL'S       67128021
         BALR  R14,R15             PERFORM ABOVE RTN                    67134021
         L     R2,SREG2            RESTORE DICTIONARY POINTER           67140021
         L     R15,AFST00          RESTORE BASE REGISTER                67146021
***                                                                     67152021
* IF END OF FILE SECTION AND SD,  NO. OF BL HAVE TO BE ADJUSTED         67158021
***                                                                     67164021
         TM    FSTSW,XX20          IS END OF FILE SECTION               67170021
         BZ    FST30A1             NO,  BRANCH                          67176021
         SR    R4,R4               CLEAR REG 4                          67182021
         IC    R4,FDBLN            INSERT NO. OF BL                     67188021
         BCTR  R4,R0               DECREAMENT ONE                       67194021
         STC   R4,FDBLN                                                 67200021
FST30A1  DS    0H                                                       67206021
         MVC   DX2(LX1,R2),FD+NX2  INSERT FIRST BL NO                   67212021
         MVN   DX1(LX1,R2),FDBLN   INSERT NO OF BL,S                    67218021
         OI    DX0(R2),XX89        SET SD SRA & SD BITS IN DICT.        67224021
         OI    DX7(R2),XX80             INDICATOR TO PH5-SD, SRA  39847 67230021
         B     FST30C              GO TO PROCESS SRA TABLE ENTRIES      67236021
FST30B   DS    0H                                                       67242021
         MVC   DX2(LX1,R2),SDBLL                                        67248021
         MVN   DX1(LX1,R2),SDBLN                                        67254021
FST30C   DS    0H                                                       67260021
         MVC   DX3(LX2,R2),MAXIM+NX2 MAX RCD SIZE                       67266021
         MVC   DX5(LX2,R2),MINIM+NX2 MIN RCD SIZE                       67272021
         TM    RCDFM,XX02                                               67278021
         BZ    FST031              CONTINUE                             67284021
         LA    R0,DX140                                                 67290021
         L     R15,AERRTN                                               67296021
         BALR  R14,R15             BR TO ERROR RTN                      67302021
         L     R15,AFST00                                               67308021
         NI    RCDFM,XXFD                                               67314021
FST031   BAL   R4,MODE00           GET RECORDING MODE                   67320021
         L     R15,AFST00          RESOTRE BASE REGISTER                67326021
*****                                                                   67332021
*                                                                       67338021
*   MAKES ENTRIES INTO SAME RECORD AREA TABLE FOR SD                    67344021
*                                                                       67350021
*****                                                                   67356021
         CLI   PSRANO,XX00         SAME REC AREA INDICATED ?            67362021
         BE    FST080              DO NOT PROCESS SRA TBL ENTRIES       67368021
         MVC   SMRCDRS+NX4(LX2),MAXIM+NX2   FD MAX                      67374021
         MVC   SMRCDRS+NX6(LX1),FD+NX2  INSERT FIRST BL NO              67380021
         OI    SMRCDRS+DX7,XX01    INDICATES SD SAME REC AREA           67386021
         TM    BUFCAS+DX10,XX08    FIXED RECORD FORMAT ?                67392021
         BO    SKIPVF              DO NOT SET V BIT                     67398021
         OI    SMRCDRS+NX8,XX80    INDICATES V REC FORMAT               67404021
SKIPVF   DS    0H                                                       67410021
         TM    PRMSW,XX20          SMRDTBL TIB5 PRIMED ?                67416021
         BO    SMRD1               YES, DO NOT PRIME                    67422021
         LA    R1,PSMRCD           NO, DO PRIME TIB 5                   67428021
         L     R15,BPRIME          LOAD  PARAM TO PRIME                 67434021
         BALR  R14,R15             PERFORM PRIME TIB 5                  67440021
         OI    PRMSW,XX20          SET TIB 5 PRIMED BIT                 67446021
SMRD1    DS    0H                                                       67452021
         L     R1,PSMRCD           TIB 5 PARAM                          67458021
         L     R15,BINSRT          LOAD INSERT RTN ADDRESS              67464021
         BALR  R14,R15             INSERT GIVEN PARAMS INTO TIB 5       67470021
         MVC   DX0(LX10,R2),SMRCDRS  MOVE IN SMRCDRS INTO TBLE          67476021
         L     R15,AFST00          RESTORE BASE REGISTER                67482021
         ST    R3,SMRCPT           SAVE ADD. RETURNED FROM INSERT RTN   67488021
         B     FST080              PROCESS RD                           67494021
*RD                                                                     67500021
FST070   BC    UNCOND,FST080       PROCESS RD                           67506021
FST080   XC    MAXIM(LX4),MAXIM     SET MAXIM TO ALL ZEROS              67512021
         MVC   MINIM(LX4),BPICTR    SET MINIM TO ALL ONES               67518021
         NI    NOFDSW,NOFDOFF      AN FD EXISTS-TURN OFF BIT BIT 6      67524021
         TM    FSTSW,XX20           END OF FILE SECTION                 67530021
         BC    NOTONE,FST085       NO                                   67536021
         NI    FSTSW,XX7F           YES, SET SW FOR FIRST RD            67542021
         BC    UNCOND,FST190        CI NOT FD, SD, SA, OR RD            67548021
FST085   OI    FSTSW,XX80           SET 1ST FD,SD, SA SW ON             67554021
         IC    R1,COUNT            WHAT TYPE IS CURRENT                 67560021
         N     R1,MK3032                                                67566021
         C     R1,SIX                      IS IT RD               45078 67572021
         BE    FST160                     YES, BR                 45078 67578021
         MVC   FDDCBNO(LX1),PRDCBNO      MVE PRESENT DCB NO.      45078 67584021
*    TO DCB NO. ASSOCIATED WITH THE RECORD                        45078 67590021
         C     R1,ONE                   IS IT SD                  45078 67596021
         BE    FST120                     YES, BR                 45078 67602021
*FD                                IT IS FD                             67608021
FST090   MVC   BUFCAS(LX30),BUFCAL  SAVE BUFFER INFO                    67614021
         MVC   SMRCDRS(LX10),SMRCDAR                                    67620021
         MVC   SAMERS(LX12),SAMEAR                                      67626021
         MVC   BSAMPS(LX4),BSAMPT                                       67632021
         MVC   REORGPS(LX4),REORGPT                                     67638021
         MVC   SVKYTB(LX6),FDKYTB   SAVE KEY TABLE DISPLS OF LAST FD    67644021
         XC    FDKYTB(LX6),FDKYTB                                       67650021
         MVC   FD(LX8),ATTRIB            SAVE ATTRIBUTES                67656021
         MVC   SMARPT(LX8),BPICTR  SET TBL DISP TO ODD NO.              67662021
         MVC   PSRANO,SRANO        SAVE SAME REC AREA NO.               67668021
         LH    R1,BLCTR        M)                                       67674021
         LA    R1,DX1(R1)                                               67680021
         STC   R1,FD+NX2                                                67686021
         STH   R1,BLCTR                                                 67692021
         STC   R1,FAPAF+NX2                                             67698021
         TM    FL4SAVE,XX04       WAS RECORD KEY SPEC'D           59737 67704021
         BC    ZERO,FST091        NO, BRANCH                      59737 67710021
*    IF RECORD KEY WAS SPEC'D FOR THIS FILE WE NOW                59737 67716021
*    HAVE TO INSERT THE FIRST BL # FOR THIS FILE                  59737 67722021
*    IN THE LAST BYTE OF THE RCKTBL ENTRY FOR THIS                59737 67728021
*    PARTICULAR KEY - WE DO THIS BY GETTING THE                   59737 67734021
*    ADDR. OF THE END OF THE TABLE, SUBTRACTING                   59737 67740021
*    1 BYTE AND THEN INSERTING THE BL # .                         59737 67746021
         L     R3,RPARAM          A(TIB) OF RCKTBL                59737 67752021
         L     R3,DX0(R3)         A(TAMM)                         59737 67758021
         LH    R4,DX4(R3)         R4 = SIZE OF TABLE              59737 67764021
         L     R3,DX0(R3)         R3 = A(TABLE)                   59737 67770021
         N     R3,MK0932          CLEAR 1ST BYTE                  59737 67776021
         AR    R4,R3              R4 = A(END OF TBL)              59737 67782021
         BCTR  R4,R0              POINT TO BL# FOR FILE           59737 67788021
         STC   R1,DX0(R4)         INSERT 1ST BL# FOR FILE         59737 67794021
FST091   EQU   *                                                  59737 67800021
       B     FST170                PROCESS FD                           67806021
*SD                                                                     67812021
FST120   DS    0H                                                       67818021
         CLI   SRANO,XX00          SD SAME REC AREA INDICATED ?         67824021
         BE    FST12A              NO, BRANCH                           67830021
         MVC   BUFCAS(LX30),BUFCAL   SAVE BUFFER INFO OF FILE           67836021
         MVC   SMRCDRS(LX10),SMRCDAR   SAVE SRA INFO                    67842021
         MVC   FD(LX8),ATTRIB      SAVE ATTRIBUTES                      67848021
         LH    R1,BLCTR            LOAD BL COUNTER                      67854021
         LA    R1,DX1(R1)          ADD ONE TO BL COUNTER                67860021
         STC   R1,FD+NX2           SAVE BL NO                           67866021
         STH   R1,BLCTR            UPDATE BL COUNTER                    67872021
         STC   R1,SDAPAF+NX2       SAVE BL NO                           67878021
         MVC   PSRANO,SRANO        SAVE SAME REC AREA NO.               67884021
         B     FST180              BRANCH TO FST180                     67890021
FST12A   DS    0H                                                       67896021
         LH    R1,BLLCTR           LOAD BLL COUNTER                     67902021
         LA    R1,DX1(R1)                                               67908021
         C     R1,THREE            CHECK BLL IS GREATER THAN THREE32325 67914021
         BH    FST12B              YES,  BRANCH AND KEEP IT       32325 67920021
         L     R1,THREE         INIT FIRST SD BLL NO. 3           32325 67926021
FST12B   DS    0H                                                 32325 67932021
         STC   R1,SDBLL                                                 67938021
         STH   R1,BLLCTR                                                67944021
         STH   R1,BLLSAVE          SAVE BLL NO                    32325 67950021
         STC   R1,SDAPAF+NX2                                            67956021
         OI    SDAPAF,XX10          SET I-FIELD FOR BLL                 67962021
         MVC   BUFCAS(LX30),BUFCAL  SAVE BUFFER INFO                    67968021
*RD                                                                     67974021
FST160   BC    UNCOND,FST180       CONTINUE                             67980021
*                                                                       67986021
FST170 SR    R4,R4                CALCULATE ATTRIB COUNT FOR FD         67992021
       SR    R1,R1                                                      67998021
       IC    R4,FDVCNT            FIXED PORTION COUNT                   68004021
       IC    R1,FDCUNT            VARIABLE PORTION COUNT                68010021
         SRL   R1,DX4                                                   68016021
         SRL   R4,DX4                                                   68022021
       AR    R1,R4                ADD THEM TO GET TOTAL COUNT.          68028021
       STC   R1,ATRCNT            STORE COUNT IN PARM LIST.             68034021
       B     FST181                CONTINUE                             68040021
FST180   MVI   ATRCNT,XX08          ENTER FD,SD,SA INTO DICTIONARY      68046021
FST181   MVC   PNTER(LX4),DICTPT                                        68052021
         MVI   CICODE,XX10                                              68058021
         LA    R1,CIPARM                                                68064021
         L     R15,AENTPT                                               68070021
         BALR  R14,R15             BR TO DICT ENTRY RTN                 68076021
FST190   L     R14,RS14A                                                68082021
         NI    OD2SW,XXFE           TURN OFF OVER 1 ODO CLAUSE SW       68088021
         MVC   CARDNO(LX2),CARDXX   RESTORE CURRENT CARD NO             68094021
         MVC   CILEV(LX1),SWKAR          RESTORE CUR LEVEL              68100021
         BCR   UNCOND,R14          RETURN                               68106021
FST990   MVI   PARAM,XX04           USING LAST DICT. PTR. AND LATRPT    68112021
         MVC   PARAM+NX1(LX3),LASTDP+NX1 LOCATE                         68118021
         LA    R1,PARAM             THE FD,SD, SA ATTRIBUTES IN         68124021
         L     R15,ALATRP           DICTIONARY                          68130021
         BALR  R14,R15              R2 WILL BE THAT LOCATION UPON       68136021
         L     R15,AFST00           RETURN FROM LATRPT                  68142021
         BCR   UNCOND,R4           RETURN                               68148021
*RECORD CONTAINS CHECKING                                               68154021
RECCON   LH    R3,RCON1            IS RECORD CONTAINS INT-2 SPECIFI     68160021
         LTR   R3,R3                                                    68166021
         BCR   ZERO,R4             NO, RETURN                           68172021
         LH    R2,RCON2            ONLY INT-2 SPEC'D                    68178021
         LTR   R2,R2                                                    68184021
         BC    ZERO,RECC01         YES                                  68190021
         LR    R3,R2               NO, SET R3= INT-2                    68196021
         BC    UNCOND,RECC01+NX6   CONTINUE                             68202021
RECC01   MVC   RCON1(LX2),ZEROS     SET INT- TO ZERO                   68208021
         C     R3,MAXIM            YES, IS IT EQUAL TO     LARGEST      68214021
         BC    EQ,RECC02           YES                                  68220021
         TM    OD2SW,XX01           NO, ARE THRRE 2 OR MORE ODO IN R    68226021
         BC    ONES,RECC04         YES                                  68232021
         LA    R0,DX146             146  NO                             68238021
         L     R15,AERRTN                                               68244021
         BALR  R14,R15             ERROR                                68250021
         L     R15,AFST00                                               68256021
RECC02   LH    R3,RCON1            GET RECORD CONTAINS INT-1            68262021
         LTR   R3,R3               IS IT SPEC'D                         68268021
         BCR   ZERO,R4             NO, RETURN                           68274021
         C     R3,MINIM            YES, IS IT EQUAL TO SMALLEST REC     68280021
         BE    RECC03             YES, OK.                              68286021
         BH    RECC02E            NO.                                   68292021
         TM    BUFOPT,XX02         INT-1 LT MINIM. ODO?                 68298021
         BO    RECC03             YES, OK(MAYBE).                       68304021
RECC02E  LA    R0,DX147                                                 68310021
         L     R15,AERRTN                                               68316021
         BALR  R14,R15             ERROR                                68322021
         L     R15,AFST00                                               68328021
RECC03   BCR   UNCOND,R4           RETURN                               68334021
RECC04   EQU   *                  MAX. FROM RCD CONTAINS CLAUSE         68340021
*                                 IF DESCRIPTION IS V.                  68346021
         ST    R3,MAXIM                                                 68352021
         BC    UNCOND,RECC02       CONTINUE RECORD CONTAINS PROCESS     68358021
MODE00   ST    R4,RS0              ING                                  68364021
         BAL   R4,FST990          GET FD'S A(ATTRIB) IN R2              68370021
         XC    RECFM(LX1),RECFM                                         68376021
         TM    RCDFM,XX08          MODE F?                              68382021
         BZ    MODE01             NO.                                   68388021
         CLC   MAXIM(LX4),MINIM    YES. DESCRIPTION F?                  68394021
         BE    MODE01                  YES, OK.                         68400021
*                                                                       68406021
         LH    R0,MSG16                                                 68412021
         L     R15,AERRTN         DATA RECORD DESCRIPTION IS            68418021
         BALR  R14,R15            VARIABLE. MODE F IGNORED.             68424021
         L     R15,AFST00                                               68430021
MODE01   TM    ACCMTH,XX0F         QSAM?                                68436021
         BZ    MDQS00             YES.                                  68442021
         TM    RCDFM,XX0F          NON-QSAM. IS MODE SPECIFIED?         68448021
         BM    MODE02                       YES.                        68454021
         TM    BLKLBL,XX10          BLK CONTAINS CHAR                   68460021
         BO    MDQS00              SEE IF MODE DECIDED                  68466021
         CLC   MAXIM(LX4),MINIM    NO. DESCRIPTION V?                   68472021
         BNE   MODE02             YES. U(DIRECT)                        68478021
         OI    RCDFM,XX08          NO. SET F BIT ON.                    68484021
*        LA    R0,28                                                    68490021
*        L     R15,AERRTN         DATA RECORD DESCRIPTION IS            68496021
*        BALR  R14,R15            FIXED. RECORDING MODE F               68502021
*        L     R15,AFST00         ASSUMED.                              68508021
MODE02   TM    ACCMTH,XX03         ISAM?                                68514021
         BM    MDIS00             YES.                                  68520021
         TM    DX8(R10),XX04                                            68526021
         BNZ   MDDI00             YES.                                  68532021
MDRE00   TM    RCDFM,XX08          F                                    68538021
         BO    MDRE01             YES, OK.                              68544021
         LH    R0,MSG135          NO                                    68550021
         L     R15,AERRTN  *****  ERROR: RCD DESCRIPTION V ILLEGAL      68556021
         BALR  R14,R15            FOR RELATIVEFILE.                     68562021
         L     R15,AFST00                                               68568021
MDRE01   OI    RCDFM,XX08          SET MODE = F                         68574021
         B     MODE10              MODE PROCESSING                      68580021
MDDI00   TM    RCDFM,XX0F          MODE DECIDED                         68586021
         BNZ   *+8                YES                                   68592021
         OI    RCDFM,XX02          MODE IS U.                           68598021
         TM    RCDFM,XX20          RCD OVFL ?                           68604021
         BZ    MDDI01             NO                                    68610021
         TM    RCDFM,XX08          YES. MODE F                          68616021
         BO    MDDI01             YES - OK.                             68622021
         LA    R0,MSG139          NO. RCD OVFL OK OM         NLY        68628021
         L     R15,AERRTN         F MODE FOR BSAM,BDAM.                 68634021
         BALR  R14,R15            ERROR: OPTION IGNORED.                68640021
         L     R15,AFST00                                               68646021
         NI    RCDFM,XXDF          SET OFF OVFL BIT                     68652021
MDDI01   OI    RECFM,XX01          KEY BIT                              68658021
         B     MODE10              MODE PROCESSING                      68664021
MDIS00   TM    RCDFM,XX0F          MODE DECIDED?                        68670021
         BNZ   MDIS01             YES.                                  68676021
         OI    RCDFM,XX04          NO. DESCRIPTION V = MODE V           68682021
*        INDEXED FILE. MODE, TRACK AREA CHECKING.                       68688021
MDIS01   OI    RECFM,XX01          KEY BIT                              68694021
         B     MODE10              MODE PROCESSING                      68700021
MDQS00   TM    RCDFM,XX0F          MODE DECIDED?                        68706021
         BM    MDQS09             YES.                                  68712021
         TM    BLKLBL,XX08         BLKCK CONT RECORD              00907 68718021
         BO    MDQS03              YES, BRANCH                    00907 68724021
         LH    R3,BKCON2          LOAD MAX LENGTH OF BLOCKED            68730021
         CLC   MAXIM(LX4),MINIM   DIFFERENCE IN MAX AND MIN OF REC      68736021
         BNE   MDQS01             SAME LENGTH, NOT VARI REC             68742021
         LTR   R3,R3              MAX BLOCKED INDICATED ??              68748021
         BZ    MDQS04             MEASN BLOCK 00 OR NO INDICATION       68754021
         LTR   R3,R3               TEST REG 3                           68760021
         BC    ZERO,MDQS3A         IF ZERO, BRANCH..                    68766021
MDQS01   CLC   MAXIM(LX4),MINIM    DESCRIPTION V?                       68772021
         L     R4,MAXIM                                                 68778021
         BE    MDQS02             NO, F.                                68784021
         LA    R4,DX4(R4)          YES.                                 68790021
MDQS02   CR    R3,R4              R3--INT-2 CHAR. R4--LRECL             68796021
         BNL   MDQS03             NOT S MODE. F OR V.                   68802021
         LTR   R3,R3                    BLOCK CONTAINS 0          41541 68808021
         BZ    MDQS03          YES,  MAKE RECFM V                 41541 68814021
         OI    RCDFM,XX01          SET S MODE BIT ON IN BUFCAS.         68820021
         TM    ACCMTH,XX0C          BASIC FILE                          68826021
         BZ    MDQS09              NO                                   68832021
         NI    BLKLBL,XXE7          YES, TIRN OFF BITS                  68838021
         OI    RECFM,KEYFLG        SET KEY BIT ON                       68844021
         B     MODE10              GO PROCESS REST                      68850021
MDQS03   DS    0H                                                 00907 68856021
         TM    BUFOPT,XX02         VARIABLE GROUP INDICATED       00907 68862021
         BO    MDQS3A              YES, MAKE RECFM = V            00907 68868021
         CLC   MAXIM(LX4),MINIM    CHECK LENGTH FOR VARIABLE      00907 68874021
         BE    MDQS04             NO. ASSUME MODE F.                    68880021
MDQS3A   OI    RCDFM,VMODE         YES, ASSUME V MODE                   68886021
         TM    ACCMTH,XX0C          BASIC FILE                          68892021
         BZ    MDQS09              NO                                   68898021
         NI    BLKLBL,XXE7          YES, TIRN OFF BITS                  68904021
         OI    RECFM,KEYFLG        SET KEY BIT ON                       68910021
         B     MODE10              GO PROCESS REST                      68916021
MDQS04   OI    RCDFM,XX08          SET F BIT IN BUFCAS                  68922021
         TM    ACCMTH,XX0C          BASIC FILE                          68928021
         BZ    MDQS09              NO                                   68934021
         NI    BLKLBL,XXE7          YES, TURN OFF BITS                  68940021
         OI    RECFM,KEYFLG        SET KEY BIT ON                       68946021
         B     MODE10              GO PROCESS REST                      68952021
*                                 RECORDING MODE DECIDED BY NOW.        68958021
MDQS09   TM    BUFOPT,XX80         APPLY WRITE ONLY?                    68964021
         BZ    MODE10             NO.                                   68970021
         TM    RCDFM,XX04          YES.  MODE V?                        68976021
         BO    MDQS10             YES - OK.                             68982021
         LA    R0,X'00B6'         NO - CLAUSE IGNORED.                  68988021
         L     R15,AERRTN                                               68994021
         BALR  R14,R15             ERROR ROUTINE                        69000021
         L     R15,AFST00                                               69006021
         B     MODE10              MODE PROCESSING                      69012021
MDQS10   OI    DX4(R2),XX02                                             69018021
         B     MODE10              MODE PROCESSING                      69024021
MODE10   TM    RCDFM,XX08          MODE F?                              69030021
         BO    MODEF              YES.                                  69036021
         TM    RCDFM,XX04          MODE V?                              69042021
         BO    MODEV              YES.                                  69048021
         TM    RCDFM,XX02          MODE U?                              69054021
         BO    MODEU              YES.                                  69060021
MODES    TM    ACCMTH,BUFUR        UNIT RECORD                          69066021
         BZ    MODEES              NO, OK                               69072021
         LH    R0,MSG195           ILLEGAL FOR S-MODE                   69078021
         L     R15,AERRTN                                               69084021
         BALR  R14,R15             GO GEN MSG 26                        69090021
         L     R15,AFST00                                               69096021
         B     MDQS3A              ASSUME V MODE                        69102021
MODEES   OI    ONEE(R2),DICTS      S BY DEFAULT                         69108021
*        R2 POINTS TO THE LAST FD DICTIONARY ATTRIBUTE.                 69114021
         OI    RECFM,XX48           V-S BITS                            69120021
         TM    ACCMTH,XX0E          QSAM                                69126021
         BM    MODES1              NO                                   69132021
         OI    RECFM,XX10           YES, B BIT ON                       69138021
         TM    BUFOPT,TTLMSK      TOTALING AREA?                        69144021
         BZ    MODE11             NO, OK.                               69150021
         LA    R0,MSGTTL1         YES, ERROR                            69156021
         L     R15,AERRTN         TOTALING AREA IGNORED FOR FILE        69162021
         BALR  R14,R15            WITH RECORDING MODE S.                69168021
         L     R15,AFST00         MSG NO 26                             69174021
         B     MODE11              SET APPROPRIATE BITS ON IN RECFM     69180021
MODES1   NI    BLKLBL,BLKOFF       TURN OFF BITS                        69186021
         TM    ACCMTH,BLKBSAM      BSAM                                 69192021
         TM    ACCMTH,XX04          BSAM                                69198021
         BO    MODES4              YES, BUFNO = 0                       69204021
         L     R3,LOCDCB           A (DCB)                              69210021
         LA    R3,DX20(R3)                + 20                          69216021
         ST    R3,LITBUF                                                69222021
         MVI   LITBUF,XX28          CODE                                69228021
         MVC   LITBUF+NX4(LX3),ONE+NX1 COUNT                            69234021
         MVI   LITBUF+NX7,XX01      BUFNO = 1                           69240021
         LA    R3,DX8               COUNT                               69246021
         LA    R2,LITBUF                                                69252021
         L     R1,COSADR                                                69258021
         BALR  R0,R1               GO GEN                               69264021
         DC    X'14'                                                    69270021
MODES4   L     R3,LOCDCB                                                69276021
         LA    R3,DX32(R3)             + 32                             69282021
         ST    R3,LITBUF                                                69288021
         MVI   LITBUF,XX28                                              69294021
         MVC   LITBUF+NX4(LX3),ONE+NX1 COUNT                            69300021
         MVI   LITBUF+NX7,XX20      SET FOR S-MODE BASIC FILES          69306021
         LA    R3,DX8               COUNT                               69312021
         LA    R2,LITBUF                                                69318021
         L     R1,COSADR                                                69324021
         BALR  R0,R1               BR TO COMMON                         69330021
         DC    X'14'                                                    69336021
         B     MODE11               GO CHECK REST                       69342021
MODEU    OI    DX1(R2),XX40        U BIT ON IN DICT. ATTRIB.            69348021
         OI    RECFM,XXC0                                               69354021
         B     MODE12             NO BLOCKING FOR U                     69360021
MODEV    OI    RECFM,XX40                                               69366021
         B     MODE11              SET APPROPRIATE BITS ON IN RECFM     69372021
MODEF    OI    DX1(R2),XX20                                             69378021
         OI    RECFM,XX80                                               69384021
*                                                                       69390021
MODE11   TM    BLKLBL,XX18         BLOCKED FILE                         69396021
         BZ    MODE12              NO.                                  69402021
         TM    RCDFM,XX02         UNDEFINED RECFM ???                   69408021
         BO    MODE12             DO NOT SET BLOCKED BIT ON             69414021
         OI    RECFM,XX10          B BIT ON                             69420021
MODE12   TM    RCDFM,XX90          ASA CC?                              69426021
         BZ    MODE13             NO.                                   69432021
         OI    RECFM,XX04          YES.                                 69438021
MODE13   TM    RCDFM,XX40          MACHINE CC                           69444021
         BZ    MODE14             NO.                                   69450021
         OI    RECFM,XX02          YES.                                 69456021
MODE14   TM    RCDFM,XX20          TRACK OVFL?                          69462021
         BZ    MODE15             NO.                                   69468021
         OI    RECFM,XX20          YES.                                 69474021
MODE15   L     R4,RS0                                                   69480021
         BR    R4                 RETURN                                69486021
MSG135    DC   X'1087'             VARIABLE DISP FOR R OR I             69492021
MSG06    DC    X'1006'        BLK CON. CL. IGNORED FOR U          LCLIO 69498021
MSG16    DC    X'0010'                                                  69504021
MSG139   EQU   139                RCD OVFL FOR V OR U DIRECT FILE       69510021
MSGTTL1  EQU   26   TOTALING AREA IGNORED FOR FILE WITH MODE S.         69516021
         EJECT                                                          69522021
*=2      BKSIZE- BLKSIZE, BUFLN CALCULATIONS                            69528021
*  THIS ROUTINE CALCULATES THE LOGICAL RECORD LENGTH, BLOCK SIZE,       69534021
*    BUFFER LENGTH AND BUFFER POOL LENGTH IN FILE SECTION. IF A SAM     69540021
*    AREA CLAUSE IS PRESENT, THE BLOCKSIZE IS PUT INTO SAMTBL ENTRY     69546021
*    BUFFER-LENGTH AND BLOCK-SIZE IN DCB ARE PUT OUT AS CONDEFS IN      69552021
*    A-TEXT FORMAT.                                                     69558021
*                                                                       69564021
BKSIZE   ST    R14,RS14B                                                69570021
         ST    R15,RS0                                                  69576021
         TM    RCDFM,XX02          MODE U?                              69582021
         BZ    BKS000             NO.                                   69588021
         TM    BLKLBL,XX18                                              69594021
         BZ    BKS000             NO - OK.                              69600021
         LH    R0,MSG06           ERROR BLOCK CONTAINS                  69606021
         L     R15,AERRTN         CLAUSE FOR U FILE IGNORED.            69612021
         BALR  R14,R15             ERROR ROUTINE                        69618021
         L     R15,RS0                                                  69624021
         NI    RECFM,XXEF                                               69630021
BKS000   L     R4,MAXIM                                                 69636021
         ST    R4,MTEMP                 SAVE REC LGN                    69642021
         TM    RCDFM,XX0A           U OR F                              69648021
         BM    BKS001              YES                                  69654021
         LA    R4,DX4(R4)          YES, LRECL=MAXIM+4.                  69660021
BKS001   TM    ACCMTH,XX08         BDAM?                                69666021
         BO    BKS002              YES                                  69672021
         L     R3,LOCDCB          NO. PUT OUT LRECL                     69678021
         LA    R3,DX82(R3)         R3=A(DCBLRECL)=DCB+82                69684021
         ST    R3,LITBUF                                                69690021
         MVI   LITBUF,XX28                                              69696021
         MVC   LITBUF+NX4(LX3),TWO+NX1 TYPE=X'00' SIZE=2                69702021
         ST    R4,MTEMP                                                 69708021
         MVC   LITBUF+NX7(LX2),MTEMP+NX2                                69714021
         L     R3,NINE                                                  69720021
         LA    R2,LITBUF                                                69726021
         L     R1,COSADR                                                69732021
         BALR  R0,R1               BR TO COMMON                         69738021
         DC    X'14'                                                    69744021
*                                                                       69750021
BKS002   TM    BLKLBL,XX18                                              69756021
         BZ    BKS010             NO.                                   69762021
BKS005   TM    BLKLBL,XX08         BLOCK CONTAINS RECORDS               69768021
         BC    ONES,BKS300         BLOCK CONTAINS RECORDS.              69774021
         TM    BLKLBL,XX10         BLOCK CONTAINS CHAR.                 69780021
*                                                                       69786021
         BC    ONES,BKS350         BLOCK CONTAINS CHARACTERS.           69792021
*                                                                       69798021
*  BLOCK-CONTAINS CLAUSE NOT PRESENT. RECORDING MODE = V.               69804021
*                                                                       69810021
BKS010   TM    RCDFM,XX08          MODE F?                              69816021
         BO    BKS200             YES.                                  69822021
         TM    RCDFM,XX02          MODE U?                              69828021
         BO    BKS020             YES.                                  69834021
         LA    R4,DX4(R4)           MODE V OR S MAXIM + 4 + 4           69840021
*                                                                       69846021
BKS020   C     R4,C32760                                                69852021
         BC    NOTHI,BKS030        BLKSIZE OK.                          69858021
         LH    R0,MSG50            BLKZ GT 32K                          69864021
         SR    R1,R1                                                    69870021
         L     R15,AERRTN                                               69876021
         BALR  R14,R15             ERROR RTN                            69882021
         L     R15,RS0                                                  69888021
*                                                                       69894021
BKS030   DS    0H                                                       69900021
         TM    RCDFM,XX02         UNDEFINED RECORD FORMAT ???           69906021
         BNO   *+14               SKIP NEXT TWO INST.                   69912021
         MVC   MTEMP1,MTEMP       MOVE REC LENGTH                       69918021
         B     *+8                SKIP NEXT INST                        69924021
         ST    R4,MTEMP1          STORE BLOCK LENGTH                    69930021
         MVC   LITBUF+NX7(LX2),MTEMP1+NX2                               69936021
         L     R3,LOCDCB                                                69942021
         LA    R3,DX62(R3)         R3=A(DCBBKS)=DCB+62                  69948021
         ST    R3,LITBUF                                                69954021
         MVI   LITBUF,XX28                                              69960021
         MVC   LITBUF+NX4(LX3),TWO+NX1                                  69966021
         L     R3,NINE            CONDEF FOR DCB BLKSIZE.               69972021
         LA    R2,LITBUF                                                69978021
         L     R1,COSADR                                                69984021
         BALR  R0,R1               BR TO COMMON                         69990021
         DC    X'14'                                                    69996021
BKS031   DS    0H                                                       70002021
         MVC   SAMERS+NX10(LX1),ACCMTH                                  70008021
         NI    SAMERS+NX10,XX3F                                         70014021
         MVC   SMRCDRS+NX8(LX1),SAMERS+NX10                             70020021
         TM    ACCMTH,XX0E                                              70026021
         BC    ZERO,BKS072            IS ASSIGN BY THE SYSTEM,          70032021
         TM    ACCMTH,XX01             SO LOCCTR IS NOT UPDATED.        70038021
         BC    ONES,BKS072         PROCESS QUEUED FILE                  70044021
BKS040   TM    ACCMTH,XX02          IS ACCESS METHOD BISAM              70050021
         BC    NOTONE,BKS045       NO, BLOCK LGN =BLKSIZE (BSAM, BS     70056021
         LA    R4,DX16(R4)          YES, BLOCK LGN= BLKSIZE+16          70062021
BKS045   LA    R4,DX7(R4)           BLKADEF DISP. =BLOCK LGN ROUNDED    70068021
         N     R4,MK0129             UP TO MULTIPLE OF 8.               70074021
* BASIC FILE                                                            70080021
BKSSM0   TM    BUFOPT,XX10         S-R-A?                               70086021
         BO    SAMERCD            YES.                                  70092021
BKSSM1   TM    BUFOPT,XX20         S-A?                                 70098021
         BO    BKS078              YES, PUT BLKSIZE IN SAMETBL          70104021
BKSKY0   TM    ACCMTH,XX30         KEY TO BE INCLUDED IN BUFF?          70110021
         BNZ   BKS130              YES                                  70116021
         TM    BUFOPT,XX20         S-A                                  70122021
         BO    BKS074              SEE IF S MODE                        70128021
         TM    BUFOPT,XX10         S-R-A                                70134021
         BZ    BKSKY1             NO                                    70140021
         TM    DX19(R10),XX03      BISAM                                70146021
         BM    BKS073             NO, RETURN                            70152021
BKSKY1   L     R5,LOCDEC                                                70158021
         LA    R5,DX12(R5)         R5=A(DECBUFADR)=DECB+12              70164021
         SR    R6,R6                                                    70170021
         IC    R6,DECBLN           R6= DECB LGN                         70176021
BKS048   MVC   LOCCTR(LX4),SAV01L       L                               70182021
         L     R8,LOCCTR                                                70188021
         LA    R8,DX7(R8)                                               70194021
       N     R8,MK0129           R8 ON R0 BOUNDARY                      70200021
BKS049   ST    R5,LITBUF           TARGET ADDRESS                       70206021
         ST    R8,LITBUF+NX4        SOURCE ADDRESS                      70212021
         MVI   LITBUF,XX2C          ADCONDEF  CODE                      70218021
         MVI   LITBUF+NX4,XX04      ADCON LGN = 4                       70224021
         L     R1,COSADR                                                70230021
         LA    R2,LITBUF                                                70236021
         LA    R3,DX8                                                   70242021
         BALR  R0,R1               PUT OUT ADCONDEF ON FILE 4           70248021
         DC    X'14'                                                    70254021
*PUT OUT BLKADEF- BLOCK ADDRESS DEFINITION                              70260021
BKS055   LR    R9,R8                                                    70266021
         AR    R8,R4                                                    70272021
         ST    R8,LOCCTR         )                                      70278021
         ST    R8,SAV01L           AND SAV01L                           70284021
         TM    ACCMTH,XX02         IS IT BISAM                          70290021
       BC    NOTONE,BKS056         NO                                   70296021
         TM    BUFOPT,XX10         S-R-A.                               70302021
         BO    BKS073              NO                                   70308021
         LA    R9,DX16(R9)         YES, ADDR. IS A(BUFFER)+16           70314021
       BC    UNCOND,BKS057         CONTINUE                             70320021
BKS056 EQU   *                                                          70326021
         TM    RCDFM,XX04          MODE V?                              70332021
         BZ    BKS057             NO.                                   70338021
         TM    RCDFM,XXC0           ADV                                 70344021
         BNZ   BKS057              NO                                   70350021
         LA    R9,DX8(R9)          YES. ADDRESS IS A(BUFFER)+8          70356021
BKS057   TM    RECFM,XX48           VRE                                 70362021
         BC    NOTONE,BKS059       BRANCH                               70368021
         L     R3,LOCDCB           YES, GEN A(AREA)                     70374021
         TM    ACCMTH,XX04          BSAM                                70380021
         BZ    BKS058              NO, QSAM                             70386021
         LA    R3,DX100(R3)         DCB + 100                           70392021
         L     R2,LOCCTR                                                70398021
         LA    R2,DX4(R2)           UPDATE VALUE BY 4 MORE              70404021
         ST    R2,LOCCTR           SAVE IT                              70410021
         ST    R2,SAV01L                                                70416021
         B     BKS58B              SKIP NEXT INSTRUCTION                70422021
BKS058   LA    R3,DX112(R3)                                             70428021
BKS58B   ST    R3,LITBUF                                                70434021
         MVI   LITBUF,XX2C          ADDRESS CONSTANT                    70440021
         ST    R9,LITBUF+NX4                                            70446021
         MVI   LITBUF+NX4,XX04      ADCON LENGTH                        70452021
         LA    R3,DX8               COUNT                               70458021
         LA    R2,LITBUF                                                70464021
         L     R1,COSADR                                                70470021
         BALR  R0,R1               GEN CONDEF                           70476021
         DC    X'14'                                                    70482021
         TM    ACCMTH,XX0E          QSAM                                70488021
         BZ    BKS066              YES, RETURN                          70494021
         L     R8,LOCCTR                                                70500021
         LA    R8,DX7(R8)                                               70506021
         N     R8,MK0129           GET ON DOUBLE WD                     70512021
         L     R3,LOCDCB           A(DCB)                               70518021
         LA    R3,DX92(R3)          DCB + 92                            70524021
         ST    R3,LITBUF                                                70530021
         MVI   LITBUF,XX2C          CODE                                70536021
         ST    R8,LITBUF+NX4        A(SEG WK AREA)                      70542021
         MVI   LITBUF+NX4,XX04      ADCON LENGTH                        70548021
         LA    R3,DX8               COUNT                               70554021
         LA    R2,LITBUF                                                70560021
         L     R1,COSADR                                                70566021
         BALR  R0,R1               GEN FOR DCB                          70572021
         DC    X'14'                                                    70578021
         ST    R8,LITBUF           TARGET ADDRESS                       70584021
         MVI   LITBUF,XX2C                                              70590021
         LA    R2,DX12(R8)          A (SEG WK AREA + 12)                70596021
         ST    R2,LITBUF+NX4                                            70602021
         MVI   LITBUF+NX4,XX04      ADCON COUNT                         70608021
         LA    R3,DX8                                                   70614021
         LA    R2,LITBUF                                                70620021
         L     R1,COSADR                                                70626021
         BALR  R0,R1               BR TO COMMON                         70632021
         DC    X'14'                                                    70638021
         LA    R8,DX4(R8)           A(SEG WK AREA + 4)                  70644021
         BAL   R6,BKS58D           GO GEN FIELDS                        70650021
         B     BKS58G              BRANCH                               70656021
BKS58D   ST    R8,LITBUF                                                70662021
         MVI   LITBUF,XX28          CODE                                70668021
         MVC   LITBUF+NX4(LX3),FOUR+NX1 COUNT                           70674021
         MVC   LITBUF+NX7(LX2),ONE+NX2 BUFNO = 1                        70680021
BKS58E   L     R4,MAXIM                                                 70686021
         LA    R4,DX8(R4)               PLUS 8                          70692021
         TM    SAMERS+NX11,XX0F    TRACK CAPACITY                       70698021
         BZ    BKS58F              NO                                   70704021
         SR    R2,R2               YES, FIND MINIMUM                    70710021
         IC    R2,SAMERS+NX11      KIND OF DEVICE                       70716021
         N     R2,MK0015           GET RID OF OTHER BITS                70722021
         LA    R1,TRKCAP           A(TABLE)                             70728021
         AR    R1,R2               POINT TO PROPER ENTRY                70734021
         CH    R4,DX0(R1)           WANT MINIMUM                        70740021
         BL    BKS58F              LRECL MIN                            70746021
         LH    R4,DX0(R1)           ADD TRACK CAPACITY                  70752021
BKS58F   LA    R4,DM10(R4)         ADD 10 FOR DATA MANG                 70758021
         STH   R4,FULLWD           SAVE TO GEN LATER                    70764021
         MVC   LITBUF+NX9(LX2),FULLWD                                   70770021
         LA    R3,DX11                                                  70776021
         LA    R2,LITBUF                                                70782021
         L     R1,COSADR                                                70788021
         BALR  R0,R1               BRANCH TO COMMON                     70794021
         DC    X'14'                                                    70800021
         BR    R6                  RETURN TO CALLER                     70806021
BKS58G   LA    R8,DX8(R8,R4)        MAXIM + 22                          70812021
         ST    R8,LOCCTR                                                70818021
         ST    R8,SAV01L                                                70824021
         LA    R9,DX8(R9)           AREA + 8                            70830021
BKS059   ST    R9,LITBUF                                                70836021
         MVI   LITBUF,XX0C          BLKADEF CODE                        70842021
         MVC   LITBUF+NX4(LX1),FD+NX2 BL= (FIRST FOR FD)                70848021
         MVC   LITBUF+NX5(LX2),FD+NX6 RPD=                              70854021
         L     R4,MAXIM                                                 70860021
         SRL   R4,DX2       SIZE IN WORDS-BDAM BLO ALSO                 70866021
         STH   R4,FULLWD                                                70872021
         MVC   LITBUF+NX7(LX2),FULLWD                                   70878021
BKS060   L     R1,COSADR                                                70884021
         LA    R2,LITBUF                                                70890021
         LA    R3,DX9                                                   70896021
         BALR  R0,R1               PUT OUT BLKADEF ON FILE 4            70902021
         DC    X'14'                                                    70908021
BKS066   L     R14,RS14B                                                70914021
         BCR   UNCOND,R14          RETURN                               70920021
* QUEUED FILE                                                           70926021
BKS072   TM    BUFOPT,XX10         S-R-A?                               70932021
         BO    SAMERCD            YES.                                  70938021
BKSQSM   TM    BUFOPT,XX20         S-A?                                 70944021
         BO    QSAME              YES.                                  70950021
BKSQSM1  TM    RCDFM,XXC1          S OR ADV?                            70956021
         BZ    BKS073              NO                                   70962021
         TM    RCDFM,XX01           S MODE                              70968021
         BZ    BKSQSMA             NO                                   70974021
         L     R3,LOCDCB           NO, SET BIT ON IN BUFTEX             70980021
         LA    R3,DX32(R3)          DCB + 32                            70986021
         ST    R3,LITBUF           ADDRESS                              70992021
         MVI   LITBUF,XX28          CODE                                70998021
         MVC   LITBUF+NX4(LX3),ONE+NX1 CONSTANT LENGTH                  71004021
         MVI   LITBUF+NX7,XX62                                          71010021
         LA    R2,LITBUF                                                71016021
         LA    R3,DX8                                                   71022021
         L     R1,COSADR                                                71028021
         BALR  R0,R1               BRANCH TO COMMON                     71034021
         DC    X'14'                                                    71040021
BKSQSMA  TM    BUFOPT,XX10          S-R-A                               71046021
         BO    BKS073              YES, RCD AREA PROCESSING IN  WSEND   71052021
         TM    BUFOPT,XX20          S-A                                 71058021
         BO    BKSQSMB             YES, PROCESS RCD AREA                71064021
         TM    RCDFM,XXC0           ADVANCING                           71070021
         BC    NOTMXD,BKS073       NO                             07878 71076021
*DEL                                                                    71082021
BKSQSMB  MVC   LOCCTR(LX4),SAV01L                                       71088021
         L     R8,LOCCTR                                                71094021
         TM    RCDFM,XX01           S                                   71100021
         BZ    BKSQSM2             NO                                   71106021
         N     R8,MK0930           YES, MAKE FULL NOT DOUBLE            71112021
         TM    LOCCTR+NX3,XX04      ON DOUBLE                           71118021
         BZ    BKSMSQ3             YES                                  71124021
         LA    R8,DX8(R8)           PUT ON NEXT FULL                    71130021
         B     BKSQSM6             PROCESS LIKE REST                    71136021
BKSMSQ3  LA    R8,DX4(R8)           GET OFF DOUBLE ON FULL              71142021
         B     BKSQSM6             PROCESS LIKE REST                    71148021
BKSQSM2  LA    R8,DX7(R8)           R8 ON F-WORD BOUNDARY               71154021
         N     R8,MK0129                                                71160021
BKSQSM6  L     R4,MAXIM                                                 71166021
         LA    R4,DX7(R4)                                               71172021
         N     R4,MK0129                                                71178021
         TM    RCDFM,XX01           S                                   71184021
         BZ    BKS055              NO                                   71190021
         LA    R4,DX36(R4)          YES, ADD 36                         71196021
         B     BKS055             GENERATE BLKDEF FOR RCD-AREA.         71202021
BKS073   L     R14,RS14B                                                71208021
         BR    R14                RETURN.                               71214021
BKS074   TM    RCDFM,XX01           S MODE                              71220021
         BZ    BKS073              NO, GO OUT                           71226021
         L     R8,LOCDCB           A(DCB)                               71232021
         LA    R8,DX104(R8)                   + 104                     71238021
         BAL   R6,BKS58D           GEN FIELDS                           71244021
         L     R8,PSAME                                                 71250021
         L     R8,DX0(R8)                                               71256021
         L     R8,DX0(R8)                                               71262021
         N     R8,MK0932           CLEAR TOP BYTE                       71268021
         A     R8,SMARPT           POINT TO PROPER ENTRY                71274021
         OI    DX11(R8),BASICS     S-A BASIC FILE S-MODE                71280021
         B     BKS073              RESTORE @, RETURN                    71286021
QSAME    LA    R4,DX7(R4)                                               71292021
         N     R4,MK0129          BUFLN=BLKSIZE  MOD 8                  71298021
         TM    ACCMTH,XX01         QISAM.                               71304021
         BZ    QSAME1             NO.                                   71310021
         LA    R4,DX16(R4)                                              71316021
QSAME1   L     R3,LOCDCB                                                71322021
         LA    R3,DX24(R3)         DCB BUFLN=DCB+24                     71328021
         ST    R3,LITBUF                                                71334021
         MVI   LITBUF,XX28           CODE                               71340021
         MVC   LITBUF+NX4,TWO+NX1   CONSTANT LGN                        71346021
         STH   R4,FULLWD                                                71352021
         MVC   LITBUF+NX7(LX2),FULLWD CONSTANT (BUFLN)                  71358021
         LA    R2,LITBUF                                                71364021
         LA    R3,DX9                                                   71370021
         L     R1,COSADR           PUT OUT CONDEF ON FILE 4             71376021
         BALR  R0,R1               BR TO COMMON                         71382021
         DC    X'14'                                                    71388021
         MVC   SAMERS+NX1(LX3),LOCDCB+NX1                               71394021
         TM    RCDFM,XXC1                                               71400021
         BZ    *+8                 SKIP NEXT INSTRUCTION                71406021
         OI    SAMERS+NX10,XX40    SET RECORD AREA BIT IN ENTRY.        71412021
         TM    RCDFM,XX01           S MODE                              71418021
         BZ    *+8                 NO                                   71424021
         OI    SAMERS+NX11,XX80    SET S-MODE BIT ON                    71430021
         BC    UNCOND,BKS078       CONTINUE PROCESSING                  71436021
*                                                                       71442021
*  SAME AREA CLAUSE GIVEN. BLKSIZE IS PUT INTO SAMETBL ENTRY.           71448021
*                                                                       71454021
BKS078   STH   R4,SAMERS+NX6        STORE BUFLN IN SAME AREA            71460021
         MVC   SAMERS+NX8(LX1),FD+NX2 1ST BL NO.                        71466021
         TM    RCDFM,XX04          V MODE?                              71472021
         BZ    *+8                 SKIP NEXT INSTRUCTION                71478021
         OI    SAMERS+NX10,XX80                                         71484021
         TM    PTBLSW,XX40          IS SAMETB PRIMED.                   71490021
         BC    ONES,BKS080            YES.                              71496021
         LA    R1,PSAME                PRIME SAMETB TABLE.              71502021
         L     R15,BPRIME                                               71508021
         BALR  R14,R15             BR TO PRIME RTN                      71514021
         OI    PTBLSW,XX40              AND SET SW TO INDICATE SO.      71520021
BKS080   L     R1,PSAME                                                 71526021
         L     R15,BINSRT                                               71532021
         BALR  R14,R15             BR TO INSERT RTN                     71538021
         L     R15,RS0                                                  71544021
         ST    R3,SMARPT          SAME TABLE DISPLACEMENT               71550021
         MVC   DX0(LX12,R2),SAMERS ENTER                                71556021
         TM    DX19(R10),XX03      BASIC FILE                           71562021
         BM    BKS087              YES                                  71568021
         B     BKSQSM1            NO.                                   71574021
BKS087   TM    BUFCAS+DX10,SMODE   S MODE                               71580021
         BZ    BKSKY0              NO                                   71586021
         MVC   DX1(DX3,R2),LOCDCB+NX1  CHANGE TO ADD OF DCB             71592021
         B     BKSKY0              CHECK IF KEY MUST BE RESOLVED        71598021
SAMERCD  OI    SAMERS+NX10,XX40                                         71604021
         MVC   SMRCDRS+NX4(LX2),MAXIM+NX2 FD MAX.                       71610021
         MVC   SMRCDRS+NX6(LX1),FD+NX2   1ST BL NO.                     71616021
         TM    RCDFM,XX05                                               71622021
         BZ    *+8                 SKIP NEXT INSTRUCTION                71628021
         OI    SMRCDRS+NX8,XX80                                         71634021
         TM    PRMSW,XX20               TBL PRIMED?                     71640021
         BO    SAMERCD1                YES.                             71646021
         LA    R1,PSMRCD               NO.                              71652021
         L     R15,BPRIME              PRIME SAME RCD TBL.              71658021
         BALR  R14,R15             BR TO PRIME RTN                      71664021
         OI    PRMSW,XX20               TBL  PRIMED BIT ON.             71670021
SAMERCD1 L     R1,PSMRCD                                                71676021
         L     R15,BINSRT                                               71682021
         BALR  R14,R15             INSERT ENTRY INTO TBL                71688021
         L     R15,RS0                                                  71694021
         MVC   DX0(LX10,R2),SMRCDRS  MOVE ENTRY INTO TBL                71700021
         ST    R3,SMRCPT               SM RCD TBL DISPLACEMENT          71706021
         TM    DX19(R10),XX03           BASIC FILE?                     71712021
         BM    SAMERCD4            YES                                  71718021
         BO    BKSSM1              TEST FOR SAME AREA                   71724021
         TM    RCDFM,SMODE         S MODE                               71730021
         BZ    BKSQSM              NO                                   71736021
         OI    DX7(R2),QSMODE      QSAM S BIT                           71742021
         TM    BUFOPT,XX20          S-A                                 71748021
         BO    BKSQSM              BRANCH TO BKSQSM                     71754021
         MVC   LOCCTR(LX4),SAV01L                                       71760021
         L     R8,LOCCTR                                                71766021
         LA    R8,DX7(R8)           R8 ON WORD BOUNDARY                 71772021
         N     R8,MK0129                                                71778021
         LR    R9,R8                                                    71784021
         LH    R7,SAMERS+NX4        BUFNO                               71790021
         MVC   MTEMP1(LX2),LITBUF+NX7 BLKSZE                            71796021
         LH    R5,MTEMP1                                                71802021
         ST    R9,LITBUF+NX4        A(EXT BUFCB)                        71808021
         MVI   LITBUF+NX4,XX03      COUNT                               71814021
         L     R1,LOCDCB           A(DCB)                               71820021
         LA    R1,DX21(R1)                                              71826021
         ST    R1,LITBUF           DCB + 21                             71832021
         MVI   LITBUF,XX2C          CODE                                71838021
         LA    R2,LITBUF                                                71844021
         LA    R3,DX8                                                   71850021
         L     R1,COSADR                                                71856021
         BALR  R0,R1               GEN A( EXT BUFCB)                    71862021
         DC    X'14'                                                    71868021
         ST    R9,LITBUF+NX4        BUFFER START                        71874021
         L     R3,LOCDCB                                                71880021
         LA    R3,DX104(R3)         DCB + 104                           71886021
         ST    R3,LITBUF                                                71892021
         MVI   LITBUF,XX2C          CODE                                71898021
         LA    R8,DX12(R8)          POINTS TO START OF BUFFER           71904021
*                                                                       71910021
         MVI   LITBUF+NX4,XX04      COUNT                               71916021
         LA    R2,LITBUF                                                71922021
         LA    R3,DX8                                                   71928021
         L     R1,COSADR                                                71934021
         BALR  R0,R1               GEN A(BUFF)                          71940021
         DC    X'14'                                                    71946021
         L     R3,LOCDCB                                                71952021
         LA    R3,DX108(R3)           DCB + 108                         71958021
         ST    R3,LITBUF                                                71964021
         MVI   LITBUF,XX28          CODE                                71970021
         MVC   LITBUF+NX4(LX3),NINE+NX1                                 71976021
         MVI   LITBUF+NX7,XX00                                          71982021
         STC   R7,LITBUF+NX8        BUFNO                               71988021
         STH   R5,MTEMP1                                                71994021
         MVC   LITBUF+NX9(LX2),MTEMP1 BUFLN                             72000021
         MVI   LITBUF+NX15,XX80     FLAG BYTE                           72006021
         LA    R2,LITBUF                                                72012021
         LA    R3,DX16                                                  72018021
         L     R1,COSADR                                                72024021
         BALR  R0,R1               GEN BUFFER FIELDS                    72030021
         DC    X'14'                                                    72036021
         L     R3,LOCDCB                                                72042021
         LA    R3,DX24(R3)          DCB + 24                            72048021
         ST    R3,LITBUF                                                72054021
         MVI   LITBUF,XX28          CODE                                72060021
         MVC   LITBUF+NX4,TWO+NX1   LENGTH                              72066021
         MVC   LITBUF+NX7(LX2),MTEMP1   BUFLN                           72072021
         LA    R2,LITBUF                                                72078021
         LA    R3,DX9               COUNT                               72084021
         L     R1,COSADR                                                72090021
         BALR  R0,R1               GO GEN ELEMENT                       72096021
         DC    X'14'                                                    72102021
         STH   R7,MTEMP1                                                72108021
         MH    R5,MTEMP1           LENGTH OF BUFFER                     72114021
         LA    R8,DX6(R8,R5)        POINTS TO END OF BUFFER             72120021
         ST    R8,LOCCTR                                                72126021
         ST    R8,SAV01L                                                72132021
         B     BKSQSM              RETURN                               72138021
SAMERCD4 TM    BUFCAS+NX10,XX01     S-MODE                              72144021
         BC    NOTONE,BKSKY0       NO                                   72150021
         TM    DX8(R2),XX04         BSAM                                72156021
         BZ    BKSSM1              NO                                   72162021
         MVC   DX1(DX3,R2),LOCDCB+NX1 CHANGE TO ADD OF DCB              72168021
         OI    DX7(R2),XX40        BSAM S-MODE                          72174021
         B     BKSSM1              TEST FOR SAME AREA (QUEUED)          72180021
BKS130   L     R7,BSMPAR           R7= A(BSAM TABLE TIB)                72186021
         L     R8,DX0(R7)                                               72192021
         L     R7,DX0(R8)                                               72198021
         N     R7,MK0932                                                72204021
         L     R8,BSAMPS                                                72210021
         N     R8,MK0932                                                72216021
         AR    R7,R8                                                    72222021
         MVC   DX0(LX2,R7),MTEMP1+NX2 MOVE BLKSIZE TO BSAMTB (TABLE)    72228021
         MVC   DX2(LX1,R7),FD+NX2    MOVE 1ST BL OF FD TO TABLE         72234021
         MVC   DX6(LX8,R7),SMARPT   MOVE SAME AREA TBLS PTR INTO TBL.   72240021
         MVC   DX14(LX3,R7),LASTDP+NX1 MOVE DICTIONARY PTR FOR FD.      72246021
         NI    SAMERS+NX11,XX0F    TURN OFF OTHER BITS                  72252021
         OC    DX17(LX1,R7),SAMERS+NX11  TRACK CAPACITY                 72258021
         TM    RCDFM,XX04          V-MODE?                              72264021
         BZ    *+8                NO.                                   72270021
         OI    DX14(R7),XX40       YES, SET V BIT IN TABLE ENTRY.       72276021
         TM    RCDFM,SMODE         S MODE                               72282021
         BZ    BKS140              NO                                   72288021
         TM    ACCMTH,BSAM         BSAM                                 72294021
         BZ    BKS135              NO, BDAM                             72300021
         OI    X17(R7),BSAMS       SET BIT ON                           72306021
         B     BKS140              RETURN                               72312021
BKS135   OI    X17(R7),SBDAM       SET BIT ON                           72318021
BKS140   L     R14,RS14B                                                72324021
         BCR   UNCOND,R14          RETURN                               72330021
*                                                                       72336021
*                                                                       72342021
*  BLOCK-CONTAINS CLAUSE NOT PRESENT. RECORDING MODE = F.               72348021
*                                                                       72354021
BKS200   L     R4,MAXIM           MODE F                                72360021
         B     BKS020              TEST FOR VALID BLKSIZE               72366021
*                                                                       72372021
*  BLOCK CONTAINS RECORDS.                                              72378021
*                                                                       72384021
BKS300   LH    R4,BKCON2                                                72390021
BKS301   LTR   R4,R4              BLOCK CONTAINS 0 RECORDS?             72396021
         BP    BKS303             NO - OK                               72402021
         TM    BUFOPT,XX20         YES. SAME AREA?                      72408021
         BO    BKS302                  YES - ERROR.                     72414021
         TM    ACCMTH,XX02         BISAM?                               72420021
         BO    BKS302             YES - ERROR.                          72426021
*        LA    R0,X'00BC'         NO - LEAVE BLKSI ZERO.                72432021
*        L     R15,AERRTN         MSG NO. 188 WARNING.                  72438021
*        BALR  R14,R15            BLK CONTAINS 0 RECORDS SPECIFIED      72444021
*        L     R15,RS0            BLKSI MUST BE SPECIFIED IN DD         72450021
         B     BKS020             CARD.                                 72456021
BKS302   LA    R0,X'00BD'         MSG NO. 189 ERROR.                    72462021
         L     R15,AERRTN         BLK CONTAIN 0 RECORDS CLAUSE          72468021
         BALR  R14,R15            ILLEGAL FOR BISAM OR WITH SAME        72474021
         L     R15,RS0            AREA CLAUSE. BLOCK CONTAINS           72480021
         NI    BLKLBL,XXE7                                              72486021
         B     BKS010              PROCESS BLKSIZE                      72492021
*              ONLY F,V MODE REACHES HERE. U,S DELETED BY NOW.          72498021
BKS303   L     R4,MAXIM           MODE IS FOR S.                        72504021
         TM    RCDFM,XX04          V?                                   72510021
         BZ    *+8                 SKIP NEXT INSTRUCTION                72516021
         LA    R4,DX4(R4)                                               72522021
         MH    R4,BKCON2                                                72528021
         TM    RCDFM,XX04          MODE V?                              72534021
         BZ    BKS020              NO                                   72540021
         LA    R4,DX4(R4)                                               72546021
         B     BKS020              YES                                  72552021
*                                                                       72558021
*  BLOCK CONTAINS CHARACTERS.                                           72564021
*                                                                       72570021
BKS350   LH    R4,BKCON2                INTEGER 2                 51301 72576021
         LTR   R4,R4                    BLK CONTAINS 0 CHARS      51301 72582021
         BP    BKS355                      NO  -  OK              51301 72588021
         TM    BUFOPT,XX20               YES- IS IT SAME AREA     51301 72594021
         BO    BKS302                    YES, ERROR               51301 72600021
         TM    ACCMTH,XX02              IS IT BISAM               51301 72606021
         BO    BKS302                   YES, ERROR                51301 72612021
         B     BKS020                     BR                      51301 72618021
BKS355   SR    R4,R4                       CLEAR R4               51301 72624021
         TM    RCDFM,XX08          F?                                   72630021
         BO    BKS370              YES                                  72636021
         TM    RCDFM,XX05               RECORDING MODE V OR S     41529 72642021
         BM    BKS360                   BR TO BKS360              41529 72648021
         L     R4,FOUR                                                  72654021
BKS360   AH    R4,BKCON2                                                72660021
         C     R4,FOUR             LENGTH OF BLKSIZE = 4          38294 72666021
         BH    BKS020              BLKSIZE GREATER THAN 0         38294 72672021
         L     R4,ZEROS            IT IS BLOCK CONTAINS ZERO      38294 72678021
         B     BKS020              TEST FOR VALID BLKSIZE               72684021
BKS370   LH    R5,BKCON2                                                72690021
         CLC   MAXIM(LX4),ZEROS    IS LRECL IS ZERO LENGTH        40624 72696021
         BE    BKS020                   YES-DONT CHK BLK FACTOR   40624 72702021
       D     R4,MAXIM                                                   72708021
       C     R4,ZEROS              IS BLOCK SIZE DIVISIBLE BY LRECL     72714021
       BC    EQ,BKS360               YES - OK                           72720021
       A     R5,ONE                NO-ADD 1 TO NUMBER OF BLOCKS         72726021
       M     R4,MAXIM              MULTIPLY BY NUMBER OF BYTES          72732021
       LR    R4,R5                                                      72738021
         LA    R0,DX95              95  BLOCK CONTAINS HAS WRONG        72744021
       SR    R1,R1                     NUMBER OF BYTES                  72750021
       L     R15,AERRTN                                                 72756021
       BALR  R14,R15               ERROR RTN                            72762021
       L     R15,RS0                                                    72768021
       BC    UNCOND,BKS020         TEST FOR VALID BLKSIZE               72774021
BKSS20   B     BKS020             S MODE. R4=MAXIM=BLKSI                72780021
         EJECT                                                          72786021
*=2      FSEND- END OF FILE SECTION- KEY TABLES SAME TABLE              72792021
*  THIS ROUTINE DOES END OF FILE SECTION PROCESSING, THEY INCLUDE -     72798021
*     1. CALLS SAME ROUTINE TO PROCESS SAMTBL ENTRIES, IF ANY.          72804021
*     2. PROCESS KEYRAN TABLE WHEN KEYS ARE PRESENT IN ASYCHRONOUS      72810021
*        PROCESSING.  KEY LENGTH IS PUT INTO DCB AND KEY ADDRESS IS     72816021
*        PUT INTO EACH DECB.                                            72822021
*     3. KEY LENGTH, IF ANY, IS ADDED TO BLKSIZ, AND BLKADEF IS PUT     72828021
*        OUT ON A-TEXT FILE.                                            72834021
*                                                                       72840021
IKF213B  CSECT                                                          72846021
       USING *,R15                                                      72852021
FSEND    ST    R14,FSESAV                                               72858021
         MVC   CARDXX(LX2),CARDNO   SAVE CURRENT CARD NUMBER            72864021
         MVC   PLBLSW(LX1),LBLSW                                        72870021
         NI    LBLSW,XX00                                               72876021
         MVC   LSTQUL(LX3),HIQUAL  SAVE DICT PTR                        72882021
         SR    R14,R14                     CLEAR REG 14           45078 72888021
         IC    R14,PRDCBNO              PRESENT DCB NO            45078 72894021
         LA    R14,DX1(R14)             INCR FLD FOR PURPOSES OF  45078 72900021
         STC   R14,PRDCBNO              RESOLVING PREV GRP,IF ANY 45078 72906021
         L     R15,AFST00          PROCESS THE LAST FD.                 72912021
         BALR  R14,R15             PROCESS FD                           72918021
         L     R15,AFSEND                                               72924021
         CLC   BLLSAVE(LX2),BLLCTR                                      72930021
         BNL   *+10                SKIP NEXT INSTRUCTION                72936021
         MVC   BLLSAVE(LX2),BLLCTR                                      72942021
         TM    FES,XX20             WAS THERE REDEFINES IN LAST FD      72948021
         BC    NOTONE,FSE005         NO                                 72954021
         L     R1,RDFPAR           YES,DELETE ALL BUT                   72960021
         L     R1,DX0(R1)             DUMMY RDFSTK ENTRY                72966021
         MVC   DX4(LX2,R1),TWELVE+NX2                                   72972021
         L     R1,RNMPAR           DELETE ALL BUT                       72978021
         L     R1,DX0(R1)             DUMMY RNMTBL ENTRY                72984021
         MVC   DX4(LX2,R1),FIVE+NX2                                     72990021
FSE005   NI    FSTSW,XXDF           SET OFF END-OF-FILE-SECTION SW      72996021
FSE205   TM    PTBLSW,XX04          ARE THERE ANY RECORD KEYS TO PRO    73002021
         BC    ZERO,FSE210         NO, BRANCH                           73008021
*                                  YES                                  73014021
         L     R4,RPARAM           R4= A(TIB)                           73020021
         L     R4,DX0(R4)           R4= A(TAMM)                         73026021
         LH    R5,DX4(R4)           R5= SIZE OF TABLE                   73032021
         L     R4,DX0(R4)           R4= A(TABLE)                        73038021
         N     R4,MK0932                                                73044021
         AR    R5,R4               R5= A(EOT)                           73050021
FSE206   LR    R1,R4                                                    73056021
         L     R15,AQUAL           CALL QUAL TO FIND KEY AND ITS LG     73062021
         BALR  R14,R15             BR TO QUAL RTN                       73068021
         LTR   R14,R15                                                  73074021
         L     R15,AFSEND                                               73080021
         BC    ZERO,FS206A         KEY FOUND                            73086021
         MVC   FULLWD(LX2),DX0(R4)   UP R4 TO DATA                      73092021
         LH    R3,FULLWD              PART OF ENTRY                     73098021
         LA    R4,DX2(R4,R3)                                            73104021
         MVC   CARDNO(LX2),DX8(R4)   GET KEY CARD NO.                   73110021
       C       R14,FOUR                                                 73116021
       BC      EQ,FS206Y           NOT FOUND-MSG GIVEN BY CHEKEY        73122021
         C     R14,EIGHT                                                73128021
         BE    FS206X              ERROR                                73134021
         NI    WKAREA+NX36,XXF0   WAS KEY VARIABLE LENGTH         59737 73140021
         CLI   WKAREA+NX36,XX40                                   59737 73146021
       BC      NOTEQ,FS206X         NO                                  73152021
       BAL     R6,FSERR             YES - ERROR 179                     73158021
       DC      X'20B3'                                                  73164021
       BC      UNCOND,FS206Y       CONTINUE                             73170021
FS206X EQU     *                                                        73176021
         BAL   R6,FSERR            KEY NOT OFUND                        73182021
         DC    X'2083'             131                                  73188021
FS206Y EQU     *                                                        73194021
         LA    R4,DX11(R4)         INCR RCKTBL POINTER            58357 73200021
         BC    UNCOND,FSE207       TEST FOR EOT                         73206021
*                                  FOUND KEY PUT OUT  KEYLEN RKP        73212021
FS206A   MVC   FULLWD(LX2),DX0(R4)                                      73218021
         LH    R3,FULLWD                                                73224021
         LA    R6,DX2(R4,R3)        R6= A(KEY DATA)                     73230021
         MVC   CARDNO(LX2),DX8(R6)                                      73236021
         C     R1,CON256           IS KEYLEN GT 255                     73242021
         BC    LO,FSE209           NO                                   73248021
       LR    R4,R6                                                      73254021
         BAL   R6,FSERR            ERROR                                73260021
         DC    X'2084'             132                                  73266021
         LA    R1,DX255        SUBSTITUTE 255                           73272021
       LR    R6,R4                                                      73278021
       BC    UNCOND,FSE209         CONTINUE                             73284021
FSE207   CR    R4,R5               EOT                                  73290021
         BC    NOTLO,FSE208        YES                                  73296021
         BC    UNCOND,FSE206       NO                                   73302021
FSE208   L     R1,RPARAM                                                73308021
         L     R15,BTABRL                                               73314021
         BALR  R14,R15             RELEASE TABLE                        73320021
         L     R15,AFSEND                                               73326021
         BC    UNCOND,FSE210       CONTINUE PROCESSING                  73332021
FSE209   MVI   LITBUF,XX28          CONDEF CODE                         73338021
         MVC   LITBUF+NX1(LX3),DX1(R6) REL. LOC. OF CONDEF              73344021
         MVC   LITBUF+NX4(LX3),ONE+NX1 CODE=0,  LGN=1                   73350021
         STC   R1,LITBUF+NX7        KEYLEN                              73356021
         LA    R3,DX8                                                   73362021
         BAL   R4,FS209A           PUT OUT CONDEF FOR KEYLEN            73368021
         MVC   LITBUF+NX1(LX3),DX5(R6) REL. LOC. OF CONDEF              73374021
         MVI   LITBUF+NX6,XX02      LGN=2                               73380021
         L     R2,WKAREA+NX36                                           73386021
         N     R2,MK2532                LEAVE ONLY BL NO IN R2    51326 73392021
         SR    R3,R3                    CLEAR R3 AND GET          51326 73398021
         IC    R3,DX10(R6)              1ST BL NO OF FILE         51326 73404021
         SR    R2,R3                    CALCULATE RELATIVE        51326 73410021
         MH    R2,CO4096+NX2               LOCATION OF            51326 73416021
         L     R3,WKAREA+NX36               KEY  -                51326 73422021
         SRL   R3,DX8                   (NO OF BL'S)*4096         51326 73428021
         N     R3,MK2132                       + DISP             51326 73434021
         AR    R2,R3                                              51326 73440021
       STH   R2,FULLWD                                                  73446021
         MVC   LITBUF+NX7(LX2),FULLWD RKP                               73452021
         LA    R3,DX9                                                   73458021
         BAL   R4,FS209A           PUT OUT CONDEF FOR RKP               73464021
         LA    R6,DX11(R6)              ADD FIXED PORTION SIZE    51326 73470021
         LR    R4,R6                                                    73476021
         BC    UNCOND,FSE207       CHECK FOR EOT                        73482021
FS209A   LA    R2,LITBUF                                                73488021
         LR    R1,R11                                                   73494021
         BALR  R0,R1               BR TO COMMON                         73500021
         DC    X'14'                                                    73506021
         BCR   UNCOND,R4           CONTINUE                             73512021
FSE210   L     R14,FSESAV                                               73518021
         MVC   CARDNO(LX2),CARDXX   RESTORE CURRENT CARD NO.            73524021
         MVC   WS(LX4),SAV01L                                           73530021
         MVC   LOCCTR(LX4),SAV01L                                       73536021
         XC    APAF(LX7),APAF       RESET APAF IF CHANGED BY XTEN RT    73542021
         MVC   APAF+NX2(LX1),FAPAF+NX2 RESET BL=                        73548021
         BCR   UNCOND,R14          RETURN                               73554021
FSERR    STM   R0,R3,LITBUF+NX112     SAVE REGS IN LITBUF +27 WDS.      73560021
         LH    R0,DX0(R6)           GET ERROR NUMBER.                   73566021
         L     R15,AERRTN                                               73572021
         BALR  R14,R15             ERROR                                73578021
         LM    R0,R3,LITBUF+NX112                                       73584021
         L     R15,AFSEND                                               73590021
         LA    R6,DX2(R6)                                               73596021
         BCR   UNCOND,R6           RETURN                               73602021
*=2      SAME  - SAME AREA CLAUSE                                       73608021
         EJECT                                                          73614021
*  THIS ROUTINE PROCESSES THE 'SAME AREA' CLAUSE OF FILE SECTION.       73620021
*    FILES WITH THE SAME AREA CLAUSE ARE ASSIGNED THE SAME MAIN STO     73626021
*    AREA FOR PROCESSING.                                               73632021
*                                                                       73638021
         USING *,R15                                                    73644021
SAME     EQU   *                                                        73650021
         ST    R14,RS14                                                 73656021
         L     R7,PSAME            A(TIB)                               73662021
         L     R8,DX0(R7)           A(TAMM)                             73668021
         L     R7,DX0(R8)           A(TABLE)                            73674021
         N     R7,MK0932                                                73680021
         SR    R2,R2                                                    73686021
         LH    R3,DX4(R8)           R3= TABLE SIZE                      73692021
         D     R2,SAMELN           R3 = NO OF ENTRIES                   73698021
         LR    R9,R3                                                    73704021
         LR    R6,R7                                                    73710021
         AH    R6,DX4(R8)           R6= ADDRESS OF END OF TABLE         73716021
         LR    R8,R7               R8= A(TABLE)                         73722021
SAM000   XC    SAMLGN(LX4),SAMLGN                                       73728021
         MVC   WKAR(LX1),DX0(R7)     WKAR = SAME AREA UNIQUE =          73734021
SAM001 BCTR  R9,R0                 SUBTRACT 1 FROM R9                   73740021
         SR    R5,R5                                                    73746021
         IC    R5,DX9(R7)                                               73752021
         AH    R5,DX6(R7)                                               73758021
         MH    R5,DX4(R7)                                               73764021
SAM010   TM    DX10(R7),XX0E       FOR QUEUED ADD 8 FOR BUFCB           73770021
         BC    NOTZER,SAM030       NO, NOT QUEUED                       73776021
         A     R5,EIGHT                                                 73782021
         TM    DX11(R7),QSMODE     SPANNED                              73788021
         BZ    SAM030              NO                                   73794021
         LA    R5,DX4(R5)           YES, ADD 4 MORE                     73800021
SAM030   TM    DX11(R7),BASICS     BASIC FILE S-MODE                    73806021
         BZ    SAM035              NO                                   73812021
         LA    R5,DM22(R5)         ADD 22 FOR BUFCB                     73818021
BLKBSAM  EQU   4                                                        73824021
DM10     EQU   10                                                       73830021
DM22     EQU   22                                                       73836021
BLKOFF   EQU   X'E7'                                                    73842021
SAM035   CL    R5,SAMLGN                                                73848021
         BC    NOTHI,SAM040        CONTINUE                             73854021
         ST    R5,SAMLGN           SAMLGN= LARGEST BUFFER POOL SIZE     73860021
SAM040   A     R7,SAMELN           GET NEXT ENTRY                       73866021
         CR    R6,R7                                                    73872021
         BC    NOTHI,SAM080        END OF TABLE FOR A  UNIQUE =         73878021
SAM050   CLC   WKAR(LX1),DX0(R7)     SAME UNIQUE =                      73884021
         BC    EQ,SAM001           YES                                  73890021
         BC    NOTEQ,SAM040        NO                                   73896021
SAM080   LR    R7,R8               SEARCH TABLE FOR ALL ENTRIES OF      73902021
*                                   UNIQUE = THAT SAMLGN WAS JUST       73908021
*                                   CALCULATED FOR.                     73914021
SAM085   CLC   DX0(LX1,R7),WKAR      IS THIS ONE OF THEM                73920021
         BE    SAM116             YES.                                  73926021
SAM090   A     R7,SAMELN           NO                                   73932021
         CR    R7,R6               END OF TABLE                         73938021
         BC    LO,SAM085           NO                                   73944021
         BC    UNCOND,SAM140       YES                                  73950021
SAM099   ST    R1,KEYLOC           YES                                  73956021
SAM100   MVI   DX0(R7),XX00         ZERO UNIQUE = SO IT IS NOT USED     73962021
*                                    AGAIN ON NEXT SEARCH OF TABLE      73968021
         MVC   FULLWD(LX4),DX0(R7)                                      73974021
         L     R12,FULLWD          R12= TARGET ADD.-A(BUFCB)/A(BUFF     73980021
         TM    DX10(R7),XX0E                                            73986021
         BM    SAM101              YES. IT IS BDAM,BSAM OR BISAM        73992021
         L     R12,FULLWD                                               73998021
         LA    R12,DX108(R12)           DCB+108                         74004021
         TM    DX10(R7),XX01                                            74010021
         BZ    *+8                 SKIP NEXT INSTRUCTION                74016021
         LA    R12,DX144(R12)       INCREMENT FOR QISAM                 74022021
         ST    R12,LITBUF                                               74028021
         MVI   LITBUF,XX28                                              74034021
         MVC   LITBUF+NX7(LX4),DX4(R7)                                  74040021
         TM    DX11(R7),QSMODE     SPANNED                              74046021
         BZ    SAM10A              NO                                   74052021
         MVC   LITBUF+NX4(LX3),NINE+NX1 YES                             74058021
         LA    R3,DX16              COUNT                               74064021
         MVI   LITBUF+NX15,XX80     INDICATE SA - S                     74070021
         B     SAM10C                                                   74076021
SAM10A   MVC   LITBUF+NX4(LX3),FOUR+NX1 COUNT                           74082021
         LA    R3,DX11              TOTAL COUNT                         74088021
SAM10C   LA    R2,LITBUF                                                74094021
         LR    R1,RCOM                                                  74100021
         BALR  R0,R1               BR TO COMMON                         74106021
         DC    X'14'                                                    74112021
         L     R12,FULLWD          A(DCB)                               74118021
         LA    R12,DX20(R12)        DCB + 20                            74124021
         ST    R12,LITBUF                                               74130021
         MVI   LITBUF,XX28          CODE                                74136021
         MVC   LITBUF+NX4(LX3),ONE+NX1 ONE BYTE FIELD                   74142021
         MVC   LITBUF+NX7(LX1),LITBUF+NX8                               74148021
         LA    R3,DX8               COUNT                               74154021
         LA    R2,LITBUF                                                74160021
         LR    R1,RCOM                                                  74166021
         BALR  R0,R1               BR TO COMMON                         74172021
         DC    X'14'                                                    74178021
         L     R12,FULLWD                                               74184021
         LA    R12,DX8(R12)                                             74190021
SAM101   TM    DX11(R7),BASICS     BASIC FILE S-MODE                    74196021
         BZ    SAM102              NO                                   74202021
         OI    SAMESW,BASICS       TURN BASIC SW ON                     74208021
         LA    R12,DX80(R12)        DCB + 92                            74214021
         TM    DX10(R7),XX04        BSAM                                74220021
         BO    SAM102              YES, GO OUT                          74226021
         LA    R12,DX8(R12)         NO, BDAM ADD 8 MORE                 74232021
SAM102   LA    R12,DX13(R12)                                            74238021
         LH    R5,DX6(R7)           R5 = BUFLN /BLOCK LGN               74244021
SAM105   L     R1,KEYLOC                                                74250021
SAM107   ST    R12,LITBUF          TARGET                               74256021
         ST    R1,LITBUF+NX4                                            74262021
         MVI   LITBUF,XX2C                                              74268021
SAM109   MVI   LITBUF+NX4,XX03                                          74274021
         LA    R2,LITBUF                                                74280021
         LA    R3,DX8                                                   74286021
         L     R1,COSADR                                                74292021
         BALR  R0,R1               BR TO COMMON                         74298021
         DC    X'14'                                                    74304021
         TM    DX11(R7),QSMODE     QSAM S                               74310021
         BZ    SAM090              NO                                   74316021
         LA    R12,DX83(R12)        DCB + 104                           74322021
         ST    R12,LITBUF                                               74328021
         MVI   LITBUF,XX2C                                              74334021
         MVI   LITBUF+NX4,XX04      COUNT                               74340021
         LA    R2,LITBUF                                                74346021
         LA    R3,DX8                                                   74352021
         L     R1,COSADR                                                74358021
         BALR  R0,R1               GO GEN A(BUFF)                       74364021
         DC    X'14'                                                    74370021
         B     SAM090              CHECK FOR EOT                        74376021
SAM116   L     R1,LOCCTR                                                74382021
         A     R1,SEVEN                                                 74388021
         N     R1,MK0129                                                74394021
         ST    R1,TSAVER                                                74400021
         SR    R2,R2                                                    74406021
         TM    DX11(R7),BASICS     BASIC FILE S-MODE                    74412021
         BO    SAM099              YES                                  74418021
         TM    DX10(R7),XX02       IS IT BISAM                          74424021
       BC    NOTONE,SAM117         NO                                   74430021
         LA    R1,DX16(R1)         YES, ADDR. IS A(BUFFER)+16           74436021
       BC    UNCOND,SAM118         CONTINUE PROCESSING                  74442021
SAM117 EQU   *                                                          74448021
         IC    R2,DX9(R7)                                               74454021
         TM    DX10(R7),XX80                                            74460021
         BZ    *+8                 SKIP NEXT INSTRUCTION                74466021
         LA    R2,DX8(R2)                                               74472021
         AR    R1,R2                                                    74478021
         A     R1,SEVEN                                                 74484021
         N     R1,MK0129                                                74490021
SAM118   ST    R1,LITBUF           A(RECORD IN BUFFER)                  74496021
         MVI   LITBUF,XX0C                                              74502021
         SR    R1,R2                                                    74508021
         IC    R2,DX9(R7)          KEYLNG.                              74514021
         TM    DX10(R7),XX08       BDAM?                                74520021
         BZ    *+6                 SKIP NEXT INSTRUCTION                74526021
         AR    R1,R2              YES, ADD KEYLNG BACK.                 74532021
         ST    R1,KEYLOC                                                74538021
         MVC   LITBUF+NX4(LX1),DX8(R7) BL NO.                           74544021
         XC    LITBUF+NX5(LX4),LITBUF+NX5                               74550021
         TM    DX10(R7),XX0E                                            74556021
         BZ    SAM100              YES. IT IS A QUEUED FILE.            74562021
         TM    DX10(R7),XX40                                            74568021
         BZ    SAM120              NOT SPANNED RCD,ADV,OR SRA           74574021
         TM    DX10(R7),XX42                                            74580021
         BO    SAM100              YES,IT IS BISAM & SR,ADV OR SRA      74586021
SAM120   L     R1,COSADR                                                74592021
         LA    R2,LITBUF                                                74598021
         LA    R3,DX9                                                   74604021
         BALR  R0,R1               BR TO COMMON                         74610021
         DC    X'14'                                                    74616021
         B     SAM100              ZERO SAME AREA NO AND PROCESS        74622021
SAM140   L     R4,TSAVER           UPDAYE LOCCTR-- A( BUFFER POOL )     74628021
         A     R4,SAMLGN            BY BUFFER POOL LENGTH (MAX)         74634021
         A     R4,SEVEN                                                 74640021
         ST    R4,LOCCTR         )  RESTORE LOCCTR                      74646021
         TM    SAMESW,BASICS       WAS THERE BASIC FILE S MODE          74652021
         BZ    SAM145              NOS BASIC FILE S MODE                74658021
         XC    SAMESW(LX1),SAMESW   YES TURN OFF SW                     74664021
         L     R1,KEYLOC           A (SEG WK AREA)                      74670021
         ST    R1,LITBUF                                                74676021
         MVI   LITBUF,XX2C                                              74682021
         LA    R1,DX12(R1)                        + 12                  74688021
         ST    R1,LITBUF+NX4                                            74694021
         MVI   LITBUF+NX4,XX04      ADCON COUNT                         74700021
         LA    R3,DX8                                                   74706021
         LA    R2,LITBUF                                                74712021
         L     R1,COSADR                                                74718021
         BALR  R0,R1               BR TO COMMON                         74724021
         DC    X'14'                                                    74730021
SAM145   CL    R9,ZEROS                                                 74736021
         BC    EQ,SAM160           BR TO EOT RTN                        74742021
SAM150   LR    R7,R8                                                    74748021
SAM151   CLI   DX0(R7),XX00                                             74754021
         BC    NOTEQ,SAM000        BR TO BEGINNING OF SA RTN            74760021
         A     R7,SAMELN                                                74766021
         CR    R7,R6                                                    74772021
         BNL   SAM160              EOT RTN                              74778021
         BC    UNCOND,SAM151       CHECK NEXT ENTRY                     74784021
*                                                                       74790021
SAM160   NI    PTBLSW,XXBF          RELEASE SAME TABLE AND SET SW, E    74796021
         L     R1,PSAME                                                 74802021
         ST    R15,TSAVER                                               74808021
         L     R15,BTABRL                                               74814021
         BALR  R14,R15             RELEASE SAME AREA TABLE              74820021
         L     R15,TSAVER                                               74826021
         L     R8,LOCCTR         )                                      74832021
         A     R8,SEVEN                                                 74838021
         N     R8,MK0129                                                74844021
         ST    R8,LOCCTR                                                74850021
         L     R14,RS14                                                 74856021
         BCR   UNCOND,R14          RETURN                               74862021
         EJECT                                                          74868021
* THIS ROUTINE PROCESSES 'SAME RECORD AREA' TABL                        74874021
         USING *,R15                                                    74880021
SAMER    ST    R14,RS14                                                 74886021
         L     R7,PSMRCD                                                74892021
         L     R8,DX0(R7)                                               74898021
         L     R7,DX0(R8)                                               74904021
         N     R7,MK0932          A(TABLE)                              74910021
         SR    R2,R2                                                    74916021
         LH    R3,DX4(R8)          TABLE SIZE                           74922021
         D     R2,SRTBLN           R3 = NO OF ENTRIES                   74928021
         LR    R9,R3                                                    74934021
         LR    R6,R7                                                    74940021
         AH    R6,DX4(R8)          R6=A(EOT)                            74946021
         LR    R8,R7                                                    74952021
SAMR000  XC    SAMLGN(LX8),SAMLGN                                       74958021
         MVC   WKAR(LX1),DX0(R7)                                        74964021
SAMR001  LH    R5,DX4(R7)          FDMAX                                74970021
         BCTR  R9,R0               SUBTRACT 1 FROM NO OF ENTRIES        74976021
         CL    R5,SAMLGN                                                74982021
         BNH   *+8                 SKIP NEXT INSTRUCTION                74988021
         ST    R5,SAMLGN                                                74994021
         TM    DX8(R7),XX0C        BSAM OR BDAM                         75000021
         BZ    SAMR003            NO.                                   75006021
         SR    R3,R3              YES.                                  75012021
         IC    R3,DX9(R7)                                               75018021
         TM    DX8(R7),XX80        V-MODE                               75024021
         BZ    SAMR002            NO.                                   75030021
         LA    R3,DX8(R3)          YES.                                 75036021
SAMR002  CL    R3,SMKYLGN                                               75042021
         BNH   *+8                 SKIP NEXT INSTRUCTION                75048021
         ST    R3,SMKYLGN                                               75054021
SAMR003  TM    DX7(R7),QSMODE      QSAM-S                               75060021
         BZ    SAMR004             NO                                   75066021
         LA    R3,DX32              RCD AREA PREFIX                     75072021
         ST    R3,SMKYLGN                                               75078021
SAMR004  A     R7,SRTBLN           GET NEXT ENTRY                       75084021
         CR    R6,R7                                                    75090021
         BNH   SAMR080            END OF SAME RECORD TBL FOR AN         75096021
SAMR050  CLC   DX0(LX1,R7),WKAR     UNIQUE NO.  SAME NO?                75102021
         BE    SAMR001                        YES.                      75108021
         B     SAMR003                        NO.                       75114021
SAMR080  LR    R7,R8              SEARCH TBL FOR ALL ENTRIES OF UNIQUE  75120021
*                                 NO. FOR WHICH SAMLGN AND SMKEYLGN     75126021
*                                 WERE CALCULATED.                      75132021
         L     R12,SMKYLGN                                              75138021
         A     R12,SEVEN          SMKYLGN MADE MULTIPLE OF 8.           75144021
         N     R12,MK0129                                               75150021
         ST    R12,SMKYLGN                                              75156021
SAMR085  CLC   DX0(LX1,R7),WKAR     IS THIS ONE OF THEM                 75162021
         BE    SAMR100            YES.                                  75168021
SAMR090  A     R7,SRTBLN           NO, TRY NEXT ONE                     75174021
         L     R11,COSADR                                               75180021
         CR    R7,R6              EOT.                                  75186021
         BL    SAMR085            NO.                                   75192021
         B     SAMR140            YES.                                  75198021
SAMR100  MVI   DX0(R7),XX00                                             75204021
         MVC   FULLWD(LX4),DX0(R7)                                      75210021
         SR    R4,R4                                                    75216021
         TM    DX8(R7),XX0C        BSAM OR BDAM?                        75222021
         BZ    SAMR101            NO.                                   75228021
         IC    R4,DX9(R7)          YES.                                 75234021
         TM    DX8(R7),XX08        BDAM?                                75240021
         BZ    *+6                NO.                                   75246021
         SR    R4,R4              YES.                                  75252021
         TM    DX8(R7),XX80        V-MODE?                              75258021
         BZ    SAMR101             NO                                   75264021
         LA    R4,DX8(R4)                                               75270021
SAMR101  DS    0H                                                       75276021
         MVC   SREG2,LOCCTR        SAVE LOCCTR TO SREG2                 75282021
         L     R11,LOCCTR          LOAD LOCCTR TO RE 11                 75288021
SAMR103  LA    R11,DX7(R11)                                             75294021
         N     R11,MK0129                                               75300021
SAMR104  DS    0H                                                       75306021
         N     R11,MK0129                                               75312021
         ST    R11,TSAVER                                               75318021
         A     R11,SMKYLGN                                              75324021
         ST    R11,LITBUF         REL LOC(RECORD AREA)                  75330021
         MVI   LITBUF,XX0C                                              75336021
         MVC   LITBUF+NX4(LX1),DX6(R7) BL #                             75342021
         XC    LITBUF+NX5(LX4),LITBUF+NX5                               75348021
         L     R1,COSADR                                                75354021
         LA    R2,LITBUF                                                75360021
         LA    R3,DX9                                                   75366021
         BALR  R0,R1              PUT OUT BLKADR DEF                    75372021
         DC    X'14'                                                    75378021
*                                                                       75384021
         TM    DX8(R7),XX0C        BSAM BDAM                      37348 75390021
*                                  ELSE QSAM,QISAM BISAM          37348 75396021
         BZ    SAMR130             BRANCH                               75402021
         SR    R11,R4             YES.R11=A(RECORD AREA)-KEY/COUNT      75408021
         MVC   FULLWD(LX4),DX0(R7)                                      75414021
         L     R12,FULLWD                                               75420021
         LA    R12,DX13(R12)       DECB+13=DECB A(AREA)                 75426021
         TM    DX7(R7),XX40        BSAM S-MODE                          75432021
         BZ    SAMR120             NO                                   75438021
         LA    R12,DX88(R12)        YES, DCB +100 IS TARGET             75444021
SAMR120  ST    R12,LITBUF          TARGET ADDRESS                       75450021
         MVI   LITBUF,XX2C                                              75456021
         ST    R11,LITBUF+NX4                                           75462021
         MVI   LITBUF+NX4,XX03                                          75468021
         LA    R2,LITBUF                                                75474021
         LA    R3,DX8                                                   75480021
         L     R1,COSADR                                                75486021
         BALR  R0,R1               BR TO COMMON                         75492021
         DC    X'14'                                                    75498021
         B     SAMR090             PROCESS NEXT ENTRY                   75504021
SAMR130  TM    DX7(R7),QSMODE      QSAM-S                               75510021
         BZ    SAMR090             NO                                   75516021
         MVC   MTEMP1+NX1(LX3),DX1(R7) REL LOC OF DCB                   75522021
         L     R2,MTEMP1                                                75528021
         LA    R2,DX112(R2)         DCB + 112                           75534021
*  FILL IN REST OF DCB EXTENSION                                        75540021
*                                                                       75546021
SAMR133  ST    R2,LITBUF                                                75552021
         MVI   LITBUF,XX2C          CODE                                75558021
         S     R11,SMKYLGN         START OF AREA                        75564021
         ST    R11,LITBUF+NX4                                           75570021
         MVI   LITBUF+NX4,XX04      ADCON LENGTH                        75576021
         LA    R2,LITBUF                                                75582021
         LA    R3,DX8                                                   75588021
         L     R1,COSADR                                                75594021
         BALR  R0,R1               BR TO COMMON                         75600021
         DC    X'14'                                                    75606021
         B     SAMR090             RETURN                               75612021
*                                                                       75618021
*                                                                       75624021
*                                                                       75630021
*                                                                       75636021
SAMR140  L     R4,TSAVER                                                75642021
         A     R4,SAMLGN                                                75648021
         A     R4,SMKYLGN                                               75654021
         ST    R4,LOCCTR                                                75660021
         CL    R9,ZEROS           ANY MORE ENTRY?                       75666021
         BE    SAMR160            NO.                                   75672021
SAMR150  LR    R7,R8              YES.                                  75678021
SAMR151  CLI   DX0(R7),XX00                                             75684021
         BNE   SAMR000             PROCESS NEXT ENTRY                   75690021
         A     R7,SRTBLN                                                75696021
         CR    R7,R6                                                    75702021
         BNL   SAMR160             BR TO EOT RTN                        75708021
         B     SAMR151             CHECK NEXT ENTRY                     75714021
SAMR160  NI    PRMSW,XXDF          SET PRIMED SW OFF                    75720021
         L     R1,PSMRCD                                                75726021
         ST    R15,TSAVER                                               75732021
         L     R15,BTABRL                                               75738021
         BALR  R14,R15             RELEASE SRA TBL                      75744021
         L     R15,TSAVER                                               75750021
         L     R8,LOCCTR                                                75756021
         A     R8,SEVEN                                                 75762021
         N     R8,MK0129                                                75768021
         ST    R8,LOCCTR                                                75774021
         L     R14,RS14                                                 75780021
         BR    R14                 RETURN                               75786021
*                                                                       75792021
         EJECT                                                          75798021
       EJECT                                                            75804021
*                                                                       75810021
*                                                                       75816021
*                                                                       75822021
*                                                                       75828021
*      DIAGNOSTIC ROUTINE FOR FILE KEYS                                 75834021
*      CALLED AFTER FD AND ALL ITS RECORDS HAVE BEEN PROCESSED          75840021
*      CHECKS THAT RECORD KEY IS IN FILE, SYMBOLIC OR ACTUAL IS NOT     75846021
*         IN FILE                                                       75852021
*                                                                       75858021
       USING *,R15                                                      75864021
KEYCHK EQU   *                                                          75870021
       STM   R14,R4,RS144                                               75876021
       SR    R3,R3            R3= 0 FOR RECORD KEY, 2 SYMBOLIC, 4 A     75882021
KEYCH2 LA    R4,SVKYTB(R3)         DID LAST FD HAVE KEY                 75888021
         CLC   DX0(LX2,R4),ZEROS                                        75894021
       BC    NOTEQ,KEYCH6            YES                                75900021
KEYCH4   LA    R3,DX2(R3)             NO - POINT R3 AT NEXT TABLE DI    75906021
       C     R3,FOUR               HAVE ALL 3 KEYS BEEN EXAMINED        75912021
       BC    NOTHI,KEYCH2           NO - RETURN FOR NEXT                75918021
         XC    SVKYTB(LX8),SVKYTB     YES - ZERO SAVED DISPS. AND EX    75924021
       LM    R14,R4,RS144                                               75930021
       BCR   UNCOND,R14            RETURN                               75936021
KEYCH6   L     R1,SYMPAR                                                75942021
       LTR   R3,R3            GIVE R1 ADDR. OF APPLICABLE TIB           75948021
         BC    NOTZER,*+NX8        CONTINUE                             75954021
       L     R1,RPARAM                                                  75960021
         L     R1,DX0(R1)                                  TAMM         75966021
         L     R1,DX0(R1)                                  TABLE        75972021
         LA    R1,DX0(R1)                                               75978021
         LA    R15,SVKYTB+NX1(R3)                                       75984021
         XI    DX0(R15),XX01                                            75990021
       AH    R1,SVKYTB(R3)         + DISPL. SAVED BY KEYRTN             75996021
       L     R15,AQUAL                                                  76002021
       BALR  R14,R15               FIND KEY IN DICT. (ADDR. IN R2)      76008021
       LTR   R14,R15                                                    76014021
       L     R15,ACHKEY                                                 76020021
       BC    ZERO,KEYC10           RETURN CODE 0 - KEY FOUND            76026021
       C     R14,FOUR                                                   76032021
       BC    NOTEQ,KEYCH4                      8 OR 12, HANDLE LATE     76038021
       LTR   R3,R3                             4 - KEY NOT FOUND        76044021
       BC    NOTZER,KEYCH4            OK FOR SYM. AND ACT.              76050021
KEYCH8 LH    R0,ERR178                ERROR FOR REC. KEY                76056021
       BC    UNCOND,KEYC16         ERROR RTN                            76062021
KEYC10   CLC   INPUT+NX5(LX3),LSTQUL IS DICT PTR OF KEY IN LIMITS OF    76068021
       BC    NOTLO,KEYC12      YES                                      76074021
       LTR   R3,R3                NO                                    76080021
       BC    ZERO,KEYCH8          ERROR FOR REC. KEY                    76086021
       BC    UNCOND,KEYCH4        OK FOR SYM. AND ACT. KEY              76092021
KEYC12 LTR   R3,R3            KEY IS IN LAST FD                         76098021
       BC    ZERO,KEYC14          OK FOR REC. KEY                       76104021
       LH    R0,ER181             ERROR FOR SYM. AND ACT. KEY           76110021
       BC    UNCOND,KEYC16         ERROR RTN                            76116021
*                RECORD KEY IS LEGALLY WITHIN FILE                      76122021
KEYC14 L     R2,INPUT             GET ADDR OF ATTRIBUTES IN DICT        76128021
         TM    BLKLBL,XX18         IS FILE BLOCKED?                     76134021
       BC    NOTZER,KEYCH4         YES - OK                             76140021
         MVC   SVKYWK(LX2),DX2(R2)                                      76146021
         NI    SVKYWK,XX0F      ISOLATE D OF I/D/K                      76152021
         CLC   SVKYWK(LX2),ZEROS IS IT 0 - DOES KEY INCLUDE 1ST BYTE    76158021
       BC    NOTEQ,KEYCH4        NO - OK                                76164021
       LH    R0,ERR180               YES - ERROR                        76170021
KEYC16 L     R15,AERRTN                                                 76176021
       BALR  R14,R15               ERROR RTN                            76182021
       L     R15,ACHKEY                                                 76188021
       BC    UNCOND,KEYCH4    RETURN FOR NEXT TYPE OF KEY               76194021
*                                                                       76200021
ERR178 DC    X'20B2'                                                    76206021
ERR180 DC    X'20B4'                                                    76212021
ER181  DC    X'20B5'                                                    76218021
*                                                                       76224021
       EJECT                                                            76230021
*                                                                       76236021
         EJECT                                                          76242021
*=2      QUAL-   FINDS KEYS IN DICTIONARY                               76248021
*  THIS ROUTINE RESOLVES FOR QUALIFIED KEY LENGTH AND ADDRESS BY CH     76254021
*    ING THAT THE KEY IS UNIQUELY DEFINED BY ITS HIERARCHY OF QUALI     76260021
*    THE LENGTH AND ADDRESS OF THE UNIQUE KEY IS THEN LOOKED UP IN      76266021
*    DICTIONARY.                                                        76272021
*      INPUT -  R1 HAS STATING ADDRESS OF QUALIFICATION CHAIN.          76278021
*      OUTPUT-  IF R15=0, R1 HAS KEY LENGTH , R2 HAS KEY ADDRESS        76284021
*               IF R15=NON-ZERO, R1,R2 HAVE MEANINGLESS INFORMATION     76290021
*                                                                       76296021
IKF214   CSECT                                                          76302021
         USING *,R15                                                    76308021
QUAL     ST    R14,LREDEF                                               76314021
         STM   R3,R12,RS3                                               76320021
         LR    R9,R1                                                    76326021
         A     R9,TWO                                                   76332021
         SR    R7,R7                                                    76338021
         IC    R7,DX0(R9)           MOVE BCD NAME TO WORK AREA.         76344021
         LR    R4,R9                         AME TO                     76350021
         XC    WKAREA(LX32),WKAREA                                      76356021
         EX    R7,QUA999                                                76362021
         MVC   PARAM(LX4),AWKARE                                        76368021
         MVI   PARAM,XX10                                               76374021
         LR    R4,R9                                                    76380021
         L     R1,APARAM                                                76386021
         L     R15,ALDELN          CHECK HIGHEST LEVEL QUALIFIER.       76392021
         BALR  R14,R15             BR TO LOCATE DEL GIVEN NAME          76398021
         LR    R5,R15                                                   76404021
QUA000   CL    R5,ZEROS                                                 76410021
         L     R15,AQUAL                                                76416021
         BC    HI,QUA040           CONTINUE                             76422021
QUA010   SR    R1,R1                                                    76428021
         IC    R1,DX0(R4)           CHECK NEXT QUALIFIER IF ANY         76434021
         AR    R4,R1                                                    76440021
         A     R4,ONE                                                   76446021
         CLI   DX0(R4),XX00                                             76452021
         BC    EQ,QUA050           END OF QUAL STRING                   76458021
QUA020   IC    R7,DX0(R4)           MOVE BCD NAME TO WORK AREA.         76464021
         XC    WKAREA(LX32),WKAREA                                      76470021
         EX    R7,QUA999                                                76476021
         MVI   PARAM,XX08                                               76482021
         L     R1,APARAM                                                76488021
         L     R15,ALATAC                                               76494021
         BALR  R14,R15             BR-LOCATE ATTRIB USING ACC-PTR       76500021
         LR    R5,R15                                                   76506021
         L     R15,AQUAL                                                76512021
         BC    UNCOND,QUA000       CHECK ATTRIBUTES                     76518021
*                                                                       76524021
QUA040   L     R14,LREDEF                                               76530021
         CL    R5,TWELVE                                                76536021
         L     R15,AQUAL                                                76542021
         BC    NOTEQ,QUA045        BR TO GET RETURN CODE                76548021
         AR    R7,R9               IS THIS ITEM NOT QUALIFIED.          76554021
         CLI   DX1(R7),XX00                                             76560021
         BC    NOTEQ,QUA045        BR TO GET RETURN CODE                76566021
         BC    UNCOND,QUA050       END OF QUAL STRING                   76572021
QUA045 LR    R15,R5                GET RETURN CODE FROM ACCESS          76578021
QUA046 LM      R3,R12,RS3                                               76584021
         BCR   UNCOND,R14          RETURN                               76590021
         USING ICDATT,R2                                                76596021
QUA050   STM   R2,R3,INPUT         END OF QUAL. STRING, SAVE LATACP     76602021
         MVC   WKAREA+NX34(LX2),DX0(R2) SAVE MAJOR AND MINOR CODE OF I  76608021
         MVC   WKAREA+NX33(LX1),DX8(R2) DEC DIG LGN                     76614021
         SR    R1,R1                                                    76620021
         IC    R1,DX1(R2)                                               76626021
         SRL   R1,DX4               R1,= MINOR CODE                     76632021
         LA    R3,KYLNTB(R1)                                            76638021
         CLI   DX0(R3),XXFF                                             76644021
       BC      EQ,QUA046           ERROR IN KEY'S MINOR CODE            76650021
         IC    R1,DX0(R3)                                               76656021
         EX    R0,QUA100(R1)                                            76662021
         MVC   WKAREA+NX36(LX4),DX1(R2) SAVE KEY'S APAF FIELD           76668021
         LM    R3,R12,RS3                                               76674021
         L     R14,LREDEF                                               76680021
         L     R15,ZEROS                                                76686021
         BCR   UNCOND,R14          RETURN                               76692021
QUA100   BAL   R4,QUA110           GR, AL, AN                           76698021
         BAL   R4,QUA120           ED                                   76704021
         BAL   R4,QUA130           BIN                                  76710021
         BAL   R4,QUA140           ID                                   76716021
         BAL   R4,QUA150           REPORT                               76722021
*                                                                       76728021
         BAL   R4,QUA160           ST. REP.                             76734021
         BAL   R4,QUA170           STERLING NON-REPORT                  76740021
         BAL   R4,QUA180           EXT. FLT. PT.                        76746021
         BAL   R4,QUA190           INT. FLT. PT.                        76752021
QUA110   MVC   LITBUF(LX2),ICDPEN                                       76758021
         LH    R1,LITBUF                                                76764021
         N     R1,MK1632                                                76770021
         TM    ITMCLS+NX1,XX04      IS THIS REPORT SECTION S.NAME       76776021
         BC    NOTONE,QUA115       NO                                   76782021
         C     R1,NINE             YES, IS LGN G.T. 9 BYTES             76788021
         BC    NOTHI,QUA113        NO                                   76794021
         L     R1,NINE             YES, SET IT TO 9                     76800021
QUA113   LR    R3,R1               FIND NUMERIC LGN                     76806021
         SLL   R3,DX1                                                   76812021
       BCTR  R3,R0                N.L. = 2(LGN) - 1   ( = OF DIGITS     76818021
         STC   R3,IPLT+NX2          STORE N.L.                          76824021
QUA115   BCR   UNCOND,R4           END OF GR,AL,AN RTN                  76830021
QUA120   IC    R1,ICDNL                                                 76836021
         TM    ITMCLS+NX1,XX04      IF REPORT S.NAME GO TO ID           76842021
         BC    ONES,QUA140+NX4      YES                                 76848021
         BCR   UNCOND,R4           END OF ED RTN                        76854021
QUA130   IC    R1,ICDNL            R1 = N.L.                            76860021
         TM    ITMCLS+NX1,XX04      IF REPORT S.NAME GO TO ID           76866021
         BC    ONES,QUA140+NX4      YES                                 76872021
         C     R1,FOUR                                                  76878021
         BC    NOTHI,QUA131        N.L. LE 4                            76884021
         C     R1,NINE             N.L.  GT  4                          76890021
         BC    NOTHI,QUA132        N.L. LE 9                            76896021
         L     R1,EIGHT            N.L.  GT  9   M.L.=8                 76902021
         BCR   UNCOND,R4           RETURN FROM BIN RTN                  76908021
*                                                                       76914021
QUA131   L     R1,TWO              N.L.  LT= 4   M.L.=2                 76920021
         BCR   UNCOND,R4           RETURN FROM BIN RTN                  76926021
QUA132   L     R1,FOUR             N.L.  LT= 9   M.L.=4                 76932021
         BCR   UNCOND,R4           RETURN FROM BIN RTN                  76938021
QUA140   IC    R1,ICDNL            R1 = N.L.                            76944021
         MVC   IPLT(LX3),ICDNLS     MOVE N.L.AND SCALE                  76950021
         NI    IPLT,XX01            SAVE SIGN                           76956021
QUA142   SRL   R1,DX1               R1 = N.L./2                         76962021
         LA    R1,DX1(R1)           R1= N.L.12 +1                       76968021
         BCR   UNCOND,R4           RETURN FROM ID RTN                   76974021
QUA150   IC    R1,ICDLGN           GET TOTAL LGN.                       76980021
         TM    ITMCLS+NX1,XX04      IS THIS REPORT S.NAME               76986021
         BC    NOTONE,QUA158       NO, BRANCH                           76992021
         MVC   IPLT+NX1(LX1),ICDSCL  MOVE SCALE                         76998021
         MVC   IPLT+NX2(LX1),ICDNLN     AND NUM. LGN. TO AREA           77004021
         NI    IPLT+NX2,XX1F                                            77010021
         IC    R1,IPLT+NX2          GET NUM. LGN.                       77016021
         BC    UNCOND,QUA142         AND CONVERT TO INT. DEC. (ID)      77022021
QUA158   BCR   UNCOND,R4           RETURN FROM REPORT RTN               77028021
QUA160   IC    R1,ICDLGN           GET TOTAL LENGTH                     77034021
         TM    ITMCLS+NX1,XX04      IS THIS REPORT SECTION S.NAME       77040021
         BC    NOTONE,QUA168       NO                                   77046021
         SR    R3,R3               YES                                  77052021
         IC    R1,ICDNDC           GET NUM OF DEC. AND                  77058021
         STC   R1,IPLT+NX1          STORE IN AREA                       77064021
         IC    R3,ICDNPD           GET NUM OF POUNDS DIG.               77070021
         LA    R1,DX3(R1,R3)        N.L. = PENCE DEC. + POUNDS + 3      77076021
         STC   R1,IPLT+NX2          STORE N.L.                          77082021
         BC    UNCOND,QUA142       CONVERT TO ID                        77088021
QUA168   BCR   UNCOND,R4           RETURN FROM ST.REP. RTN              77094021
QUA170   IC    R1,ICDNLN           GET TOTAL LGN                        77100021
         TM    ITMCLS+NX1,XX04      IS THIS REPORT SECTION S.NAME       77106021
         BCR   NOTONE,R4           NO                                   77112021
         SR    R3,R3               YES                                  77118021
         IC    R1,ICDNL                                                 77124021
         SRL   R1,DX3               R1= = OF POUND DIGITS               77130021
         MVC   IPLT+NX1(LX1),ICDPEN                                     77136021
         NI    IPLT+NX1,XX1F        = OF DEC. PENCE                     77142021
         IC    R3,IPLT+NX1                                              77148021
         LA    R1,DX3(R1,R3)        N.L. = POUND + DEC. PENCE +3        77154021
         STC   R1,IPLT+NX2          N.L.                                77160021
         BC    UNCOND,QUA142       CONVERT TO ID                        77166021
QUA180   IC    R1,ICDNL            GET TOTAL LGN                        77172021
         TM    ITMCLS+NX1,XX04      IS THIS REPORT SECTION S.NAME       77178021
         BCR   NOTONE,R4           NO                                   77184021
         S     R1,FIVE             YES, GET N.L.                        77190021
         TM    ICDPEN,XX40          IS THERE DEC. POINT                 77196021
         BC    NOTONE,*+NX6         NO                                  77202021
       BCTR  R1,R0                YES, SUBTRACT 1 FROM R1               77208021
         STC   R1,IPLT+NX2          SAVE N.L.                           77214021
         MVC   IPLT+NX1(LX1),ICDPEN  SAVE SCALE                         77220021
         NI    IPLT+NX1,XX1F                                            77226021
         BC    UNCOND,QUA142       CONVERT TO ID                        77232021
QUA190   LA    R1,DX4               T.L. = 4  SHORT PREC.               77238021
         TM    ICDNL,XX01           8 = LONG  PREC                      77244021
         BC    NOTONE,QUA192       NO                                   77250021
         LA    R1,DX8                                                   77256021
QUA192   TM    ITMCLS+NX1,XX04      IS THIS ITEM REPORT SECTION S.NA    77262021
         BCR   NOTONE,R4           NO                                   77268021
         LA    R1,DX2(R1)           YES                                 77274021
         C     R1,SIX              N.L.= 6 SHORT PREC.                  77280021
         BC    EQ,QUA194               14 LONG   PREC.                  77286021
         LA    R1,CON14                                                 77292021
QUA194   STC   R1,IPLT+NX2          N.L. SAVE                           77298021
         MVI   IPLT+NX1,XX00        SCALE SAVE (0)                      77304021
         BC    UNCOND,QUA142       CONVERT TO ID                        77310021
QUA999   MVC   WKAREA(LX0),DX0(R4)                                      77316021
         DROP  R2                                                       77322021
*                                                                       77328021
*ELIODO - SEE IF ITEM IS AN OCCURS DEPENDING VARIABLE BY SEARCHING      77334021
*         THE OD2TBL WHICH HAS THE OCCURS DEPENDING ON VARIABLES AN     77340021
*         THEIR QUALIFIERS IF ANY(TABLE BUILT BY PHASE 1)               77346021
       USING *,R15                                                      77352021
ELIODO   TM    PTBLSW+NX1,XX08      ARE THERE ANY ODO VARIABLES         77358021
         BCR   ZERO,R14            NO, RETURN                           77364021
         STM   R0,R14,QSAVE                                             77370021
         NI    ODOVSW,XXFE                                              77376021
         L     R4,AOD2TB           YES, R4= A(TIB)                      77382021
         L     R4,DX0(R4)           R4= A(TAMM)                         77388021
         LH    R5,DX4(R4)           R5= TABLE SIZE                      77394021
         L     R4,DX0(R4)           R4= P(OD2TBL)                       77400021
         N     R4,MK0932                                                77406021
         ST    R4,QTEXT            SAVE A(OD2TBL)                       77412021
         AR    R5,R4               R5= A(END OF OD2TBL)                 77418021
ELIOD1   LA    R7,DX2(R4)                                               77424021
ELIOD2   SR    R6,R6                                                    77430021
         IC    R6,DX0(R7)                                               77436021
         LA    R7,DX1(R6,R7)                                            77442021
         CLI   DX0(R7),XX00         IS THIS LAST NAME IN ENTRY          77448021
         BC    NOTEQ,ELIOD2        NO, BRANCH                           77454021
         SR    R7,R6               YES, SET R7 BACK TO COUNT OF LAS     77460021
       BCTR  R7,R0                  NAME                                77466021
         EX    R6,CMPOD2           IS ODZTBL NAME = CI NAME             77472021
         BC    EQ,ELIOD5           YES, SET UP FOR QUAL RTN             77478021
ELIOD3   MVC   FULLWD(LX2),DX0(R4)   NO                                 77484021
         AH    R4,FULLWD           GET TO NEXT ENTRY                    77490021
         A     R4,TWO                                                   77496021
         CR    R4,R5               IS IT END OF TABLE                   77502021
         BC    LO,ELIOD1           NO, LOOK AT NEXT ENTRY               77508021
         LM    R0,R14,QSAVE        YES, RETURN TO CALLER                77514021
         BCR   UNCOND,R14          RETURN                               77520021
ELIOD5   L     R8,GPARAM           GET A(LGS)                           77526021
         L     R8,DX0(R8)           R8=A(TAMM)                          77532021
         L     R9,DX0(R8)                                               77538021
         N     R9,MK0932           R9= A(TABLE)  GPLSTK                 77544021
         AH    R9,DX4(R8)                                               77550021
         S     R9,CON24            R9= A(LGS)                           77556021
         ST    R9,LGSSAV                                                77562021
         CLI   DX20(R9),XX00        ANY GROUPS OVER THIS ITEM           77568021
         BC    EQ,ELID10           NO, BRANCH                           77574021
         L     R1,DICTPT           DUMMY DELIMITOR IS CI                77580021
         A     R1,ONE                 DICT. PTR. +1                     77586021
         ST    R1,PARAM1                                                77592021
         MVI   PARAM,XX00                                               77598021
ELIOD8   MVC   PARAM+NX1(LX3),DX13(R9) GROUP DICT. PTR.                 77604021
         LA    R1,PARAM                                                 77610021
         L     R15,AENTDE                                               77616021
         BALR  R14,R15             CALL ENTER DELIMITOR                 77622021
         L     R15,AELIOD                                               77628021
         S     R9,CON24            GET NEXT HIGHER GROUP ON STACK       77634021
         CLI   DX20(R9),XX00        IS IT LEVEL 0 (DUMMY)               77640021
         BC    NOTEQ,ELIOD8        NO                                   77646021
         CLI   MCI,XX01                 IS THIS FILE SCT WHERE FD,39847 77652021
         BC    HI,ELID10                SD CAN BE QUALIFIERS      39847 77658021
         TM    NOFDSW,NOFDBIT      IS THIS A RECORD WITH NO FD          77664021
         BO    ELID10              YES-BYPASS ENTER DELIMITER RTN       77670021
         MVC   PARAM+NX1(LX3),HIQUAL YES                                77676021
         LA    R1,PARAM                                                 77682021
         L     R15,AENTDE                                               77688021
         BALR  R14,R15             BR TO ACCESS RTN 'ENTDEL'            77694021
         L     R15,AELIOD                                               77700021
ELID10   LR    R1,R4                                                    77706021
         L     R15,AQUAL           CALL QUAL TO SEE IF THIS IS          77712021
         BALR  R14,R15              ODO VARIABLE                        77718021
         LTR   R1,R15                                                   77724021
         L     R15,AELIOD                                               77730021
         BC    NOTZER,ELIOD3       NO                                   77736021
ELID12   L     R9,LGSSAV           YES                                  77742021
         LM    R2,R3,INPUT         R2= ADDR. OF DICT. ATTRIB. ODO V     77748021
*                                  R3= DICT. PTR. OF ODO VARIABLE       77754021
         C     R3,DICTPT           IS THE ITEM FOUND REALLY THE ONE     77760021
         BC    NOTEQ,ELIOD3        NO, BRANCH             LOOKED FO     77766021
         OI    DX6(R2),XX02        SET Q-BIT ON                         77772021
ELID14   CLI   DX20(R9),XX00        NO GROUPS OVER THIS ITEM            77778021
         BC    EQ,ELID20           YES, BRANCH                          77784021
         OI    DX0(R9),XX40         SET Q-BIT IN ALL OF CI'S GROUPS     77790021
         TM    DX1(R9),XX40         IS ODO VARIABLE IN VARIABLE PART    77796021
*                                    RECORD                             77802021
         BC    ONES,ELID35         YES, BRANCH                          77808021
ELID16   S     R9,CON24            R9= A(NEXT GROUP) IN GPLSTK          77814021
         CLI   DX20(R9),XX00                                            77820021
         BC    NOTEQ,ELID14        GO SEE IF GROUPS OVER THIS ITEM      77826021
         CLI   MCI,XX01                 IF FILE SCT ENTER Q-BIT   39847 77832021
         BC    HI,ELID20                IN FD, SD DICT ENTRY      39847 77838021
         TM    NOFDSW,NOFDBIT      IS THIS A RECORD WITH NO FD          77844021
         BO    ELID20              YES-BYPASS.                          77850021
         MVC   PARAM+NX1(LX3),HIQUAL                                    77856021
         MVI   PARAM,XX04                                               77862021
         LA    R1,PARAM                                                 77868021
         L     R15,ALATRP                                               77874021
         BALR  R14,R15             GET A(ATTRIBUTES) OF FD, SD, SA      77880021
         L     R15,AELIOD                                               77886021
         OI    DX1(R2),XX80         SET Q-BIT ON IN DICT. ATTR.         77892021
ELID20   TM    PTBLSW+NX1,XX10      WAS QITBL PRIMED                    77898021
         BC    ONES,ELID21         YES                                  77904021
         LA    R1,QITBLP           NO                                   77910021
         L     R15,BPRIME                                               77916021
         BALR  R14,R15             BRANCH TO PRIME ROUTINE              77922021
         OI    PTBLSW+NX1,XX10      SET PRIME SW ON                     77928021
ELID21   L     R1,QITBLP                                                77934021
         L     R15,BINSRT                                               77940021
         BALR  R14,R15             INSERT QITBL ENTRY                   77946021
         L     R15,AELIOD                                               77952021
         LR    R1,R4               R1IS A(ENTRY)                        77958021
         S     R1,QTEXT            R1 IS DISP OF ODO VAR. IN OD2TBL     77964021
         ST    R1,PARAM+NX4         MOVE OD2TBL DISP TO PARAM           77970021
         MVC   PARAM(LX4),DICTPT    MOVE ODO VAR. DICT. PTR. TO PARA    77976021
         MVC   DX0(LX8,R2),PARAM                                        77982021
         CLI   MCI,XX04             IF ODO VARIABLE                     77988021
         BC    NOTEQ,ELID30         IS IN WORKING STORAGE SECTION       77994021
         TM    ITMCLS,XX38           AND HAS NO VALUE CLAUSE            78000021
         BC    NOTZER,ELID30        INITIALIZE                          78006021
         OI    ITMCLS,XX28           ITEM TO                            78012021
         MVC   LITVAL(LX2),ODOFIG    ZERO THRU                          78018021
         L     R15,AVALGN           VALGEN ROUTINE                      78024021
         BALR  R14,R15             BRANCH                               78030021
         NI    ITMCLS,XXC7          TURN OFF VALUE BITS                 78036021
ELID30   LM    R0,R14,QSAVE                                             78042021
         BCR   UNCOND,R14          RETURN                               78048021
ELID35   TM    ODOVSW,XX01          WAS ERROR PUT OUT                   78054021
         BC    ONES,ELID16         YES, RETURN                          78060021
         LH    R0,ER158                                                 78066021
         L     R15,AERRTN                                               78072021
         BALR  R14,R15             BRANCH TO ERR RTN                    78078021
         L     R15,AELIOD                                               78084021
         OI    ODOVSW,XX01          SET SW ON                           78090021
         BC    UNCOND,ELID16       BRANCH                               78096021
CMPOD2   CLC   CI(LX0),DX0(R7)                                          78102021
ER158    DC    X'809E'                                                  78108021
*                                                                       78114021
*=2 QBUILD- BUILDS QRTN AND QFILE TABLE ENTRY WHEN AN ITEM WITH AN      78120021
*           OCCURS   DEPENDING ON CLAUSE IS ENCOUNTERED. QINIT A-TE     78126021
*           (QDEF) IS PUT OUT ON FILE 4 FOR ALL QRTNS WHICH MUST BE     78132021
*           EXECUTED AT INTIIALIZATION (Q-RTNS FOR ALL RECORDS OTHE     78138021
*           THAN QSAM AND QISAM)                                        78144021
         USING *,R15                                                    78150021
QBUILD   STM   R0,R14,QSAVE                                             78156021
         MVI   QCALL+NX2,XX88       SET GNDEF CODE                      78162021
         TM    PTBLSW+NX1,XX20      HAS QRTN TABLE BEEN PRIMED          78168021
         BC    ONES,QBLD01         YES                                  78174021
         LA    R1,QRTNPM           NO, PRIME QRTN TABLE                 78180021
         L     R15,BPRIME                                               78186021
         BALR  R14,R15             GO TO PRIME RTN                      78192021
         L     R15,AQBUIL                                               78198021
         OI    PTBLSW+NX1,XX20      SET PRIME SW ON                     78204021
         LA    R3,DX2               PUT OUT                             78210021
         LA    R2,QRTNHD             QRTN                               78216021
         LR    R1,R11                  HEADER ON                        78222021
         BALR  R0,R1                      FILE 2                        78228021
         DC    X'12'                                                    78234021
QBLD01   TM    GNSW,XX01            HAS A GN= BEEN ENTERED              78240021
         BC    ONES,QBLD50         YES                                  78246021
         LH    R1,GNCTR        M)  NO, GET A GN=                        78252021
         A     R1,ONE                                                   78258021
         STH   R1,GNCTR         )                                       78264021
         STH   R1,GNNUMB                                                78270021
         MVC   GNDISP(LX2),ZEROS                                        78276021
         MVC   QCALL+NX3(LX2),GNNUMB PUT OUT                            78282021
         LA    R3,DX3                 GNDEF                             78288021
         LA    R2,QCALL+NX2                                             78294021
         LR    R1,R11                    ON                             78300021
         BALR  R0,R1                     FILE 2                         78306021
         DC    X'12'                                                    78312021
         L     R1,QRTNPM                                                78318021
         L     R15,BINSRT                                               78324021
         BALR  R14,R15             CALL INSERT                          78330021
         L     R15,AQBUIL          RESET BASE REG.                      78336021
         MVC   DX0(LX4,R2),GNNUMB    MOVE GN= AND N(COUNT) TO TABLE(Q   78342021
         A     R3,TWO                                                   78348021
         STH   R3,GNDISP           GNDISP= DISP OF N IN TABLE           78354021
         OI    GNSW,XX01            SET GNSW ON                         78360021
         CLI   MCI,XX02             IS ODO UNDER FD                     78366021
         BC    HI,QBLD60           NO                                   78372021
         TM    NOFDSW,NOFDBIT      IS THIS A RECORD WITH NO FD          78378021
         BO    QBLD50              YES-BYPASS QINIT & OBJSUB PROC       78384021
         B     QBLD15              GO TO GENERATE INIT.                 78390021
QBLD05   TM    PTBLSW+NX1,XX40      HAS QFILE TABLE BEEN PRIMED         78396021
         BC    ONES,QBLD10        YES- BRANCH.                          78402021
         LA    R1,QFILEP            *                                   78408021
         L     R15,BPRIME           *  PRIME                            78414021
         BALR  R14,R15              *  QFILE TABLE.                     78420021
         L     R15,AQBUIL           *                                   78426021
         OI    PTBLSW+NX1,XX40     SET PRIMED SWITCH.                   78432021
*                                                                       78438021
         OI    SWITCH,XX01          QFILE TABLE EXISTS FOR PH3          78444021
*                                                                       78450021
QBLD10   EQU   *                                                  39847 78456021
         CLI   MCI,XX01                 IS THIS FOR AN SD         39847 78462021
         BNE   QBLD10A                     NO, BR                 39847 78468021
         CLI   GNDCB,XX09    WAS LAST QFILE ENTRY FOR SD          06813 78474021
         BNE   QBLD10Y       NO - MAKE NEW ENTRY FOR SD           06813 78480021
         CLC   GNDCB+NX1(LX1),SDBLL     YS,HAS THIS BEEN ENTERED  39847 78486021
         BE    QBLD20                       YES, BR               39847 78492021
*  NO, BUILD A NEW QFILE ENTRY FOR SD                             39847 78498021
QBLD10Y  EQU   *                                                  06813 78504021
         MVI   GNDCB,XX09               IDENTIFYING CDE FOR SD    39847 78510021
         MVC   GNDCB+NX1(LX1),SDBLL     FIRST BLL NO FOR SD       39847 78516021
         B     QBLD10B                       BR                   39847 78522021
QBLD10A  EQU   *                                                  39847 78528021
         CLI   GNDCB,XX09    WAS LAST QFILE ENTRY FOR SD          06813 78534021
         BE    QBLD10Z       YES - MAKE NEW ENTRY FOR FD          06813 78540021
         CLC   GNDCB+NX1(LX1),FD+NX3    HAS THIS DCB BEEN ENTERED 39847 78546021
         BE    QBLD20             YES- BRANCH.                          78552021
*                                 NO- BUILD A NEW QFILE ENTRY           78558021
QBLD10Z  EQU   *                                                  06813 78564021
         MVI   GNDCB,XX00    INDICATE FD ENTRY                    06813 78570021
         MVC   GNDCB+NX1(LX1),FD+NX3                                    78576021
QBLD10B  EQU   *                                                  39847 78582021
         MVC   GNGN(LX2),GNNUMB    SAVE DCB NUMBER.                     78588021
         LA    R0,DX6                *                                  78594021
         L     R1,QFILEP            *  GET NEXT 6 BYTE ENTRY            78600021
         L     R15,BINSRT           *  USING THE VARIABLE               78606021
         BALR  R14,R15              *  LENGTH ENTRY OPTION.             78612021
         L     R15,AQBUIL           *                                   78618021
         MVC   DX0(LX2,R2),GNDCB                                        78624021
         LA    R2,DX2(R2)                                               78630021
         B     QBLD30              BRANCH                               78636021
QBLD15   OI    GNNUMB,XX80          SET HIGH BIT ON                     78642021
         BAL   R4,QBLD70           GO GENERATE INIT                     78648021
         NI    GNNUMB,XX7F          TURN OFF                            78654021
         NI    INITGN,XX7F                HIGH BIT                      78660021
         B     QBLD05              SEE IF QFILE TABLE PRIMED YET        78666021
*                                                                       78672021
QBLD20   LA    R0,DX2                                                   78678021
         L     R1,QFILEP                                                78684021
         L     R15,BINSRT                                               78690021
         BALR  R14,R15             CALL INSERT RTN                      78696021
         L     R15,AQBUIL                                               78702021
         S     R2,TWO                                                   78708021
*                                                                       78714021
QBLD30   MVC   DX0(LX4,R2),GNNUMB                                       78720021
QBLD50   XC    PARAM(LX4),PARAM                                         78726021
         MVC   PARAM+NX2(LX2),OBJDIS MOVE ODZTBL PTR TO WORKAREA        78732021
         L     R1,QRTNPM                                                78738021
         LR    R4,R1                                                    78744021
         L     R15,BINSRT          MOVE OD2TBL PTR TO QRTN TABLE        78750021
         BALR  R14,R15             CALL INSERT RTN                      78756021
         L     R15,AQBUIL                                               78762021
         MVC   DX0(LX4,R2),PARAM                                        78768021
         L     R4,DX0(R4)                A(TAMM)    QRTN TABLE          78774021
         L     R4,DX0(R4)                A(TABLE)                       78780021
         AH    R4,GNDISP                A(N-COUNT) IN CURRENT GN EN     78786021
         LH    R5,DX0(R4)                ADD 1 TO N-COUNT               78792021
         A     R5,ONE                      IN ENTRY                     78798021
         STH   R5,DX0(R4)                                               78804021
         LM    R0,R14,QSAVE                                             78810021
         BCR   UNCOND,R14          RETURN                               78816021
QBLD60   CLI   MCI,XX04             IS ODO ITEM IN WORKING STORAGE      78822021
         BC    NOTEQ,QBLD50        NO                                   78828021
         BAL   R4,QBLD70           YES, PUT OUT QINIT TEXT              78834021
         BC    UNCOND,QBLD50       BRANCH                               78840021
QBLD70   MVC   INITGN(LX2),GNNUMB   NO, PUT OUT QDEF ON FILE 4          78846021
         LA    R3,DX3                                                   78852021
         LA    R2,QDEFTX                                                78858021
         L     R1,COSADR                                                78864021
         BALR  R0,R1               BRANCH TO COMMON ROUTINE             78870021
         DC    X'14'                                                    78876021
         LH    R1,ODOCTR     RCOM) ADD ONE TO ODOCTR IN COMMON          78882021
         A     R1,ONE                FOR EACH                           78888021
         STH   R1,ODOCTR       OM)  QINIT TEXT                          78894021
         BCR   UNCOND,R4           RETURN                               78900021
*                                                                       78906021
*=2    QVARBD-COMBINES QRTN TABLE AND QITBL INTO QVAR TABLE AND LEA     78912021
*              QVAR TABLE FOR PHASE 3.                                  78918021
*                                                                       78924021
         USING *,R15                                                    78930021
QVARBD   STM   R0,R14,QSAVE                                             78936021
         TM    PTBLSW+NX1,XX30     WERE QRTN,QITBL TABLES PRIMED? 55190 78942021
         BCR   NOTONE,R14          NO, RETURN                           78948021
         CLI   ODOCT,XX00           ODO'S FOR TBLSRH                    78954021
         BE    QVAR09              NO                                   78960021
         L   R1,ATBLSH             YES                                  78966021
         L     R1,DX0(R1)                                               78972021
         L     R1,DX0(R1)                                               78978021
         L     R7,QITBLP                GET QITBL                 34761 78984021
         L     R8,DX0(R7)                         TABLE           34761 78990021
         L     R7,DX0(R8)                 ADDRESS                 34761 78996021
         N     R7,MK0932                CLEAR 1ST BYTE                  79002021
         LR    R6,R7                    PUT IN R6                 34761 79008021
         AH    R7,DX4(R8)               GET ADDR OF END OF        34761 79014021
         LR    R5,R7                        TABLE IN R5           34761 79020021
         LR    R7,R6                    R7 = BEGINNING OF TABLE   34761 79026021
         SR    R4,R4                                                    79032021
         IC    R4,ODOCT            HOW MANY VARIABLES                   79038021
QVAR03   TM    DX4(R1),XX10         THIS ENTRY HAVE PTR                 79044021
         BZ    QVAR04              NO                                   79050021
QVAR06   CLC   DX5(LX2,R1),DX6(R7)   EQUAL                              79056021
         BE    QVAR07              YES                                  79062021
         LA    R7,DX8(R7)                                               79068021
         CR    R7,R5                    IS IT END OF QITBL        34761 79074021
         BL    QVAR06                   NO, CHECK NEXT            34761 79080021
         OI    DX4(R1),XX04        YES, LET PH3 KNOW ODO          34761 79086021
*   OBJECT NOT DEFINED                                            34761 79092021
         XC    DX5(LX3,R1),DX5(R1)      PUT ZEROS IN DICT PTR FLD 34761 79098021
         B     QVAR08                   CHECK NEXT ENTRY          34761 79104021
QVAR04   SR    R8,R8                                                    79110021
         IC    R8,DX0(R1)           COUNT OF ENTRY                      79116021
         AR    R1,R8                                                    79122021
         B     QVAR03              CHECK NEXT ENTRY                     79128021
QVAR07   MVC   DX5(LX3,R1),DX1(R7)   MOVE DICT PTR                      79134021
QVAR08   SR    R8,R8                    CLEAR R8                  34761 79140021
         IC    R8,DX0(R1)           GET COUNT                           79146021
         LR    R7,R6                                                    79152021
         AR    R1,R8                                                    79158021
         BCT   R4,QVAR03           SEE IF ENTRY HAD PTR                 79164021
QVAR09   EQU   *                                                        79170021
         L     R1,QRTNPM           YES, ENTER EOT                       79176021
         BAL   R4,QVAR90            VIA QVAR90                          79182021
*DEL                                                                    79188021
*DEL                                                                    79194021
*DEL                                                                    79200021
*DEL                                                                    79206021
QVAR10   L     R1,QITBLP           ENTER EOT VIA                        79212021
         BAL   R4,QVAR90              QVAR90                            79218021
         LA    R1,QVARPM           PRIME QVAR                           79224021
         L     R15,BPRIME                                               79230021
         BALR  R14,R15             CALL PRIME ROUTINE                   79236021
         OI    SWITCH,XX04                                              79242021
         L     R15,AQVARB                                               79248021
         SR    R7,R7                                                    79254021
QVAR15   L     R5,QITBLP                                                79260021
         L     R5,DX0(R5)                                               79266021
         L     R5,DX0(R5)           R5= A(QITBL)                        79272021
         SR    R8,R8                                                    79278021
         S     R5,EIGHT            R5= A(QITBL)-8                       79284021
         S     R8,EIGHT                                                 79290021
QVAR20   L     R6,QRTNPM                                                79296021
         L     R6,DX0(R6)                                               79302021
         L     R6,DX0(R6)           R6= A(QRTN TABLE)                   79308021
         SR    R9,R9                                                    79314021
         MVC   GNGN(LX2),ZEROS                                          79320021
         A     R5,EIGHT            GET NEXT QITBL ENTRY                 79326021
         A     R8,EIGHT            ADD TO DISP IN QITBL OF NEXT         79332021
         CLC   DX0(LX4,R5),ZEROS     IS THIS EOT                        79338021
         BC    EQ,QVAR40           YES                                  79344021
         LA    R0,DX4                                                   79350021
         L     R5,QITBLP           RESTORE QITBL ADDRESS AND            79356021
         BAL   R4,QVAR91           CALL INSERT FOR SPACE IN QVAR TA     79362021
         AR    R5,R8                                                    79368021
         BAL   R4,QVAR95           RESTORE QRTN  ADDRESS                79374021
         MVC   DX0(LX4,R2),DX0(R5)   INSERT DICT. PTR. OF ODO VAR.(FR   79380021
*                                  QITBL) INTO QVAR                     79386021
QVAR21   LH    R10,DX2(R6)          R10= NO. OF OD2TBL DISP. PTRS. I    79392021
*                                   THIS GN QRTN ENTRY                  79398021
         MVC   GNNUMB(LX2),DX0(R6)   PUT GN= FOR THIS ENTRY IN WKARA    79404021
QVAR22   CLC   DX4(LX4,R6),DX4(R5)   COMPARE DISP. PTR. IN QRTN TO      79410021
*                                          DISP. PTR  IN QITBL          79416021
         BC    NOTEQ,QVAR24        NOT EQUAL, BRANCH                    79422021
         CLC   GNGN(LX2),GNNUMB     IS THIS GN IN QVAR ALREADY(DUPLI    79428021
*                                   GN FOR A DICT. PTR)                 79434021
         BC    EQ,QVAR24           YES, BRANCH                          79440021
         LA    R0,DX2               NO, ENTER GN INTO QVAR              79446021
         L     R5,QITBLP           RESTORE QITBL ADDRESS                79452021
         BAL   R4,QVAR91             (QVAR91 GETS SPACE)                79458021
         AR    R5,R8                                                    79464021
         BAL   R4,QVAR95           RESTORE QRTN TABLE ADDRESS           79470021
         MVC   DX0(LX2,R2),GNNUMB                                       79476021
         MVC   GNGN(LX2),GNNUMB     GNGN IS USED FOR DUPLICATE GN CH    79482021
QVAR24   BCT   R10,QVAR25          BRANCH IF MORE OD2TBL DISP. PTRS     79488021
*                                   FOR CURRENT GN OTHERWISE            79494021
         A     R6,EIGHT            GET NEXT GN                          79500021
         A     R9,EIGHT            UP DISP OF QRTN ENTRY                79506021
         CLC   DX0(LX4,R6),ZEROS     IS THIS EOT FOR QRTN TABLE         79512021
         BC    NOTEQ,QVAR21        NO, BRANCH                           79518021
         LA    R0,DX2               YES, CALL INSERT FOR                79524021
         L     R5,QITBLP                RESTORE OF QITBL ADDRESS        79530021
         BAL   R4,QVAR91                SPACE TO INSERT                 79536021
         MVC   DX0(LX2,R2),ZEROS          END OF ENTRY IN QVAR          79542021
         AR    R5,R8                                                    79548021
         BC    UNCOND,QVAR20       BRANCH                               79554021
QVAR25   A     R6,FOUR             GET NEXT OD2TBL DISP. PTR. (QRTN     79560021
         A     R9,FOUR                                                  79566021
         BC    UNCOND,QVAR22       COMPARE DISP PTRS IN QRTN,QITBL      79572021
QVAR40   LA    R0,DX4                                                   79578021
         L     R1,QVARPM                                                79584021
         BAL   R4,QVAR90           GO ENTER EOT                    3548 79590021
*                                                                       79596021
* QVAR IS NOW MODIFIED SUCH THAT EACH DICT. PTR. WILL HAVE ONLY 1 G     79602021
*      ASSOCIATED WITH IT. A CALL TO THAT GN= WILL CALL THE OTHER G     79608021
*                                                                       79614021
QVAR50   L     R5,QVARPM                                                79620021
         L     R5,DX0(R5)                                               79626021
         MVC   DX4(LX2,R5),ZEROS     SET QVAR TABLE DISP. IN TAMM =0    79632021
*                                   FOR IT IS GOING TO BE OVERLAID      79638021
         L     R5,DX0(R5)           R5= A(QVAR)                         79644021
QVAR52   LH    R6,GNCTR    (RCOM) GET A GN= FROM GNCTR                  79650021
         SR    R9,R9               INIT R9 TO SAVE R5 INCREMENT         79656021
         LA    R6,DX1(R6)                                               79662021
         STH   R6,GNCTR                                                 79668021
         STH   R6,GNNUMB           SAVE IT                              79674021
         BAL   R4,QVAR75           PUT OUT GNDEF                        79680021
         LA    R6,DX4(R5)           R6= A(GN=)  OR NEXT GN=             79686021
         A     R9,FOUR                                                  79692021
QVAR54   CLC   DX0(LX2,R6),ZEROS     IS THERE ANOTHER GN                79698021
         BC    EQ,QVAR55           NO, BRANCH                           79704021
         BAL   R4,QVAR76           YES, PUT OUT CALLQ FOR GN            79710021
         A     R6,TWO                                                   79716021
         A     R9,TWO                                                   79722021
         BC    UNCOND,QVAR54       SEE IF THERE IS ANOTHER GN           79728021
QVAR55   A     R6,TWO              R6= A(NEXT DICT. PTR)                79734021
         A     R9,TWO                                                   79740021
         BAL   R4,QVAR77           PUT OUT QRET2                        79746021
         MVC   DX4(LX2,R5),GNNUMB    MOVE NEW GN= TO 1ST OLD GN= IN Q   79752021
         LA    R0,DX6                                                   79758021
         L     R5,QVARPM                                                79764021
         BAL   R4,QVAR91           CALL INSERT AND PUT DICT. PTR AN     79770021
         AR    R5,R7                                                    79776021
         MVC   DX0(LX6,R2),DX0(R5)    IN NEW QVAR                       79782021
         AR    R5,R9                                                    79788021
         AR    R7,R9                                                    79794021
         CLC   DX0(LX4,R5),ZEROS    IS THIS EOT QVAR ?                  79800021
         BC    NOTEQ,QVAR52        NO, BRANCH                           79806021
         LA    R0,DX4               YES, CALL INSERT FOR SPACE          79812021
         L     R5,QVARPM                                                79818021
         BAL   R4,QVAR91                TO ENTER                        79824021
         MVC   DX0(LX4,R2),ZEROS          EOT IN NEW QVAR               79830021
         AR    R5,R7                                                    79836021
         TM    PTBLSW+NX1,XX40      WAS A QFILE TABLE CONSTRUCTED       79842021
         BC    NOTONE,QVAR68       NO, BRANCH                           79848021
*                                                                       79854021
*        THERE IS A QFILE TABLE.                                        79860021
*                                                                       79866021
*        IT IS NOW MODIFIED SO THAT ALL RECORDS UNDER AN FD             79872021
*        WILL HAVE ONLY ONE GN NUMBER.   A CALL TO THAT GN              79878021
*        NUMBER WILL RESULT IN A CALL TO ALL OTHER GN NUMBERS           79884021
*        ASSOCIATED WITH THAT FD.                                       79890021
*                                                                       79896021
*        MODIFICATION OF THE QFILE TABLE IS SIMILAR TO THE              79902021
*        MODIFICATION OF THE QVAR TABLE ABOVE.   FOR EVERY              79908021
*        ENTRY IN THE ORIGINAL QFILE TABLE, A NEW GN NUMBER             79914021
*        IS ASSIGNED.   THE NEW GN NUMBER REPLACES ALL THE              79920021
*        GN NUMBERS IN THE ORIGINAL QFILE ENTRY.   THE NEW              79926021
*        QFILE TABLE IS BUILT OVERLAYING THE ORIGINAL.                  79932021
*        THE NEW QFILE TABLE HAS FIXED LENGTH ENTRIES 4 BYTES           79938021
*        LONG  /DTF NO/GN NO/ 2+2.                                      79944021
*                                                                       79950021
         LA    R0,DX4                *                                  79956021
         L     R1,QFILEP            *  GET NEXT 4 BYTE ENTRY            79962021
         L     R5,QFILEP            *  IN QFILE(I) TABLE.               79968021
         BAL   R4,QVAR92            *                                   79974021
         MVC   DX0(LX4,R2),ZEROS    ENTER EOT IN QFILE(I).              79980021
         L     R5,QFILEP            *  SET 'SET BYTES USED THUS FAR'    79986021
         L     R5,DX0(R5)            *  IN QFILE TAMM TO ZERO.          79992021
         MVC   DX4(LX2,R5),ZEROS      *  QFILE TABLE WILL BE OVERLAID.  79998021
*                                                                       80004021
*        REBUILDING THE QFILE TABLE.                                    80010021
*                                                                       80016021
*        REGISTER ASSIGNMENTS:                                          80022021
*                                                                       80028021
*           R5 - ADDRESS OF CURRENT QFILE(I) TABLE ENTRY.               80034021
*           R7 - DISPLACEMENT OF CURRENT QFILE(I) ENTRY.                80040021
*           R6 - ADDRESS OF CURRENT SUBFIELD WITHIN QFILE(I) ENTRY.     80046021
*           R9 - DISPLACEMENT OF CURRENT SUBFIELD WITHIN                80052021
*                CURRENT QFILE(I) ENTRY.                                80058021
*           R2 - ADDRESS OF CURRENT QFILE(II) TABLE ENTRY.              80064021
*                                                                       80070021
         L     R5,DX0(R5)          ADDR OF QFILE TBL.                   80076021
         SR    R7,R7                *  INITIALIZE                       80082021
         SR    R9,R9                *  REGS.                            80088021
QVAR60   LA    R6,DX2(R5)          ADDR OF 1ST GN SUBFIELD   * QFILE(I) 80094021
         LA    R9,DX2              DISP OF SAME IN NEW ENTRY * TABLE.   80100021
         LH    R4,GNCTR                                                 80106021
         LA    R4,DX1(R4)            *  GET A NEW GN NUMBER.            80112021
         STH   R4,GNCTR                                                 80118021
         STH   R4,GNNUMB          SAVE IT.                              80124021
         BAL   R4,QVAR75          PUT OUT GNDEF FOR NEW GN.             80130021
QVAR64   CLC   DX0(LX2,R6),ZEROS    ANOTHER GN IN QFILE(I) ENTRY ?      80136021
         BE    QVAR66             NO- BRANCH.                           80142021
         BAL   R4,QVAR76          YES- PUT OUT QCALL FOR OLD GN.        80148021
         LA    R6,DX2(R6)            *  INCREMENT TO NEXT SUBFIELD      80154021
         LA    R9,DX2(R9)            *  IN CURRENT QFILE(I) ENTRY.      80160021
         B     QVAR64             CHECK FOR MORE.                       80166021
*                        END OF QFILE(I) ENTRY.                         80172021
QVAR66   LA    R6,DX2(R6)            *  INCREMENT OVER ENTRY            80178021
         LA    R9,DX2(R9)            *  TERMINATION BYTE.               80184021
         BAL   R4,QVAR77          PUT OUT Q-RETURN-2 VERB.              80190021
         MVC   DX2(LX2,R5),GNNUMB   NEW GN TO 1ST OLD GN IN QFILE(I) EN 80196021
         LA    R0,DX4                *                                  80202021
         L     R1,QFILEP            *  GET NEXT 4 BYTE ENTRY IN         80208021
         L     R5,QFILEP            *  QFILE(II).  TBL ADDR IN R5.      80214021
         BAL   R4,QVAR92            *                                   80220021
         AR    R5,R7              ADDR OF CURRENT QFILE(I) ENTRY.       80226021
         MVC   DX0(LX4,R2),DX0(R5)  MOVE OLD DTF, NEW GN TO QFILE(II).  80232021
         AR    R5,R9                *  INCREMENT TO NEXT                80238021
         AR    R7,R9                *  QFILE(I) ENTRY.                  80244021
         CLC   DX0(LX4,R5),ZEROS    IS THIS QFILE(I) EOT ?              80250021
         BNE   QVAR60             NO- BRANCH.                           80256021
         LA    R0,DX4                *                                  80262021
         L     R1,QFILEP            *  GET NEXT 4 BYTE ENTRY IN         80268021
         L     R5,QFILEP            *  QFILE(II).  TBL ADDR IN R5.      80274021
         BAL   R4,QVAR92            *                                   80280021
         MVC   DX0(LX4,R2),ZEROS    ENTER QFILE(II) EOT.                80286021
         BAL   R4,QVAR90           GO INTER EOT                         80292021
QVAR68   L     R1,QRTNPM           RELEASE TABLES                       80298021
         L     R15,BTABRL              QRTN                             80304021
         BALR  R14,R15             BRANCH                               80310021
         L     R1,QITBLP               QITBL                            80316021
         BALR  R14,R15             BRANCH                               80322021
         LM    R0,R14,QSAVE                                             80328021
         BCR   UNCOND,R14          RETURN                               80334021
QVAR75   MVC   QCALL+NX3(LX2),GNNUMB PUT GN IN GNDEF                    80340021
         MVI   QCALL+NX2,XX88       SET GNDEF CODE                      80346021
         LA    R3,DX3                                                   80352021
         LA    R2,QCALL+NX2                                             80358021
         BC    UNCOND,QVAR81       SET UP FOR CALL TO COMMON RTN        80364021
QVAR76   MVI   QCALL+NX1,XX4C       SET UP QCALL VERB                   80370021
         MVC   QCALL+NX3(LX2),DX0(R6) PUT GN IN GNDEF                   80376021
         MVI   QCALL+NX2,XXAA       SET GNREF CODE                      80382021
         LA    R3,DX5                                                   80388021
         BC    UNCOND,QVAR80       BRANCH                               80394021
QVAR77   MVI   QCALL+NX1,XX4D       SET UP QRET2 VERB                   80400021
         LA    R3,DX2                                                   80406021
QVAR80   LA    R2,QCALL            PUT AREA                             80412021
QVAR81   LR    R1,R11              COSADRESS                            80418021
         BALR  R0,R1               GO TO COMMON RTN                     80424021
         DC    X'12'               PUT ON FILE 2                        80430021
         BCR   UNCOND,R4           BRANCH                               80436021
QVAR90   L     R15,BINSRT          ENTER EOT                            80442021
         BALR  R14,R15             CALL INSERT ROUTINE                  80448021
         L     R15,AQVARB                                               80454021
         MVC   DX0(LX4,R2),ZEROS     EOT= FW ZEROS                      80460021
LX3      EQU   3                                                        80466021
LX4      EQU   4                                                        80472021
LX6      EQU   6                                                        80478021
LX7      EQU   7                                                        80484021
LX10     EQU   10                                                       80490021
LX11     EQU   11                                                       80496021
LX12     EQU   12                                                       80502021
LX14     EQU   14                                                       80508021
LX17     EQU   17                                                       80514021
LX20     EQU   20                                                       80520021
LX24     EQU   24                                                       80526021
LX30     EQU   30                                                       80532021
LX31     EQU   31                                                       80538021
LX32     EQU   32                                                       80544021
LX34     EQU   34                                                       80550021
LX36     EQU   36                                                       80556021
LX46     EQU   46                         ***                           80562021
LX66     EQU   66                                                       80568021
LX100    EQU   100                                                      80574021
LX133    EQU   133                                                      80580021
DX144    EQU   144                                                      80586021
LX215    EQU   215                                                      80592021
LX216    EQU   216                                                      80598021
LX222    EQU   222                                                      80604021
         BCR   UNCOND,R4           BRANCH                               80610021
QVAR91   L     R1,QVARPM                                                80616021
QVAR92   L     R15,BINSRT                                               80622021
         BALR  R14,R15             CALL INSERT ROUTINE                  80628021
         L     R15,AQVARB                                               80634021
         L     R5,DX0(R5)           R5 = A(TAMM)                        80640021
         L     R5,DX0(R5)           R5 = A(TABLE)                       80646021
         BCR   UNCOND,R4           BRANCH                               80652021
QVAR95   L     R6,QRTNPM           R6 = A(TIB)                          80658021
         L     R6,DX0(R6)           R6 = A(TAMM)                        80664021
         L     R6,DX0(R6)           R6 = A(QRTN TABLE)                  80670021
         AR    R6,R9               R6 = A(THIS ENTRY)                   80676021
         BCR   UNCOND,R4           BRANCH                               80682021
PATCH1   DS    0F                                                       80688021
IKFPATCH DS    0H                                                       80694021
PATCH    ST    R15,PATCHRSV        SAVE REGISTER BEFORE RELOADING PATCH 80700021
         L     R15,AQVARB          BASE REG POINTING TO QVARBD    PATCH 80706021
         B     IKFPATCH           THIS INSTR INDICATES DISPL            80712021
         DC    800X'FF'            PATCH SPACE                    PATCH 80718021
         EJECT                                                          80724021
IKF215   CSECT                                                          80730021
         DS    0F                                                       80736021
PH2SAV DS    18F                                                        80742021
PATCHRSV DS    F                   REG SAVE AREA FOR PATCHING     PATCH 80748021
PATCH2   DC    160C'P'            PATCH AREA ADDRESSABLE BY R13   PATCH 80754021
BRATAB   DC    C'$'                BRANCHING TABLE TO PROPER ROUTIN     80760021
         DC    AL3(BDOLLR)         DEPENDING ON CHARACTER               80766021
         DC    C'*'                                                     80772021
         DC    AL3(BASTSK)                                              80778021
         DC    C'Z'                                                     80784021
         DC    AL3(BZUPP)                                               80790021
         DC    C'+'                                                     80796021
         DC    AL3(BPLUSB)                                              80802021
         DC    C'-'                                                     80808021
         DC    AL3(BPLUSB)                                              80814021
         DC    C'9'                                                     80820021
         DC    AL3(BNINEB)                                              80826021
         DC    C'C'                                                     80832021
         DC    AL3(BCREDB)                                              80838021
         DC    C'D'                                                     80844021
         DC    AL3(BDEBIT)                                              80850021
CONCOM   DC    C','                                                     80856021
         DC    AL3(BZEROB)                                              80862021
         DC    C'0'                                                     80868021
         DC    AL3(BZEROB)                                              80874021
         DC    C'B'                                                     80880021
         DC    AL3(BZEROB)                                              80886021
         DC    C'P'                                                     80892021
         DC    AL3(BSCALB)                                              80898021
CONPER   DC    C'.'                                                     80904021
         DC    AL3(BVVVVB)                                              80910021
         DC    C'V'                                                     80916021
         DC    AL3(BVVVVB)                                              80922021
         DS    0F                                                       80928021
SECTTB   DC    X'02'               BRANCHING TABLE TO PROPER PROCES     80934021
         DC    AL3(FILEST)         DEPENDING ON TYPE OF CONTROL BRE     80940021
         DC    X'03'               AK                                   80946021
         DC    AL3(WSTSCT)                                              80952021
         DC    X'04'                                                    80958021
         DC    AL3(LINKST)                                              80964021
         DC    X'05'                                                    80970021
         DC    AL3(REPORT)                                              80976021
KYLNTB   DC    X'FF000000FF101400041C20080C18FFFF'                      80982021
*ACCESS METHOD TABLE                                                    80988021
ACCTAB   DS    0F                                                       80994021
* QSAM                                                                  81000021
         DC    X'0000'            KEY DISP                              81006021
         DC    X'00'              V-COUNT                               81012021
         DC    X'F6'                     ILBOERR                  48401 81018021
         DC    H'122'                     DCB LENGTH              48401 81024021
         DC    X'00'              DECB                                  81030021
         DC    X'00'              *                                     81036021
         DC    X'00'              ACCESS                                81042021
         DC    X'40000000000142000001'  DCB+26 - DCB+35                 81048021
         DC    X'AD'              ACCESS TYPE                           81054021
         DC    X'00'              OPEN TABLE                            81060021
         DC    X'00'              MODE TABLE                            81066021
         DS    3C                 *                                     81072021
         DC    X'00'              OPTCD                                 81078021
         DC    X'8060'            CLSMSK                                81084021
         DC    F'0'               A(KEYRTN)                             81090021
* QISAM                                                                 81096021
         DC    X'0000'                                                  81102021
         DC    X'00'                                                    81108021
         DC    X'F4'                                                    81114021
         DC    H'260'                                                   81120021
         DC    X'00'                                                    81126021
         DC    X'00'                                                    81132021
         DC    X'10'                                                    81138021
         DC    X'80000000000142000001'                                  81144021
         DC    X'A1'                                                    81150021
         DC    X'10'                                                    81156021
         DC    X'09'                                                    81162021
         DS    3C                                                       81168021
         DC    X'00'                                                    81174021
         DC    X'9441'                                                  81180021
         DC    A(KEYRTN)                                                81186021
* BISAM                                                                 81192021
         DC    X'0014'                                                  81198021
         DC    X'30'                                                    81204021
         DC    X'F5'                                                    81210021
         DC    H'256'                                                   81216021
         DC    X'1C'                                                    81222021
         DC    X'02'                                                    81228021
         DC    X'20'                                                    81234021
         DC    X'80000000000142000001'                                  81240021
         DC    X'1E'                                                    81246021
         DC    X'20'                                                    81252021
         DC    X'09'                                                    81258021
         DS    3C                                                       81264021
         DC    X'00'                                                    81270021
         DC    X'1445'                                                  81276021
         DC    A(KEYRTN)                                                81282021
* BSAM-R                                                                81288021
         DC    X'0014'                                                  81294021
         DC    X'00'                                                    81300021
         DC    X'F2'                                                    81306021
         DC    H'100'                                                   81312021
         DC    X'1C'                                                    81318021
         DC    X'80'                                                    81324021
         DC    X'40'                                                    81330021
         DC    X'40000000000100000001'                                  81336021
         DC    X'00'                                                    81342021
         DC    X'30'                                                    81348021
         DC    X'12'                                                    81354021
         DS    3C                                                       81360021
         DC    X'00'                                                    81366021
         DC    X'1020'                                                  81372021
         DC    A(KEYRTN)                                                81378021
* BSAM-D                                                                81384021
         DC    X'0000'                                                  81390021
         DC    X'40'                                                    81396021
         DC    X'F2'                                                    81402021
         DC    H'124'                                                   81408021
         DC    X'1C'                                                    81414021
         DC    X'80'                                                    81420021
         DC    X'44'                                                    81426021
         DC    X'40000000000100000001'                                  81432021
         DC    X'00'                                                    81438021
         DC    X'30'                                                    81444021
         DC    X'1B'                                                    81450021
         DS    3C                                                       81456021
         DC    X'00'                                                    81462021
         DC    X'2860'                                                  81468021
         DC    A(KEYRTN)                                                81474021
* BDAM-R                                                                81480021
         DC    X'0000'                                                  81486021
         DC    X'00'                                                    81492021
         DC    X'F3'                                                    81498021
         DC    H'104'                                                   81504021
         DC    X'24'                                                    81510021
         DC    X'00'                                                    81516021
         DC    X'80'                                                    81522021
         DC    X'20000000000100000001'                                  81528021
         DC    X'1C'                                                    81534021
         DC    X'40'                                                    81540021
         DC    X'12'                                                    81546021
         DS    3C                                                       81552021
         DC    X'01'                                                    81558021
         DC    X'1024'                                                  81564021
         DC    A(KEYRTN)                                                81570021
* BDAM-W                                                                81576021
         DC    X'0000'                                                  81582021
         DC    X'40'                                                    81588021
         DC    X'F3'                                                    81594021
         DC    H'104'                                                   81600021
         DC    X'24'                                                    81606021
         DC    X'00'                                                    81612021
         DC    X'84'                                                    81618021
         DC    X'20000000000100000001'                                  81624021
         DC    X'1F'                                                    81630021
         DC    X'50'                                                    81636021
         DC    X'1B'                                                    81642021
         DS    3C                                                       81648021
         DC    X'00'                                                    81654021
         DC    X'2822'                                                  81660021
         DC    A(KEYRTN)                                                81666021
* BDAM-D                                                                81672021
         DC    X'0000'                                                  81678021
         DC    X'40'                                                    81684021
         DC    X'F3'                                                    81690021
         DC    H'124'                                                   81696021
         DC    X'28'                                                    81702021
         DC    X'00'                                                    81708021
         DC    X'8C'                                                    81714021
         DC    X'20000000000100000001'                                  81720021
         DC    X'1F'                                                    81726021
         DC    X'50'                                                    81732021
         DC    X'1B'                                                    81738021
         DS    3C                                                       81744021
         DC    X'00'                                                    81750021
         DC    X'2862'                                                  81756021
         DC    A(KEYRTN)                                                81762021
KEYMSK   DS    0CL4                MASK FOR:                            81768021
         DC    X'00'                                                    81774021
         DC    X'04'               RECORD KEY                           81780021
         DC    X'08'               ACTUAL KEY                           81786021
         DC    X'10'               SYMBOLIC KEY                         81792021
KYCODE   DC    X'CDB6B5'           COBOL WORD CODES                     81798021
*                                  CD = RECORD                          81804021
*                                  B6 = ACTUAL                          81810021
*                                  B5 = SYMBOLIC                        81816021
BLNTAB   DC    X'00'               NORM. LEVEL ='S TABLE                81822021
         DC    49X'00'                                                  81828021
BDAMS    DC    X'200000000100040001'                                    81834021
         DS    0H                  TRACK CAPACITY TABLE                 81840021
TRKCAP   DC    H'0'                                                     81846021
         DC    H'20483'            2301                                 81852021
         DC    H'4984'             2302                                 81858021
         DC    H'4892'             2303                                 81864021
         DC    H'3625'             2311                                 81870021
         DC    H'7188'             2314                                 81876021
         DC    H'2000'             2321                                 81882021
BPICTR   DS    0CL256              LEGAL PICTURE TABLE                  81888021
         DC    5X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                       81894021
         DC    X'08FFFF08'         .  +                                 81900021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFF'                              81906021
         DC    X'1010FFFFFF08'     $*   -                               81912021
         DC    X'10FFFFFFFFFFFFFFFFFF'  /                               81918021
         DC    X'10'               ,                                    81924021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFF10'   COLON                81930021
         DC    X'FFFFFFFFFFFFFFFFFF10'             PENCE                81936021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                        81942021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFF10'   SHILLING             81948021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                        81954021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                        81960021
         DC    X'8010101020'       ABCDE                                81966021
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      81972021
         DC    X'FF02FF10'          P R                                 81978021
         DC    X'FFFFFFFFFFFFFFFF'                                      81984021
         DC    X'01FFFF04FF40FF10' S  V X Z                             81990021
         DC    X'FFFFFFFFFFFF'                                          81996021
         DC    X'10'               0                                    82002021
         DC    X'FFFFFFFFFF606010'       6 7 8                    37098 82008021
         DC    X'04'               9                                    82014021
         DC    X'FFFFFFFFFFFF'                                          82020021
*  PICTURE TYPE TABLE                                                   82026021
PTYPTB   DC    X'040305030603070308040A040C040E04'                      82032021
         DC    X'100412041404160418041A041C041E04'                      82038021
         DC    X'24052C05400244025008540880018402'                      82044021
         DC    X'900874067506C402D008D408'              **        37098 82050021
BPICTB   DC    F'0'                BRANCHING TABLE                      82056021
         DC    A(BALPHA)           FOR ANALYSIS                         82062021
         DC    A(BALPHA)           OF PICTURE                           82068021
         DC    A(BNUMER)           CLAUSES                              82074021
         DC    A(BREPOR)                                                82080021
         DC    A(BFLTPT)                                                82086021
         DC    A(BSTERL)                                                82092021
         DC    A(BSTREP)                                                82098021
         DC    A(BANRPT)                                                82104021
*  PROGRAM CONSTANTS.                                                   82110021
*                                                                       82116021
ZEROS    DC    F'0'                                                     82122021
ONE      DC    F'1'                                                     82128021
TWO      DC    F'2'                                                     82134021
THREE    DC    F'3'                                                     82140021
FOUR     DC    F'4'                                                     82146021
FIVE     DC    F'5'                                                     82152021
SIX      DC    F'6'                                                     82158021
SEVEN    DC    F'7'                                                     82164021
EIGHT    DC    F'8'                                                     82170021
NINE     DC    F'9'                                                     82176021
TEN      DC    F'10'                                                    82182021
ELEVEN   DC    F'11'                                                    82188021
TWELVE   DC    F'12'                                                    82194021
CON13    DC    F'13'               CONSTANT 13.                         82200021
CON14    DC    F'14'                                                    82206021
CON15    DC    F'15'                                                    82212021
CON16    DC    F'16'                                                    82218021
CON18    DC    F'18'                                                    82224021
CON19    DC    F'19'                                                    82230021
TWENTY   DC    F'20'                                                    82236021
CON24    DC    F'36'                                                    82242021
CON23    DC    F'23'                                                    82248021
CON34    DC    F'34'                                                    82254021
FIFTY  DC    F'50'                                                      82260021
FIFTY1   DC    F'51'                                                    82266021
FIFTY7   DC    F'00000057'                                              82272021
CON60    DC    F'60'                                                    82278021
CON128   DC    F'128'                                                   82284021
CON256   DC    F'256'                                                   82290021
SRANO    DC    X'00'               SAME RECORD AREA NO FOR SD           82296021
PSRANO   DC    X'00'               PREVIOUS SRANO                       82302021
SREG2    DS    F                                                        82308021
CON32K   DC    F'32767'                                                 82314021
C32760   DC    F'32760'                                                 82320021
CO4096   DC    F'4096'             4096 IN MAGNITUTE.                   82326021
M8192  DC    F'8192'                                                    82332021
CO131K   DC    F'131071'           131K IN MAGNITUDE.                   82338021
TENPW9   DC    F'1000000000'       10 TO THE POWER OF 9.                82344021
MAXHAF   DC    X'000000000032767C'                                      82350021
MINHAF   DC    X'000000000032768D'                                      82356021
MAXFUL   DC    X'0000000000000000000002147483647C'                      82362021
MINFUL   DC    X'0000000000000000000002147483648D'                      82368021
SAVZONE  DS    1C                                                       82374021
ACKETXT  DC    A(CKETXT)                                                82380021
*                                                                       82386021
*  MASKS.                                                               82392021
*                                                                       82398021
MK2532   DC    F'255'                                                   82404021
MK0932   DC    X'00FFFFFF'                                              82410021
MK3032   DC    X'00000007'                                              82416021
MK0015   DC    X'0000000F'                                              82422021
MK2632   DC    X'0000007F'                                              82428021
MK2529   DC    X'000000F8'                                              82434021
MK2528   DC    X'000000F0'                                              82440021
MK2830   DC    X'0000001C'                                              82446021
MK1732   DC    X'0000FFFF'         16 BITS,A HALF WORD.                 82452021
MK2132   DC    X'00000FFF'         SAVE ONLY LAST 12 BITS.              82458021
MK1632   DC    X'0001FFFF'         17 BITS FROM BIT 16 TO 32.           82464021
MK0930   DC    X'00FFFFFC'                                              82470021
MK0129   DC    X'FFFFFFF8'                                              82476021
*                                                                       82482021
AMBSRN   DC    A(BMBSRN)                                                82488021
PRMTBL   DC  X'002080806060A0A00040C0E0A0A0C0C0'                        82494021
BRPTAB   DC    X'0101020001030300' SCALE LEGAL                          82500021
BPTABL   DC    X'0102010000000000' P TABLE                              82506021
BVTABL   DC    X'0201000000020000' V TABLE                              82512021
BDPTAB   DC    X'000000AAAAAABBBBBBCCCCCC' DICT PTR TABLE FOR MBS       82518021
BDECTB   DC    C'$+-9*Z'           NUMERIC TABLE                        82524021
BASLOC   DC    X'00001000000000'                                        82530021
BFIXCN   DC    X'01F900010001'     CONSTANT PICTURE FOR ERROR COND      82536021
DEBIT    DC    C'DB'                                                    82542021
CREDIT   DC    C'CR'                                                    82548021
BDUMMY   DC    X'015B'           01USED BY PHTERM                       82554021
X4848    DC    X'4848'                                                  82560021
X4844    DC    X'4844'                                                  82566021
DNREF    DC    X'300B'             FOR INCRA VERB                       82572021
FES      DC    X'00'               USED BY FD ROUTINES                  82578021
UPDTCD DC      X'810000'     CARD NUM FOR UPDATE VERB                   82584021
UPDTVB   DC    X'4443BB0000'       Q                                    82590021
INCRAV   DC    X'4441'             ROUTINE                              82596021
INITVB   DC    X'4440FA040000BB00' VERBS                                82602021
UPDTOP   DC    X'BB0000FA04'                                            82608021
INCROP   DC    X'FA040000FA2C'                                          82614021
STEPVL   DC    X'4442FA040000FA04'                                      82620021
UPDTOC   DC    X'4443BB0000FA040000BB0000FA04'                          82626021
RNMQRN   DC    X'4476FA040000FA2C0000FA2C0000BB0000'                    82632021
QCALL    DC    X'4400880000'       END OF Q-ROUTINE VERBS               82638021
QRTNHD   DC    X'420A'             QRTN HEADER FOR P4 P5                82644021
VLCCUR   DC    X'04'               SET Q RTN                            82650021
VLCSET   DC    X'00'                 VLC                                82656021
ODOMAX   DS    2C                  NOC FOR UPDATE VERB OP 1             82662021
ODOFIG   DC    X'01F0'             FIGURATIVE CONSTANT                  82668021
SECTSW   DC    X'00'               CURRENT SECTION                      82674021
SECTSAV  DC    X'00'                      SAVE SECTION CODE       44287 82680021
OD2SW    DC    X'00'               SW= 1 IF MORE THAN 1 ODO IN AN 0     82686021
ODOCCT   DC    X'00'               = OF ODO IN AN 01                    82692021
LBLSW    DC    X'00'               LABEL SWITCH                         82698021
PLBLSW   DC    X'00'               PRIOR LABEL SWITCH                   82704021
PTBLSW   DS    3C                                                       82710021
PRMSW    DS    C                  BIT 0 TOTL TBL PRIMED                 82716021
BPERRO   DC    X'00'               SA   6  PICTURE   7                  82722021
ODOVSW   EQU   BPERRO              BIT 7= 1 ERROR 158 WAS PUT OUT       82728021
*                                         IN ELIODO RTN.                82734021
FDDCBNO  DC    X'00'                    DCB NO ASSOCIATED WITH REC45078 82740021
PRDCBNO  DC    X'00'                      PRESENT DCB NO          45078 82746021
COPYSW   DS    C             LOW ORDER BIT IS COPY SWITCH               82752021
FSTSW    EQU   COPYSW                                                   82758021
WSRSW    DC    X'00'               WS SECTION AND REPORT SECTION        82764021
NOFDSW   DC    X'00'               TURNED ON WHEN FIRST FD,SD,OR        82770021
NOFDBIT  EQU   X'02'                                                    82776021
FSTFDBIT EQU   X'01'                                                    82782021
NOFDOFF  EQU   X'FD'                                                    82788021
*                                    SA FOUND, USED BY ELIODO           82794021
BRETSW   DC    X'00'                         SWITCH               47046 82800021
XTNSBL   DC    X'00'                                                    82806021
SW88     DC    X'00'               88 SWITCH                            82812021
BYTESW   DC    X'00'               NUMERIC PICTURE ANALYSIS SWITCH      82818021
DECSW    DC    X'00'               BNUMER DECIMAL SW                    82824021
SCSIGN   DC    X'00'               BNUMER SEIGN SW                      82830021
BEXPSW   DC    X'00'               BFLTPT SW FOR SIGN DEC 9 AND E       82836021
BSTRSW   EQU   BEXPSW                                                   82842021
LIDLGS   DC    X'00'               BIT 7 = 1 IF LAST GROUP ITEM'S       82848021
*                            DICT. PTR. SHOULD BE OBTAINED FROM         82854021
*                            LID(LAST ITEM DELETED). BIT 7 = 0 IF       82860021
*                            ABOVE SHOULD BE OBTAINED FROM GPLSTK T     82866021
*                            (USED IN REDEF ROUTINE).                   82872021
ASYNSW   DS    C                                                        82878021
BYTE67   EQU   ASYNSW                                                   82884021
BVPCHK   DS    C                   PICT CHAR CHECK BYTE                 82890021
NXTLEV   DS    C                   NEXT LEVEL NUMBER                    82896021
NXCISW   DC    X'00'               INDICATES NEXT FD IN CI FOR ADP0     82902021
NOADD    DC    X'00'          TELLS ADP310 NOT TO ASSIGN NEW BLLCTR     82908021
         DS    0H                                                       82914021
         DC    X'00'                                                    82920021
MSGDEF   DC    X'0006000000000002' MESSAGE TEXT                         82926021
MSGPRM   DC    X'00025400'         MESSAGE PARAMETER FIELD              82932021
CARDNO   DS    2C                  CURRENT CARD NUMBER                  82938021
SAVCDNO  DS    2C                                                       82944021
SASUMV   EQU   * STERLING REPORT PICTURE ASSUMED VALUES AND CONSTAN     82950021
         DC    X'14'              NO.OF PICTURE BYTES                   82956021
         DC    X'00'          NOT BLANK WHEN ZERO,SEPARATORD D          82962021
         DC    X'5B0D0600'    FLOAT,LENGTH,NO.OF $,NO.OF DEC PENCE      82968021
STLASM   DC    X'5B06F9014001C401'      POUNDS    $$$$$$9BD             82974021
STSASM   DC    X'E901F9014001C401'      SHILLINGS Z9BD                  82980021
STPASM   DC    X'E901F901'              PENCE     Z9                    82986021
HW127    DC    H'127'         127 IN HALF WORD                          82992021
HW129  DC      H'129'             129 IN HALF WORD                      82998021
*                                                                       83004021
*  CURRENT ITEM  ( C I ).                                               83010021
*                                                                       83016021
         DS    0F                                                       83022021
CI       DS    0CL160                   CURRENT ITEM SET UP AREA        83028021
NUMBCD   DS    C                   SAVE AREA                            83034021
BCDNAM   DS    31C                 FOR BCD-NAME                         83040021
ATTRIB   DS    106C            DICT. ATTRIBUTE SET UP AREA        32352 83046021
*                                                                       83052021
*  LD DICTIONARY ENTRY ATTRIBUTE FORMAT                                 83058021
*                                                                       83064021
COUNT  EQU   ATTRIB               COUNT+MAJOR CODE=4+4                  83070021
MINCOD EQU   ATTRIB+1             MINCD+MBS+OCCURS+REDEF=4+2+1+1        83076021
ADDPAR EQU   ATTRIB+2             ADDRESSING PARAMETER=24               83082021
SYNCHR EQU   ATTRIB+5             INDX+SYNCH+R/L+LABEL+X=1+1+1+1+4      83088021
LEVNUM EQU   ATTRIB+6             LEVNUM+Q-RTN+NEXT FIELD=6+1+1         83094021
VILGN  EQU   ATTRIB+7             INFO ON ITEM LENGTH, OCCURS PTR       83100021
REPPIC EQU   ATTRIB+9             AND REPORT PICTURE INFORMATION        83106021
*                                                                       83112021
* SD DICTIONARY ATTRIB                                                  83118021
*                                                                       83124021
SDCOUNT  EQU   ATTRIB             COUNT+MAJOR CODE=4+4                  83130021
SDNOBL   EQU   ATTRIB+1           X+MODE+X+NOBL=1+2+1+4                 83136021
SDBLNO   EQU   ATTRIB+2           FIRST BL NO=8                         83142021
SDMAX    EQU   ATTRIB+3           MAX RECORD LENGTH=2                   83148021
SDMIN    EQU   ATTRIB+5           MIN RECORD LENGTH=2                   83154021
SDUNU    EQU   ATTRIB+7           X=1                                   83160021
*                                                                       83166021
*  FD DICTIONARY ENTRY ATTRIBUTE FORMAT                                 83172021
*                                                                       83178021
FDCUNT EQU   ATTRIB               COUNT+MAJOR CODE=4+4                  83184021
FDNOBL EQU   ATTRIB+1             Q-RTN+MODE+PROTCT,NOBL=1+2+1+4        83190021
FDBLNO EQU   ATTRIB+2             FIRST BL NO=8                         83196021
FDCBNO EQU   ATTRIB+3             DCB NO=8                              83202021
FDACMT EQU   ATTRIB+4             ACCESS METHOD+OPTIONS=4+4             83208021
FDECNO EQU   ATTRIB+5             DECB NO=8                             83214021
FDMAX    EQU   ATTRIB+6           MAX. DATA RECORD SIZE=16              83220021
FDVCNT EQU   ATTRIB+8             VAR INFO CNT+SAME RCD+X=4+1+3         83226021
FDKEYADP EQU   ATTRIB+9           ACT-KEY IDK FOR DIRECT FILE=24        83232021
FDREORG  EQU   ATTRIB+9           REORG-DN IDK FOR BISAM FILE=24        83238021
FDKEYLNG EQU   ATTRIB+12          ACT-KEY LNG-4 FOR DIRECT FILE=24      83244021
         CNOP  2,4                                                      83250021
ITMCLS   DS    2C                  ITEM CLASS                           83256021
CILGN    DS    2C                  CURRENT ITEM LENGTH                  83262021
OBJDIS   DS    2C                  DISPLACEMENT IN ODLTBL               83268021
NOC      DS    2C                  NUMBER OF OCCURENCES                 83274021
CARDXX   DS    2C                  *************************            83280021
OBJRED   DS    4C                                                       83286021
DICTPT   DS    4C                  DICTIONARY POINTER                   83292021
SRCELN   DS    C                   LEVEL NUMBER                         83298021
CILEV    EQU   SRCELN                                                   83304021
ELITEM   DS    0CL216         ELEMENTARY ITEM WORK AREA                 83310021
IPT      DS    31C            INITIAL PICTURE TABLE                     83316021
IPLT     DS    31H            INITIAL PICTURE LENGTH TABLE              83322021
LITVAL   DS    121C           LITERAL OF VALUE CLAUSE                   83328021
NOOFPS   DS    C              NUMBER OF P,S IN PICTURE                  83334021
PCTYPE   DS    C              PICTURE TYPE CODE                         83340021
       ORG   CI+41                FD WORK AREA                          83346021
         DS    0F                                                       83352021
DCBCON   DS    7C                  IC-TEXT FOR DCB ADCON                83358021
DCB      DS    102C                    DATA CONTROL BLOCK AREA          83364021
         DS    0F                                                       83370021
DECBCN   DS    7C                  IC-TEXT FOR DECB ADCON               83376021
DECB     DS    40C                 DATA EVENT CONTROL BLOCK             83382021
         DS    0F                                                       83388021
DECBDF   DS    9C                  WORK AREA FOR DECB DEFINITION        83394021
DCBDEF   EQU   DECBDF                            DCB  DEFINITION AN     83400021
INDADF   EQU   DECBDF                            INDIRECT ADDRESS D     83406021
ACONDF   EQU   DECBDF                            ADCON DEFINITIONS      83412021
DCBADD   DS    F                   RELATIVE LOC. OF CURRENT DCB         83418021
DECBAD   DS    F                   RELATIVE LOC. OF CURRENT DECB        83424021
KEYINS   DS    0F                  INSERT TO BE MADE TO-                83430021
KEYLGN   DS    F                       RCKTBL-RECORD KEY TABLE          83436021
KEYLOC   DS    F                       KEYTBL-SYM AND ACT KEY TABLE     83442021
KYDECB   DS    F                               SEQUENTIAL PROCESSIN     83448021
BSAMDP   EQU   KYDECB                  KEYRAN-SYM AND ACT KEY TABLE     83454021
NCYC     DS    H                               ASSYNCHRONOUS PROCES     83460021
APPTSA   DS    2C                                                       83466021
CARDKY   DS    2C                                                       83472021
*                                 *KEYLGN-THE REL LOC OF KEYLGN(DCB     83478021
*                                 *KEYLOC-THE REL LOC OF RKP(RECORD     83484021
*                                          DISP.)IN DCB                 83490021
*                                          OR                           83496021
*                                         THE REL LOC OF SYM/ACT KE     83502021
*                                          DECB                         83508021
*                                 *KYDECB-THE REL LOC OF RECORD KEY     83514021
*                                          DECB                         83520021
*                                 *BSAMDP-THE PTR TO BSAM TABLE IF      83526021
*                                          KEY IS USED IN BSAM DIRE     83532021
*                                 *NCYC  -THE NUMBER OF CYCLES IF       83538021
*                                          ASSYNCHRONOUS PROC.          83544021
*                                 *LDECB - THE LGN OF DECB IF ASSYN     83550021
*                                            RONOUS PROC.               83556021
*                                  *APPTSA- PTR TO SA THAT KEY SHOU     83562021
*                                           BE IN                       83568021
       ORG   CI+41                CHECK POINT WORK AREA                 83574021
* DCB AND DECB FOR RERUN.                                               83580021
DCBCCN   DC    F'0'                                                     83586021
         DC    X'000064'                                                83592021
DCBC     DC    X'00000000000000000000000000000000'                      83598021
         DC    X'00000000000000'                                        83604021
         DC    X'01'                         A(BUFCB)=1                 83610021
         DC    X'000040000000000100000001'   DSORG=PS                   83616021
         DC    X'C0'                         RECFM=C0  UNDEFINED        83622021
         DC    X'00000000000000000000000200'  DCB FLGS FOR RERUN        83628021
         DC    X'0020'            MACRF=WRITE                           83634021
         DC    X'00000001000000'                                        83640021
         DC    X'01'                         A(SYNAD)=1                 83646021
         DC    X'0000'                                                  83652021
         DC    X'0000'            BLKSIZE UNSPECIFIED                   83658021
         DC    X'00000000000000010000000100000001'                      83664021
         DC    X'00000000000000010000000000000000'                      83670021
         DC    X'00000000'                                              83676021
DECBCC   DC    F'0'                                                     83682021
         DC    X'00001C'                                                83688021
DECBC    DC    X'00000000'                                              83694021
         DC    X'0020'                                                  83700021
         DC    X'0000'                                                  83706021
         DC    X'00000000'                                              83712021
         DC    X'0000000000000000'                                      83718021
WORKC    DC    X'0000'                       CHECK POINT WORK AREA      83724021
         DC    X'8000'                                                  83730021
         DC    X'00000000'                                              83736021
         ORG   PCTYPE+1                                                 83742021
         DS    0F                                                       83748021
* WORK AREA FOR TRACK-AREA IS DATA-NAME CLAUSE                          83754021
TRACK    DS    11C                                                      83760021
SCAR     DS    0CL14                                                    83766021
MCI      DS    C              MAJOR CODE INDICATOR                      83772021
*                             0    FD                                   83778021
*                             1    SD                                   83784021
*                             2   FD (ASSYNCHRONOUS PROCESSING)         83790021
*                             3    SA                                   83796021
*                             4    WORKING-STORAGE SECTION              83802021
*                             5    LINKAGE SECTION                      83808021
*                             6    REPORT SECTION                       83814021
GLN      DS    C              LEVEL = OF CURRENT GROUP                  83820021
GUI      DS    C              USAGE OF CURRENT GROUP                    83826021
*                             0    NO USAGE ON CURRENT GROUP            83832021
*                             1    DISPLAY                              83838021
*                             2    COMPUTATIONAL                        83844021
*                             3    COMPUTATIONAL-1                      83850021
*                             4    COMPUTATIONAL-2                      83856021
*                             5    COMPUTATIONAL-3                      83862021
*                             6    DISPLAY-ST                           83868021
OLN      DS    4C             LEVEL ='S OF ITEMS WHICH HAVE OCCURS      83874021
*                             CLAUSES                                   83880021
OCT      DS    C              NUMBER OF ENTRIES IN OLN                  83886021
FESB     DS    C              FIRST ENTRY SWITCH                        83892021
*                             BIT0      UNUSED                          83898021
*                                1      UNUSED                          83904021
*                                2      UNUSED                          83910021
*                                3      UNUSED                          83916021
*                                4      UNUSED                          83922021
*                                5      UNUSED                          83928021
*                                6      LEVEL 01 HAS APPEARED           83934021
*                                7      LEVEL 77 HAS APPEARED           83940021
BAS      DS    4C             LEVEL ='S OF ITEMS WITH OCCURS DEPEND     83946021
*                             ON CLAUSES                                83952021
BASI     DS    C              COUNT OF NUMBER OF ENTRIES IN BAS         83958021
*                                                                       83964021
*  PREVIOUS TO CURRENT ITEM. ( P C I ).                                 83970021
*                                                                       83976021
         DS    0F                                                       83982021
PCI      DS    0CL160                   PREV ITEM SET UP AREA           83988021
PNMBCD   DS    C                   NO. OF BCD CHARACTERS IN NAME.       83994021
PBCDNM   DS    30C                 BCD NAME.                            84000021
PBLANK   DS    C                                                        84006021
PATTRB   DS    106C                     PREV. ITEM SET UP AREA    32352 84012021
*                                                                       84018021
*  LD DICTIONARY ENTRY ATTRIBUTE FORMAT                                 84024021
*                                                                       84030021
PCOUNT EQU   PATTRB                                                     84036021
PMINCD EQU   PATTRB+1                                                   84042021
PADDPR EQU   PATTRB+2                                                   84048021
PSYNCH EQU   PATTRB+5                                                   84054021
PLEVNM EQU   PATTRB+6                                                   84060021
PVILGN EQU   PATTRB+7                                                   84066021
PREPIC EQU   PATTRB+9                                                   84072021
           CNOP  2,4                  NON-FULL-WRD HALF-WRD BOUNDAR     84078021
PITMCL   DS    2C                  CONTAINS CODE FOR PRESENCE OF CL     84084021
PCILGN   DS    2C                  LN IN BYTES IF ELEM ITEM (MACH L     84090021
POBJDS   DS    2C                  DISP IN QUITEM OF OBJ OF OCCURS.     84096021
PNOC     DS    2C                  NO. OF OCCURRENCES FOR OCCURS CL     84102021
PCARDN   DS    2C                  SOURCE CARD NUMBER.                  84108021
POBJRD   DS    4C                  DICT POINTER OF OBJECT OF REDEF.     84114021
PDICPT   DS    4C                  DICT POINTER OF CURRENT ITEM.        84120021
PSRLEN   DS    C                   SOURCE LEVEL NUMBER,UNNORMALIZED     84126021
*                                                                       84132021
BPCILN   DS    C              LEVEL NUMBER OF PREVIOUS ITEM             84138021
PMCI     DS    C                                                        84144021
BREPSW   DS    2C             BIT SWITCHES FOR REPORT PICTURE ANALY     84150021
*                             BIT 0 =1  IF FIXED $ APPEARED             84156021
*                                 1 =1  IF FIXED +OR- APPEARED          84162021
*                                 2 =1  ASSUMED V (FOR P9)              84168021
*                                 3 =1 IF V APPEARED                    84174021
*                                 4 =1  IF 9 APPEARED                   84180021
*                                 5 =1  IF . APPEARED                   84186021
*                                 6 =1  IF Z APPEARED                   84192021
*                                 7 =1  IF * APPEARED                   84198021
*                                 8 =1  IF CR APPEARED                  84204021
*                                 9 =1  IF DB APPEARED                  84210021
*                                10 =1  IF FLOATING STRING HAS APPE     84216021
*                                       AND 1 WAS SUBTRACTED FROM I     84222021
*                                       LENGTH  FOR NUMERIC LENGTH      84228021
*                                11 =1  IF THERE IS A SCALE             84234021
*                                12 =1  TO CHECK FOR 9P9                84240021
*                                13 =1  IF P APPEARED                   84246021
*                                14 =1  IF NUMERIC APPEARED             84252021
*                                15 =1  IF A DEC. PT (REAL, IMPLIED     84258021
*                                       ASSUMED) APPEARED.              84264021
*                                           V     RB-CN                 84270021
*                                                   1 V                 84276021
BDECCH   DS    C              CHAR AFTER DECIMAL POINT                  84282021
BFIRST   DS    C              FIRST CHAR                                84288021
BFLTST   DS    C                   FLOATING STRING CHARACTER $, +,      84294021
LEVSAV   DC    X'00'         SAVE LEVEL FOR COND VAR              07271 84300021
         DS    0F                  SAVES LEVEL NUMBER FOR 88 ITEM       84306021
REDEFA   DS    32C                 BCDNAME FOR REDEFINES                84312021
BSAVEC   DS    32C            SAVE AREA FOR COPY NAME                   84318021
OVERFL   DS    32C                 OVERFLOW NAME WORK AREA              84324021
         DS    0F                                                       84330021
BUFCAS   DS    0CL30               BUFFER CALCULATION WORK AREA         84336021
RESERV   DS    1C                     NO. OF BUFFERS.                   84342021
BLKLBL   DS    C                   BLOCK LABEL                          84348021
BKCON1   DS    2C                  BLOCK CONTAINS                       84354021
RCON1    DS    2C                  REC. CONTAINS-1                      84360021
RCON2    DS    2C                  REC. CONTAINS-2                      84366021
BKCON2   DS    2C                  BLOCK CONTAINS-2                     84372021
RCDFM    DS    C                                                        84378021
BUFOPT   DS    C                                                        84384021
LOCDCB   DS    4C                  LOCATION OF DCB                      84390021
LOCDEC   DS    4C                  LOCATION OF DECB                     84396021
LOCLRL   DS    4C                  REL LOCATION OF LOGICAL REC LGN      84402021
ACCMTH   DS    C                   IN/OUTPUT 1, ACCESS METHOD LAST      84408021
DECBLN   DS    C                   DECB LENGTH.                         84414021
CYCNO    DS    2C                  NO OF CYCLES IN ASYN. PROCESSING     84420021
BUFCRD   DS    2C                  CARD NO. OF FD,SD, SA                84426021
         DS    0F                                                       84432021
BUFCAL   DS    0CL30              FSTXT INFORMATION                     84438021
         DS    10C                SAVE AREA FOR CURRENT FD              84444021
BUFOPT1  DS    1C                 IT IS MOVED TO BUFCAS AND USED IN     84450021
BUFOPT2  DS    1C                 FST000 ROUTINE.                       84456021
TTLMSK   EQU   X'04'              TOTALING AREA                         84462021
         DS    18C                                                      84468021
BLDCOP   DS    31C                                                      84474021
GETSAV   DS    5F                  SAVE AREA                            84480021
FSESAV   DS    F                                                        84486021
FULLWD   DS    F                   WORK AREA                            84492021
BLLINK   EQU   FULLWD                                                   84498021
SAV01L   DS    F                                                        84504021
BSAMPT   DS    F                  DISP IN BSAM TABLE                    84510021
BSAMPS   DS    F                  DISP IN BSAM TABLE FOR LAST FD        84516021
REORGPT  DS    F                  DISP IN REORGTBL                      84522021
REORGPS  DS    F                  DISP IN REORGTBL FOR LAST FD          84528021
SMARPT   DS    F                  SAME TABLE DISPLACEMENT               84534021
SMRCPT   DS    F                  SAME RECORD TBL DISPLACEMENT          84540021
BPACKD   DS    D                   WORK AREA                            84546021
SVDECB   DC    F'0'  SAVE DECB BYTES 25 THRU 28                         84552021
         DS    0F                                                       84558021
* SAME (RECORD) AREA TABLE ENTRY(CURRENT AND PREVIOUS FD).              84564021
SAMERS   DS    6H                                                       84570021
SAMEAR   DS    6H                                                       84576021
         DS    0F                                                       84582021
SMRCDAR  DS    5H                                                       84588021
SMRCDRS  DS    5H                                                       84594021
SAMELN   DC    F'12'               LENGTH OF SAMETBL                    84600021
SRTBLN   DC    F'10'               SAMERTBL LENGTH                      84606021
         DS    0F                                                       84612021
QTEXT    DS    34C                 Q-RTN SET UP AREA                    84618021
FILLER   DC    X'06C6C9D3D3C5D9'   06FILLER                             84624021
*SAVE AREA FOR 1ST LEVEL AFTER FILE SECTION                             84630021
SWKAR  DC    X'00'                      USED ONLY BY FST001             84636021
*                                                                       84642021
REDFSW   DC    X'00'          80  IF VAR-LGN GROUP IS SUBJ OF REDEFIN.  84648021
*                                                                       84654021
*  REGISTER SAVE AREA.                                                  84660021
*                                                                       84666021
         DS    0F                                                       84672021
RSAVE    DS    0CL64                                                    84678021
RS0      DS    F                                                        84684021
RS1      DS    F                                                        84690021
RS2      DS    F                                                        84696021
RS3      DS    F                                                        84702021
RS4      DS    F                                                        84708021
RS5      DS    F                                                        84714021
RS6      DS    F                                                        84720021
RS7      DS    F                                                        84726021
RS8      DS    F                                                        84732021
RS9      DS    F                                                        84738021
RS10     DS    F                                                        84744021
RS11     DS    F                                                        84750021
RS12     DS    F                                                        84756021
RS13     DS    F                                                        84762021
RS14     DS    F                                                        84768021
RS15     DS    F                                                        84774021
RS14A    DS    F                                                        84780021
RS14B    DS    F                                                        84786021
RETURN   DS    F                                                        84792021
*                                                                       84798021
BSAVE    DS    16F                                                      84804021
RSAVEA   EQU   BSAVE                                                    84810021
BSAVE4   DS    F                                                        84816021
TSAVER   EQU   BSAVE4                                                   84822021
SAVE4    DC    F'0'                        SAVE REG 4                   84828021
SAVE15   DC    F'0'                        SAVE REG 15                  84834021
DSAVE    DS    F                                                        84840021
BRET     DS    F                                                        84846021
NSAVE    DC    F'0'                SAVE AREA FOR BLNTAB INDEX           84852021
ERSAVE   DS    8F                  ERROR SAVE                           84858021
QSAVE    DS    16F                                                      84864021
RS144  DS    7F                                                         84870021
SVKYTB DC    H'0'       **    KEEP THESE 4 TOGETHER  REC.KEY DISPL.     84876021
SVKYSM DC    H'0'       **                            SYM.KEY           84882021
SVKYAC DC    H'0'       **                            ACT.KEY           84888021
SVKYWK DC    H'0'       **                            KEY WORK AREA     84894021
FDKYTB DC    H'0'  **  KEEP THESE THREE TOGETHER  REC. KEY DISPL        84900021
FDKYSM DC    H'0'  **                               SYM.KEY             84906021
FDKYAC DC    H'0'  **                               ACT. KEY            84912021
*                                                                       84918021
*  TAMER TABLES INITIATION AREA.                                        84924021
*                                                                       84930021
         DS    0F                                                       84936021
RDFPAR   DC    X'0C'               ENTRY LENGTH IN BYTES                84942021
         DC    AL3(RDFSTK)                                              84948021
         DC    H'60'               TOTAL LENGTH OF TABLE.               84954021
         DC    H'12'               GROW SIZE                            84960021
         DS    0F                                                       84966021
RNMPAR   DC    X'05'               ENTRY LENGTH IN BYTES                84972021
         DC    AL3(RNMTBL)                                              84978021
      DC    H'25'                                                       84984021
         DC    H'05'               GROW SIZE.                           84990021
*                                                                       84996021
REORGPAR DC    X'00'                                                    85002021
         DC    AL3(REORGTBL)      REORGTBL EQU TIB3-COS                 85008021
         DC    H'60'                                                    85014021
         DC    H'12'                                                    85020021
GPARAM   DS    0F                                                       85026021
         DC    X'24'               CODE = 36 DECIMAL                    85032021
         DC    AL3(GPLSTK)                                              85038021
    DC      H'240'             50 ENTRIES                               85044021
         DC    X'0024'                 GROW SIZE                        85050021
         DS    0F                                                       85056021
PSAME    DC    X'0C'                                                    85062021
         DC    AL3(SAMETB)                                              85068021
      DC    H'56'                                                       85074021
         DC    H'14'                                                    85080021
PSMRCD   DC    X'0A'                                                    85086021
         DC    AL3(SMRCDTBL)                                            85092021
         DC    H'50'                                                    85098021
         DC    H'10'                                                    85104021
         DS    0F                                                       85110021
RPARAM   DC    X'00'                                                    85116021
         DC    AL3(RCKTBL)                                              85122021
      DC    H'64'                                                       85128021
         DC    H'44'                                                    85134021
SYMPAR   DC    X'00'                                                    85140021
         DC    AL3(KEYTBL)                                              85146021
      DC    H'72'                                                       85152021
         DC    H'44'                                                    85158021
BSMPAR   DC    X'12'                                                    85164021
         DC    AL3(BSAMTB)                                              85170021
         DC    H'54'                                                    85176021
         DC    H'36'                                                    85182021
LPARAM   DC    X'00'               VARIABLE LGN ENTRIES                 85188021
         DC    AL3(LABTBL)         A(TIB13)                             85194021
         DC    H'96'               ESTIMATE OF TABLE SIZE               85200021
         DC    H'12'               GROWTH FACTOR                        85206021
TPARAM   DC    X'00'                                                    85212021
         DC    AL3(TRKTBL)                                              85218021
      DC    H'40'                                                       85224021
         DC    H'12'                                                    85230021
QRTNPM   DC    X'04'                                                    85236021
         DC    AL3(QRTN)                                                85242021
      DC    H'24'                                                       85248021
         DC    H'48'                                                    85254021
QFILEP   DC    X'00'                                                    85260021
         DC    AL3(QFILE)                                               85266021
      DC    H'24'                                                       85272021
         DC    H'48'                                                    85278021
QITBLP   DC    X'08'                                                    85284021
         DC    AL3(QITBL)                                               85290021
      DC    H'48'                                                       85296021
         DC    H'48'                                                    85302021
QVARPM   DC    X'00'               QVAR TABLE                           85308021
         DC    AL3(QVAR)                                                85314021
      DC    H'48'                                                       85320021
         DC    H'48'                                                    85326021
*                                                                       85332021
ATBLSH   DC    X'00'               INDKEY TABLE                         85338021
         DC    AL3(INDKEY)                                              85344021
         DC    H'66'                                                    85350021
         DC    H'30'                                                    85356021
AKEYTB   DC    X'00'               SRCHKY TABLE                         85362021
         DC    AL3(KEYTAB)                                              85368021
         DC    H'60'                                                    85374021
         DC    H'33'                                                    85380021
TOTLPAR  DS    0F                                                       85386021
         DC    X'00'              VARIABLE LENGTH ENTRY                 85392021
         DC    AL3(TOTLTBL)       TOTTBL EQU TIB2-COS                   85398021
         DC    H'60'                                                    85404021
         DC    H'12'                                                    85410021
*                                                                       85416021
PVALTR   DC    X'00'               VALTRU TABLE                         85422021
         DC    AL3(VALTRU)                                              85428021
         DC    H'60'                                                    85434021
         DC    H'33'                                                    85440021
RUNPAR   DS    0F                                                       85446021
         DC    X'08'                                                    85452021
         DC    AL3(RUNTBL)                                              85458021
         DC    H'40'              REQUESTED SIZE                        85464021
         DC    H'8'                                                     85470021
AVALGR   DC    X'00'               VALGRP TABLE                         85476021
         DC    AL3(VALGRP)                                              85482021
         DC    H'60'                                                    85488021
         DC    H'30'                                                    85494021
QSBLPM   DC    X'01'                                               4758 85500021
         DC    AL3(QSBL)                                           4758 85506021
         DC    H'48'                                               4758 85512021
         DC    H'48'                                               4758 85518021
         EJECT                                                          85524021
*              T A M E R  T A B L E S                                   85530021
*                                                                       85536021
*                                                                       85542021
*                                                                       85548021
*                                                                       85554021
*                                                                       85560021
*                                                                       85566021
*                                                                       85572021
*                                                                       85578021
*      GPLSTK                                                           85584021
*            -GROUP LENGTH STACK IS USED TO SAVE GROUP ITEMS UNTIL      85590021
*             THEIR LENGTHS ARE RESOLVED                                85596021
*                  ****************************************             85602021
*                                                                       85608021
*                  E N T R Y   M U S T    S T A R T   O N               85614021
*                                                                       85620021
*                  F U L L   W O R D   B O U N D A R Y                  85626021
*                                                                       85632021
*                                                                       85638021
*                  ****************************************             85644021
*      TIB 10                                                           85650021
*      PRIMED FOR          240 BYTES                                    85656021
*      ENTRY LENGTH        36 BYTES                                     85662021
*      GROW FACTOR         36 BYTES                                     85668021
*      FORMAT    SIZE(BITS)   CONTENTS                                  85674021
*                   1         SET TO 1 IF GROUP OCCURS MORE THAN ON     85680021
*                             AND A BOUNDARY REQUIREMENT EXISTS         85686021
*                   1         SET TO 1 IF GROUP CONTAINS AN ODO         85692021
*                             VARIABLE                                  85698021
*                   1         SET TO 1 IF SYNCHRONIZED CLAUSE           85704021
*                             UNDER GROUP                               85710021
*                   1         SET TO 1 IF SYNCHRONIZED CLAUSE           85716021
*                             ON GROUP                                  85722021
*                   1         SET TO 1 IF VALUE ON GROUP                85728021
*                   1         SET TO 1 IF 88'S UNDER GROUP              85734021
*                   4         MINOR CODE---0001  FIXED LGN GROUP        85740021
*                                          0100  VARIABLE LGN GROUP     85746021
*                   3         0                                         85752021
*                  17         LENGTH OF GROUP IF MINOR CODE IS 0001     85758021
*                             VLC(VARIABLE LGN CELL)           0100     85764021
*                  16         DISPLACEMENT IN OD2TBL OF THE OBJECT      85770021
*                             ODO CLAUSE IF ANY. OTHERWISE 0            85776021
*                  16         NUMBER OF OCCURRENCES IF ITEM HAS OCC     85782021
*                             CLAUSE, MAXIMUM OCCURRENCES IF ODO        85788021
*                             CLAUSE. OTHERWISE 0.                      85794021
*                  16         CARD NUMBER OF SOURCE PROGRAM ON WHIC     85800021
*                             THE ITEMS NAME APPEARED                   85806021
*                  24         DICTIONARY POINTER OF THE REDEFINING      85812021
*                             OBJECT IF ITEM HAS REDEFINES CLAUSE.      85818021
*                             OTHERWISE 0.                              85824021
*                  24         DICTIONARY POINTER OF ITEM                85830021
*                  32         MAXIMUM LGN OF ITEM WHEN IT IS VARIAB     85836021
*                             LENGTH GROUP. OTHERWISE 0.                85842021
*                   8         LEVEL NUMBER OF ITEM                      85848021
*                  24         ADDRESSING PARAMETER OF ITEM              85854021
*                   8         NUMBER OF INDEX NAMES                     85860021
*                                  SPECIFIED. OTHERWISE 0.              85866021
*                   8         NUMBER OF KEYS IF SPECIFIED.              85872021
*                                  OTHERWISE 0.                         85878021
*                   16        DISPL IN INDKEY IF USED.                  85884021
*                                  OTHERWISE 0.                         85890021
*                   16        DISPL IN KEYTAB IF USED.                  85896021
*                                  OTHERWISE 0                          85902021
*                   16        DISPL IN VALGRP IF BIT 4 IS 1.            85908021
*                                  OTHERWISE 0                          85914021
*                   16        DISPL IN VALTRU IF BIT 5 IS 1.            85920021
*                                  OTHERWISE 0                          85926021
*                   16        UNUSED                                    85932021
*      TABLE HANDLING                                                   85938021
*                   -ENTRIES     ARE ENTERED INTO GPLSTK AFTER 'INS     85944021
*                   GETS SPACE.                                         85950021
*                   -ENTRIES  ARE DELETED BY ADJUSTING TAMM             85956021
*                                                                       85962021
*                                                                       85968021
*                                                                       85974021
         EJECT                                                          85980021
*      RDFSTK                                                           85986021
*            -REDEFINES STACK IS USED TO ENABLE THE ADDPAR ROUTINE      85992021
*             TO ASSIGN ADDRESSING PARAMETERS TO ITEMS AFTER A          85998021
*             REDEFINES CLAUSE AND TO SAVE THE LENGTH OF REDEFINES      86004021
*             OBJECT FOR SUBSEQUENT ERROR CHECKING.                     86010021
*      TIB 11                                                           86016021
*      PRIMED FOR           36 BYTES                                    86022021
*      ENTRY LENGTH         12 BYTES                                    86028021
*      GROW FACTOR          12 BYTES                                    86034021
*      FORMAT    SIZE(BITS)   CONTENTS                                  86040021
*                   8         LEVEL NUMBER OF REDEFINES SUBJECT         86046021
*                  56         THE ADDRESSING PARAMETER FIELD CONTEN     86052021
*                             AT THE TIME THE REDEFINES CLAUSE IS       86058021
*                             ENCOUNTERED                               86064021
*                  32         LENGTH OF REDEFINES OBJECT                86070021
*      TABLE HANDLING                                                   86076021
*              -ENTRIES ARE MADE AFTER 'INSERT' GETS SPACE              86082021
*              -ENTRIES ARE DELETED BY ADJUSTING TAMM                   86088021
*                                                                       86094021
*                                                                       86100021
*                                                                       86106021
*      RNMTBL                                                           86112021
*            -REDEFINES NAME TABLE IS USED TO CHECK LEGALITY OF         86118021
*             REDEFINES CLAUSE AND ENABLE REDEFINES CHAINING            86124021
*      TIB 12                                                           86130021
*      PRIMED FOR           50 BYTES                                    86136021
*      ENTRY LENGTH          5 BYTES                                    86142021
*      GROW FACTOR           5 BYTES                                    86148021
*      FORMAT   SIZE(BITS)    CONTENTS                                  86154021
*                  8          LEVEL NUMBER OF REDEFINES OBJECT          86160021
*                 24          DICTIONARY POINTER OF REDEFINES OBJEC     86166021
*                  8          MINOR CODE OF REDEFINES OBJECT            86172021
*      TABLE HANDLING                                                   86178021
*              -ENTRIES ARE MADE AFTER 'INSERT GETS SPACE               86184021
*              -ENTRIES ARE DELETED BY ADJUSTING TAMM                   86190021
*                                                                       86196021
*                                                                       86202021
*                                                                       86208021
         EJECT                                                          86214021
*      LABTBL                                                           86220021
*            -SAVES LABEL RECORD NAMES FROM LABEL RECORDS ARE           86226021
*             DATA-NAME CLAUSE AND ASSIGNS THE SAME LINKAGE BASE        86232021
*             LOCATORS TO ALL DATA-NAMES IN SAME FD. THIS TABLE IS      86238021
*             THEN USED IN THE LINKAGE SECTION FOR DETERMINING BASE     86244021
*             LOCATORS OF LABEL RECORDS.                                86250021
*      TIB 13                                                           86256021
*      PRIMED FOR           96 BYTES                                    86262021
*      ENTRY LENGTH        VARIABLE                                     86268021
*      GROW FACTOR          12 BYTES                                    86274021
*      FORMAT   SIZE(BITS)    CONTENTS                                  86280021
*                 16          LINKAGE BASE LOCATOR NUMBER ASSIGNED      86286021
*                             TO LABEL RECORD DATA-NAME                 86292021
*                  8  N       COUNT FOR LABEL RECORD DATA-NAME          86298021
*                8*N          LABEL RECORD DATA-NAME                    86304021
*                                                                       86310021
*                                                                       86316021
*                                                                       86322021
*      RCKTBL                                                           86328021
*            -RECORD KEY TABLE- SAVES DATA-NAMES OF RECORD KEYS         86334021
*             SPECIFIED IN AN FD AND THE RELATIVE LOCATIONS OF THE      86340021
*             KEYLEN AND RKP FIELDS IN THE FILE'S DCB. AT THE END O     86346021
*             THE FILE SECTION THE KEY DATA-NAMES ARE LOOKED UP IN      86352021
*             THE DICTIONARY AND KEYLEN, RKP(DISPLACEMENT OF KEY FR     86358021
*             BEGINNING OF RECORD) INFORMATION IS USED TO PUT OUT       86364021
*             CONDEFS TO FILL IN THESE FIELDS IN THE DCB(AT PHASE 6     86370021
*      TIB 14                                                           86376021
*      PRIMED FOR           96 BYTES                                    86382021
*      ENTRY LENGTH        VARIABLE                                     86388021
*      GROW FACTOR          44 BYTES                                    86394021
*      FORMAT   SIZE(BITS)    CONTENTS                                  86400021
*                 16          COUNT OF CHARACTERS IN KEY NAME AND I     86406021
*                             QUALIFIERS + INDIVIDUAL COUNTS FOR EA     86412021
*                             NAME +1                                   86418021
*                  8 N1       COUNT OF HIGHEST QUALIFIER DATA-NAME      86424021
*               8*N1          DATA-NAME                                 86430021
*                  .          .                                         86436021
*                  .          .                                         86442021
*                  .          .                                         86448021
*                  8 NN       COUNT OF LOWEST QUALIFIER DATA-NAME       86454021
*               8*NN          DATA- NAME                                86460021
*                  8          0                                         86466021
*                 32          RELATIVE LOCATION OF KEYLEN FIELD IN      86472021
*                 32          RELATIVE LOCATION OF RKP FIELD IN DCB     86478021
*                 16          CARD NUMBER OF SELECT CLAUSE IN WHICH     86484021
*                             RECORD KEY CLAUSE IS SPECIFIED            86490021
*                                                                       86496021
*                                                                       86502021
*                                                                       86508021
         EJECT                                                          86514021
*      KEYTBL                                                           86520021
*            -SYMBOLIC AND ACTUAL KEYS FOR SYNCHRONOUS PROCESSED FI     86526021
*             TABLE- SAVES THE FOLLOWING INFORMATION WHEN A SYMBOLI     86532021
*             OR ACTUAL KEY IS SPECIFIED IN AN FD WHICH IS PROCESSE     86538021
*             SYNCHRONOUSLY.                                            86544021
*                 (A) DATA-NAME OF KEY                                  86550021
*                 (B) RELATIVE LOCATION OF KEYLEN FIELD IN FD'S  DC     86556021
*                 (C) RELATIVE LOCATION OF A(KEY) FIELD IN FD'S  DE     86562021
*                 (D) POINTER TO BSAMTB (TABLE) IF ACCESS METHOD        86568021
*                     SPECIFIED BY FD IS BSAM.                          86574021
*                 (E) CARD NUMBER OF KEY                                86580021
*             AT THE END OF WORKING-STORAGE SECTION EACH KEY IS LOO     86586021
*             UP IN THE DICTIONARY SO THAT THE INFORMATION NEEDED F     86592021
*             (B) AND (C) CAN BE SENT OUT VIA CONDEF AND ACONDEF TO     86598021
*             FILL IN THE RESPECTIVE DCB AND DECB FIELDS (AT PHASE      86604021
*             FOR BSAM THE KEY LENGTH IS A PARAMETER IN THE             86610021
*             CALCULATION OF THE BUFFER SIZE. THEREFORE IF THERE IS     86616021
*             A BSAM POINTER THE BUFFER FOR THE FD WHOSE KEY IS BEI     86622021
*             PROCESSED CAN BE ALLOCATED AT THIS TIME.                  86628021
*      TIB 15                                                           86634021
*      PRIMED FOR           96 BYTES                                    86640021
*      ENTRY LENGTH        VARIABLE                                     86646021
*      GROW FACTOR          44 BYTES                                    86652021
*      FORMAT   SIZE(BITS)    CONTENTS                                  86658021
*                 16          TOTAL COUNT OF CHARACTERS IN KEY NAME     86664021
*                             AND ITS QUALIFIERS + INDIVIDUAL COUNT     86670021
*                             FOR EACH NAME +1                          86676021
*                  8 N1       COUNT OF CHARACTERS IN HIGHEST LEVEL      86682021
*                             QUALIFIER DATA-NAME                       86688021
*               8*N1          DATA-NAME                                 86694021
*                  .          .                                         86700021
*                  .          .                                         86706021
*                  .          .                                         86712021
*                  8 NN       COUNT OF CHARACTERS IN LOWEST LEVEL       86718021
*                             QUALIFIER DATA-NAME                       86724021
*               8*NN          DATA-NAME                                 86730021
*                  8          0                                         86736021
*                 32          RELATIVE LOCATION OF KEYLEN FIELD IN      86742021
*                 32          RELATIVE LOCATION OF A(KEY) FLD IN DE     86748021
*                 32          DISPLACEMENT IN BSAMTB IF BSAM KEY        86754021
*                             OTHERWISE 0                               86760021
*                 16          CARD NUMBER OF SELECT CLAUSE IN WHICH     86766021
*                             RECORD KEY CLAUSE IS SPECIFIED            86772021
*                                                                       86778021
*      NOTE- A(KEY) FIELD IS 0 FOR AN ACTUAL KEY                        86784021
*                                                                       86790021
*                                                                       86796021
*                                                                       86802021
*                                                                       86808021
*                                                                       86814021
         EJECT                                                          86820021
*      BSAMTB-                                                          86826021
*             BSAM TABLE- THE BUFFER FOR BSAM CANNOT BE ALLOCATED       86832021
*             UNTIL THE KEY LENGTH IS KNOWN. THEREFORE IN THE           86838021
*             KEYTBL AND KEYRAN TABLES THERE IS A DISPLACEMENT CELL     86844021
*             OF THE BSAMTB TABLE FOR KEYS IN A BSAM FILE. WHEN         86850021
*             KEY TABLES ARE PROCESSED THE KEY LENGTH IS KNOWN          86856021
*             AND SO THE BUFFER CAN BE ALLOCATED WITH THE INFORMATI     86862021
*             IN BSAMTB AT THIS TIME.                                   86868021
*      TIB 17                                                           86874021
*      PRIMED FOR           48 BYTES                                    86880021
*      ENTRY LENGTH         12 BYTES                                    86886021
*      GROW FACTOR          12 BYTES                                    86892021
*      FORMAT   SIZE(BITS)    CONTENTS                                  86898021
*                 6          BLKSIZE ROUNDED UP TO MULTIPLE OF 8       86904021
*                  8          BASE LOCATOR ASSOCIATED WITH FILE         86910021
*                 24          RELATIVE LOCATION OF A(BUFFER) FIELD      86916021
*                             DECB                                      86922021
*                 16          RPD= ASSOCIATED WITH FILE                 86928021
*                 16          NUMBER OF CYCLES ASSOCIATED WITH FILE     86934021
*                             FROM APPLY 4 CLAUSE                       86940021
*                             0 IF NO APPLY 4 CLAUSE                    86946021
*                 15          0                                         86952021
*                  1          =1  FOR V-TYPE RECORDS                    86958021
*                             =0  FOR UORF-TYPE RECORDS                 86964021
*                                                                       86970021
*                                                                       86976021
*                                                                       86982021
*                                                                       86988021
*      TRKTBL                                                           86994021
*            -TRACK-AREA IS DATA-NAME CHARACTERS CLAUSE TABLE-          87000021
*             SAVES THE DATA-NAME OF TRACK AREA CLAUSE ALONG WITH       87006021
*               (A) RELATIVE LOCATION OF MSWA FIELD IN DCB.             87012021
*               (B) RELATIVE LOCATION OF SMSW FIELD IN DCB.             87018021
*             AT THE END OF WORKING-STORAGE SECTION THE TRACK-AREA      87024021
*             DATA-NAME IS LOOKED UP IN THE DICTIONARY WHICH CONTAI     87030021
*             THE INFORMATION TO FILL IN FIELDS (A) AND (B) IN THE      87036021
*             DCB                                                       87042021
*               MSWA = MAIN STORAGE WORKAREA ADDRESS                    87048021
*               SMSW = SIZE OF MSWA                                     87054021
*      TIB 18                                                           87060021
*      PRIMED FOR           96 BYTES                                    87066021
*      ENTRY LENGTH        VARIABLE                                     87072021
*      GROW FACTOR          12 BYTES                                    87078021
*      FORMAT   SIZE(BITS)    CONTENTS                                  87084021
*                  8  N       COUNT OF CHARACTERS IN DATA-NAME          87090021
*                8*N          DATA-NAME                                 87096021
*                 32          RELATIVE LOCATION OF MSWA FIELD IN DC     87102021
*                 32          RELATIVE LOCATION OF SMSW FIELD IN DC     87108021
*                 16          CARD NUMBER OF SELECT FOR TRACK-AREA      87114021
*                                                                       87120021
*                                                                       87126021
*                                                                       87132021
*                                                                       87138021
         EJECT                                                          87144021
*      SAMETB                                                           87150021
*            -SAME AREA CLAUSE TABLE- COLLECTS BUFFER SIZE ATTRIBUT     87156021
*             OF ALL FD'S UNDER SAME AREA CLAUSES SO THAT AT THE        87162021
*             END OF THE FILE SECTION THE BUFFER CAN BE ALLOCATED       87168021
*             TO MEMBERS UNDER A SAME AREA CLAUSE. ALL FD'S UNDER       87174021
*             ONE SAME AREA CLAUSE ARE GIVEN A UNIQUE NUMBER AND TH     87180021
*             THE FD WHOSE BUFFER IS THE LARGEST FOR A UNIQUE NUMBE     87186021
*             IS USED FOR THE BUFFER SIZE FOR ALL MEMBERS WITH THAT     87192021
*             UNIQUE NUMBER.                                            87198021
*      TIB 19                                                           87204021
*      PRIMED FOR           70 BYTES                                    87210021
*      ENTRY LENGTH         14 BYTES                                    87216021
*      GROW FACTOR          14 BYTES                                    87222021
*      FORMAT   SIZE(BITS)    CONTENTS                                  87228021
*                  8          UNIQUE NUMBER ASSIGNED TO ALL FILES       87234021
*                             UNDER THE SAME AREA CLAUSE                87240021
*                 24          RELATIVE LOCATION OF A(BUFCB) FIELD I     87246021
*                              DCB FOR QUEUED ACCESS METHODS            87252021
*                             RELATIVE LOCATION OF A(BUFFER) FIELD      87258021
*                              DECB FOR BASIC ACCESS METHODS            87264021
*                 16          NUMBER OF BUFFERS FOR QUEUED ACC. MET     87270021
*                             NUMBER OF CYCLES FOR  BASIC  ACC. MET     87276021
*                 16          BLOCK LENGTH OF FD                        87282021
*                 16          RPD= ASSOCIATED WITH ASSYNCHRONOUS FI     87288021
*                             0 IF SYNCHRONOUSLY PROCESSED FILE         87294021
*                  8          BASE LOCATOR ASSOCIATED WITH FILE         87300021
*                  1          =1 INPUT FILE                             87306021
*                             =0 OUTPUT FILE                            87312021
*                  1          =1 V-TYPE RECORDS                         87318021
*                             =0 U OR F TYPE RECORDS                    87324021
*                  2          0                                         87330021
*                  4          ACCESS METHOD                             87336021
*                                    0000   QSAM                        87342021
*                                    0001   QISAM                       87348021
*                                    0010   BISAM                       87354021
*                                    0100   BSAM                        87360021
*                                    1000   BDAM                        87366021
*                 16          DECB LENGTH FOR BASIC ACCESS METHODS      87372021
*                             0 FOR QUEUED ACCESS METHODS               87378021
*                                                                       87384021
*                                                                       87390021
*                                                                       87396021
*                                                                       87402021
         EJECT                                                          87408021
*      QRTN                                                             87414021
*          -Q-ROUTINE TABLE- WHEN AN OCCURS...DEPENDING ON CLAUSE I     87420021
*           ENCOUNTERED IN A RECORD DESCRIPTION A Q-ROUTINE IS          87426021
*           GENERATED FOR THAT RECORD DESCRIPTION AND REFERENCED BY     87432021
*           GN NUMBER. THE GN= OF THE Q-ROUTINE ALONG WITH THE OCCU     87438021
*           DEPENDING ON VARIABLES ASSOCIATED WITH IT ARE COLLECTED     87444021
*           IN THE QRTN TABLE. THIS TABLE IS USED TO CREATE THE QVA     87450021
*           TABLE AT THE END OF PHASE 2.                                87456021
*      TIB 21                                                           87462021
*      PRIMED FOR           48 BYTES                                    87468021
*      ENTRY LENGTH       VARIABLE                                      87474021
*      GROW FACTOR           8 BYTES                                    87480021
*      FORMAT   SIZE(BITS)    CONTENTS                                  87486021
*                 16  GNI     FIRST GN =                                87492021
*                 16  N       NUMBER OF ODO VARIABLES (DISPLACEMENT     87498021
*                             POINTERS TO OD2TBL) FOLLOWING             87504021
*               32*N          DISPLACEMENT POINTERS TO OD2TBL (ODO      87510021
*                              VARIABLES)                               87516021
*                  .                                                    87522021
*                  .                                                    87528021
*                  .                                                    87534021
*                 16  GNN     LAST GN =                                 87540021
*                 16  N       SAME AS ABOVE                             87546021
*               32*N          SAME AS ABOVE                             87552021
*                 32          0                                         87558021
*                               6B                                      87564021
*                                                                       87570021
*                                                                       87576021
*                                                                       87582021
*      QITBL                                                            87588021
*          -OCCURS...DEPENDING ON TABLE-RELATES DICTIONARY POINTER      87594021
*           OF AN OCCURS DEPENDING ON VARIABLE WITH THE DISPLACEMEN     87600021
*           POINTER OF THE VARIABLE IN THE OD2TBL TABLE. THIS TABLE     87606021
*           AND QRTN TABLE ARE COMBINED INTO THE QVAR TABLE BY THEI     87612021
*           COMMON FIELD,THE OD2TBL POINTER.                            87618021
*      TIB 22                                                           87624021
*      PRIMED FOR           96 BYTES                                    87630021
*      ENTRY LENGTH          8 BYTES                                    87636021
*      GROW FACTOR           8 BYTES                                    87642021
*      FORMAT   SIZE(BITS)    CONTENTS                                  87648021
*                 32          DISP. PTR. OF ODO VARIABLE IN OD2TBL      87654021
*                             FOR  1ST ENTRY                            87660021
*                 32          DICTIONARY POINTER OF ODO VARIABLE        87666021
*                             FOR 1ST ENTRY                             87672021
*                  .          .                                         87678021
*                  .          .                                         87684021
*                  .          .                                         87690021
*                 32          DISP. PTR OF ODO VARIABLE IN OD2TBL       87696021
*                             FOR LAST ENTRY                            87702021
*                 32          DICTIONARY POINTER OF ODO VARIABLE        87708021
*                             FOR LAST ENTRY                            87714021
*                 32          0                                         87720021
*                                                                       87726021
*                                                                       87732021
*                                                                       87738021
         EJECT                                                          87744021
CONVAR   DS    F                   DICTIONARY PTR OF CONDITIONAL VA     87750021
DEL88    DS    F                   DELIMITOR OF CONDITIONAL VARIABL     87756021
ACIPRM   DC    A(BCIPRM)                                                87762021
BCIPRM   DS    0CL5           PARAMETER FOR ACCESS OD CI PTR            87768021
BCODE    DS    C                                                        87774021
ACI      DC    AL3(CI)                                                  87780021
         DS    C                                                        87786021
         DC    F'00080000'    LEVEL NO =1                               87792021
*  ADDRESS CONSTANTS.                                                   87798021
*                                                                       87804021
COSADR DS    F                                                          87810021
AACMET   DC    A(ACCMET)                                                87816021
ALABRN   DC    A(LABLBD)                                                87822021
ATTLBD   DC    A(TOTLBD)          ADR OF TOTL TBL BLD RTN               87828021
ADPIOT   DC    A(PIOTBL)                                                87834021
ACHKPT   DC    A(CHKTBL)                                                87840021
ADAPTB   DC    A(APPTBL)                                                87846021
AOD2TB   DC    A(OD2TBL)                                                87852021
ATTLDTB  DC    A(TTLDTBL)                                               87858021
ASUBRTN  DC    A(SUBRTN)                                                87864021
ASAMRN   DC    A(SAMRTN)                                                87870021
ASAME    DC    A(SAME)                                                  87876021
ARDF10   DC    A(RDF105)                                                87882021
ASAMER   DC    A(SAMER)                                                 87888021
AKEYRN   DC    A(KEYRTN)                                                87894021
AERRTN   DC    A(ERRRTN)                                                87900021
BGETPT   DC    A(GETPTR)                                                87906021
ADICTB   DC    A(DICTBD)                                                87912021
ADIC62   DC    A(DIC062)                                                87918021
AGSPIC   DC    A(GSPICT)                                                87924021
BINTAC   DC    A(INTACC)                                                87930021
ABELEM   DC    A(BELEM4)                                                87936021
ADPARS   DC    A(DPARST)           ACCESS CELL ADDRESS FOR A(PHASE      87942021
AENTPT   DC    A(ENTPTR)                                                87948021
ALATRP   DC    A(LATRPT)                                                87954021
ALATGP   DC    A(LATGRP)                                                87960021
ALATRN   DC    A(LATRNM)                                                87966021
ALDELN   DC    A(LDELNM)                                                87972021
ALATAC   DC    A(LATACP)                                                87978021
AENTDE   DC    A(ENTDEL)                                                87984021
AENTNM   DC    A(ENTNAM)                                                87990021
ATASSR   DC    A(TASSR)                                                 87996021
AVALGN   DC    A(VALGEN)                                                88002021
AIRSBT   DC    A(IRSLBT)                                                88008021
AELIPR   DC    A(ELIPR)                                                 88014021
AGRIPR   DC    A(GRIPR)                                                 88020021
AERROR   DC    A(ERROR)                                                 88026021
APTQRN   DC    A(PUTQRN)                                                88032021
AUPDN    DC    A(UPDN)                                                  88038021
AADPAR   DC    A(ADPAR)                                                 88044021
AADP49   DC    A(ADP049)                                                88050021
AXTEN    DC    A(XTEN)                                                  88056021
AREDEF   DC    A(REDEF)                                                 88062021
ASPIR    DC    A(SPIR)                                                  88068021
ASP100   DC    A(SPI100)                                                88074021
AREORGBD DC    A(REORGBD)                                               88080021
ASP200   DC    A(SPI200)                                                88086021
ASP210   DC    A(SPI210)                                                88092021
AWSEND   DC    A(WSEND)                                                 88098021
AFSEND   DC    A(FSEND)                                                 88104021
AQUAL    DC    A(QUAL)                                                  88110021
AWKARE   DC    A(WKAREA)                                                88116021
AFST00   DC    A(FST000)                                                88122021
ABPICT   DC    A(BPICTR)                                                88128021
AELIOD   DC    A(ELIODO)                                                88134021
AQBUIL   DC    A(QBUILD)                                                88140021
AQVARB   DC    A(QVARBD)                                                88146021
BEGPH2   DC    A(ENTPH2)                                                88152021
LGS      DC    F'0'                                                     88158021
GIG      DC    F'0'                                                     88164021
APARAM   DC    A(PARAM)                                                 88170021
ATDDMP   DC    A(TDDMP0)           TABLE DICTIONARY DUMP                88176021
ANORML   DC    A(BNORML)                                                88182021
AFSTXT   DC    A(FSTXT)                                                 88188021
AMAIN    DC    A(BEGADC)                                                88194021
ASRCHT   DC    A(SRCHTB)                                                88200021
AGETDP   DC    A(GETDP)                  GET DICT PTR RTN               88206021
AIDPRM   DC    A(IDPARM)                                                88212021
ASR200   DC    A(SRH200)                                                88218021
ABYPAS   DC    A(BYPAS)                                                 88224021
ACPYRN   DC    A(COPYRN)                                                88230021
ACHKEY DC    A(KEYCHK)                                                  88236021
AXREF  DC    A(XREFF)                                                   88242021
ARNTBL   DC    A(RUNTBL)                                                88248021
APUTOT DC    A(PUTOUT)                                                  88254021
AVAL30   DC    A(VAL030)                                                88260021
AVALSR   DC    A(VALSER)                                                88266021
ACHNXT   DC    A(CHKNXT)                                                88272021
AVLT20   DC    A(VALT20)                                                88278021
ALTNPRM  DC    A(LTNPRM)           PARAM FOR                            88284021
LTNPRM   DC    A(CI)                 'LATRNM'                           88290021
ACONDE   DC    A(BCONDE)                                                88296021
ABEGIN   DC    A(BEGADC)                                                88302021
APHTRM   DC    A(PHTERM)                                                88308021
* DEL                                                                   88314021
ARNAMS   DC    A(RENAMS)                                                88320021
ABHALT   DC    A(BHALT)                                                 88326021
AREPRTCK DC    A(REPRTCK)     NEW CSECT TO CHECK RPT ITEM LENGTHS FIXAD 88332021
AREPRT2A DC    A(REPRT2A)     ENTRY IN REPRTCK                    FIXAD 88338021
*       TAMER  ROUTINE ADCONS                                           88344021
BPRIME   DC    A(0)                PRIME     ROUTINE                    88350021
BINSRT   DC    A(0)                INSERT    ROUTINE                    88356021
BSTATC   DC    A(0)                STATIC    ROUTINE                    88362021
BTABRL   DC    A(0)                TABLE RELEASE                        88368021
BTAMIN   DC    A(0)                TAMER INITIALIZATION                 88374021
*                                                                       88380021
MCODE    DC    X'00'               88 CODE                              88386021
FIGCOD   DC    X'00'                       FOR FIGCON                   88392021
NMSIGN   DC    X'00'               SOURCE SIGN OF NUMERIC LITERAL.      88398021
*                                                                       88404021
*   CIPARM IS THE BEGINNING ADDRESS OF THE PARAMETER LIST FOR           88410021
*    CALLING ACCESS TO ENTER CI IN THE DICTIONARY.   ONLY ATRCNT        88416021
*     AND PNTER CHANGE' WHILE ALL OTHER FIELDS REMAIN CONSTANT.         88422021
         DS    0F                                                       88428021
CIPARM   DS    0CL12                                                    88434021
CICODE   DC    X'10'               CODE=16 FOR ACCESS TO ENTER CI       88440021
ADBCD    DC    AL3(CI)                 IN THE DICTIONARY                88446021
ATRCNT   DS    1C                                                       88452021
ADATRB   DC    AL3(ATTRIB)                                              88458021
PNTER    DS    F                                                        88464021
*                                                                       88470021
ERRVCON  DC    X'446C'            VCONDEF AREA                          88476021
         DC    X'3408'            NAME COUNT=8                          88482021
ERRNAME  DC    C'ILBOERR '                                              88488021
         DC    X'3403'            EXTERNAL NAME                         88494021
ERRTARG  DS    3C                 TARGET ADDRESS                        88500021
FMCNST   DS    0F                                                       88506021
         DS    C                  CONST DEFINITION CODE, X'28'.         88512021
         DS    3C                                                       88518021
         DC    X'00'              HEXADECIMAL                           88524021
         DC    X'0001'            SIZE = 1 BYTE                         88530021
RECFM    DS    C                  VALUE = MODE,B,S,CC,OVFL,KEYC.        88536021
MACRCN   DS    F                                                        88542021
         DC    X'000002'          HEXADECIMAL, 2 BYTES.                 88548021
MACR     DC    X'4141'            GET/PUT DATA MODE.                    88554021
DCBPRX   DS    0F                                                       88560021
         DS    C                  X'28'                                 88566021
         DS    3C                 TARGET ADDRESS                        88572021
         DC    X'00'              HEXADECIMAL                           88578021
DCBPSZ   DC    X'0028'            SIZE=40                               88584021
DCBPLST  DS    4C                 BOV,BOF  X'0..0'                      88590021
         DS    4C                 EOV  X'0...0'                         88596021
         DS    4C                 EOF  X'0...0'                         88602021
DCBPAD1  DS    4C                 TOT AREA X'0...0' X'0A...'            88608021
         DS    4C                 DCB EXIT : 0, X'05....0' QISAM        88614021
         DS    4C                 ER-BIT 08/QSAM,BSAM 00/ELSE           88620021
         DC    X'00000001'        INV-KEY                               88626021
         DC    X'00000001'        USE-ERR      **         **            88632021
         DC    X'00000000'        FEOV OPTION RTN ADDR.                 88638021
         DC    X'80000000'        EO LIST,OPEN TYPE,NSL MAX SIZE        88644021
EXLADCN  EQU   DCBPLST+1          CODE(2C)+TARGET ADDRESS=1+3           88650021
EXLADSZ  EQU   EXLADCN+4          SIZE(4)+RELATIVE ADDRESS=1+3          88656021
TTLDC0A  EQU   DCBPLST+1          CODE(28)+TARGET ADDRESS=1+3           88662021
TTLDCSZ  EQU   TTLDC0A+5          SIZE(1)=2(NOT ON HW BOUNDARY)         88668021
TTLVALU  EQU   TTLDCSZ+2          VALUE(X'0A')=1                        88674021
TOTLDC   EQU   DCBPLST+1          USED WHEN MOVING DCBADD AND           88680021
*                                 CARD NO. INTO TOTL TBL.               88686021
         DS    0F                                                       88692021
LNTH01   DC    F'0'                                                     88698021
VALSAV   DS    F                                                        88704021
VALDSP   DS    H                   SAVE DISPL IN VALTRU TABLE           88710021
BANSAV   DS    H                                                        88716021
VALTSW   DC    X'00'               IF ON VALUE THRU                     88722021
VALSV1   DC    X'00'               WORK BYTE FOR VALSER                 88728021
ERR88    DC    X'00'               ERROR FOR 88'S                       88734021
VALTHR   EQU   X'08'                                                    88740021
         DS    0F                                                       88746021
RNMSV3   DS    9F                                                       88752021
RNMSAV   DS    F                   REG SAVE                             88758021
RNMSV1   DS    F                   REG SAVE                             88764021
RNMSV2   DS    F                                                        88770021
RNMPTR   DS    F                                                        88776021
VALSV2   DS    F                                                        88782021
RNMTMP   DS    F                   WORK WORD                            88788021
END88    DC    F'0'                                                     88794021
RNMSVE   DS    F                                                        88800021
GRP88    DC    X'00'               IF ON 88'S ARE UNDER GROUP           88806021
RNMTM1   EQU   RNMTMP+1                                                 88812021
RNMTM2   EQU   RNMTM1+1                                                 88818021
RNMTM3   EQU   RNMTM2+1                                                 88824021
RNMAD2   DS    H                   ADD PARM                             88830021
RNMADD   DS    H                   ADD PARM                             88836021
RNMGLS   DS    H                                                        88842021
RNMAD1   DC    F'0'                                                     88848021
RNMDEL   DC    F'0'                DELM PTR FOR RENAMES GROUP           88854021
RNMDL1   EQU   RNMDEL+1                                                 88860021
RNMGRP   DC    X'00'               ONE OF OBJECTS IS GROUP              88866021
RNAMSW   DC    X'00'               LAST ENTRY WAS RENAMES               88872021
RNMADP   EQU   RNMAD1+1                                                 88878021
RNTHRU   DC    X'00'               RENAMES THRU                         88884021
RNMVAR   DC    X'00'                                                    88890021
RNMVLC   EQU   RNMPTR                                                   88896021
         DS    0F                                                       88902021
ACTKEY   DS    F                                                        88908021
DCBSAV   DS    F                                                        88914021
SEGSAV   DS    H                                                        88920021
ITMCL3   DC    X'00'               FLAG BYTE                            88926021
KEYFLG   EQU   X'01'                                                    88932021
SBDAM    EQU   X'40'                                                    88938021
BSAMS    EQU   X'20'                                                    88944021
X17      EQU   17                                                       88950021
X13      EQU   13                                                       88956021
X15      EQU   15                                                       88962021
BSAM     EQU   X'04'                                                    88968021
BSAMBDAM  EQU   X'C0'                                                   88974021
QSMODE   EQU   X'80'                                                    88980021
SMODE    EQU   X'01'                                                    88986021
QSAMSA   EQU   X'08'                                                    88992021
GRPVAL   DC    X'00'                                                    88998021
PARAM    DC    F'0'                ACCESS PARAMETER                     89004021
PARAM1   DC    F'0'                                                     89010021
LREDEF   DC    F'0'                                                     89016021
WS       DS    2F                  WSADEF WORK AREA                     89022021
DSPKEY   EQU   0    2C                                                  89028021
VCOUNT   EQU   2   1C                                                   89034021
DCBLGN   EQU   4     H                                                  89040021
DECBLGN  EQU   6                                                        89046021
DECBTYP  EQU   7   *                                                    89052021
AMCODE   EQU   8     C                                                  89058021
DCBOTK   EQU   9   10C                                                  89064021
*                  * C                                                  89070021
DISPOPN  EQU   20    C                                                  89076021
DISPRM   EQU   21    C                                                  89082021
*                  *3C                                                  89088021
OPTCODE  EQU   25    C                                                  89094021
CLSMSK   EQU   26   2C                                                  89100021
DISPKY   EQU   28    F                                                  89106021
CON121   DC    F'121'                                              6998 89112021
LITBUF   DS    0F                  SET UP AREA                 FOR      89118021
       DS    38F                   DATA-A TEXT                          89124021
NMPUT    DC    F'0'                OUTPUT BYTE COUNT IS KEPT HERE.      89130021
TOTLGN   DS    F                                                        89136021
XTRA     DC    F'0'                     SAVE XTRA BYTES TO BE     42660 89142021
*  SUBTRACTED FROM LOCCTR  IN RPT SECT OR AT PH20 TERMINATION     42660 89148021
DS       DC    F'0'                                                     89154021
LID      DS    6F                  LAST ITEM DELETED FROM GLS           89160021
LBLMAX   DC    F'0'                                                     89166021
MAXIM    DC    F'0'                MAXIMUM RECORD.                      89172021
MINIM    DC    X'FFFFFFFF'         MINIMUM RECORD LENGTH                89178021
         DC    X'00'                                                    89184021
APAF     DC    X'000000'           ADD PARM                             89190021
DISP     DC    F'0'                DISPL FROM BEGINNING                 89196021
         DC    X'00'                                                    89202021
RPTRDF   DS    3C                  REPORT DIFFERENCE                    89208021
         DC    X'00'                                                    89214021
FAPAF    DS    7C                  ADD PARM                             89220021
SDAPAF   DS    7C                                                       89226021
RAPAF    DS    7C                                                       89232021
SDBLL    DS    C                                                        89238021
FDBLN    DS    C                       LOCATOR                          89244021
SDBLN    DS    C                           NUMBERS                      89250021
MSW      DC    X'00'               SWITCH FOR DICTBD USES.              89256021
COD01  DC    X'00'                      01 IN FD SW                     89262021
APAFSV   DS    7C                           SAVE APAF             42027 89268021
FL4SAVE  DC    X'00'              SAVE ICTFL4 FOR                 59737 89274021
*    RECORD KEY INFORMATION IN LATER ROUTINE                      59737 89280021
ALIGN    DC    F'0'                PUT ON WORD BOUNDARY                 89286021
ADDRES   DS    F                   ADD TO GEN                           89292021
INPUT    DC    F'0'                WORK AREAS                     F     89298021
OUTPUT   DC    F'0'                OR VALUE ROUTINES                    89304021
SAMLGN   DS    F                   SAME LENGTH                          89310021
SMKYLGN  DS    F                                                        89316021
WKAR     DS    2F                                                       89322021
       DS    0F                                                         89328021
XREFSV DS    F                                                          89334021
XRFHDR EQU   X'48'                                                      89340021
         DS    0D                                                       89346021
WKAREA   DS    10F                 TEMPORARY                            89352021
MTEMP    DS    F                         WORK                           89358021
MTEMP1   DS    F                             AREAS                      89364021
NUMSAV   DC    X'00'               80=MUST DROP LEADING ZEROES          89370021
         DC    X'00'               NUMBER OF BYTES CHECKED              89376021
REALPTR  DC    F'0'                                                     89382021
FD       DC    2F'0'               FD ATTRIBUTES SAVED HERE             89388021
FDPT     DS    F                   FD CURRENT PTR SAVED HERE.           89394021
FDDICT   DC    F'0'                FD DICTIONARY PTR SAVED HERE.        89400021
FDBL     DC    H'0'                NO. OF 1ST BL IN FILE SECTION.       89406021
         DS    0F                                                       89412021
REDDIF   DS    H                   SHOULD BE ZERO                       89418021
REDPLS   DS    H                    WORK AREA FOR REDEFINES +           89424021
RPTLOC   DC    F'0'                                                     89430021
LGSSAV   DS    F                   SAVE LAST ITEM DELETED               89436021
LASTDP   DS    F                   LAST FD SD SA RD DICT. PTR.          89442021
*                                                                       89448021
         DS    0D                                                       89454021
MAXNUM   DS    D                   MAX NUM OF OCCURENCES FOR INDKEY     89460021
IDSAV    DS    F                                                        89466021
SRCHSV   DS    F                                                        89472021
BCTSAV   DS    F                   SAVE R14                             89478021
SRHSAV   DS    6F                                                       89484021
SRHSVD   DS    F                                                        89490021
IDDISP   DS    H                   SAVE DISPL IN INDKEY                 89496021
KEYDSP   DS    H                   SAVE DISPL IN SRCHKY                 89502021
BLLSAVE  DC    H'2'                                                     89508021
WSREC    DC    H'4'          CODE FOR KEY IN WORKING-STORAGE      51873 89514021
MSG108   DC    X'206C'                                                  89520021
MSG138   DC    X'208A'                                             2998 89526021
MSG17    DC    X'2011'                                                  89532021
MSG145   DC    X'2091'                                                  89538021
MSG50    DC    X'2032'                                                  89544021
MSG195   DC    X'20C3'                  UNIT RECORD FOR S-MODE          89550021
MSG12    DC    X'200C'                                                  89556021
MSG44    DC    X'002C'             DUPLICATE SD ERRMSG                  89562021
TBLSW    DC    X'00'               TABLE HANDLING                       89568021
ODOCT    DC    X'00'               NUMB OF ODO'S FOR TABLE HANDLING     89574021
SAMESW   DC    X'00'                                                    89580021
SUBSW    EQU   X'20'                                                    89586021
OLIDNM   EQU   X'20'                                                    89592021
SAIDNM   EQU   X'10'                                                    89598021
ILIDNM   EQU   X'40'                                                    89604021
BASICS   EQU   X'40'                                                    89610021
SWONN    EQU   X'11'                                                    89616021
SWON     EQU   X'31'                                                    89622021
SWONE    EQU   X'01'                                                    89628021
SWOFF    EQU   X'F0'                                                    89634021
IDNMOL   EQU   X'10'                                                    89640021
IDNMSA   EQU   X'20'                                                    89646021
BUFUR   EQU    X'40'               UNIT RECORD IN BUFCAL                89652021
ACCMON   EQU   X'0F'                                                    89658021
DICTS    EQU   X'60'                                                    89664021
ONEE     EQU   1                                                        89670021
BUFC24   EQU   BUFCAL+24                                                89676021
VMODE    EQU   4                                                        89682021
ICLKEY   EQU   X'20'                                                    89688021
LEV77    EQU   X'32'                                                    89694021
ASCKEY   EQU   X'01'                                                    89700021
ICLASC   EQU   X'10'                                                    89706021
KEYERR   EQU   X'01'                                                    89712021
ODOPTR   EQU   X'10'                                                    89718021
RDFSW    DC    X'00'                                                    89724021
RDFERR   DC    X'00'                                                    89730021
CONDLN   DS    C                                                        89736021
CONDLT   DS    C                                                        89742021
CONDL1   DS    C                                                        89748021
CHKLTH   DC    X'00'                                                    89754021
         DS    0F                                                       89760021
* ATTRIBUTES FOR ID NAME                                                89766021
IDATT    DS    0CL6                                                     89772021
         DC    X'6F'               COUNT AND MAJOR CODE                 89778021
IDFLAG   DS    C                                                        89784021
IDNUM    DS    2C                                                       89790021
IDLNTH   DS    2C                                                       89796021
*                                                                       89802021
         DS    0F                                                       89808021
IDPARM   DS    0CL5                 PARAMETER FOR ID NAMES              89814021
IDCODE   DC    X'00'                                                    89820021
         DC    AL3(OVERFL)                                              89826021
ATTCNT   DC    X'06'                                                    89832021
AIDATT   DC    AL3(IDATT)                                               89838021
NOIDNM   DS    C                                                        89844021
NOKEYS   DS    C                                                        89850021
NUMIDS   DS    C                   SAVE NUM OF IDS                      89856021
NUMKEY   DS    C                   SAVE NUM OF KEYS                     89862021
USGIND   DC    X'0AE2F9F9F9F9'     USAGE IS INDEX                       89868021
         DC    X'F9F9F9F9F9'         DUMMY PICTURE                      89874021
HIQUAL   DS    3C                                                       89880021
LSTQUL DS    3C                                                         89886021
GNSW     DC    X'00'               GN= SWITCH                           89892021
GNAREA   DS    0F                                                       89898021
GNNUMB   DC    F'0'                                                     89904021
GNDISP   DC    H'0'                CURRENT DISP OF N IN QRTN            89910021
GNDCB    DC    H'0'                CURRENT DCB= IN QFILE                89916021
GNGN     DC    H'0'                GN= ASSOC. WITH DCB=                 89922021
QDEFTX   DC    X'34'                                                    89928021
INITGN   DC    X'0000'             QINIT GN=                            89934021
         DS    0H                                                       89940021
CON9000  DC    X'9000'                                                  89946021
STERAT   DSECT                                                          89952021
*  STERLING REPORT ATTRIBUTE NAME DEFINITIONS.USED WITH R1 AS BASE      89958021
STATWK   DS    0CL70     STERLING REPORT WORK AREA  GENERAL             89964021
STWCDE   DS    C         CODE BYTE                                      89970021
STWFLT   DS    C         FLOAT CHARACTER                                89976021
STWTOL   DS    C         TOTAL LENGTH OF REPORT ITEM                    89982021
STWNOL   DS    C         NO .OF POUNDS DIGITS                           89988021
STWNOD   DS    C         NO.OF DECIMAL PENCE                            89994021
STWVAR   DS    60C       VARIABLE PORTION FOR CHARACTER/LENGTH STRI     90000021
STPOUP   DS    C         DELIMITOR POSITION POUNDS                      90006021
STSHIP   DS    C         DEIIMITOR POSITION SHILLINGS                   90012021
STDICT   DS    3C        SPACE FOR DICTIONARY POINTER                   90018021
XLSTSW   EQU   BYTESW                                                   90024021
KEYEND   EQU   BYTESW                                                   90030021
DICPNT   EQU   DICTPT                                                   90036021
ICDATT   DSECT                                                          90042021
ICDCOD   DS    1X                  MAJ CODE                             90048021
IDCINF   DS    5X                                                       90054021
ICDNLS   DS    1X                  N.L AND SCALE                        90060021
ICDPEN   DS    1X                  DEC. PENCE, SCALE                    90066021
ICDNL    DS    1X                  N.L.                                 90072021
ICDNLN   DS    1X                  NUM. LGN.                            90078021
ICDSCL   DS    1X                  SCALE                                90084021
ICDLGN   DS    1X                                                       90090021
ICDNPD   DS    1X                  NUM. PNDS                            90096021
ICDNDC   DS    1X                  NUM. DEC                             90102021
ICLDST DSECT                                                            90108021
ICLCOD DS    1X                    03 CODE                              90114021
ICLCNT DS    1X                    TOTAL COUNT                          90120021
ICLLEV DS    1X                    LEVEL INDICATION                     90126021
ICLCDN DS    2X                    CARD NUMBER                          90132021
ICLFL1 DS    1X                    FLAG 1                               90138021
ICLBWZ EQU   X'80'                 BLANK WHEN ZERO                      90144021
ICLJST EQU   X'40'                 JUSTIFIED                            90150021
ICLVLU EQU   X'38'                 VALUE BITS                           90156021
ICLUSG EQU   X'07'                 USAGE BITS                           90162021
ICLFL2 DS    1X                    FLAG 2                               90168021
ICLODO EQU   X'80'                 OCCURS DEPENDING ON                  90174021
ICLRDF EQU   X'40'                 REDEFINES                            90180021
ICLPIC EQU   X'20'                 PICTURE                              90186021
ICLCOP EQU   X'10'                 COPY                                 90192021
ICLIRD EQU   X'08'                 INTERNAL REDEFINES                   90198021
ICLRD  EQU   X'04'                 RD                                   90204021
ICLRNM EQU   X'02'                 RENAMES                              90210021
ICLSYN EQU   X'01'                 SYNCHRONIZED                         90216021
ICLNOC DS    2X                    MAX NUMBER OF OCCURRENCES            90222021
ICLFL3 DS    1X                    FLAG 3                               90228021
ICLLOR EQU   X'80'                 LEFT OR RIGHT                        90234021
ICLRNT   EQU   X'40'               RENAMES THRU                         90240021
ICLNOI DS    1X                    NUMB OF INDEXES                      90246021
ICLNOK DS    1X                    NUMB OF KEYS                         90252021
ICLDCT DS    1X                    DATANAME COUNT                       90258021
ISDTXT   DSECT                                                          90264021
ISDCOD   DS    1X                  03 CODE                              90270021
ISDCNT   DS    1X                  TOTAL COUNT                          90276021
ISDLVL   DS    1X                  LEVEL INDICATION                     90282021
ISDFL1   DS    1X                  FLAG1                                90288021
ISDNWU   EQU   X'F0'               NO. SORT WORK UNITS                  90294021
ISDLBR   EQU   X'0C'               LABEL REC'DS STAND. OR OMITTED       90300021
ISDSMSW  EQU   X'03'              SAME (RECORD) SW                      90306021
ISDCDN   DS    2X                  CARD NO.                             90312021
ISDRC1   DS    2X                  RECORD CONTAINS INTEGER 1            90318021
ISDRC2   DS    2X                  RECORD CONTAINS INTEGER 2            90324021
ISDFL2   DS    1X                  FLAG2                                90330021
ISDDEV   EQU   X'E0'               DEVICE CLASS                         90336021
ISDRDM   EQU   X'1E'              MODE                                  90342021
ISDUN1   EQU   X'01'              UNUSED                                90348021
ISDSMNO  DS    1X                 SAME RECORD NO.                       90354021
ISDEXN   DS    8X                  EXTERNAL NAME                        90360021
ISDNCT   DS    1X                  NAME CT                              90366021
ISDSDN   DS    30X                 SD NAME                              90372021
ISDEND   DS    1X                                                       90378021
PIBDST DSECT                                                            90384021
PIBFL1 DS    1X                         FLAG 1                          90390021
PIBOIN EQU   X'80'                      OPEN INPUT                      90396021
PIBOOT EQU   X'40'                      OPEN OUTPUT                     90402021
PIBOIO EQU   X'20'                      OPEN I/O                        90408021
PIBCNR EQU   X'10'                      CLOSE UNIT NO REWIND            90414021
PIBWAA EQU   X'08'                      WRITE AFTER ADVANCING           90420021
PIBCWL EQU   X'04'                      CLOSE WITH LOCK                 90426021
PIBCLO EQU   X'02'                 CLOSE ONLY                           90432021
PIBREW EQU   X'01'                      REWRITE                         90438021
PIBFL2 DS    1X                         FLAG 2                          90444021
PIBRER EQU   X'80'                      RERUN                           90450021
PIBOIR EQU   X'40'                OPEN INPUT REVERSED                   90456021
PIBFRE   EQU   X'20'              FREE                                  90462021
PIBWBA EQU   X'10'                WRITE BEFORE ADVANCING                90468021
PIBUSI EQU   X'08'                USING                                 90474021
PIBGIV EQU   X'04'                GIVING                                90480021
PIBUSE   EQU   X'02'              USE                                   90486021
PIBPOS   EQU   X'01'              POSITIONING                           90492021
PIBFL3 DS    1X                   UNUSED                                90498021
PIBNSL   EQU   X'80'              NSL                                   90504021
PIBWRT   EQU   X'20'              WRITE                                 90510021
PIBSRT   EQU   X'08'              START                                 90516021
PIBINV   EQU   X'04'              INV-KEY                               90522021
ICTDST DSECT                                                            90528021
ICTCOD DS    1X                         03 CODE                         90534021
ICTCNT DS    1X                         TOTAL CT= FIXED + FN            90540021
ICTLVL DS    1X                         LEVEL INDICATION                90546021
ICTCDN DS    2X                         CARD NO                         90552021
ICTEXF DS    7X                         EXT FILE NAME                   90558021
ICTSYS DS    1X                         SYS NO                          90564021
ICTFL1 DS    1X                         FLAG 1                          90570021
ICTRDA EQU   X'80'                      RANDOM ACCESS SW                90576021
ICTORG EQU   X'70'                      ORGANIZATION                    90582021
ICTDA    EQU   X'02'                                                    90588021
ICTUR    EQU   X'04'                                                    90594021
ICTUT    EQU   X'08'                                                    90600021
ICTALA EQU   X'01'                      RESERVE ALT AREA                90606021
ICTFL2 DS    1X                         FLAG 2                          90612021
ICTSOP EQU   X'80'                      SELECT OPTIONAL SW              90618021
ICTSMA EQU   X'40'                      SAME AREA SW                    90624021
ICTEXS EQU   X'20'                      EXTENDED SEARCH SW              90630021
ICTSRS   EQU   X'10'                                                    90636021
ICTSSS   EQU   X'08'                                                    90642021
ICTCKP EQU   X'04'                      PTR TO CKPTBL SW                90648021
ICTPIO EQU   X'02'                      PTR TO PIOTBL SW                90654021
ICTRPD EQU   X'01'                      RANDOM PROCESSING SW            90660021
ICTTRK   DS    1X                  TRACK CAPACITY                       90666021
ICTXXX   DS    1X                                                       90672021
ICTPIR DS    2X                         PIOTBL PTR                      90678021
ICTRAR DS    1X                         RESERVE AREA                    90684021
ICTFL3 DS    1X                         FLAG 3                          90690021
ICTCPY EQU   X'80'                      COPY SW                         90696021
ICTRCM EQU   X'60'                      RECORDING MODE                  90702021
ICTBLO EQU   X'18'                      BLOCK CONTAINS OPTION           90708021
ICTLRD EQU   X'06'                      LABEL RECORDS                   90714021
ICTRPT EQU   X'01'                      REPORTS                         90720021
ICTBMN   DS    2X                BLOCK CONTAINS 1ST COUNT               90726021
ICTRMN DS    2X                         RECORD CONTAINS MIN CT          90732021
ICTRMX DS    2X                         RECORD CONTAINS MAX CT          90738021
ICTTLM DS    2X                         TRACK LIMIT NUM                 90744021
ICTESH DS    2X                         EXTENDED SEARCH NO              90750021
ICTCPT DS    2X                         CKPTBL PTR                      90756021
ICTSAM DS    1X                         SAME NO                         90762021
ICTFL4 DS    1X                         FLAG 4                          90768021
ICTTKA EQU   X'C0'                 TRACK AREA SW                        90774021
ICTOVF EQU   X'20'                      OVERFLOW SW                     90780021
ICTNOM EQU   X'10'                      NOMKEY SW                       90786021
ICTACT EQU   X'08'                      ACTKEY SW                       90792021
ICTREC EQU   X'04'                      RECKEY SW                       90798021
ICTWRT EQU   X'02'                      WRITE ONLY SW                   90804021
ICTRCP EQU   X'01'                      RECORD PROTECT SW               90810021
ICTFL5 DS    1X                         FLAG 5                          90816021
ICTWRV EQU   X'80'                      WRITE VERIFY SW                 90822021
ICTCOS EQU   X'40'                      CYL OVERFLOW SW                 90828021
ICTMFT EQU   X'08'                      MULTIPLE FILE TAPE SW           90834021
ICTMSI EQU   X'04'                      MASTER INDEX SW                 90840021
ICTICI EQU   X'02'                      INCORE CYL INDEX SW             90846021
ICTROS EQU   X'01'                      RECORD OVERFLOW SW              90852021
ICTUN1 DS    1X                         UNUSED                          90858021
ICTSRA DS    1X                         SAME RECORD AREA NO             90864021
ICTPIN DS    1X                         POSITION INTEGER                90870021
ICTCOT DS    1X                         CYL OVERFLOW TRACKS NO          90876021
ICTDTC DS    1X                         DEVICE TYPE CODE                90882021
ICTDHI DS    1X                         DEVICE OF HIGHEST INDEX         90888021
ICTUN2 DS    1X                         UNUSED                          90894021
ICTBMX   DS    2X                 BLOCK CONTAINS 2ND COUNT              90900021
ICTFL6   DS    1X                                                       90906021
ICTEND DS    1X                                                         90912021
DX0      EQU   0                                                        90918021
LX0      EQU   0                                                        90924021
DX1      EQU   1                                                        90930021
NX1      EQU   1                                                        90936021
LX1      EQU   1                                                        90942021
DX2      EQU   2                                                        90948021
NX2      EQU   2                                                        90954021
LX2      EQU   2                                                        90960021
DX3      EQU   3                                                        90966021
NX3      EQU   3                                                        90972021
DX4      EQU   4                                                        90978021
NX4      EQU   4                                                        90984021
DX5      EQU   5                                                        90990021
NX5      EQU   5                                                        90996021
LX5      EQU   5                                                        91002021
DX6      EQU   6                                                        91008021
NX6      EQU   6                                                        91014021
DX7      EQU   7                                                        91020021
NX7      EQU   7                                                        91026021
DX8      EQU   8                                                        91032021
NX8      EQU   8                                                        91038021
LX8      EQU   8                                                        91044021
DX9      EQU   9                                                        91050021
NX9      EQU   9                                                        91056021
DX10     EQU   10                                                       91062021
NX10     EQU   10                                                       91068021
DX11     EQU   11                                                       91074021
NX11     EQU   11                                                       91080021
DX12     EQU   12                                                       91086021
NX12     EQU   12                                                       91092021
DX13     EQU   13                                                       91098021
NX13     EQU   13                                                       91104021
DX14     EQU   14                                                       91110021
NX14     EQU   14                                                       91116021
DX15     EQU   15                                                       91122021
NX15     EQU   15                                                       91128021
LX15     EQU   15                                                       91134021
DX16     EQU   16                                                       91140021
NX16     EQU   16                                                       91146021
LX16     EQU   16                                                       91152021
DX17     EQU   17                                                       91158021
NX17     EQU   17                                                       91164021
DX18     EQU   18                                                       91170021
DX19     EQU   19                                                       91176021
DX20     EQU   20                                                       91182021
NX20     EQU   20                                                       91188021
DX21     EQU   21                                                       91194021
NX21     EQU   21                                                       91200021
DX22     EQU   22                                                       91206021
DX23     EQU   23                                                       91212021
NX23     EQU   23                                                       91218021
DX24     EQU   24                                                       91224021
NX24     EQU   24                                                       91230021
DX25     EQU   25                                                       91236021
NX25     EQU   25                                                       91242021
DX26     EQU   26                                                       91248021
NX26     EQU   26                                                       91254021
DX27     EQU   27                                                       91260021
DX28     EQU   28                                                       91266021
NX28     EQU   28                                                       91272021
DX30     EQU   30                                                       91278021
DX32     EQU   32                                                       91284021
NX32     EQU   32                                                       91290021
NX33     EQU   33                                                       91296021
DX34     EQU   34                                                       91302021
NX34     EQU   34                                                       91308021
DX35     EQU   35                                                       91314021
NX35     EQU   35                                                       91320021
DX36     EQU   36                                                       91326021
NX36     EQU   36                                                       91332021
DX37     EQU   37                                                       91338021
NX37     EQU   37                                                       91344021
NX39     EQU   39                                                       91350021
NX40     EQU   40                                                       91356021
DX41     EQU   41                                                       91362021
DX44     EQU   44                                                       91368021
DX47     EQU   47                                                       91374021
DX48     EQU   48                                                       91380021
NX48     EQU   48                                                       91386021
DX50     EQU   50                                                       91392021
DX51     EQU   51                                                       91398021
NX52     EQU   52                                                       91404021
NX53     EQU   53                                                       91410021
DX56     EQU   56                                                       91416021
NX56     EQU   56                                                       91422021
NX58     EQU   58                                                       91428021
NX59     EQU   59                                                       91434021
NX60     EQU   60                                                       91440021
DX61     EQU   61                                                       91446021
DX62     EQU   62                                                       91452021
DX64     EQU   64                                                       91458021
NX67     EQU   67                                                       91464021
NX70     EQU   70                                                       91470021
NX75     EQU   75                                                       91476021
DX76     EQU   76                                                       91482021
NX79     EQU   79                                                       91488021
DX80     EQU   80                                                       91494021
DX82     EQU   82                                                       91500021
DX83     EQU   83                                                       91506021
DX84     EQU   84                                                       91512021
DX88     EQU   88                                                       91518021
NX91     EQU   91                                                       91524021
DX92     EQU   92                                                       91530021
DX95     EQU   95                                                       91536021
NX98     EQU   98                                                       91542021
DX100    EQU   100                                                      91548021
NX100    EQU   100                                                      91554021
DX104    EQU   104                                                      91560021
DX107    EQU   107                                                      91566021
NX107    EQU   107                                                      91572021
DX108    EQU   108                                                      91578021
NX108    EQU   108                                                      91584021
DX112    EQU   112                                                      91590021
NX112    EQU   112                                                      91596021
DX116    EQU   116                                                      91602021
DX120    EQU   120                                                      91608021
DX128    EQU   128                                                      91614021
LX160    EQU   160                      LENGTH OF PCI AND CI            91620021
DX140    EQU   140                                                      91626021
DX142    EQU   142                                                      91632021
DX143    EQU   143                                                      91638021
DX146    EQU   146                                                      91644021
DX147    EQU   147                                                      91650021
DX156    EQU   156                                                      91656021
DX255    EQU   255                                                      91662021
DX256    EQU   256                                                      91668021
XX0      EQU   X'00'                                                    91674021
XX4B     EQU   X'4B'                                                    91680021
XX08     EQU   X'08'                                                    91686021
XX10     EQU   X'10'                                                    91692021
XX5B     EQU   X'5B'                                                    91698021
XXFF     EQU   X'FF'                                                    91704021
XX02     EQU   X'02'                                                    91710021
XX00     EQU   X'00'                                                    91716021
XX04     EQU   X'04'                                                    91722021
XX28     EQU   X'28'                                                    91728021
XX29     EQU   X'29'                                              44686 91734021
XXFD     EQU   X'FD'                                                    91740021
XX42     EQU   X'42'                                                    91746021
XX03     EQU   X'03'                                                    91752021
XX01     EQU   X'01'                                                    91758021
XX12     EQU   X'12'                                                    91764021
XX38     EQU   X'38'                                                    91770021
XX36     EQU   X'36'                                                    91776021
XX32     EQU   X'32'                                                    91782021
XX80     EQU   X'80'                                                    91788021
XX05     EQU   X'05'                                                    91794021
XX40     EQU   X'40'                                                    91800021
XXBF     EQU   X'BF'                                                    91806021
XX0C     EQU   X'0C'                                                    91812021
XX20     EQU   X'20'                                                    91818021
XX44     EQU   X'44'                                                    91824021
XX0F     EQU   X'0F'                                                    91830021
XX89     EQU   X'89'                                                    91836021
XX06     EQU   X'06'                                                    91842021
XX34     EQU   X'34'                                                    91848021
XX8E     EQU   X'8E'                                                    91854021
XXF0     EQU   X'F0'                                                    91860021
XX30     EQU   X'30'                                                    91866021
XXC8     EQU   X'C8'                                                    91872021
XXFB     EQU   X'FB'                                                    91878021
XX2C     EQU   X'2C'                                                    91884021
XX7F     EQU   X'7F'                                                    91890021
XX39     EQU   X'39'                                                    91896021
XX31     EQU   X'31'                                                    91902021
XXFE     EQU   X'FE'                                                    91908021
XX33     EQU   X'33'                                                    91914021
XXF1     EQU   X'F1'                                                    91920021
XXC7     EQU   X'C7'                                                    91926021
XXCC     EQU   X'CC'                                                    91932021
XX07     EQU   X'07'                                                    91938021
XX70     EQU   X'70'                                                    91944021
XXE2     EQU   X'E2'                                                    91950021
XXF9     EQU   X'F9'                                                    91956021
XXA0     EQU   X'A0'                                                    91962021
XXDF     EQU   X'DF'                                                    91968021
XXC0     EQU   X'C0'                                                    91974021
XX4D     EQU   X'4D'                                                    91980021
XX5D     EQU   X'5D'                                                    91986021
XX23     EQU   X'23'                                                    91992021
XX0E     EQU   X'0E'                                                    91998021
XXE4     EQU   X'E4'                                                    92004021
XX3F     EQU   X'3F'                                                    92010021
XX22     EQU   X'22'                                                    92016021
XX0A     EQU   X'0A'                                                    92022021
XX1F     EQU   X'1F'                                                    92028021
XX90     EQU   X'90'                                                    92034021
XXE6     EQU   X'E6'                                                    92040021
XXBB     EQU   X'BB'                                                    92046021
XXB0     EQU   X'B0'                                                    92052021
XX84     EQU   X'84'                                                    92058021
INITSIZE EQU   X'4C'                    SIZE OF CORE-IDX RTN      41095 92064021
XX98     EQU   X'98'                                                    92070021
XXEF     EQU   X'EF'                                                    92076021
XXE0     EQU   X'E0'                                                    92082021
XX09     EQU   X'09'                                                    92088021
XX18     EQU   X'18'                                                    92094021
XXE7     EQU   X'E7'                                                    92100021
XX2F     EQU   X'2F'                                                    92106021
XXF2     EQU   X'F2'                                                    92112021
XXF8     EQU   X'F8'                                                    92118021
XX8C     EQU   X'8C'                                                    92124021
XXF7     EQU   X'F7'                                                    92130021
XX4E     EQU   X'4E'                                                    92136021
XX60     EQU   X'60'                                                    92142021
XX24     EQU   X'24'                                                    92148021
XX50     EQU   X'50'                                                    92154021
XX0B     EQU   X'0B'                                                    92160021
XX14     EQU   X'14'                                                    92166021
XX25     EQU   X'25'                                                    92172021
XXD0     EQU   X'D0'                                                    92178021
XX37     EQU   X'37'                                                    92184021
XX1C     EQU   X'1C'                                                    92190021
XX6F     EQU   X'6F'                                                    92196021
XX5C     EQU   X'5C'                                                    92202021
XX75     EQU   X'75'                                                    92208021
XXC1     EQU   X'C1'                                                    92214021
XXC9     EQU   X'C9'                                                    92220021
XXD1     EQU   X'D1'                                                    92226021
XXD9     EQU   X'D9'                                                    92232021
XXE9     EQU   X'E9'                                                    92238021
XX48     EQU   X'48'                                                    92244021
XX62     EQU   X'62'                                                    92250021
XX58     EQU   X'58'                                                    92256021
XX88     EQU   X'88'                                                    92262021
XX4C     EQU   X'4C'                                                    92268021
XXAA     EQU   X'AA'                                                    92274021
XC0      EQU   C'0'                                                     92280021
XCP      EQU   C'P'                                                     92286021
XC9      EQU   C'9'                                                     92292021
XCS      EQU   C'S'                                                     92298021
XCV      EQU   C'V'                                                     92304021
XCE      EQU   C'E'                                                     92310021
XCZ      EQU   C'Z'                                                     92316021
XCB      EQU   C'B'                                                     92322021
XCC      EQU   C'C'                                                     92328021
XCX      EQU   C'X'                                                     92334021
XCA      EQU   C'A'                                                     92340021
XC8      EQU   C'8'                                                     92346021
XC7      EQU   C'7'                                                     92352021
XC6      EQU   C'6'                                                     92358021
XCD      EQU   C'D'                                                     92364021
XCR      EQU   C'R'                                                     92370021
M0       EQU   0                                                        92376021
M1       EQU   1                                                        92382021
M2       EQU   2                                                        92388021
M4       EQU   4                                                        92394021
M7       EQU   7                                                        92400021
M8       EQU   8                                                        92406021
M15      EQU   15                                                       92412021
       END     BEGIN                                                    92418021
